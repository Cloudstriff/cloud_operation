var requirejs,require,define;!function(global){function isFunction(it){return"[object Function]"===ostring.call(it)}function isArray(it){return"[object Array]"===ostring.call(it)}function each(ary,func){if(ary){var i;for(i=0;i<ary.length&&(!ary[i]||!func(ary[i],i,ary));i+=1);}}function eachReverse(ary,func){if(ary){var i;for(i=ary.length-1;i>-1&&(!ary[i]||!func(ary[i],i,ary));i-=1);}}function hasProp(obj,prop){return hasOwn.call(obj,prop)}function getOwn(obj,prop){return hasProp(obj,prop)&&obj[prop]}function eachProp(obj,func){var prop;for(prop in obj)if(hasProp(obj,prop)&&func(obj[prop],prop))break}function mixin(target,source,force,deepStringMixin){return source&&eachProp(source,function(value,prop){(force||!hasProp(target,prop))&&(deepStringMixin&&"string"!=typeof value?(target[prop]||(target[prop]={}),mixin(target[prop],value,force,deepStringMixin)):target[prop]=value)}),target}function bind(obj,fn){return function(){return fn.apply(obj,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(err){throw err}function getGlobal(value){if(!value)return value;var g=global;return each(value.split("."),function(part){g=g[part]}),g}function makeError(id,msg,err,requireModules){var e=new Error(msg+"\nhttp://requirejs.org/docs/errors.html#"+id);return e.requireType=id,e.requireModules=requireModules,err&&(e.originalError=err),e}function newContext(contextName){function trimDots(ary){var i,part;for(i=0;ary[i];i+=1)if(part=ary[i],"."===part)ary.splice(i,1),i-=1;else if(".."===part){if(1===i&&(".."===ary[2]||".."===ary[0]))break;i>0&&(ary.splice(i-1,2),i-=2)}}function normalize(name,baseName,applyMap){var pkgName,pkgConfig,mapValue,nameParts,i,j,nameSegment,foundMap,foundI,foundStarMap,starI,baseParts=baseName&&baseName.split("/"),normalizedBaseParts=baseParts,map=config.map,starMap=map&&map["*"];if(name&&"."===name.charAt(0)&&(baseName?(normalizedBaseParts=getOwn(config.pkgs,baseName)?baseParts=[baseName]:baseParts.slice(0,baseParts.length-1),name=normalizedBaseParts.concat(name.split("/")),trimDots(name),pkgConfig=getOwn(config.pkgs,pkgName=name[0]),name=name.join("/"),pkgConfig&&name===pkgName+"/"+pkgConfig.main&&(name=pkgName)):0===name.indexOf("./")&&(name=name.substring(2))),applyMap&&map&&(baseParts||starMap)){for(nameParts=name.split("/"),i=nameParts.length;i>0;i-=1){if(nameSegment=nameParts.slice(0,i).join("/"),baseParts)for(j=baseParts.length;j>0;j-=1)if(mapValue=getOwn(map,baseParts.slice(0,j).join("/")),mapValue&&(mapValue=getOwn(mapValue,nameSegment))){foundMap=mapValue,foundI=i;break}if(foundMap)break;!foundStarMap&&starMap&&getOwn(starMap,nameSegment)&&(foundStarMap=getOwn(starMap,nameSegment),starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return name}function removeScript(name){isBrowser&&each(scripts(),function(scriptNode){return scriptNode.getAttribute("data-requiremodule")===name&&scriptNode.getAttribute("data-requirecontext")===context.contextName?(scriptNode.parentNode.removeChild(scriptNode),!0):void 0})}function hasPathFallback(id){var pathConfig=getOwn(config.paths,id);return pathConfig&&isArray(pathConfig)&&pathConfig.length>1?(pathConfig.shift(),context.require.undef(id),context.require([id]),!0):void 0}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;return index>-1&&(prefix=name.substring(0,index),name=name.substring(index+1,name.length)),[prefix,name]}function makeModuleMap(name,parentModuleMap,isNormalized,applyMap){var url,pluginModule,suffix,nameParts,prefix=null,parentName=parentModuleMap?parentModuleMap.name:null,originalName=name,isDefine=!0,normalizedName="";return name||(isDefine=!1,name="_@r"+(requireCounter+=1)),nameParts=splitPrefix(name),prefix=nameParts[0],name=nameParts[1],prefix&&(prefix=normalize(prefix,parentName,applyMap),pluginModule=getOwn(defined,prefix)),name&&(prefix?normalizedName=pluginModule&&pluginModule.normalize?pluginModule.normalize(name,function(name){return normalize(name,parentName,applyMap)}):normalize(name,parentName,applyMap):(normalizedName=normalize(name,parentName,applyMap),nameParts=splitPrefix(normalizedName),prefix=nameParts[0],normalizedName=nameParts[1],isNormalized=!0,url=context.nameToUrl(normalizedName))),suffix=!prefix||pluginModule||isNormalized?"":"_unnormalized"+(unnormalizedCounter+=1),{prefix:prefix,name:normalizedName,parentMap:parentModuleMap,unnormalized:!!suffix,url:url,originalName:originalName,isDefine:isDefine,id:(prefix?prefix+"!"+normalizedName:normalizedName)+suffix}}function getModule(depMap){var id=depMap.id,mod=getOwn(registry,id);return mod||(mod=registry[id]=new context.Module(depMap)),mod}function on(depMap,name,fn){var id=depMap.id,mod=getOwn(registry,id);!hasProp(defined,id)||mod&&!mod.defineEmitComplete?(mod=getModule(depMap),mod.error&&"error"===name?fn(mod.error):mod.on(name,fn)):"defined"===name&&fn(defined[id])}function onError(err,errback){var ids=err.requireModules,notified=!1;errback?errback(err):(each(ids,function(id){var mod=getOwn(registry,id);mod&&(mod.error=err,mod.events.error&&(notified=!0,mod.emit("error",err)))}),notified||req.onError(err))}function takeGlobalQueue(){globalDefQueue.length&&(apsp.apply(defQueue,[defQueue.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function cleanRegistry(id){delete registry[id],delete enabledRegistry[id]}function breakCycle(mod,traced,processed){var id=mod.map.id;mod.error?mod.emit("error",mod.error):(traced[id]=!0,each(mod.depMaps,function(depMap,i){var depId=depMap.id,dep=getOwn(registry,depId);!dep||mod.depMatched[i]||processed[depId]||(getOwn(traced,depId)?(mod.defineDep(i,defined[depId]),mod.check()):breakCycle(dep,traced,processed))}),processed[id]=!0)}function checkLoaded(){var map,modId,err,usingPathFallback,waitInterval=1e3*config.waitSeconds,expired=waitInterval&&context.startTime+waitInterval<(new Date).getTime(),noLoads=[],reqCalls=[],stillLoading=!1,needCycleCheck=!0;if(!inCheckLoaded){if(inCheckLoaded=!0,eachProp(enabledRegistry,function(mod){if(map=mod.map,modId=map.id,mod.enabled&&(map.isDefine||reqCalls.push(mod),!mod.error))if(!mod.inited&&expired)hasPathFallback(modId)?(usingPathFallback=!0,stillLoading=!0):(noLoads.push(modId),removeScript(modId));else if(!mod.inited&&mod.fetched&&map.isDefine&&(stillLoading=!0,!map.prefix))return needCycleCheck=!1}),expired&&noLoads.length)return err=makeError("timeout","Load timeout for modules: "+noLoads,null,noLoads),err.contextName=context.contextName,onError(err);needCycleCheck&&each(reqCalls,function(mod){breakCycle(mod,{},{})}),expired&&!usingPathFallback||!stillLoading||!isBrowser&&!isWebWorker||checkLoadedTimeoutId||(checkLoadedTimeoutId=setTimeout(function(){checkLoadedTimeoutId=0,checkLoaded()},50)),inCheckLoaded=!1}}function callGetModule(args){hasProp(defined,args[0])||getModule(makeModuleMap(args[0],null,!0)).init(args[1],args[2])}function removeListener(node,func,name,ieName){node.detachEvent&&!isOpera?ieName&&node.detachEvent(ieName,func):node.removeEventListener(name,func,!1)}function getScriptData(evt){var node=evt.currentTarget||evt.srcElement;return removeListener(node,context.onScriptLoad,"load","onreadystatechange"),removeListener(node,context.onScriptError,"error"),{node:node,id:node&&node.getAttribute("data-requiremodule")}}function intakeDefines(){var args;for(takeGlobalQueue();defQueue.length;){if(args=defQueue.shift(),null===args[0])return onError(makeError("mismatch","Mismatched anonymous define() module: "+args[args.length-1]));callGetModule(args)}}var inCheckLoaded,Module,context,handlers,checkLoadedTimeoutId,config={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},registry={},enabledRegistry={},undefEvents={},defQueue=[],defined={},urlFetched={},requireCounter=1,unnormalizedCounter=1;return handlers={require:function(mod){return mod.require?mod.require:mod.require=context.makeRequire(mod.map)},exports:function(mod){return mod.usingExports=!0,mod.map.isDefine?mod.exports?mod.exports:mod.exports=defined[mod.map.id]={}:void 0},module:function(mod){return mod.module?mod.module:mod.module={id:mod.map.id,uri:mod.map.url,config:function(){var c,pkg=getOwn(config.pkgs,mod.map.id);return c=pkg?getOwn(config.config,mod.map.id+"/"+pkg.main):getOwn(config.config,mod.map.id),c||{}},exports:defined[mod.map.id]}}},Module=function(map){this.events=getOwn(undefEvents,map.id)||{},this.map=map,this.shim=getOwn(config.shim,map.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},Module.prototype={init:function(depMaps,factory,errback,options){options=options||{},this.inited||(this.factory=factory,errback?this.on("error",errback):this.events.error&&(errback=bind(this,function(err){this.emit("error",err)})),this.depMaps=depMaps&&depMaps.slice(0),this.errback=errback,this.inited=!0,this.ignore=options.ignore,options.enabled||this.enabled?this.enable():this.check())},defineDep:function(i,depExports){this.depMatched[i]||(this.depMatched[i]=!0,this.depCount-=1,this.depExports[i]=depExports)},fetch:function(){if(!this.fetched){this.fetched=!0,context.startTime=(new Date).getTime();var map=this.map;return this.shim?void context.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return map.prefix?this.callPlugin():this.load()})):map.prefix?this.callPlugin():this.load()}},load:function(){var url=this.map.url;urlFetched[url]||(urlFetched[url]=!0,context.load(this.map.id,url))},check:function(){if(this.enabled&&!this.enabling){var err,cjsModule,id=this.map.id,depExports=this.depExports,exports=this.exports,factory=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(factory)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{exports=context.execCb(id,factory,depExports,exports)}catch(e){err=e}else exports=context.execCb(id,factory,depExports,exports);if(this.map.isDefine&&(cjsModule=this.module,cjsModule&&void 0!==cjsModule.exports&&cjsModule.exports!==this.exports?exports=cjsModule.exports:void 0===exports&&this.usingExports&&(exports=this.exports)),err)return err.requireMap=this.map,err.requireModules=this.map.isDefine?[this.map.id]:null,err.requireType=this.map.isDefine?"define":"require",onError(this.error=err)}else exports=factory;this.exports=exports,this.map.isDefine&&!this.ignore&&(defined[id]=exports,req.onResourceLoad&&req.onResourceLoad(context,this.map,this.depMaps)),cleanRegistry(id),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var map=this.map,id=map.id,pluginMap=makeModuleMap(map.prefix);this.depMaps.push(pluginMap),on(pluginMap,"defined",bind(this,function(plugin){var load,normalizedMap,normalizedMod,name=this.map.name,parentName=this.map.parentMap?this.map.parentMap.name:null,localRequire=context.makeRequire(map.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(plugin.normalize&&(name=plugin.normalize(name,function(name){return normalize(name,parentName,!0)})||""),normalizedMap=makeModuleMap(map.prefix+"!"+name,this.map.parentMap),on(normalizedMap,"defined",bind(this,function(value){this.init([],function(){return value},null,{enabled:!0,ignore:!0})})),normalizedMod=getOwn(registry,normalizedMap.id),void(normalizedMod&&(this.depMaps.push(normalizedMap),this.events.error&&normalizedMod.on("error",bind(this,function(err){this.emit("error",err)})),normalizedMod.enable()))):(load=bind(this,function(value){this.init([],function(){return value},null,{enabled:!0})}),load.error=bind(this,function(err){this.inited=!0,this.error=err,err.requireModules=[id],eachProp(registry,function(mod){0===mod.map.id.indexOf(id+"_unnormalized")&&cleanRegistry(mod.map.id)}),onError(err)}),load.fromText=bind(this,function(text,textAlt){var moduleName=map.name,moduleMap=makeModuleMap(moduleName),hasInteractive=useInteractive;textAlt&&(text=textAlt),hasInteractive&&(useInteractive=!1),getModule(moduleMap),hasProp(config.config,id)&&(config.config[moduleName]=config.config[id]);try{req.exec(text)}catch(e){return onError(makeError("fromtexteval","fromText eval for "+id+" failed: "+e,e,[id]))}hasInteractive&&(useInteractive=!0),this.depMaps.push(moduleMap),context.completeLoad(moduleName),localRequire([moduleName],load)}),void plugin.load(map.name,localRequire,load,config))})),context.enable(pluginMap,this),this.pluginMaps[pluginMap.id]=pluginMap},enable:function(){enabledRegistry[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(depMap,i){var id,mod,handler;if("string"==typeof depMap){if(depMap=makeModuleMap(depMap,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[i]=depMap,handler=getOwn(handlers,depMap.id))return void(this.depExports[i]=handler(this));this.depCount+=1,on(depMap,"defined",bind(this,function(depExports){this.defineDep(i,depExports),this.check()})),this.errback&&on(depMap,"error",bind(this,this.errback))}id=depMap.id,mod=registry[id],hasProp(handlers,id)||!mod||mod.enabled||context.enable(depMap,this)})),eachProp(this.pluginMaps,bind(this,function(pluginMap){var mod=getOwn(registry,pluginMap.id);mod&&!mod.enabled&&context.enable(pluginMap,this)})),this.enabling=!1,this.check()},on:function(name,cb){var cbs=this.events[name];cbs||(cbs=this.events[name]=[]),cbs.push(cb)},emit:function(name,evt){each(this.events[name],function(cb){cb(evt)}),"error"===name&&delete this.events[name]}},context={config:config,contextName:contextName,registry:registry,defined:defined,urlFetched:urlFetched,defQueue:defQueue,Module:Module,makeModuleMap:makeModuleMap,nextTick:req.nextTick,onError:onError,configure:function(cfg){cfg.baseUrl&&"/"!==cfg.baseUrl.charAt(cfg.baseUrl.length-1)&&(cfg.baseUrl+="/");var pkgs=config.pkgs,shim=config.shim,objs={paths:!0,config:!0,map:!0};eachProp(cfg,function(value,prop){objs[prop]?"map"===prop?(config.map||(config.map={}),mixin(config[prop],value,!0,!0)):mixin(config[prop],value,!0):config[prop]=value}),cfg.shim&&(eachProp(cfg.shim,function(value,id){isArray(value)&&(value={deps:value}),!value.exports&&!value.init||value.exportsFn||(value.exportsFn=context.makeShimExports(value)),shim[id]=value}),config.shim=shim),cfg.packages&&(each(cfg.packages,function(pkgObj){var location;pkgObj="string"==typeof pkgObj?{name:pkgObj}:pkgObj,location=pkgObj.location,pkgs[pkgObj.name]={name:pkgObj.name,location:location||pkgObj.name,main:(pkgObj.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),config.pkgs=pkgs),eachProp(registry,function(mod,id){mod.inited||mod.map.unnormalized||(mod.map=makeModuleMap(id))}),(cfg.deps||cfg.callback)&&context.require(cfg.deps||[],cfg.callback)},makeShimExports:function(value){function fn(){var ret;return value.init&&(ret=value.init.apply(global,arguments)),ret||value.exports&&getGlobal(value.exports)}return fn},makeRequire:function(relMap,options){function localRequire(deps,callback,errback){var id,map,requireMod;return options.enableBuildCallback&&callback&&isFunction(callback)&&(callback.__requireJsBuild=!0),"string"==typeof deps?isFunction(callback)?onError(makeError("requireargs","Invalid require call"),errback):relMap&&hasProp(handlers,deps)?handlers[deps](registry[relMap.id]):req.get?req.get(context,deps,relMap,localRequire):(map=makeModuleMap(deps,relMap,!1,!0),id=map.id,hasProp(defined,id)?defined[id]:onError(makeError("notloaded",'Module name "'+id+'" has not been loaded yet for context: '+contextName+(relMap?"":". Use require([])")))):(intakeDefines(),context.nextTick(function(){intakeDefines(),requireMod=getModule(makeModuleMap(null,relMap)),requireMod.skipMap=options.skipMap,requireMod.init(deps,callback,errback,{enabled:!0}),checkLoaded()}),localRequire)}return options=options||{},mixin(localRequire,{isBrowser:isBrowser,toUrl:function(moduleNamePlusExt){var ext,index=moduleNamePlusExt.lastIndexOf("."),segment=moduleNamePlusExt.split("/")[0],isRelative="."===segment||".."===segment;return-1!==index&&(!isRelative||index>1)&&(ext=moduleNamePlusExt.substring(index,moduleNamePlusExt.length),moduleNamePlusExt=moduleNamePlusExt.substring(0,index)),context.nameToUrl(normalize(moduleNamePlusExt,relMap&&relMap.id,!0),ext,!0)},defined:function(id){return hasProp(defined,makeModuleMap(id,relMap,!1,!0).id)},specified:function(id){return id=makeModuleMap(id,relMap,!1,!0).id,hasProp(defined,id)||hasProp(registry,id)}}),relMap||(localRequire.undef=function(id){takeGlobalQueue();var map=makeModuleMap(id,relMap,!0),mod=getOwn(registry,id);removeScript(id),delete defined[id],delete urlFetched[map.url],delete undefEvents[id],mod&&(mod.events.defined&&(undefEvents[id]=mod.events),cleanRegistry(id))}),localRequire},enable:function(depMap){var mod=getOwn(registry,depMap.id);mod&&getModule(depMap).enable()},completeLoad:function(moduleName){var found,args,mod,shim=getOwn(config.shim,moduleName)||{},shExports=shim.exports;for(takeGlobalQueue();defQueue.length;){if(args=defQueue.shift(),null===args[0]){if(args[0]=moduleName,found)break;found=!0}else args[0]===moduleName&&(found=!0);callGetModule(args)}if(mod=getOwn(registry,moduleName),!found&&!hasProp(defined,moduleName)&&mod&&!mod.inited){if(!(!config.enforceDefine||shExports&&getGlobal(shExports)))return hasPathFallback(moduleName)?void 0:onError(makeError("nodefine","No define call for "+moduleName,null,[moduleName]));callGetModule([moduleName,shim.deps||[],shim.exportsFn])}checkLoaded()},nameToUrl:function(moduleName,ext,skipExt){var paths,pkgs,pkg,pkgPath,syms,i,parentModule,url,parentPath;if(req.jsExtRegExp.test(moduleName))url=moduleName+(ext||"");else{for(paths=config.paths,pkgs=config.pkgs,syms=moduleName.split("/"),i=syms.length;i>0;i-=1){if(parentModule=syms.slice(0,i).join("/"),pkg=getOwn(pkgs,parentModule),parentPath=getOwn(paths,parentModule)){isArray(parentPath)&&(parentPath=parentPath[0]),syms.splice(0,i,parentPath);break}if(pkg){pkgPath=moduleName===pkg.name?pkg.location+"/"+pkg.main:pkg.location,syms.splice(0,i,pkgPath);break}}url=syms.join("/"),url+=ext||(/^data\:|\?/.test(url)||skipExt?"":".js"),url=("/"===url.charAt(0)||url.match(/^[\w\+\.\-]+:/)?"":config.baseUrl)+url}return config.urlArgs?url+((-1===url.indexOf("?")?"?":"&")+config.urlArgs):url},load:function(id,url){req.load(context,id,url)},execCb:function(name,callback,args,exports){return callback.apply(exports,args)},onScriptLoad:function(evt){if("load"===evt.type||readyRegExp.test((evt.currentTarget||evt.srcElement).readyState)){interactiveScript=null;var data=getScriptData(evt);context.completeLoad(data.id)}},onScriptError:function(evt){var data=getScriptData(evt);return hasPathFallback(data.id)?void 0:onError(makeError("scripterror","Script error for: "+data.id,evt,[data.id]))}},context.require=context.makeRequire(),context}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(script){return"interactive"===script.readyState?interactiveScript=script:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(deps,callback,errback,optional){var context,config,contextName=defContextName;return isArray(deps)||"string"==typeof deps||(config=deps,isArray(callback)?(deps=callback,callback=errback,errback=optional):deps=[]),config&&config.context&&(contextName=config.context),context=getOwn(contexts,contextName),context||(context=contexts[contextName]=req.s.newContext(contextName)),config&&context.configure(config),context.require(deps,callback,errback)},req.config=function(config){return req(config)},req.nextTick="undefined"!=typeof setTimeout?function(fn){setTimeout(fn,4)}:function(fn){fn()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(prop){req[prop]=function(){var ctx=contexts[defContextName];return ctx.require[prop].apply(ctx,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(config){var node=config.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return node.type=config.scriptType||"text/javascript",node.charset="utf-8",node.async=!0,node},req.load=function(context,moduleName,url){var node,config=context&&context.config||{};if(isBrowser)return node=req.createNode(config,moduleName,url),node.setAttribute("data-requirecontext",context.contextName),node.setAttribute("data-requiremodule",moduleName),!node.attachEvent||node.attachEvent.toString&&node.attachEvent.toString().indexOf("[native code")<0||isOpera?(node.addEventListener("load",context.onScriptLoad,!1),node.addEventListener("error",context.onScriptError,!1)):(useInteractive=!0,node.attachEvent("onreadystatechange",context.onScriptLoad)),node.src=url,currentlyAddingScript=node,baseElement?head.insertBefore(node,baseElement):head.appendChild(node),currentlyAddingScript=null,node;if(isWebWorker)try{importScripts(url),context.completeLoad(moduleName)}catch(e){context.onError(makeError("importscripts","importScripts failed for "+moduleName+" at "+url,e,[moduleName]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(script){return head||(head=script.parentNode),dataMain=script.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(name,deps,callback){var node,context;"string"!=typeof name&&(callback=deps,deps=name,name=null),isArray(deps)||(callback=deps,deps=null),!deps&&isFunction(callback)&&(deps=[],callback.length&&(callback.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(match,dep){deps.push(dep)}),deps=(1===callback.length?["require"]:["require","exports","module"]).concat(deps))),useInteractive&&(node=currentlyAddingScript||getInteractiveScript(),node&&(name||(name=node.getAttribute("data-requiremodule")),context=contexts[node.getAttribute("data-requirecontext")])),(context?context.defQueue:globalDefQueue).push([name,deps,callback])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("requireLib",function(){}),require.config({baseUrl:"",waitSeconds:0,paths:{jquery:"bower_components/jquery/jquery",angular:"bower_components/angular/angular",angularLocaleZhHansCn:"bower_components/angular-i18n/angular-locale_zh-hans-cn",angularAnimate:"bower_components/angular-animate/angular-animate",angularSanitize:"bower_components/angular-sanitize/angular-sanitize",angularUiSelect:"bower_components/angular-ui-select/dist/select",base64:"bower_components/js-base64/base64",jplayer:"bower_components/jplayer/jquery.jplayer/jquery.jplayer",less:"bower_components/less/dist/less-1.5.0",underscore:"bower_components/underscore/underscore",jcrop:"bower_components/jcrop/js/jquery.Jcrop",jqueryQrcode:"bower_components/jquery-qrcode/jquery.qrcode.min",placeholder:"bower_components/jquery-placeholder/jquery.placeholder",linkify:"bower_components/jQuery-linkify/dist/jquery.linkify",jqueryMousewheel:"bower_components/jquery-mousewheel/jquery.mousewheel",fullcalendar:"bower_components/fullcalendar/dist/fullcalendar",fullcalendarLang:"bower_components/fullcalendar/dist/lang/zh-cn",moment:"bower_components/moment/min/moment.min",bsTooltip:"bower_components/bootstrap/js/tooltip",bsPopover:"bower_components/bootstrap/js/popover",screenfull:"bower_components/screenfull/dist/screenfull",angularDatepicker:"bower_components/angular-datepicker/dist/angular-datepicker",select2:"bower_components/select2/dist/js/select2",caret:"vendor/atwho/js/jquery.caret",atwho:"vendor/atwho/js/jquery.atwho",socketio:"vendor/pomelo/socket.io",pomelo:"vendor/pomelo/pomeloclient",slimScroll:"vendor/rochal/slimscroll",swfupload:"vendor/swfupload/swfupload",ynDialog:"bower_components/ynDialog/src/dialogs",ynToast:"bower_components/ynToast/src/toast",ynMenu:"bower_components/ynMenu/src/menu",groupApp:"app/groupApp",dragable:"util/dragable",ZeroClipboard:"util/ZeroClipboard",RemoteLogger:"util/RemoteLogger",htmldiff:"util/htmldiff",analyzer:"util/analyzer",commonModule:"common/CommonModule",fileModule:"pagelet/file/fileModule",noteModule:"pagelet/note/noteModule",sidebarModule:"pagelet/sidebar/sidebarModule",chatModule:"pagelet/chat/chatModule",settingModule:"pagelet/setting/settingModule",imageModule:"pagelet/image/imageModule",previewModule:"pagelet/office/module",pdfModule:"pagelet/pdf/module",textModule:"pagelet/text/module",searchModule:"pagelet/search/searchModule",tableModule:"pagelet/table/module",orgSettingModule:"pagelet/orgSetting/orgSettingModule",calendarModule:"pagelet/calendar/module",markdownModule:"pagelet/md/module",taskModule:"pagelet/task/module",requireLib:"bower_components/requirejs/require"},shim:{angular:{deps:["jquery"],exports:"angular"},angularLocaleZhHansCn:["angular"],angularAnimate:["angular"],angularSanitize:["angular"],angularDatepicker:["angular","moment"],angularUiSelect:["angular"],angularMocks:{deps:["angular"],exports:"angular.resource"},ynDialog:{deps:["angular"],exports:"ynDialog"},ynToast:{deps:["angular"],exports:"ynToast"},ynMenu:{deps:["angular"],exports:"ynMenu"},jplayer:{deps:["jquery"],exports:"jplayer"},jquery:{exports:"jQuery"},jqueryui:{exports:"jQuery"},jqueryMousewheel:["jquery"],underscore:{deps:["jquery"],exports:"_"},less:{exports:"less"},ZeroClipboard:{exports:"ZeroClipboard"},base64:{exports:"Base64"},atwho:{deps:["jquery"],exports:"jQuery"},jcrop:{deps:["jquery"],exports:"jQuery"},jqueryQrcode:["jquery"],slimScroll:{deps:["jquery"],exports:"jQuery"},placeholder:{deps:["jquery"],exports:"jQuery"},linkify:{deps:["jquery"],exports:"jQuery"},bsTooltip:["jquery"],bsPopover:["jquery","bsTooltip"],pomelo:{deps:["socketio"],exports:"pomelo"},jqueryContextMenu:["jquery"],backbone:{deps:["jquery","underscore"],exports:"Backbone"},fullcalendarLang:{deps:["fullcalendar"]},select2:{deps:["jquery"],exports:"select2"}},priority:["angular"]}),define("option",function(){}),require(["option"],function(){"use strict";require(["angular","groupApp","analyzer"],function(angular,groupApp){angular.bootstrap(document,[groupApp.name])})}),define("index",function(){}),function(window,undefined){function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);return jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||"function"!==type&&(0===length||"number"==typeof length&&length>0&&length-1 in obj)}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(core_rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function internalData(elem,name,data,pvt){if(jQuery.acceptData(elem)){var thisCache,ret,internalKey=jQuery.expando,getByName="string"==typeof name,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if(id&&cache[id]&&(pvt||cache[id].data)||!getByName||data!==undefined)return id||(isNode?elem[internalKey]=id=core_deletedIds.pop()||jQuery.guid++:id=internalKey),cache[id]||(cache[id]={},isNode||(cache[id].toJSON=jQuery.noop)),("object"==typeof name||"function"==typeof name)&&(pvt?cache[id]=jQuery.extend(cache[id],name):cache[id].data=jQuery.extend(cache[id].data,name)),thisCache=cache[id],pvt||(thisCache.data||(thisCache.data={}),thisCache=thisCache.data),data!==undefined&&(thisCache[jQuery.camelCase(name)]=data),getByName?(ret=thisCache[name],null==ret&&(ret=thisCache[jQuery.camelCase(name)])):ret=thisCache,ret}}function internalRemoveData(elem,name,pvt){if(jQuery.acceptData(elem)){var i,l,thisCache,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(cache[id]){if(name&&(thisCache=pvt?cache[id]:cache[id].data)){jQuery.isArray(name)?name=name.concat(jQuery.map(name,jQuery.camelCase)):name in thisCache?name=[name]:(name=jQuery.camelCase(name),name=name in thisCache?[name]:name.split(" "));for(i=0,l=name.length;l>i;i++)delete thisCache[name[i]];if(!(pvt?isEmptyDataObject:jQuery.isEmptyObject)(thisCache))return}(pvt||(delete cache[id].data,isEmptyDataObject(cache[id])))&&(isNode?jQuery.cleanData([elem],!0):jQuery.support.deleteExpando||cache!=cache.window?delete cache[id]:cache[id]=null)}}}function dataAttr(elem,key,data){if(data===undefined&&1===elem.nodeType){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();if(data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else data=undefined}return data}function isEmptyDataObject(obj){var name;for(name in obj)if(("data"!==name||!jQuery.isEmptyObject(obj[name]))&&"toJSON"!==name)return!1;return!0}function returnTrue(){return!0}function returnFalse(){return!1}function sibling(cur,dir){do cur=cur[dir];while(cur&&1!==cur.nodeType);return cur}function winnow(elements,qualifier,keep){if(qualifier=qualifier||0,jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){var retVal=!!qualifier.call(elem,i,elem);return retVal===keep});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier===keep});if("string"==typeof qualifier){var filtered=jQuery.grep(elements,function(elem){return 1===elem.nodeType});if(isSimple.test(qualifier))return jQuery.filter(qualifier,filtered,!keep);qualifier=jQuery.filter(qualifier,filtered)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0===keep})}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement)for(;list.length;)safeFrag.createElement(list.pop());return safeFrag}function findOrAppend(elem,tag){return elem.getElementsByTagName(tag)[0]||elem.appendChild(elem.ownerDocument.createElement(tag))}function disableScript(elem){var attr=elem.getAttributeNode("type");return elem.type=(attr&&attr.specified)+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var elem,i=0;null!=(elem=elems[i]);i++)jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){if(1===dest.nodeType&&jQuery.hasData(src)){var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;
if(events){delete curData.handle,curData.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}curData.data&&(curData.data=jQuery.extend({},curData.data))}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(1===dest.nodeType){if(nodeName=dest.nodeName.toLowerCase(),!jQuery.support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events)jQuery.removeEvent(dest,e,data.handle);dest.removeAttribute(jQuery.expando)}"script"===nodeName&&dest.text!==src.text?(disableScript(dest).text=src.text,restoreScript(dest)):"object"===nodeName?(dest.parentNode&&(dest.outerHTML=src.outerHTML),jQuery.support.html5Clone&&src.innerHTML&&!jQuery.trim(dest.innerHTML)&&(dest.innerHTML=src.innerHTML)):"input"===nodeName&&manipulation_rcheckableType.test(src.type)?(dest.defaultChecked=dest.checked=src.checked,dest.value!==src.value&&(dest.value=src.value)):"option"===nodeName?dest.defaultSelected=dest.selected=src.defaultSelected:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}}function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==core_strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==core_strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found)for(found=[],elems=context.childNodes||context;null!=(elem=elems[i]);i++)!tag||jQuery.nodeName(elem,tag)?found.push(elem):jQuery.merge(found,getAll(elem,tag));return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){manipulation_rcheckableType.test(elem.type)&&(elem.defaultChecked=elem.checked)}function vendorPropName(style,name){if(name in style)return name;for(var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function isHidden(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=jQuery._data(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=jQuery._data(elem,"olddisplay",css_defaultDisplay(elem.nodeName)))):values[index]||(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(jQuery.support.boxSizingReliable||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function css_defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(doc.documentElement),doc=(iframe[0].contentWindow||iframe[0].contentDocument).document,doc.write("<!doctype html><html><body>"),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");return elem.remove(),display}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)src[key]!==undefined&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes,responseFields=s.responseFields;for(type in responseFields)type in responses&&(jqXHR[responseFields[type]]=responses[type]);for(;"*"===dataTypes[0];)dataTypes.shift(),ct===undefined&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response){var conv2,current,conv,tmp,converters={},i=0,dataTypes=s.dataTypes.slice(),prev=dataTypes[0];if(s.dataFilter&&(response=s.dataFilter(response,s.dataType)),dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(;current=dataTypes[++i];)if("*"!==current){if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.splice(i--,0,current));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}prev=current}return{state:"success",data:response}}function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function createFxNow(){return setTimeout(function(){fxNow=undefined}),fxNow=jQuery.now()}function createTweens(animation,props){jQuery.each(props,function(prop,value){for(var collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(collection[index].call(animation,prop,value))return})}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return createTweens(animation,props),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function propFilter(props,specialEasing){var value,name,index,easing,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function defaultPrefilter(elem,props,opts){var prop,index,length,value,dataShow,toggle,tween,hooks,oldfire,anim=this,style=elem.style,orig={},handled=[],hidden=elem.nodeType&&isHidden(elem);opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],"inline"===jQuery.css(elem,"display")&&"none"===jQuery.css(elem,"float")&&(jQuery.support.inlineBlockNeedsLayout&&"inline"!==css_defaultDisplay(elem.nodeName)?style.zoom=1:style.display="inline-block")),opts.overflow&&(style.overflow="hidden",jQuery.support.shrinkWrapBlocks||anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(index in props)if(value=props[index],rfxtypes.exec(value)){if(delete props[index],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show"))continue;handled.push(index)}if(length=handled.length){dataShow=jQuery._data(elem,"fxshow")||jQuery._data(elem,"fxshow",{}),"hidden"in dataShow&&(hidden=dataShow.hidden),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(index=0;length>index;index++)prop=handled[index],tween=anim.createTween(prop,hidden?dataShow[prop]:0),orig[prop]=dataShow[prop]||jQuery.style(elem,prop),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function genFx(type,includeWidth){var which,attrs={height:type},i=0;for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType?elem.defaultView||elem.parentWindow:!1}var readyList,rootjQuery,core_strundefined=typeof undefined,document=window.document,location=window.location,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="1.9.1",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rquickExpr=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rvalidchars=/^[\],:{}\s]*$/,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()},completed=function(event){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(detach(),jQuery.ready())},detach=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1)):(document.detachEvent("onreadystatechange",completed),window.detachEvent("onload",completed))};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}if(elem=document.getElementById(match[2]),elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1,this[0]=elem}return this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?rootjQuery.ready(selector):(selector.selector!==undefined&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return core_slice.call(this)},get:function(num){return null==num?this.toArray():0>num?this[this.length+num]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){return jQuery.ready.promise().done(fn),this},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice},jQuery.fn.init.prototype=jQuery.fn,jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[1]||{},i=2),"object"==typeof target||jQuery.isFunction(target)||(target={}),length===i&&(target=this,--i);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):copy!==undefined&&(target[name]=copy));return target},jQuery.extend({noConflict:function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){if(wait===!0?!--jQuery.readyWait:!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready);jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready"))}},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray||function(obj){return"array"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj==obj.window},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){return null==obj?String(obj):"object"==typeof obj||"function"==typeof obj?class2type[core_toString.call(obj)]||"object":typeof obj},isPlainObject:function(obj){if(!obj||"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!core_hasOwn.call(obj,"constructor")&&!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var key;for(key in obj);return key===undefined||core_hasOwn.call(obj,key)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},error:function(msg){throw new Error(msg)},parseHTML:function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))},parseJSON:function(data){return window.JSON&&window.JSON.parse?window.JSON.parse(data):null===data?data:"string"==typeof data&&(data=jQuery.trim(data),data&&rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,"")))?new Function("return "+data)():void jQuery.error("Invalid JSON: "+data)},parseXML:function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{window.DOMParser?(tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")):(xml=new ActiveXObject("Microsoft.XMLDOM"),xml.async="false",xml.loadXML(data))}catch(e){xml=undefined}return xml&&xml.documentElement&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml},noop:function(){},globalEval:function(data){data&&jQuery.trim(data)&&(window.execScript||function(data){window.eval.call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:core_trim&&!core_trim.call("﻿ ")?function(text){return null==text?"":core_trim.call(text)}:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):core_push.call(ret,arr)),ret},inArray:function(elem,arr,i){var len;if(arr){if(core_indexOf)return core_indexOf.call(arr,elem,i);for(len=arr.length,i=i?0>i?Math.max(0,len+i):i:0;len>i;i++)if(i in arr&&arr[i]===elem)return i}return-1},merge:function(first,second){var l=second.length,i=first.length,j=0;if("number"==typeof l)for(;l>j;j++)first[i++]=second[j];else for(;second[j]!==undefined;)first[i++]=second[j++];return first.length=i,first},grep:function(elems,callback,inv){var retVal,ret=[],i=0,length=elems.length;for(inv=!!inv;length>i;i++)retVal=!!callback(elems[i],i),inv!==retVal&&ret.push(elems[i]);return ret},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&(ret[ret.length]=value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&(ret[ret.length]=value);return core_concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=core_slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(core_slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):undefined},access:function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(value!==undefined&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;length>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},now:function(){return(new Date).getTime()}}),jQuery.ready.promise=function(obj){if(!readyList)if(readyList=jQuery.Deferred(),"complete"===document.readyState)setTimeout(jQuery.ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1);else{document.attachEvent("onreadystatechange",completed),window.attachEvent("onload",completed);var top=!1;try{top=null==window.frameElement&&document.documentElement}catch(e){}top&&top.doScroll&&!function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach(),jQuery.ready()}}()}return readyList.promise(obj)},jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()}),rootjQuery=jQuery(document);var optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],this},disable:function(){return list=stack=memory=undefined,this},disabled:function(){return!list},lock:function(){return stack=undefined,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return args=args||[],args=[context,args.slice?args.slice():args],!list||fired&&!stack||(firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var action=tuple[0],fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[action+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=core_slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?core_slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}}),jQuery.support=function(){var support,all,a,input,select,fragment,opt,eventName,isSupported,i,div=document.createElement("div");if(div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",all=div.getElementsByTagName("*"),a=div.getElementsByTagName("a")[0],!all||!a||!all.length)return{};select=document.createElement("select"),opt=select.appendChild(document.createElement("option")),input=div.getElementsByTagName("input")[0],a.style.cssText="top:1px;float:left;opacity:.5",support={getSetAttribute:"t"!==div.className,leadingWhitespace:3===div.firstChild.nodeType,tbody:!div.getElementsByTagName("tbody").length,htmlSerialize:!!div.getElementsByTagName("link").length,style:/top/.test(a.getAttribute("style")),hrefNormalized:"/a"===a.getAttribute("href"),opacity:/^0.5/.test(a.style.opacity),cssFloat:!!a.style.cssFloat,checkOn:!!input.value,optSelected:opt.selected,enctype:!!document.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===document.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},input.checked=!0,support.noCloneChecked=input.cloneNode(!0).checked,select.disabled=!0,support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=!1}input=document.createElement("input"),input.setAttribute("value",""),support.input=""===input.getAttribute("value"),input.value="t",input.setAttribute("type","radio"),support.radioValue="t"===input.value,input.setAttribute("checked","t"),input.setAttribute("name","t"),fragment=document.createDocumentFragment(),fragment.appendChild(input),support.appendChecked=input.checked,support.checkClone=fragment.cloneNode(!0).cloneNode(!0).lastChild.checked,div.attachEvent&&(div.attachEvent("onclick",function(){support.noCloneEvent=!1}),div.cloneNode(!0).click());for(i in{submit:!0,change:!0,focusin:!0})div.setAttribute(eventName="on"+i,"t"),support[i+"Bubbles"]=eventName in window||div.attributes[eventName].expando===!1;return div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,jQuery(function(){var container,marginDiv,tds,divReset="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",body=document.getElementsByTagName("body")[0];body&&(container=document.createElement("div"),container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",body.appendChild(container).appendChild(div),div.innerHTML="<table><tr><td></td><td>t</td></tr></table>",tds=div.getElementsByTagName("td"),tds[0].style.cssText="padding:0;margin:0;border:0;display:none",isSupported=0===tds[0].offsetHeight,tds[0].style.display="",tds[1].style.display="none",support.reliableHiddenOffsets=isSupported&&0===tds[0].offsetHeight,div.innerHTML="",div.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",support.boxSizing=4===div.offsetWidth,support.doesNotIncludeMarginInBodyOffset=1!==body.offsetTop,window.getComputedStyle&&(support.pixelPosition="1%"!==(window.getComputedStyle(div,null)||{}).top,support.boxSizingReliable="4px"===(window.getComputedStyle(div,null)||{width:"4px"}).width,marginDiv=div.appendChild(document.createElement("div")),marginDiv.style.cssText=div.style.cssText=divReset,marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",support.reliableMarginRight=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight)),typeof div.style.zoom!==core_strundefined&&(div.innerHTML="",div.style.cssText=divReset+"width:1px;padding:1px;display:inline;zoom:1",support.inlineBlockNeedsLayout=3===div.offsetWidth,div.style.display="block",div.innerHTML="<div></div>",div.firstChild.style.width="5px",support.shrinkWrapBlocks=3!==div.offsetWidth,support.inlineBlockNeedsLayout&&(body.style.zoom=1)),body.removeChild(container),container=div=tds=marginDiv=null)
}),all=select=fragment=opt=a=input=null,support}();var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(elem){return elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando],!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,!0)},_removeData:function(elem,name){return internalRemoveData(elem,name,!0)},acceptData:function(elem){if(elem.nodeType&&1!==elem.nodeType&&9!==elem.nodeType)return!1;var noData=elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()];return!noData||noData!==!0&&elem.getAttribute("classid")===noData}}),jQuery.fn.extend({data:function(key,value){var attrs,name,elem=this[0],i=0,data=null;if(key===undefined){if(this.length&&(data=jQuery.data(elem),1===elem.nodeType&&!jQuery._data(elem,"parsedAttrs"))){for(attrs=elem.attributes;i<attrs.length;i++)name=attrs[i].name,name.indexOf("data-")||(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name]));jQuery._data(elem,"parsedAttrs",!0)}return data}return"object"==typeof key?this.each(function(){jQuery.data(this,key)}):jQuery.access(this,function(value){return value===undefined?elem?dataAttr(elem,key,jQuery.data(elem,key)):null:void this.each(function(){jQuery.data(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=jQuery._data(elem,type),data&&(!queue||jQuery.isArray(data)?queue=jQuery._data(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),hooks.cur=fn,fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue"),jQuery._removeData(elem,key)})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=undefined),type=type||"fx";i--;)tmp=jQuery._data(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var nodeHook,boolHook,rclass=/[\t\r\n]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i,rboolean=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=jQuery.support.getSetAttribute,getSetInput=jQuery.support.input;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return name=jQuery.propFix[name]||name,this.each(function(){try{this[name]=undefined,delete this[name]}catch(e){}})},addClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed="string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(core_rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");elem.className=jQuery.trim(cur)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=0===arguments.length||"string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(core_rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");elem.className=value?jQuery.trim(cur):""}return this},toggleClass:function(value,stateVal){var type=typeof value,isBool="boolean"==typeof stateVal;return this.each(jQuery.isFunction(value)?function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}:function(){if("string"===type)for(var className,i=0,self=jQuery(this),state=stateVal,classNames=value.match(core_rnotwhite)||[];className=classNames[i++];)state=isBool?state:!self.hasClass(className),self[state?"addClass":"removeClass"](className);else(type===core_strundefined||"boolean"===type)&&(this.className&&jQuery._data(this,"__className__",this.className),this.className=this.className||value===!1?"":jQuery._data(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1},val:function(value){var ret,hooks,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val,self=jQuery(this);1===this.nodeType&&(val=isFunction?value.call(this,i,self.val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&hooks.set(this,val,"value")!==undefined||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=elem.attributes.value;return!val||val.specified?elem.value:elem.text}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],!(!option.selected&&i!==index||(jQuery.support.optDisabled?option.disabled:null!==option.getAttribute("disabled"))||option.parentNode.disabled&&jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){var values=jQuery.makeArray(value);return jQuery(elem).find("option").each(function(){this.selected=jQuery.inArray(jQuery(this).val(),values)>=0}),values.length||(elem.selectedIndex=-1),values}}},attr:function(elem,name,value){var hooks,notxml,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===core_strundefined?jQuery.prop(elem,name,value):(notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(rboolean.test(name)?boolHook:nodeHook)),value===undefined?hooks&&notxml&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(typeof elem.getAttribute!==core_strundefined&&(ret=elem.getAttribute(name)),null==ret?undefined:ret):null!==value?hooks&&notxml&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem.setAttribute(name,value+""),value):void jQuery.removeAttr(elem,name))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(core_rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,rboolean.test(name)?!getSetAttribute&&ruseDefault.test(name)?elem[jQuery.camelCase("default-"+name)]=elem[propName]=!1:elem[propName]=!1:jQuery.attr(elem,name,""),elem.removeAttribute(getSetAttribute?name:propName)},attrHooks:{type:{set:function(elem,value){if(!jQuery.support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),value!==undefined?hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var attributeNode=elem.getAttributeNode("tabindex");return attributeNode&&attributeNode.specified?parseInt(attributeNode.value,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:undefined}}}}),boolHook={get:function(elem,name){var prop=jQuery.prop(elem,name),attr="boolean"==typeof prop&&elem.getAttribute(name),detail="boolean"==typeof prop?getSetInput&&getSetAttribute?null!=attr:ruseDefault.test(name)?elem[jQuery.camelCase("default-"+name)]:!!attr:elem.getAttributeNode(name);return detail&&detail.value!==!1?name.toLowerCase():undefined},set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name):elem[jQuery.camelCase("default-"+name)]=elem[name]=!0,name}},getSetInput&&getSetAttribute||(jQuery.attrHooks.value={get:function(elem,name){var ret=elem.getAttributeNode(name);return jQuery.nodeName(elem,"input")?elem.defaultValue:ret&&ret.specified?ret.value:undefined},set:function(elem,value,name){return jQuery.nodeName(elem,"input")?void(elem.defaultValue=value):nodeHook&&nodeHook.set(elem,value,name)}}),getSetAttribute||(nodeHook=jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);return ret&&("id"===name||"name"===name||"coords"===name?""!==ret.value:ret.specified)?ret.value:undefined},set:function(elem,value,name){var ret=elem.getAttributeNode(name);return ret||elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name)),ret.value=value+="","value"===name||value===elem.getAttribute(name)?value:undefined}},jQuery.attrHooks.contenteditable={get:nodeHook.get,set:function(elem,value,name){nodeHook.set(elem,""===value?!1:value,name)}},jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{set:function(elem,value){return""===value?(elem.setAttribute(name,"auto"),value):void 0}})})),jQuery.support.hrefNormalized||(jQuery.each(["href","src","width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{get:function(elem){var ret=elem.getAttribute(name,2);return null==ret?undefined:ret}})}),jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}})),jQuery.support.style||(jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined},set:function(elem,value){return elem.style.cssText=value+""}}),jQuery.support.optSelected||(jQuery.propHooks.selected=jQuery.extend(jQuery.propHooks.selected,{get:function(elem){var parent=elem.parentNode;return parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex),null}})),jQuery.support.enctype||(jQuery.propFix.enctype="encoding"),jQuery.support.checkOn||jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={get:function(elem){return null===elem.getAttribute("value")?"on":elem.value}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]=jQuery.extend(jQuery.valHooks[this],{set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}})});var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(elemData){for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery===core_strundefined||e&&jQuery.event.triggered===e.type?undefined:jQuery.event.dispatch.apply(eventHandle.elem,arguments)},eventHandle.elem=elem),types=(types||"").match(core_rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||(elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent&&elem.attachEvent("on"+type,eventHandle))),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0;elem=null}},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(core_rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,jQuery._removeData(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=core_hasOwn.call(event,"type")?event.type:event,namespaces=core_hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=!0,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=undefined,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&jQuery.acceptData(cur)&&handle.apply&&handle.apply(cur,data)===!1&&event.preventDefault();if(event.type=type,!(onlyHandlers||event.isDefaultPrevented()||special._default&&special._default.apply(elem.ownerDocument,data)!==!1||"click"===type&&jQuery.nodeName(elem,"a")||!jQuery.acceptData(elem)||!ontype||!elem[type]||jQuery.isWindow(elem))){tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=undefined,tmp&&(elem[ontype]=tmp)}return event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=core_slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.namespace_re||event.namespace_re.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),ret!==undefined&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!=this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",matches[sel]===undefined&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=originalEvent.srcElement||document),3===event.target.nodeType&&(event.target=event.target.parentNode),event.metaKey=!!event.metaKey,fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),!event.relatedTarget&&fromElement&&(event.relatedTarget=fromElement===event.target?original.toElement:fromElement),event.which||button===undefined||(event.which=1&button?1:2&button?3:4&button?2:0),event}},special:{load:{noBubble:!0},click:{trigger:function(){return jQuery.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0}},focus:{trigger:function(){if(this!==document.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===document.activeElement&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},beforeunload:{postDispatch:function(event){event.result!==undefined&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)}:function(elem,type,handle){var name="on"+type;elem.detachEvent&&(typeof elem[name]===core_strundefined&&(elem[name]=null),elem.detachEvent(name,handle))},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||src.returnValue===!1||src.getPreventDefault&&src.getPreventDefault()?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.support.submitBubbles||(jQuery.event.special.submit={setup:function(){return jQuery.nodeName(this,"form")?!1:void jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;form&&!jQuery._data(form,"submitBubbles")&&(jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=!0}),jQuery._data(form,"submitBubbles",!0))})},postDispatch:function(event){event._submit_bubble&&(delete event._submit_bubble,this.parentNode&&!event.isTrigger&&jQuery.event.simulate("submit",this.parentNode,event,!0))},teardown:function(){return jQuery.nodeName(this,"form")?!1:void jQuery.event.remove(this,"._submit")}}),jQuery.support.changeBubbles||(jQuery.event.special.change={setup:function(){return rformElems.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(jQuery.event.add(this,"propertychange._change",function(event){"checked"===event.originalEvent.propertyName&&(this._just_changed=!0)}),jQuery.event.add(this,"click._change",function(event){this._just_changed&&!event.isTrigger&&(this._just_changed=!1),jQuery.event.simulate("change",this,event,!0)})),!1):void jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")&&(jQuery.event.add(elem,"change._change",function(event){!this.parentNode||event.isSimulated||event.isTrigger||jQuery.event.simulate("change",this.parentNode,event,!0)}),jQuery._data(elem,"changeBubbles",!0))})},handle:function(event){var elem=event.target;return this!==elem||event.isSimulated||event.isTrigger||"radio"!==elem.type&&"checkbox"!==elem.type?event.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return jQuery.event.remove(this,"._change"),!rformElems.test(this.nodeName)}}),jQuery.support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){0===attaches++&&document.addEventListener(orig,handler,!0)},teardown:function(){0===--attaches&&document.removeEventListener(orig,handler,!0)}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=undefined);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=undefined):null==fn&&("string"==typeof selector?(fn=data,data=undefined):(fn=data,data=selector,selector=undefined)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=undefined),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}}),function(window,undefined){function isNative(fn){return rnative.test(fn+"")}function createCache(){var cache,keys=[];return cache=function(key,value){return keys.push(key+=" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key]=value}}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return fn(div)}catch(e){return!1}finally{div=null}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(!documentIsXML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,slice.call(context.getElementsByTagName(selector),0)),results;if((m=match[3])&&support.getByClassName&&context.getElementsByClassName)return push.apply(results,slice.call(context.getElementsByClassName(m),0)),results}if(support.qsa&&!rbuggyQSA.test(selector)){if(old=!0,nid=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&context.parentNode||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,slice.call(newContext.querySelectorAll(newSelector),0)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function siblingCheck(a,b){var cur=b&&a,diff=cur&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));
for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var data,cache,outerCache,dirkey=dirruns+" "+doneName;if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),(cache=outerCache[dir])&&cache[0]===dirkey){if((data=cache[1])===!0||data===cachedruns)return data===!0}else if(cache=outerCache[dir]=[dirkey],cache[1]=matcher(elem,context,xml)||cachedruns,cache[1]===!0)return!0}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1)).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var matcherCachedRuns=0,bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,expandContext){var elem,j,matcher,setMatched=[],matchedCount=0,i="0",unmatched=seed&&[],outermost=null!=expandContext,contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",expandContext&&context.parentNode||context),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1;for(outermost&&(outermostContext=context!==document&&context,cachedruns=matcherCachedRuns);null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique,cachedruns=++matcherCachedRuns)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed&&1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&9===context.nodeType&&!documentIsXML&&Expr.relative[tokens[1].type]){if(context=Expr.find.ID(token.matches[0].replace(runescape,funescape),context)[0],!context)return results;selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&context.parentNode||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,slice.call(seed,0)),results;break}}return compile(selector,match)(seed,context,documentIsXML,results,rsibling.test(selector)),results}function setFilters(){}var i,cachedruns,Expr,getText,isXML,compile,hasDuplicate,outermostContext,setDocument,document,docElem,documentIsXML,rbuggyQSA,rbuggyMatches,matches,contains,sortOrder,expando="sizzle"+-new Date,preferredDoc=window.document,support={},dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),strundefined=typeof undefined,MAX_NEGATIVE=1<<31,arr=[],pop=arr.pop,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){for(var i=0,len=this.length;len>i;i++)if(this[i]===elem)return i;return-1},whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),operators="([*^$|!~]?=)",attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:"+operators+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([\\x20\\t\\r\\n\\f>+~])"+whitespace+"*"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),NAME:new RegExp("^\\[name=['\"]?("+characterEncoding+")['\"]?\\]"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rsibling=/[\x20\t\r\n\f]*[+~]/,rnative=/^[^{]+\{\s*\[native code/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rescape=/'|\\/g,rattributeQuotes=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,runescape=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,funescape=function(_,escaped){var high="0x"+escaped-65536;return high!==high?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)};try{slice.call(preferredDoc.documentElement.childNodes,0)[0].nodeType}catch(e){slice=function(i){for(var elem,results=[];elem=this[i++];)results.push(elem);return results}}isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsXML=isXML(doc),support.tagNameNoComments=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.attributes=assert(function(div){div.innerHTML="<select></select>";var type=typeof div.lastChild.getAttribute("multiple");return"boolean"!==type&&"string"!==type}),support.getByClassName=assert(function(div){return div.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",div.getElementsByClassName&&div.getElementsByClassName("e").length?(div.lastChild.className="e",2===div.getElementsByClassName("e").length):!1}),support.getByName=assert(function(div){div.id=expando+0,div.innerHTML="<a name='"+expando+"'></a><div name='"+expando+"'></div>",docElem.insertBefore(div,docElem.firstChild);var pass=doc.getElementsByName&&doc.getElementsByName(expando).length===2+doc.getElementsByName(expando+0).length;return support.getIdNotName=!doc.getElementById(expando),docElem.removeChild(div),pass}),Expr.attrHandle=assert(function(div){return div.innerHTML="<a href='#'></a>",div.firstChild&&typeof div.firstChild.getAttribute!==strundefined&&"#"===div.firstChild.getAttribute("href")})?{}:{href:function(elem){return elem.getAttribute("href",2)},type:function(elem){return elem.getAttribute("type")}},support.getIdNotName?(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&!documentIsXML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&!documentIsXML){var m=context.getElementById(id);return m?m.id===id||typeof m.getAttributeNode!==strundefined&&m.getAttributeNode("id").value===id?[m]:undefined:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.tagNameNoComments?function(tag,context){return typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.NAME=support.getByName&&function(tag,context){return typeof context.getElementsByName!==strundefined?context.getElementsByName(name):void 0},Expr.find.CLASS=support.getByClassName&&function(className,context){return typeof context.getElementsByClassName===strundefined||documentIsXML?void 0:context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[":focus"],(support.qsa=isNative(doc.querySelectorAll))&&(assert(function(div){div.innerHTML="<select><option selected=''></option></select>",div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked")}),assert(function(div){div.innerHTML="<input type='hidden' i=''/>",div.querySelectorAll("[i^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:\"\"|'')"),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=isNative(matches=docElem.matchesSelector||docElem.mozMatchesSelector||docElem.webkitMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=new RegExp(rbuggyQSA.join("|")),rbuggyMatches=new RegExp(rbuggyMatches.join("|")),contains=isNative(docElem.contains)||docElem.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=docElem.compareDocumentPosition?function(a,b){var compare;return a===b?(hasDuplicate=!0,0):(compare=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b))?1&compare||a.parentNode&&11===a.parentNode.nodeType?a===doc||contains(preferredDoc,a)?-1:b===doc||contains(preferredDoc,b)?1:0:4&compare?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(a===b)return hasDuplicate=!0,0;if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},hasDuplicate=!1,[0,0].sort(sortOrder),support.detectDuplicates=hasDuplicate,document):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),!(!support.matchesSelector||documentIsXML||rbuggyMatches&&rbuggyMatches.test(expr)||rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){var val;return(elem.ownerDocument||elem)!==document&&setDocument(elem),documentIsXML||(name=name.toLowerCase()),(val=Expr.attrHandle[name])?val(elem):documentIsXML||support.attributes?elem.getAttribute(name):((val=elem.getAttributeNode(name))||elem.getAttribute(name))&&elem[name]===!0?name:val&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],i=1,j=0;if(hasDuplicate=!support.detectDuplicates,results.sort(sortOrder),hasDuplicate){for(;elem=results[i];i++)elem===results[i-1]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i];i++)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[4]?match[2]=match[4]:unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeName){return"*"===nodeName?function(){return!0}:(nodeName=nodeName.replace(runescape,funescape).toLowerCase(),function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName})},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsXML?elem.getAttribute("xml:lang")||elem.getAttribute("lang"):elem.lang)return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeName>"@"||3===elem.nodeType||4===elem.nodeType)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||attr.toLowerCase()===elem.type)},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}};for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(group||(group=tokenize(selector)),i=group.length;i--;)cached=matcherFromTokens(group[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached},Expr.pseudos.nth=Expr.pseudos.eq,Expr.filters=setFilters.prototype=Expr.pseudos,Expr.setFilters=new setFilters,setDocument(),Sizzle.attr=jQuery.attr,jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains}(window);var runtil=/Until$/,rparentsprev=/^(?:parents|prev(?:Until|All))/,isSimple=/^.[^:#\[\.,]*$/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({find:function(selector){var i,ret,self,len=this.length;if("string"!=typeof selector)return self=this,this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(ret=[],i=0;len>i;i++)jQuery.find(selector,this[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=(this.selector?this.selector+" ":"")+selector,ret},has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;len>i;i++)if(jQuery.contains(this,targets[i]))return!0})},not:function(selector){return this.pushStack(winnow(this,selector,!1))},filter:function(selector){return this.pushStack(winnow(this,selector,!0))},is:function(selector){return!!selector&&("string"==typeof selector?rneedsContext.test(selector)?jQuery(selector,this.context).index(this[0])>=0:jQuery.filter(selector,this).length>0:this.filter(selector).length>0)},closest:function(selectors,context){for(var cur,i=0,l=this.length,ret=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur.ownerDocument&&cur!==context&&11!==cur.nodeType;){if(pos?pos.index(cur)>-1:jQuery.find.matchesSelector(cur,selectors)){ret.push(cur);break}cur=cur.parentNode}return this.pushStack(ret.length>1?jQuery.unique(ret):ret)},index:function(elem){return elem?"string"==typeof elem?jQuery.inArray(this[0],jQuery(elem)):jQuery.inArray(elem.jquery?elem[0]:elem,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){var set="string"==typeof selector?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(jQuery.unique(all))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.fn.andSelf=jQuery.fn.addBack,jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);return runtil.test(name)||(selector=until),selector&&"string"==typeof selector&&(ret=jQuery.filter(selector,ret)),ret=this.length>1&&!guaranteedUnique[name]?jQuery.unique(ret):ret,this.length>1&&rparentsprev.test(name)&&(ret=ret.reverse()),this.pushStack(ret)}}),jQuery.extend({filter:function(expr,elems,not){return not&&(expr=":not("+expr+")"),1===elems.length?jQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:jQuery.find.matches(expr,elems)},dir:function(elem,dir,until){for(var matched=[],cur=elem[dir];cur&&9!==cur.nodeType&&(until===undefined||1!==cur.nodeType||!jQuery(cur).is(until));)1===cur.nodeType&&matched.push(cur),cur=cur[dir];return matched},sibling:function(n,elem){for(var r=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&r.push(n);return r}});var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.fn.extend({text:function(value){return jQuery.access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstChild&&1===elem.firstChild.nodeType;)elem=elem.firstChild;return elem}).append(this)}return this},wrapInner:function(html){return this.each(jQuery.isFunction(html)?function(i){jQuery(this).wrapInner(html.call(this,i))}:function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(elem){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(elem)})},prepend:function(){return this.domManip(arguments,!0,function(elem){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(elem,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,!1,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,i=0;null!=(elem=this[i]);i++)(!selector||jQuery.filter(selector,[elem]).length>0)&&(keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem)));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++){for(1===elem.nodeType&&jQuery.cleanData(getAll(elem,!1));elem.firstChild;)elem.removeChild(elem.firstChild);
elem.options&&jQuery.nodeName(elem,"select")&&(elem.options.length=0)}return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return jQuery.access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined)return 1===elem.nodeType?elem.innerHTML.replace(rinlinejQuery,""):undefined;if(!("string"!=typeof value||rnoInnerhtml.test(value)||!jQuery.support.htmlSerialize&&rnoshimcache.test(value)||!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(value)||wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()])){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(value){var isFunc=jQuery.isFunction(value);return isFunc||"string"==typeof value||(value=jQuery(value).not(this).detach()),this.domManip([value],!0,function(elem){var next=this.nextSibling,parent=this.parentNode;parent&&(jQuery(this).remove(),parent.insertBefore(elem,next))})},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,table,callback){args=core_concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||!(1>=l||"string"!=typeof value||jQuery.support.checkClone)&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,table?self.html():undefined)),self.domManip(args,table,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(table=table&&jQuery.nodeName(first,"tr"),scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(table&&jQuery.nodeName(this[i],"table")?findOrAppend(this[i],"tbody"):this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery.ajax({url:node.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,"")));fragment=first=null}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),core_push.apply(ret,elems.get());return this.pushStack(ret)}}),jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(jQuery.support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")?clone=elem.cloneNode(!0):(fragmentDiv.innerHTML=elem.outerHTML,fragmentDiv.removeChild(clone=fragmentDiv.firstChild)),!(jQuery.support.noCloneEvent&&jQuery.support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0;null!=(node=srcElements[i]);++i)destElements[i]&&fixCloneNodeIssues(node,destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0;null!=(node=srcElements[i]);i++)cloneCopyEvent(node,destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),destElements=srcElements=node=null,clone},buildFragment:function(elems,context,scripts,selection){for(var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||safe.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)&&nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0])),!jQuery.support.tbody)for(elem="table"!==tag||rtbody.test(elem)?"<table>"!==wrap[1]||rtbody.test(elem)?0:tmp:tmp.firstChild,j=elem&&elem.childNodes.length;j--;)jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length&&elem.removeChild(tbody);for(jQuery.merge(nodes,tmp.childNodes),tmp.textContent="";tmp.firstChild;)tmp.removeChild(tmp.firstChild);tmp=safe.lastChild}else nodes.push(context.createTextNode(elem));for(tmp&&safe.removeChild(tmp),jQuery.support.appendChecked||jQuery.grep(getAll(nodes,"input"),fixDefaultChecked),i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(safe.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return tmp=null,safe},cleanData:function(elems,acceptData){for(var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=jQuery.support.deleteExpando,special=jQuery.event.special;null!=(elem=elems[i]);i++)if((acceptData||jQuery.acceptData(elem))&&(id=elem[internalKey],data=id&&cache[id])){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);cache[id]&&(delete cache[id],deleteExpando?delete elem[internalKey]:typeof elem.removeAttribute!==core_strundefined?elem.removeAttribute(internalKey):elem[internalKey]=null,core_deletedIds.push(id))}}});var iframe,getStyles,curCSS,ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rposition=/^(top|right|bottom|left)$/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];jQuery.fn.extend({css:function(name,value){return jQuery.access(this,function(elem,name,value){var len,styles,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){var bool="boolean"==typeof state;return this.each(function(){(bool?state:isHidden(this))?jQuery(this).show():jQuery(this).hide()})}}),jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;if(name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],value===undefined)return hooks&&"get"in hooks&&(ret=hooks.get(elem,!1,extra))!==undefined?ret:style[name];if(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),!(null==value||"number"===type&&isNaN(value)||("number"!==type||jQuery.cssNumber[origName]||(value+="px"),jQuery.support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&(value=hooks.set(elem,value,extra))===undefined)))try{style[name]=value}catch(e){}}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),val===undefined&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val},swap:function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret}}),window.getComputedStyle?(getStyles=function(elem){return window.getComputedStyle(elem,null)},curCSS=function(elem,name,_computed){var width,minWidth,maxWidth,computed=_computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:undefined,style=elem.style;return computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),ret}):document.documentElement.currentStyle&&(getStyles=function(elem){return elem.currentStyle},curCSS=function(elem,name,_computed){var left,rs,rsLeft,computed=_computed||getStyles(elem),ret=computed?computed[name]:undefined,style=elem.style;return null==ret&&style&&style[name]&&(ret=style[name]),rnumnonpx.test(ret)&&!rposition.test(name)&&(left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rsLeft&&(rs.left=elem.currentStyle.left),style.left="fontSize"===name?"1em":ret,ret=style.pixelLeft+"px",style.left=left,rsLeft&&(rs.left=rsLeft)),""===ret?"auto":ret}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?0===elem.offsetWidth&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),jQuery.support.opacity||(jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+100*value+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1,(value>=1||""===value)&&""===jQuery.trim(filter.replace(ralpha,""))&&style.removeAttribute&&(style.removeAttribute("filter"),""===value||currentStyle&&!currentStyle.filter)||(style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity)}}),jQuery(function(){jQuery.support.reliableMarginRight||(jQuery.cssHooks.marginRight={get:function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}}),!jQuery.support.pixelPosition&&jQuery.fn.position&&jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]={get:function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0}}})}),jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!jQuery.support.reliableHiddenOffsets&&"none"===(elem.style&&elem.style.display||jQuery.css(elem,"display"))},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!manipulation_rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.hover=function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)};var ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,response,type,self=this,off=url.indexOf(" ");return off>=0&&(selector=url.slice(off,url.length),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=undefined):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=undefined),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":window.String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=undefined,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),status>=200&&300>status||304===status?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status?(isSuccess=!0,statusText="nocontent"):304===status?(isSuccess=!0,statusText="notmodified"):(isSuccess=ajaxConvert(s,response),statusText=isSuccess.state,success=isSuccess.data,error=isSuccess.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=undefined,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=undefined),options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(core_rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?80:443))==(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?80:443)))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(ajax_rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+ajax_nonce++):cacheURL+(ajax_rquery.test(cacheURL)?"&":"?")+"_="+ajax_nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){s.cache===undefined&&(s.cache=!1),s.crossDomain&&(s.type="GET",s.global=!1)}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script"),script.async=!0,s.scriptCharset&&(script.charset=s.scriptCharset),script.src=s.url,script.onload=script.onreadystatechange=function(_,isAbort){(isAbort||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),script=null,isAbort||callback(200,"success"))},head.insertBefore(script,head.firstChild)},abort:function(){script&&script.onload(undefined,!0)}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+ajax_nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(ajax_rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=undefined}),"script"):void 0});var xhrCallbacks,xhrSupported,xhrId=0,xhrOnUnloadAbort=window.ActiveXObject&&function(){var key;for(key in xhrCallbacks)xhrCallbacks[key](undefined,!0)};jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||createActiveXHR()}:createStandardXHR,xhrSupported=jQuery.ajaxSettings.xhr(),jQuery.support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,xhrSupported=jQuery.support.ajax=!!xhrSupported,xhrSupported&&jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var handle,i,xhr=s.xhr();if(s.username?xhr.open(s.type,s.url,s.async,s.username,s.password):xhr.open(s.type,s.url,s.async),s.xhrFields)for(i in s.xhrFields)xhr[i]=s.xhrFields[i];s.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(s.mimeType),s.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");try{for(i in headers)xhr.setRequestHeader(i,headers[i])}catch(err){}xhr.send(s.hasContent&&s.data||null),callback=function(_,isAbort){var status,responseHeaders,statusText,responses;try{if(callback&&(isAbort||4===xhr.readyState))if(callback=undefined,handle&&(xhr.onreadystatechange=jQuery.noop,xhrOnUnloadAbort&&delete xhrCallbacks[handle]),isAbort)4!==xhr.readyState&&xhr.abort();else{responses={},status=xhr.status,responseHeaders=xhr.getAllResponseHeaders(),"string"==typeof xhr.responseText&&(responses.text=xhr.responseText);try{statusText=xhr.statusText}catch(e){statusText=""}status||!s.isLocal||s.crossDomain?1223===status&&(status=204):status=responses.text?200:404}}catch(firefoxAccessException){isAbort||complete(-1,firefoxAccessException)}responses&&complete(status,statusText,responses,responseHeaders)},s.async?4===xhr.readyState?setTimeout(callback):(handle=++xhrId,xhrOnUnloadAbort&&(xhrCallbacks||(xhrCallbacks={},jQuery(window).unload(xhrOnUnloadAbort)),xhrCallbacks[handle]=callback),xhr.onreadystatechange=callback):callback()},abort:function(){callback&&callback(undefined,!0)}}}});var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var end,unit,tween=this.createTween(prop,value),parts=rfxnum.exec(value),target=tween.cur(),start=+target||0,scale=1,maxIterations=20;if(parts){if(end=+parts[2],unit=parts[3]||(jQuery.cssNumber[prop]?"":"px"),"px"!==unit&&start){start=jQuery.css(tween.elem,prop,!0)||end||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}tween.unit=unit,tween.start=start,tween.end=parts[1]?start+(parts[1]+1)*end:end}return tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.pos=eased=this.options.duration?jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);doAnimation.finish=function(){anim.stop(!0)},(empty||jQuery._data(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=undefined),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.cur&&hooks.cur.finish&&hooks.cur.finish.call(this),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);
delete data.finish})}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.timers=[],jQuery.fx=Tween.prototype.init,jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=undefined},jQuery.fx.timer=function(timer){timer()&&jQuery.timers.push(timer)&&jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fx.step={},jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}),jQuery.fn.offset=function(options){if(arguments.length)return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==core_strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):box},jQuery.offset={setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");"static"===position&&(elem.style.position="relative");var curTop,curLeft,curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={};calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({position:function(){if(this[0]){var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||document.documentElement;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||document.documentElement})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return jQuery.access(this,function(elem,method,val){var win=getWindow(elem);return val===undefined?win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]:void(win?win.scrollTo(top?jQuery(win).scrollLeft():val,top?val:jQuery(win).scrollTop()):elem[method]=val)},method,val,arguments.length,null)}}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return jQuery.access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})}),window.jQuery=window.$=jQuery,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return jQuery})}(window),function(window,document,undefined){"use strict";function minErr(module,ErrorConstructor){return ErrorConstructor=ErrorConstructor||Error,function(){var message,i,code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments;for(message=prefix+template.replace(/\{\d+\}/g,function(match){var index=+match.slice(1,-1);return index+2<templateArgs.length?toDebugString(templateArgs[index+2]):match}),message=message+"\nhttp://errors.angularjs.org/1.3.13/"+(module?module+"/":"")+code,i=2;i<arguments.length;i++)message=message+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(toDebugString(arguments[i]));return new ErrorConstructor(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;var length=obj.length;return obj.nodeType===NODE_TYPE_ELEMENT&&length?!0:isString(obj)||isArray(obj)||0===length||"number"==typeof length&&length>0&&length-1 in obj}function forEach(obj,iterator,context){var key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key,obj);else if(isArray(obj)||isArrayLike(obj)){var isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;length>key;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);return obj}function sortedKeys(obj){return Object.keys(obj).sort()}function forEachSorted(obj,iterator,context){for(var keys=sortedKeys(obj),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){return++uid}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function extend(dst){for(var h=dst.$$hashKey,i=1,ii=arguments.length;ii>i;i++){var obj=arguments[i];if(obj)for(var keys=Object.keys(obj),j=0,jj=keys.length;jj>j;j++){var key=keys[j];dst[key]=obj[key]}}return setHashKey(dst,h),dst}function int(str){return parseInt(str,10)}function inherit(parent,extra){return extend(Object.create(parent),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!==value&&"object"==typeof value}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.window===obj}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isFormData(obj){return"[object FormData]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isBoolean(value){return"boolean"==typeof value}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function nodeName_(element){return lowercase(element.nodeName||element[0]&&element[0].nodeName)}function arrayRemove(array,value){var index=array.indexOf(value);return index>=0&&array.splice(index,1),value}function copy(source,destination,stackSource,stackDest){if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(destination){if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");if(stackSource=stackSource||[],stackDest=stackDest||[],isObject(source)){var index=stackSource.indexOf(source);if(-1!==index)return stackDest[index];stackSource.push(source),stackDest.push(destination)}var result;if(isArray(source)){destination.length=0;for(var i=0;i<source.length;i++)result=copy(source[i],null,stackSource,stackDest),isObject(source[i])&&(stackSource.push(source[i]),stackDest.push(result)),destination.push(result)}else{var h=destination.$$hashKey;isArray(destination)?destination.length=0:forEach(destination,function(value,key){delete destination[key]});for(var key in source)source.hasOwnProperty(key)&&(result=copy(source[key],null,stackSource,stackDest),isObject(source[key])&&(stackSource.push(source[key]),stackDest.push(result)),destination[key]=result);setHashKey(destination,h)}}else if(destination=source,source)if(isArray(source))destination=copy(source,[],stackSource,stackDest);else if(isDate(source))destination=new Date(source.getTime());else if(isRegExp(source))destination=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]),destination.lastIndex=source.lastIndex;else if(isObject(source)){var emptyObject=Object.create(Object.getPrototypeOf(source));destination=copy(source,emptyObject,stackSource,stackDest)}return destination}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;ii>i;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)("$"!==key.charAt(0)||"$"!==key.charAt(1))&&(dst[key]=src[key])}return dst||src}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)?equals(o1.getTime(),o2.getTime()):!1;if(isRegExp(o1)&&isRegExp(o2))return o1.toString()==o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2))return!1;keySet={};for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!keySet.hasOwnProperty(key)&&"$"!==key.charAt(0)&&o2[key]!==undefined&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,concat(curryArgs,arguments,0)):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)&&"$"===key.charAt(1)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return"undefined"==typeof obj?undefined:(isNumber(pretty)||(pretty=pretty?2:null),JSON.stringify(obj,toJsonReplacer,pretty))}function fromJson(json){return isString(json)?JSON.parse(json):json}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===NODE_TYPE_TEXT?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var key_value,key,obj={};return forEach((keyValue||"").split("&"),function(keyValue){if(keyValue&&(key_value=keyValue.replace(/\+/g,"%20").split("="),key=tryDecodeURIComponent(key_value[0]),isDefined(key))){var val=isDefined(key_value[1])?tryDecodeURIComponent(key_value[1]):!0;hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val}}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function getNgAttribute(element,ngAttr){var attr,i,ii=ngAttrPrefixes.length;for(element=jqLite(element),i=0;ii>i;++i)if(attr=ngAttrPrefixes[i]+ngAttr,isString(attr=element.attr(attr)))return attr;return null}function angularInit(element,bootstrap){var appElement,module,config={};forEach(ngAttrPrefixes,function(prefix){var name=prefix+"app";!appElement&&element.hasAttribute&&element.hasAttribute(name)&&(appElement=element,module=element.getAttribute(name))}),forEach(ngAttrPrefixes,function(prefix){var candidate,name=prefix+"app";!appElement&&(candidate=element.querySelector("["+name.replace(":","\\:")+"]"))&&(appElement=candidate,module=candidate.getAttribute(name))}),appElement&&(config.strictDi=null!==getNgAttribute(appElement,"strict-di"),bootstrap(appElement,module?[module]:[],config))}function bootstrap(element,modules,config){isObject(config)||(config={});var defaultConfig={strictDi:!1};config=extend(defaultConfig,config);var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===document?"document":startingTag(element);throw ngMinErr("btstrpd","App Already Bootstrapped with this Element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),config.debugInfoEnabled&&modules.push(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!0)}]),modules.unshift("ng");var injector=createInjector(modules,config.strictDi);return injector.invoke(["$rootScope","$rootElement","$compile","$injector",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_ENABLE_DEBUG_INFO=/^NG_ENABLE_DEBUG_INFO!/,NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&NG_ENABLE_DEBUG_INFO.test(window.name)&&(config.debugInfoEnabled=!0,window.name=window.name.replace(NG_ENABLE_DEBUG_INFO,"")),window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){return forEach(extraModules,function(module){modules.push(module)}),doBootstrap()},void(isFunction(angular.resumeDeferredBootstrap)&&angular.resumeDeferredBootstrap()))}function reloadWithDebugInfo(){window.name="NG_ENABLE_DEBUG_INFO!"+window.name,window.location.reload()}function getTestability(rootElement){var injector=angular.element(rootElement).injector();if(!injector)throw ngMinErr("test","no injector found for element argument to getTestability");return injector.get("$$testability")}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){var originalCleanData;bindJQueryFired||(jQuery=window.jQuery,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),originalCleanData=jQuery.cleanData,jQuery.cleanData=function(elems){var events;if(skipDestroyOnNextJQueryCleanData)skipDestroyOnNextJQueryCleanData=!1;else for(var elem,i=0;null!=(elem=elems[i]);i++)events=jQuery._data(elem,"events"),events&&events.$destroy&&jQuery(elem).triggerHandler("$destroy");originalCleanData(elems)}):jqLite=JQLite,angular.element=jqLite,bindJQueryFired=!0)}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockNodes(nodes){var node=nodes[0],endNode=nodes[nodes.length-1],blockNodes=[node];do{if(node=node.nextSibling,!node)break;blockNodes.push(node)}while(node!==endNode);return jqLite(blockNodes)}function createMap(){return Object.create(null)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod,queue){return queue||(queue=invokeQueue),function(){return queue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],configBlocks=[],runBlocks=[],config=invokeLater("$injector","invoke","push",configBlocks),moduleInstance={_invokeQueue:invokeQueue,_configBlocks:configBlocks,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLater("$provide","provider"),factory:invokeLater("$provide","factory"),service:invokeLater("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),animation:invokeLater("$animateProvider","register"),filter:invokeLater("$filterProvider","register"),controller:invokeLater("$controllerProvider","register"),directive:invokeLater("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function serializeObject(obj){var seen=[];return JSON.stringify(obj,function(key,val){if(val=toJsonReplacer(key,val),isObject(val)){if(seen.indexOf(val)>=0)return"<<already seen>>";seen.push(val)}return val})}function toDebugString(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof obj?"undefined":"string"!=typeof obj?serializeObject(obj):obj}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0},getTestability:getTestability,$$minErr:minErr,$$csp:csp,reloadWithDebugInfo:reloadWithDebugInfo}),angularModule=setupModuleLoader(window);try{angularModule("ngLocale")}catch(e){angularModule("ngLocale",[]).provider("$locale",$LocaleProvider)}angularModule("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,pattern:patternDirective,ngPattern:patternDirective,required:requiredDirective,ngRequired:requiredDirective,minlength:minlengthDirective,ngMinlength:minlengthDirective,maxlength:maxlengthDirective,ngMaxlength:maxlengthDirective,ngValue:ngValueDirective,ngModelOptions:ngModelOptionsDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpBackend:$HttpBackendProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$$q:$$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$templateRequest:$TemplateRequestProvider,$$testability:$$TestabilityProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$asyncCallback:$$AsyncCallbackProvider,$$jqLite:$$jqLiteProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteAcceptsData(node){var nodeType=node.nodeType;return nodeType===NODE_TYPE_ELEMENT||!nodeType||nodeType===NODE_TYPE_DOCUMENT}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],i=wrap[0];i--;)tmp=tmp.lastChild;nodes=concat(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",forEach(nodes,function(node){fragment.appendChild(node)}),fragment}function jqLiteParseHTML(html,context){context=context||document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:(parsed=jqLiteBuildFragment(html,context))?parsed.childNodes:[]}function JQLite(element){if(element instanceof JQLite)return element;var argIsString;if(isString(element)&&(element=trim(element),argIsString=!0),!(this instanceof JQLite)){if(argIsString&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}argIsString?jqLiteAddNodes(this,jqLiteParseHTML(element)):jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element,onlyDescendants){if(onlyDescendants||jqLiteRemoveData(element),element.querySelectorAll)for(var descendants=element.querySelectorAll("*"),i=0,l=descendants.length;l>i;i++)jqLiteRemoveData(descendants[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,handle=expandoStore&&expandoStore.handle;if(handle)if(type)forEach(type.split(" "),function(type){if(isDefined(fn)){var listenerFns=events[type];if(arrayRemove(listenerFns||[],fn),listenerFns&&listenerFns.length>0)return}removeEventListenerFn(element,type,handle),delete events[type]});else for(type in events)"$destroy"!==type&&removeEventListenerFn(element,type,handle),delete events[type]}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];if(expandoStore){if(name)return void delete expandoStore.data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=undefined}}function jqLiteExpandoStore(element,createIfNecessary){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];return createIfNecessary&&!expandoStore&&(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={events:{},data:{},handle:undefined}),expandoStore}function jqLiteData(element,key,value){if(jqLiteAcceptsData(element)){var isSimpleSetter=isDefined(value),isSimpleGetter=!isSimpleSetter&&key&&!isObject(key),massGetter=!key,expandoStore=jqLiteExpandoStore(element,!isSimpleGetter),data=expandoStore&&expandoStore.data;if(isSimpleSetter)data[key]=value;else{if(massGetter)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}}function jqLiteHasClass(element,selector){return element.getAttribute?(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1:!1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===existingClasses.indexOf(" "+cssClass+" ")&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements)if(elements.nodeType)root[root.length++]=elements;else{var length=elements.length;if("number"==typeof length&&elements.window!==elements){if(length)for(var i=0;length>i;i++)root[root.length++]=elements[i]}else root[root.length++]=elements}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element.nodeType==NODE_TYPE_DOCUMENT&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;ii>i;i++)if((value=jqLite.data(element,names[i]))!==undefined)return value;element=element.parentNode||element.nodeType===NODE_TYPE_DOCUMENT_FRAGMENT&&element.host}}function jqLiteEmpty(element){for(jqLiteDealoc(element,!0);element.firstChild;)element.removeChild(element.firstChild)}function jqLiteRemove(element,keepData){keepData||jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)}function jqLiteDocumentLoaded(action,win){win=win||window,"complete"===win.document.readyState?win.setTimeout(action):jqLite(win).on("load",action)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[nodeName_(element)]&&booleanAttr}function getAliasedAttrName(element,name){var nodeName=element.nodeName;return("INPUT"===nodeName||"TEXTAREA"===nodeName)&&ALIASED_ATTR[name]}function createEventHandler(element,events){var eventHandler=function(event,type){event.isDefaultPrevented=function(){return event.defaultPrevented};var eventFns=events[type||event.type],eventFnsLength=eventFns?eventFns.length:0;if(eventFnsLength){if(isUndefined(event.immediatePropagationStopped)){var originalStopImmediatePropagation=event.stopImmediatePropagation;event.stopImmediatePropagation=function(){event.immediatePropagationStopped=!0,event.stopPropagation&&event.stopPropagation(),originalStopImmediatePropagation&&originalStopImmediatePropagation.call(event)}}event.isImmediatePropagationStopped=function(){return event.immediatePropagationStopped===!0},eventFnsLength>1&&(eventFns=shallowCopy(eventFns));for(var i=0;eventFnsLength>i;i++)event.isImmediatePropagationStopped()||eventFns[i].call(element,event)}};return eventHandler.elem=element,eventHandler}function $$jqLiteProvider(){this.$get=function(){return extend(JQLite,{hasClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteHasClass(node,classes)},addClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteAddClass(node,classes)},removeClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteRemoveClass(node,classes)}})}}function hashKey(obj,nextUidFn){var key=obj&&obj.$$hashKey;if(key)return"function"==typeof key&&(key=obj.$$hashKey()),key;var objType=typeof obj;return key="function"==objType||"object"==objType&&null!==obj?obj.$$hashKey=objType+":"+(nextUidFn||nextUid)():objType+":"+obj}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function anonFn(fn){var fnText=fn.toString().replace(STRIP_COMMENTS,""),args=fnText.match(FN_ARGS);return args?"function("+(args[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function annotate(fn,strictDi,name){var $inject,fnText,argDecl,last;if("function"==typeof fn){if(!($inject=fn.$inject)){if($inject=[],fn.length){if(strictDi)throw isString(name)&&name||(name=fn.name||anonFn(fn)),$injectorMinErr("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",name);
fnText=fn.toString().replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})}fn.$inject=$inject}}else isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0);return $inject}function createInjector(modulesToLoad,strictDi){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function enforceReturnValue(name,factory){return function(){var result=instanceInjector.invoke(factory,this);if(isUndefined(result))throw $injectorMinErr("undef","Provider '{0}' must return a value from $get factory method.",name);return result}}function factory(name,factoryFn,enforce){return provider(name,{$get:enforce!==!1?enforceReturnValue(name,factoryFn):factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val),!1)}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){var moduleFn,runBlocks=[];return forEach(modulesToLoad,function(module){function runInvokeQueue(queue){var i,ii;for(i=0,ii=queue.length;ii>i;i++){var invokeArgs=queue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}if(!loadedModules.get(module)){loadedModules.put(module,!0);try{isString(module)?(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),runInvokeQueue(moduleFn._invokeQueue),runInvokeQueue(moduleFn._configBlocks)):isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName,caller){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName,caller)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function invoke(fn,self,locals,serviceName){"string"==typeof locals&&(serviceName=locals,locals=null);var length,i,key,args=[],$inject=createInjector.$$annotate(fn,strictDi,serviceName);for(i=0,length=$inject.length;length>i;i++){if(key=$inject[i],"string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key,serviceName))}return isArray(fn)&&(fn=fn[length]),fn.apply(self,args)}function instantiate(Type,locals,serviceName){var instance=Object.create((isArray(Type)?Type[Type.length-1]:Type).prototype||null),returnedValue=invoke(Type,instance,locals,serviceName);return isObject(returnedValue)||isFunction(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:createInjector.$$annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}strictDi=strictDi===!0;var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],!0),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(serviceName,caller){throw angular.isString(caller)&&path.push(caller),$injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(serviceName,caller){var provider=providerInjector.get(serviceName+providerSuffix,caller);return instanceInjector.invoke(provider.$get,provider,undefined,serviceName)});return forEach(loadModules(modulesToLoad),function(fn){instanceInjector.invoke(fn||noop)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return Array.prototype.some.call(list,function(element){return"a"===nodeName_(element)?(result=element,!0):void 0}),result}function getYOffset(){var offset=scroll.yOffset;if(isFunction(offset))offset=offset();else if(isElement(offset)){var elem=offset[0],style=$window.getComputedStyle(elem);offset="fixed"!==style.position?0:elem.getBoundingClientRect().bottom}else isNumber(offset)||(offset=0);return offset}function scrollTo(elem){if(elem){elem.scrollIntoView();var offset=getYOffset();if(offset){var elemTop=elem.getBoundingClientRect().top;$window.scrollBy(0,elemTop-offset)}}else $window.scrollTo(0,0)}function scroll(){var elm,hash=$location.hash();hash?(elm=document.getElementById(hash))?scrollTo(elm):(elm=getFirstAnchor(document.getElementsByName(hash)))?scrollTo(elm):"top"===hash&&scrollTo(null):scrollTo(null)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(newVal,oldVal){(newVal!==oldVal||""!==newVal)&&jqLiteDocumentLoaded(function(){$rootScope.$evalAsync(scroll)})}),scroll}]}function $$AsyncCallbackProvider(){this.$get=["$$rAF","$timeout",function($$rAF,$timeout){return $$rAF.supported?function(fn){return $$rAF(fn)}:function(fn){return $timeout(fn,0,!1)}}]}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function getHash(url){var index=url.indexOf("#");return-1===index?"":url.substr(index+1)}function startPoller(interval,setTimeout){!function check(){forEach(pollFns,function(pollFn){pollFn()}),pollTimeout=setTimeout(check,interval)}()}function cacheStateAndFireUrlChange(){cacheState(),fireUrlChange()}function cacheState(){cachedState=window.history.state,cachedState=isUndefined(cachedState)?null:cachedState,equals(cachedState,lastCachedState)&&(cachedState=lastCachedState),lastCachedState=cachedState}function fireUrlChange(){(lastBrowserUrl!==self.url()||lastHistoryState!==cachedState)&&(lastBrowserUrl=self.url(),lastHistoryState=cachedState,forEach(urlChangeListeners,function(listener){listener(self.url(),cachedState)}))}function safeDecodeURIComponent(str){try{return decodeURIComponent(str)}catch(e){return str}}var self=this,rawDocument=document[0],location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){forEach(pollFns,function(pollFn){pollFn()}),0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var pollTimeout,pollFns=[];self.addPollFn=function(fn){return isUndefined(pollTimeout)&&startPoller(100,setTimeout),pollFns.push(fn),fn};var cachedState,lastHistoryState,lastBrowserUrl=location.href,baseElement=document.find("base"),reloadLocation=null;cacheState(),lastHistoryState=cachedState,self.url=function(url,replace,state){if(isUndefined(state)&&(state=null),location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){var sameState=lastHistoryState===state;if(lastBrowserUrl===url&&(!$sniffer.history||sameState))return self;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,lastHistoryState=state,!$sniffer.history||sameBase&&sameState?(sameBase||(reloadLocation=url),replace?location.replace(url):sameBase?location.hash=getHash(url):location.href=url):(history[replace?"replaceState":"pushState"](state,"",url),cacheState(),lastHistoryState=cachedState),self}return reloadLocation||location.href.replace(/%27/g,"'")},self.state=function(){return cachedState};var urlChangeListeners=[],urlChangeInit=!1,lastCachedState=null;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",cacheStateAndFireUrlChange),jqLite(window).on("hashchange",cacheStateAndFireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var lastCookies={},lastCookieString="",cookiePath=self.baseHref();self.cookies=function(name,value){var cookieLength,cookieArray,cookie,i,index;if(!name){if(rawDocument.cookie!==lastCookieString)for(lastCookieString=rawDocument.cookie,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=safeDecodeURIComponent(cookie.substring(0,index)),lastCookies[name]===undefined&&(lastCookies[name]=safeDecodeURIComponent(cookie.substring(index+1))));return lastCookies}value===undefined?rawDocument.cookie=encodeURIComponent(name)+"=;path="+cookiePath+";expires=Thu, 01 Jan 1970 00:00:00 GMT":isString(value)&&(cookieLength=(rawDocument.cookie=encodeURIComponent(name)+"="+encodeURIComponent(value)+";path="+cookiePath).length+1,cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"))},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data={},capacity=options&&options.capacity||Number.MAX_VALUE,lruHash={},freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}if(!isUndefined(value))return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}delete data[key],size--},removeAll:function(){data={},size=0,lruHash={},freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function $CompileProvider($provide,$$sanitizeUriProvider){function parseIsolateBindings(scope,directiveName){var LOCAL_REGEXP=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,bindings={};return forEach(scope,function(definition,scopeName){var match=definition.match(LOCAL_REGEXP);if(!match)throw $compileMinErr("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",directiveName,scopeName,definition);bindings[scopeName]={mode:match[1][0],collection:"*"===match[2],optional:"?"===match[3],attrName:match[4]||scopeName}}),bindings}var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\w\-]+)(?:\:([^;]+))?;?)/,ALL_OR_NOTHING_ATTRS=makeMap("ngSrc,ngSrcset,src,srcset"),REQUIRE_PREFIX_REGEXP=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/;this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"EA",isObject(directive.scope)&&(directive.$$isolateBindings=parseIsolateBindings(directive.scope,directive.name)),directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()};var debugInfoEnabled=!0;this.debugInfoEnabled=function(enabled){return isDefined(enabled)?(debugInfoEnabled=enabled,this):debugInfoEnabled},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$templateRequest,$parse,$controller,$rootScope,$document,$sce,$animate,$$sanitizeUri){function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes)),forEach($compileNodes,function(node,index){node.nodeType==NODE_TYPE_TEXT&&node.nodeValue.match(/\S+/)&&($compileNodes[index]=jqLite(node).wrap("<span></span>").parent()[0])});var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);compile.$$addScopeClass($compileNodes);var namespace=null;return function(scope,cloneConnectFn,options){assertArg(scope,"scope"),options=options||{};var parentBoundTranscludeFn=options.parentBoundTranscludeFn,transcludeControllers=options.transcludeControllers,futureParentElement=options.futureParentElement;parentBoundTranscludeFn&&parentBoundTranscludeFn.$$boundTransclude&&(parentBoundTranscludeFn=parentBoundTranscludeFn.$$boundTransclude),namespace||(namespace=detectNamespaceForChildElements(futureParentElement));var $linkNode;if($linkNode="html"!==namespace?jqLite(wrapTemplate(namespace,jqLite("<div>").append($compileNodes).html())):cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,transcludeControllers)for(var controllerName in transcludeControllers)$linkNode.data("$"+controllerName+"Controller",transcludeControllers[controllerName].instance);return compile.$$addScopeInfo($linkNode,scope),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function detectNamespaceForChildElements(parentElement){var node=parentElement&&parentElement[0];return node&&"foreignobject"!==nodeName_(node)&&node.toString().match(/SVG/)?"svg":"html"}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,idx,childBoundTranscludeFn,stableNodeList;if(nodeLinkFnFound){var nodeListLength=nodeList.length;for(stableNodeList=new Array(nodeListLength),i=0;i<linkFns.length;i+=3)idx=linkFns[i],stableNodeList[idx]=nodeList[idx]}else stableNodeList=nodeList;for(i=0,ii=linkFns.length;ii>i;)node=stableNodeList[linkFns[i++]],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),compile.$$addScopeInfo(jqLite(node),childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn,nodeLinkFn.elementTranscludeOnThisElement):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,undefined,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,nodeLinkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:undefined,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&compile.$$addScopeClass(attrs.$$element),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),(nodeLinkFn||childLinkFn)&&(linkFns.push(i,nodeLinkFn,childLinkFn),linkFnFound=!0,nodeLinkFnFound=nodeLinkFnFound||nodeLinkFn),previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){var boundTranscludeFn=function(transcludedScope,cloneFn,controllers,futureParentElement,containingScope){return transcludedScope||(transcludedScope=scope.$new(!1,containingScope),transcludedScope.$$transcluded=!0),transcludeFn(transcludedScope,cloneFn,{parentBoundTranscludeFn:previousBoundTranscludeFn,transcludeControllers:controllers,futureParentElement:futureParentElement})};return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case NODE_TYPE_ELEMENT:addDirective(directives,directiveNormalize(nodeName_(node)),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName=!1,attrEndName=!1;attr=nAttrs[j],name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),(isNgAttr=NG_ATTR_BINDING.test(ngAttrName))&&(name=name.replace(PREFIX_REGEXP,"").substr(8).replace(/_(.)/g,function(match,letter){return letter.toUpperCase()}));var directiveNName=ngAttrName.replace(/(Start|End)$/,"");directiveIsMultiElement(directiveNName)&&ngAttrName===directiveNName+"Start"&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,(isNgAttr||!attrs.hasOwnProperty(nName))&&(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName,isNgAttr),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}if(className=node.className,isObject(className)&&(className=className.animVal),isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case NODE_TYPE_TEXT:addTextInterpolateDirective(directives,node.nodeValue);break;case NODE_TYPE_COMMENT:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);node.nodeType==NODE_TYPE_ELEMENT&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function getControllers(directiveName,require,$element,elementControllers){var value,match,retrievalMethod="data",optional=!1,$searchElement=$element;if(isString(require)){if(match=require.match(REQUIRE_PREFIX_REGEXP),require=require.substring(match[0].length),match[3]&&(match[1]?match[3]=null:match[1]=match[3]),"^"===match[1]?retrievalMethod="inheritedData":"^^"===match[1]&&(retrievalMethod="inheritedData",$searchElement=$element.parent()),"?"===match[2]&&(optional=!0),value=null,elementControllers&&"data"===retrievalMethod&&(value=elementControllers[require])&&(value=value.instance),value=value||$searchElement[retrievalMethod]("$"+require+"Controller"),!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",require,directiveName);return value||null}return isArray(require)&&(value=[],forEach(require,function(require){value.push(getControllers(directiveName,require,$element,elementControllers))})),value}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn,futureParentElement){var transcludeControllers;return isScope(scope)||(futureParentElement=cloneAttachFn,cloneAttachFn=scope,scope=undefined),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),futureParentElement||(futureParentElement=hasElementTranscludeDirective?$element.parent():$element),boundTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild)}var i,ii,linkFn,controller,isolateScope,elementControllers,transcludeFn,$element,attrs;if(compileNode===linkNode?(attrs=templateAttrs,$element=templateAttrs.$$element):($element=jqLite(linkNode),attrs=new Attributes($element,templateAttrs)),newIsolateScopeDirective&&(isolateScope=scope.$new(!0)),boundTranscludeFn&&(transcludeFn=controllersBoundTransclude,transcludeFn.$$boundTransclude=boundTranscludeFn),controllerDirectives&&(controllers={},elementControllers={},forEach(controllerDirectives,function(directive){var controllerInstance,locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn};controller=directive.controller,"@"==controller&&(controller=attrs[directive.name]),controllerInstance=$controller(controller,locals,!0,directive.controllerAs),elementControllers[directive.name]=controllerInstance,hasElementTranscludeDirective||$element.data("$"+directive.name+"Controller",controllerInstance.instance),controllers[directive.name]=controllerInstance})),newIsolateScopeDirective){compile.$$addScopeInfo($element,isolateScope,!0,!(templateDirective&&(templateDirective===newIsolateScopeDirective||templateDirective===newIsolateScopeDirective.$$originalDirective))),compile.$$addScopeClass($element,!0);var isolateScopeController=controllers&&controllers[newIsolateScopeDirective.name],isolateBindingContext=isolateScope;isolateScopeController&&isolateScopeController.identifier&&newIsolateScopeDirective.bindToController===!0&&(isolateBindingContext=isolateScopeController.instance),forEach(isolateScope.$$isolateBindings=newIsolateScopeDirective.$$isolateBindings,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,attrName=definition.attrName,optional=definition.optional,mode=definition.mode;switch(mode){case"@":attrs.$observe(attrName,function(value){isolateBindingContext[scopeName]=value}),attrs.$$observers[attrName].$$scope=scope,attrs[attrName]&&(isolateBindingContext[scopeName]=$interpolate(attrs[attrName])(scope));break;case"=":if(optional&&!attrs[attrName])return;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=isolateBindingContext[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",attrs[attrName],newIsolateScopeDirective.name)},lastValue=isolateBindingContext[scopeName]=parentGet(scope);var parentValueWatch=function(parentValue){return compare(parentValue,isolateBindingContext[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=isolateBindingContext[scopeName]):isolateBindingContext[scopeName]=parentValue),lastValue=parentValue};parentValueWatch.$stateful=!0;var unwatch;unwatch=definition.collection?scope.$watchCollection(attrs[attrName],parentValueWatch):scope.$watch($parse(attrs[attrName],parentValueWatch),null,parentGet.literal),isolateScope.$on("$destroy",unwatch);break;case"&":parentGet=$parse(attrs[attrName]),isolateBindingContext[scopeName]=function(locals){return parentGet(scope,locals)}}})}for(controllers&&(forEach(controllers,function(controller){controller()}),controllers=null),i=0,ii=preLinkFns.length;ii>i;i++)linkFn=preLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,undefined,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)linkFn=postLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}previousCompileContext=previousCompileContext||{};for(var newScopeDirective,controllers,directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=undefined,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(directive.templateUrl||(isObject(directiveValue)?(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective||newScopeDirective,directive,$compileNode),newIsolateScopeDirective=directive):assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode)),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||{},assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue?(hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective})):($template=jqLite(jqLiteClone(compileNode)).contents(),$compileNode.empty(),childTranscludeFn=compile($template,transcludeFn))),directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:removeComments(wrapTemplate(directive.templateNamespace,trim(directiveValue))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");
replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));newIsolateScopeDirective&&markDirectivesAsIsolate(templateDirectives),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn,attrStart,attrEnd):linkFn&&addLinkFns(linkFn.pre,linkFn.post,attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.elementTranscludeOnThisElement=hasElementTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function markDirectivesAsIsolate(directives){for(var j=0,jj=directives.length;jj>j;j++)directives[j]=inherit(directives[j],{$$isolateScope:!0})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{directive=directives[i],(maxPriority===undefined||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)&&(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),tDirectives.push(directive),match=directive)}catch(e){$exceptionHandler(e)}return match}function directiveIsMultiElement(name){if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)if(directive=directives[i],directive.multiElement)return!0;return!1}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?($element.attr("style",$element.attr("style")+";"+value),dst.style=(dst.style?dst.style+";":"")+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=inherit(origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl,templateNamespace=origAsyncDirective.templateNamespace;return $compileNode.empty(),$templateRequest($sce.getTrustedResourceUrl(templateUrl)).then(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:removeComments(wrapTemplate(templateNamespace,trim(content))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectivesAsIsolate(templateDirectives),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(!scope.$$destroyed){if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}}linkQueue=null}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;scope.$$destroyed||(linkQueue?linkQueue.push(scope,node,rootElement,childBoundTranscludeFn):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn)))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",previousDirective.name,directive.name,what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var templateNodeParent=templateNode.parent(),hasCompileParent=!!templateNodeParent.length;return hasCompileParent&&compile.$$addBindingClass(templateNodeParent),function(scope,node){var parent=node.parent();hasCompileParent||compile.$$addBindingClass(parent),compile.$$addBindingInfo(parent,interpolateFn.expressions),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function wrapTemplate(type,template){switch(type=lowercase(type||"html")){case"svg":case"math":var wrapper=document.createElement("div");return wrapper.innerHTML="<"+type+">"+template+"</"+type+">",wrapper.childNodes[0].childNodes;default:return template}}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"form"==tag&&"action"==attrNormalizedName||"img"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name,allOrNothing){var trustedContext=getTrustedContext(node,name);allOrNothing=ALL_OR_NOTHING_ATTRS[name]||allOrNothing;var interpolateFn=$interpolate(value,!0,trustedContext,allOrNothing);if(interpolateFn){if("multiple"===name&&"select"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers={});if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var newValue=attr[name];newValue!==value&&(interpolateFn=newValue&&$interpolate(newValue,!0,trustedContext,allOrNothing),value=newValue),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1,$rootElement.context===firstElementToRemove&&($rootElement.context=newNode);break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=document.createDocumentFragment();fragment.appendChild(firstElementToRemove),jqLite(newNode).data(jqLite(firstElementToRemove).data()),jQuery?(skipDestroyOnNextJQueryCleanData=!0,jQuery.cleanData([firstElementToRemove])):delete jqLite.cache[firstElementToRemove[jqLite.expando]];for(var k=1,kk=elementsToRemove.length;kk>k;k++){var element=elementsToRemove[k];jqLite(element).remove(),fragment.appendChild(element),delete elementsToRemove[k]}elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}function invokeLinkFn(linkFn,scope,$element,attrs,controllers,transcludeFn){try{linkFn(scope,$element,attrs,controllers,transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}var Attributes=function(element,attributesToCopy){if(attributesToCopy){var i,l,key,keys=Object.keys(attributesToCopy);for(i=0,l=keys.length;l>i;i++)key=keys[i],this[key]=attributesToCopy[key]}else this.$attr={};this.$$element=element};Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses);toAdd&&toAdd.length&&$animate.addClass(this.$$element,toAdd);var toRemove=tokenDifference(oldClasses,newClasses);toRemove&&toRemove.length&&$animate.removeClass(this.$$element,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,node=this.$$element[0],booleanKey=getBooleanAttrName(node,key),aliasedKey=getAliasedAttrName(node,key),observer=key;if(booleanKey?(this.$$element.prop(key,value),attrName=booleanKey):aliasedKey&&(this[aliasedKey]=value,observer=aliasedKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),"a"===nodeName&&"href"===key||"img"===nodeName&&"src"===key)this[key]=value=$$sanitizeUri(value,"src"===key);else if("img"===nodeName&&"srcset"===key){for(var result="",trimmedSrcset=trim(value),srcPattern=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,pattern=/\s/.test(trimmedSrcset)?srcPattern:/(,)/,rawUris=trimmedSrcset.split(pattern),nbrUrisWith2parts=Math.floor(rawUris.length/2),i=0;nbrUrisWith2parts>i;i++){var innerIdx=2*i;result+=$$sanitizeUri(trim(rawUris[innerIdx]),!0),result+=" "+trim(rawUris[innerIdx+1])}var lastTuple=trim(rawUris[2*i]).split(/\s/);result+=$$sanitizeUri(trim(lastTuple[0]),!0),2===lastTuple.length&&(result+=" "+trim(lastTuple[1])),this[key]=value=result}writeAttr!==!1&&(null===value||value===undefined?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[observer],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers=createMap()),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){!listeners.$$inter&&attrs.hasOwnProperty(key)&&fn(attrs[key])}),function(){arrayRemove(listeners,fn)}}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol||"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/;return compile.$$addBindingInfo=debugInfoEnabled?function($element,binding){var bindings=$element.data("$binding")||[];isArray(binding)?bindings=bindings.concat(binding):bindings.push(binding),$element.data("$binding",bindings)}:noop,compile.$$addBindingClass=debugInfoEnabled?function($element){safeAddClass($element,"ng-binding")}:noop,compile.$$addScopeInfo=debugInfoEnabled?function($element,scope,isolated,noTemplate){var dataName=isolated?noTemplate?"$isolateScopeNoTemplate":"$isolateScope":"$scope";$element.data(dataName,scope)}:noop,compile.$$addScopeClass=debugInfoEnabled?function($element,isolated){safeAddClass($element,isolated?"ng-isolate-scope":"ng-scope")}:noop,compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function removeComments(jqNodes){jqNodes=jqLite(jqNodes);var i=jqNodes.length;if(1>=i)return jqNodes;for(;i--;){var node=jqNodes[i];node.nodeType===NODE_TYPE_COMMENT&&splice.call(jqNodes,i,1)}return jqNodes}function $ControllerProvider(){var controllers={},globals=!1,CNTRL_REG=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.allowGlobals=function(){globals=!0},this.$get=["$injector","$window",function($injector,$window){function addIdentifier(locals,identifier,instance,name){if(!locals||!isObject(locals.$scope))throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",name,identifier);locals.$scope[identifier]=instance}return function(expression,locals,later,ident){var instance,match,constructor,identifier;if(later=later===!0,ident&&isString(ident)&&(identifier=ident),isString(expression)){if(match=expression.match(CNTRL_REG),!match)throw $controllerMinErr("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",expression);constructor=match[1],identifier=identifier||match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||(globals?getter($window,constructor,!0):undefined),assertArgFn(expression,constructor,!0)}if(later){var controllerPrototype=(isArray(expression)?expression[expression.length-1]:expression).prototype;return instance=Object.create(controllerPrototype||null),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),extend(function(){return $injector.invoke(expression,instance,locals,constructor),instance},{instance:instance,identifier:identifier})}return instance=$injector.instantiate(expression,locals,constructor),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(){$log.error.apply($log,arguments)}}]}function defaultHttpResponseTransform(data,headers){if(isString(data)){var tempData=data.replace(JSON_PROTECTION_PREFIX,"").trim();if(tempData){var contentType=headers("Content-Type");(contentType&&0===contentType.indexOf(APPLICATION_JSON)||isJsonLike(tempData))&&(data=fromJson(tempData))}}return data}function isJsonLike(str){var jsonStart=str.match(JSON_START);return jsonStart&&JSON_ENDS[jsonStart[0]].test(str)}function parseHeaders(headers){var key,val,i,parsed=createMap();return headers?(forEach(headers.split("\n"),function(line){i=line.indexOf(":"),key=lowercase(trim(line.substr(0,i))),val=trim(line.substr(i+1)),key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}),parsed):parsed}function headersGetter(headers){var headersObj=isObject(headers)?headers:undefined;return function(name){if(headersObj||(headersObj=parseHeaders(headers)),name){var value=headersObj[lowercase(name)];return void 0===value&&(value=null),value}return headersObj}}function transformData(data,headers,status,fns){return isFunction(fns)?fns(data,headers,status):(forEach(fns,function(fn){data=fn(data,headers,status)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var defaults=this.defaults={transformResponse:[defaultHttpResponseTransform],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)||isFormData(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},useApplyAsync=!1;this.useApplyAsync=function(value){return isDefined(value)?(useApplyAsync=!!value,this):useApplyAsync};var interceptorFactories=this.interceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$browser,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function transformResponse(response){var resp=extend({},response);return resp.data=response.data?transformData(response.data,response.headers,response.status,config.transformResponse):response.data,isSuccess(response.status)?resp:$q.reject(resp)}function executeHeaderFns(headers){var headerContent,processedHeaders={};return forEach(headers,function(headerFn,header){isFunction(headerFn)?(headerContent=headerFn(),null!=headerContent&&(processedHeaders[header]=headerContent)):processedHeaders[header]=headerFn}),processedHeaders}function mergeHeaders(config){var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return executeHeaderFns(reqHeaders)}if(!angular.isObject(requestConfig))throw minErr("$http")("badreq","Http request configuration must be an object.  Received: {0}",requestConfig);var config=extend({method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse},requestConfig);config.headers=mergeHeaders(requestConfig),config.method=uppercase(config.method);var serverRequest=function(config){var headers=config.headers,reqData=transformData(config.data,headersGetter(headers),undefined,config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData).then(transformResponse,transformResponse)},chain=[serverRequest,undefined],promise=$q.when(config);for(forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&chain.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&chain.push(interceptor.response,interceptor.responseError)});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(thenFn,rejectFn)}return promise.success=function(fn){return promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise},promise}function createShortMethods(){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend(config||{},{method:name,url:url}))}})}function createShortMethodsWithData(){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend(config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData){function done(status,response,headersString,statusText){function resolveHttpPromise(){resolvePromise(response,status,headersString,statusText)}cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),useApplyAsync?$rootScope.$applyAsync(resolveHttpPromise):(resolveHttpPromise(),$rootScope.$$phase||$rootScope.$apply())}function resolvePromise(response,status,headers,statusText){status=Math.max(status,0),(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function resolvePromiseWithResult(result){resolvePromise(result.data,result.status,shallowCopy(result.headers()),result.statusText)}function removePendingReq(){var idx=$http.pendingRequests.indexOf(config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,reqHeaders=config.headers,url=buildUrl(config.url,config.params);if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache&&(cachedResp=cache.get(url),isDefined(cachedResp)?isPromiseLike(cachedResp)?cachedResp.then(resolvePromiseWithResult,resolvePromiseWithResult):isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK"):cache.put(url,promise)),isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$browser.cookies()[config.xsrfCookieName||defaults.xsrfCookieName]:undefined;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType)}return promise}function buildUrl(url,params){if(!params)return url;var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)||(value=[value]),forEach(value,function(v){isObject(v)&&(v=isDate(v)?v.toISOString():toJson(v)),parts.push(encodeUriQuery(key)+"="+encodeUriQuery(v))}))}),parts.length>0&&(url+=(-1==url.indexOf("?")?"?":"&")+parts.join("&")),url}var defaultCache=$cacheFactory("$http"),reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function createXhr(){return new window.XMLHttpRequest}function $HttpBackendProvider(){this.$get=["$browser","$window","$document",function($browser,$window,$document){return createHttpBackend($browser,createXhr,$browser.defer,$window.angular.callbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackId,done){var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks[callbackId].called||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),rawDocument.body.appendChild(script),callback}return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){timeoutId!==undefined&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data,callbacks[callbackId].called=!0};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),callbackId,function(status,text){completeRequest(callback,status,callbacks[callbackId].data,"",text),callbacks[callbackId]=noop})}else{var xhr=createXhr();xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onload=function(){var statusText=xhr.statusText||"",response="response"in xhr?xhr.response:xhr.responseText,status=1223===xhr.status?204:xhr.status;0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),completeRequest(callback,status,response,xhr.getAllResponseHeaders(),statusText)};var requestError=function(){completeRequest(callback,-1,null,null,"")};if(xhr.onerror=requestError,xhr.onabort=requestError,withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(post||null)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function escape(ch){return"\\\\\\"+ch}function $interpolate(text,mustHaveExpression,trustedContext,allOrNothing){function unescapeText(text){return text.replace(escapedStartRegexp,startSymbol).replace(escapedEndRegexp,endSymbol)}function parseStringifyInterceptor(value){try{return value=getValue(value),allOrNothing&&!isDefined(value)?value:stringify(value)}catch(err){var newErr=$interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString());$exceptionHandler(newErr)}}allOrNothing=!!allOrNothing;for(var startIndex,endIndex,exp,index=0,expressions=[],parseFns=[],textLength=text.length,concat=[],expressionPositions=[];textLength>index;){if(-1==(startIndex=text.indexOf(startSymbol,index))||-1==(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))){index!==textLength&&concat.push(unescapeText(text.substring(index)));break}index!==startIndex&&concat.push(unescapeText(text.substring(index,startIndex))),exp=text.substring(startIndex+startSymbolLength,endIndex),expressions.push(exp),parseFns.push($parse(exp,parseStringifyInterceptor)),index=endIndex+endSymbolLength,expressionPositions.push(concat.length),concat.push("")}if(trustedContext&&concat.length>1)throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text);if(!mustHaveExpression||expressions.length){var compute=function(values){for(var i=0,ii=expressions.length;ii>i;i++){if(allOrNothing&&isUndefined(values[i]))return;concat[expressionPositions[i]]=values[i]}return concat.join("")},getValue=function(value){return trustedContext?$sce.getTrusted(trustedContext,value):$sce.valueOf(value)},stringify=function(value){if(null==value)return"";switch(typeof value){case"string":break;case"number":value=""+value;break;default:value=toJson(value)}return value};return extend(function(context){var i=0,ii=expressions.length,values=new Array(ii);try{for(;ii>i;i++)values[i]=parseFns[i](context);return compute(values)}catch(err){var newErr=$interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString());$exceptionHandler(newErr)}},{exp:text,expressions:expressions,$$watchDelegate:function(scope,listener,objectEquality){var lastValue;return scope.$watchGroup(parseFns,function(values,oldValues){var currValue=compute(values);isFunction(listener)&&listener.call(this,currValue,values!==oldValues?lastValue:currValue,scope),lastValue=currValue},objectEquality)}})}}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length,escapedStartRegexp=new RegExp(startSymbol.replace(/./g,escape),"g"),escapedEndRegexp=new RegExp(endSymbol.replace(/./g,escape),"g");return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q","$$q",function($rootScope,$window,$q,$$q){function interval(fn,delay,count,invokeApply){var setInterval=$window.setInterval,clearInterval=$window.clearInterval,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return count=isDefined(count)?count:0,promise.then(null,null,fn),promise.$$intervalId=setInterval(function(){deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return promise&&promise.$$intervalId in intervals?(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0):!1},interval}]}function $LocaleProvider(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(num){return 1===num?"one":"other"
}}}}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj){var parsedUrl=urlResolve(absoluteUrl);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=int(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function beginsWith(begin,whole){return 0===whole.indexOf(begin)?whole.substr(begin.length):void 0}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function trimEmptyHash(url){return url.replace(/(#.+)|#$/,"$1")}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"";var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this),this.$$parse=function(url){var pathUrl=beginsWith(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var appUrl,prevAppUrl,rewrittenUrl;return(appUrl=beginsWith(appBase,url))!==undefined?(prevAppUrl=appUrl,rewrittenUrl=(appUrl=beginsWith(basePrefix,appUrl))!==undefined?appBaseNoFile+(beginsWith("/",appUrl)||appUrl):appBase+prevAppUrl):(appUrl=beginsWith(appBaseNoFile,url))!==undefined?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile==url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,hashPrefix){var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return 0===url.indexOf(base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutHashUrl,withoutBaseUrl=beginsWith(appBase,url)||beginsWith(appBaseNoFile,url);"#"===withoutBaseUrl.charAt(0)?(withoutHashUrl=beginsWith(hashPrefix,withoutBaseUrl),isUndefined(withoutHashUrl)&&(withoutHashUrl=withoutBaseUrl)):withoutHashUrl=this.$$html5?withoutBaseUrl:"",parseAppUrl(withoutHashUrl,this),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url){return stripHash(appBase)==stripHash(url)?(this.$$parse(url),!0):!1}}function LocationHashbangInHtml5Url(appBase,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments);var appBaseNoFile=stripFile(appBase);this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var rewrittenUrl,appUrl;return appBase==stripHash(url)?rewrittenUrl=url:(appUrl=beginsWith(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isBoolean(mode)?(html5Mode.enabled=mode,this):isObject(mode)?(isBoolean(mode.enabled)&&(html5Mode.enabled=mode.enabled),isBoolean(mode.requireBase)&&(html5Mode.requireBase=mode.requireBase),isBoolean(mode.rewriteLinks)&&(html5Mode.rewriteLinks=mode.rewriteLinks),this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function($rootScope,$browser,$sniffer,$rootElement,$window){function setBrowserUrlWithFallback(url,replace,state){var oldUrl=$location.url(),oldState=$location.$$state;try{$browser.url(url,replace,state),$location.$$state=$browser.state()}catch(e){throw $location.url(oldUrl),$location.$$state=oldState,e}}function afterLocationChange(oldUrl,oldState){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl,$location.$$state,oldState)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();if(html5Mode.enabled){if(!baseHref&&html5Mode.requireBase)throw $locationMinErr("nobase","$location in HTML5 mode requires a <base> tag to be present!");appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url}else appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl;$location=new LocationMode(appBase,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl),$location.$$state=$browser.state();var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(html5Mode.rewriteLinks&&!event.ctrlKey&&!event.metaKey&&!event.shiftKey&&2!=event.which&&2!=event.button){for(var elm=jqLite(event.target);"a"!==nodeName_(elm[0]);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!=$browser.url()&&($rootScope.$apply(),$window.angular["ff-684208-preventDefault"]=!0))}}),trimEmptyHash($location.absUrl())!=trimEmptyHash(initialUrl)&&$browser.url($location.absUrl(),!0);var initializing=!0;return $browser.onUrlChange(function(newUrl,newState){$rootScope.$evalAsync(function(){var defaultPrevented,oldUrl=$location.absUrl(),oldState=$location.$$state;$location.$$parse(newUrl),$location.$$state=newState,defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,newState,oldState).defaultPrevented,$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState,setBrowserUrlWithFallback(oldUrl,!1,oldState)):(initializing=!1,afterLocationChange(oldUrl,oldState)))}),$rootScope.$$phase||$rootScope.$digest()}),$rootScope.$watch(function(){var oldUrl=trimEmptyHash($browser.url()),newUrl=trimEmptyHash($location.absUrl()),oldState=$browser.state(),currentReplace=$location.$$replace,urlOrStateChanged=oldUrl!==newUrl||$location.$$html5&&$sniffer.history&&oldState!==$location.$$state;(initializing||urlOrStateChanged)&&(initializing=!1,$rootScope.$evalAsync(function(){var newUrl=$location.absUrl(),defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,$location.$$state,oldState).defaultPrevented;$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState):(urlOrStateChanged&&setBrowserUrlWithFallback(newUrl,currentReplace,oldState===$location.$$state?null:$location.$$state),afterLocationChange(oldUrl,oldState)))})),$location.$$replace=!1}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.window===obj)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function isConstant(exp){return exp.constant}function setter(obj,locals,path,setValue,fullExp){ensureSafeObject(obj,fullExp),ensureSafeObject(locals,fullExp);for(var key,element=path.split("."),i=0;element.length>1;i++){key=ensureSafeMemberName(element.shift(),fullExp);var propertyObj=0===i&&locals&&locals[key]||obj[key];propertyObj||(propertyObj={},obj[key]=propertyObj),obj=ensureSafeObject(propertyObj,fullExp)}return key=ensureSafeMemberName(element.shift(),fullExp),ensureSafeObject(obj[key],fullExp),obj[key]=setValue,setValue}function isPossiblyDangerousMemberName(name){return"constructor"==name}function cspSafeGetterFn(key0,key1,key2,key3,key4,fullExp,expensiveChecks){ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),ensureSafeMemberName(key2,fullExp),ensureSafeMemberName(key3,fullExp),ensureSafeMemberName(key4,fullExp);var eso=function(o){return ensureSafeObject(o,fullExp)},eso0=expensiveChecks||isPossiblyDangerousMemberName(key0)?eso:identity,eso1=expensiveChecks||isPossiblyDangerousMemberName(key1)?eso:identity,eso2=expensiveChecks||isPossiblyDangerousMemberName(key2)?eso:identity,eso3=expensiveChecks||isPossiblyDangerousMemberName(key3)?eso:identity,eso4=expensiveChecks||isPossiblyDangerousMemberName(key4)?eso:identity;return function(scope,locals){var pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=eso0(pathVal[key0]),key1?null==pathVal?undefined:(pathVal=eso1(pathVal[key1]),key2?null==pathVal?undefined:(pathVal=eso2(pathVal[key2]),key3?null==pathVal?undefined:(pathVal=eso3(pathVal[key3]),key4?null==pathVal?undefined:pathVal=eso4(pathVal[key4]):pathVal):pathVal):pathVal):pathVal)}}function getterFnWithEnsureSafeObject(fn,fullExpression){return function(s,l){return fn(s,l,ensureSafeObject,fullExpression)}}function getterFn(path,options,fullExp){var expensiveChecks=options.expensiveChecks,getterFnCache=expensiveChecks?getterFnCacheExpensive:getterFnCacheDefault,fn=getterFnCache[path];if(fn)return fn;var pathKeys=path.split("."),pathKeysLength=pathKeys.length;if(options.csp)fn=6>pathKeysLength?cspSafeGetterFn(pathKeys[0],pathKeys[1],pathKeys[2],pathKeys[3],pathKeys[4],fullExp,expensiveChecks):function(scope,locals){var val,i=0;do val=cspSafeGetterFn(pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],fullExp,expensiveChecks)(scope,locals),locals=undefined,scope=val;while(pathKeysLength>i);return val};else{var code="";expensiveChecks&&(code+="s = eso(s, fe);\nl = eso(l, fe);\n");var needsEnsureSafeObject=expensiveChecks;forEach(pathKeys,function(key,index){ensureSafeMemberName(key,fullExp);var lookupJs=(index?"s":'((l&&l.hasOwnProperty("'+key+'"))?l:s)')+"."+key;(expensiveChecks||isPossiblyDangerousMemberName(key))&&(lookupJs="eso("+lookupJs+", fe)",needsEnsureSafeObject=!0),code+="if(s == null) return undefined;\ns="+lookupJs+";\n"}),code+="return s;";var evaledFnGetter=new Function("s","l","eso","fe",code);evaledFnGetter.toString=valueFn(code),needsEnsureSafeObject&&(evaledFnGetter=getterFnWithEnsureSafeObject(evaledFnGetter,fullExp)),fn=evaledFnGetter}return fn.sharedGetter=!0,fn.assign=function(self,value,locals){return setter(self,locals,path,value,path)},getterFnCache[path]=fn,fn}function getValueOf(value){return isFunction(value.valueOf)?value.valueOf():objectValueOf.call(value)}function $ParseProvider(){var cacheDefault=createMap(),cacheExpensive=createMap();this.$get=["$filter","$sniffer",function($filter,$sniffer){function wrapSharedExpression(exp){var wrapped=exp;return exp.sharedGetter&&(wrapped=function(self,locals){return exp(self,locals)},wrapped.literal=exp.literal,wrapped.constant=exp.constant,wrapped.assign=exp.assign),wrapped}function collectExpressionInputs(inputs,list){for(var i=0,ii=inputs.length;ii>i;i++){var input=inputs[i];input.constant||(input.inputs?collectExpressionInputs(input.inputs,list):-1===list.indexOf(input)&&list.push(input))}return list}function expressionInputDirtyCheck(newValue,oldValueOfValue){return null==newValue||null==oldValueOfValue?newValue===oldValueOfValue:"object"==typeof newValue&&(newValue=getValueOf(newValue),"object"==typeof newValue)?!1:newValue===oldValueOfValue||newValue!==newValue&&oldValueOfValue!==oldValueOfValue}function inputsWatchDelegate(scope,listener,objectEquality,parsedExpression){var lastResult,inputExpressions=parsedExpression.$$inputs||(parsedExpression.$$inputs=collectExpressionInputs(parsedExpression.inputs,[]));if(1===inputExpressions.length){var oldInputValue=expressionInputDirtyCheck;return inputExpressions=inputExpressions[0],scope.$watch(function(scope){var newInputValue=inputExpressions(scope);return expressionInputDirtyCheck(newInputValue,oldInputValue)||(lastResult=parsedExpression(scope),oldInputValue=newInputValue&&getValueOf(newInputValue)),lastResult},listener,objectEquality)}for(var oldInputValueOfValues=[],i=0,ii=inputExpressions.length;ii>i;i++)oldInputValueOfValues[i]=expressionInputDirtyCheck;return scope.$watch(function(scope){for(var changed=!1,i=0,ii=inputExpressions.length;ii>i;i++){var newInputValue=inputExpressions[i](scope);(changed||(changed=!expressionInputDirtyCheck(newInputValue,oldInputValueOfValues[i])))&&(oldInputValueOfValues[i]=newInputValue&&getValueOf(newInputValue))}return changed&&(lastResult=parsedExpression(scope)),lastResult},listener,objectEquality)}function oneTimeWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.apply(this,arguments),isDefined(value)&&scope.$$postDigest(function(){isDefined(lastValue)&&unwatch()})},objectEquality)}function oneTimeLiteralWatchDelegate(scope,listener,objectEquality,parsedExpression){function isAllDefined(value){var allDefined=!0;return forEach(value,function(val){isDefined(val)||(allDefined=!1)}),allDefined}var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.call(this,value,old,scope),isAllDefined(value)&&scope.$$postDigest(function(){isAllDefined(lastValue)&&unwatch()})},objectEquality)}function constantWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(){isFunction(listener)&&listener.apply(this,arguments),unwatch()},objectEquality)}function addInterceptor(parsedExpression,interceptorFn){if(!interceptorFn)return parsedExpression;var watchDelegate=parsedExpression.$$watchDelegate,regularWatch=watchDelegate!==oneTimeLiteralWatchDelegate&&watchDelegate!==oneTimeWatchDelegate,fn=regularWatch?function(scope,locals){var value=parsedExpression(scope,locals);return interceptorFn(value,scope,locals)}:function(scope,locals){var value=parsedExpression(scope,locals),result=interceptorFn(value,scope,locals);return isDefined(value)?result:value};return parsedExpression.$$watchDelegate&&parsedExpression.$$watchDelegate!==inputsWatchDelegate?fn.$$watchDelegate=parsedExpression.$$watchDelegate:interceptorFn.$stateful||(fn.$$watchDelegate=inputsWatchDelegate,fn.inputs=[parsedExpression]),fn}var $parseOptions={csp:$sniffer.csp,expensiveChecks:!1},$parseOptionsExpensive={csp:$sniffer.csp,expensiveChecks:!0};return function(exp,interceptorFn,expensiveChecks){var parsedExpression,oneTime,cacheKey;switch(typeof exp){case"string":cacheKey=exp=exp.trim();var cache=expensiveChecks?cacheExpensive:cacheDefault;if(parsedExpression=cache[cacheKey],!parsedExpression){":"===exp.charAt(0)&&":"===exp.charAt(1)&&(oneTime=!0,exp=exp.substring(2));var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);parsedExpression=parser.parse(exp),parsedExpression.constant?parsedExpression.$$watchDelegate=constantWatchDelegate:oneTime?(parsedExpression=wrapSharedExpression(parsedExpression),parsedExpression.$$watchDelegate=parsedExpression.literal?oneTimeLiteralWatchDelegate:oneTimeWatchDelegate):parsedExpression.inputs&&(parsedExpression.$$watchDelegate=inputsWatchDelegate),cache[cacheKey]=parsedExpression}return addInterceptor(parsedExpression,interceptorFn);case"function":return addInterceptor(exp,interceptorFn);default:return addInterceptor(noop,interceptorFn)}}}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function $$QProvider(){this.$get=["$browser","$exceptionHandler",function($browser,$exceptionHandler){return qFactory(function(callback){$browser.defer(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function callOnce(self,resolveFn,rejectFn){function wrap(fn){return function(value){called||(called=!0,fn.call(self,value))}}var called=!1;return[wrap(resolveFn),wrap(rejectFn)]}function Promise(){this.$$state={status:0}}function simpleBind(context,fn){return function(value){fn.call(context,value)}}function processQueue(state){var fn,promise,pending;pending=state.pending,state.processScheduled=!1,state.pending=undefined;for(var i=0,ii=pending.length;ii>i;++i){promise=pending[i][0],fn=pending[i][state.status];try{isFunction(fn)?promise.resolve(fn(state.value)):1===state.status?promise.resolve(state.value):promise.reject(state.value)}catch(e){promise.reject(e),exceptionHandler(e)}}}function scheduleProcessQueue(state){!state.processScheduled&&state.pending&&(state.processScheduled=!0,nextTick(function(){processQueue(state)}))}function Deferred(){this.promise=new Promise,this.resolve=simpleBind(this,this.resolve),this.reject=simpleBind(this,this.reject),this.notify=simpleBind(this,this.notify)}function all(promises){var deferred=new Deferred,counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,when(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}var $qMinErr=minErr("$q",TypeError),defer=function(){return new Deferred};Promise.prototype={then:function(onFulfilled,onRejected,progressBack){var result=new Deferred;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([result,onFulfilled,onRejected,progressBack]),this.$$state.status>0&&scheduleProcessQueue(this.$$state),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback,progressBack){return this.then(function(value){return handleCallback(value,!0,callback)},function(error){return handleCallback(error,!1,callback)},progressBack)}},Deferred.prototype={resolve:function(val){this.promise.$$state.status||(val===this.promise?this.$$reject($qMinErr("qcycle","Expected promise to be resolved with value other than itself '{0}'",val)):this.$$resolve(val))},$$resolve:function(val){var then,fns;fns=callOnce(this,this.$$resolve,this.$$reject);try{(isObject(val)||isFunction(val))&&(then=val&&val.then),isFunction(then)?(this.promise.$$state.status=-1,then.call(val,fns[0],fns[1],this.notify)):(this.promise.$$state.value=val,this.promise.$$state.status=1,scheduleProcessQueue(this.promise.$$state))}catch(e){fns[1](e),exceptionHandler(e)}},reject:function(reason){this.promise.$$state.status||this.$$reject(reason)},$$reject:function(reason){this.promise.$$state.value=reason,this.promise.$$state.status=2,scheduleProcessQueue(this.promise.$$state)},notify:function(progress){var callbacks=this.promise.$$state.pending;this.promise.$$state.status<=0&&callbacks&&callbacks.length&&nextTick(function(){for(var callback,result,i=0,ii=callbacks.length;ii>i;i++){result=callbacks[i][0],callback=callbacks[i][3];try{result.notify(isFunction(callback)?callback(progress):progress)}catch(e){exceptionHandler(e)}}})}};var reject=function(reason){var result=new Deferred;return result.reject(reason),result.promise},makePromise=function(value,resolved){var result=new Deferred;return resolved?result.resolve(value):result.reject(value),result.promise},handleCallback=function(value,isResolved,callback){var callbackOutput=null;try{isFunction(callback)&&(callbackOutput=callback())}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)},when=function(value,callback,errback,progressBack){var result=new Deferred;return result.resolve(value),result.promise.then(callback,errback,progressBack)},$Q=function Q(resolver){function resolveFn(value){deferred.resolve(value)}function rejectFn(reason){deferred.reject(reason)}if(!isFunction(resolver))throw $qMinErr("norslvr","Expected resolverFn, got '{0}'",resolver);if(!(this instanceof Q))return new Q(resolver);var deferred=new Deferred;return resolver(resolveFn,rejectFn),deferred.promise};return $Q.defer=defer,$Q.reject=reject,$Q.when=when,$Q.all=all,$Q}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null,applyAsyncId=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse","$browser",function($injector,$exceptionHandler,$parse,$browser){function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings=null}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}function flushApplyAsync(){for(;applyAsyncQueue.length;)try{applyAsyncQueue.shift()()}catch(e){$exceptionHandler(e)}applyAsyncId=null}function scheduleApplyAsync(){null===applyAsyncId&&(applyAsyncId=$browser.defer(function(){$rootScope.$apply(flushApplyAsync)}))}Scope.prototype={constructor:Scope,$new:function(isolate,parent){function destroyChild(){child.$$destroyed=!0}var child;return parent=parent||this,isolate?(child=new Scope,child.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=nextUid(),this.$$ChildScope=null},this.$$ChildScope.prototype=this),child=new this.$$ChildScope),child.$parent=parent,child.$$prevSibling=parent.$$childTail,parent.$$childHead?(parent.$$childTail.$$nextSibling=child,parent.$$childTail=child):parent.$$childHead=parent.$$childTail=child,(isolate||parent!=this)&&child.$on("$destroy",destroyChild),child},$watch:function(watchExp,listener,objectEquality){var get=$parse(watchExp);if(get.$$watchDelegate)return get.$$watchDelegate(this,listener,objectEquality,get);var scope=this,array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:watchExp,eq:!!objectEquality};return lastDirtyWatch=null,isFunction(listener)||(watcher.fn=noop),array||(array=scope.$$watchers=[]),array.unshift(watcher),function(){arrayRemove(array,watcher),lastDirtyWatch=null}},$watchGroup:function(watchExpressions,listener){function watchGroupAction(){changeReactionScheduled=!1,firstRun?(firstRun=!1,listener(newValues,newValues,self)):listener(newValues,oldValues,self)}var oldValues=new Array(watchExpressions.length),newValues=new Array(watchExpressions.length),deregisterFns=[],self=this,changeReactionScheduled=!1,firstRun=!0;if(!watchExpressions.length){var shouldCall=!0;return self.$evalAsync(function(){shouldCall&&listener(newValues,newValues,self)}),function(){shouldCall=!1}}return 1===watchExpressions.length?this.$watch(watchExpressions[0],function(value,oldValue,scope){newValues[0]=value,oldValues[0]=oldValue,listener(newValues,value===oldValue?newValues:oldValues,scope)}):(forEach(watchExpressions,function(expr,i){var unwatchFn=self.$watch(expr,function(value,oldValue){newValues[i]=value,oldValues[i]=oldValue,changeReactionScheduled||(changeReactionScheduled=!0,self.$evalAsync(watchGroupAction))});deregisterFns.push(unwatchFn)}),function(){for(;deregisterFns.length;)deregisterFns.shift()()})},$watchCollection:function(obj,listener){function $watchCollectionInterceptor(_value){newValue=_value;var newLength,key,bothNaN,newItem,oldItem;if(!isUndefined(newValue)){if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++)oldItem=oldValue[i],newItem=newValue[i],bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[i]=newItem)}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)newValue.hasOwnProperty(key)&&(newLength++,newItem=newValue[key],oldItem=oldValue[key],key in oldValue?(bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[key]=newItem)):(oldLength++,oldValue[key]=newItem,changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)newValue.hasOwnProperty(key)||(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}$watchCollectionInterceptor.$stateful=!0;var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,changeDetector=$parse(obj,$watchCollectionInterceptor),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch(changeDetector,$watchCollectionAction)},$digest:function(){var watch,value,last,watchers,length,dirty,next,current,logIdx,asyncTask,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),this===$rootScope&&null!==applyAsyncId&&($browser.defer.cancel(applyAsyncId),flushApplyAsync()),lastDirtyWatch=null;do{for(dirty=!1,current=target;asyncQueue.length;){try{asyncTask=asyncQueue.shift(),asyncTask.scope.$eval(asyncTask.expression,asyncTask.locals)}catch(e){$exceptionHandler(e)}lastDirtyWatch=null}traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if((value=watch.get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,watch.fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),watchLog[logIdx].push({msg:isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,newVal:value,oldVal:last}))}catch(e){$exceptionHandler(e)}if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,watchLog)}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueue.length;)try{postDigestQueue.shift()()}catch(e){$exceptionHandler(e)}},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;if(this.$broadcast("$destroy"),this.$$destroyed=!0,this!==$rootScope){for(var eventName in this.$$listenerCount)decrementListenerCount(this,this.$$listenerCount[eventName],eventName);parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=noop,this.$on=this.$watch=this.$watchGroup=function(){return noop
},this.$$listeners={},this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=this.$$watchers=null}}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr,locals){$rootScope.$$phase||asyncQueue.length||$browser.defer(function(){asyncQueue.length&&$rootScope.$digest()}),asyncQueue.push({scope:this,expression:expr,locals:locals})},$$postDigest:function(fn){postDigestQueue.push(fn)},$apply:function(expr){try{return beginPhase("$apply"),this.$eval(expr)}catch(e){$exceptionHandler(e)}finally{clearPhase();try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$applyAsync:function(expr){function $applyAsyncExpression(){scope.$eval(expr)}var scope=this;expr&&applyAsyncQueue.push($applyAsyncExpression),scheduleApplyAsync()},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=namedListeners.indexOf(listener);-1!==indexOfListener&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event.currentScope=null,event;scope=scope.$parent}while(scope);return event.currentScope=null,event},$broadcast:function(name){var target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1};if(!target.$$listenerCount[name])return event;for(var listeners,i,length,listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event.currentScope=null,event}};var $rootScope=new Scope,asyncQueue=$rootScope.$$asyncQueue=[],postDigestQueue=$rootScope.$$postDigestQueue=[],applyAsyncQueue=$rootScope.$$applyAsyncQueue=[];return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex)?uri:"unsafe:"+normalizedVal}}}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||trustedValue===undefined||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||maybeTrusted===undefined||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sceDelegate",function($parse,$sceDelegate){if(enabled&&8>msie)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:$parse(expr,function(value){return sce.getTrusted(type,value)})};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},android=int((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},vendorRegex=/^(Moz|webkit|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix.substr(0,1).toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(document.body.style.webkitTransition),animations=isString(document.body.style.webkitAnimation))}return{history:!(!$window.history||!$window.history.pushState||4>android||boxee),hasEvent:function(event){if("input"===event&&11>=msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android}}]}function $TemplateRequestProvider(){this.$get=["$templateCache","$http","$q",function($templateCache,$http,$q){function handleRequestFn(tpl,ignoreRequestError){function handleError(resp){if(!ignoreRequestError)throw $compileMinErr("tpload","Failed to load template: {0}",tpl);return $q.reject(resp)}handleRequestFn.totalPendingRequests++;var transformResponse=$http.defaults&&$http.defaults.transformResponse;isArray(transformResponse)?transformResponse=transformResponse.filter(function(transformer){return transformer!==defaultHttpResponseTransform}):transformResponse===defaultHttpResponseTransform&&(transformResponse=null);var httpOptions={cache:$templateCache,transformResponse:transformResponse};return $http.get(tpl,httpOptions).finally(function(){handleRequestFn.totalPendingRequests--}).then(function(response){return response.data},handleError)}return handleRequestFn.totalPendingRequests=0,handleRequestFn}]}function $$TestabilityProvider(){this.$get=["$rootScope","$browser","$location",function($rootScope,$browser,$location){var testability={};return testability.findBindings=function(element,expression,opt_exactMatch){var bindings=element.getElementsByClassName("ng-binding"),matches=[];return forEach(bindings,function(binding){var dataBinding=angular.element(binding).data("$binding");dataBinding&&forEach(dataBinding,function(bindingName){if(opt_exactMatch){var matcher=new RegExp("(^|\\s)"+escapeForRegexp(expression)+"(\\s|\\||$)");matcher.test(bindingName)&&matches.push(binding)}else-1!=bindingName.indexOf(expression)&&matches.push(binding)})}),matches},testability.findModels=function(element,expression,opt_exactMatch){for(var prefixes=["ng-","data-ng-","ng\\:"],p=0;p<prefixes.length;++p){var attributeEquals=opt_exactMatch?"=":"*=",selector="["+prefixes[p]+"model"+attributeEquals+'"'+expression+'"]',elements=element.querySelectorAll(selector);if(elements.length)return elements}},testability.getLocation=function(){return $location.url()},testability.setLocation=function(url){url!==$location.url()&&($location.url(url),$rootScope.$digest())},testability.whenStable=function(callback){$browser.notifyWhenNoOutstandingRequests(callback)},testability}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function($rootScope,$browser,$q,$$q,$exceptionHandler){function timeout(fn,delay,invokeApply){var timeoutId,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn())}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator){if(!isArray(array))return array;var predicateFn,matchAgainstAnyProp;switch(typeof expression){case"function":predicateFn=expression;break;case"boolean":case"number":case"string":matchAgainstAnyProp=!0;case"object":predicateFn=createPredicateFn(expression,comparator,matchAgainstAnyProp);break;default:return array}return array.filter(predicateFn)}}function createPredicateFn(expression,comparator,matchAgainstAnyProp){var predicateFn,shouldMatchPrimitives=isObject(expression)&&"$"in expression;return comparator===!0?comparator=equals:isFunction(comparator)||(comparator=function(actual,expected){return isObject(actual)||isObject(expected)?!1:(actual=lowercase(""+actual),expected=lowercase(""+expected),-1!==actual.indexOf(expected))}),predicateFn=function(item){return shouldMatchPrimitives&&!isObject(item)?deepCompare(item,expression.$,comparator,!1):deepCompare(item,expression,comparator,matchAgainstAnyProp)}}function deepCompare(actual,expected,comparator,matchAgainstAnyProp,dontMatchWholeObject){var actualType=typeof actual,expectedType=typeof expected;if("string"===expectedType&&"!"===expected.charAt(0))return!deepCompare(actual,expected.substring(1),comparator,matchAgainstAnyProp);if(isArray(actual))return actual.some(function(item){return deepCompare(item,expected,comparator,matchAgainstAnyProp)});switch(actualType){case"object":var key;if(matchAgainstAnyProp){for(key in actual)if("$"!==key.charAt(0)&&deepCompare(actual[key],expected,comparator,!0))return!0;return dontMatchWholeObject?!1:deepCompare(actual,expected,comparator,!1)}if("object"===expectedType){for(key in expected){var expectedVal=expected[key];if(!isFunction(expectedVal)){var matchAnyProperty="$"===key,actualVal=matchAnyProperty?actual:actual[key];if(!deepCompare(actualVal,expectedVal,comparator,matchAnyProperty,matchAnyProperty))return!1}}return!0}return comparator(actual,expected);case"function":return!1;default:return comparator(actual,expected)}}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol,fractionSize){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),isUndefined(fractionSize)&&(fractionSize=formats.PATTERNS[1].maxFrac),null==amount?amount:formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return null==number?number:formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(!isFinite(number)||isObject(number))return"";var isNegative=0>number;number=Math.abs(number);var numStr=number+"",formatedText="",parts=[],hasExponent=!1;if(-1!==numStr.indexOf("e")){var match=numStr.match(/([\d\.]+)e(-?)(\d+)/);match&&"-"==match[2]&&match[3]>fractionSize+1?number=0:(formatedText=numStr,hasExponent=!0)}if(hasExponent)fractionSize>0&&1>number&&(formatedText=number.toFixed(fractionSize),number=parseFloat(formatedText));else{var fractionLen=(numStr.split(DECIMAL_SEP)[1]||"").length;isUndefined(fractionSize)&&(fractionSize=Math.min(Math.max(pattern.minFrac,fractionLen),pattern.maxFrac)),number=+(Math.round(+(number.toString()+"e"+fractionSize)).toString()+"e"+-fractionSize);var fraction=(""+number).split(DECIMAL_SEP),whole=fraction[0];fraction=fraction[1]||"";var i,pos=0,lgroup=pattern.lgSize,group=pattern.gSize;if(whole.length>=lgroup+group)for(pos=whole.length-lgroup,i=0;pos>i;i++)(pos-i)%group===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(i=pos;i<whole.length;i++)(whole.length-i)%lgroup===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(;fraction.length<fractionSize;)fraction+="0";fractionSize&&"0"!==fractionSize&&(formatedText+=decimalSep+fraction.substr(0,fractionSize))}return 0===number&&(isNegative=!1),parts.push(isNegative?pattern.negPre:pattern.posPre,formatedText,isNegative?pattern.negSuf:pattern.posSuf),parts.join("")}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset(),paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function getFirstThursdayOfYear(year){var dayOfWeekOnFirst=new Date(year,0,1).getDay();return new Date(year,0,(4>=dayOfWeekOnFirst?5:12)-dayOfWeekOnFirst)}function getThursdayThisWeek(datetime){return new Date(datetime.getFullYear(),datetime.getMonth(),datetime.getDate()+(4-datetime.getDay()))}function weekGetter(size){return function(date){var firstThurs=getFirstThursdayOfYear(date.getFullYear()),thisThurs=getThursdayThisWeek(date),diff=+thisThurs-+firstThurs,result=1+Math.round(diff/6048e5);return padNumber(result,size)}}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),dateSetter.call(date,int(match[1]),int(match[2])-1,int(match[3]));var h=int(match[4]||0)-tzHour,m=int(match[5]||0)-tzMin,s=int(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format,timezone){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?int(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);return timezone&&"UTC"===timezone&&(date=new Date(date.getTime()),date.setMinutes(date.getMinutes()+date.getTimezoneOffset())),forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object,spacing){return isUndefined(spacing)&&(spacing=2),toJson(object,spacing)}}function limitToFilter(){return function(input,limit){return isNumber(input)&&(input=input.toString()),isArray(input)||isString(input)?(limit=1/0===Math.abs(Number(limit))?Number(limit):int(limit),limit?limit>0?input.slice(0,limit):input.slice(limit):isString(input)?"":[]):input}}function orderByFilter($parse){return function(array,sortPredicate,reverseOrder){function comparator(o1,o2){for(var i=0;i<sortPredicate.length;i++){var comp=sortPredicate[i](o1,o2);if(0!==comp)return comp}return 0}function reverseComparator(comp,descending){return descending?function(a,b){return comp(b,a)}:comp}function isPrimitive(value){switch(typeof value){case"number":case"boolean":case"string":return!0;default:return!1}}function objectToString(value){return null===value?"null":"function"==typeof value.valueOf&&(value=value.valueOf(),isPrimitive(value))?value:"function"==typeof value.toString&&(value=value.toString(),isPrimitive(value))?value:""}function compare(v1,v2){var t1=typeof v1,t2=typeof v2;return t1===t2&&"object"===t1&&(v1=objectToString(v1),v2=objectToString(v2)),t1===t2?("string"===t1&&(v1=v1.toLowerCase(),v2=v2.toLowerCase()),v1===v2?0:v2>v1?-1:1):t2>t1?-1:1}return isArrayLike(array)?(sortPredicate=isArray(sortPredicate)?sortPredicate:[sortPredicate],0===sortPredicate.length&&(sortPredicate=["+"]),sortPredicate=sortPredicate.map(function(predicate){var descending=!1,get=predicate||identity;if(isString(predicate)){if(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0),predicate=predicate.substring(1)),""===predicate)return reverseComparator(compare,descending);if(get=$parse(predicate),get.constant){var key=get();return reverseComparator(function(a,b){return compare(a[key],b[key])},descending)}}return reverseComparator(function(a,b){return compare(get(a),get(b))},descending)}),slice.call(array).sort(reverseComparator(comparator,reverseOrder))):array}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function nullFormRenameControl(control,name){control.$name=name}function FormController(element,attrs,$scope,$animate,$interpolate){var form=this,controls=[],parentForm=form.$$parentForm=element.parent().controller("form")||nullFormCtrl;form.$error={},form.$$success={},form.$pending=undefined,form.$name=$interpolate(attrs.name||attrs.ngForm||"")($scope),form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,form.$submitted=!1,parentForm.$addControl(form),form.$rollbackViewValue=function(){forEach(controls,function(control){control.$rollbackViewValue()})},form.$commitViewValue=function(){forEach(controls,function(control){control.$commitViewValue()})},form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control)},form.$$renameControl=function(control,newName){var oldName=control.$name;form[oldName]===control&&delete form[oldName],form[newName]=control,control.$name=newName},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(form.$pending,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$error,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$$success,function(value,name){form.$setValidity(name,null,control)}),arrayRemove(controls,control)},addSetValidityMethod({ctrl:this,$element:element,set:function(object,property,controller){var list=object[property];if(list){var index=list.indexOf(controller);-1===index&&list.push(controller)}else object[property]=[controller]},unset:function(object,property,controller){var list=object[property];list&&(arrayRemove(list,controller),0===list.length&&delete object[property])},parentForm:parentForm,$animate:$animate}),form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,parentForm.$setDirty()},form.$setPristine=function(){$animate.setClass(element,PRISTINE_CLASS,DIRTY_CLASS+" "+SUBMITTED_CLASS),form.$dirty=!1,form.$pristine=!0,form.$submitted=!1,forEach(controls,function(control){control.$setPristine()})},form.$setUntouched=function(){forEach(controls,function(control){control.$setUntouched()})},form.$setSubmitted=function(){$animate.addClass(element,SUBMITTED_CLASS),form.$submitted=!0,parentForm.$setSubmitted()}}function stringBasedInputType(ctrl){ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?value:value.toString()})}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl)}function baseInputType(scope,element,attr,ctrl,$sniffer,$browser){var type=lowercase(element[0].type);if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var listener=function(ev){if(timeout&&($browser.defer.cancel(timeout),timeout=null),!composing){var value=element.val(),event=ev&&ev.type;"password"===type||attr.ngTrim&&"false"===attr.ngTrim||(value=trim(value)),(ctrl.$viewValue!==value||""===value&&ctrl.$$hasNativeValidators)&&ctrl.$setViewValue(value,event)}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var timeout,deferListener=function(ev,input,origValue){timeout||(timeout=$browser.defer(function(){timeout=null,input&&input.value===origValue||listener(ev)}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener(event,this,this.value)}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),ctrl.$render=function(){element.val(ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue)}}function weekParser(isoWeek,existingDate){if(isDate(isoWeek))return isoWeek;if(isString(isoWeek)){WEEK_REGEXP.lastIndex=0;var parts=WEEK_REGEXP.exec(isoWeek);if(parts){var year=+parts[1],week=+parts[2],hours=0,minutes=0,seconds=0,milliseconds=0,firstThurs=getFirstThursdayOfYear(year),addDays=7*(week-1);return existingDate&&(hours=existingDate.getHours(),minutes=existingDate.getMinutes(),seconds=existingDate.getSeconds(),milliseconds=existingDate.getMilliseconds()),new Date(year,0,firstThurs.getDate()+addDays,hours,minutes,seconds,milliseconds)}}return 0/0}function createDateParser(regexp,mapping){return function(iso,date){var parts,map;if(isDate(iso))return iso;if(isString(iso)){if('"'==iso.charAt(0)&&'"'==iso.charAt(iso.length-1)&&(iso=iso.substring(1,iso.length-1)),ISO_DATE_REGEXP.test(iso))return new Date(iso);if(regexp.lastIndex=0,parts=regexp.exec(iso))return parts.shift(),map=date?{yyyy:date.getFullYear(),MM:date.getMonth()+1,dd:date.getDate(),HH:date.getHours(),mm:date.getMinutes(),ss:date.getSeconds(),sss:date.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},forEach(parts,function(part,index){index<mapping.length&&(map[mapping[index]]=+part)}),new Date(map.yyyy,map.MM-1,map.dd,map.HH,map.mm,map.ss||0,1e3*map.sss||0)}return 0/0}}function createDateInputType(type,regexp,parseDate,format){return function(scope,element,attr,ctrl,$sniffer,$browser,$filter){function isValidDate(value){return value&&!(value.getTime&&value.getTime()!==value.getTime())}function parseObservedDateValue(val){return isDefined(val)?isDate(val)?val:parseDate(val):undefined}badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser);var previousDate,timezone=ctrl&&ctrl.$options&&ctrl.$options.timezone;if(ctrl.$$parserName=type,ctrl.$parsers.push(function(value){if(ctrl.$isEmpty(value))return null;if(regexp.test(value)){var parsedDate=parseDate(value,previousDate);return"UTC"===timezone&&parsedDate.setMinutes(parsedDate.getMinutes()-parsedDate.getTimezoneOffset()),parsedDate}return undefined}),ctrl.$formatters.push(function(value){if(value&&!isDate(value))throw $ngModelMinErr("datefmt","Expected `{0}` to be a date",value);if(isValidDate(value)){if(previousDate=value,previousDate&&"UTC"===timezone){var timezoneOffset=6e4*previousDate.getTimezoneOffset();previousDate=new Date(previousDate.getTime()+timezoneOffset)}return $filter("date")(value,format,timezone)}return previousDate=null,""}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return!isValidDate(value)||isUndefined(minVal)||parseDate(value)>=minVal},attr.$observe("min",function(val){minVal=parseObservedDateValue(val),ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return!isValidDate(value)||isUndefined(maxVal)||parseDate(value)<=maxVal},attr.$observe("max",function(val){maxVal=parseObservedDateValue(val),ctrl.$validate()})}}}function badInputChecker(scope,element,attr,ctrl){var node=element[0],nativeValidation=ctrl.$$hasNativeValidators=isObject(node.validity);nativeValidation&&ctrl.$parsers.push(function(value){var validity=element.prop(VALIDITY_STATE_PROPERTY)||{};return validity.badInput&&!validity.typeMismatch?undefined:value})}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$$parserName="number",ctrl.$parsers.push(function(value){return ctrl.$isEmpty(value)?null:NUMBER_REGEXP.test(value)?parseFloat(value):undefined}),ctrl.$formatters.push(function(value){if(!ctrl.$isEmpty(value)){if(!isNumber(value))throw $ngModelMinErr("numfmt","Expected `{0}` to be a number",value);value=value.toString()}return value}),attr.min||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return ctrl.$isEmpty(value)||isUndefined(minVal)||value>=minVal},attr.$observe("min",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val,10)),minVal=isNumber(val)&&!isNaN(val)?val:undefined,ctrl.$validate()})}if(attr.max||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return ctrl.$isEmpty(value)||isUndefined(maxVal)||maxVal>=value},attr.$observe("max",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val,10)),maxVal=isNumber(val)&&!isNaN(val)?val:undefined,ctrl.$validate()})}}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="url",ctrl.$validators.url=function(modelValue,viewValue){var value=modelValue||viewValue;
return ctrl.$isEmpty(value)||URL_REGEXP.test(value)}}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="email",ctrl.$validators.email=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value)}}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid());var listener=function(ev){element[0].checked&&ctrl.$setViewValue(attr.value,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function parseConstantExpr($parse,context,name,expression,fallback){var parseFn;if(isDefined(expression)){if(parseFn=$parse(expression),!parseFn.constant)throw minErr("ngModel")("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",name,expression);return parseFn(context)}return fallback}function checkboxInputType(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){var trueValue=parseConstantExpr($parse,scope,"ngTrueValue",attr.ngTrueValue,!0),falseValue=parseConstantExpr($parse,scope,"ngFalseValue",attr.ngFalseValue,!1),listener=function(ev){ctrl.$setViewValue(element[0].checked,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value===!1},ctrl.$formatters.push(function(value){return equals(value,trueValue)}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){if(isArray(classVal))return classVal;if(isString(classVal))return classVal.split(" ");if(isObject(classVal)){var classes=[];return forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes}return classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||{},classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toAdd=digestClassCounts(toAdd,1),toRemove=digestClassCounts(toRemove,-1),toAdd&&toAdd.length&&$animate.addClass(element,toAdd),toRemove&&toRemove.length&&$animate.removeClass(element,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||scope.$index%2===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}function addSetValidityMethod(context){function setValidity(validationErrorKey,state,controller){state===undefined?createAndSet("$pending",validationErrorKey,controller):unsetAndCleanup("$pending",validationErrorKey,controller),isBoolean(state)?state?(unset(ctrl.$error,validationErrorKey,controller),set(ctrl.$$success,validationErrorKey,controller)):(set(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)):(unset(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)),ctrl.$pending?(cachedToggleClass(PENDING_CLASS,!0),ctrl.$valid=ctrl.$invalid=undefined,toggleValidationCss("",null)):(cachedToggleClass(PENDING_CLASS,!1),ctrl.$valid=isObjectEmpty(ctrl.$error),ctrl.$invalid=!ctrl.$valid,toggleValidationCss("",ctrl.$valid));var combinedState;combinedState=ctrl.$pending&&ctrl.$pending[validationErrorKey]?undefined:ctrl.$error[validationErrorKey]?!1:ctrl.$$success[validationErrorKey]?!0:null,toggleValidationCss(validationErrorKey,combinedState),parentForm.$setValidity(validationErrorKey,combinedState,ctrl)}function createAndSet(name,value,controller){ctrl[name]||(ctrl[name]={}),set(ctrl[name],value,controller)}function unsetAndCleanup(name,value,controller){ctrl[name]&&unset(ctrl[name],value,controller),isObjectEmpty(ctrl[name])&&(ctrl[name]=undefined)}function cachedToggleClass(className,switchValue){switchValue&&!classCache[className]?($animate.addClass($element,className),classCache[className]=!0):!switchValue&&classCache[className]&&($animate.removeClass($element,className),classCache[className]=!1)}function toggleValidationCss(validationErrorKey,isValid){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",cachedToggleClass(VALID_CLASS+validationErrorKey,isValid===!0),cachedToggleClass(INVALID_CLASS+validationErrorKey,isValid===!1)}var ctrl=context.ctrl,$element=context.$element,classCache={},set=context.set,unset=context.unset,parentForm=context.parentForm,$animate=context.$animate;classCache[INVALID_CLASS]=!(classCache[VALID_CLASS]=$element.hasClass(VALID_CLASS)),ctrl.$setValidity=setValidity}function isObjectEmpty(obj){if(obj)for(var prop in obj)return!1;return!0}var REGEX_STRING_REGEXP=/^\/(.+)\/([a-z]*)$/,VALIDITY_STATE_PROPERTY="validity",lowercase=function(string){return isString(string)?string.toLowerCase():string},hasOwnProperty=Object.prototype.hasOwnProperty,uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,slice=[].slice,splice=[].splice,push=[].push,toString=Object.prototype.toString,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=0;msie=document.documentMode,noop.$inject=[],identity.$inject=[];var skipDestroyOnNextJQueryCleanData,isArray=Array.isArray,trim=function(value){return isString(value)?value.trim():value},escapeForRegexp=function(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},csp=function(){if(isDefined(csp.isActive_))return csp.isActive_;var active=!(!document.querySelector("[ng-csp]")&&!document.querySelector("[data-ng-csp]"));if(!active)try{new Function("")}catch(e){active=!0}return csp.isActive_=active},ngAttrPrefixes=["ng-","data-ng-","ng:","x-ng-"],SNAKE_CASE_REGEXP=/[A-Z]/g,bindJQueryFired=!1,NODE_TYPE_ELEMENT=1,NODE_TYPE_TEXT=3,NODE_TYPE_COMMENT=8,NODE_TYPE_DOCUMENT=9,NODE_TYPE_DOCUMENT_FRAGMENT=11,version={full:"1.3.13",major:1,minor:3,dot:13,codeName:"meticulous-riffleshuffle"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=function(element,type,fn){element.addEventListener(type,fn,!1)},removeEventListenerFn=function(element,type,fn){element.removeEventListener(type,fn,!1)};JQLite._data=function(node){return this.cache[node[this.expando]]||{}};var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,MOUSE_EVENT_MAP={mouseleave:"mouseout",mouseenter:"mouseover"},jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===document.readyState?setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[value]=!0});var ALIASED_ATTR={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};forEach({data:jqLiteData,removeData:jqLiteRemoveData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){return name=camelCase(name),isDefined(value)?void(element.style[name]=value):element.style[name]},attr:function(element,name,value){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){if(isUndefined(value)){var nodeType=element.nodeType;return nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_TEXT?element.textContent:""}element.textContent=value}return getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if(element.multiple&&"select"===nodeName_(element)){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){return isUndefined(value)?element.innerHTML:(jqLiteDealoc(element,!0),void(element.innerHTML=value))},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)===undefined){if(isObject(arg1)){for(i=0;nodeCount>i;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=value===undefined?Math.min(nodeCount,1):nodeCount,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;nodeCount>i;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,on:function jqLiteOn(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(jqLiteAcceptsData(element)){var expandoStore=jqLiteExpandoStore(element,!0),events=expandoStore.events,handle=expandoStore.handle;handle||(handle=expandoStore.handle=createEventHandler(element,events));for(var types=type.indexOf(" ")>=0?type.split(" "):[type],i=types.length;i--;){type=types[i];var eventFns=events[type];eventFns||(events[type]=[],"mouseenter"===type||"mouseleave"===type?jqLiteOn(element,MOUSE_EVENT_MAP[type],function(event){var target=this,related=event.relatedTarget;(!related||related!==target&&!target.contains(related))&&handle(event,type)}):"$destroy"!==type&&addEventListenerFn(element,type,handle),eventFns=events[type]),eventFns.push(fn)}}},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){element.nodeType===NODE_TYPE_ELEMENT&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){var nodeType=element.nodeType;if(nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_DOCUMENT_FRAGMENT){node=new JQLite(node);for(var i=0,ii=node.length;ii>i;i++){var child=node[i];element.appendChild(child)}}},prepend:function(element,node){if(element.nodeType===NODE_TYPE_ELEMENT){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){wrapNode=jqLite(wrapNode).eq(0).clone()[0];var parent=element.parentNode;parent&&parent.replaceChild(wrapNode,element),wrapNode.appendChild(element)},remove:jqLiteRemove,detach:function(element){jqLiteRemove(element,!0)},after:function(element,newElement){var index=element,parent=element.parentNode;newElement=new JQLite(newElement);for(var i=0,ii=newElement.length;ii>i;i++){var node=newElement[i];parent.insertBefore(node,index.nextSibling),index=node}},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&parent.nodeType!==NODE_TYPE_DOCUMENT_FRAGMENT?parent:null},next:function(element){return element.nextElementSibling},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,eventFns=events&&events[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){dummyEvent.isImmediatePropagationStopped()||fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0,ii=this.length;ii>i;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var FN_ARGS=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector");createInjector.$$annotate=annotate;var $animateMinErr=minErr("$animate"),$AnimateProvider=["$provide",function($provide){this.$$selectors={},this.register=function(name,factory){var key=name+"-animation";if(name&&"."!=name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);this.$$selectors[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){return 1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null),this.$$classNameFilter},this.$get=["$$q","$$asyncCallback","$rootScope",function($$q,$$asyncCallback,$rootScope){function runAnimationPostDigest(fn){var cancelFn,defer=$$q.defer();return defer.promise.$$cancelFn=function(){cancelFn&&cancelFn()},$rootScope.$$postDigest(function(){cancelFn=fn(function(){defer.resolve()})}),defer.promise}function resolveElementClasses(element,classes){var toAdd=[],toRemove=[],hasClasses=createMap();return forEach((element.attr("class")||"").split(/\s+/),function(className){hasClasses[className]=!0}),forEach(classes,function(status,className){var hasClass=hasClasses[className];status===!1&&hasClass?toRemove.push(className):status!==!0||hasClass||toAdd.push(className)}),toAdd.length+toRemove.length>0&&[toAdd.length?toAdd:null,toRemove.length?toRemove:null]}function cachedClassManipulation(cache,classes,op){for(var i=0,ii=classes.length;ii>i;++i){var className=classes[i];cache[className]=op}}function asyncPromise(){return currentDefer||(currentDefer=$$q.defer(),$$asyncCallback(function(){currentDefer.resolve(),currentDefer=null})),currentDefer.promise}function applyStyles(element,options){if(angular.isObject(options)){var styles=extend(options.from||{},options.to||{});element.css(styles)}}var currentDefer;return{animate:function(element,from,to){return applyStyles(element,{from:from,to:to}),asyncPromise()},enter:function(element,parent,after,options){return applyStyles(element,options),after?after.after(element):parent.prepend(element),asyncPromise()},leave:function(element){return element.remove(),asyncPromise()},move:function(element,parent,after,options){return this.enter(element,parent,after,options)},addClass:function(element,className,options){return this.setClass(element,className,[],options)},$$addClassImmediately:function(element,className,options){return element=jqLite(element),className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteAddClass(element,className)}),applyStyles(element,options),asyncPromise()},removeClass:function(element,className,options){return this.setClass(element,[],className,options)},$$removeClassImmediately:function(element,className,options){return element=jqLite(element),className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteRemoveClass(element,className)}),applyStyles(element,options),asyncPromise()},setClass:function(element,add,remove,options){var self=this,STORAGE_KEY="$$animateClasses",createdCache=!1;element=jqLite(element);var cache=element.data(STORAGE_KEY);cache?options&&cache.options&&(cache.options=angular.extend(cache.options||{},options)):(cache={classes:{},options:options},createdCache=!0);var classes=cache.classes;return add=isArray(add)?add:add.split(" "),remove=isArray(remove)?remove:remove.split(" "),cachedClassManipulation(classes,add,!0),cachedClassManipulation(classes,remove,!1),createdCache&&(cache.promise=runAnimationPostDigest(function(done){var cache=element.data(STORAGE_KEY);if(element.removeData(STORAGE_KEY),cache){var classes=resolveElementClasses(element,cache.classes);classes&&self.$$setClassImmediately(element,classes[0],classes[1],cache.options)}done()}),element.data(STORAGE_KEY,cache)),cache.promise},$$setClassImmediately:function(element,add,remove,options){return add&&this.$$addClassImmediately(element,add),remove&&this.$$removeClassImmediately(element,remove),applyStyles(element,options),asyncPromise()},enabled:noop,cancel:noop}}]}],$compileMinErr=minErr("$compile");$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"];var PREFIX_REGEXP=/^((?:x|data)[\:\-_])/i,$controllerMinErr=minErr("$controller"),APPLICATION_JSON="application/json",CONTENT_TYPE_APPLICATION_JSON={"Content-Type":APPLICATION_JSON+";charset=utf-8"},JSON_START=/^\[|^\{(?!\{)/,JSON_ENDS={"[":/]$/,"{":/}$/},JSON_PROTECTION_PREFIX=/^\)\]\}',?\n/,$interpolateMinErr=minErr("$interpolate"),PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location"),locationPrototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return(match[1]||""===url)&&this.path(decodeURIComponent(match[1])),(match[2]||match[1]||""===url)&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");search=copy(search,{}),forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};forEach([LocationHashbangInHtml5Url,LocationHashbangUrl,LocationHtml5Url],function(Location){Location.prototype=Object.create(locationPrototype),Location.prototype.state=function(state){if(!arguments.length)return this.$$state;if(Location!==LocationHtml5Url||!this.$$html5)throw $locationMinErr("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=isUndefined(state)?null:state,this}});var $parseMinErr=minErr("$parse"),CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,CONSTANTS=createMap();forEach({"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:function(){}},function(constantGetter,name){constantGetter.constant=constantGetter.literal=constantGetter.sharedGetter=!0,CONSTANTS[name]=constantGetter}),CONSTANTS["this"]=function(self){return self},CONSTANTS["this"].sharedGetter=!0;var OPERATORS=extend(createMap(),{"+":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),isDefined(a)?isDefined(b)?a+b:a:isDefined(b)?b:undefined},"-":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),(isDefined(a)?a:0)-(isDefined(b)?b:0)},"*":function(self,locals,a,b){return a(self,locals)*b(self,locals)},"/":function(self,locals,a,b){return a(self,locals)/b(self,locals)},"%":function(self,locals,a,b){return a(self,locals)%b(self,locals)},"===":function(self,locals,a,b){return a(self,locals)===b(self,locals)},"!==":function(self,locals,a,b){return a(self,locals)!==b(self,locals)},"==":function(self,locals,a,b){return a(self,locals)==b(self,locals)},"!=":function(self,locals,a,b){return a(self,locals)!=b(self,locals)},"<":function(self,locals,a,b){return a(self,locals)<b(self,locals)},">":function(self,locals,a,b){return a(self,locals)>b(self,locals)},"<=":function(self,locals,a,b){return a(self,locals)<=b(self,locals)},">=":function(self,locals,a,b){return a(self,locals)>=b(self,locals)},"&&":function(self,locals,a,b){return a(self,locals)&&b(self,locals)},"||":function(self,locals,a,b){return a(self,locals)||b(self,locals)},"!":function(self,locals,a){return!a(self,locals)},"=":!0,"|":!0}),ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.tokens=[];this.index<this.text.length;){var ch=this.text.charAt(this.index);if('"'===ch||"'"===ch)this.readString(ch);else if(this.isNumber(ch)||"."===ch&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(ch))this.readIdent();else if(this.is(ch,"(){}[].,;:?"))this.tokens.push({index:this.index,text:ch}),this.index++;else if(this.isWhitespace(ch))this.index++;else{var ch2=ch+this.peek(),ch3=ch2+this.peek(2),op1=OPERATORS[ch],op2=OPERATORS[ch2],op3=OPERATORS[ch3];if(op1||op2||op3){var token=op3?ch3:op2?ch2:ch;this.tokens.push({index:this.index,text:token,operator:!0}),this.index+=token.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(ch,chars){return-1!==chars.indexOf(ch)},peek:function(i){var num=i||1;return this.index+num<this.text.length?this.text.charAt(this.index+num):!1},isNumber:function(ch){return ch>="0"&&"9">=ch&&"string"==typeof ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"	"===ch||"\n"===ch||""===ch||" "===ch},isIdent:function(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"===ch||"$"===ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:start,text:number,constant:!0,value:Number(number)})},readIdent:function(){for(var start=this.index;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(!this.isIdent(ch)&&!this.isNumber(ch))break;this.index++}this.tokens.push({index:start,text:this.text.slice(start,this.index),identifier:!0})},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,constant:!0,value:string});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options};Parser.ZERO=extend(function(){return 0},{sharedGetter:!0,constant:!0}),Parser.prototype={constructor:Parser,parse:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value.literal=!!value.literal,value.constant=!!value.constant,value},primary:function(){var primary;this.expect("(")?(primary=this.filterChain(),this.consume(")")):this.expect("[")?primary=this.arrayDeclaration():this.expect("{")?primary=this.object():this.peek().identifier&&this.peek().text in CONSTANTS?primary=CONSTANTS[this.consume().text]:this.peek().identifier?primary=this.identifier():this.peek().constant?primary=this.constant():this.throwError("not a primary expression",this.peek());for(var next,context;next=this.expect("(","[",".");)"("===next.text?(primary=this.functionCall(primary,context),context=null):"["===next.text?(context=primary,primary=this.objectIndex(primary)):"."===next.text?(context=primary,primary=this.fieldAccess(primary)):this.throwError("IMPOSSIBLE");return primary},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){return this.peekAhead(0,e1,e2,e3,e4)},peekAhead:function(i,e1,e2,e3,e4){if(this.tokens.length>i){var token=this.tokens[i],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return token?(this.tokens.shift(),token):!1},consume:function(e1){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);var token=this.expect(e1);return token||this.throwError("is unexpected, expecting ["+e1+"]",this.peek()),token},unaryFn:function(op,right){var fn=OPERATORS[op];return extend(function(self,locals){return fn(self,locals,right)},{constant:right.constant,inputs:[right]})},binaryFn:function(left,op,right,isBranching){var fn=OPERATORS[op];return extend(function(self,locals){return fn(self,locals,left,right)},{constant:left.constant&&right.constant,inputs:!isBranching&&[left,right]})},identifier:function(){for(var id=this.consume().text;this.peek(".")&&this.peekAhead(1).identifier&&!this.peekAhead(2,"(");)id+=this.consume().text+this.consume().text;return getterFn(id,this.options,this.text)},constant:function(){var value=this.consume().value;return extend(function(){return value},{constant:!0,literal:!0})},statements:function(){for(var statements=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&statements.push(this.filterChain()),!this.expect(";"))return 1===statements.length?statements[0]:function(self,locals){for(var value,i=0,ii=statements.length;ii>i;i++)value=statements[i](self,locals);return value}},filterChain:function(){for(var token,left=this.expression();token=this.expect("|");)left=this.filter(left);return left},filter:function(inputFn){var argsFn,args,fn=this.$filter(this.consume().text);if(this.peek(":"))for(argsFn=[],args=[];this.expect(":");)argsFn.push(this.expression());var inputs=[inputFn].concat(argsFn||[]);return extend(function(self,locals){var input=inputFn(self,locals);if(args){args[0]=input;for(var i=argsFn.length;i--;)args[i+1]=argsFn[i](self,locals);return fn.apply(undefined,args)}return fn(input)},{constant:!fn.$stateful&&inputs.every(isConstant),inputs:!fn.$stateful&&inputs})
},expression:function(){return this.assignment()},assignment:function(){var right,token,left=this.ternary();return(token=this.expect("="))?(left.assign||this.throwError("implies assignment but ["+this.text.substring(0,token.index)+"] can not be assigned to",token),right=this.ternary(),extend(function(scope,locals){return left.assign(scope,right(scope,locals),locals)},{inputs:[left,right]})):left},ternary:function(){var middle,token,left=this.logicalOR();if((token=this.expect("?"))&&(middle=this.assignment(),this.consume(":"))){var right=this.assignment();return extend(function(self,locals){return left(self,locals)?middle(self,locals):right(self,locals)},{constant:left.constant&&middle.constant&&right.constant})}return left},logicalOR:function(){for(var token,left=this.logicalAND();token=this.expect("||");)left=this.binaryFn(left,token.text,this.logicalAND(),!0);return left},logicalAND:function(){for(var token,left=this.equality();token=this.expect("&&");)left=this.binaryFn(left,token.text,this.equality(),!0);return left},equality:function(){for(var token,left=this.relational();token=this.expect("==","!=","===","!==");)left=this.binaryFn(left,token.text,this.relational());return left},relational:function(){for(var token,left=this.additive();token=this.expect("<",">","<=",">=");)left=this.binaryFn(left,token.text,this.additive());return left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left=this.binaryFn(left,token.text,this.multiplicative());return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left=this.binaryFn(left,token.text,this.unary());return left},unary:function(){var token;return this.expect("+")?this.primary():(token=this.expect("-"))?this.binaryFn(Parser.ZERO,token.text,this.unary()):(token=this.expect("!"))?this.unaryFn(token.text,this.unary()):this.primary()},fieldAccess:function(object){var getter=this.identifier();return extend(function(scope,locals,self){var o=self||object(scope,locals);return null==o?undefined:getter(o)},{assign:function(scope,value,locals){var o=object(scope,locals);return o||object.assign(scope,o={},locals),getter.assign(o,value)}})},objectIndex:function(obj){var expression=this.text,indexFn=this.expression();return this.consume("]"),extend(function(self,locals){var v,o=obj(self,locals),i=indexFn(self,locals);return ensureSafeMemberName(i,expression),o?v=ensureSafeObject(o[i],expression):undefined},{assign:function(self,value,locals){var key=ensureSafeMemberName(indexFn(self,locals),expression),o=ensureSafeObject(obj(self,locals),expression);return o||obj.assign(self,o={},locals),o[key]=value}})},functionCall:function(fnGetter,contextGetter){var argsFn=[];if(")"!==this.peekToken().text)do argsFn.push(this.expression());while(this.expect(","));this.consume(")");var expressionText=this.text,args=argsFn.length?[]:null;return function(scope,locals){var context=contextGetter?contextGetter(scope,locals):isDefined(contextGetter)?undefined:scope,fn=fnGetter(scope,locals,context)||noop;if(args)for(var i=argsFn.length;i--;)args[i]=ensureSafeObject(argsFn[i](scope,locals),expressionText);ensureSafeObject(context,expressionText),ensureSafeFunction(fn,expressionText);var v=fn.apply?fn.apply(context,args):fn(args[0],args[1],args[2],args[3],args[4]);return args&&(args.length=0),ensureSafeObject(v,expressionText)}},arrayDeclaration:function(){var elementFns=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;elementFns.push(this.expression())}while(this.expect(","));return this.consume("]"),extend(function(self,locals){for(var array=[],i=0,ii=elementFns.length;ii>i;i++)array.push(elementFns[i](self,locals));return array},{literal:!0,constant:elementFns.every(isConstant),inputs:elementFns})},object:function(){var keys=[],valueFns=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var token=this.consume();token.constant?keys.push(token.value):token.identifier?keys.push(token.text):this.throwError("invalid key",token),this.consume(":"),valueFns.push(this.expression())}while(this.expect(","));return this.consume("}"),extend(function(self,locals){for(var object={},i=0,ii=valueFns.length;ii>i;i++)object[keys[i]]=valueFns[i](self,locals);return object},{literal:!0,constant:valueFns.every(isConstant),inputs:valueFns})}};var getterFnCacheDefault=createMap(),getterFnCacheExpensive=createMap(),objectValueOf=Object.prototype.valueOf,$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},$compileMinErr=minErr("$compile"),urlParsingNode=document.createElement("a"),originUrl=urlResolve(window.location.href);$FilterProvider.$inject=["$provide"],currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DECIMAL_SEP=".",DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter,ww:weekGetter(2),w:weekGetter(1)},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZEw']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|w+))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return attr.href||attr.xlinkHref||attr.name?void 0:function(scope,element){if("a"===element[0].nodeName.toLowerCase()){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{restrict:"A",priority:100,link:function(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}}}}}),forEach(ALIASED_ATTR,function(htmlAttr,ngAttr){ngAttributeAliasDirectives[ngAttr]=function(){return{priority:100,link:function(scope,element,attr){if("ngPattern"===ngAttr&&"/"==attr.ngPattern.charAt(0)){var match=attr.ngPattern.match(REGEX_STRING_REGEXP);if(match)return void attr.$set("ngPattern",new RegExp(match[1],match[2]))}scope.$watch(attr[ngAttr],function(value){attr.$set(ngAttr,value)})}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),void(msie&&propName&&element.prop(propName,attr[name]))):void("href"===attrName&&attr.$set(name,null))})}}}});var nullFormCtrl={$addControl:noop,$$renameControl:nullFormRenameControl,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop,$setSubmitted:noop},SUBMITTED_CLASS="ng-submitted";FormController.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var formDirectiveFactory=function(isNgForm){return["$timeout",function($timeout){var formDirective={name:"form",restrict:isNgForm?"EAC":"E",controller:FormController,compile:function(formElement){return formElement.addClass(PRISTINE_CLASS).addClass(VALID_CLASS),{pre:function(scope,formElement,attr,controller){if(!("action"in attr)){var handleFormSubmission=function(event){scope.$apply(function(){controller.$commitViewValue(),controller.$setSubmitted()}),event.preventDefault()};addEventListenerFn(formElement[0],"submit",handleFormSubmission),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",handleFormSubmission)},0,!1)})}var parentFormCtrl=controller.$$parentForm,alias=controller.$name;alias&&(setter(scope,null,alias,controller,alias),attr.$observe(attr.name?"name":"ngForm",function(newValue){alias!==newValue&&(setter(scope,null,alias,undefined,alias),alias=newValue,setter(scope,null,alias,controller,alias),parentFormCtrl.$$renameControl(controller,alias))})),formElement.on("$destroy",function(){parentFormCtrl.$removeControl(controller),alias&&setter(scope,null,alias,undefined,alias),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),ISO_DATE_REGEXP=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,URL_REGEXP=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,DATE_REGEXP=/^(\d{4})-(\d{2})-(\d{2})$/,DATETIMELOCAL_REGEXP=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,WEEK_REGEXP=/^(\d{4})-W(\d\d)$/,MONTH_REGEXP=/^(\d{4})-(\d\d)$/,TIME_REGEXP=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,inputType={text:textInputType,date:createDateInputType("date",DATE_REGEXP,createDateParser(DATE_REGEXP,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":createDateInputType("datetimelocal",DATETIMELOCAL_REGEXP,createDateParser(DATETIMELOCAL_REGEXP,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:createDateInputType("time",TIME_REGEXP,createDateParser(TIME_REGEXP,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:createDateInputType("week",WEEK_REGEXP,weekParser,"yyyy-Www"),month:createDateInputType("month",MONTH_REGEXP,createDateParser(MONTH_REGEXP,["yyyy","MM"]),"yyyy-MM"),number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},inputDirective=["$browser","$sniffer","$filter","$parse",function($browser,$sniffer,$filter,$parse){return{restrict:"E",require:["?ngModel"],link:{pre:function(scope,element,attr,ctrls){ctrls[0]&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrls[0],$sniffer,$browser,$filter,$parse)}}}}],CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{restrict:"A",priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=["$compile",function($compile){return{restrict:"AC",compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBind),element=element[0],scope.$watch(attr.ngBind,function(value){element.textContent=value===undefined?"":value})}}}}],ngBindTemplateDirective=["$interpolate","$compile",function($interpolate,$compile){return{compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));$compile.$$addBindingInfo(element,interpolateFn.expressions),element=element[0],attr.$observe("ngBindTemplate",function(value){element.textContent=value===undefined?"":value})}}}}],ngBindHtmlDirective=["$sce","$parse","$compile",function($sce,$parse,$compile){return{restrict:"A",compile:function(tElement,tAttrs){var ngBindHtmlGetter=$parse(tAttrs.ngBindHtml),ngBindHtmlWatch=$parse(tAttrs.ngBindHtml,function(value){return(value||"").toString()});return $compile.$$addBindingClass(tElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBindHtml),scope.$watch(ngBindHtmlWatch,function(){element.html($sce.getTrustedHtml(ngBindHtmlGetter(scope))||"")})}}}}],ngChangeDirective=valueFn({restrict:"A",require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{restrict:"A",compile:function($element,attr){var fn=$parse(attr[directiveName],null,!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate",function($animate){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){value?childScope||$transclude(function(clone,newScope){childScope=newScope,clone[clone.length++]=document.createComment(" end ngIf: "+$attr.ngIf+" "),block={clone:clone},$animate.enter(clone,$element.parent(),$element)}):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockNodes(block.clone),$animate.leave(previousElements).then(function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$templateRequest","$anchorScroll","$animate","$sce",function($templateRequest,$anchorScroll,$animate,$sce){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement).then(function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch($sce.parseAsResourceUrl(srcExp),function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($templateRequest(src,!0).then(function(response){if(thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element).then(afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded",src),scope.$eval(onloadExp)}},function(){thisChangeId===changeCounter&&(cleanupLastIncludeContent(),scope.$emit("$includeContentError",src))}),scope.$emit("$includeContentRequested",src)):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){return/SVG/.test($element[0].toString())?($element.empty(),void $compile(jqLiteBuildFragment(ctrl.template,document).childNodes)(scope,function(clone){$element.append(clone)},{futureParentElement:$element})):($element.html(ctrl.template),void $compile($element.contents())(scope))}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngListDirective=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(scope,element,attr,ctrl){var ngList=element.attr(attr.$attr.ngList)||", ",trimValues="false"!==attr.ngTrim,separator=trimValues?trim(ngList):ngList,parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trimValues?trim(value):value)}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(ngList):undefined}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",UNTOUCHED_CLASS="ng-untouched",TOUCHED_CLASS="ng-touched",PENDING_CLASS="ng-pending",$ngModelMinErr=new minErr("ngModel"),NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate,$timeout,$rootScope,$q,$interpolate){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=undefined,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=undefined,this.$name=$interpolate($attr.name||"",!1)($scope);var parsedNgModel=$parse($attr.ngModel),parsedNgModelAssign=parsedNgModel.assign,ngModelGet=parsedNgModel,ngModelSet=parsedNgModelAssign,pendingDebounce=null,ctrl=this;this.$$setOptions=function(options){if(ctrl.$options=options,options&&options.getterSetter){var invokeModelGetter=$parse($attr.ngModel+"()"),invokeModelSetter=$parse($attr.ngModel+"($$$p)");ngModelGet=function($scope){var modelValue=parsedNgModel($scope);return isFunction(modelValue)&&(modelValue=invokeModelGetter($scope)),modelValue},ngModelSet=function($scope){isFunction(parsedNgModel($scope))?invokeModelSetter($scope,{$$$p:ctrl.$modelValue}):parsedNgModelAssign($scope,ctrl.$modelValue)}}else if(!parsedNgModel.assign)throw $ngModelMinErr("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element))},this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value};var parentForm=$element.inheritedData("$formController")||nullFormCtrl,currentValidationRunId=0;addSetValidityMethod({ctrl:this,$element:$element,set:function(object,property){object[property]=!0},unset:function(object,property){delete object[property]},parentForm:parentForm,$animate:$animate}),this.$setPristine=function(){ctrl.$dirty=!1,ctrl.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setDirty=function(){ctrl.$dirty=!0,ctrl.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),parentForm.$setDirty()},this.$setUntouched=function(){ctrl.$touched=!1,ctrl.$untouched=!0,$animate.setClass($element,UNTOUCHED_CLASS,TOUCHED_CLASS)},this.$setTouched=function(){ctrl.$touched=!0,ctrl.$untouched=!1,$animate.setClass($element,TOUCHED_CLASS,UNTOUCHED_CLASS)},this.$rollbackViewValue=function(){$timeout.cancel(pendingDebounce),ctrl.$viewValue=ctrl.$$lastCommittedViewValue,ctrl.$render()},this.$validate=function(){if(!isNumber(ctrl.$modelValue)||!isNaN(ctrl.$modelValue)){var viewValue=ctrl.$$lastCommittedViewValue,modelValue=ctrl.$$rawModelValue,parserName=ctrl.$$parserName||"parse",parserValid=ctrl.$error[parserName]?!1:undefined,prevValid=ctrl.$valid,prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$runValidators(parserValid,modelValue,viewValue,function(allValid){allowInvalid||prevValid===allValid||(ctrl.$modelValue=allValid?modelValue:undefined,ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope())})}},this.$$runValidators=function(parseValid,modelValue,viewValue,doneCallback){function processParseErrors(parseValid){var errorKey=ctrl.$$parserName||"parse";if(parseValid===undefined)setValidity(errorKey,null);else if(setValidity(errorKey,parseValid),!parseValid)return forEach(ctrl.$validators,function(v,name){setValidity(name,null)}),forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)}),!1;return!0}function processSyncValidators(){var syncValidatorsValid=!0;return forEach(ctrl.$validators,function(validator,name){var result=validator(modelValue,viewValue);syncValidatorsValid=syncValidatorsValid&&result,setValidity(name,result)}),syncValidatorsValid?!0:(forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)}),!1)}function processAsyncValidators(){var validatorPromises=[],allValid=!0;forEach(ctrl.$asyncValidators,function(validator,name){var promise=validator(modelValue,viewValue);if(!isPromiseLike(promise))throw $ngModelMinErr("$asyncValidators","Expected asynchronous validator to return a promise but got '{0}' instead.",promise);setValidity(name,undefined),validatorPromises.push(promise.then(function(){setValidity(name,!0)},function(){allValid=!1,setValidity(name,!1)}))}),validatorPromises.length?$q.all(validatorPromises).then(function(){validationDone(allValid)},noop):validationDone(!0)}function setValidity(name,isValid){localValidationRunId===currentValidationRunId&&ctrl.$setValidity(name,isValid)}function validationDone(allValid){localValidationRunId===currentValidationRunId&&doneCallback(allValid)}currentValidationRunId++;var localValidationRunId=currentValidationRunId;return processParseErrors(parseValid)&&processSyncValidators()?void processAsyncValidators():void validationDone(!1)},this.$commitViewValue=function(){var viewValue=ctrl.$viewValue;$timeout.cancel(pendingDebounce),(ctrl.$$lastCommittedViewValue!==viewValue||""===viewValue&&ctrl.$$hasNativeValidators)&&(ctrl.$$lastCommittedViewValue=viewValue,ctrl.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function writeToModelIfNeeded(){ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope()}var viewValue=ctrl.$$lastCommittedViewValue,modelValue=viewValue,parserValid=isUndefined(modelValue)?undefined:!0;if(parserValid)for(var i=0;i<ctrl.$parsers.length;i++)if(modelValue=ctrl.$parsers[i](modelValue),isUndefined(modelValue)){parserValid=!1;break}isNumber(ctrl.$modelValue)&&isNaN(ctrl.$modelValue)&&(ctrl.$modelValue=ngModelGet($scope));var prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$rawModelValue=modelValue,allowInvalid&&(ctrl.$modelValue=modelValue,writeToModelIfNeeded()),ctrl.$$runValidators(parserValid,modelValue,ctrl.$$lastCommittedViewValue,function(allValid){allowInvalid||(ctrl.$modelValue=allValid?modelValue:undefined,writeToModelIfNeeded())})},this.$$writeModelToScope=function(){ngModelSet($scope,ctrl.$modelValue),forEach(ctrl.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}})},this.$setViewValue=function(value,trigger){ctrl.$viewValue=value,(!ctrl.$options||ctrl.$options.updateOnDefault)&&ctrl.$$debounceViewValueCommit(trigger)},this.$$debounceViewValueCommit=function(trigger){var debounce,debounceDelay=0,options=ctrl.$options;options&&isDefined(options.debounce)&&(debounce=options.debounce,isNumber(debounce)?debounceDelay=debounce:isNumber(debounce[trigger])?debounceDelay=debounce[trigger]:isNumber(debounce["default"])&&(debounceDelay=debounce["default"])),$timeout.cancel(pendingDebounce),debounceDelay?pendingDebounce=$timeout(function(){ctrl.$commitViewValue()},debounceDelay):$rootScope.$$phase?ctrl.$commitViewValue():$scope.$apply(function(){ctrl.$commitViewValue()})},$scope.$watch(function(){var modelValue=ngModelGet($scope);if(modelValue!==ctrl.$modelValue){ctrl.$modelValue=ctrl.$$rawModelValue=modelValue;for(var formatters=ctrl.$formatters,idx=formatters.length,viewValue=modelValue;idx--;)viewValue=formatters[idx](viewValue);ctrl.$viewValue!==viewValue&&(ctrl.$viewValue=ctrl.$$lastCommittedViewValue=viewValue,ctrl.$render(),ctrl.$$runValidators(undefined,modelValue,viewValue,noop))}return modelValue})}],ngModelDirective=["$rootScope",function($rootScope){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:NgModelController,priority:1,compile:function(element){return element.addClass(PRISTINE_CLASS).addClass(UNTOUCHED_CLASS).addClass(VALID_CLASS),{pre:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||nullFormCtrl;modelCtrl.$$setOptions(ctrls[2]&&ctrls[2].$options),formCtrl.$addControl(modelCtrl),attr.$observe("name",function(newValue){modelCtrl.$name!==newValue&&formCtrl.$$renameControl(modelCtrl,newValue)}),scope.$on("$destroy",function(){formCtrl.$removeControl(modelCtrl)})},post:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];modelCtrl.$options&&modelCtrl.$options.updateOn&&element.on(modelCtrl.$options.updateOn,function(ev){modelCtrl.$$debounceViewValueCommit(ev&&ev.type)}),element.on("blur",function(){modelCtrl.$touched||($rootScope.$$phase?scope.$evalAsync(modelCtrl.$setTouched):scope.$apply(modelCtrl.$setTouched))})}}}}}],DEFAULT_REGEXP=/(\s+|^)default(\s+|$)/,ngModelOptionsDirective=function(){return{restrict:"A",controller:["$scope","$attrs",function($scope,$attrs){var that=this;this.$options=$scope.$eval($attrs.ngModelOptions),this.$options.updateOn!==undefined?(this.$options.updateOnDefault=!1,this.$options.updateOn=trim(this.$options.updateOn.replace(DEFAULT_REGEXP,function(){return that.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngPluralizeDirective=["$locale","$interpolate",function($locale,$interpolate){var BRACE=/{}/g,IS_WHEN=/^when(Minus)?(.+)$/;return{restrict:"EA",link:function(scope,element,attr){function updateElementText(newText){element.text(newText||"")}var lastCount,numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),braceReplacement=startSymbol+numberExp+"-"+offset+endSymbol,watchRemover=angular.noop;forEach(attr,function(expression,attributeName){var tmpMatch=IS_WHEN.exec(attributeName);if(tmpMatch){var whenKey=(tmpMatch[1]?"-":"")+lowercase(tmpMatch[2]);whens[whenKey]=element.attr(attr.$attr[attributeName])}}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,braceReplacement))}),scope.$watch(numberExp,function(newVal){var count=parseFloat(newVal),countIsNaN=isNaN(count);countIsNaN||count in whens||(count=$locale.pluralCat(count-offset)),count===lastCount||countIsNaN&&isNaN(lastCount)||(watchRemover(),watchRemover=scope.$watch(whensExpFns[count],updateElementText),lastCount=count)})}}}],ngRepeatDirective=["$parse","$animate",function($parse,$animate){var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat"),updateScope=function(scope,index,valueIdentifier,value,keyIdentifier,key,arrayLength){scope[valueIdentifier]=value,keyIdentifier&&(scope[keyIdentifier]=key),scope.$index=index,scope.$first=0===index,scope.$last=index===arrayLength-1,scope.$middle=!(scope.$first||scope.$last),scope.$odd=!(scope.$even=0===(1&index))},getBlockStart=function(block){return block.clone[0]},getBlockEnd=function(block){return block.clone[block.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function($element,$attr){var expression=$attr.ngRepeat,ngRepeatEndComment=document.createComment(" end ngRepeat: "+expression+" "),match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);var lhs=match[1],rhs=match[2],aliasAs=match[3],trackByExp=match[4];if(match=lhs.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);var valueIdentifier=match[3]||match[1],keyIdentifier=match[2];if(aliasAs&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(aliasAs)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(aliasAs)))throw ngRepeatMinErr("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",aliasAs);var trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,hashFnLocals={$id:hashKey};return trackByExp?trackByExpGetter=$parse(trackByExp):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),function($scope,$element,$attr,ctrl,$transclude){trackByExpGetter&&(trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)});var lastBlockMap=createMap();$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,collectionLength,key,value,trackById,trackByIdFn,collectionKeys,block,nextBlockOrder,elementsToRemove,previousNode=$element[0],nextBlockMap=createMap();if(aliasAs&&($scope[aliasAs]=collection),isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(var itemKey in collection)collection.hasOwnProperty(itemKey)&&"$"!=itemKey.charAt(0)&&collectionKeys.push(itemKey);collectionKeys.sort()}for(collectionLength=collectionKeys.length,nextBlockOrder=new Array(collectionLength),index=0;collectionLength>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),lastBlockMap[trackById])block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap[trackById])throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,value);nextBlockOrder[index]={id:trackById,scope:undefined,clone:undefined},nextBlockMap[trackById]=!0}for(var blockKey in lastBlockMap){if(block=lastBlockMap[blockKey],elementsToRemove=getBlockNodes(block.clone),$animate.leave(elementsToRemove),elementsToRemove[0].parentNode)for(index=0,length=elementsToRemove.length;length>index;index++)elementsToRemove[index][NG_REMOVED]=!0;block.scope.$destroy()}for(index=0;collectionLength>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],block.scope){nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockNodes(block.clone),null,jqLite(previousNode)),previousNode=getBlockEnd(block),updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)}else $transclude(function(clone,scope){block.scope=scope;var endNode=ngRepeatEndComment.cloneNode(!1);clone[clone.length++]=endNode,$animate.enter(clone,null,jqLite(previousNode)),previousNode=endNode,block.clone=clone,nextBlockMap[block.id]=block,updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)
});lastBlockMap=nextBlockMap})}}}}],NG_HIDE_CLASS="ng-hide",NG_HIDE_IN_PROGRESS_CLASS="ng-hide-animate",ngShowDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[value?"removeClass":"addClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngHideDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[value?"addClass":"removeClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watchCollection(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)})}),ngSwitchDirective=["$animate",function($animate){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousLeaveAnimations=[],selectedScopes=[],spliceFactory=function(array,index){return function(){array.splice(index,1)}};scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousLeaveAnimations.length;ii>i;++i)$animate.cancel(previousLeaveAnimations[i]);for(previousLeaveAnimations.length=0,i=0,ii=selectedScopes.length;ii>i;++i){var selected=getBlockNodes(selectedElements[i].clone);selectedScopes[i].$destroy();var promise=previousLeaveAnimations[i]=$animate.leave(selected);promise.then(spliceFactory(previousLeaveAnimations,i))}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&forEach(selectedTranscludes,function(selectedTransclude){selectedTransclude.transclude(function(caseElement,selectedScope){selectedScopes.push(selectedScope);var anchor=selectedTransclude.element;caseElement[caseElement.length++]=document.createComment(" end ngSwitchWhen: ");var block={clone:caseElement};selectedElements.push(block),$animate.enter(caseElement,anchor.parent(),anchor)})})})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeDirective=ngDirective({restrict:"EAC",link:function($scope,$element,$attrs,controller,$transclude){if(!$transclude)throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$transclude(function(clone){$element.empty(),$element.append(clone)})}}),scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],ngOptionsMinErr=minErr("ngOptions"),ngOptionsDirective=valueFn({restrict:"A",terminal:!0}),selectDirective=["$compile","$parse",function($compile,$parse){var NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,nullModelCtrl={$setViewValue:noop};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function($element,$scope,$attrs){var nullOption,unknownOption,self=this,optionsMap={},ngModelCtrl=nullModelCtrl;self.databound=$attrs.ngModel,self.init=function(ngModelCtrl_,nullOption_,unknownOption_){ngModelCtrl=ngModelCtrl_,nullOption=nullOption_,unknownOption=unknownOption_},self.addOption=function(value,element){assertNotHasOwnProperty(value,'"option value"'),optionsMap[value]=!0,ngModelCtrl.$viewValue==value&&($element.val(value),unknownOption.parent()&&unknownOption.remove()),element&&element[0].hasAttribute("selected")&&(element[0].selected=!0)},self.removeOption=function(value){this.hasOption(value)&&(delete optionsMap[value],ngModelCtrl.$viewValue===value&&this.renderUnknownOption(value))},self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";unknownOption.val(unknownVal),$element.prepend(unknownOption),$element.val(unknownVal),unknownOption.prop("selected",!0)},self.hasOption=function(value){return optionsMap.hasOwnProperty(value)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop})}],link:function(scope,element,attr,ctrls){function setupAsSingle(scope,selectElement,ngModelCtrl,selectCtrl){ngModelCtrl.$render=function(){var viewValue=ngModelCtrl.$viewValue;selectCtrl.hasOption(viewValue)?(unknownOption.parent()&&unknownOption.remove(),selectElement.val(viewValue),""===viewValue&&emptyOption.prop("selected",!0)):isUndefined(viewValue)&&emptyOption?selectElement.val(""):selectCtrl.renderUnknownOption(viewValue)},selectElement.on("change",function(){scope.$apply(function(){unknownOption.parent()&&unknownOption.remove(),ngModelCtrl.$setViewValue(selectElement.val())})})}function setupAsMultiple(scope,selectElement,ctrl){var lastView;ctrl.$render=function(){var items=new HashMap(ctrl.$viewValue);forEach(selectElement.find("option"),function(option){option.selected=isDefined(items.get(option.value))})},scope.$watch(function(){equals(lastView,ctrl.$viewValue)||(lastView=shallowCopy(ctrl.$viewValue),ctrl.$render())}),selectElement.on("change",function(){scope.$apply(function(){var array=[];forEach(selectElement.find("option"),function(option){option.selected&&array.push(option.value)}),ctrl.$setViewValue(array)})})}function setupAsOptions(scope,selectElement,ctrl){function callExpression(exprFn,key,value){return locals[valueName]=value,keyName&&(locals[keyName]=key),exprFn(scope,locals)}function selectionChanged(){scope.$apply(function(){var viewValue,collection=valuesFn(scope)||[];if(multiple)viewValue=[],forEach(selectElement.val(),function(selectedKey){selectedKey=trackFn?trackKeysCache[selectedKey]:selectedKey,viewValue.push(getViewValue(selectedKey,collection[selectedKey]))});else{var selectedKey=trackFn?trackKeysCache[selectElement.val()]:selectElement.val();viewValue=getViewValue(selectedKey,collection[selectedKey])}ctrl.$setViewValue(viewValue),render()})}function getViewValue(key,value){if("?"===key)return undefined;if(""===key)return null;var viewValueFn=selectAsFn?selectAsFn:valueFn;return callExpression(viewValueFn,key,value)}function getLabels(){var toDisplay,values=valuesFn(scope);if(values&&isArray(values)){toDisplay=new Array(values.length);for(var i=0,ii=values.length;ii>i;i++)toDisplay[i]=callExpression(displayFn,i,values[i]);return toDisplay}if(values){toDisplay={};for(var prop in values)values.hasOwnProperty(prop)&&(toDisplay[prop]=callExpression(displayFn,prop,values[prop]))}return toDisplay}function createIsSelectedFn(viewValue){var selectedSet;if(multiple)if(trackFn&&isArray(viewValue)){selectedSet=new HashMap([]);for(var trackIndex=0;trackIndex<viewValue.length;trackIndex++)selectedSet.put(callExpression(trackFn,null,viewValue[trackIndex]),!0)}else selectedSet=new HashMap(viewValue);else trackFn&&(viewValue=callExpression(trackFn,null,viewValue));return function(key,value){var compareValueFn;return compareValueFn=trackFn?trackFn:selectAsFn?selectAsFn:valueFn,multiple?isDefined(selectedSet.remove(callExpression(compareValueFn,key,value))):viewValue===callExpression(compareValueFn,key,value)}}function scheduleRendering(){renderScheduled||(scope.$$postDigest(render),renderScheduled=!0)}function updateLabelMap(labelMap,label,added){labelMap[label]=labelMap[label]||0,labelMap[label]+=added?1:-1}function render(){renderScheduled=!1;var optionGroupName,optionGroup,option,existingParent,existingOptions,existingOption,key,value,groupLength,length,groupIndex,index,selected,lastElement,element,label,optionId,optionGroups={"":[]},optionGroupNames=[""],viewValue=ctrl.$viewValue,values=valuesFn(scope)||[],keys=keyName?sortedKeys(values):values,labelMap={},isSelected=createIsSelectedFn(viewValue),anySelected=!1;for(trackKeysCache={},index=0;length=keys.length,length>index;index++)key=index,keyName&&(key=keys[index],"$"===key.charAt(0))||(value=values[key],optionGroupName=callExpression(groupByFn,key,value)||"",(optionGroup=optionGroups[optionGroupName])||(optionGroup=optionGroups[optionGroupName]=[],optionGroupNames.push(optionGroupName)),selected=isSelected(key,value),anySelected=anySelected||selected,label=callExpression(displayFn,key,value),label=isDefined(label)?label:"",optionId=trackFn?trackFn(scope,locals):keyName?keys[index]:index,trackFn&&(trackKeysCache[optionId]=key),optionGroup.push({id:optionId,label:label,selected:selected}));for(multiple||(nullOption||null===viewValue?optionGroups[""].unshift({id:"",label:"",selected:!anySelected}):anySelected||optionGroups[""].unshift({id:"?",label:"",selected:!0})),groupIndex=0,groupLength=optionGroupNames.length;groupLength>groupIndex;groupIndex++){for(optionGroupName=optionGroupNames[groupIndex],optionGroup=optionGroups[optionGroupName],optionGroupsCache.length<=groupIndex?(existingParent={element:optGroupTemplate.clone().attr("label",optionGroupName),label:optionGroup.label},existingOptions=[existingParent],optionGroupsCache.push(existingOptions),selectElement.append(existingParent.element)):(existingOptions=optionGroupsCache[groupIndex],existingParent=existingOptions[0],existingParent.label!=optionGroupName&&existingParent.element.attr("label",existingParent.label=optionGroupName)),lastElement=null,index=0,length=optionGroup.length;length>index;index++)option=optionGroup[index],(existingOption=existingOptions[index+1])?(lastElement=existingOption.element,existingOption.label!==option.label&&(updateLabelMap(labelMap,existingOption.label,!1),updateLabelMap(labelMap,option.label,!0),lastElement.text(existingOption.label=option.label),lastElement.prop("label",existingOption.label)),existingOption.id!==option.id&&lastElement.val(existingOption.id=option.id),lastElement[0].selected!==option.selected&&(lastElement.prop("selected",existingOption.selected=option.selected),msie&&lastElement.prop("selected",existingOption.selected))):(""===option.id&&nullOption?element=nullOption:(element=optionTemplate.clone()).val(option.id).prop("selected",option.selected).attr("selected",option.selected).prop("label",option.label).text(option.label),existingOptions.push(existingOption={element:element,label:option.label,id:option.id,selected:option.selected}),updateLabelMap(labelMap,option.label,!0),lastElement?lastElement.after(element):existingParent.element.append(element),lastElement=element);for(index++;existingOptions.length>index;)option=existingOptions.pop(),updateLabelMap(labelMap,option.label,!1),option.element.remove()}for(;optionGroupsCache.length>groupIndex;){for(optionGroup=optionGroupsCache.pop(),index=1;index<optionGroup.length;++index)updateLabelMap(labelMap,optionGroup[index].label,!1);optionGroup[0].element.remove()}forEach(labelMap,function(count,label){count>0?selectCtrl.addOption(label):0>count&&selectCtrl.removeOption(label)})}var match;if(!(match=optionsExp.match(NG_OPTIONS_REGEXP)))throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var displayFn=$parse(match[2]||match[1]),valueName=match[4]||match[6],selectAs=/ as /.test(match[0])&&match[1],selectAsFn=selectAs?$parse(selectAs):null,keyName=match[5],groupByFn=$parse(match[3]||""),valueFn=$parse(match[2]?match[1]:valueName),valuesFn=$parse(match[7]),track=match[8],trackFn=track?$parse(match[8]):null,trackKeysCache={},optionGroupsCache=[[{element:selectElement,label:""}]],locals={};nullOption&&($compile(nullOption)(scope),nullOption.removeClass("ng-scope"),nullOption.remove()),selectElement.empty(),selectElement.on("change",selectionChanged),ctrl.$render=render,scope.$watchCollection(valuesFn,scheduleRendering),scope.$watchCollection(getLabels,scheduleRendering),multiple&&scope.$watchCollection(function(){return ctrl.$modelValue},scheduleRendering)}if(ctrls[1]){for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,optionsExp=attr.ngOptions,nullOption=!1,renderScheduled=!1,optionTemplate=jqLite(document.createElement("option")),optGroupTemplate=jqLite(document.createElement("optgroup")),unknownOption=optionTemplate.clone(),i=0,children=element.children(),ii=children.length;ii>i;i++)if(""===children[i].value){emptyOption=nullOption=children.eq(i);break}selectCtrl.init(ngModelCtrl,nullOption,unknownOption),multiple&&(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}),optionsExp?setupAsOptions(scope,element,ngModelCtrl):multiple?setupAsMultiple(scope,element,ngModelCtrl):setupAsSingle(scope,element,ngModelCtrl,selectCtrl)}}}}],optionDirective=["$interpolate",function($interpolate){var nullSelectCtrl={addOption:noop,removeOption:noop};return{restrict:"E",priority:100,compile:function(element,attr){if(isUndefined(attr.value)){var interpolateFn=$interpolate(element.text(),!0);interpolateFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.databound||(selectCtrl=nullSelectCtrl),interpolateFn?scope.$watch(interpolateFn,function(newVal,oldVal){attr.$set("value",newVal),oldVal!==newVal&&selectCtrl.removeOption(oldVal),selectCtrl.addOption(newVal,element)}):selectCtrl.addOption(attr.value,element),element.on("$destroy",function(){selectCtrl.removeOption(attr.value)})}}}}],styleDirective=valueFn({restrict:"E",terminal:!1}),requiredDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){ctrl&&(attr.required=!0,ctrl.$validators.required=function(modelValue,viewValue){return!attr.required||!ctrl.$isEmpty(viewValue)},attr.$observe("required",function(){ctrl.$validate()}))}}},patternDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var regexp,patternExp=attr.ngPattern||attr.pattern;attr.$observe("pattern",function(regex){if(isString(regex)&&regex.length>0&&(regex=new RegExp("^"+regex+"$")),regex&&!regex.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",patternExp,regex,startingTag(elm));regexp=regex||undefined,ctrl.$validate()}),ctrl.$validators.pattern=function(value){return ctrl.$isEmpty(value)||isUndefined(regexp)||regexp.test(value)}}}}},maxlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var maxlength=-1;attr.$observe("maxlength",function(value){var intVal=int(value);maxlength=isNaN(intVal)?-1:intVal,ctrl.$validate()}),ctrl.$validators.maxlength=function(modelValue,viewValue){return 0>maxlength||ctrl.$isEmpty(viewValue)||viewValue.length<=maxlength}}}}},minlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var minlength=0;attr.$observe("minlength",function(value){minlength=int(value)||0,ctrl.$validate()}),ctrl.$validators.minlength=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||viewValue.length>=minlength}}}}};return window.angular.bootstrap?void console.log("WARNING: Tried to load angular more than once."):(bindJQuery(),publishExternalAPI(angular),void jqLite(document).ready(function(){angularInit(document,bootstrap)}))}(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}</style>'),define("angular",["jquery"],function(global){return function(){var ret;return ret||global.angular}}(this)),angular.module("ngLocale",[],["$provide",function($provide){var PLURAL_CATEGORY={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["上午","下午"],DAY:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ERANAMES:["公元前","公元"],ERAS:["公元前","公元"],FIRSTDAYOFWEEK:6,MONTH:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],SHORTDAY:["周日","周一","周二","周三","周四","周五","周六"],SHORTMONTH:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],WEEKENDRANGE:[5,6],fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"y年M月d日 ah:mm:ss",mediumDate:"y年M月d日",mediumTime:"ah:mm:ss","short":"yy/M/d ah:mm",shortDate:"yy/M/d",shortTime:"ah:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"¥",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤ ",negSuf:"",posPre:"¤ ",posSuf:""}]},id:"zh-hans-cn",pluralCat:function(){return PLURAL_CATEGORY.OTHER}})}]),define("angularLocaleZhHansCn",function(){}),function(window,angular,undefined){"use strict";angular.module("ngAnimate",["ng"]).directive("ngAnimateChildren",function(){var NG_ANIMATE_CHILDREN="$$ngAnimateChildren";return function(scope,element,attrs){var val=attrs.ngAnimateChildren;angular.isString(val)&&0===val.length?element.data(NG_ANIMATE_CHILDREN,!0):scope.$watch(val,function(value){element.data(NG_ANIMATE_CHILDREN,!!value)})}}).factory("$$animateReflow",["$$rAF","$document",function($$rAF,$document){var bod=$document[0].body;return function(fn){return $$rAF(function(){bod.offsetWidth+1;fn()})}}]).config(["$provide","$animateProvider",function($provide,$animateProvider){function extractElementNode(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType==ELEMENT_NODE)return elm}}function prepareElement(element){return element&&angular.element(element)}function stripCommentsFromElement(element){return angular.element(extractElementNode(element))}function isMatchingElement(elm1,elm2){return extractElementNode(elm1)==extractElementNode(elm2)}var $$jqLite,noop=angular.noop,forEach=angular.forEach,selectors=$animateProvider.$$selectors,isArray=angular.isArray,isString=angular.isString,isObject=angular.isObject,ELEMENT_NODE=1,NG_ANIMATE_STATE="$$ngAnimateState",NG_ANIMATE_CHILDREN="$$ngAnimateChildren",NG_ANIMATE_CLASS_NAME="ng-animate",rootAnimateState={running:!0};$provide.decorator("$animate",["$delegate","$$q","$injector","$sniffer","$rootElement","$$asyncCallback","$rootScope","$document","$templateRequest","$$jqLite",function($delegate,$$q,$injector,$sniffer,$rootElement,$$asyncCallback,$rootScope,$document,$templateRequest,$$$jqLite){function classBasedAnimationsBlocked(element,setter){var data=element.data(NG_ANIMATE_STATE)||{};return setter&&(data.running=!0,data.structural=!0,element.data(NG_ANIMATE_STATE,data)),data.disabled||data.running&&data.structural}function runAnimationPostDigest(fn){var cancelFn,defer=$$q.defer();return defer.promise.$$cancelFn=function(){cancelFn&&cancelFn()},$rootScope.$$postDigest(function(){cancelFn=fn(function(){defer.resolve()})}),defer.promise}function parseAnimateOptions(options){return isObject(options)?(options.tempClasses&&isString(options.tempClasses)&&(options.tempClasses=options.tempClasses.split(/\s+/)),options):void 0}function resolveElementClasses(element,cache,runningAnimations){runningAnimations=runningAnimations||{};var lookup={};forEach(runningAnimations,function(data,selector){forEach(selector.split(" "),function(s){lookup[s]=data})});var hasClasses=Object.create(null);forEach((element.attr("class")||"").split(/\s+/),function(className){hasClasses[className]=!0});var toAdd=[],toRemove=[];return forEach(cache&&cache.classes||[],function(status,className){var hasClass=hasClasses[className],matchingAnimation=lookup[className]||{};status===!1?(hasClass||"addClass"==matchingAnimation.event)&&toRemove.push(className):status===!0&&(hasClass&&"removeClass"!=matchingAnimation.event||toAdd.push(className))}),toAdd.length+toRemove.length>0&&[toAdd.join(" "),toRemove.join(" ")]}function lookup(name){if(name){var matches=[],flagMap={},classes=name.substr(1).split(".");($sniffer.transitions||$sniffer.animations)&&matches.push($injector.get(selectors[""]));for(var i=0;i<classes.length;i++){var klass=classes[i],selectorFactoryName=selectors[klass];selectorFactoryName&&!flagMap[klass]&&(matches.push($injector.get(selectorFactoryName)),flagMap[klass]=!0)}return matches}}function animationRunner(element,animationEvent,className,options){function registerAnimation(animationFactory,event){var afterFn=animationFactory[event],beforeFn=animationFactory["before"+event.charAt(0).toUpperCase()+event.substr(1)];return afterFn||beforeFn?("leave"==event&&(beforeFn=afterFn,afterFn=null),after.push({event:event,fn:afterFn}),before.push({event:event,fn:beforeFn}),!0):void 0}function run(fns,cancellations,allCompleteFn){function afterAnimationComplete(index){if(cancellations){if((cancellations[index]||noop)(),++count<animations.length)return;cancellations=null}allCompleteFn()}var animations=[];forEach(fns,function(animation){animation.fn&&animations.push(animation)});var count=0;forEach(animations,function(animation,index){var progress=function(){afterAnimationComplete(index)};switch(animation.event){case"setClass":cancellations.push(animation.fn(element,classNameAdd,classNameRemove,progress,options));break;case"animate":cancellations.push(animation.fn(element,className,options.from,options.to,progress));break;case"addClass":cancellations.push(animation.fn(element,classNameAdd||className,progress,options));break;case"removeClass":cancellations.push(animation.fn(element,classNameRemove||className,progress,options));break;default:cancellations.push(animation.fn(element,progress,options))}}),cancellations&&0===cancellations.length&&allCompleteFn()}var node=element[0];if(node){options&&(options.to=options.to||{},options.from=options.from||{});var classNameAdd,classNameRemove;isArray(className)&&(classNameAdd=className[0],classNameRemove=className[1],classNameAdd?classNameRemove?className=classNameAdd+" "+classNameRemove:(className=classNameAdd,animationEvent="addClass"):(className=classNameRemove,animationEvent="removeClass"));var isSetClassOperation="setClass"==animationEvent,isClassBased=isSetClassOperation||"addClass"==animationEvent||"removeClass"==animationEvent||"animate"==animationEvent,currentClassName=element.attr("class"),classes=currentClassName+" "+className;if(isAnimatableClassName(classes)){var beforeComplete=noop,beforeCancel=[],before=[],afterComplete=noop,afterCancel=[],after=[],animationLookup=(" "+classes).replace(/\s+/g,".");return forEach(lookup(animationLookup),function(animationFactory){var created=registerAnimation(animationFactory,animationEvent);!created&&isSetClassOperation&&(registerAnimation(animationFactory,"addClass"),registerAnimation(animationFactory,"removeClass"))}),{node:node,event:animationEvent,className:className,isClassBased:isClassBased,isSetClassOperation:isSetClassOperation,applyStyles:function(){options&&element.css(angular.extend(options.from||{},options.to||{}))},before:function(allCompleteFn){beforeComplete=allCompleteFn,run(before,beforeCancel,function(){beforeComplete=noop,allCompleteFn()})},after:function(allCompleteFn){afterComplete=allCompleteFn,run(after,afterCancel,function(){afterComplete=noop,allCompleteFn()})},cancel:function(){beforeCancel&&(forEach(beforeCancel,function(cancelFn){(cancelFn||noop)(!0)}),beforeComplete(!0)),afterCancel&&(forEach(afterCancel,function(cancelFn){(cancelFn||noop)(!0)}),afterComplete(!0))}}}}}function performAnimation(animationEvent,className,element,parentElement,afterElement,domOperation,options,doneCallback){function fireDOMCallback(animationPhase){var eventName="$animate:"+animationPhase;elementEvents&&elementEvents[eventName]&&elementEvents[eventName].length>0&&$$asyncCallback(function(){element.triggerHandler(eventName,{event:animationEvent,className:className})})}function fireBeforeCallbackAsync(){fireDOMCallback("before")}function fireAfterCallbackAsync(){fireDOMCallback("after")}function fireDoneCallbackAsync(){fireDOMCallback("close"),doneCallback()}function fireDOMOperation(){fireDOMOperation.hasBeenRun||(fireDOMOperation.hasBeenRun=!0,domOperation())}function closeAnimation(){if(!closeAnimation.hasBeenRun){runner&&runner.applyStyles(),closeAnimation.hasBeenRun=!0,options&&options.tempClasses&&forEach(options.tempClasses,function(className){$$jqLite.removeClass(element,className)});var data=element.data(NG_ANIMATE_STATE);data&&(runner&&runner.isClassBased?cleanup(element,className):($$asyncCallback(function(){var data=element.data(NG_ANIMATE_STATE)||{};localAnimationCount==data.index&&cleanup(element,className,animationEvent)}),element.data(NG_ANIMATE_STATE,data))),fireDoneCallbackAsync()}}var noopCancel=noop,runner=animationRunner(element,animationEvent,className,options);if(!runner)return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),closeAnimation(),noopCancel;animationEvent=runner.event,className=runner.className;var elementEvents=angular.element._data(runner.node);if(elementEvents=elementEvents&&elementEvents.events,parentElement||(parentElement=afterElement?afterElement.parent():element.parent()),animationsDisabled(element,parentElement))return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),closeAnimation(),noopCancel;var ngAnimateState=element.data(NG_ANIMATE_STATE)||{},runningAnimations=ngAnimateState.active||{},totalActiveAnimations=ngAnimateState.totalActive||0,lastAnimation=ngAnimateState.last,skipAnimation=!1;if(totalActiveAnimations>0){var animationsToCancel=[];if(runner.isClassBased){if("setClass"==lastAnimation.event)animationsToCancel.push(lastAnimation),cleanup(element,className);else if(runningAnimations[className]){var current=runningAnimations[className];current.event==animationEvent?skipAnimation=!0:(animationsToCancel.push(current),cleanup(element,className))}}else if("leave"==animationEvent&&runningAnimations["ng-leave"])skipAnimation=!0;else{for(var klass in runningAnimations)animationsToCancel.push(runningAnimations[klass]);ngAnimateState={},cleanup(element,!0)}animationsToCancel.length>0&&forEach(animationsToCancel,function(operation){operation.cancel()})}if(!runner.isClassBased||runner.isSetClassOperation||"animate"==animationEvent||skipAnimation||(skipAnimation="addClass"==animationEvent==element.hasClass(className)),skipAnimation)return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),fireDoneCallbackAsync(),noopCancel;runningAnimations=ngAnimateState.active||{},totalActiveAnimations=ngAnimateState.totalActive||0,"leave"==animationEvent&&element.one("$destroy",function(){var element=angular.element(this),state=element.data(NG_ANIMATE_STATE);if(state){var activeLeaveAnimation=state.active["ng-leave"];activeLeaveAnimation&&(activeLeaveAnimation.cancel(),cleanup(element,"ng-leave"))}}),$$jqLite.addClass(element,NG_ANIMATE_CLASS_NAME),options&&options.tempClasses&&forEach(options.tempClasses,function(className){$$jqLite.addClass(element,className)});var localAnimationCount=globalAnimationCounter++;return totalActiveAnimations++,runningAnimations[className]=runner,element.data(NG_ANIMATE_STATE,{last:runner,active:runningAnimations,index:localAnimationCount,totalActive:totalActiveAnimations}),fireBeforeCallbackAsync(),runner.before(function(cancelled){var data=element.data(NG_ANIMATE_STATE);cancelled=cancelled||!data||!data.active[className]||runner.isClassBased&&data.active[className].event!=animationEvent,fireDOMOperation(),cancelled===!0?closeAnimation():(fireAfterCallbackAsync(),runner.after(closeAnimation))}),runner.cancel}function cancelChildAnimations(element){var node=extractElementNode(element);if(node){var nodes=angular.isFunction(node.getElementsByClassName)?node.getElementsByClassName(NG_ANIMATE_CLASS_NAME):node.querySelectorAll("."+NG_ANIMATE_CLASS_NAME);forEach(nodes,function(element){element=angular.element(element);var data=element.data(NG_ANIMATE_STATE);data&&data.active&&forEach(data.active,function(runner){runner.cancel()})})}}function cleanup(element,className){if(isMatchingElement(element,$rootElement))rootAnimateState.disabled||(rootAnimateState.running=!1,rootAnimateState.structural=!1);else if(className){var data=element.data(NG_ANIMATE_STATE)||{},removeAnimations=className===!0;!removeAnimations&&data.active&&data.active[className]&&(data.totalActive--,delete data.active[className]),(removeAnimations||!data.totalActive)&&($$jqLite.removeClass(element,NG_ANIMATE_CLASS_NAME),element.removeData(NG_ANIMATE_STATE))}}function animationsDisabled(element,parentElement){if(rootAnimateState.disabled)return!0;if(isMatchingElement(element,$rootElement))return rootAnimateState.running;var allowChildAnimations,parentRunningAnimation,hasParent;do{if(0===parentElement.length)break;var isRoot=isMatchingElement(parentElement,$rootElement),state=isRoot?rootAnimateState:parentElement.data(NG_ANIMATE_STATE)||{};if(state.disabled)return!0;if(isRoot&&(hasParent=!0),allowChildAnimations!==!1){var animateChildrenFlag=parentElement.data(NG_ANIMATE_CHILDREN);angular.isDefined(animateChildrenFlag)&&(allowChildAnimations=animateChildrenFlag)}parentRunningAnimation=parentRunningAnimation||state.running||state.last&&!state.last.isClassBased}while(parentElement=parentElement.parent());return!hasParent||!allowChildAnimations&&parentRunningAnimation}$$jqLite=$$$jqLite,$rootElement.data(NG_ANIMATE_STATE,rootAnimateState);var deregisterWatch=$rootScope.$watch(function(){return $templateRequest.totalPendingRequests},function(val){0===val&&(deregisterWatch(),$rootScope.$$postDigest(function(){$rootScope.$$postDigest(function(){rootAnimateState.running=!1})}))}),globalAnimationCounter=0,classNameFilter=$animateProvider.classNameFilter(),isAnimatableClassName=classNameFilter?function(className){return classNameFilter.test(className)}:function(){return!0};return{animate:function(element,from,to,className,options){return className=className||"ng-inline-animate",options=parseAnimateOptions(options)||{},options.from=to?from:null,options.to=to?to:from,runAnimationPostDigest(function(done){return performAnimation("animate",className,stripCommentsFromElement(element),null,null,noop,options,done)})},enter:function(element,parentElement,afterElement,options){return options=parseAnimateOptions(options),element=angular.element(element),parentElement=prepareElement(parentElement),afterElement=prepareElement(afterElement),classBasedAnimationsBlocked(element,!0),$delegate.enter(element,parentElement,afterElement),runAnimationPostDigest(function(done){return performAnimation("enter","ng-enter",stripCommentsFromElement(element),parentElement,afterElement,noop,options,done)})},leave:function(element,options){return options=parseAnimateOptions(options),element=angular.element(element),cancelChildAnimations(element),classBasedAnimationsBlocked(element,!0),runAnimationPostDigest(function(done){return performAnimation("leave","ng-leave",stripCommentsFromElement(element),null,null,function(){$delegate.leave(element)},options,done)})},move:function(element,parentElement,afterElement,options){return options=parseAnimateOptions(options),element=angular.element(element),parentElement=prepareElement(parentElement),afterElement=prepareElement(afterElement),cancelChildAnimations(element),classBasedAnimationsBlocked(element,!0),$delegate.move(element,parentElement,afterElement),runAnimationPostDigest(function(done){return performAnimation("move","ng-move",stripCommentsFromElement(element),parentElement,afterElement,noop,options,done)
})},addClass:function(element,className,options){return this.setClass(element,className,[],options)},removeClass:function(element,className,options){return this.setClass(element,[],className,options)},setClass:function(element,add,remove,options){options=parseAnimateOptions(options);var STORAGE_KEY="$$animateClasses";if(element=angular.element(element),element=stripCommentsFromElement(element),classBasedAnimationsBlocked(element))return $delegate.$$setClassImmediately(element,add,remove,options);var classes,cache=element.data(STORAGE_KEY),hasCache=!!cache;return cache||(cache={},cache.classes={}),classes=cache.classes,add=isArray(add)?add:add.split(" "),forEach(add,function(c){c&&c.length&&(classes[c]=!0)}),remove=isArray(remove)?remove:remove.split(" "),forEach(remove,function(c){c&&c.length&&(classes[c]=!1)}),hasCache?(options&&cache.options&&(cache.options=angular.extend(cache.options||{},options)),cache.promise):(element.data(STORAGE_KEY,cache={classes:classes,options:options}),cache.promise=runAnimationPostDigest(function(done){var parentElement=element.parent(),elementNode=extractElementNode(element),parentNode=elementNode.parentNode;if(!parentNode||parentNode.$$NG_REMOVED||elementNode.$$NG_REMOVED)return void done();var cache=element.data(STORAGE_KEY);element.removeData(STORAGE_KEY);var state=element.data(NG_ANIMATE_STATE)||{},classes=resolveElementClasses(element,cache,state.active);return classes?performAnimation("setClass",classes,element,parentElement,null,function(){classes[0]&&$delegate.$$addClassImmediately(element,classes[0]),classes[1]&&$delegate.$$removeClassImmediately(element,classes[1])},cache.options,done):done()}))},cancel:function(promise){promise.$$cancelFn()},enabled:function(value,element){switch(arguments.length){case 2:if(value)cleanup(element);else{var data=element.data(NG_ANIMATE_STATE)||{};data.disabled=!0,element.data(NG_ANIMATE_STATE,data)}break;case 1:rootAnimateState.disabled=!value;break;default:value=!rootAnimateState.disabled}return!!value}}}]),$animateProvider.register("",["$window","$sniffer","$timeout","$$animateReflow",function($window,$sniffer,$timeout,$$animateReflow){function clearCacheAfterReflow(){cancelAnimationReflow||(cancelAnimationReflow=$$animateReflow(function(){animationReflowQueue=[],cancelAnimationReflow=null,lookupCache={}}))}function afterReflow(element,callback){cancelAnimationReflow&&cancelAnimationReflow(),animationReflowQueue.push(callback),cancelAnimationReflow=$$animateReflow(function(){forEach(animationReflowQueue,function(fn){fn()}),animationReflowQueue=[],cancelAnimationReflow=null,lookupCache={}})}function animationCloseHandler(element,totalTime){var node=extractElementNode(element);element=angular.element(node),animationElementQueue.push(element);var futureTimestamp=Date.now()+totalTime;closingTimestamp>=futureTimestamp||($timeout.cancel(closingTimer),closingTimestamp=futureTimestamp,closingTimer=$timeout(function(){closeAllAnimations(animationElementQueue),animationElementQueue=[]},totalTime,!1))}function closeAllAnimations(elements){forEach(elements,function(element){var elementData=element.data(NG_ANIMATE_CSS_DATA_KEY);elementData&&forEach(elementData.closeAnimationFns,function(fn){fn()})})}function getElementAnimationDetails(element,cacheKey){var data=cacheKey?lookupCache[cacheKey]:null;if(!data){var transitionDuration=0,transitionDelay=0,animationDuration=0,animationDelay=0;forEach(element,function(element){if(element.nodeType==ELEMENT_NODE){var elementStyles=$window.getComputedStyle(element)||{},transitionDurationStyle=elementStyles[TRANSITION_PROP+DURATION_KEY];transitionDuration=Math.max(parseMaxTime(transitionDurationStyle),transitionDuration);var transitionDelayStyle=elementStyles[TRANSITION_PROP+DELAY_KEY];transitionDelay=Math.max(parseMaxTime(transitionDelayStyle),transitionDelay);{elementStyles[ANIMATION_PROP+DELAY_KEY]}animationDelay=Math.max(parseMaxTime(elementStyles[ANIMATION_PROP+DELAY_KEY]),animationDelay);var aDuration=parseMaxTime(elementStyles[ANIMATION_PROP+DURATION_KEY]);aDuration>0&&(aDuration*=parseInt(elementStyles[ANIMATION_PROP+ANIMATION_ITERATION_COUNT_KEY],10)||1),animationDuration=Math.max(aDuration,animationDuration)}}),data={total:0,transitionDelay:transitionDelay,transitionDuration:transitionDuration,animationDelay:animationDelay,animationDuration:animationDuration},cacheKey&&(lookupCache[cacheKey]=data)}return data}function parseMaxTime(str){var maxValue=0,values=isString(str)?str.split(/\s*,\s*/):[];return forEach(values,function(value){maxValue=Math.max(parseFloat(value)||0,maxValue)}),maxValue}function getCacheKey(element){var parentElement=element.parent(),parentID=parentElement.data(NG_ANIMATE_PARENT_KEY);return parentID||(parentElement.data(NG_ANIMATE_PARENT_KEY,++parentCounter),parentID=parentCounter),parentID+"-"+extractElementNode(element).getAttribute("class")}function animateSetup(animationEvent,element,className,styles){var structural=["ng-enter","ng-leave","ng-move"].indexOf(className)>=0,cacheKey=getCacheKey(element),eventCacheKey=cacheKey+" "+className,itemIndex=lookupCache[eventCacheKey]?++lookupCache[eventCacheKey].total:0,stagger={};if(itemIndex>0){var staggerClassName=className+"-stagger",staggerCacheKey=cacheKey+" "+staggerClassName,applyClasses=!lookupCache[staggerCacheKey];applyClasses&&$$jqLite.addClass(element,staggerClassName),stagger=getElementAnimationDetails(element,staggerCacheKey),applyClasses&&$$jqLite.removeClass(element,staggerClassName)}$$jqLite.addClass(element,className);var formerData=element.data(NG_ANIMATE_CSS_DATA_KEY)||{},timings=getElementAnimationDetails(element,eventCacheKey),transitionDuration=timings.transitionDuration,animationDuration=timings.animationDuration;if(structural&&0===transitionDuration&&0===animationDuration)return $$jqLite.removeClass(element,className),!1;var blockTransition=styles||structural&&transitionDuration>0,blockAnimation=animationDuration>0&&stagger.animationDelay>0&&0===stagger.animationDuration,closeAnimationFns=formerData.closeAnimationFns||[];element.data(NG_ANIMATE_CSS_DATA_KEY,{stagger:stagger,cacheKey:eventCacheKey,running:formerData.running||0,itemIndex:itemIndex,blockTransition:blockTransition,closeAnimationFns:closeAnimationFns});var node=extractElementNode(element);return blockTransition&&(blockTransitions(node,!0),styles&&element.css(styles)),blockAnimation&&blockAnimations(node,!0),!0}function animateRun(animationEvent,element,className,activeAnimationComplete,styles){function onEnd(){element.off(css3AnimationEvents,onAnimationProgress),$$jqLite.removeClass(element,activeClassName),$$jqLite.removeClass(element,pendingClassName),staggerTimeout&&$timeout.cancel(staggerTimeout),animateClose(element,className);var node=extractElementNode(element);for(var i in appliedStyles)node.style.removeProperty(appliedStyles[i])}function onAnimationProgress(event){event.stopPropagation();var ev=event.originalEvent||event,timeStamp=ev.$manualTimeStamp||ev.timeStamp||Date.now(),elapsedTime=parseFloat(ev.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES));Math.max(timeStamp-startTime,0)>=maxDelayTime&&elapsedTime>=maxDuration&&activeAnimationComplete()}var node=extractElementNode(element),elementData=element.data(NG_ANIMATE_CSS_DATA_KEY);if(-1==node.getAttribute("class").indexOf(className)||!elementData)return void activeAnimationComplete();var activeClassName="",pendingClassName="";forEach(className.split(" "),function(klass,i){var prefix=(i>0?" ":"")+klass;activeClassName+=prefix+"-active",pendingClassName+=prefix+"-pending"});var style="",appliedStyles=[],itemIndex=elementData.itemIndex,stagger=elementData.stagger,staggerTime=0;if(itemIndex>0){var transitionStaggerDelay=0;stagger.transitionDelay>0&&0===stagger.transitionDuration&&(transitionStaggerDelay=stagger.transitionDelay*itemIndex);var animationStaggerDelay=0;stagger.animationDelay>0&&0===stagger.animationDuration&&(animationStaggerDelay=stagger.animationDelay*itemIndex,appliedStyles.push(CSS_PREFIX+"animation-play-state")),staggerTime=Math.round(100*Math.max(transitionStaggerDelay,animationStaggerDelay))/100}staggerTime||($$jqLite.addClass(element,activeClassName),elementData.blockTransition&&blockTransitions(node,!1));var eventCacheKey=elementData.cacheKey+" "+activeClassName,timings=getElementAnimationDetails(element,eventCacheKey),maxDuration=Math.max(timings.transitionDuration,timings.animationDuration);if(0===maxDuration)return $$jqLite.removeClass(element,activeClassName),animateClose(element,className),void activeAnimationComplete();!staggerTime&&styles&&Object.keys(styles).length>0&&(timings.transitionDuration||(element.css("transition",timings.animationDuration+"s linear all"),appliedStyles.push("transition")),element.css(styles));var maxDelay=Math.max(timings.transitionDelay,timings.animationDelay),maxDelayTime=maxDelay*ONE_SECOND;if(appliedStyles.length>0){var oldStyle=node.getAttribute("style")||"";";"!==oldStyle.charAt(oldStyle.length-1)&&(oldStyle+=";"),node.setAttribute("style",oldStyle+" "+style)}var staggerTimeout,startTime=Date.now(),css3AnimationEvents=ANIMATIONEND_EVENT+" "+TRANSITIONEND_EVENT,animationTime=(maxDelay+maxDuration)*CLOSING_TIME_BUFFER,totalTime=(staggerTime+animationTime)*ONE_SECOND;return staggerTime>0&&($$jqLite.addClass(element,pendingClassName),staggerTimeout=$timeout(function(){staggerTimeout=null,timings.transitionDuration>0&&blockTransitions(node,!1),timings.animationDuration>0&&blockAnimations(node,!1),$$jqLite.addClass(element,activeClassName),$$jqLite.removeClass(element,pendingClassName),styles&&(0===timings.transitionDuration&&element.css("transition",timings.animationDuration+"s linear all"),element.css(styles),appliedStyles.push("transition"))},staggerTime*ONE_SECOND,!1)),element.on(css3AnimationEvents,onAnimationProgress),elementData.closeAnimationFns.push(function(){onEnd(),activeAnimationComplete()}),elementData.running++,animationCloseHandler(element,totalTime),onEnd}function blockTransitions(node,bool){node.style[TRANSITION_PROP+PROPERTY_KEY]=bool?"none":""}function blockAnimations(node,bool){node.style[ANIMATION_PROP+ANIMATION_PLAYSTATE_KEY]=bool?"paused":""}function animateBefore(animationEvent,element,className,styles){return animateSetup(animationEvent,element,className,styles)?function(cancelled){cancelled&&animateClose(element,className)}:void 0}function animateAfter(animationEvent,element,className,afterAnimationComplete,styles){return element.data(NG_ANIMATE_CSS_DATA_KEY)?animateRun(animationEvent,element,className,afterAnimationComplete,styles):(animateClose(element,className),void afterAnimationComplete())}function animate(animationEvent,element,className,animationComplete,options){var preReflowCancellation=animateBefore(animationEvent,element,className,options.from);if(!preReflowCancellation)return clearCacheAfterReflow(),void animationComplete();var cancel=preReflowCancellation;return afterReflow(element,function(){cancel=animateAfter(animationEvent,element,className,animationComplete,options.to)}),function(cancelled){(cancel||noop)(cancelled)}}function animateClose(element,className){$$jqLite.removeClass(element,className);var data=element.data(NG_ANIMATE_CSS_DATA_KEY);data&&(data.running&&data.running--,data.running&&0!==data.running||element.removeData(NG_ANIMATE_CSS_DATA_KEY))}function suffixClasses(classes,suffix){var className="";return classes=isArray(classes)?classes:classes.split(/\s+/),forEach(classes,function(klass,i){klass&&klass.length>0&&(className+=(i>0?" ":"")+klass+suffix)}),className}var TRANSITION_PROP,TRANSITIONEND_EVENT,ANIMATION_PROP,ANIMATIONEND_EVENT,CSS_PREFIX="";window.ontransitionend===undefined&&window.onwebkittransitionend!==undefined?(CSS_PREFIX="-webkit-",TRANSITION_PROP="WebkitTransition",TRANSITIONEND_EVENT="webkitTransitionEnd transitionend"):(TRANSITION_PROP="transition",TRANSITIONEND_EVENT="transitionend"),window.onanimationend===undefined&&window.onwebkitanimationend!==undefined?(CSS_PREFIX="-webkit-",ANIMATION_PROP="WebkitAnimation",ANIMATIONEND_EVENT="webkitAnimationEnd animationend"):(ANIMATION_PROP="animation",ANIMATIONEND_EVENT="animationend");var cancelAnimationReflow,DURATION_KEY="Duration",PROPERTY_KEY="Property",DELAY_KEY="Delay",ANIMATION_ITERATION_COUNT_KEY="IterationCount",ANIMATION_PLAYSTATE_KEY="PlayState",NG_ANIMATE_PARENT_KEY="$$ngAnimateKey",NG_ANIMATE_CSS_DATA_KEY="$$ngAnimateCSS3Data",ELAPSED_TIME_MAX_DECIMAL_PLACES=3,CLOSING_TIME_BUFFER=1.5,ONE_SECOND=1e3,lookupCache={},parentCounter=0,animationReflowQueue=[],closingTimer=null,closingTimestamp=0,animationElementQueue=[];return{animate:function(element,className,from,to,animationCompleted,options){return options=options||{},options.from=from,options.to=to,animate("animate",element,className,animationCompleted,options)},enter:function(element,animationCompleted,options){return options=options||{},animate("enter",element,"ng-enter",animationCompleted,options)},leave:function(element,animationCompleted,options){return options=options||{},animate("leave",element,"ng-leave",animationCompleted,options)},move:function(element,animationCompleted,options){return options=options||{},animate("move",element,"ng-move",animationCompleted,options)},beforeSetClass:function(element,add,remove,animationCompleted,options){options=options||{};var className=suffixClasses(remove,"-remove")+" "+suffixClasses(add,"-add"),cancellationMethod=animateBefore("setClass",element,className,options.from);return cancellationMethod?(afterReflow(element,animationCompleted),cancellationMethod):(clearCacheAfterReflow(),void animationCompleted())},beforeAddClass:function(element,className,animationCompleted,options){options=options||{};var cancellationMethod=animateBefore("addClass",element,suffixClasses(className,"-add"),options.from);return cancellationMethod?(afterReflow(element,animationCompleted),cancellationMethod):(clearCacheAfterReflow(),void animationCompleted())},beforeRemoveClass:function(element,className,animationCompleted,options){options=options||{};var cancellationMethod=animateBefore("removeClass",element,suffixClasses(className,"-remove"),options.from);return cancellationMethod?(afterReflow(element,animationCompleted),cancellationMethod):(clearCacheAfterReflow(),void animationCompleted())},setClass:function(element,add,remove,animationCompleted,options){options=options||{},remove=suffixClasses(remove,"-remove"),add=suffixClasses(add,"-add");var className=remove+" "+add;return animateAfter("setClass",element,className,animationCompleted,options.to)},addClass:function(element,className,animationCompleted,options){return options=options||{},animateAfter("addClass",element,suffixClasses(className,"-add"),animationCompleted,options.to)},removeClass:function(element,className,animationCompleted,options){return options=options||{},animateAfter("removeClass",element,suffixClasses(className,"-remove"),animationCompleted,options.to)}}}])}])}(window,window.angular),define("angularAnimate",function(){}),function(window,angular){"use strict";function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}]}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}"string"!=typeof html&&(html=null===html||"undefined"==typeof html?"":""+html);var index,chars,match,text,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(text="",chars=!0,stack.last()&&specialElements[stack.last()]?(html=html.replace(new RegExp("([\\W\\w]*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last())):(0===html.indexOf("<!--")?(index=html.indexOf("--",4),index>=0&&html.lastIndexOf("-->",index)===index&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):DOCTYPE_REGEXP.test(html)?(match=html.match(DOCTYPE_REGEXP),match&&(html=html.replace(match[0],""),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match?(match[4]&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag)),chars=!1):(text+="<",html=html.substring(1))),chars&&(index=html.indexOf("<"),text+=0>index?html:html.substring(0,index),html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text)))),html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){if(!value)return"";var parts=spaceRe.exec(value),spaceBefore=parts[1],spaceAfter=parts[3],content=parts[2];return content&&(hiddenPre.innerHTML=content.replace(/</g,"&lt;"),content="textContent"in hiddenPre?hiddenPre.textContent:hiddenPre.innerText),spaceBefore+content+spaceAfter}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||validElements[tag]!==!0||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),START_TAG_REGEXP=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,END_TAG_REGEXP=/^<\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),svgElements=makeMap("animate,animateColor,animateMotion,animateTransform,circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,set,stop,svg,switch,text,title,tspan,use"),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements,svgElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap,xlink:href"),htmlAttrs=makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width"),svgAttrs=makeMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,attributeName,attributeType,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan"),validAttrs=angular.extend({},uriAttrs,svgAttrs,htmlAttrs),hiddenPre=document.createElement("pre"),spaceRe=/^(\s*)([\s\S]*?)(\s*)$/;angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"”’]/,MAILTO_REGEXP=/^mailto:/;return function(text,target){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){html.push("<a "),angular.isDefined(target)&&html.push('target="',target,'" '),html.push('href="',url.replace(/"/g,"&quot;"),'">'),addText(text),html.push("</a>")}if(!text)return text;for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]||match[4]||(url=(match[3]?"http://":"mailto:")+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular),define("angularSanitize",function(){}),function(){"use strict";var KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,COMMAND:91,MAP:{91:"COMMAND",8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSEBREAK",20:"CAPSLOCK",27:"ESC",32:"SPACE",33:"PAGE_UP",34:"PAGE_DOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",43:"+",44:"PRINTSCREEN",45:"INSERT",46:"DELETE",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NUMLOCK",145:"SCROLLLOCK",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},isControl:function(e){var k=e.which;switch(k){case KEY.COMMAND:case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(k){return k=k.which?k.which:k,k>=112&&123>=k},isVerticalMovement:function(k){return~[KEY.UP,KEY.DOWN].indexOf(k)},isHorizontalMovement:function(k){return~[KEY.LEFT,KEY.RIGHT,KEY.BACKSPACE,KEY.DELETE].indexOf(k)}};void 0===angular.element.prototype.querySelectorAll&&(angular.element.prototype.querySelectorAll=function(selector){return angular.element(this[0].querySelectorAll(selector))}),void 0===angular.element.prototype.closest&&(angular.element.prototype.closest=function(selector){for(var elem=this[0],matchesSelector=elem.matches||elem.webkitMatchesSelector||elem.mozMatchesSelector||elem.msMatchesSelector;elem;){if(matchesSelector.bind(elem)(selector))return elem;elem=elem.parentElement}return!1});var latestId=0,uis=angular.module("ui.select",[]).constant("uiSelectConfig",{theme:"bootstrap",searchEnabled:!0,sortable:!1,placeholder:"",refreshDelay:1e3,closeOnSelect:!0,dropdownPosition:"auto",generateId:function(){return latestId++},appendToBody:!1}).service("uiSelectMinErr",function(){var minErr=angular.$$minErr("ui.select");return function(){var error=minErr.apply(this,arguments),message=error.message.replace(new RegExp("\nhttp://errors.angularjs.org/.*"),"");return new Error(message)}}).directive("uisTranscludeAppend",function(){return{link:function(scope,element,attrs,ctrl,transclude){transclude(scope,function(clone){element.append(clone)})}}}).filter("highlight",function(){function escapeRegexp(queryToEscape){return queryToEscape.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(matchItem,query){return query&&matchItem?matchItem.replace(new RegExp(escapeRegexp(query),"gi"),'<span class="ui-select-highlight">$&</span>'):matchItem}}).factory("uisOffset",["$document","$window",function($document,$window){return function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].documentElement.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].documentElement.scrollLeft)}}}]);uis.directive("uiSelectChoices",["uiSelectConfig","uisRepeatParser","uiSelectMinErr","$compile",function(uiSelectConfig,RepeatParser,uiSelectMinErr,$compile){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(tElement){var theme=tElement.parent().attr("theme")||uiSelectConfig.theme;return theme+"/choices.tpl.html"},compile:function(tElement,tAttrs){if(!tAttrs.repeat)throw uiSelectMinErr("repeat","Expected 'repeat' expression.");return function(scope,element,attrs,$select,transcludeFn){var groupByExp=attrs.groupBy,groupFilterExp=attrs.groupFilter;if($select.parseRepeatAttr(attrs.repeat,groupByExp,groupFilterExp),$select.disableChoiceExpression=attrs.uiDisableChoice,$select.onHighlightCallback=attrs.onHighlight,$select.dropdownPosition=attrs.position?attrs.position.toLowerCase():uiSelectConfig.dropdownPosition,groupByExp){var groups=element.querySelectorAll(".ui-select-choices-group");if(1!==groups.length)throw uiSelectMinErr("rows","Expected 1 .ui-select-choices-group but got '{0}'.",groups.length);groups.attr("ng-repeat",RepeatParser.getGroupNgRepeatExpression())}var choices=element.querySelectorAll(".ui-select-choices-row");if(1!==choices.length)throw uiSelectMinErr("rows","Expected 1 .ui-select-choices-row but got '{0}'.",choices.length);choices.attr("ng-repeat",$select.parserResult.repeatExpression(groupByExp)).attr("ng-if","$select.open").attr("ng-click","$select.select("+$select.parserResult.itemName+",false,$event)");var rowsInner=element.querySelectorAll(".ui-select-choices-row-inner");if(1!==rowsInner.length)throw uiSelectMinErr("rows","Expected 1 .ui-select-choices-row-inner but got '{0}'.",rowsInner.length);rowsInner.attr("uis-transclude-append",""),$compile(element,transcludeFn)(scope),scope.$watch("$select.search",function(newValue){newValue&&!$select.open&&$select.multiple&&$select.activate(!1,!0),$select.activeIndex=$select.tagging.isActivated?-1:0,$select.refresh(attrs.refresh)}),attrs.$observe("refreshDelay",function(){var refreshDelay=scope.$eval(attrs.refreshDelay);$select.refreshDelay=void 0!==refreshDelay?refreshDelay:uiSelectConfig.refreshDelay})}}}}]),uis.controller("uiSelectCtrl",["$scope","$element","$timeout","$filter","uisRepeatParser","uiSelectMinErr","uiSelectConfig","$parse",function($scope,$element,$timeout,$filter,RepeatParser,uiSelectMinErr,uiSelectConfig,$parse){function _resetSearchInput(){(ctrl.resetSearchInput||void 0===ctrl.resetSearchInput&&uiSelectConfig.resetSearchInput)&&(ctrl.search=EMPTY_SEARCH,ctrl.selected&&ctrl.items.length&&!ctrl.multiple&&(ctrl.activeIndex=ctrl.items.indexOf(ctrl.selected)))}function _groupsFilter(groups,groupNames){var i,j,result=[];for(i=0;i<groupNames.length;i++)for(j=0;j<groups.length;j++)groups[j].name==[groupNames[i]]&&result.push(groups[j]);return result}function _handleDropDownSelection(key){var processed=!0;switch(key){case KEY.DOWN:!ctrl.open&&ctrl.multiple?ctrl.activate(!1,!0):ctrl.activeIndex<ctrl.items.length-1&&ctrl.activeIndex++;break;case KEY.UP:!ctrl.open&&ctrl.multiple?ctrl.activate(!1,!0):(ctrl.activeIndex>0||0===ctrl.search.length&&ctrl.tagging.isActivated&&ctrl.activeIndex>-1)&&ctrl.activeIndex--;break;case KEY.TAB:(!ctrl.multiple||ctrl.open)&&ctrl.select(ctrl.items[ctrl.activeIndex],!0);break;case KEY.ENTER:ctrl.open&&(ctrl.tagging.isActivated||ctrl.activeIndex>=0)?ctrl.select(ctrl.items[ctrl.activeIndex]):ctrl.activate(!1,!0);break;case KEY.ESC:ctrl.close();break;default:processed=!1}return processed}function _ensureHighlightVisible(){var container=$element.querySelectorAll(".ui-select-choices-content"),choices=container.querySelectorAll(".ui-select-choices-row");if(choices.length<1)throw uiSelectMinErr("choices","Expected multiple .ui-select-choices-row but got '{0}'.",choices.length);if(!(ctrl.activeIndex<0)){var highlighted=choices[ctrl.activeIndex],posY=highlighted.offsetTop+highlighted.clientHeight-container[0].scrollTop,height=container[0].offsetHeight;posY>height?container[0].scrollTop+=posY-height:posY<highlighted.clientHeight&&(ctrl.isGrouped&&0===ctrl.activeIndex?container[0].scrollTop=0:container[0].scrollTop-=highlighted.clientHeight-posY)}}var ctrl=this,EMPTY_SEARCH="";if(ctrl.placeholder=uiSelectConfig.placeholder,ctrl.searchEnabled=uiSelectConfig.searchEnabled,ctrl.sortable=uiSelectConfig.sortable,ctrl.refreshDelay=uiSelectConfig.refreshDelay,ctrl.removeSelected=!1,ctrl.closeOnSelect=!0,ctrl.search=EMPTY_SEARCH,ctrl.activeIndex=0,ctrl.items=[],ctrl.open=!1,ctrl.focus=!1,ctrl.disabled=!1,ctrl.selected=void 0,ctrl.dropdownPosition="auto",ctrl.focusser=void 0,ctrl.resetSearchInput=!0,ctrl.multiple=void 0,ctrl.disableChoiceExpression=void 0,ctrl.tagging={isActivated:!1,fct:void 0},ctrl.taggingTokens={isActivated:!1,tokens:void 0},ctrl.lockChoiceExpression=void 0,ctrl.clickTriggeredSelect=!1,ctrl.$filter=$filter,ctrl.searchInput=$element.querySelectorAll("input.ui-select-search"),1!==ctrl.searchInput.length)throw uiSelectMinErr("searchInput","Expected 1 input.ui-select-search but got '{0}'.",ctrl.searchInput.length);
ctrl.isEmpty=function(){return angular.isUndefined(ctrl.selected)||null===ctrl.selected||""===ctrl.selected},ctrl.activate=function(initSearchValue,avoidReset){ctrl.disabled||ctrl.open||(avoidReset||_resetSearchInput(),$scope.$broadcast("uis:activate"),ctrl.open=!0,ctrl.activeIndex=ctrl.activeIndex>=ctrl.items.length?0:ctrl.activeIndex,-1===ctrl.activeIndex&&ctrl.taggingLabel!==!1&&(ctrl.activeIndex=0),$timeout(function(){ctrl.search=initSearchValue||ctrl.search,ctrl.searchInput[0].focus(),!ctrl.tagging.isActivated&&ctrl.items.length>1&&_ensureHighlightVisible()}))},ctrl.findGroupByName=function(name){return ctrl.groups&&ctrl.groups.filter(function(group){return group.name===name})[0]},ctrl.parseRepeatAttr=function(repeatAttr,groupByExp,groupFilterExp){function updateGroups(items){var groupFn=$scope.$eval(groupByExp);if(ctrl.groups=[],angular.forEach(items,function(item){var groupName=angular.isFunction(groupFn)?groupFn(item):item[groupFn],group=ctrl.findGroupByName(groupName);group?group.items.push(item):ctrl.groups.push({name:groupName,items:[item]})}),groupFilterExp){var groupFilterFn=$scope.$eval(groupFilterExp);angular.isFunction(groupFilterFn)?ctrl.groups=groupFilterFn(ctrl.groups):angular.isArray(groupFilterFn)&&(ctrl.groups=_groupsFilter(ctrl.groups,groupFilterFn))}ctrl.items=[],ctrl.groups.forEach(function(group){ctrl.items=ctrl.items.concat(group.items)})}function setPlainItems(items){ctrl.items=items}ctrl.setItemsFn=groupByExp?updateGroups:setPlainItems,ctrl.parserResult=RepeatParser.parse(repeatAttr),ctrl.isGrouped=!!groupByExp,ctrl.itemProperty=ctrl.parserResult.itemName;var originalSource=ctrl.parserResult.source,createArrayFromObject=function(){var origSrc=originalSource($scope);$scope.$uisSource=Object.keys(origSrc).map(function(v){var result={};return result[ctrl.parserResult.keyName]=v,result.value=origSrc[v],result})};ctrl.parserResult.keyName&&(createArrayFromObject(),ctrl.parserResult.source=$parse("$uisSource"+ctrl.parserResult.filters),$scope.$watch(originalSource,function(newVal,oldVal){newVal!==oldVal&&createArrayFromObject()},!0)),ctrl.refreshItems=function(data){data=data||ctrl.parserResult.source($scope);var selectedItems=ctrl.selected;if(ctrl.isEmpty()||angular.isArray(selectedItems)&&!selectedItems.length||!ctrl.removeSelected)ctrl.setItemsFn(data);else if(void 0!==data){var filteredItems=data.filter(function(i){return selectedItems&&selectedItems.indexOf(i)<0});ctrl.setItemsFn(filteredItems)}("auto"===ctrl.dropdownPosition||"up"===ctrl.dropdownPosition)&&$scope.calculateDropdownPos()},$scope.$watchCollection(ctrl.parserResult.source,function(items){if(void 0===items||null===items)ctrl.items=[];else{if(!angular.isArray(items))throw uiSelectMinErr("items","Expected an array but got '{0}'.",items);ctrl.refreshItems(items),ctrl.ngModel.$modelValue=null}})};var _refreshDelayPromise;ctrl.refresh=function(refreshAttr){void 0!==refreshAttr&&(_refreshDelayPromise&&$timeout.cancel(_refreshDelayPromise),_refreshDelayPromise=$timeout(function(){$scope.$eval(refreshAttr)},ctrl.refreshDelay))},ctrl.isActive=function(itemScope){if(!ctrl.open)return!1;var itemIndex=ctrl.items.indexOf(itemScope[ctrl.itemProperty]),isActive=itemIndex===ctrl.activeIndex;return!isActive||0>itemIndex&&ctrl.taggingLabel!==!1||0>itemIndex&&ctrl.taggingLabel===!1?!1:(isActive&&!angular.isUndefined(ctrl.onHighlightCallback)&&itemScope.$eval(ctrl.onHighlightCallback),isActive)},ctrl.isDisabled=function(itemScope){if(ctrl.open){var item,itemIndex=ctrl.items.indexOf(itemScope[ctrl.itemProperty]),isDisabled=!1;return itemIndex>=0&&!angular.isUndefined(ctrl.disableChoiceExpression)&&(item=ctrl.items[itemIndex],isDisabled=!!itemScope.$eval(ctrl.disableChoiceExpression),item._uiSelectChoiceDisabled=isDisabled),isDisabled}},ctrl.select=function(item,skipFocusser,$event){if(void 0===item||!item._uiSelectChoiceDisabled){if(!ctrl.items&&!ctrl.search)return;if(!item||!item._uiSelectChoiceDisabled){if(ctrl.tagging.isActivated){if(ctrl.taggingLabel===!1)if(ctrl.activeIndex<0){if(item=void 0!==ctrl.tagging.fct?ctrl.tagging.fct(ctrl.search):ctrl.search,!item||angular.equals(ctrl.items[0],item))return}else item=ctrl.items[ctrl.activeIndex];else if(0===ctrl.activeIndex){if(void 0===item)return;if(void 0!==ctrl.tagging.fct&&"string"==typeof item){if(item=ctrl.tagging.fct(ctrl.search),!item)return}else"string"==typeof item&&(item=item.replace(ctrl.taggingLabel,"").trim())}if(ctrl.selected&&angular.isArray(ctrl.selected)&&ctrl.selected.filter(function(selection){return angular.equals(selection,item)}).length>0)return void ctrl.close(skipFocusser)}$scope.$broadcast("uis:select",item);var locals={};locals[ctrl.parserResult.itemName]=item,$timeout(function(){ctrl.onSelectCallback($scope,{$item:item,$model:ctrl.parserResult.modelMapper($scope,locals)})}),ctrl.closeOnSelect&&ctrl.close(skipFocusser),$event&&"click"===$event.type&&(ctrl.clickTriggeredSelect=!0)}}},ctrl.close=function(skipFocusser){ctrl.open&&(ctrl.ngModel&&ctrl.ngModel.$setTouched&&ctrl.ngModel.$setTouched(),_resetSearchInput(),ctrl.open=!1,$scope.$broadcast("uis:close",skipFocusser))},ctrl.setFocus=function(){ctrl.focus||ctrl.focusInput[0].focus()},ctrl.clear=function($event){ctrl.select(void 0),$event.stopPropagation(),$timeout(function(){ctrl.focusser[0].focus()},0,!1)},ctrl.toggle=function(e){ctrl.open?(ctrl.close(),e.preventDefault(),e.stopPropagation()):ctrl.activate()},ctrl.isLocked=function(itemScope,itemIndex){var isLocked,item=ctrl.selected[itemIndex];return item&&!angular.isUndefined(ctrl.lockChoiceExpression)&&(isLocked=!!itemScope.$eval(ctrl.lockChoiceExpression),item._uiSelectChoiceLocked=isLocked),isLocked};var sizeWatch=null;ctrl.sizeSearchInput=function(){var input=ctrl.searchInput[0],container=ctrl.searchInput.parent().parent()[0],calculateContainerWidth=function(){return container.clientWidth*!!input.offsetParent},updateIfVisible=function(containerWidth){if(0===containerWidth)return!1;var inputWidth=containerWidth-input.offsetLeft-10;return 50>inputWidth&&(inputWidth=containerWidth),ctrl.searchInput.css("width",inputWidth+"px"),!0};ctrl.searchInput.css("width","10px"),$timeout(function(){null!==sizeWatch||updateIfVisible(calculateContainerWidth())||(sizeWatch=$scope.$watch(calculateContainerWidth,function(containerWidth){updateIfVisible(containerWidth)&&(sizeWatch(),sizeWatch=null)}))})},ctrl.searchInput.on("keydown",function(e){var key=e.which;$scope.$apply(function(){var tagged=!1;if((ctrl.items.length>0||ctrl.tagging.isActivated)&&(_handleDropDownSelection(key),ctrl.taggingTokens.isActivated)){for(var i=0;i<ctrl.taggingTokens.tokens.length;i++)ctrl.taggingTokens.tokens[i]===KEY.MAP[e.keyCode]&&ctrl.search.length>0&&(tagged=!0);tagged&&$timeout(function(){ctrl.searchInput.triggerHandler("tagged");var newItem=ctrl.search.replace(KEY.MAP[e.keyCode],"").trim();ctrl.tagging.fct&&(newItem=ctrl.tagging.fct(newItem)),newItem&&ctrl.select(newItem,!0)})}}),KEY.isVerticalMovement(key)&&ctrl.items.length>0&&_ensureHighlightVisible(),(key===KEY.ENTER||key===KEY.ESC)&&(e.preventDefault(),e.stopPropagation())}),ctrl.searchInput.on("paste",function(e){var data=e.originalEvent.clipboardData.getData("text/plain");if(data&&data.length>0&&ctrl.taggingTokens.isActivated&&ctrl.tagging.fct){var items=data.split(ctrl.taggingTokens.tokens[0]);items&&items.length>0&&(angular.forEach(items,function(item){var newItem=ctrl.tagging.fct(item);newItem&&ctrl.select(newItem,!0)}),e.preventDefault(),e.stopPropagation())}}),ctrl.searchInput.on("tagged",function(){$timeout(function(){_resetSearchInput()})}),$scope.$on("$destroy",function(){ctrl.searchInput.off("keyup keydown tagged blur paste")})}]),uis.directive("uiSelect",["$document","uiSelectConfig","uiSelectMinErr","uisOffset","$compile","$parse","$timeout",function($document,uiSelectConfig,uiSelectMinErr,uisOffset,$compile,$parse,$timeout){return{restrict:"EA",templateUrl:function(tElement,tAttrs){var theme=tAttrs.theme||uiSelectConfig.theme;return theme+(angular.isDefined(tAttrs.multiple)?"/select-multiple.tpl.html":"/select.tpl.html")},replace:!0,transclude:!0,require:["uiSelect","^ngModel"],scope:!0,controller:"uiSelectCtrl",controllerAs:"$select",compile:function(tElement,tAttrs){return angular.isDefined(tAttrs.multiple)?tElement.append("<ui-select-multiple/>").removeAttr("multiple"):tElement.append("<ui-select-single/>"),tAttrs.inputId&&(tElement.querySelectorAll("input.ui-select-search")[0].id=tAttrs.inputId),function(scope,element,attrs,ctrls,transcludeFn){function onDocumentClick(e){if($select.open){var contains=!1;if(contains=window.jQuery?window.jQuery.contains(element[0],e.target):element[0].contains(e.target),!contains&&!$select.clickTriggeredSelect){var focusableControls=["input","button","textarea"],targetController=angular.element(e.target).controller("uiSelect"),skipFocusser=targetController&&targetController!==$select;skipFocusser||(skipFocusser=~focusableControls.indexOf(e.target.tagName.toLowerCase())),$select.close(skipFocusser),scope.$digest()}$select.clickTriggeredSelect=!1}}function positionDropdown(){var offset=uisOffset(element);placeholder=angular.element('<div class="ui-select-placeholder"></div>'),placeholder[0].style.width=offset.width+"px",placeholder[0].style.height=offset.height+"px",element.after(placeholder),originalWidth=element[0].style.width,$document.find("body").append(element),element[0].style.position="absolute",element[0].style.left=offset.left+"px",element[0].style.top=offset.top+"px",element[0].style.width=offset.width+"px"}function resetDropdown(){null!==placeholder&&(placeholder.replaceWith(element),placeholder=null,element[0].style.position="",element[0].style.left="",element[0].style.top="",element[0].style.width=originalWidth)}var $select=ctrls[0],ngModel=ctrls[1];$select.generatedId=uiSelectConfig.generateId(),$select.baseTitle=attrs.title||"Select box",$select.focusserTitle=$select.baseTitle+" focus",$select.focusserId="focusser-"+$select.generatedId,$select.closeOnSelect=function(){return angular.isDefined(attrs.closeOnSelect)?$parse(attrs.closeOnSelect)():uiSelectConfig.closeOnSelect}(),$select.onSelectCallback=$parse(attrs.onSelect),$select.onRemoveCallback=$parse(attrs.onRemove),$select.limit=angular.isDefined(attrs.limit)?parseInt(attrs.limit,10):void 0,$select.ngModel=ngModel,$select.choiceGrouped=function(group){return $select.isGrouped&&group&&group.name},attrs.tabindex&&attrs.$observe("tabindex",function(value){$select.focusInput.attr("tabindex",value),element.removeAttr("tabindex")}),scope.$watch("searchEnabled",function(){var searchEnabled=scope.$eval(attrs.searchEnabled);$select.searchEnabled=void 0!==searchEnabled?searchEnabled:uiSelectConfig.searchEnabled}),scope.$watch("sortable",function(){var sortable=scope.$eval(attrs.sortable);$select.sortable=void 0!==sortable?sortable:uiSelectConfig.sortable}),attrs.$observe("disabled",function(){$select.disabled=void 0!==attrs.disabled?attrs.disabled:!1}),attrs.$observe("resetSearchInput",function(){var resetSearchInput=scope.$eval(attrs.resetSearchInput);$select.resetSearchInput=void 0!==resetSearchInput?resetSearchInput:!0}),attrs.$observe("tagging",function(){if(void 0!==attrs.tagging){var taggingEval=scope.$eval(attrs.tagging);$select.tagging={isActivated:!0,fct:taggingEval!==!0?taggingEval:void 0}}else $select.tagging={isActivated:!1,fct:void 0}}),attrs.$observe("taggingLabel",function(){void 0!==attrs.tagging&&($select.taggingLabel="false"===attrs.taggingLabel?!1:void 0!==attrs.taggingLabel?attrs.taggingLabel:"(new)")}),attrs.$observe("taggingTokens",function(){if(void 0!==attrs.tagging){var tokens=void 0!==attrs.taggingTokens?attrs.taggingTokens.split("|"):[",","ENTER"];$select.taggingTokens={isActivated:!0,tokens:tokens}}}),angular.isDefined(attrs.autofocus)&&$timeout(function(){$select.setFocus()}),angular.isDefined(attrs.focusOn)&&scope.$on(attrs.focusOn,function(){$timeout(function(){$select.setFocus()})}),$document.on("click",onDocumentClick),scope.$on("$destroy",function(){$document.off("click",onDocumentClick)}),transcludeFn(scope,function(clone){var transcluded=angular.element("<div>").append(clone),transcludedMatch=transcluded.querySelectorAll(".ui-select-match");if(transcludedMatch.removeAttr("ui-select-match"),transcludedMatch.removeAttr("data-ui-select-match"),1!==transcludedMatch.length)throw uiSelectMinErr("transcluded","Expected 1 .ui-select-match but got '{0}'.",transcludedMatch.length);element.querySelectorAll(".ui-select-match").replaceWith(transcludedMatch);var transcludedChoices=transcluded.querySelectorAll(".ui-select-choices");if(transcludedChoices.removeAttr("ui-select-choices"),transcludedChoices.removeAttr("data-ui-select-choices"),1!==transcludedChoices.length)throw uiSelectMinErr("transcluded","Expected 1 .ui-select-choices but got '{0}'.",transcludedChoices.length);element.querySelectorAll(".ui-select-choices").replaceWith(transcludedChoices)});var appendToBody=scope.$eval(attrs.appendToBody);(void 0!==appendToBody?appendToBody:uiSelectConfig.appendToBody)&&(scope.$watch("$select.open",function(isOpen){isOpen?positionDropdown():resetDropdown()}),scope.$on("$destroy",function(){resetDropdown()}));var placeholder=null,originalWidth="",dropdown=null,directionUpClassName="direction-up";scope.$watch("$select.open",function(){("auto"===$select.dropdownPosition||"up"===$select.dropdownPosition)&&scope.calculateDropdownPos()});var setDropdownPosUp=function(offset,offsetDropdown){offset=offset||uisOffset(element),offsetDropdown=offsetDropdown||uisOffset(dropdown),dropdown[0].style.position="absolute",dropdown[0].style.top=-1*offsetDropdown.height+"px",element.addClass(directionUpClassName)},setDropdownPosDown=function(offset,offsetDropdown){element.removeClass(directionUpClassName),offset=offset||uisOffset(element),offsetDropdown=offsetDropdown||uisOffset(dropdown),dropdown[0].style.position="",dropdown[0].style.top=""};scope.calculateDropdownPos=function(){if($select.open){if(dropdown=angular.element(element).querySelectorAll(".ui-select-dropdown"),0===dropdown.length)return;dropdown[0].style.opacity=0,$timeout(function(){if("up"===$select.dropdownPosition)setDropdownPosUp(offset,offsetDropdown);else{element.removeClass(directionUpClassName);var offset=uisOffset(element),offsetDropdown=uisOffset(dropdown),scrollTop=$document[0].documentElement.scrollTop||$document[0].body.scrollTop;offset.top+offset.height+offsetDropdown.height>scrollTop+$document[0].documentElement.clientHeight?setDropdownPosUp(offset,offsetDropdown):setDropdownPosDown(offset,offsetDropdown)}dropdown[0].style.opacity=1})}else{if(null===dropdown||0===dropdown.length)return;dropdown[0].style.position="",dropdown[0].style.top="",element.removeClass(directionUpClassName)}}}}}}]),uis.directive("uiSelectMatch",["uiSelectConfig",function(uiSelectConfig){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(tElement){var theme=tElement.parent().attr("theme")||uiSelectConfig.theme,multi=tElement.parent().attr("multiple");return theme+(multi?"/match-multiple.tpl.html":"/match.tpl.html")},link:function(scope,element,attrs,$select){function setAllowClear(allow){$select.allowClear=angular.isDefined(allow)?""===allow?!0:"true"===allow.toLowerCase():!1}$select.lockChoiceExpression=attrs.uiLockChoice,attrs.$observe("placeholder",function(placeholder){$select.placeholder=void 0!==placeholder?placeholder:uiSelectConfig.placeholder}),attrs.$observe("allowClear",setAllowClear),setAllowClear(attrs.allowClear),$select.multiple&&$select.sizeSearchInput()}}}]),uis.directive("uiSelectMultiple",["uiSelectMinErr","$timeout",function(uiSelectMinErr,$timeout){return{restrict:"EA",require:["^uiSelect","^ngModel"],controller:["$scope","$timeout",function($scope,$timeout){var ngModel,ctrl=this,$select=$scope.$select;$scope.$evalAsync(function(){ngModel=$scope.ngModel}),ctrl.activeMatchIndex=-1,ctrl.updateModel=function(){ngModel.$setViewValue(Date.now()),ctrl.refreshComponent()},ctrl.refreshComponent=function(){$select.refreshItems(),$select.sizeSearchInput()},ctrl.removeChoice=function(index){var removedChoice=$select.selected[index];if(!removedChoice._uiSelectChoiceLocked){var locals={};locals[$select.parserResult.itemName]=removedChoice,$select.selected.splice(index,1),ctrl.activeMatchIndex=-1,$select.sizeSearchInput(),$timeout(function(){$select.onRemoveCallback($scope,{$item:removedChoice,$model:$select.parserResult.modelMapper($scope,locals)})}),ctrl.updateModel()}},ctrl.getPlaceholder=function(){return $select.selected&&$select.selected.length?void 0:$select.placeholder}}],controllerAs:"$selectMultiple",link:function(scope,element,attrs,ctrls){function _getCaretPosition(el){return angular.isNumber(el.selectionStart)?el.selectionStart:el.value.length}function _handleMatchSelection(key){function getNewActiveMatchIndex(){switch(key){case KEY.LEFT:return~$selectMultiple.activeMatchIndex?prev:last;case KEY.RIGHT:return~$selectMultiple.activeMatchIndex&&curr!==last?next:($select.activate(),!1);case KEY.BACKSPACE:return~$selectMultiple.activeMatchIndex?($selectMultiple.removeChoice(curr),prev):last;case KEY.DELETE:return~$selectMultiple.activeMatchIndex?($selectMultiple.removeChoice($selectMultiple.activeMatchIndex),curr):!1}}var caretPosition=_getCaretPosition($select.searchInput[0]),length=$select.selected.length,first=0,last=length-1,curr=$selectMultiple.activeMatchIndex,next=$selectMultiple.activeMatchIndex+1,prev=$selectMultiple.activeMatchIndex-1,newIndex=curr;return caretPosition>0||$select.search.length&&key==KEY.RIGHT?!1:($select.close(),newIndex=getNewActiveMatchIndex(),$selectMultiple.activeMatchIndex=$select.selected.length&&newIndex!==!1?Math.min(last,Math.max(first,newIndex)):-1,!0)}function _findCaseInsensitiveDupe(arr){if(void 0===arr||void 0===$select.search)return!1;var hasDupe=arr.filter(function(origItem){return void 0===$select.search.toUpperCase()||void 0===origItem?!1:origItem.toUpperCase()===$select.search.toUpperCase()}).length>0;return hasDupe}function _findApproxDupe(haystack,needle){var dupeIndex=-1;if(angular.isArray(haystack))for(var tempArr=angular.copy(haystack),i=0;i<tempArr.length;i++)if(void 0===$select.tagging.fct)tempArr[i]+" "+$select.taggingLabel===needle&&(dupeIndex=i);else{var mockObj=tempArr[i];mockObj.isTag=!0,angular.equals(mockObj,needle)&&(dupeIndex=i)}return dupeIndex}var $select=ctrls[0],ngModel=scope.ngModel=ctrls[1],$selectMultiple=scope.$selectMultiple;$select.multiple=!0,$select.removeSelected=!0,$select.focusInput=$select.searchInput,ngModel.$parsers.unshift(function(){for(var result,locals={},resultMultiple=[],j=$select.selected.length-1;j>=0;j--)locals={},locals[$select.parserResult.itemName]=$select.selected[j],result=$select.parserResult.modelMapper(scope,locals),resultMultiple.unshift(result);return resultMultiple}),ngModel.$formatters.unshift(function(inputValue){var result,data=$select.parserResult.source(scope,{$select:{search:""}}),locals={};if(!data)return inputValue;var resultMultiple=[],checkFnMultiple=function(list,value){if(list&&list.length){for(var p=list.length-1;p>=0;p--){if(locals[$select.parserResult.itemName]=list[p],result=$select.parserResult.modelMapper(scope,locals),$select.parserResult.trackByExp){var matches=/\.(.+)/.exec($select.parserResult.trackByExp);if(matches.length>0&&result[matches[1]]==value[matches[1]])return resultMultiple.unshift(list[p]),!0}if(angular.equals(result,value))return resultMultiple.unshift(list[p]),!0}return!1}};if(!inputValue)return resultMultiple;for(var k=inputValue.length-1;k>=0;k--)checkFnMultiple($select.selected,inputValue[k])||checkFnMultiple(data,inputValue[k])||resultMultiple.unshift(inputValue[k]);return resultMultiple}),scope.$watchCollection(function(){return ngModel.$modelValue},function(newValue,oldValue){oldValue!=newValue&&(ngModel.$modelValue=null,$selectMultiple.refreshComponent())}),ngModel.$render=function(){if(!angular.isArray(ngModel.$viewValue)){if(!angular.isUndefined(ngModel.$viewValue)&&null!==ngModel.$viewValue)throw uiSelectMinErr("multiarr","Expected model value to be array but got '{0}'",ngModel.$viewValue);$select.selected=[]}$select.selected=ngModel.$viewValue,scope.$evalAsync()},scope.$on("uis:select",function(event,item){$select.selected.length>=$select.limit||($select.selected.push(item),$selectMultiple.updateModel())}),scope.$on("uis:activate",function(){$selectMultiple.activeMatchIndex=-1}),scope.$watch("$select.disabled",function(newValue,oldValue){oldValue&&!newValue&&$select.sizeSearchInput()}),$select.searchInput.on("keydown",function(e){var key=e.which;scope.$apply(function(){var processed=!1;KEY.isHorizontalMovement(key)&&(processed=_handleMatchSelection(key)),processed&&key!=KEY.TAB&&(e.preventDefault(),e.stopPropagation())})}),$select.searchInput.on("keyup",function(e){if(KEY.isVerticalMovement(e.which)||scope.$evalAsync(function(){$select.activeIndex=$select.taggingLabel===!1?-1:0}),$select.tagging.isActivated&&$select.search.length>0){if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC||KEY.isVerticalMovement(e.which))return;if($select.activeIndex=$select.taggingLabel===!1?-1:0,$select.taggingLabel===!1)return;var newItem,item,tagItems,tagItem,items=angular.copy($select.items),stashArr=angular.copy($select.items),hasTag=!1,dupeIndex=-1;if(void 0!==$select.tagging.fct){if(tagItems=$select.$filter("filter")(items,{isTag:!0}),tagItems.length>0&&(tagItem=tagItems[0]),items.length>0&&tagItem&&(hasTag=!0,items=items.slice(1,items.length),stashArr=stashArr.slice(1,stashArr.length)),newItem=$select.tagging.fct($select.search),newItem.isTag=!0,stashArr.filter(function(origItem){return angular.equals(origItem,$select.tagging.fct($select.search))}).length>0)return;newItem.isTag=!0}else{if(tagItems=$select.$filter("filter")(items,function(item){return item.match($select.taggingLabel)}),tagItems.length>0&&(tagItem=tagItems[0]),item=items[0],void 0!==item&&items.length>0&&tagItem&&(hasTag=!0,items=items.slice(1,items.length),stashArr=stashArr.slice(1,stashArr.length)),newItem=$select.search+" "+$select.taggingLabel,_findApproxDupe($select.selected,$select.search)>-1)return;if(_findCaseInsensitiveDupe(stashArr.concat($select.selected)))return void(hasTag&&(items=stashArr,scope.$evalAsync(function(){$select.activeIndex=0,$select.items=items})));if(_findCaseInsensitiveDupe(stashArr))return void(hasTag&&($select.items=stashArr.slice(1,stashArr.length)))}hasTag&&(dupeIndex=_findApproxDupe($select.selected,newItem)),dupeIndex>-1?items=items.slice(dupeIndex+1,items.length-1):(items=[],items.push(newItem),items=items.concat(stashArr)),scope.$evalAsync(function(){$select.activeIndex=0,$select.items=items})}}),$select.searchInput.on("blur",function(){$timeout(function(){$selectMultiple.activeMatchIndex=-1})})}}}]),uis.directive("uiSelectSingle",["$timeout","$compile",function($timeout,$compile){return{restrict:"EA",require:["^uiSelect","^ngModel"],link:function(scope,element,attrs,ctrls){var $select=ctrls[0],ngModel=ctrls[1];ngModel.$parsers.unshift(function(inputValue){var result,locals={};return locals[$select.parserResult.itemName]=inputValue,result=$select.parserResult.modelMapper(scope,locals)}),ngModel.$formatters.unshift(function(inputValue){var result,data=$select.parserResult.source(scope,{$select:{search:""}}),locals={};if(data){var checkFnSingle=function(d){return locals[$select.parserResult.itemName]=d,result=$select.parserResult.modelMapper(scope,locals),result==inputValue};if($select.selected&&checkFnSingle($select.selected))return $select.selected;for(var i=data.length-1;i>=0;i--)if(checkFnSingle(data[i]))return data[i]}return inputValue}),scope.$watch("$select.selected",function(newValue){ngModel.$viewValue!==newValue&&ngModel.$setViewValue(newValue)}),ngModel.$render=function(){$select.selected=ngModel.$viewValue},scope.$on("uis:select",function(event,item){$select.selected=item}),scope.$on("uis:close",function(event,skipFocusser){$timeout(function(){$select.focusser.prop("disabled",!1),skipFocusser||$select.focusser[0].focus()},0,!1)}),scope.$on("uis:activate",function(){focusser.prop("disabled",!0)});var focusser=angular.element("<input ng-disabled='$select.disabled' class='ui-select-focusser ui-select-offscreen' type='text' id='{{ $select.focusserId }}' aria-label='{{ $select.focusserTitle }}' aria-haspopup='true' role='button' />");$compile(focusser)(scope),$select.focusser=focusser,$select.focusInput=focusser,element.parent().append(focusser),focusser.bind("focus",function(){scope.$evalAsync(function(){$select.focus=!0})}),focusser.bind("blur",function(){scope.$evalAsync(function(){$select.focus=!1})}),focusser.bind("keydown",function(e){return e.which===KEY.BACKSPACE?(e.preventDefault(),e.stopPropagation(),$select.select(void 0),void scope.$apply()):void(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC||((e.which==KEY.DOWN||e.which==KEY.UP||e.which==KEY.ENTER||e.which==KEY.SPACE)&&(e.preventDefault(),e.stopPropagation(),$select.activate()),scope.$digest()))}),focusser.bind("keyup input",function(e){e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC||e.which==KEY.ENTER||e.which===KEY.BACKSPACE||($select.activate(focusser.val()),focusser.val(""),scope.$digest())})}}}]),uis.directive("uiSelectSort",["$timeout","uiSelectConfig","uiSelectMinErr",function($timeout,uiSelectConfig,uiSelectMinErr){return{require:"^uiSelect",link:function(scope,element,attrs,$select){if(null===scope[attrs.uiSelectSort])throw uiSelectMinErr("sort","Expected a list to sort");var options=angular.extend({axis:"horizontal"},scope.$eval(attrs.uiSelectSortOptions)),axis=options.axis,draggingClassName="dragging",droppingClassName="dropping",droppingBeforeClassName="dropping-before",droppingAfterClassName="dropping-after";scope.$watch(function(){return $select.sortable},function(n){n?element.attr("draggable",!0):element.removeAttr("draggable")}),element.on("dragstart",function(e){element.addClass(draggingClassName),(e.dataTransfer||e.originalEvent.dataTransfer).setData("text/plain",scope.$index)}),element.on("dragend",function(){element.removeClass(draggingClassName)});var dropTimeout,move=function(from,to){this.splice(to,0,this.splice(from,1)[0])},dragOverHandler=function(e){e.preventDefault();var offset="vertical"===axis?e.offsetY||e.layerY||(e.originalEvent?e.originalEvent.offsetY:0):e.offsetX||e.layerX||(e.originalEvent?e.originalEvent.offsetX:0);offset<this["vertical"===axis?"offsetHeight":"offsetWidth"]/2?(element.removeClass(droppingAfterClassName),element.addClass(droppingBeforeClassName)):(element.removeClass(droppingBeforeClassName),element.addClass(droppingAfterClassName))},dropHandler=function(e){e.preventDefault();var droppedItemIndex=parseInt((e.dataTransfer||e.originalEvent.dataTransfer).getData("text/plain"),10);$timeout.cancel(dropTimeout),dropTimeout=$timeout(function(){_dropHandler(droppedItemIndex)},20)},_dropHandler=function(droppedItemIndex){var theList=scope.$eval(attrs.uiSelectSort),itemToMove=theList[droppedItemIndex],newIndex=null;newIndex=element.hasClass(droppingBeforeClassName)?droppedItemIndex<scope.$index?scope.$index-1:scope.$index:droppedItemIndex<scope.$index?scope.$index:scope.$index+1,move.apply(theList,[droppedItemIndex,newIndex]),scope.$apply(function(){scope.$emit("uiSelectSort:change",{array:theList,item:itemToMove,from:droppedItemIndex,to:newIndex})}),element.removeClass(droppingClassName),element.removeClass(droppingBeforeClassName),element.removeClass(droppingAfterClassName),element.off("drop",dropHandler)};element.on("dragenter",function(){element.hasClass(draggingClassName)||(element.addClass(droppingClassName),element.on("dragover",dragOverHandler),element.on("drop",dropHandler))}),element.on("dragleave",function(e){e.target==element&&(element.removeClass(droppingClassName),element.removeClass(droppingBeforeClassName),element.removeClass(droppingAfterClassName),element.off("dragover",dragOverHandler),element.off("drop",dropHandler))})}}}]),uis.service("uisRepeatParser",["uiSelectMinErr","$parse",function(uiSelectMinErr,$parse){var self=this;self.parse=function(expression){var match,isObjectCollection=/\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)/.test(expression);if(match=expression.match(/^\s*(?:([\s\S]+?)\s+as\s+)?(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(([\w\.]+)?\s*(|\s*[\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),!match)throw uiSelectMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);if(!match[6]&&isObjectCollection)throw uiSelectMinErr("iexp","Expected expression in form of '_item_ as (_key_, _item_) in _ObjCollection_ [ track by _id_]' but got '{0}'.",expression);return{itemName:match[4]||match[2],keyName:match[3],source:$parse(match[3]?match[6]:match[5]),sourceName:match[6],filters:match[7],trackByExp:match[8],modelMapper:$parse(match[1]||match[4]||match[2]),repeatExpression:function(grouped){var expression=this.itemName+" in "+(grouped?"$group.items":"$select.items");return this.trackByExp&&(expression+=" track by "+this.trackByExp),expression}}},self.getGroupNgRepeatExpression=function(){return"$group in $select.groups"}}])}(),angular.module("ui.select").run(["$templateCache",function($templateCache){$templateCache.put("bootstrap/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu" role="listbox" ng-show="$select.items.length > 0"><li class="ui-select-choices-group" id="ui-select-choices-{{ $select.generatedId }}"><div class="divider" ng-show="$select.isGrouped && $index > 0"></div><div ng-show="$select.isGrouped" class="ui-select-choices-group-label dropdown-header" ng-bind="$group.name"></div><div id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}" role="option"><a href="javascript:void(0)" class="ui-select-choices-row-inner"></a></div></li></ul>'),$templateCache.put("bootstrap/match-multiple.tpl.html",'<span class="ui-select-match"><span ng-repeat="$item in $select.selected"><span class="ui-select-match-item btn btn-default btn-xs" tabindex="-1" type="button" ng-disabled="$select.disabled" ng-click="$selectMultiple.activeMatchIndex = $index;" ng-class="{\'btn-primary\':$selectMultiple.activeMatchIndex === $index, \'select-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span class="close ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&nbsp;&times;</span> <span uis-transclude-append=""></span></span></span></span>'),$templateCache.put("bootstrap/match.tpl.html",'<div class="ui-select-match" ng-hide="$select.open" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}"><span tabindex="-1" class="btn btn-default form-control ui-select-toggle" aria-label="{{ $select.baseTitle }} activate" ng-disabled="$select.disabled" ng-click="$select.activate()" style="outline: 0;"><span ng-show="$select.isEmpty()" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="ui-select-match-text pull-left" ng-class="{\'ui-select-allow-clear\': $select.allowClear && !$select.isEmpty()}" ng-transclude=""></span> <i class="caret pull-right" ng-click="$select.toggle($event)"></i> <a ng-show="$select.allowClear && !$select.isEmpty()" aria-label="{{ $select.baseTitle }} clear" style="margin-right: 10px" ng-click="$select.clear($event)" class="btn btn-xs btn-link pull-right"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></a></span></div>'),$templateCache.put("bootstrap/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple ui-select-bootstrap dropdown form-control" ng-class="{open: $select.open}"><div><div class="ui-select-match"></div><input type="text" autocomplete="false" autocorrect="off" autocapitalize="off" spellcheck="false" class="ui-select-search input-xs" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-hide="$select.disabled" ng-click="$select.activate()" ng-model="$select.search" role="combobox" aria-label="{{ $select.baseTitle }}" ondrop="return false;"></div><div class="ui-select-choices"></div></div>'),$templateCache.put("bootstrap/select.tpl.html",'<div class="ui-select-container ui-select-bootstrap dropdown" ng-class="{open: $select.open}"><div class="ui-select-match"></div><input type="text" autocomplete="false" tabindex="-1" aria-expanded="true" aria-label="{{ $select.baseTitle }}" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-activedescendant="ui-select-choices-row-{{ $select.generatedId }}-{{ $select.activeIndex }}" class="form-control ui-select-search" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-show="$select.searchEnabled && $select.open"><div class="ui-select-choices"></div></div>'),$templateCache.put("selectize/choices.tpl.html",'<div ng-show="$select.open" class="ui-select-choices ui-select-dropdown selectize-dropdown single"><div class="ui-select-choices-content selectize-dropdown-content"><div class="ui-select-choices-group optgroup" role="listbox"><div ng-show="$select.isGrouped" class="ui-select-choices-group-label optgroup-header" ng-bind="$group.name"></div><div role="option" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}"><div class="option ui-select-choices-row-inner" data-selectable=""></div></div></div></div></div>'),$templateCache.put("selectize/match.tpl.html",'<div ng-hide="($select.open || $select.isEmpty())" class="ui-select-match" ng-transclude=""></div>'),$templateCache.put("selectize/select.tpl.html",'<div class="ui-select-container selectize-control single" ng-class="{\'open\': $select.open}"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus}" ng-click="$select.activate()"><div class="ui-select-match"></div><input type="text" autocomplete="false" tabindex="-1" class="ui-select-search ui-select-toggle" ng-click="$select.toggle($event)" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-hide="!$select.searchEnabled || ($select.selected && !$select.open)" ng-disabled="$select.disabled" aria-label="{{ $select.baseTitle }}"></div><div class="ui-select-choices"></div></div>'),$templateCache.put("select2/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content select2-results"><li class="ui-select-choices-group" ng-class="{\'select2-result-with-children\': $select.choiceGrouped($group) }"><div ng-show="$select.choiceGrouped($group)" class="ui-select-choices-group-label select2-result-label" ng-bind="$group.name"></div><ul role="listbox" id="ui-select-choices-{{ $select.generatedId }}" ng-class="{\'select2-result-sub\': $select.choiceGrouped($group), \'select2-result-single\': !$select.choiceGrouped($group) }"><li role="option" id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{\'select2-highlighted\': $select.isActive(this), \'select2-disabled\': $select.isDisabled(this)}"><div class="select2-result-label ui-select-choices-row-inner"></div></li></ul></li></ul>'),$templateCache.put("select2/match-multiple.tpl.html",'<span class="ui-select-match"><li class="ui-select-match-item select2-search-choice" ng-repeat="$item in $select.selected" ng-class="{\'select2-search-choice-focus\':$selectMultiple.activeMatchIndex === $index, \'select2-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span uis-transclude-append=""></span> <a href="javascript:;" class="ui-select-match-close select2-search-choice-close" ng-click="$selectMultiple.removeChoice($index)" tabindex="-1"></a></li></span>'),$templateCache.put("select2/match.tpl.html",'<a class="select2-choice ui-select-match" ng-class="{\'select2-default\': $select.isEmpty()}" ng-click="$select.toggle($event)" aria-label="{{ $select.baseTitle }} select"><span ng-show="$select.isEmpty()" class="select2-chosen">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="select2-chosen" ng-transclude=""></span> <abbr ng-if="$select.allowClear && !$select.isEmpty()" class="select2-search-choice-close" ng-click="$select.clear($event)"></abbr> <span class="select2-arrow ui-select-toggle"><b></b></span></a>'),$templateCache.put("select2/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple select2 select2-container select2-container-multi" ng-class="{\'select2-container-active select2-dropdown-open open\': $select.open, \'select2-container-disabled\': $select.disabled}"><ul class="select2-choices"><span class="ui-select-match"></span><li class="select2-search-field"><input type="text" autocomplete="false" autocorrect="off" autocapitalize="off" spellcheck="false" role="combobox" aria-expanded="true" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-label="{{ $select.baseTitle }}" aria-activedescendant="ui-select-choices-row-{{ $select.generatedId }}-{{ $select.activeIndex }}" class="select2-input ui-select-search" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-hide="$select.disabled" ng-model="$select.search" ng-click="$select.activate()" style="width: 34px;" ondrop="return false;"></li></ul><div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open}"><div class="ui-select-choices"></div></div></div>'),$templateCache.put("select2/select.tpl.html",'<div class="ui-select-container select2 select2-container" ng-class="{\'select2-container-active select2-dropdown-open open\': $select.open, \'select2-container-disabled\': $select.disabled, \'select2-container-active\': $select.focus, \'select2-allowclear\': $select.allowClear && !$select.isEmpty()}"><div class="ui-select-match"></div><div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open}"><div class="select2-search" ng-show="$select.searchEnabled"><input type="text" autocomplete="false" autocorrect="false" autocapitalize="off" spellcheck="false" role="combobox" aria-expanded="true" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-label="{{ $select.baseTitle }}" aria-activedescendant="ui-select-choices-row-{{ $select.generatedId }}-{{ $select.activeIndex }}" class="ui-select-search select2-input" ng-model="$select.search"></div><div class="ui-select-choices"></div></div></div>')
}]),define("angularUiSelect",function(){}),function(){"use strict";var ynDialogModule=angular.module("ynote.dialog",[]);ynDialogModule.service("dialogService",["$compile","$http","$templateCache","$rootScope","$timeout","$q",function($compile,$http,$templateCache,$rootScope,$timeout,$q){function onBodyKeyDown(evt){if(0!==stack.length)switch(evt.keyCode){case 27:$rootScope.$apply(function(){_.last(stack).cancel()});break;case 13:return $rootScope.$apply(function(){var scope=_.last(stack);scope.enableEnter&&scope.dismiss(scope.message)}),!1;default:return}}function create(parentScope,options,autoOpen){function onReady(){ready=!0,showOnReady&&show()}function open(){return null!==el?void show():void $http.get(DIALOG_TPL_SRC,{cache:$templateCache}).success(function(res){compile(res)})}function compile(tpl){el=$(tpl),el.appendTo(bodyEl),$compile(el)(scope)}function destroy(){hide().then(function(){el.remove(),scope.$destroy(),el=scope=scope.$dialog=null,alive=!1})}function autoSize(){null!=el&&setTimeout(function(){el&&el.css("visibility","visible")})}function dismiss(returnValue){alive&&(destroy(),defer.resolve(returnValue))}function cancel(returnValue){alive&&(destroy(),defer.reject(returnValue))}function full(){scope.fullScreen?(scope.width=initWidth,scope.height=initHeight,el.find(".widget-dialog-body").css({height:initWidth+"px",width:initHeight+"px"}),el.find(".full-screen").removeClass("min-screen").addClass("max-screen").attr("title","全屏")):(scope.width="100%",scope.height=$(window).height()-el.find(".widget-dialog-header").height(),el.find(".widget-dialog-body").css("height",scope.height+"px"),el.find(".full-screen").removeClass("max-screen").addClass("min-screen").attr("title","退出全屏")),scope.fullScreen=!scope.fullScreen,$timeout(function(){autoSize()},0)}function show(){return ready?alive?(stack.push(scope),$timeout(function(){autoSize()},0),el.show().css({zIndex:BASE_INDEX+stack.length}),$q.when()):$q.reject():(showOnReady=!0,$q.when())}function hide(){return ready?alive?(stack.splice(_.indexOf(stack,scope),1),el.hide(),$q.when()):$q.when():(showOnReady=!1,$q.when())}function notify(value){alive&&defer.notify(value)}function close(returnValue){"cancel"==scope.closeAction?scope.cancel(returnValue):"dismiss"==scope.closeAction&&scope.dismiss(returnValue)}function getDefer(){return defer}function promise(){return defer.promise}function onBtnClick(btnOption){switch(typeof btnOption.handler){case"function":btnOption.handler(scope);break;case"string":scope.$eval(btnOption.handler,{$dialog:scope})}}var scope,initWidth,initHeight,el=null,alive=!0,defer=$q.defer(),ready=!1,showOnReady=!0;return void 0===options&&(options=parentScope,parentScope=$rootScope),scope=parentScope.$new(),_.defaults(options,{width:640,buttonAlign:"right",closeAction:"cancel",canFullScreen:!1,fullScreen:!1,withHeader:!0}),_.extend(scope,options,{$dialog:scope,onBtnClick:onBtnClick,display:"none",open:open,dismiss:dismiss,notify:notify,show:show,hide:hide,close:close,cancel:cancel,defer:getDefer,promise:promise,onReady:onReady,full:full}),initWidth=scope.width,initHeight=scope.height,$(window).resize(function(){if(null!=scope&&scope.canFullScreen&&scope.fullScreen){var height=$(window).height()-el.find(".widget-dialog-header").height(),width=$(window).width(),ct=el.find(".widget-dialog-body:visible");ct.css({height:height+"px",width:width+"px"}),autoSize()}}),autoOpen&&open(),defer.promise}function open(parentScope,options){return create(parentScope,options,!0)}function confirm(title,message,options){return options=_.defaults(options||{},{width:320,ok:"确定",cancel:"取消",buttons:[]}),open({title:title,src:"/ynDialog/confirm.html",message:message,width:options.width,height:options.height,enableEnter:!0,buttons:[{text:options.ok,cls:"primary",handler:function($dialog){$dialog.dismiss(),"function"==typeof options.okCallback&&options.okCallback()}},{text:options.cancel,cls:"cancel",handler:function($dialog){$dialog.cancel(),"function"==typeof options.cancelCallback&&options.cancelCallback()}}].concat(options.buttons)})}function confirmBySrc(title,src,options){return options=_.defaults(options||{},{width:320,ok:"确定",cancel:"取消",buttons:[]}),open({title:title,src:src,width:options.width,height:options.height,enableEnter:!0,buttons:[{text:"确定",cls:"primary",handler:function($dialog){$dialog.dismiss()}},{text:"取消",cls:"cancel",handler:function($dialog){$dialog.cancel()}}].concat(options.buttons)})}function alert(title,message,options){return options=_.defaults(options||{},{width:320,ok:"确定",cancel:"取消",buttons:[]}),open({closeAction:"dismiss",title:title,src:"/ynDialog/alert.html",message:message,width:options.width,height:options.height,enableEnter:!0,buttons:[{text:"确定",cls:"primary",handler:function($dialog){$dialog.dismiss()}}].concat(options.buttons)})}function alertBySrc(title,src,options){return options=_.defaults(options||{},{width:320,height:70,ok:"确定",cancel:"取消",buttons:[]}),open({closeAction:"dismiss",title:title,src:src,width:options.width,height:options.height,message:options.message,enableEnter:!0,buttons:[{text:"确定",cls:"primary",handler:function($dialog){$dialog.dismiss()}}].concat(options.buttons)})}function prompt(title,message,options){return options=_.defaults(options||{},{width:320,height:70,ok:"确定",cancel:"取消",buttons:[]}),open({title:title,src:"/ynDialog/prompt.html",message:message||"",width:options.width,height:options.height,maxlength:options.maxlength,enableEnter:!0,buttons:[{text:"确定",cls:"primary",handler:function($dialog){$dialog.dismiss($dialog.message)}},{text:"取消",cls:"cancel",handler:function($dialog){$dialog.cancel()}}]})}var DIALOG_TPL_SRC="/ynDialog/dialog.html",BASE_INDEX=1e4,bodyEl=$(document.body).on("keydown",onBodyKeyDown),stack=[];this.open=open,this.create=create,this.confirm=confirm,this.confirmBySrc=confirmBySrc,this.alert=alert,this.alertBySrc=alertBySrc,this.prompt=prompt}]).run(["$templateCache","$interpolate",function($templateCache){$templateCache.put("/ynDialog/alert.html",'<p class="alert">{{message}}</p>'),$templateCache.put("/ynDialog/confirm.html",'<p class="confirm">{{message}}</p>'),$templateCache.put("/ynDialog/dialog.html",'<div class="widget-dialog {{cls}}"\n     ng-class="{ \'no-footer\' : !buttons || buttons.length == 0}">\n    <div class="widget-dialog-container" ng-style="{width:width}">\n        <div class="widget-dialog-header" ng-style="{width:width}">\n            {{title}}\n            <a class="full-screen" ng-click="full()" ng-if="canFullScreen" title="fullScreen" ? "退出全屏":"全屏">\n                <svg class="icon-screen">\n                    <use ng-if="fullScreen" class="default" xlink:href="#dialog_min"/>\n                    <use ng-if="fullScreen" class="hover" xlink:href="#dialog_min_hover"/>\n                    <use ng-if="!fullScreen" class="default" xlink:href="#dialog_max"/>\n                    <use ng-if="!fullScreen" class="hover" xlink:href="#dialog_max_hover"/>\n                </svg>\n            </a>\n            <svg class="dialog-close" ng-click="close()">\n                <use class="default" xlink:href="#dialog_close"/>\n                <use class="hover" xlink:href="#dialog_close_hover"/>\n            </svg>\n        </div>\n        <div class="widget-dialog-body" ng-style="{width:width,height:height}">\n            <div ng-include="src" onload="onReady()"></div>\n        </div>\n        <div class="widget-dialog-footer" ng-show="buttons.length > 0" ng-style="{textAlign:buttonAlign}">\n            <button class="btn"\n                tabIndex="{{$index+1}}"\n                ng-repeat="btn in buttons"\n                ng-disabled="btn.disabled"\n                ng-class="btn.cls"\n                ng-switch="!btn.src"\n                ng-click="onBtnClick(btn)">\n                {{btn.text}}\n            </button>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("/ynDialog/prompt.html",'<p class="prompt"><input widget-auto-focus type="text" ng-model="$dialog.message" maxlength="{{$dialog.maxlength}}"/></p>')}])}(),define("ynDialog",["angular"],function(global){return function(){var ret;return ret||global.ynDialog}}(this)),function(){"use strict";var ynToastModule=angular.module("ynote.toast",[]);ynToastModule.directive("widgetHint",function(){var ctrl=["$scope","$element","$rootScope","$timeout",function($scope,$element,$rootScope,$timeout){function popup(){$element.stop(!0,!0),hideTimeout&&$timeout.cancel(hideTimeout),hideTimeout=$timeout(hide,3e3),$element.find("p").attr("class",$scope.theme),$timeout(function(){$element.is(":visible")||$element.fadeIn("slow")})}function hide(){$element.is(":visible")&&$element.stop(!0,!0).fadeOut("slow",function(){$element.find("p").removeClass($scope.theme)}),hideTimeout=null}var hideTimeout;$scope.hide=hide,$rootScope.$on("ynote.toast",function(evt,message,theme,undo){$scope.message=message,$scope.theme=theme,$scope.undo=undo,popup()})}];return{restrict:"A",templateUrl:"/ynToast/toast.html",controller:ctrl,replace:!0,scope:{}}}).run(["$templateCache","$interpolate",function($templateCache){$templateCache.put("/ynToast/toast.html",'<div class="widget-container">\n    <div class="widget-hint">\n        <p>\n            <svg class="icon-hint">\n                <use class="icon-success" xlink:href="#file_upload_success"/>\n                <use class="icon-error" xlink:href="#file_upload_error"/>\n            <use class="icon-warning" xlink:href="#file_upload_warning"/>\n     </svg>\n            <span class="hint-text" ng-bind="message + \'！\'" ng-show="message"></span>\n            <span class="undo" ng-if="undo!=undefined && message" ng-click="undo()">撤销</span>\n        </p>\n    </div>\n    </div>')}])}(),define("ynToast",["angular"],function(global){return function(){var ret;return ret||global.ynToast}}(this)),function(){"use strict";var ynMenuModule=angular.module("ynote.menu",[]);ynMenuModule.service("menuService",["$compile","$injector","$http","$templateCache","$rootScope","$timeout",function($compile,$injector,$http,$templateCache,$rootScope,$timeout){function WebMenuService($compile,$http,$templateCache,$rootScope,$timeout){function closeMenu(){null!=$menu&&$menu.close()}function onWindowResize(){null!=$menu&&$menu.update()}function catchEvent(e){e.stopPropagation(),e.preventDefault()}function removeMoreSplits(items){for(var newItems=[],i=0;i<items.length;i++)3===items[i].type&&(0>i-1||3===items[i-1].type)||newItems.push(items[i]);items=newItems,newItems=[];for(var i=0;i<items.length;i++)3===items[i].type&&(i+1>=items.length||3===items[i+1].type)||newItems.push(items[i]);return newItems}function openMenu(options){function initClipItems(items){_.each(items,function(item){4===item.type&&(item.clipboardOptions={copyValue:item.copyValue,oncomplete:function(){_.isFunction(item.handler)?item.handler(item):_.isString(item.handler)&&$scope.$eval(item.handler),close()}}),item.children&&item.children.length>0&&initClipItems(item.children)})}function create(){var tpl=$templateCache.get(MENU_TPL_SRC);initClipItems(options.items),void 0!==tpl?compile(tpl,$scope,!0):$http.get(MENU_TPL_SRC,{cache:$templateCache}).success(function(res){$templateCache.put(MENU_TPL_SRC,res),compile(res,$scope,!1)})}function compile(tpl,$scope,digest){el=$(tpl).appendTo(bodyEl).on("mousedown contextmenu",catchEvent),$compile(el)($scope),$menu=$scope,show(digest)}function show(digest){$scope.visibility="visible",el.hide().fadeIn("fast"),digest&&$scope.$digest(),update()}function update(){var left=$scope.x,top=$scope.y,height=el.outerHeight(),width=el.outerWidth(),docWidth=document.body.clientWidth,docHeight=document.body.clientHeight,left=left+width>docWidth?left-width:left;top=top+height>docHeight?top-height:top,el.css({left:left+"px",top:top+"px"})}function onItemClick(item,evt){evt.stopPropagation(),_.isFunction(item.handler)?item.handler(item):_.isString(item.handler)&&$scope.$eval(item.handler),close()}function close(){null!=$scope&&("function"==typeof $scope.destroy&&$timeout($scope.destroy),$scope.$destroy()),null!=el&&(el.remove(),el=null),$scope===$menu&&($menu=null),$scope=null}var $scope=null,el=null;return $scope=$rootScope.$new(),options.items=removeMoreSplits(options.items),0!==options.items.length?(_.extend($scope,options,{visibility:"hidden",update:update}),$scope.close=close,$scope.onItemClick=onItemClick,closeMenu(),create(),$scope):void 0}var MENU_TPL_SRC="/ynMenu/menu.html",bodyEl=$(document.body).on("mousedown",closeMenu),$menu=null;$(window).on("resize",onWindowResize),this.open=openMenu,this.close=closeMenu}function NativeMenuService($rootScope,client){function openMenu(options){items={},client.ctxMenu(_.map(options.items,function(item){var index=id++;return items[index]=item,{index:index,label:item.label,type:item.type}}))}function onItemSelect(evt,id){var item=items[id];_.isFunction(item.handler)&&item.handler(item)}var items,id=0;this.open=openMenu,this.close=function(){},$rootScope.$on(client.MENU_SELECT,onItemSelect)}var lastType,client,nativeMenu,webMenu=new WebMenuService($compile,$http,$templateCache,$rootScope,$timeout);client=$injector.has("clientProxy")?$injector.get("clientProxy"):{isMac:function(){return!1},isPC:function(){return!1}},nativeMenu=new NativeMenuService($rootScope,client),this.open=function(options,type){switch(type=type||"auto"){case"web":webMenu.open(options),lastType="web";break;case"native":nativeMenu.open(options),lastType="native";break;default:client.isPC()?(nativeMenu.open(options),lastType="native"):(webMenu.open(options),lastType="web")}},this.close=function(){switch(lastType){case"web":webMenu.close()}},this.MenuOption=function(files){var list=[];this.append=function(name,label,handler,otherOpt,thumb){this.insertAfter(null,name,label,handler,otherOpt,thumb)},this.insertAfter=function(after,name,label,handler,otherOpt,thumb){var option,index=0;index=after?_.indexOf(list,_.findWhere(list,{name:after}))+1:list.length,option="-"!==name?otherOpt?{name:name,label:label,handler:handler,type:otherOpt.type,copyValue:otherOpt.copyValue,hasThumb:!_.isUndefined(thumb),thumb:thumb,children:[]}:{name:name,label:label,handler:handler,hasThumb:!_.isUndefined(thumb),thumb:thumb,children:[]}:{type:3},list.splice(index,0,option)},this.get=function(pos){return _.isNumber(pos)?list[pos]:_.findWhere(list,{name:pos})},this.appendChildren=function(parentName,name,label,handler,otherOpt,thumb){var option,parentMenu=this.get(parentName);option="-"!==name?otherOpt?{name:name,label:label,handler:handler,type:otherOpt.type,copyValue:otherOpt.copyValue,hasThumb:!_.isUndefined(thumb),thumb:thumb,children:[],hasChildren:!1}:{name:name,label:label,handler:handler,hasThumb:!_.isUndefined(thumb),thumb:thumb,children:[],hasChildren:!1}:{type:3},parentMenu.hasChildren=!0,parentMenu.children.push(option)},this.remove=function(pos){var item;if(_.isNumber(pos))list.splice(pos,1);else if(_.isString(pos)){if(item=_.findWhere(list,{name:pos}),!item)return;list.splice(list.indexOf(item))}},this.files=function(){return files},this.items=function(){return list},this.disable=function(name){var item=_.findWhere(list,{name:name});item&&(item.disabled=!0)}}}]).run(["$templateCache","$interpolate",function($templateCache){$templateCache.put("/ynMenu/menu.html",'<ul class="widget-menu" ng-style="{visibility:visibility}">  \n     <li ng-repeat="item in items" \n        ng-switch="item.type"\n          class="menu-li"> \n        <div ng-switch-when="3" class="widget-menu-item split-line"></div> \n <div ng-switch-when="4" class="widget-menu-item" ng-if="!client.isMac()" ng-bind="item.label" clipboard="item.clipboardOptions"></div> \n        <div ng-switch-default class="widget-menu-item" \n             ng-click="onItemClick(item, $event)" \n             ng-mouseover="($parent.$parent.showChildrenItemName = item.label)"> \n             <span class="menu-label" ng-class="{disabled: item.disabled}"> \n                 {{item.label}} \n             </span> \n             <svg class="expand-children-menu" ng-if="item.hasChildren"> \n                 <use xlink:href="#arrow_right"/> \n             </svg> \n             <ul class="widget-menu children-menu" ng-if="showChildrenItemName === item.label && !item.disabled"> \n                 <li ng-repeat="child in item.children" ng-switch="child.type" class="menu-li"> \n                     <div ng-switch-when="3" class="widget-menu-item split-line"></div> \n            <div ng-switch-when="4" class="widget-menu-item" ng-if="!client.isMac()" clipboard="child.clipboardOptions">\n                       <svg class="menu-thumb" ng-if="child.hasThumb"> \n                             <use xlink:href="{{child.thumb}}"/> \n                         </svg> \n                         <span class="menu-label"> \n                              {{child.label}} \n                        </span> \n </div> \n          <div ng-switch-default class="widget-menu-item" \n                             ng-click="onItemClick(child, $event)"> \n                        <svg class="menu-thumb" ng-if="child.hasThumb"> \n                             <use xlink:href="{{child.thumb}}"/> \n                         </svg> \n                         <span class="menu-label"> \n                              {{child.label}} \n                        </span> \n </div> \n </li> \n   </ul> \n </div> \n      </li> \n </ul>')}])}(),define("ynMenu",["angular"],function(global){return function(){var ret;return ret||global.ynMenu}}(this)),function(root,factory){"function"==typeof define&&define.amd?define("jplayer",["jquery"],factory):factory(root.jQuery?root.jQuery:root.Zepto)}(this,function($,undefined){$.fn.jPlayer=function(options){var name="jPlayer",isMethodCall="string"==typeof options,args=Array.prototype.slice.call(arguments,1),returnValue=this;return options=!isMethodCall&&args.length?$.extend.apply(null,[!0,options].concat(args)):options,isMethodCall&&"_"===options.charAt(0)?returnValue:(this.each(isMethodCall?function(){var instance=$(this).data(name),methodValue=instance&&$.isFunction(instance[options])?instance[options].apply(instance,args):instance;return methodValue!==instance&&methodValue!==undefined?(returnValue=methodValue,!1):void 0}:function(){var instance=$(this).data(name);instance?instance.option(options||{}):$(this).data(name,new $.jPlayer(options,this))}),returnValue)},$.jPlayer=function(options,element){if(arguments.length){this.element=$(element),this.options=$.extend(!0,{},this.options,options);var self=this;this.element.bind("remove.jPlayer",function(){self.destroy()}),this._init()}},"function"!=typeof $.fn.stop&&($.fn.stop=function(){}),$.jPlayer.emulateMethods="load play pause",$.jPlayer.emulateStatus="src readyState networkState currentTime duration paused ended playbackRate",$.jPlayer.emulateOptions="muted volume",$.jPlayer.reservedEvent="ready flashreset resize repeat error warning",$.jPlayer.event={},$.each(["ready","flashreset","resize","repeat","click","error","warning","loadstart","progress","suspend","abort","emptied","stalled","play","pause","loadedmetadata","loadeddata","waiting","playing","canplay","canplaythrough","seeking","seeked","timeupdate","ended","ratechange","durationchange","volumechange"],function(){$.jPlayer.event[this]="jPlayer_"+this}),$.jPlayer.htmlEvent=["loadstart","abort","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough"],$.jPlayer.pause=function(){$.each($.jPlayer.prototype.instances,function(i,element){element.data("jPlayer").status.srcSet&&element.jPlayer("pause")})},$.jPlayer.timeFormat={showHour:!1,showMin:!0,showSec:!0,padHour:!1,padMin:!0,padSec:!0,sepHour:":",sepMin:":",sepSec:""};var ConvertTime=function(){this.init()};ConvertTime.prototype={init:function(){this.options={timeFormat:$.jPlayer.timeFormat}},time:function(s){s=s&&"number"==typeof s?s:0;var myTime=new Date(1e3*s),hour=myTime.getUTCHours(),min=this.options.timeFormat.showHour?myTime.getUTCMinutes():myTime.getUTCMinutes()+60*hour,sec=this.options.timeFormat.showMin?myTime.getUTCSeconds():myTime.getUTCSeconds()+60*min,strHour=this.options.timeFormat.padHour&&10>hour?"0"+hour:hour,strMin=this.options.timeFormat.padMin&&10>min?"0"+min:min,strSec=this.options.timeFormat.padSec&&10>sec?"0"+sec:sec,strTime="";return strTime+=this.options.timeFormat.showHour?strHour+this.options.timeFormat.sepHour:"",strTime+=this.options.timeFormat.showMin?strMin+this.options.timeFormat.sepMin:"",strTime+=this.options.timeFormat.showSec?strSec+this.options.timeFormat.sepSec:""}};var myConvertTime=new ConvertTime;$.jPlayer.convertTime=function(s){return myConvertTime.time(s)},$.jPlayer.uaBrowser=function(userAgent){var ua=userAgent.toLowerCase(),rwebkit=/(webkit)[ \/]([\w.]+)/,ropera=/(opera)(?:.*version)?[ \/]([\w.]+)/,rmsie=/(msie) ([\w.]+)/,rmozilla=/(mozilla)(?:.*? rv:([\w.]+))?/,match=rwebkit.exec(ua)||ropera.exec(ua)||rmsie.exec(ua)||ua.indexOf("compatible")<0&&rmozilla.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}},$.jPlayer.uaPlatform=function(userAgent){var ua=userAgent.toLowerCase(),rplatform=/(ipad|iphone|ipod|android|blackberry|playbook|windows ce|webos)/,rtablet=/(ipad|playbook)/,randroid=/(android)/,rmobile=/(mobile)/,platform=rplatform.exec(ua)||[],tablet=rtablet.exec(ua)||!rmobile.exec(ua)&&randroid.exec(ua)||[];return platform[1]&&(platform[1]=platform[1].replace(/\s/g,"_")),{platform:platform[1]||"",tablet:tablet[1]||""}},$.jPlayer.browser={},$.jPlayer.platform={};var browserMatch=$.jPlayer.uaBrowser(navigator.userAgent);browserMatch.browser&&($.jPlayer.browser[browserMatch.browser]=!0,$.jPlayer.browser.version=browserMatch.version);var platformMatch=$.jPlayer.uaPlatform(navigator.userAgent);platformMatch.platform&&($.jPlayer.platform[platformMatch.platform]=!0,$.jPlayer.platform.mobile=!platformMatch.tablet,$.jPlayer.platform.tablet=!!platformMatch.tablet),$.jPlayer.getDocMode=function(){var docMode;return $.jPlayer.browser.msie&&(document.documentMode?docMode=document.documentMode:(docMode=5,document.compatMode&&"CSS1Compat"===document.compatMode&&(docMode=7))),docMode},$.jPlayer.browser.documentMode=$.jPlayer.getDocMode(),$.jPlayer.nativeFeatures={init:function(){var fs,i,il,d=document,v=d.createElement("video"),spec={w3c:["fullscreenEnabled","fullscreenElement","requestFullscreen","exitFullscreen","fullscreenchange","fullscreenerror"],moz:["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"],webkit:["","webkitCurrentFullScreenElement","webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange",""],webkitVideo:["webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitEnterFullscreen","webkitExitFullscreen","",""]},specOrder=["w3c","moz","webkit","webkitVideo"];for(this.fullscreen=fs={support:{w3c:!!d[spec.w3c[0]],moz:!!d[spec.moz[0]],webkit:"function"==typeof d[spec.webkit[3]],webkitVideo:"function"==typeof v[spec.webkitVideo[2]]},used:{}},i=0,il=specOrder.length;il>i;i++){var n=specOrder[i];if(fs.support[n]){fs.spec=n,fs.used[n]=!0;break}}if(fs.spec){var s=spec[fs.spec];fs.api={fullscreenEnabled:!0,fullscreenElement:function(elem){return elem=elem?elem:d,elem[s[1]]},requestFullscreen:function(elem){return elem[s[2]]()},exitFullscreen:function(elem){return elem=elem?elem:d,elem[s[3]]()}},fs.event={fullscreenchange:s[4],fullscreenerror:s[5]}}else fs.api={fullscreenEnabled:!1,fullscreenElement:function(){return null},requestFullscreen:function(){},exitFullscreen:function(){}},fs.event={}}},$.jPlayer.nativeFeatures.init(),$.jPlayer.focus=null,$.jPlayer.keyIgnoreElementNames="INPUT TEXTAREA";var keyBindings=function(event){var ignoreKey,f=$.jPlayer.focus;f&&($.each($.jPlayer.keyIgnoreElementNames.split(/\s+/g),function(i,name){return event.target.nodeName.toUpperCase()===name.toUpperCase()?(ignoreKey=!0,!1):void 0}),ignoreKey||$.each(f.options.keyBindings,function(action,binding){return binding&&event.which===binding.key&&$.isFunction(binding.fn)?(event.preventDefault(),binding.fn(f),!1):void 0}))};$.jPlayer.keys=function(en){var event="keydown.jPlayer";$(document.documentElement).unbind(event),en&&$(document.documentElement).bind(event,keyBindings)},$.jPlayer.keys(!0),$.jPlayer.prototype={count:0,version:{script:"2.5.0",needFlash:"2.5.0",flash:"unknown"},options:{swfPath:"js",solution:"html, flash",supplied:"mp3",preload:"metadata",volume:.8,muted:!1,playbackRate:1,defaultPlaybackRate:1,minPlaybackRate:.5,maxPlaybackRate:4,wmode:"opaque",backgroundColor:"#000000",cssSelectorAncestor:"#jp_container_1",cssSelector:{videoPlay:".jp-video-play",play:".jp-play",pause:".jp-pause",stop:".jp-stop",seekBar:".jp-seek-bar",playBar:".jp-play-bar",mute:".jp-mute",unmute:".jp-unmute",volumeBar:".jp-volume-bar",volumeBarValue:".jp-volume-bar-value",volumeMax:".jp-volume-max",playbackRateBar:".jp-playback-rate-bar",playbackRateBarValue:".jp-playback-rate-bar-value",currentTime:".jp-current-time",duration:".jp-duration",fullScreen:".jp-full-screen",restoreScreen:".jp-restore-screen",repeat:".jp-repeat",repeatOff:".jp-repeat-off",gui:".jp-gui",noSolution:".jp-no-solution"},smoothPlayBar:!1,fullScreen:!1,fullWindow:!1,autohide:{restored:!1,full:!0,fadeIn:200,fadeOut:600,hold:1e3},loop:!1,repeat:function(event){event.jPlayer.options.loop?$(this).unbind(".jPlayerRepeat").bind($.jPlayer.event.ended+".jPlayer.jPlayerRepeat",function(){$(this).jPlayer("play")}):$(this).unbind(".jPlayerRepeat")},nativeVideoControls:{},noFullWindow:{msie:/msie [0-6]\./,ipad:/ipad.*?os [0-4]\./,iphone:/iphone/,ipod:/ipod/,android_pad:/android [0-3]\.(?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,iemobile:/iemobile/,webos:/webos/},noVolume:{ipad:/ipad/,iphone:/iphone/,ipod:/ipod/,android_pad:/android(?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,iemobile:/iemobile/,webos:/webos/,playbook:/playbook/},timeFormat:{},keyEnabled:!1,audioFullScreen:!1,keyBindings:{play:{key:32,fn:function(f){f.status.paused?f.play():f.pause()}},fullScreen:{key:13,fn:function(f){(f.status.video||f.options.audioFullScreen)&&f._setOption("fullScreen",!f.options.fullScreen)}},muted:{key:8,fn:function(f){f._muted(!f.options.muted)}},volumeUp:{key:38,fn:function(f){f.volume(f.options.volume+.1)}},volumeDown:{key:40,fn:function(f){f.volume(f.options.volume-.1)}}},verticalVolume:!1,verticalPlaybackRate:!1,globalVolume:!1,idPrefix:"jp",noConflict:"jQuery",emulateHtml:!1,consoleAlerts:!0,errorAlerts:!1,warningAlerts:!1},optionsAudio:{size:{width:"0px",height:"0px",cssClass:""},sizeFull:{width:"0px",height:"0px",cssClass:""}},optionsVideo:{size:{width:"480px",height:"270px",cssClass:"jp-video-270p"},sizeFull:{width:"100%",height:"100%",cssClass:"jp-video-full"}},instances:{},status:{src:"",media:{},paused:!0,format:{},formatType:"",waitForPlay:!0,waitForLoad:!0,srcSet:!1,video:!1,seekPercent:0,currentPercentRelative:0,currentPercentAbsolute:0,currentTime:0,duration:0,videoWidth:0,videoHeight:0,readyState:0,networkState:0,playbackRate:1,ended:0},internal:{ready:!1},solution:{html:!0,flash:!0},format:{mp3:{codec:'audio/mpeg; codecs="mp3"',flashCanPlay:!0,media:"audio"},m4a:{codec:'audio/mp4; codecs="mp4a.40.2"',flashCanPlay:!0,media:"audio"},m3u8a:{codec:'application/vnd.apple.mpegurl; codecs="mp4a.40.2"',flashCanPlay:!1,media:"audio"},m3ua:{codec:"audio/mpegurl",flashCanPlay:!1,media:"audio"},oga:{codec:'audio/ogg; codecs="vorbis, opus"',flashCanPlay:!1,media:"audio"},flac:{codec:"audio/x-flac",flashCanPlay:!1,media:"audio"},wav:{codec:'audio/wav; codecs="1"',flashCanPlay:!1,media:"audio"},webma:{codec:'audio/webm; codecs="vorbis"',flashCanPlay:!1,media:"audio"},fla:{codec:"audio/x-flv",flashCanPlay:!0,media:"audio"},rtmpa:{codec:'audio/rtmp; codecs="rtmp"',flashCanPlay:!0,media:"audio"},m4v:{codec:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:!0,media:"video"},m3u8v:{codec:'application/vnd.apple.mpegurl; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:!1,media:"video"},m3uv:{codec:"audio/mpegurl",flashCanPlay:!1,media:"video"},ogv:{codec:'video/ogg; codecs="theora, vorbis"',flashCanPlay:!1,media:"video"},webmv:{codec:'video/webm; codecs="vorbis, vp8"',flashCanPlay:!1,media:"video"},flv:{codec:"video/x-flv",flashCanPlay:!0,media:"video"},rtmpv:{codec:'video/rtmp; codecs="rtmp"',flashCanPlay:!0,media:"video"}},_init:function(){var self=this;if(this.element.empty(),this.status=$.extend({},this.status),this.internal=$.extend({},this.internal),this.options.timeFormat=$.extend({},$.jPlayer.timeFormat,this.options.timeFormat),this.internal.cmdsIgnored=$.jPlayer.platform.ipad||$.jPlayer.platform.iphone||$.jPlayer.platform.ipod,this.internal.domNode=this.element.get(0),this.options.keyEnabled&&!$.jPlayer.focus&&($.jPlayer.focus=this),this.formats=[],this.solutions=[],this.require={},this.htmlElement={},this.html={},this.html.audio={},this.html.video={},this.flash={},this.css={},this.css.cs={},this.css.jq={},this.ancestorJq=[],this.options.volume=this._limitValue(this.options.volume,0,1),$.each(this.options.supplied.toLowerCase().split(","),function(index1,value1){var format=value1.replace(/^\s+|\s+$/g,"");if(self.format[format]){var dupFound=!1;$.each(self.formats,function(index2,value2){return format===value2?(dupFound=!0,!1):void 0}),dupFound||self.formats.push(format)}}),$.each(this.options.solution.toLowerCase().split(","),function(index1,value1){var solution=value1.replace(/^\s+|\s+$/g,"");if(self.solution[solution]){var dupFound=!1;$.each(self.solutions,function(index2,value2){return solution===value2?(dupFound=!0,!1):void 0}),dupFound||self.solutions.push(solution)}}),this.internal.instance="jp_"+this.count,this.instances[this.internal.instance]=this.element,this.element.attr("id")||this.element.attr("id",this.options.idPrefix+"_jplayer_"+this.count),this.internal.self=$.extend({},{id:this.element.attr("id"),jq:this.element}),this.internal.audio=$.extend({},{id:this.options.idPrefix+"_audio_"+this.count,jq:undefined}),this.internal.video=$.extend({},{id:this.options.idPrefix+"_video_"+this.count,jq:undefined}),this.internal.flash=$.extend({},{id:this.options.idPrefix+"_flash_"+this.count,jq:undefined,swf:this.options.swfPath+(".swf"!==this.options.swfPath.toLowerCase().slice(-4)?(this.options.swfPath&&"/"!==this.options.swfPath.slice(-1)?"/":"")+"Jplayer.swf":"")}),this.internal.poster=$.extend({},{id:this.options.idPrefix+"_poster_"+this.count,jq:undefined}),$.each($.jPlayer.event,function(eventName,eventType){self.options[eventName]!==undefined&&(self.element.bind(eventType+".jPlayer",self.options[eventName]),self.options[eventName]=undefined)}),this.require.audio=!1,this.require.video=!1,$.each(this.formats,function(priority,format){self.require[self.format[format].media]=!0}),this.options=this.require.video?$.extend(!0,{},this.optionsVideo,this.options):$.extend(!0,{},this.optionsAudio,this.options),this._setSize(),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullWindow=this._uaBlocklist(this.options.noFullWindow),this.status.noVolume=this._uaBlocklist(this.options.noVolume),$.jPlayer.nativeFeatures.fullscreen.api.fullscreenEnabled&&this._fullscreenAddEventListeners(),this._restrictNativeVideoControls(),this.htmlElement.poster=document.createElement("img"),this.htmlElement.poster.id=this.internal.poster.id,this.htmlElement.poster.onload=function(){(!self.status.video||self.status.waitForPlay)&&self.internal.poster.jq.show()},this.element.append(this.htmlElement.poster),this.internal.poster.jq=$("#"+this.internal.poster.id),this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),this.internal.poster.jq.hide(),this.internal.poster.jq.bind("click.jPlayer",function(){self._trigger($.jPlayer.event.click)}),this.html.audio.available=!1,this.require.audio&&(this.htmlElement.audio=document.createElement("audio"),this.htmlElement.audio.id=this.internal.audio.id,this.html.audio.available=!!this.htmlElement.audio.canPlayType&&this._testCanPlayType(this.htmlElement.audio)),this.html.video.available=!1,this.require.video&&(this.htmlElement.video=document.createElement("video"),this.htmlElement.video.id=this.internal.video.id,this.html.video.available=!!this.htmlElement.video.canPlayType&&this._testCanPlayType(this.htmlElement.video)),this.flash.available=this._checkForFlash(10.1),this.html.canPlay={},this.flash.canPlay={},$.each(this.formats,function(priority,format){self.html.canPlay[format]=self.html[self.format[format].media].available&&""!==self.htmlElement[self.format[format].media].canPlayType(self.format[format].codec),self.flash.canPlay[format]=self.format[format].flashCanPlay&&self.flash.available
}),this.html.desired=!1,this.flash.desired=!1,$.each(this.solutions,function(solutionPriority,solution){if(0===solutionPriority)self[solution].desired=!0;else{var audioCanPlay=!1,videoCanPlay=!1;$.each(self.formats,function(formatPriority,format){self[self.solutions[0]].canPlay[format]&&("video"===self.format[format].media?videoCanPlay=!0:audioCanPlay=!0)}),self[solution].desired=self.require.audio&&!audioCanPlay||self.require.video&&!videoCanPlay}}),this.html.support={},this.flash.support={},$.each(this.formats,function(priority,format){self.html.support[format]=self.html.canPlay[format]&&self.html.desired,self.flash.support[format]=self.flash.canPlay[format]&&self.flash.desired}),this.html.used=!1,this.flash.used=!1,$.each(this.solutions,function(solutionPriority,solution){$.each(self.formats,function(formatPriority,format){return self[solution].support[format]?(self[solution].used=!0,!1):void 0})}),this._resetActive(),this._resetGate(),this._cssSelectorAncestor(this.options.cssSelectorAncestor),this.html.used||this.flash.used?this.css.jq.noSolution.length&&this.css.jq.noSolution.hide():(this._error({type:$.jPlayer.error.NO_SOLUTION,context:"{solution:'"+this.options.solution+"', supplied:'"+this.options.supplied+"'}",message:$.jPlayer.errorMsg.NO_SOLUTION,hint:$.jPlayer.errorHint.NO_SOLUTION}),this.css.jq.noSolution.length&&this.css.jq.noSolution.show()),this.flash.used){var htmlObj,flashVars="jQuery="+encodeURI(this.options.noConflict)+"&id="+encodeURI(this.internal.self.id)+"&vol="+this.options.volume+"&muted="+this.options.muted;if($.jPlayer.browser.msie&&(Number($.jPlayer.browser.version)<9||$.jPlayer.browser.documentMode<9)){var objStr='<object id="'+this.internal.flash.id+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="0" height="0" tabindex="-1"></object>',paramStr=['<param name="movie" value="'+this.internal.flash.swf+'" />','<param name="FlashVars" value="'+flashVars+'" />','<param name="allowScriptAccess" value="always" />','<param name="bgcolor" value="'+this.options.backgroundColor+'" />','<param name="wmode" value="'+this.options.wmode+'" />'];htmlObj=document.createElement(objStr);for(var i=0;i<paramStr.length;i++)htmlObj.appendChild(document.createElement(paramStr[i]))}else{var createParam=function(el,n,v){var p=document.createElement("param");p.setAttribute("name",n),p.setAttribute("value",v),el.appendChild(p)};htmlObj=document.createElement("object"),htmlObj.setAttribute("id",this.internal.flash.id),htmlObj.setAttribute("name",this.internal.flash.id),htmlObj.setAttribute("data",this.internal.flash.swf),htmlObj.setAttribute("type","application/x-shockwave-flash"),htmlObj.setAttribute("width","1"),htmlObj.setAttribute("height","1"),htmlObj.setAttribute("tabindex","-1"),createParam(htmlObj,"flashvars",flashVars),createParam(htmlObj,"allowscriptaccess","always"),createParam(htmlObj,"bgcolor",this.options.backgroundColor),createParam(htmlObj,"wmode",this.options.wmode)}this.element.append(htmlObj),this.internal.flash.jq=$(htmlObj)}this.status.playbackRateEnabled=this.html.used&&!this.flash.used?this._testPlaybackRate("audio"):!1,this._updatePlaybackRate(),this.html.used&&(this.html.audio.available&&(this._addHtmlEventListeners(this.htmlElement.audio,this.html.audio),this.element.append(this.htmlElement.audio),this.internal.audio.jq=$("#"+this.internal.audio.id)),this.html.video.available&&(this._addHtmlEventListeners(this.htmlElement.video,this.html.video),this.element.append(this.htmlElement.video),this.internal.video.jq=$("#"+this.internal.video.id),this.internal.video.jq.css(this.status.nativeVideoControls?{width:this.status.width,height:this.status.height}:{width:"0px",height:"0px"}),this.internal.video.jq.bind("click.jPlayer",function(){self._trigger($.jPlayer.event.click)}))),this.options.emulateHtml&&this._emulateHtmlBridge(),this.html.used&&!this.flash.used&&setTimeout(function(){self.internal.ready=!0,self.version.flash="n/a",self._trigger($.jPlayer.event.repeat),self._trigger($.jPlayer.event.ready)},100),this._updateNativeVideoControls(),this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),$.jPlayer.prototype.count++},destroy:function(){this.clearMedia(),this._removeUiClass(),this.css.jq.currentTime.length&&this.css.jq.currentTime.text(""),this.css.jq.duration.length&&this.css.jq.duration.text(""),$.each(this.css.jq,function(fn,jq){jq.length&&jq.unbind(".jPlayer")}),this.internal.poster.jq.unbind(".jPlayer"),this.internal.video.jq&&this.internal.video.jq.unbind(".jPlayer"),this._fullscreenRemoveEventListeners(),this===$.jPlayer.focus&&($.jPlayer.focus=null),this.options.emulateHtml&&this._destroyHtmlBridge(),this.element.removeData("jPlayer"),this.element.unbind(".jPlayer"),this.element.empty(),delete this.instances[this.internal.instance]},enable:function(){},disable:function(){},_testCanPlayType:function(elem){try{return elem.canPlayType(this.format.mp3.codec),!0}catch(err){return!1}},_testPlaybackRate:function(type){var el,rate=.5;type="string"==typeof type?type:"audio",el=document.createElement(type);try{return"playbackRate"in el?(el.playbackRate=rate,el.playbackRate===rate):!1}catch(err){return!1}},_uaBlocklist:function(list){var ua=navigator.userAgent.toLowerCase(),block=!1;return $.each(list,function(p,re){return re&&re.test(ua)?(block=!0,!1):void 0}),block},_restrictNativeVideoControls:function(){this.require.audio&&this.status.nativeVideoControls&&(this.status.nativeVideoControls=!1,this.status.noFullWindow=!0)},_updateNativeVideoControls:function(){this.html.video.available&&this.html.used&&(this.htmlElement.video.controls=this.status.nativeVideoControls,this._updateAutohide(),this.status.nativeVideoControls&&this.require.video?(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})):this.status.waitForPlay&&this.status.video&&(this.internal.poster.jq.show(),this.internal.video.jq.css({width:"0px",height:"0px"})))},_addHtmlEventListeners:function(mediaElement,entity){var self=this;mediaElement.preload=this.options.preload,mediaElement.muted=this.options.muted,mediaElement.volume=this.options.volume,this.status.playbackRateEnabled&&(mediaElement.defaultPlaybackRate=this.options.defaultPlaybackRate,mediaElement.playbackRate=this.options.playbackRate),mediaElement.addEventListener("progress",function(){entity.gate&&(self.internal.cmdsIgnored&&this.readyState>0&&(self.internal.cmdsIgnored=!1),self._getHtmlStatus(mediaElement),self._updateInterface(),self._trigger($.jPlayer.event.progress))},!1),mediaElement.addEventListener("timeupdate",function(){entity.gate&&(self._getHtmlStatus(mediaElement),self._updateInterface(),self._trigger($.jPlayer.event.timeupdate))},!1),mediaElement.addEventListener("durationchange",function(){entity.gate&&(self._getHtmlStatus(mediaElement),self._updateInterface(),self._trigger($.jPlayer.event.durationchange))},!1),mediaElement.addEventListener("play",function(){entity.gate&&(self._updateButtons(!0),self._html_checkWaitForPlay(),self._trigger($.jPlayer.event.play))},!1),mediaElement.addEventListener("playing",function(){entity.gate&&(self._updateButtons(!0),self._seeked(),self._trigger($.jPlayer.event.playing))},!1),mediaElement.addEventListener("pause",function(){entity.gate&&(self._updateButtons(!1),self._trigger($.jPlayer.event.pause))},!1),mediaElement.addEventListener("waiting",function(){entity.gate&&(self._seeking(),self._trigger($.jPlayer.event.waiting))},!1),mediaElement.addEventListener("seeking",function(){entity.gate&&(self._seeking(),self._trigger($.jPlayer.event.seeking))},!1),mediaElement.addEventListener("seeked",function(){entity.gate&&(self._seeked(),self._trigger($.jPlayer.event.seeked))},!1),mediaElement.addEventListener("volumechange",function(){entity.gate&&(self.options.volume=mediaElement.volume,self.options.muted=mediaElement.muted,self._updateMute(),self._updateVolume(),self._trigger($.jPlayer.event.volumechange))},!1),mediaElement.addEventListener("ratechange",function(){entity.gate&&(self.options.defaultPlaybackRate=mediaElement.defaultPlaybackRate,self.options.playbackRate=mediaElement.playbackRate,self._updatePlaybackRate(),self._trigger($.jPlayer.event.ratechange))},!1),mediaElement.addEventListener("suspend",function(){entity.gate&&(self._seeked(),self._trigger($.jPlayer.event.suspend))},!1),mediaElement.addEventListener("ended",function(){entity.gate&&($.jPlayer.browser.webkit||(self.htmlElement.media.currentTime=0),self.htmlElement.media.pause(),self._updateButtons(!1),self._getHtmlStatus(mediaElement,!0),self._updateInterface(),self._trigger($.jPlayer.event.ended))},!1),mediaElement.addEventListener("error",function(){entity.gate&&(self._updateButtons(!1),self._seeked(),self.status.srcSet&&(clearTimeout(self.internal.htmlDlyCmdId),self.status.waitForLoad=!0,self.status.waitForPlay=!0,self.status.video&&!self.status.nativeVideoControls&&self.internal.video.jq.css({width:"0px",height:"0px"}),self._validString(self.status.media.poster)&&!self.status.nativeVideoControls&&self.internal.poster.jq.show(),self.css.jq.videoPlay.length&&self.css.jq.videoPlay.show(),self._error({type:$.jPlayer.error.URL,context:self.status.src,message:$.jPlayer.errorMsg.URL,hint:$.jPlayer.errorHint.URL})))},!1),$.each($.jPlayer.htmlEvent,function(i,eventType){mediaElement.addEventListener(this,function(){entity.gate&&self._trigger($.jPlayer.event[eventType])},!1)})},_getHtmlStatus:function(media,override){var ct=0,cpa=0,sp=0,cpr=0;isFinite(media.duration)&&(this.status.duration=media.duration),ct=media.currentTime,cpa=this.status.duration>0?100*ct/this.status.duration:0,"object"==typeof media.seekable&&media.seekable.length>0?(sp=this.status.duration>0?100*media.seekable.end(media.seekable.length-1)/this.status.duration:100,cpr=this.status.duration>0?100*media.currentTime/media.seekable.end(media.seekable.length-1):0):(sp=100,cpr=cpa),override&&(ct=0,cpr=0,cpa=0),this.status.seekPercent=sp,this.status.currentPercentRelative=cpr,this.status.currentPercentAbsolute=cpa,this.status.currentTime=ct,this.status.videoWidth=media.videoWidth,this.status.videoHeight=media.videoHeight,this.status.readyState=media.readyState,this.status.networkState=media.networkState,this.status.playbackRate=media.playbackRate,this.status.ended=media.ended},_resetStatus:function(){this.status=$.extend({},this.status,$.jPlayer.prototype.status)},_trigger:function(eventType,error,warning){var event=$.Event(eventType);event.jPlayer={},event.jPlayer.version=$.extend({},this.version),event.jPlayer.options=$.extend(!0,{},this.options),event.jPlayer.status=$.extend(!0,{},this.status),event.jPlayer.html=$.extend(!0,{},this.html),event.jPlayer.flash=$.extend(!0,{},this.flash),error&&(event.jPlayer.error=$.extend({},error)),warning&&(event.jPlayer.warning=$.extend({},warning)),this.element.trigger(event)},jPlayerFlashEvent:function(eventType,status){if(eventType===$.jPlayer.event.ready)if(this.internal.ready){if(this.flash.gate){if(this.status.srcSet){var currentTime=this.status.currentTime,paused=this.status.paused;this.setMedia(this.status.media),this.volumeWorker(this.options.volume),currentTime>0&&(paused?this.pause(currentTime):this.play(currentTime))}this._trigger($.jPlayer.event.flashreset)}}else this.internal.ready=!0,this.internal.flash.jq.css({width:"0px",height:"0px"}),this.version.flash=status.version,this.version.needFlash!==this.version.flash&&this._error({type:$.jPlayer.error.VERSION,context:this.version.flash,message:$.jPlayer.errorMsg.VERSION+this.version.flash,hint:$.jPlayer.errorHint.VERSION}),this._trigger($.jPlayer.event.repeat),this._trigger(eventType);if(this.flash.gate)switch(eventType){case $.jPlayer.event.progress:this._getFlashStatus(status),this._updateInterface(),this._trigger(eventType);break;case $.jPlayer.event.timeupdate:this._getFlashStatus(status),this._updateInterface(),this._trigger(eventType);break;case $.jPlayer.event.play:this._seeked(),this._updateButtons(!0),this._trigger(eventType);break;case $.jPlayer.event.pause:this._updateButtons(!1),this._trigger(eventType);break;case $.jPlayer.event.ended:this._updateButtons(!1),this._trigger(eventType);break;case $.jPlayer.event.click:this._trigger(eventType);break;case $.jPlayer.event.error:this.status.waitForLoad=!0,this.status.waitForPlay=!0,this.status.video&&this.internal.flash.jq.css({width:"0px",height:"0px"}),this._validString(this.status.media.poster)&&this.internal.poster.jq.show(),this.css.jq.videoPlay.length&&this.status.video&&this.css.jq.videoPlay.show(),this.status.video?this._flash_setVideo(this.status.media):this._flash_setAudio(this.status.media),this._updateButtons(!1),this._error({type:$.jPlayer.error.URL,context:status.src,message:$.jPlayer.errorMsg.URL,hint:$.jPlayer.errorHint.URL});break;case $.jPlayer.event.seeking:this._seeking(),this._trigger(eventType);break;case $.jPlayer.event.seeked:this._seeked(),this._trigger(eventType);break;case $.jPlayer.event.ready:break;default:this._trigger(eventType)}return!1},_getFlashStatus:function(status){this.status.seekPercent=status.seekPercent,this.status.currentPercentRelative=status.currentPercentRelative,this.status.currentPercentAbsolute=status.currentPercentAbsolute,this.status.currentTime=status.currentTime,this.status.duration=status.duration,this.status.videoWidth=status.videoWidth,this.status.videoHeight=status.videoHeight,this.status.readyState=4,this.status.networkState=0,this.status.playbackRate=1,this.status.ended=!1},_updateButtons:function(playing){playing===undefined?playing=!this.status.paused:this.status.paused=!playing,this.css.jq.play.length&&this.css.jq.pause.length&&(playing?(this.css.jq.play.hide(),this.css.jq.pause.show()):(this.css.jq.play.show(),this.css.jq.pause.hide())),this.css.jq.restoreScreen.length&&this.css.jq.fullScreen.length&&(this.status.noFullWindow?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.hide()):this.options.fullWindow?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.show()):(this.css.jq.fullScreen.show(),this.css.jq.restoreScreen.hide())),this.css.jq.repeat.length&&this.css.jq.repeatOff.length&&(this.options.loop?(this.css.jq.repeat.hide(),this.css.jq.repeatOff.show()):(this.css.jq.repeat.show(),this.css.jq.repeatOff.hide()))},_updateInterface:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.width(this.status.seekPercent+"%"),this.css.jq.playBar.length&&(this.options.smoothPlayBar?this.css.jq.playBar.stop().animate({width:this.status.currentPercentAbsolute+"%"},250,"linear"):this.css.jq.playBar.width(this.status.currentPercentRelative+"%")),this.css.jq.currentTime.length&&this.css.jq.currentTime.text(this._convertTime(this.status.currentTime)),this.css.jq.duration.length&&this.css.jq.duration.text(this._convertTime(this.status.duration))},_convertTime:ConvertTime.prototype.time,_seeking:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.addClass("jp-seeking-bg")},_seeked:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.removeClass("jp-seeking-bg")},_resetGate:function(){this.html.audio.gate=!1,this.html.video.gate=!1,this.flash.gate=!1},_resetActive:function(){this.html.active=!1,this.flash.active=!1},_escapeHtml:function(s){return s.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;")},_qualifyURL:function(url){var el=document.createElement("div");return el.innerHTML='<a href="'+this._escapeHtml(url)+'">x</a>',el.firstChild.href},_absoluteMediaUrls:function(media){var self=this;return $.each(media,function(type,url){self.format[type]&&(media[type]=self._qualifyURL(url))}),media},setMedia:function(media){var self=this,supported=!1,posterChanged=this.status.media.poster!==media.poster;this._resetMedia(),this._resetGate(),this._resetActive(),media=this._absoluteMediaUrls(media),$.each(this.formats,function(formatPriority,format){var isVideo="video"===self.format[format].media;return $.each(self.solutions,function(solutionPriority,solution){if(self[solution].support[format]&&self._validString(media[format])){var isHtml="html"===solution;return isVideo?(isHtml?(self.html.video.gate=!0,self._html_setVideo(media),self.html.active=!0):(self.flash.gate=!0,self._flash_setVideo(media),self.flash.active=!0),self.css.jq.videoPlay.length&&self.css.jq.videoPlay.show(),self.status.video=!0):(isHtml?(self.html.audio.gate=!0,self._html_setAudio(media),self.html.active=!0):(self.flash.gate=!0,self._flash_setAudio(media),self.flash.active=!0),self.css.jq.videoPlay.length&&self.css.jq.videoPlay.hide(),self.status.video=!1),supported=!0,!1}}),supported?!1:void 0}),supported?(this.status.nativeVideoControls&&this.html.video.gate||this._validString(media.poster)&&(posterChanged?this.htmlElement.poster.src=media.poster:this.internal.poster.jq.show()),this.status.srcSet=!0,this.status.media=$.extend({},media),this._updateButtons(!1),this._updateInterface()):this._error({type:$.jPlayer.error.NO_SUPPORT,context:"{supplied:'"+this.options.supplied+"'}",message:$.jPlayer.errorMsg.NO_SUPPORT,hint:$.jPlayer.errorHint.NO_SUPPORT})},_resetMedia:function(){this._resetStatus(),this._updateButtons(!1),this._updateInterface(),this._seeked(),this.internal.poster.jq.hide(),clearTimeout(this.internal.htmlDlyCmdId),this.html.active?this._html_resetMedia():this.flash.active&&this._flash_resetMedia()},clearMedia:function(){this._resetMedia(),this.html.active?this._html_clearMedia():this.flash.active&&this._flash_clearMedia(),this._resetGate(),this._resetActive()},load:function(){this.status.srcSet?this.html.active?this._html_load():this.flash.active&&this._flash_load():this._urlNotSetError("load")},focus:function(){this.options.keyEnabled&&($.jPlayer.focus=this)},play:function(time){time="number"==typeof time?time:0/0,this.status.srcSet?(this.focus(),this.html.active?this._html_play(time):this.flash.active&&this._flash_play(time)):this._urlNotSetError("play")},videoPlay:function(){this.play()},pause:function(time){time="number"==typeof time?time:0/0,this.status.srcSet?this.html.active?this._html_pause(time):this.flash.active&&this._flash_pause(time):this._urlNotSetError("pause")},tellOthers:function(command,conditions){var self=this,hasConditions="function"==typeof conditions,args=Array.prototype.slice.call(arguments);"string"==typeof command&&(hasConditions&&args.splice(1,1),$.each(this.instances,function(){self.element!==this&&(!hasConditions||conditions.call(this.data("jPlayer"),self))&&this.jPlayer.apply(this,args)}))},pauseOthers:function(time){this.tellOthers("pause",function(){return this.status.srcSet},time)},stop:function(){this.status.srcSet?this.html.active?this._html_pause(0):this.flash.active&&this._flash_pause(0):this._urlNotSetError("stop")},playHead:function(p){p=this._limitValue(p,0,100),this.status.srcSet?this.html.active?this._html_playHead(p):this.flash.active&&this._flash_playHead(p):this._urlNotSetError("playHead")},_muted:function(muted){this.mutedWorker(muted),this.options.globalVolume&&this.tellOthers("mutedWorker",function(){return this.options.globalVolume},muted)},mutedWorker:function(muted){this.options.muted=muted,this.html.used&&this._html_setProperty("muted",muted),this.flash.used&&this._flash_mute(muted),this.html.video.gate||this.html.audio.gate||(this._updateMute(muted),this._updateVolume(this.options.volume),this._trigger($.jPlayer.event.volumechange))},mute:function(mute){mute=mute===undefined?!0:!!mute,this._muted(mute)},unmute:function(unmute){unmute=unmute===undefined?!0:!!unmute,this._muted(!unmute)},_updateMute:function(mute){mute===undefined&&(mute=this.options.muted),this.css.jq.mute.length&&this.css.jq.unmute.length&&(this.status.noVolume?(this.css.jq.mute.hide(),this.css.jq.unmute.hide()):mute?(this.css.jq.mute.hide(),this.css.jq.unmute.show()):(this.css.jq.mute.show(),this.css.jq.unmute.hide()))},volume:function(v){this.volumeWorker(v),this.options.globalVolume&&this.tellOthers("volumeWorker",function(){return this.options.globalVolume},v)},volumeWorker:function(v){v=this._limitValue(v,0,1),this.options.volume=v,this.html.used&&this._html_setProperty("volume",v),this.flash.used&&this._flash_volume(v),this.html.video.gate||this.html.audio.gate||(this._updateVolume(v),this._trigger($.jPlayer.event.volumechange))},volumeBar:function(e){if(this.css.jq.volumeBar.length){var $bar=$(e.currentTarget),offset=$bar.offset(),x=e.pageX-offset.left,w=$bar.width(),y=$bar.height()-e.pageY+offset.top,h=$bar.height();this.volume(this.options.verticalVolume?y/h:x/w)}this.options.muted&&this._muted(!1)},volumeBarValue:function(){},_updateVolume:function(v){v===undefined&&(v=this.options.volume),v=this.options.muted?0:v,this.status.noVolume?(this.css.jq.volumeBar.length&&this.css.jq.volumeBar.hide(),this.css.jq.volumeBarValue.length&&this.css.jq.volumeBarValue.hide(),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.hide()):(this.css.jq.volumeBar.length&&this.css.jq.volumeBar.show(),this.css.jq.volumeBarValue.length&&(this.css.jq.volumeBarValue.show(),this.css.jq.volumeBarValue[this.options.verticalVolume?"height":"width"](100*v+"%")),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.show())},volumeMax:function(){this.volume(1),this.options.muted&&this._muted(!1)},_cssSelectorAncestor:function(ancestor){var self=this;this.options.cssSelectorAncestor=ancestor,this._removeUiClass(),this.ancestorJq=ancestor?$(ancestor):[],ancestor&&1!==this.ancestorJq.length&&this._warning({type:$.jPlayer.warning.CSS_SELECTOR_COUNT,context:ancestor,message:$.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.ancestorJq.length+" found for cssSelectorAncestor.",hint:$.jPlayer.warningHint.CSS_SELECTOR_COUNT}),this._addUiClass(),$.each(this.options.cssSelector,function(fn,cssSel){self._cssSelector(fn,cssSel)}),this._updateInterface(),this._updateButtons(),this._updateAutohide(),this._updateVolume(),this._updateMute()},_cssSelector:function(fn,cssSel){var self=this;if("string"==typeof cssSel)if($.jPlayer.prototype.options.cssSelector[fn]){if(this.css.jq[fn]&&this.css.jq[fn].length&&this.css.jq[fn].unbind(".jPlayer"),this.options.cssSelector[fn]=cssSel,this.css.cs[fn]=this.options.cssSelectorAncestor+" "+cssSel,this.css.jq[fn]=cssSel?$(this.css.cs[fn]):[],this.css.jq[fn].length){var handler=function(e){e.preventDefault(),self[fn](e),$(this).blur()};this.css.jq[fn].bind("click.jPlayer",handler)}cssSel&&1!==this.css.jq[fn].length&&this._warning({type:$.jPlayer.warning.CSS_SELECTOR_COUNT,context:this.css.cs[fn],message:$.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.css.jq[fn].length+" found for "+fn+" method.",hint:$.jPlayer.warningHint.CSS_SELECTOR_COUNT})}else this._warning({type:$.jPlayer.warning.CSS_SELECTOR_METHOD,context:fn,message:$.jPlayer.warningMsg.CSS_SELECTOR_METHOD,hint:$.jPlayer.warningHint.CSS_SELECTOR_METHOD});else this._warning({type:$.jPlayer.warning.CSS_SELECTOR_STRING,context:cssSel,message:$.jPlayer.warningMsg.CSS_SELECTOR_STRING,hint:$.jPlayer.warningHint.CSS_SELECTOR_STRING})},seekBar:function(e){if(this.css.jq.seekBar.length){var $bar=$(e.currentTarget),offset=$bar.offset(),x=e.pageX-offset.left,w=$bar.width(),p=100*x/w;this.playHead(p)}},playBar:function(){},playbackRate:function(pbr){this._setOption("playbackRate",pbr)},playbackRateBar:function(e){if(this.css.jq.playbackRateBar.length){var ratio,pbr,$bar=$(e.currentTarget),offset=$bar.offset(),x=e.pageX-offset.left,w=$bar.width(),y=$bar.height()-e.pageY+offset.top,h=$bar.height();ratio=this.options.verticalPlaybackRate?y/h:x/w,pbr=ratio*(this.options.maxPlaybackRate-this.options.minPlaybackRate)+this.options.minPlaybackRate,this.playbackRate(pbr)}},playbackRateBarValue:function(){},_updatePlaybackRate:function(){var pbr=this.options.playbackRate,ratio=(pbr-this.options.minPlaybackRate)/(this.options.maxPlaybackRate-this.options.minPlaybackRate);this.status.playbackRateEnabled?(this.css.jq.playbackRateBar.length&&this.css.jq.playbackRateBar.show(),this.css.jq.playbackRateBarValue.length&&(this.css.jq.playbackRateBarValue.show(),this.css.jq.playbackRateBarValue[this.options.verticalPlaybackRate?"height":"width"](100*ratio+"%"))):(this.css.jq.playbackRateBar.length&&this.css.jq.playbackRateBar.hide(),this.css.jq.playbackRateBarValue.length&&this.css.jq.playbackRateBarValue.hide())},repeat:function(){this._loop(!0)},repeatOff:function(){this._loop(!1)},_loop:function(loop){this.options.loop!==loop&&(this.options.loop=loop,this._updateButtons(),this._trigger($.jPlayer.event.repeat))},currentTime:function(){},duration:function(){},gui:function(){},noSolution:function(){},option:function(key,value){var options=key;if(0===arguments.length)return $.extend(!0,{},this.options);if("string"==typeof key){var keys=key.split(".");if(value===undefined){for(var opt=$.extend(!0,{},this.options),i=0;i<keys.length;i++){if(opt[keys[i]]===undefined)return this._warning({type:$.jPlayer.warning.OPTION_KEY,context:key,message:$.jPlayer.warningMsg.OPTION_KEY,hint:$.jPlayer.warningHint.OPTION_KEY}),undefined;opt=opt[keys[i]]}return opt}options={};for(var opts=options,j=0;j<keys.length;j++)j<keys.length-1?(opts[keys[j]]={},opts=opts[keys[j]]):opts[keys[j]]=value}return this._setOptions(options),this},_setOptions:function(options){var self=this;return $.each(options,function(key,value){self._setOption(key,value)}),this},_setOption:function(key,value){var self=this;switch(key){case"volume":this.volume(value);break;case"muted":this._muted(value);break;case"globalVolume":this.options[key]=value;break;case"cssSelectorAncestor":this._cssSelectorAncestor(value);break;case"cssSelector":$.each(value,function(fn,cssSel){self._cssSelector(fn,cssSel)});break;case"playbackRate":this.options[key]=value=this._limitValue(value,this.options.minPlaybackRate,this.options.maxPlaybackRate),this.html.used&&this._html_setProperty("playbackRate",value),this._updatePlaybackRate();break;case"defaultPlaybackRate":this.options[key]=value=this._limitValue(value,this.options.minPlaybackRate,this.options.maxPlaybackRate),this.html.used&&this._html_setProperty("defaultPlaybackRate",value),this._updatePlaybackRate();break;case"minPlaybackRate":this.options[key]=value=this._limitValue(value,.1,this.options.maxPlaybackRate-.1),this._updatePlaybackRate();break;case"maxPlaybackRate":this.options[key]=value=this._limitValue(value,this.options.minPlaybackRate+.1,16),this._updatePlaybackRate();break;case"fullScreen":if(this.options[key]!==value){var wkv=$.jPlayer.nativeFeatures.fullscreen.used.webkitVideo;(!wkv||wkv&&!this.status.waitForPlay)&&(wkv||(this.options[key]=value),value?this._requestFullscreen():this._exitFullscreen(),wkv||this._setOption("fullWindow",value))}break;case"fullWindow":this.options[key]!==value&&(this._removeUiClass(),this.options[key]=value,this._refreshSize());break;case"size":this.options.fullWindow||this.options[key].cssClass===value.cssClass||this._removeUiClass(),this.options[key]=$.extend({},this.options[key],value),this._refreshSize();break;case"sizeFull":this.options.fullWindow&&this.options[key].cssClass!==value.cssClass&&this._removeUiClass(),this.options[key]=$.extend({},this.options[key],value),this._refreshSize();break;case"autohide":this.options[key]=$.extend({},this.options[key],value),this._updateAutohide();break;case"loop":this._loop(value);break;case"nativeVideoControls":this.options[key]=$.extend({},this.options[key],value),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this._restrictNativeVideoControls(),this._updateNativeVideoControls();break;case"noFullWindow":this.options[key]=$.extend({},this.options[key],value),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullWindow=this._uaBlocklist(this.options.noFullWindow),this._restrictNativeVideoControls(),this._updateButtons();break;case"noVolume":this.options[key]=$.extend({},this.options[key],value),this.status.noVolume=this._uaBlocklist(this.options.noVolume),this._updateVolume(),this._updateMute();break;case"emulateHtml":this.options[key]!==value&&(this.options[key]=value,value?this._emulateHtmlBridge():this._destroyHtmlBridge());break;case"timeFormat":this.options[key]=$.extend({},this.options[key],value);break;case"keyEnabled":this.options[key]=value,value||this!==$.jPlayer.focus||($.jPlayer.focus=null);break;case"keyBindings":this.options[key]=$.extend(!0,{},this.options[key],value);break;case"audioFullScreen":this.options[key]=value}return this},_refreshSize:function(){this._setSize(),this._addUiClass(),this._updateSize(),this._updateButtons(),this._updateAutohide(),this._trigger($.jPlayer.event.resize)},_setSize:function(){this.options.fullWindow?(this.status.width=this.options.sizeFull.width,this.status.height=this.options.sizeFull.height,this.status.cssClass=this.options.sizeFull.cssClass):(this.status.width=this.options.size.width,this.status.height=this.options.size.height,this.status.cssClass=this.options.size.cssClass),this.element.css({width:this.status.width,height:this.status.height})},_addUiClass:function(){this.ancestorJq.length&&this.ancestorJq.addClass(this.status.cssClass)},_removeUiClass:function(){this.ancestorJq.length&&this.ancestorJq.removeClass(this.status.cssClass)},_updateSize:function(){this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),!this.status.waitForPlay&&this.html.active&&this.status.video||this.html.video.available&&this.html.used&&this.status.nativeVideoControls?this.internal.video.jq.css({width:this.status.width,height:this.status.height}):!this.status.waitForPlay&&this.flash.active&&this.status.video&&this.internal.flash.jq.css({width:this.status.width,height:this.status.height})},_updateAutohide:function(){var self=this,event="mousemove.jPlayer",namespace=".jPlayerAutohide",eventType=event+namespace,handler=function(){self.css.jq.gui.fadeIn(self.options.autohide.fadeIn,function(){clearTimeout(self.internal.autohideId),self.internal.autohideId=setTimeout(function(){self.css.jq.gui.fadeOut(self.options.autohide.fadeOut)},self.options.autohide.hold)})};this.css.jq.gui.length&&(this.css.jq.gui.stop(!0,!0),clearTimeout(this.internal.autohideId),this.element.unbind(namespace),this.css.jq.gui.unbind(namespace),this.status.nativeVideoControls?this.css.jq.gui.hide():this.options.fullWindow&&this.options.autohide.full||!this.options.fullWindow&&this.options.autohide.restored?(this.element.bind(eventType,handler),this.css.jq.gui.bind(eventType,handler),this.css.jq.gui.hide()):this.css.jq.gui.show())},fullScreen:function(){this._setOption("fullScreen",!0)},restoreScreen:function(){this._setOption("fullScreen",!1)},_fullscreenAddEventListeners:function(){var self=this,fs=$.jPlayer.nativeFeatures.fullscreen;fs.api.fullscreenEnabled&&fs.event.fullscreenchange&&("function"!=typeof this.internal.fullscreenchangeHandler&&(this.internal.fullscreenchangeHandler=function(){self._fullscreenchange()}),document.addEventListener(fs.event.fullscreenchange,this.internal.fullscreenchangeHandler,!1))},_fullscreenRemoveEventListeners:function(){var fs=$.jPlayer.nativeFeatures.fullscreen;this.internal.fullscreenchangeHandler&&document.addEventListener(fs.event.fullscreenchange,this.internal.fullscreenchangeHandler,!1)},_fullscreenchange:function(){this.options.fullScreen&&!$.jPlayer.nativeFeatures.fullscreen.api.fullscreenElement()&&this._setOption("fullScreen",!1)},_requestFullscreen:function(){var e=this.ancestorJq.length?this.ancestorJq[0]:this.element[0],fs=$.jPlayer.nativeFeatures.fullscreen;fs.used.webkitVideo&&(e=this.htmlElement.video),fs.api.fullscreenEnabled&&fs.api.requestFullscreen(e)},_exitFullscreen:function(){var e,fs=$.jPlayer.nativeFeatures.fullscreen;fs.used.webkitVideo&&(e=this.htmlElement.video),fs.api.fullscreenEnabled&&fs.api.exitFullscreen(e)},_html_initMedia:function(media){var $media=$(this.htmlElement.media).empty();$.each(media.track||[],function(i,v){var track=document.createElement("track");track.setAttribute("kind",v.kind?v.kind:""),track.setAttribute("src",v.src?v.src:""),track.setAttribute("srclang",v.srclang?v.srclang:""),track.setAttribute("label",v.label?v.label:""),v.def&&track.setAttribute("default",v.def),$media.append(track)
}),this.htmlElement.media.src=this.status.src,"none"!==this.options.preload&&this._html_load(),this._trigger($.jPlayer.event.timeupdate)},_html_setFormat:function(media){var self=this;$.each(this.formats,function(priority,format){return self.html.support[format]&&media[format]?(self.status.src=media[format],self.status.format[format]=!0,self.status.formatType=format,!1):void 0})},_html_setAudio:function(media){this._html_setFormat(media),this.htmlElement.media=this.htmlElement.audio,this._html_initMedia(media)},_html_setVideo:function(media){this._html_setFormat(media),this.status.nativeVideoControls&&(this.htmlElement.video.poster=this._validString(media.poster)?media.poster:""),this.htmlElement.media=this.htmlElement.video,this._html_initMedia(media)},_html_resetMedia:function(){this.htmlElement.media&&(this.htmlElement.media.id!==this.internal.video.id||this.status.nativeVideoControls||this.internal.video.jq.css({width:"0px",height:"0px"}),this.htmlElement.media.pause())},_html_clearMedia:function(){this.htmlElement.media&&(this.htmlElement.media.src="about:blank",this.htmlElement.media.load())},_html_load:function(){this.status.waitForLoad&&(this.status.waitForLoad=!1,this.htmlElement.media.load()),clearTimeout(this.internal.htmlDlyCmdId)},_html_play:function(time){var self=this,media=this.htmlElement.media;if(this._html_load(),isNaN(time))media.play();else{this.internal.cmdsIgnored&&media.play();try{if(media.seekable&&!("object"==typeof media.seekable&&media.seekable.length>0))throw 1;media.currentTime=time,media.play()}catch(err){return void(this.internal.htmlDlyCmdId=setTimeout(function(){self.play(time)},250))}}this._html_checkWaitForPlay()},_html_pause:function(time){var self=this,media=this.htmlElement.media;if(time>0?this._html_load():clearTimeout(this.internal.htmlDlyCmdId),media.pause(),!isNaN(time))try{if(media.seekable&&!("object"==typeof media.seekable&&media.seekable.length>0))throw 1;media.currentTime=time}catch(err){return void(this.internal.htmlDlyCmdId=setTimeout(function(){self.pause(time)},250))}time>0&&this._html_checkWaitForPlay()},_html_playHead:function(percent){var self=this,media=this.htmlElement.media;this._html_load();try{if("object"==typeof media.seekable&&media.seekable.length>0)media.currentTime=percent*media.seekable.end(media.seekable.length-1)/100;else{if(!(media.duration>0)||isNaN(media.duration))throw"e";media.currentTime=percent*media.duration/100}}catch(err){return void(this.internal.htmlDlyCmdId=setTimeout(function(){self.playHead(percent)},250))}this.status.waitForLoad||this._html_checkWaitForPlay()},_html_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})))},_html_setProperty:function(property,value){this.html.audio.available&&(this.htmlElement.audio[property]=value),this.html.video.available&&(this.htmlElement.video[property]=value)},_flash_setAudio:function(media){var self=this;try{$.each(this.formats,function(priority,format){if(self.flash.support[format]&&media[format]){switch(format){case"m4a":case"fla":self._getMovie().fl_setAudio_m4a(media[format]);break;case"mp3":self._getMovie().fl_setAudio_mp3(media[format]);break;case"rtmpa":self._getMovie().fl_setAudio_rtmp(media[format])}return self.status.src=media[format],self.status.format[format]=!0,self.status.formatType=format,!1}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)}catch(err){this._flashError(err)}},_flash_setVideo:function(media){var self=this;try{$.each(this.formats,function(priority,format){if(self.flash.support[format]&&media[format]){switch(format){case"m4v":case"flv":self._getMovie().fl_setVideo_m4v(media[format]);break;case"rtmpv":self._getMovie().fl_setVideo_rtmp(media[format])}return self.status.src=media[format],self.status.format[format]=!0,self.status.formatType=format,!1}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)}catch(err){this._flashError(err)}},_flash_resetMedia:function(){this.internal.flash.jq.css({width:"0px",height:"0px"}),this._flash_pause(0/0)},_flash_clearMedia:function(){try{this._getMovie().fl_clearMedia()}catch(err){this._flashError(err)}},_flash_load:function(){try{this._getMovie().fl_load()}catch(err){this._flashError(err)}this.status.waitForLoad=!1},_flash_play:function(time){try{this._getMovie().fl_play(time)}catch(err){this._flashError(err)}this.status.waitForLoad=!1,this._flash_checkWaitForPlay()},_flash_pause:function(time){try{this._getMovie().fl_pause(time)}catch(err){this._flashError(err)}time>0&&(this.status.waitForLoad=!1,this._flash_checkWaitForPlay())},_flash_playHead:function(p){try{this._getMovie().fl_play_head(p)}catch(err){this._flashError(err)}this.status.waitForLoad||this._flash_checkWaitForPlay()},_flash_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.flash.jq.css({width:this.status.width,height:this.status.height})))},_flash_volume:function(v){try{this._getMovie().fl_volume(v)}catch(err){this._flashError(err)}},_flash_mute:function(m){try{this._getMovie().fl_mute(m)}catch(err){this._flashError(err)}},_getMovie:function(){return document[this.internal.flash.id]},_getFlashPluginVersion:function(){var flash,version=0;if(window.ActiveXObject)try{if(flash=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")){var v=flash.GetVariable("$version");v&&(v=v.split(" ")[1].split(","),version=parseInt(v[0],10)+"."+parseInt(v[1],10))}}catch(e){}else navigator.plugins&&navigator.mimeTypes.length>0&&(flash=navigator.plugins["Shockwave Flash"],flash&&(version=navigator.plugins["Shockwave Flash"].description.replace(/.*\s(\d+\.\d+).*/,"$1")));return 1*version},_checkForFlash:function(version){var flashOk=!1;return this._getFlashPluginVersion()>=version&&(flashOk=!0),flashOk},_validString:function(url){return url&&"string"==typeof url},_limitValue:function(value,min,max){return min>value?min:value>max?max:value},_urlNotSetError:function(context){this._error({type:$.jPlayer.error.URL_NOT_SET,context:context,message:$.jPlayer.errorMsg.URL_NOT_SET,hint:$.jPlayer.errorHint.URL_NOT_SET})},_flashError:function(error){var errorType;errorType=this.internal.ready?"FLASH_DISABLED":"FLASH",this._error({type:$.jPlayer.error[errorType],context:this.internal.flash.swf,message:$.jPlayer.errorMsg[errorType]+error.message,hint:$.jPlayer.errorHint[errorType]}),this.internal.flash.jq.css({width:"1px",height:"1px"})},_error:function(error){this._trigger($.jPlayer.event.error,error),this.options.errorAlerts&&this._alert("Error!"+(error.message?"\n"+error.message:"")+(error.hint?"\n"+error.hint:"")+"\nContext: "+error.context)},_warning:function(warning){this._trigger($.jPlayer.event.warning,undefined,warning),this.options.warningAlerts&&this._alert("Warning!"+(warning.message?"\n"+warning.message:"")+(warning.hint?"\n"+warning.hint:"")+"\nContext: "+warning.context)},_alert:function(message){var msg="jPlayer "+this.version.script+" : id='"+this.internal.self.id+"' : "+message;this.options.consoleAlerts?console&&console.log&&console.log(msg):alert(msg)},_emulateHtmlBridge:function(){var self=this;$.each($.jPlayer.emulateMethods.split(/\s+/g),function(i,name){self.internal.domNode[name]=function(arg){self[name](arg)}}),$.each($.jPlayer.event,function(eventName,eventType){var nativeEvent=!0;$.each($.jPlayer.reservedEvent.split(/\s+/g),function(i,name){return name===eventName?(nativeEvent=!1,!1):void 0}),nativeEvent&&self.element.bind(eventType+".jPlayer.jPlayerHtml",function(){self._emulateHtmlUpdate();var domEvent=document.createEvent("Event");domEvent.initEvent(eventName,!1,!0),self.internal.domNode.dispatchEvent(domEvent)})})},_emulateHtmlUpdate:function(){var self=this;$.each($.jPlayer.emulateStatus.split(/\s+/g),function(i,name){self.internal.domNode[name]=self.status[name]}),$.each($.jPlayer.emulateOptions.split(/\s+/g),function(i,name){self.internal.domNode[name]=self.options[name]})},_destroyHtmlBridge:function(){var self=this;this.element.unbind(".jPlayerHtml");var emulated=$.jPlayer.emulateMethods+" "+$.jPlayer.emulateStatus+" "+$.jPlayer.emulateOptions;$.each(emulated.split(/\s+/g),function(i,name){delete self.internal.domNode[name]})}},$.jPlayer.error={FLASH:"e_flash",FLASH_DISABLED:"e_flash_disabled",NO_SOLUTION:"e_no_solution",NO_SUPPORT:"e_no_support",URL:"e_url",URL_NOT_SET:"e_url_not_set",VERSION:"e_version"},$.jPlayer.errorMsg={FLASH:"jPlayer's Flash fallback is not configured correctly, or a command was issued before the jPlayer Ready event. Details: ",FLASH_DISABLED:"jPlayer's Flash fallback has been disabled by the browser due to the CSS rules you have used. Details: ",NO_SOLUTION:"No solution can be found by jPlayer in this browser. Neither HTML nor Flash can be used.",NO_SUPPORT:"It is not possible to play any media format provided in setMedia() on this browser using your current options.",URL:"Media URL could not be loaded.",URL_NOT_SET:"Attempt to issue media playback commands, while no media url is set.",VERSION:"jPlayer "+$.jPlayer.prototype.version.script+" needs Jplayer.swf version "+$.jPlayer.prototype.version.needFlash+" but found "},$.jPlayer.errorHint={FLASH:"Check your swfPath option and that Jplayer.swf is there.",FLASH_DISABLED:"Check that you have not display:none; the jPlayer entity or any ancestor.",NO_SOLUTION:"Review the jPlayer options: support and supplied.",NO_SUPPORT:"Video or audio formats defined in the supplied option are missing.",URL:"Check media URL is valid.",URL_NOT_SET:"Use setMedia() to set the media URL.",VERSION:"Update jPlayer files."},$.jPlayer.warning={CSS_SELECTOR_COUNT:"e_css_selector_count",CSS_SELECTOR_METHOD:"e_css_selector_method",CSS_SELECTOR_STRING:"e_css_selector_string",OPTION_KEY:"e_option_key"},$.jPlayer.warningMsg={CSS_SELECTOR_COUNT:"The number of css selectors found did not equal one: ",CSS_SELECTOR_METHOD:"The methodName given in jPlayer('cssSelector') is not a valid jPlayer method.",CSS_SELECTOR_STRING:"The methodCssSelector given in jPlayer('cssSelector') is not a String or is empty.",OPTION_KEY:"The option requested in jPlayer('option') is undefined."},$.jPlayer.warningHint={CSS_SELECTOR_COUNT:"Check your css selector and the ancestor.",CSS_SELECTOR_METHOD:"Check your method name.",CSS_SELECTOR_STRING:"Check your css selector is a string.",OPTION_KEY:"Check your option name."}}),function(){function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&length>index;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;return arguments.length<3&&(memo=obj[keys?keys[index]:index],index+=dir),iterator(obj,iteratee,memo,keys,index,length)}}function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);for(var length=getLength(array),index=dir>0?0:length-1;index>=0&&length>index;index+=dir)if(predicate(array[index],index,array))return index;return-1}}function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if("number"==typeof idx)dir>0?i=idx>=0?idx:Math.max(idx+length,i):length=idx>=0?Math.min(idx+1,length):idx+length+1;else if(sortedIndex&&idx&&length)return idx=sortedIndex(array,item),array[idx]===item?idx:-1;if(item!==item)return idx=predicateFind(slice.call(array,i,length),_.isNaN),idx>=0?idx+i:-1;for(idx=dir>0?i:length-1;idx>=0&&length>idx;idx+=dir)if(array[idx]===item)return idx;return-1}}function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length,constructor=obj.constructor,proto=_.isFunction(constructor)&&constructor.prototype||ObjProto,prop="constructor";for(_.has(obj,prop)&&!_.contains(keys,prop)&&keys.push(prop);nonEnumIdx--;)prop=nonEnumerableProps[nonEnumIdx],prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)&&keys.push(prop)}var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create,Ctor=function(){},_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.8.3";var optimizeCb=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}},cb=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?optimizeCb(value,context,argCount):_.isObject(value)?_.matcher(value):_.property(value)};_.iteratee=function(value,context){return cb(value,context,1/0)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(2>length||null==obj)return obj;for(var index=1;length>index;index++)for(var source=arguments[index],keys=keysFunc(source),l=keys.length,i=0;l>i;i++){var key=keys[i];undefinedOnly&&void 0!==obj[key]||(obj[key]=source[key])}return obj}},baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;return Ctor.prototype=null,result},property=function(key){return function(obj){return null==obj?void 0:obj[key]}},MAX_ARRAY_INDEX=Math.pow(2,53)-1,getLength=property("length"),isArrayLike=function(collection){var length=getLength(collection);return"number"==typeof length&&length>=0&&MAX_ARRAY_INDEX>=length};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj))for(i=0,length=obj.length;length>i;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;length>i;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;length>index;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results},_.reduce=_.foldl=_.inject=createReduce(1),_.reduceRight=_.foldr=createReduce(-1),_.find=_.detect=function(obj,predicate,context){var key;return key=isArrayLike(obj)?_.findIndex(obj,predicate,context):_.findKey(obj,predicate,context),void 0!==key&&-1!==key?obj[key]:void 0},_.filter=_.select=function(obj,predicate,context){var results=[];return predicate=cb(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)},_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;length>index;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return!1}return!0},_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;length>index;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return!0}return!1},_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){return isArrayLike(obj)||(obj=_.values(obj)),("number"!=typeof fromIndex||guard)&&(fromIndex=0),_.indexOf(obj,item,fromIndex)>=0},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return null==func?func:func.apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-1/0,lastComputed=-1/0;if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],value>result&&(result=value)}else iteratee=cb(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed>lastComputed||computed===-1/0&&result===-1/0)&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],result>value&&(result=value)}else iteratee=cb(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(lastComputed>computed||1/0===computed&&1/0===result)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var rand,set=isArrayLike(obj)?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0;length>index;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(isArrayLike(obj)||(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=cb(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=cb(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):isArrayLike(obj)?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:isArrayLike(obj)?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:_.initial(array,array.length-n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:_.rest(array,Math.max(0,array.length-n))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,startIndex){for(var output=[],idx=0,i=startIndex||0,length=getLength(input);length>i;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){shallow||(value=flatten(value,shallow,strict));var j=0,len=value.length;for(output.length+=len;len>j;)output[idx++]=value[j++]}else strict||(output[idx++]=value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1)},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=cb(iteratee,context));for(var result=[],seen=[],i=0,length=getLength(array);length>i;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;isSorted?(i&&seen===computed||result.push(value),seen=computed):iteratee?_.contains(seen,computed)||(seen.push(computed),result.push(value)):_.contains(result,value)||result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0))},_.intersection=function(array){for(var result=[],argsLength=arguments.length,i=0,length=getLength(array);length>i;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;argsLength>j&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(arguments,!0,!0,1);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(array){for(var length=array&&_.max(array,getLength).length||0,result=Array(length),index=0;length>index;index++)result[index]=_.pluck(array,index);return result},_.object=function(list,values){for(var result={},i=0,length=getLength(list);length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.findIndex=createPredicateIndexFinder(1),_.findLastIndex=createPredicateIndexFinder(-1),_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);for(var value=iteratee(obj),low=0,high=getLength(array);high>low;){var mid=Math.floor((low+high)/2);iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex),_.lastIndexOf=createIndexFinder(-1,_.findLastIndex),_.range=function(start,stop,step){null==stop&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;length>idx;idx++,start+=step)range[idx]=start;return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype),result=sourceFunc.apply(self,args);return _.isObject(result)?result:self};_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2),bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound},_.partial=function(func){var boundArgs=slice.call(arguments,1),bound=function(){for(var position=0,length=boundArgs.length,args=Array(length),i=0;length>i;i++)args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i];for(;position<arguments.length;)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound},_.bindAll=function(obj){var i,key,length=arguments.length;if(1>=length)throw new Error("bindAll must be passed function names");for(i=1;length>i;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=""+(hasher?hasher.apply(this,arguments):key);return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=_.partial(_.delay,_,1),_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining||remaining>wait?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last&&last>=0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.before=function(times,func){var memo;return function(){return--times>0&&(memo=func.apply(this,arguments)),1>=times&&(func=null),memo}},_.once=_.partial(_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var currentKey,keys=_.keys(obj),length=keys.length,results={},index=0;length>index;index++)currentKey=keys[index],results[currentKey]=iteratee(obj[currentKey],currentKey,obj);return results},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=createAssigner(_.allKeys),_.extendOwn=_.assign=createAssigner(_.keys),_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);for(var key,keys=_.keys(obj),i=0,length=keys.length;length>i;i++)if(key=keys[i],predicate(obj[key],key,obj))return key},_.pick=function(object,oiteratee,context){var iteratee,keys,result={},obj=object;if(null==obj)return result;_.isFunction(oiteratee)?(keys=_.allKeys(obj),iteratee=optimizeCb(oiteratee,context)):(keys=flatten(arguments,!1,!1,1),iteratee=function(value,key,obj){return key in obj},obj=Object(obj));for(var i=0,length=keys.length;length>i;i++){var key=keys[i],value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(flatten(arguments,!1,!1,1),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=createAssigner(_.allKeys,!0),_.create=function(prototype,props){var result=baseCreate(prototype);return props&&_.extendOwn(result,props),result},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(null==object)return!length;for(var obj=Object(object),i=0;length>i;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return!1}return!0};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var areArrays="[object Array]"===className;if(!areArrays){if("object"!=typeof a||"object"!=typeof b)return!1;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1}aStack=aStack||[],bStack=bStack||[];for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;if(aStack.push(a),bStack.push(b),areArrays){if(length=a.length,length!==b.length)return!1;for(;length--;)if(!eq(a[length],b[length],aStack,bStack))return!1}else{var key,keys=_.keys(a);if(length=keys.length,_.keys(b).length!==length)return!1;for(;length--;)if(key=keys[length],!_.has(b,key)||!eq(a[key],b[key],aStack,bStack))return!1}return aStack.pop(),bStack.pop(),!0};_.isEqual=function(a,b){return eq(a,b)},_.isEmpty=function(obj){return null==obj?!0:isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))?0===obj.length:0===_.keys(obj).length},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=property,_.propertyOf=function(obj){return null==obj?function(){}:function(key){return obj[key]}},_.matcher=_.matches=function(attrs){return attrs=_.extendOwn({},attrs),function(obj){return _.isMatch(obj,attrs)}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;n>i;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]
},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property,fallback){var value=null==object?void 0:object[property];return void 0===value&&(value=fallback),_.isFunction(value)?value.call(object):value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),define("util/tracker",["jquery","underscore"],function($){"use strict";return{timing:function(category,action,value,opt_lable){window.ga("send","timing",category,action,value,opt_lable)},event:function(category,action,opt_label,opt_value){window._hmt.push(["_trackEvent",category,action,opt_label,opt_value]),window.ga("send","event",category,action,opt_label,opt_value)},addPushLog:function(userId,platform,state,msg){$.get("/yws/mapi/ilogrpt",{method:"pushlink",userId:userId,platform:platform,state:state,time:(new Date).getTime(),msg:msg})}}}),define("util/trackTiming",["underscore","util/tracker"],function(_,tracker){function TrackTiming(category,variable,opt_label){return this.MAX_TIME=3e5,this.category=category,this.variable=variable,this.label=opt_label||void 0,this.startTime={},this.elapsedTime=0,this}return TrackTiming.prototype.setLabel=function(value){return this.label=value,this},TrackTiming.prototype.start=function(index){return this.startTime[index]=(new Date).getTime(),this},TrackTiming.prototype.end=function(index){return this.startTime[index]&&(this.elapsedTime=(new Date).getTime()-this.startTime[index]),this},TrackTiming.prototype.clear=function(index){return delete this.startTime[index],this.elapsedTime=0,this},TrackTiming.prototype.send=function(){return 0<this.elapsedTime&&this.elapsedTime<this.MAX_TIME&&tracker.timing(this.category,this.variable,this.elapsedTime,this.label),this},{changeGroupLoadFiles:new TrackTiming("change-group","load-files"),changeGroupLoadChat:new TrackTiming("change-group","load-chat"),openNote:new TrackTiming("open-file","open-note"),openTable:new TrackTiming("open-file","open-table"),openOffice:new TrackTiming("open-file","open-office"),closeNote:new TrackTiming("close-file","close-note"),closeTable:new TrackTiming("close-file","close-table"),closeOffice:new TrackTiming("close-file","close-office"),downFolder:new TrackTiming("change-folder","down"),upFolder:new TrackTiming("change-folder","up"),getFileByPath:new TrackTiming("ajax","file-getFileByPath"),getFilePath:new TrackTiming("ajax","file-getPathByFileId"),getFilePaths:new TrackTiming("ajax","file-getFilePaths"),getFile:new TrackTiming("ajax","file-getFile"),listFiles:new TrackTiming("ajax","file-listFiles"),listRevision:new TrackTiming("ajax","file-listRevision"),moveFile:new TrackTiming("ajax","file-move"),deleteFile:new TrackTiming("ajax","file-delete"),updateFile:new TrackTiming("ajax","file-update"),createFile:new TrackTiming("ajax","file-create"),getModifiers:new TrackTiming("ajax","file-getModifiers"),startEdit:new TrackTiming("ajax","file-startEdit"),stopEdit:new TrackTiming("ajax","file-stopEdit"),copyTo:new TrackTiming("ajax","file-copy"),getCopyId:new TrackTiming("ajax","file-getCopyId"),setEntryAuthority:new TrackTiming("ajax","file-setEntryAuthority"),setBatchUploadId:new TrackTiming("ajax","file-setBatchUploadId"),exportSingleFile:new TrackTiming("ajax","file-exportSingleFile"),exportMultiFiles:new TrackTiming("ajax","file-exportMultiFiles"),getGroup:new TrackTiming("ajax","group-get"),inviteCode:new TrackTiming("ajax","group-inviteCode"),getMyGroups:new TrackTiming("ajax","group-list"),getMyRole:new TrackTiming("ajax","group-getMyRole"),getMembers:new TrackTiming("ajax","group-getMembers"),getMembersHasAlias:new TrackTiming("ajax","group-listUsers"),createInvitationLink:new TrackTiming("ajax","group-createLink"),createGroup:new TrackTiming("ajax","group-create"),groupJoin:new TrackTiming("ajax","group-join"),removeMember:new TrackTiming("ajax","group-removeMember"),changeRole:new TrackTiming("ajax","group-changeRole"),changeOwner:new TrackTiming("ajax","group-changeOwner"),changeGroup:new TrackTiming("ajax","group-change"),updateSettings:new TrackTiming("ajax","group-updateSettings"),quitGroup:new TrackTiming("ajax","group-quit"),deleteGroup:new TrackTiming("ajax","group-delete"),createOrg:new TrackTiming("ajax","org-create"),listMember:new TrackTiming("ajax","org-listMember"),listGroups:new TrackTiming("ajax","org-listGroups"),listGroupOfMember:new TrackTiming("ajax","org-listGroupOfMember"),eraseGroup:new TrackTiming("ajax","org-eraseGroup"),recoverGroup:new TrackTiming("ajax","org-recoverGroup"),orgGroupJoin:new TrackTiming("ajax","org-groupJoin"),addMember:new TrackTiming("ajax","org-addMember"),removeOrgMember:new TrackTiming("ajax","org-removeOrgMember"),orgChangeRole:new TrackTiming("ajax","org-changeRole"),getRole:new TrackTiming("ajax","org-getRole"),updateOrg:new TrackTiming("ajax","org-update"),listOrg:new TrackTiming("ajax","org-listOrg"),getOrgMeta:new TrackTiming("ajax","org-getOrgMeta"),startTrail:new TrackTiming("ajax","org-startTrail"),startTrailfromBiz:new TrackTiming("ajax","org-startTrailfromBiz"),dismissOrg:new TrackTiming("ajax","org-dismiss"),quitOrg:new TrackTiming("ajax","org-quit"),getCurrentUserInfo:new TrackTiming("ajax","user-getCurrentUserInfo"),getUserInfo:new TrackTiming("ajax","user-getUserInfo"),getUsersInfo:new TrackTiming("ajax","user-getUsersInfo"),getSettingList:new TrackTiming("ajax","user-getSettingList"),searchUser:new TrackTiming("ajax","user-searchUser"),searchPrefix:new TrackTiming("ajax","user-searchPrefix"),updateUserInfo:new TrackTiming("ajax","user-updateUserInfo"),logout:new TrackTiming("ajax","user-logout"),isYDocUser:new TrackTiming("ajax","user-isYDocUser"),getAliasName:new TrackTiming("ajax","alias-getAliasName"),updateAliasName:new TrackTiming("ajax","alias-updateAliasName"),deleteAliasName:new TrackTiming("ajax","alias-deleteAliasName"),getAliasList:new TrackTiming("ajax","alias-getAliasList"),getApplicants:new TrackTiming("ajax","applicant-getApplicants"),listInvitee:new TrackTiming("ajax","applicant-listInvitee"),acceptApplicant:new TrackTiming("ajax","applicant-accept"),rejectApplicant:new TrackTiming("ajax","applicant-reject"),inviteApplicant:new TrackTiming("ajax","applicant-invite"),inviteApplicantByEmail:new TrackTiming("ajax","applicant-inviteByEmail"),inviteOrgMembers:new TrackTiming("ajax","applicant-inviteOrgMembers"),confirmApplicant:new TrackTiming("ajax","applicant-confirm"),ignoreApplicant:new TrackTiming("ajax","applicant-ignore"),deleteInvitee:new TrackTiming("ajax","applicant-deleteInvitee"),cancelNotice:new TrackTiming("ajax","applicant-cancelNotice"),cancelInterval:new TrackTiming("ajax","applicant-cancelInterval"),getNotificationTime:new TrackTiming("ajax","applicant-getNotificationTime"),getLastChatReadTime:new TrackTiming("ajax","applicant-getLastChatReadTime"),getLatestChatId:new TrackTiming("ajax","applicant-getLatestChatId"),listMessage:new TrackTiming("ajax","chat-listMessage"),sendText:new TrackTiming("ajax","chat-sendText"),sendNote:new TrackTiming("ajax","chat-sendNote"),sendFile:new TrackTiming("ajax","chat-sendFile"),listComment:new TrackTiming("ajax","comment-list"),addComment:new TrackTiming("ajax","comment-add"),removeComment:new TrackTiming("ajax","comment-remove"),getComment:new TrackTiming("ajax","comment-get"),locateComment:new TrackTiming("ajax","comment-locate"),createNote:new TrackTiming("ajax","note-create"),updateNote:new TrackTiming("ajax","note-update"),getContent:new TrackTiming("ajax","note-getContent"),singleImport:new TrackTiming("ajax","note-singleImport"),multiImport:new TrackTiming("ajax","note-multiImport"),statusMulti:new TrackTiming("ajax","note-statusMulti"),importFromYDoc:new TrackTiming("ajax","note-importFromYDoc"),multiImportFromYDoc:new TrackTiming("ajax","note-multiImportFromYDoc"),queryMulti:new TrackTiming("ajax","note-queryMulti"),singleExport:new TrackTiming("ajax","note-singleExport"),listNotebookByParentId:new TrackTiming("ajax","note-listNotebookByParentId"),listNotebookByParentPath:new TrackTiming("ajax","note-listNotebookByParentPath"),listNotebookByOld:new TrackTiming("ajax","note-listNotebookByOld"),ynoteRead:new TrackTiming("ajax","note-ynoteRead"),addNotice:new TrackTiming("ajax","notice-add"),getNotice:new TrackTiming("ajax","notice-get"),getBindInfo:new TrackTiming("ajax","pomelo-getBindInfo"),getServer:new TrackTiming("ajax","pomelo-getServer"),searchMessage:new TrackTiming("ajax","search-searchMessage"),searchComment:new TrackTiming("ajax","search-searchComment"),searchFile:new TrackTiming("ajax","search-searchFile"),allocateNew:new TrackTiming("ajax","table-allocateNew"),allocateExists:new TrackTiming("ajax","table-allocateExists"),saveTable:new TrackTiming("ajax","table-saveTable"),getRevisions:new TrackTiming("ajax","table-getRevisions"),getVersion:new TrackTiming("ajax","table-getVersion"),getMaxVersion:new TrackTiming("ajax","table-getMaxVersion"),getRecentContacts:new TrackTiming("ajax","p2p-getRecentContacts"),p2pSendText:new TrackTiming("ajax","p2p-sendText"),getRecentMessage:new TrackTiming("ajax","p2p-getRecentMessage"),getLatestReadP2PId:new TrackTiming("ajax","p2p-getLatestReadP2PId"),getLastP2PId:new TrackTiming("ajax","p2p-getLastP2PId"),updateLatestP2PId:new TrackTiming("ajax","p2p-updateLatestP2PId"),startShare:new TrackTiming("ajax","share-start"),stopShare:new TrackTiming("ajax","share-stop"),getShareFile:new TrackTiming("ajax","share-getShareFile"),listShareFiles:new TrackTiming("ajax","share-listShareFiles"),listStars:new TrackTiming("ajax","stars-listStars"),addFavorite:new TrackTiming("ajax","stars-addFavorite"),cancelFavorite:new TrackTiming("ajax","stars-cancelFavorite"),listTrashes:new TrackTiming("ajax","trash-list"),restoreFile:new TrackTiming("ajax","trash-restore"),eraseTrash:new TrackTiming("ajax","trash-eraseTrash"),eraseTrashes:new TrackTiming("ajax","trash-eraseTrashes"),startUpload:new TrackTiming("ajax","h5upload-startUpload"),completeUpload:new TrackTiming("ajax","h5upload-completeUpload"),checkUpload:new TrackTiming("ajax","h5upload-checkUpload")}}),define("common/service/groupService",["underscore","util/trackTiming"],function(_,trackTiming){return function($http,$rootScope,$q,$cacheFactory,ROLES){function invoke(fn,args){_.isFunction(fn)&&fn.apply(this,args)}function Group(json){var groupType={normal:!1,vip:!1,feedback:!1,hundred:!1,inner_group:!1},setTypeInfo=function(type){this.type=type,this.typeName=GROUP_TYPE_NAME[type],this.memberLimit=GROUP_MEMBER_LIMIT[type]}.bind(this);if(this.id=Number(json.groupId||0),this.owner=String(json.ownerId||""),this.ownerName=String(json.name||""),this.name=String(json.groupName||""),this.description=String(json.description||""),this.acl=Number(json.acl||1),this.size=Number(json.memberCount||0),this.createTime=new Date(json.createTime),this.modifyTime=new Date(json.modifyTime||0),json.properties&&(this.photo=String(json.properties.photo||""),this.confirm=String(json.properties.confirm||""),this.orgId=Number(json.properties.orgId)||0,this.deleted=Boolean(JSON.parse(json.properties.del||!1))),this.totalSpace=Number(json.quotaSpace),this.usedSpace=Number(json.fileSpace),this.isVip=!1,this.memberLimit=20,json.properties&&json.properties.limit){var limits=JSON.parse(json.properties.limit).limits;_.each(limits,function(obj){obj.type&&(groupType[obj.type]=!0)}.bind(this)),groupType.vip?(setTypeInfo("vip"),this.isVip=!0,groupType.feedback&&setTypeInfo("feedback")):groupType.normal?(setTypeInfo("normal"),groupType.hundred&&setTypeInfo("hundred"),groupType.feedback&&setTypeInfo("feedback")):setTypeInfo(groupType.inner_group?"inner_group":groupType.feedback?"feedback":"normal")}else this.isVip=this.totalSpace>=10737418240;this.isVip?(this.MAX_UPLOAD_SIZE=1073741824,this.MAX_ATTACHMENT_SIZE=1073741824):this.orgId&&0!==this.orgId?(this.MAX_UPLOAD_SIZE=1073741824,this.MAX_ATTACHMENT_SIZE=1073741824):(this.MAX_UPLOAD_SIZE=209715200,this.MAX_ATTACHMENT_SIZE=26214400)}function Member(json){this.userId=String(json.userId||""),this.name=String(json.name||""),this.joinTime=new Date(json.joinTime||json.modifyTime||0),json.photo||(json.photo="style/images/033488d9.dummy_user.jpg"),this.photo=String(json.photo||""),this.groupId=Number(json.groupId||0),this.role=String(json.role||""),this.settings={msg:Number(json.messageSetting)},this.aliasName=json.aliasName,json.properties&&json.properties.aliasName&&(this.aliasName=String(json.properties.aliasName||this.aliasName),this.aliasPinyin=String(json.properties.aliasPinyin)),this.pinyin=json.pinyin,json.properties&&(this.pinyin=String(json.properties.pinyin||this.pinyin))}function getGroup(id,sb,fb){var group=new Group({groupId:id});return trackTiming.getGroup.start(),$http.get("/yws/api/group/"+id,{params:{method:"get"}}).success(function(json){return trackTiming.getGroup.end().setLabel("success").send().clear(),null===json?void invoke(fb,[]):(Group.call(group,json),void invoke(sb,[group]))}).error(function(e){trackTiming.getGroup.end().setLabel("error").send().clear(),invoke(fb,[e])}),group}function getGroupByInviteCode(code,sb,fb){var group=new Group({});return trackTiming.inviteCode.start(),$http.get("/yws/api/group",{params:{method:"inviteCode",invite:code}}).success(function(json){trackTiming.inviteCode.end().setLabel("success").send().clear(),getGroup(json.groupId,function(value){_.extend(group,value),invoke(sb,[group])},function(e){invoke(fb,[e])})}).error(function(e){trackTiming.inviteCode.end().setLabel("error").send().clear(),invoke(fb,[e])}),group}function getInvitation(code){var deferred=$q.defer();return trackTiming.inviteCode.start(),$http.get("/yws/api/group",{params:{method:"inviteCode",invite:code}}).success(function(invitation){trackTiming.inviteCode.end().setLabel("success").send().clear(),deferred.resolve(invitation)}).error(function(e){trackTiming.inviteCode.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function getMyGroups(sb,fb){var groups=[];return trackTiming.getMyGroups.start(),$http.get("/yws/api/group",{params:{method:"list"}}).success(function(jsons){trackTiming.getMyGroups.end().setLabel("success").send().clear(),_.each(jsons,function(json){groups.push(new Group(json))}),invoke(sb,[groups])}).error(function(e){trackTiming.getMyGroups.end().setLabel("error").send().clear(),invoke(fb,[e])}),groups}function getMyRole(groupId,userId){var deferred=$q.defer(),me=new Member({groupId:groupId}),key=String(groupId);if(userId&&(myUserId=userId),myGroupRoleCache.get(key))return $q.when(myGroupRoleCache.get(key));var i=Math.random();return trackTiming.getMyRole.start(i),$http.get("/yws/api/group/"+groupId+"/self",{params:{method:"get"}}).success(function(data){trackTiming.getMyRole.end(i).setLabel("success").send().clear(i),Member.call(me,data),myGroupRoleCache.put(key,me),deferred.resolve(me)}).error(function(e){trackTiming.getMyRole.end(i).setLabel("error").send().clear(i),deferred.reject(e)}),deferred.promise}function getMembers(groupId,timeout,sb,fb){var members=[];return trackTiming.getMembers.start(),$http.get("/yws/api/group/"+groupId+"/member",{params:{method:"list"},timeout:timeout.promise}).success(function(array){trackTiming.getMembers.end().setLabel("success").send().clear(),_.each(array,function(json){json.groupId=groupId,members.push(new Member(json))}),invoke(sb,[members])}).error(function(json){trackTiming.getMembers.end().setLabel("error").send().clear(),invoke(fb,[json])}),members}function getMembersHasAlias(groupId,sb,fb){var members=[];return trackTiming.getMembersHasAlias.start(),$http.get("/yws/api/group/"+groupId+"/member",{params:{method:"listUsers"}}).success(function(array){trackTiming.getMembersHasAlias.end().setLabel("success").send().clear(),invoke(sb,[array])}).error(function(json){trackTiming.getMembersHasAlias.end().setLabel("error").send().clear(),invoke(fb,[json])}),members}function createInvitationLink(groupId,sb,fb){var invitationLinkObject={url:""};trackTiming.createInvitationLink.start(),$http.post("/yws/api/group/"+groupId,null,{params:{method:"createLink"},transformResponse:function(url){return invitationLinkObject.url=url,invitationLinkObject}}).success(function(json){trackTiming.createInvitationLink.end().setLabel("success").send().clear(),invoke(sb,[json])}).error(function(json){trackTiming.createInvitationLink.end().setLabel("error").send().clear(),invoke(fb,[json])})}function createGroup(name,orgId,description,acl,sb,fb){var group=new Group({name:name});return trackTiming.createGroup.start(),$http.post("/yws/api/group",{groupName:name,orgId:orgId,description:description,acl:acl},{params:{method:"create"}}).success(function(json){trackTiming.createGroup.end().setLabel("success").send().clear(),Group.call(group,json),invoke(sb,[group]),$rootScope.$broadcast(EVENTS.CREATE,group)}).error(function(e){trackTiming.createGroup.end().setLabel("error").send().clear(),invoke(fb,[e])}),group}function joinGroup(groupId,message,sb,fb){trackTiming.groupJoin.start(),$http.post("/yws/api/group/"+groupId+"/applicant",{message:message},{params:{method:"request"}}).success(function(json){trackTiming.groupJoin.end().setLabel("success").send().clear(),invoke(sb,[json]),message||$rootScope.$broadcast(EVENTS.JOIN,groupId)}).error(function(json){trackTiming.groupJoin.end().setLabel("error").send().clear(),invoke(fb,[json])})}function removeMember(groupId,userId,sb,fb){trackTiming.removeMember.start(),$http.post("/yws/api/group/"+groupId+"/member",{memberId:userId},{params:{method:"del"}}).success(function(){trackTiming.removeMember.end().setLabel("success").send().clear(),invoke(sb,[])}).error(function(e){trackTiming.removeMember.end().setLabel("error").send().clear(),invoke(fb,[e])})}function changeRole(groupId,userId,role,sb,fb){trackTiming.changeRole.start(),$http.post("/yws/api/group/"+groupId+"/member",{role:role,memberId:userId},{params:{method:"changeRole"}}).success(function(json){trackTiming.changeRole.end().setLabel("success").send().clear(),invoke(sb,[json])}).error(function(json){trackTiming.changeRole.end().setLabel("error").send().clear(),invoke(fb,[json])})}function changeOwner(groupId,userId,sb,fb){trackTiming.changeOwner.start(),$http.post("/yws/api/group/"+groupId+"/member",{memberId:userId},{params:{method:"changeOwner"}}).success(function(json){trackTiming.changeOwner.end().setLabel("success").send().clear(),invoke(sb,[json])}).error(function(json){trackTiming.changeOwner.end().setLabel("error").send().clear(),invoke(fb,[json])})}function update(group,sb,fb){return trackTiming.changeGroup.start(),$http.post("/yws/api/group/"+group.id,{groupName:group.name,acl:group.acl,description:group.description},{params:{method:"change"}}).success(function(json){trackTiming.changeGroup.end().setLabel("success").send().clear(),Group.call(group,json),invoke(sb,[json]),$rootScope.$broadcast(EVENTS.UPDATE,group.id,group)}).error(function(e){trackTiming.changeGroup.end().setLabel("error").send().clear(),invoke(fb,[e])}),group}function updateSettings(groupId,msg,sb,fb){trackTiming.updateSettings.start(),$http.post("/yws/api/group/"+groupId+"/self",{messageSetting:msg},{params:{method:"changeSetting"}}).success(function(json){trackTiming.updateSettings.end().setLabel("success").send().clear(),invoke(sb,[json])}).error(function(e){trackTiming.updateSettings.end().setLabel("error").send().clear(),invoke(fb,[e])})}function quit(groupId,sb,fb){trackTiming.quitGroup.start(),$http.post("/yws/api/group/"+groupId+"/member",null,{params:{method:"quit"}}).success(function(){trackTiming.quitGroup.end().setLabel("success").send().clear(),invoke(sb,[]),$rootScope.$broadcast(EVENTS.QUIT,groupId)}).error(function(e){trackTiming.quitGroup.end().setLabel("error").send().clear(),invoke(fb,[e])})}function dismiss(group,sb,fb){trackTiming.deleteGroup.start(),$http.post("/yws/api/group/"+group.id,null,{params:{method:"del"}}).success(function(){trackTiming.deleteGroup.end().setLabel("success").send().clear(),invoke(sb,[]),$rootScope.$broadcast(EVENTS.DISMISS,group)}).error(function(e){trackTiming.deleteGroup.end().setLabel("error").send().clear(),invoke(fb,[e])})}function onMemberEvent(evt,content,value){var member,key=value.groupId;switch(value.action){case 3:case 4:value.object.userId===myUserId&&myGroupRoleCache.remove(key);break;case 5:value.object.userId===myUserId&&(member=myGroupRoleCache.get(key),member.role=value.value,myGroupRoleCache.put(key,member));break;case 6:value.object.userId===myUserId&&(member=myGroupRoleCache.get(key),member.role=ROLES.GROUP_FOUNDER,myGroupRoleCache.put(key,member))}}var myUserId,EVENTS={QUIT:"group.quit",CREATE:"group.create",UPDATE:"group.update",JOIN:"group.join",DISMISS:"group.dismiss",INVITED:"group.invited",FORWARD:"group.forward",CHANGED:"group.changed"},GROUP_TYPE_NAME={normal:"普通群",vip:"高级群",feedback:"反馈群",hundred:"百人群",inner_group:"组织内部群"},GROUP_MEMBER_LIMIT={normal:20,vip:100,feedback:500,hundred:100,inner_group:1e4},myGroupRoleCache=$cacheFactory("group.member.role");_.extend(this,EVENTS),$rootScope.$on("socket.event.1",onMemberEvent),this.getMyGroups=getMyGroups,this.getGroup=getGroup,this.getMembers=getMembers,this.getMembersHasAlias=getMembersHasAlias,this.getMyRole=getMyRole,this.getGroupByInviteCode=getGroupByInviteCode,this.createInvitationLink=createInvitationLink,this.createGroup=createGroup,this.joinGroup=joinGroup,this.removeMember=removeMember,this.changeRole=changeRole,this.changeOwner=changeOwner,this.getInvitation=getInvitation,this.update=update,this.updateSettings=updateSettings,this.quit=quit,this.dismiss=dismiss,this.Group=Group,this.Member=Member}}),define("common/service/fileManager",["underscore","util/trackTiming"],function(_,trackTiming){"use strict";return function($http,$q,uploader,downloads,client,$timeout,dialogService,storageManager,LOCAL_STORAGE_KEY){function File(gid,json){this.gid=gid,this.id=json.fileId?String(json.fileId):void 0,this.isFolder=json.dir?Boolean(json.dir):!1,this.files=json.childrenNum?Number(json.childrenNum):0,this.folders=json.directoryNum?Number(json.directoryNum):0,this.size=json.size?Number(json.size):void 0,this.name="/"===json.name?"全部文件":String(json.name).replace(/\\\//g,"/"),this.parentId=json.parentId?String(json.parentId):void 0,this.version=void 0!==json.version?Number(json.version):void 0,this.creator=json.creator?{id:String(json.creator.userId),name:String(json.creator.name),photo:String(json.creator.photo)}:{},this.createDate=json.createTime?new Date(json.createTime):void 0,this.modifier=json.modifier?{id:String(json.modifier.userId),name:String(json.modifier.name),photo:json.modifier.photo?String(json.modifier.photo):null}:{},this.lastUpdater=json.lastUpdater?{id:String(json.lastUpdater.userId),name:String(json.lastUpdater.name),photo:json.lastUpdater.photo?String(json.lastUpdater.photo):null}:{},this.lastModifiedDate=new Date(json.modiftyTime?json.modiftyTime:json.lastUpdateTime),this.lastUpdateTime=json.lastUpdateTime,this.comments=void 0!==json.commentNum?Number(json.commentNum):0,this.domain=json.domain,this.data=json,this.favorite=json.favorite,this.favoriteDate=json.opTime?new Date(json.opTime):null,json.properties&&(this.isOnlyManagerEdit=!Boolean(1&json.authCode),this.isOnlyManagerView=!Boolean(2&json.authCode),this.authCode=Number(json.authCode)),_.isObject(this.data)&&(this.data.isOnlyManagerEdit=!Boolean(1&json.authCode),this.data.isOnlyManagerView=!Boolean(2&json.authCode),this.data.authCode=Number(json.authCode),delete this.data.onlyManagerEdit,delete this.data.onlyManagerView,delete this.data.authCode)}var tempPercent=20,storage=storageManager.forAll();this.getRoot=function(gid){return this.getFileByPath(gid,"/")},this.getFileByPath=function(gid,path,backTrack){var defer=$q.defer(),i=Math.random();return trackTiming.getFileByPath.start(i),$http.get("/yws/api/group/"+gid+"/file",{params:{path:path,method:"getFileByPath",needAncestors:backTrack?!0:void 0}}).success(function(json){trackTiming.getFileByPath.end(i).setLabel("success").send().clear(i);var file=new File(gid,json),child=file;_.each(json.properties.ancestors,function(ancestor){var parent;parent=new File(gid,ancestor),child.parent=parent,child=parent}),defer.resolve(file)}).error(function(e,status){trackTiming.getFileByPath.end(i).setLabel("error").send().clear(i),defer.reject(e,status)}),defer.promise},this.getFilePath=function(gid,fileId){var defer=$q.defer();return trackTiming.getFilePath.start(),$http.get("/yws/api/group/"+gid+"/file/"+fileId,{params:{method:"getPathByFileId"}}).success(function(json){trackTiming.getFilePath.end().setLabel("success").send().clear(),defer.resolve(json.path)}).error(function(e,status){trackTiming.getFilePath.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.getFilePaths=function(gid,ids){return trackTiming.getFilePaths.start(),$http.get("/yws/api/group/"+gid+"/file?method=getPaths",{params:{fileIdList:ids.join(",")}}).then(function(res){return trackTiming.getFilePaths.end().setLabel("success").send().clear(),res.data}).catch(function(e){return trackTiming.getFilePaths.end().setLabel("error").send().clear(),$q.reject(e.data)})},this.getFile=function(gid,fileId,version,batchId){var defer=$q.defer(),params={method:"getFile",batchId:batchId};return version&&(params.version=version),trackTiming.getFile.start(),$http.get("/yws/api/group/"+gid+"/file/"+fileId,{params:params}).success(function(json){trackTiming.getFile.end().setLabel("success").send().clear(),defer.resolve(new File(gid,json))}).error(function(e,status){trackTiming.getFile.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.listFiles=function(gid,path,filter,timeout){var defer=$q.defer();return trackTiming.listFiles.start(),$http.get("/yws/api/group/"+gid+"/file",{params:{method:"listFile",path:path},timeout:timeout?timeout.promise:null}).success(function(array){trackTiming.listFiles.end().setLabel("success").send().clear();var files=[];_.each(array,function(json){var file=new File(gid,json);_.isFunction(filter)&&filter(file)===!1||files.push(file)}),defer.resolve(files)}).error(function(e,status){trackTiming.listFiles.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.listRevision=function(gid,fileId,includeCurrentRevision){var defer=$q.defer();return trackTiming.listRevision.start(),$http.get("/yws/api/group/"+gid+"/file/"+fileId,{params:{method:"listFileRevision",includeCurrentRevision:includeCurrentRevision!==!1,draftRelated:!1}}).success(function(array){trackTiming.listRevision.end().setLabel("success").send().clear();var revs=[];_.each(array,function(json){revs.unshift(new File(gid,json))}),defer.resolve(revs)}).error(function(e,status){trackTiming.listRevision.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.move=function(gid,file,folder,name){return this.getFilePaths(gid,[file.id,folder.id]).then(function(paths){return trackTiming.moveFile.start(),$http.post("/yws/api/group/"+gid+"/file",{srcPath:paths[file.id],destPath:paths[folder.id],fileName:name||""},{params:{method:"moveFile"}})}).then(function(res){return trackTiming.moveFile.end().setLabel("success").send().clear(),new File(gid,res.data)}).catch(function(e){return $q.reject(e.status?e.data:e)})},this.moveAndRename=function(gid,file,folder,name){return this.move(gid,file,folder,name)},this.remove=function(gid,file){function doRemove(file){trackTiming.deleteFile.start(),$http.post("/yws/api/group/"+gid+"/file/"+file.id,null,{params:{method:"deleteFile",lastUpdateTime:file.lastUpdateTime}}).success(function(json){trackTiming.deleteFile.end().setLabel("success").send().clear(),defer.resolve(new File(gid,json))}).error(onError)}function onError(e,status){trackTiming.deleteFile.end().setLabel("error").send().clear(),defer.reject(e,status)}var defer=$q.defer();return this.getFile(gid,file.id).then(doRemove).catch(onError),defer.promise},this.rename=function(gid,file,name){return this.updateFile(gid,file,name)},this.updateFile=function(gid,file,name,code){var defer=$q.defer();return trackTiming.updateFile.start(),$http.post("/yws/api/group/"+gid+"/file/"+file.id,{name:name,authCode:code},{params:{method:"updateFile"}}).success(function(json){trackTiming.updateFile.end().setLabel("success").send().clear(),defer.resolve(new File(gid,json))}).error(function(e,status){trackTiming.updateFile.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.overwrite=function(gid,fileId,transId,batchId){var defer;return fileId instanceof File?this.overwrite(gid,fileId.id,transId,batchId):(defer=$q.defer(),trackTiming.updateFile.start(),$http.post("/yws/api/group/"+gid+"/file/"+fileId,{transmitId:transId,batchId:batchId},{params:{method:"updateFile"}}).success(function(json){trackTiming.updateFile.end().setLabel("success").send().clear(),defer.resolve(new File(gid,json))}).error(function(e,status){trackTiming.updateFile.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise)},this.newFolder=function(gid,name,folder){var defer=$q.defer();return trackTiming.createFile.start(),$http.post("/yws/api/group/"+gid+"/file",{directory:!0,name:name,parentId:folder.id},{params:{method:"createFile"}}).success(function(json){trackTiming.createFile.end().setLabel("success").send().clear(),defer.resolve(new File(gid,json))
}).error(function(e,status){trackTiming.createFile.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.uploadFolder=function(gid,name,folder,sendMsg,batchId){var defer=$q.defer();return trackTiming.createFile.start(),$http.post("/yws/api/group/"+gid+"/file",{directory:!0,name:name,parentId:folder.id,opCode:6,sendMsg:sendMsg,batchId:batchId},{params:{method:"createFile"}}).success(function(json){trackTiming.createFile.end().setLabel("success").send().clear(),defer.resolve(new File(gid,json))}).error(function(e,status){trackTiming.createFile.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.newFile=function(gid,name,folder,transId,noMsg,batchId){var defer=$q.defer();return trackTiming.createFile.start(),$http.post("/yws/api/group/"+gid+"/file",{name:name,directory:!1,parentId:folder.id,transmitId:transId,sendMsg:!noMsg,batchId:batchId},{params:{method:"createFile"}}).success(function(json){trackTiming.createFile.end().setLabel("success").send().clear(),defer.resolve(new File(gid,json))}).error(function(e,status){trackTiming.createFile.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.createNewFileTask=function(gid,files,folder){var task=uploader.createTask("/yws/api/group/"+gid+"/file");return _.each(files,function(file){task.append("file",file)}),task.append("parent",folder?folder.path:"/"),task},this.download=function(gid,files){function showDownloadHint(){storage.get(LOCAL_STORAGE_KEY.DOWNLOAD_FOLDER_HINT)||(dialogService.alert("下载","文件夹中的笔记和表格不支持下载到本地，因为它们只能在协作中编辑。"),storage.put(LOCAL_STORAGE_KEY.DOWNLOAD_FOLDER_HINT,!0))}function singleDownload(){var file=files[0];file.isFolder&&client.isNative()?client.downloadDir(file.name,"/yws/api/group/"+gid+"/file/"+file.id+"?method=download"):downloads.download(file.name,"/yws/api/group/"+gid+"/file/"+file.id+"?method=download"+(void 0!==file.version?"&version="+file.version:"")),file.isFolder&&showDownloadHint()}function batchDownload(){var name=files[0].name+"等"+files.length+"个文件",url="/yws/api/group/"+gid+"/file?method=downloads&fileIdList="+_.map(files,function(file){return file.id}).join(",");client.isNative()?client.downloadDir(name,url):downloads.download(name,url);var hasFolder=_.find(files,function(file){return file.isFolder});hasFolder&&showDownloadHint()}files=[].concat(files),1==files.length?singleDownload():batchDownload()},this.getModifiers=function(gid,fileId){return trackTiming.getModifiers.start(),$http.get("/yws/api/group/"+gid+"/file/"+fileId+"/lease",{params:{method:"getModifiers"}}).then(function(json){return trackTiming.getModifiers.end().setLabel("success").send().clear(),json.data.editors})},this.startEdit=function(gid,fileId){return trackTiming.startEdit.start(),$http.get("/yws/api/group/"+gid+"/file/"+fileId+"/lease",{params:{method:"update"}}).then(function(json){return trackTiming.startEdit.end().setLabel("success").send().clear(),json.data.editors})},this.stopEdit=function(gid,fileId){return trackTiming.stopEdit.start(),$http.get("/yws/api/group/"+gid+"/file/"+fileId+"/lease",{params:{method:"remove"}}).then(function(json){return trackTiming.stopEdit.end().setLabel("success").send().clear(),json.data.editors})},this.copyTo=function(file,fromGroupId,dstGroupId,dstFolderId,adviceName){var fileName,defer=$q.defer();return fileName=_.isUndefined(adviceName)?"":adviceName,trackTiming.copyTo.start(),$http.post("/yws/api/group/"+fromGroupId+"/file/"+file.id,{groupId:fromGroupId,dstGroupId:dstGroupId,dstFolderId:dstFolderId,adviceName:fileName},{params:{method:"copy"}}).success(function(json){trackTiming.copyTo.end().setLabel("success").send().clear(),defer.resolve(new File(fromGroupId,json))}).error(function(e,status){trackTiming.copyTo.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.getCopyId=function(file,fromGroupId,dstGroupId,dstFolderId){var defer=$q.defer();return trackTiming.getCopyId.start(),$http.post("/yws/api/group/"+fromGroupId+"/file/"+file.id,{groupId:fromGroupId,dstGroupId:dstGroupId,dstFolderId:dstFolderId},{params:{method:"startCopy"}}).success(function(json,status,headers){trackTiming.getCopyId.end().setLabel("success").send().clear(),defer.resolve(headers().copyprocessid)}).error(function(e,status){trackTiming.getCopyId.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.copyFolderTo=function(file,fromGroupId,dstGroupId,dstFolderId,adviceName,copyProcessId){var fileName,defer=$q.defer();return fileName=_.isUndefined(adviceName)?"":adviceName,trackTiming.copyTo.start(),$http.post("/yws/api/group/"+fromGroupId+"/file/"+file.id,{groupId:fromGroupId,dstGroupId:dstGroupId,dstFolderId:dstFolderId,adviceName:fileName,copyProcessId:copyProcessId,queryFolderProcess:!1},{params:{method:"copy"}}).success(function(json){trackTiming.copyTo.end().setLabel("success").send().clear(),defer.resolve(new File(dstGroupId,json))}).error(function(e,status){trackTiming.copyTo.end().setLabel("error").send().clear(),defer.reject(e,status)}),function pullStatus(){trackTiming.copyTo.start(),$http.post("/yws/api/group/"+fromGroupId+"/file/"+file.id,{groupId:fromGroupId,dstGroupId:dstGroupId,dstFolderId:dstFolderId,adviceName:fileName,copyProcessId:copyProcessId,queryFolderProcess:!0},{params:{method:"copy"}}).success(function(json,status,headers){trackTiming.copyTo.end().setLabel("success").send().clear();var percent=100/parseInt(headers().copyprocess),detail=headers().copyprocess.split("/"),total=detail[0]?parseInt(detail[0]):0,finished=detail[1]?parseInt(detail[1]):0;return-1==finished?void setTimeout(pullStatus,500):finished>=total-1||-1>finished?void((finished>total-1||-1>finished)&&setTimeout(pullStatus,500)):(percent=20>percent?tempPercent+Math.floor(Math.random()*(100-tempPercent)*.5):Math.floor(percent),tempPercent=percent,defer.notify(percent),void setTimeout(pullStatus,500))}).error(function(){trackTiming.copyTo.end().setLabel("error").send().clear()})}(),defer.promise},this.setEntryAuthority=function(gid,fileId,code){var defer=$q.defer();return trackTiming.setEntryAuthority.start(),$http.post("/yws/api/group/"+gid+"/file/"+fileId,{},{params:{method:"setEntryAuthority",authCode:code}}).success(function(){trackTiming.setEntryAuthority.end().setLabel("success").send().clear(),defer.resolve()}).error(function(e,status){trackTiming.setEntryAuthority.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.setBatchUploadId=function(groupId,batchId,fileNumber){var defer=$q.defer();return trackTiming.setBatchUploadId.start(),$http.post("/yws/api/group/"+groupId+"/file",{batchId:batchId,fileNum:fileNumber},{params:{method:"batchUpload"}}).success(function(){trackTiming.setBatchUploadId.end().setLabel("success").send().clear(),defer.resolve()}).error(function(e,status){trackTiming.setBatchUploadId.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise},this.exportSingleFile=function(file){var defer=$q.defer();return trackTiming.exportSingleFile.start(),$http.post("/yws/api/group/"+file.gid+"/export",{},{params:{method:"single",fileId:file.id,autoRename:!0}}).success(function(res){trackTiming.exportSingleFile.end().setLabel("success").send().clear(),defer.resolve(res)}).error(function(e){trackTiming.exportSingleFile.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise},this.exportMultiFiles=function(files){var defer=$q.defer(),fileIdList=_.reduce(files,function(memo,file){return memo+(memo?",":"")+file.id},"");return trackTiming.exportMultiFiles.start(),$http.post("/yws/api/group/"+files[0].gid+"/export",{},{params:{method:"multi",fileIdList:fileIdList}}).success(function(res){trackTiming.exportMultiFiles.end().setLabel("success").send().clear(),defer.resolve(res)}).error(function(e){trackTiming.exportMultiFiles.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise},this.File=File}}),function(){!function(factory){return"function"==typeof define&&define.amd?define("bower_components/util/src/cookies",[],factory):factory()}(function(){function getter(name){var regexp=new RegExp("(^| )"+name+"=([^;]*)(;|$)"),token=document.cookie.match(regexp);return null===token?null:token[2]}function setter(name,value,expireDate){null===value&&(expireDate=new Date,expireDate.setTime(expireDate.getTime()-1),document.cookie=name+"="+value+";expires="+expireDate.toGMTString())}function string(){return document.cookie}return{get:getter,set:setter,string:string}})}.call(this),define("common/service/voiceService",["jquery","bower_components/util/src/cookies","jplayer"],function($,Cookies){"use strict";return function(clientProxy){function initPlayer(playUrl,playType){var solution,params={};params[playType]=playUrl,solution=clientProxy.isNative()?"flash":"html, flash",player=$("<div></div>").jPlayer({swfPath:"bower_components/jplayer/jquery.jplayer/Jplayer.swf",supplied:"m4a,mp3",solution:solution,preload:"auto",wmode:"window",ready:function(){player.jPlayer("setMedia",params).jPlayer("play"),inited=!0}}).appendTo(document.body)}var inited,player;inited=!1,this.play=function(playUrl,playType,endCb){var cstk=Cookies.get("YNOTE_CSTK");if(playUrl=playUrl+"&cstk="+cstk,inited){var params={};params[playType]=playUrl,player.jPlayer("setMedia",params).jPlayer("play")}else initPlayer(playUrl,playType);player.unbind($.jPlayer.event.ended).bind($.jPlayer.event.ended,function(){player.unbind($.jPlayer.event.ended),endCb()})},this.stop=function(){player.jPlayer("stop")}}}),define("common/service/voiceState",["underscore"],function(_){"use strict";var players=[];return function(){function registerPlayer(id,player){players.push({id:id,player:player})}function removePlayer(id){players=_.reject(players,function(value){return value.id===id})}function stopAllPlayers(){_.each(players,function(value){value.player.stop()})}return{registerPlayer:registerPlayer,removePlayer:removePlayer,stopAllPlayers:stopAllPlayers}}}),define("common/service/noteManager",["underscore","util/trackTiming"],function(_,trackTiming){"use strict";var YNOTE_PROPERTY={path:"p",depth:"dp",thinMode:"th",digestNumber:"dn",withThumb:"thm",thumbThreshold:"thrh",title:"tl",version:"v",encrypted:"encrypted",isDirectory:"r",isDeleted:"del",createTime:"ct",modifyTime:"mt",tags:"tg",length:"sz",noteNumber:"nn",author:"au",sourceUrl:"su",thumbUrl:"thmurl",property:"pp",digest:"dg",resourceNumber:"resnum",resourceSize:"ressize",pathList:"ps",baseVersion:"bv",threshold:"thr",fileId:"fid",size:"sz",destination:"dst",group:"ng"},YNOTE_ALIAS=_.invert(YNOTE_PROPERTY);return function($http,$q,fileMgr){function YNoteMeta(json){_.each(json,function(value,key){this[YNOTE_ALIAS[key]||key]=value},this),this.digest=this.property.dg}function NewYNoteMeta(json,isNewUser){var path,p,fileId,parentId,expandable,oldNotebook,name;return json.p&&(path=json.p,p=path.split("/"),1===p.length?fileId=p[0]:(fileId=p[p.length-1],parentId=p[p.length-2])),isNewUser?(expandable=json.subTreeDirNum?json.subTreeDirNum>0:!1,name=json.name):(oldNotebook=expandable=""!==json.ng,name=json.tl,/\./.test(name)||json.r||(name+=".note")),{id:json.id||fileId,name:name,expandable:expandable,title:json.name||json.tl,createTime:json.ct||json.crateTimeForSort,modifyTime:json.mt||json.modifyTimeForSort,parentId:json.parentId||parentId,path:json.p,isFolder:json.r||json.dir,size:json.sz||json.fileSize,domain:json.domain}}this.StackFile=function(json){return{id:json.id,name:json.name}},this.createNote=function(gid,folderId,title,content,draftId){var defer=$q.defer();return trackTiming.createNote.start(),$http.post("/yws/api/group/"+gid+"/note",{parentId:folderId,title:title,content:content,draftId:draftId},{params:{method:"create",editorType:1}}).success(function(json){trackTiming.createNote.end().setLabel("success").send().clear(),defer.resolve(new fileMgr.File(gid,json))}).error(function(e){trackTiming.createNote.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise},this.updateNote=function(gid,fileId,title,content,defer){return defer=defer||$q.defer(),_.isUndefined(content)?(this.getDraft(gid,fileId).then(_.bind(function(content){this.updateNote(gid,fileId,title,content,defer)},this)).catch(function(e){defer.reject(e)}),defer.promise):(trackTiming.updateNote.start(),$http.post("/yws/api/group/"+gid+"/note/"+fileId,{title:title,content:content},{params:{method:"update",editorType:1}}).success(function(json){trackTiming.updateNote.end().setLabel("success").send().clear(),defer.resolve(new fileMgr.File(gid,json))}).error(function(e){trackTiming.updateNote.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise)},this.convertNote=function(){return $q.when(!0)},this.getContent=function(gid,fileId,version,returnHtml){var defer=$q.defer(),params={method:"get-content",draftRelated:!1};return returnHtml||(params.editorType=1),trackTiming.getContent.start(),$http.get("/yws/api/group/"+gid+"/note/"+fileId+(_.isUndefined(version)?"":"/version/"+version),{params:params}).success(function(html){trackTiming.getContent.end().setLabel("success").send().clear(),defer.resolve(html)}).error(function(e){trackTiming.getContent.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise},this.getDraft=function(gid,fileId){var defer=$q.defer();return trackTiming.getContent.start(),$http.get("/yws/api/group/"+gid+"/note/"+fileId,{params:{method:"get-content",draftRelated:!0,editorType:1}}).success(function(html){trackTiming.getContent.end().setLabel("success").send().clear(),defer.resolve(html)}).error(function(e){trackTiming.getContent.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise},this.importFromMyNote=function(gid,fileId,meta){var path=meta.path;return trackTiming.singleImport.start(),$http.post("/yws/api/group/"+gid+"/note",{gNoteId:fileId,fileId:path.substring(path.lastIndexOf("/")+1,path.length)},{params:{method:"single-import"}}).then(function(res){return trackTiming.singleImport.end().setLabel("success").send().clear(),new fileMgr.File(gid,res.data)}).catch(function(res){return trackTiming.singleImport.end().setLabel("error").send().clear(),$q.reject(res.data)})},this.importFromMyNotes=function(gid,folderId,paths){var defer=$q.defer();return trackTiming.multiImport.start(),$http.post("/yws/api/group/"+gid+"/note",{groupId:gid,parentId:folderId,noteList:_.map(paths,function(path){return path.substring(path.lastIndexOf("/")+1,path.length)}).join(",")},{params:{method:"multi-import"}}).success(function(status){trackTiming.multiImport.end().setLabel("success").send().clear(),function pullStatus(){trackTiming.statusMulti.start(),$http.post("/yws/api/group/"+gid+"/note",{taskId:status.taskId},{params:{method:"status-multi"}}).success(function(status){return trackTiming.statusMulti.end().setLabel("success").send().clear(),status.finished?void defer.resolve(status):(defer.notify(status),void setTimeout(pullStatus,1e3))}).error(function(e){trackTiming.statusMulti.end().setLabel("error").send().clear(),defer.reject(e)})}()}).error(function(e){trackTiming.multiImport.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise},this.importFromYDoc=function(gid,overrideFile,fileId){return trackTiming.importFromYDoc.start(),$http.post("/yws/api/group/"+gid+"/import",{overrideFileId:overrideFile.id,parentId:overrideFile.parentId,fileId:fileId},{params:{method:"single"}}).then(function(res){return trackTiming.importFromYDoc.end().setLabel("success").send().clear(),new fileMgr.File(gid,res.data)}).catch(function(res){return trackTiming.importFromYDoc.end().setLabel("error").send().clear(),$q.reject(res.data)})},this.multiImportFromYDoc=function(gid,selectionList,parentId){for(var defer=$q.defer(),fileIdList="",i=0;i<selectionList.length;i++)0==i?fileIdList+=selectionList[i]:fileIdList=fileIdList+","+selectionList[i];return trackTiming.multiImportFromYDoc.start(),$http.post("/yws/api/group/"+gid+"/import",{parentId:parentId,fileIdList:fileIdList},{params:{method:"multi"}}).success(function(status){trackTiming.multiImportFromYDoc.end().setLabel("success").send().clear(),function pullStatus(){trackTiming.queryMulti.start(),$http.post("/yws/api/group/"+gid+"/query",{taskId:status.taskId},{params:{method:"multi"}}).success(function(status){return trackTiming.queryMulti.end().setLabel("success").send().clear(),status.finished?void defer.resolve(status):(status.isYDocImport=!0,defer.notify(status),void setTimeout(pullStatus,1e3))}).error(function(e){trackTiming.queryMulti.end().setLabel("error").send().clear(),defer.reject(e)})}()}).error(function(e){trackTiming.multiImportFromYDoc.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise},this.exportAsMyNotes=function(gid,fileId){var defer=$q.defer();return trackTiming.singleExport.start(),$http.post("/yws/api/group/"+gid+"/note/"+fileId,{groupId:gid,fileId:fileId},{params:{method:"single-export"}}).success(function(res){trackTiming.singleExport.end().setLabel("success").send().clear(),defer.resolve(res)}).error(function(e){trackTiming.singleExport.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise},this.ynote={},this.ynote.listNotebook=function(isNewUser,path,depth,dirOnly,fileId){var defer=$q.defer();return isNewUser?_.isUndefined(path)?(trackTiming.listNotebookByParentId.start(),$http.post("/yws/api/personal/file/"+fileId,{fileId:fileId,dirOnly:dirOnly},{params:{method:"listByParentId"}}).success(function(array){trackTiming.listNotebookByParentId.end().setLabel("success").send().clear();var result=_.filter(array,function(v){return!("false"!=v.entryProps.encrypted&&v.entryProps.encrypted||v.dir&&1==v.entryType&&"HUBDIR"==v.id)});defer.resolve(_.map(result,function(meta){return new NewYNoteMeta(meta,!0)}))}).error(function(e){trackTiming.listNotebookByParentId.end().setLabel("error").send().clear(),defer.reject(e)})):(trackTiming.listNotebookByParentPath.start(),$http.get("/yws/api/personal/file",{params:{method:"listByParentPath",path:path,dirOnly:dirOnly}}).success(function(array){trackTiming.listNotebookByParentPath.end().setLabel("success").send().clear();var result=_.filter(array,function(v){return!("false"!=v.entryProps.encrypted&&v.entryProps.encrypted||v.dir&&1==v.entryType&&"HUBDIR"==v.id)});defer.resolve(_.map(result,function(meta){return new NewYNoteMeta(meta,!0)}))}).error(function(e){trackTiming.listNotebookByParentPath.end().setLabel("error").send().clear(),defer.reject(e)})):(trackTiming.listNotebookByOld.start(),$http.get("/yws/mapi/filemeta",{params:{method:"get",alive:!0,dp:void 0===depth?1:depth,p:path}}).success(function(array){trackTiming.listNotebookByOld.end().setLabel("success").send().clear(),array=_.filter(array,function(json){return json.p!==path&&"/"!=json.p&&0===json.encrypted&&!(1==json.dr&&1==json.et&&"_HUBDIR"==json.p)}),defer.resolve(_.map(array,function(meta){return new YNoteMeta(meta,!1)}))}).error(function(e){trackTiming.listNotebookByOld.end().setLabel("error").send().clear(),defer.reject(e)})),defer.promise},this.ynote.listNotes=function(path){return this.listNotebook(!1,path,1)},this.ynote.read=function(meta){return trackTiming.ynoteRead.start(),$http.get("/yws/mapi/file",{params:{method:"get",dp:0,p:meta.path,v:-1,_:(new Date).getTime()}}).then(function(res){return trackTiming.ynoteRead.end().setLabel("success").send().clear(),res.data})}}}),define("common/service/userService",["underscore","util/trackTiming"],function(_,trackTiming){return function($http,$q){function invoke(fn,args){_.isFunction(fn)&&fn.apply(this,args)}this.getDefaultPhoto=function(){return"style/images/033488d9.dummy_user.jpg"},this.getCurrentUserInfo=function(){var deferred=$q.defer();return trackTiming.getCurrentUserInfo.start(),$http.get("/yws/api/self",{params:{method:"get"}}).success(function(json){trackTiming.getCurrentUserInfo.end().setLabel("success").send().clear(),json.photo||(json.photo="style/images/033488d9.dummy_user.jpg"),deferred.resolve(json)}).error(function(json){trackTiming.getCurrentUserInfo.end().setLabel("error").send().clear(),deferred.reject(json)}),deferred.promise},this.getUserInfo=function(userId){var defer=$q.defer();return trackTiming.getUserInfo.start(),$http.get("/yws/api/self/other",{params:{method:"get",userId:userId}}).success(function(json){trackTiming.getUserInfo.end().setLabel("success").send().clear(),json.photo||(json.photo="style/images/033488d9.dummy_user.jpg"),defer.resolve(json)}).error(function(json){trackTiming.getUserInfo.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise},this.getUsersInfo=function(usersId){var defer=$q.defer();return trackTiming.getUsersInfo.start(),$http.post("/yws/api/self/multi?method=getMulti",{userId:usersId}).success(function(json){trackTiming.getUsersInfo.end().setLabel("success").send().clear(),json=_.map(json,function(value){return value.photo||(value.photo="style/images/033488d9.dummy_user.jpg"),value}),defer.resolve(json)}).error(function(json){trackTiming.getUsersInfo.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise},this.getSettingList=function(){var deferred=$q.defer();return trackTiming.getSettingList.start(),$http.get("/yws/api/self",{params:{method:"getsettings"}}).success(function(json){trackTiming.getSettingList.end().setLabel("success").send().clear(),deferred.resolve(json)}).error(function(json){trackTiming.getSettingList.end().setLabel("error").send().clear(),deferred.reject(json)}),deferred.promise},this.searchUser=function(kw,sb,fb){trackTiming.searchUser.start(),$http.get("/yws/api/self/other",{params:{method:"search",kw:kw}}).success(function(json){trackTiming.searchUser.end().setLabel("success").send().clear(),invoke(sb,[json])}).error(function(json){trackTiming.searchUser.end().setLabel("error").send().clear(),invoke(fb,[json])})},this.searchPrefix=function(prefix,timeout,orgId){var deferred=$q.defer();return trackTiming.searchPrefix.start(),$http.get("/yws/api/self/other",{params:{method:"searchPrefix",prefix:prefix,orgId:orgId},timeout:timeout.promise}).success(function(json){trackTiming.searchPrefix.end().setLabel("success").send().clear(),deferred.resolve(json)}).error(function(e){trackTiming.searchPrefix.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise},this.updateUserInfo=function(data,sb,fb){trackTiming.updateUserInfo.start(),$http.post("/yws/api/self",data,{params:{method:"change"}}).success(function(json){trackTiming.updateUserInfo.end().setLabel("success").send().clear(),invoke(sb,[json])}).error(function(json){trackTiming.updateUserInfo.end().setLabel("error").send().clear(),invoke(fb,[json])})},this.logout=function(){var defer=$q.defer();return trackTiming.logout.start(),$http.get("/auth/reset",{params:{app:"web"}}).success(function(res){trackTiming.logout.end().setLabel("success").send().clear(),defer.resolve(res)}).error(function(e){trackTiming.logout.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise},this.isYDocUser=function(userId){return trackTiming.isYDocUser.start(),$http.get("/yws/api/personal/user",{params:{method:"check",userId:userId}}).then(function(json){return trackTiming.isYDocUser.end().setLabel("success").send().clear(),json.data.result})}}});var io="undefined"==typeof module?{}:module.exports;!function(){if(function(exports,global){var io=exports;io.version="0.9.16",io.protocol=1,io.transports=[],io.j=[],io.sockets={},io.connect=function(host,details){var uuri,socket,uri=io.util.parseUri(host);global&&global.location&&(uri.protocol=uri.protocol||global.location.protocol.slice(0,-1),uri.host=uri.host||(global.document?global.document.domain:global.location.hostname),uri.port=uri.port||global.location.port),uuri=io.util.uniqueUri(uri);var options={host:uri.host,secure:"https"==uri.protocol,port:uri.port||("https"==uri.protocol?443:80),query:uri.query||""};return io.util.merge(options,details),(options["force new connection"]||!io.sockets[uuri])&&(socket=new io.Socket(options)),!options["force new connection"]&&socket&&(io.sockets[uuri]=socket),socket=socket||io.sockets[uuri],socket.of(uri.path.length>1?uri.path:"")}}("object"==typeof module?module.exports:this.io={},this),function(exports,global){var util=exports.util={},re=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];util.parseUri=function(str){for(var m=re.exec(str||""),uri={},i=14;i--;)uri[parts[i]]=m[i]||"";return uri},util.uniqueUri=function(uri){var protocol=uri.protocol,host=uri.host,port=uri.port;return"document"in global?(host=host||document.domain,port=port||("https"==protocol&&"https:"!==document.location.protocol?443:document.location.port)):(host=host||"localhost",port||"https"!=protocol||(port=443)),(protocol||"http")+"://"+host+":"+(port||80)},util.query=function(base,addition){var query=util.chunkQuery(base||""),components=[];util.merge(query,util.chunkQuery(addition||""));for(var part in query)query.hasOwnProperty(part)&&components.push(part+"="+query[part]);return components.length?"?"+components.join("&"):""},util.chunkQuery=function(qs){for(var kv,query={},params=qs.split("&"),i=0,l=params.length;l>i;++i)kv=params[i].split("="),kv[0]&&(query[kv[0]]=kv[1]);return query};var pageLoaded=!1;util.load=function(fn){return"document"in global&&"complete"===document.readyState||pageLoaded?fn():void util.on(global,"load",fn,!1)},util.on=function(element,event,fn,capture){element.attachEvent?element.attachEvent("on"+event,fn):element.addEventListener&&element.addEventListener(event,fn,capture)},util.request=function(xdomain){if(xdomain&&"undefined"!=typeof XDomainRequest&&!util.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!xdomain||util.ua.hasCORS))return new XMLHttpRequest;if(!xdomain)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}return null},"undefined"!=typeof window&&util.load(function(){pageLoaded=!0}),util.defer=function(fn){return util.ua.webkit&&"undefined"==typeof importScripts?void util.load(function(){setTimeout(fn,100)}):fn()},util.merge=function(target,additional,deep,lastseen){var prop,seen=lastseen||[],depth="undefined"==typeof deep?2:deep;for(prop in additional)additional.hasOwnProperty(prop)&&util.indexOf(seen,prop)<0&&("object"==typeof target[prop]&&depth?util.merge(target[prop],additional[prop],depth-1,seen):(target[prop]=additional[prop],seen.push(additional[prop])));return target},util.mixin=function(ctor,ctor2){util.merge(ctor.prototype,ctor2.prototype)},util.inherit=function(ctor,ctor2){function f(){}f.prototype=ctor2.prototype,ctor.prototype=new f},util.isArray=Array.isArray||function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},util.intersect=function(arr,arr2){for(var ret=[],longest=arr.length>arr2.length?arr:arr2,shortest=arr.length>arr2.length?arr2:arr,i=0,l=shortest.length;l>i;i++)~util.indexOf(longest,shortest[i])&&ret.push(shortest[i]);return ret},util.indexOf=function(arr,o,i){for(var j=arr.length,i=0>i?0>i+j?0:i+j:i||0;j>i&&arr[i]!==o;i++);return i>=j?-1:i},util.toArray=function(enu){for(var arr=[],i=0,l=enu.length;l>i;i++)arr.push(enu[i]);return arr},util.ua={},util.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var a=new XMLHttpRequest}catch(e){return!1}return void 0!=a.withCredentials}(),util.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),util.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(exports,io){function EventEmitter(){}exports.EventEmitter=EventEmitter,EventEmitter.prototype.on=function(name,fn){return this.$events||(this.$events={}),this.$events[name]?io.util.isArray(this.$events[name])?this.$events[name].push(fn):this.$events[name]=[this.$events[name],fn]:this.$events[name]=fn,this},EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.once=function(name,fn){function on(){self.removeListener(name,on),fn.apply(this,arguments)}var self=this;return on.listener=fn,this.on(name,on),this},EventEmitter.prototype.removeListener=function(name,fn){if(this.$events&&this.$events[name]){var list=this.$events[name];if(io.util.isArray(list)){for(var pos=-1,i=0,l=list.length;l>i;i++)if(list[i]===fn||list[i].listener&&list[i].listener===fn){pos=i;break}if(0>pos)return this;list.splice(pos,1),list.length||delete this.$events[name]}else(list===fn||list.listener&&list.listener===fn)&&delete this.$events[name]}return this},EventEmitter.prototype.removeAllListeners=function(name){return void 0===name?(this.$events={},this):(this.$events&&this.$events[name]&&(this.$events[name]=null),this)},EventEmitter.prototype.listeners=function(name){return this.$events||(this.$events={}),this.$events[name]||(this.$events[name]=[]),io.util.isArray(this.$events[name])||(this.$events[name]=[this.$events[name]]),this.$events[name]},EventEmitter.prototype.emit=function(name){if(!this.$events)return!1;var handler=this.$events[name];if(!handler)return!1;var args=Array.prototype.slice.call(arguments,1);if("function"==typeof handler)handler.apply(this,args);else{if(!io.util.isArray(handler))return!1;for(var listeners=handler.slice(),i=0,l=listeners.length;l>i;i++)listeners[i].apply(this,args)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){"use strict";function f(n){return 10>n?"0"+n:n}function date(d){return isFinite(d.valueOf())?d.getUTCFullYear()+"-"+f(d.getUTCMonth()+1)+"-"+f(d.getUTCDate())+"T"+f(d.getUTCHours())+":"+f(d.getUTCMinutes())+":"+f(d.getUTCSeconds())+"Z":null}function quote(string){return escapable.lastIndex=0,escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];switch(value instanceof Date&&(value=date(key)),"function"==typeof rep&&(value=rep.call(holder,key,value)),typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(gap+=indent,partial=[],"[object Array]"===Object.prototype.toString.apply(value)){for(length=value.length,i=0;length>i;i+=1)partial[i]=str(i,value)||"null";return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&"object"==typeof rep)for(length=rep.length,i=0;length>i;i+=1)"string"==typeof rep[i]&&(k=rep[i],v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));else for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(value,replacer,space){var i;if(gap="",indent="","number"==typeof space)for(i=0;space>i;i+=1)indent+=" ";else"string"==typeof space&&(indent=space);if(rep=replacer,replacer&&"function"!=typeof replacer&&("object"!=typeof replacer||"number"!=typeof replacer.length))throw new Error("JSON.stringify");return str("",{"":value})},JSON.parse=function(text,reviver){function walk(holder,key){var k,v,value=holder[key];
if(value&&"object"==typeof value)for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(exports,io){var parser=exports.parser={},packets=parser.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],reasons=parser.reasons=["transport not supported","client not handshaken","unauthorized"],advice=parser.advice=["reconnect"],JSON=io.JSON,indexOf=io.util.indexOf;parser.encodePacket=function(packet){var type=indexOf(packets,packet.type),id=packet.id||"",endpoint=packet.endpoint||"",ack=packet.ack,data=null;switch(packet.type){case"error":var reason=packet.reason?indexOf(reasons,packet.reason):"",adv=packet.advice?indexOf(advice,packet.advice):"";(""!==reason||""!==adv)&&(data=reason+(""!==adv?"+"+adv:""));break;case"message":""!==packet.data&&(data=packet.data);break;case"event":var ev={name:packet.name};packet.args&&packet.args.length&&(ev.args=packet.args),data=JSON.stringify(ev);break;case"json":data=JSON.stringify(packet.data);break;case"connect":packet.qs&&(data=packet.qs);break;case"ack":data=packet.ackId+(packet.args&&packet.args.length?"+"+JSON.stringify(packet.args):"")}var encoded=[type,id+("data"==ack?"+":""),endpoint];return null!==data&&void 0!==data&&encoded.push(data),encoded.join(":")},parser.encodePayload=function(packets){var decoded="";if(1==packets.length)return packets[0];for(var i=0,l=packets.length;l>i;i++){var packet=packets[i];decoded+="�"+packet.length+"�"+packets[i]}return decoded};var regexp=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;parser.decodePacket=function(data){var pieces=data.match(regexp);if(!pieces)return{};var id=pieces[2]||"",data=pieces[5]||"",packet={type:packets[pieces[1]],endpoint:pieces[4]||""};switch(id&&(packet.id=id,packet.ack=pieces[3]?"data":!0),packet.type){case"error":var pieces=data.split("+");packet.reason=reasons[pieces[0]]||"",packet.advice=advice[pieces[1]]||"";break;case"message":packet.data=data||"";break;case"event":try{var opts=JSON.parse(data);packet.name=opts.name,packet.args=opts.args}catch(e){}packet.args=packet.args||[];break;case"json":try{packet.data=JSON.parse(data)}catch(e){}break;case"connect":packet.qs=data||"";break;case"ack":var pieces=data.match(/^([0-9]+)(\+)?(.*)/);if(pieces&&(packet.ackId=pieces[1],packet.args=[],pieces[3]))try{packet.args=pieces[3]?JSON.parse(pieces[3]):[]}catch(e){}break;case"disconnect":case"heartbeat":}return packet},parser.decodePayload=function(data){if("�"==data.charAt(0)){for(var ret=[],i=1,length="";i<data.length;i++)"�"==data.charAt(i)?(ret.push(parser.decodePacket(data.substr(i+1).substr(0,length))),i+=Number(length)+1,length=""):length+=data.charAt(i);return ret}return[parser.decodePacket(data)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,io){function Transport(socket,sessid){this.socket=socket,this.sessid=sessid}exports.Transport=Transport,io.util.mixin(Transport,io.EventEmitter),Transport.prototype.heartbeats=function(){return!0},Transport.prototype.onData=function(data){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==data){var msgs=io.parser.decodePayload(data);if(msgs&&msgs.length)for(var i=0,l=msgs.length;l>i;i++)this.onPacket(msgs[i])}return this},Transport.prototype.onPacket=function(packet){return this.socket.setHeartbeatTimeout(),"heartbeat"==packet.type?this.onHeartbeat():("connect"==packet.type&&""==packet.endpoint&&this.onConnect(),"error"==packet.type&&"reconnect"==packet.advice&&(this.isOpen=!1),this.socket.onPacket(packet),this)},Transport.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var self=this;this.closeTimeout=setTimeout(function(){self.onDisconnect()},this.socket.closeTimeout)}},Transport.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},Transport.prototype.onConnect=function(){return this.socket.onConnect(),this},Transport.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},Transport.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},Transport.prototype.packet=function(packet){this.send(io.parser.encodePacket(packet))},Transport.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})},Transport.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},Transport.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},Transport.prototype.prepareUrl=function(){var options=this.socket.options;return this.scheme()+"://"+options.host+":"+options.port+"/"+options.resource+"/"+io.protocol+"/"+this.name+"/"+this.sessid},Transport.prototype.ready=function(socket,fn){fn.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,io,global){function Socket(options){if(this.options={port:80,secure:!1,document:"document"in global?document:!1,resource:"socket.io",transports:io.transports,"connect timeout":3e4,"try multiple transports":!1,reconnect:!0,"reconnection delay":5e3,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":1e4,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},io.util.merge(this.options,options),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||io.util.ua.hasCORS)){var self=this;io.util.on(global,"beforeunload",function(){self.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function empty(){}exports.Socket=Socket,io.util.mixin(Socket,io.EventEmitter),Socket.prototype.of=function(name){return this.namespaces[name]||(this.namespaces[name]=new io.SocketNamespace(this,name),""!==name&&this.namespaces[name].packet({type:"connect"})),this.namespaces[name]},Socket.prototype.publish=function(){this.emit.apply(this,arguments);var nsp;for(var i in this.namespaces)this.namespaces.hasOwnProperty(i)&&(nsp=this.of(i),nsp.$emit.apply(nsp,arguments))},Socket.prototype.handshake=function(fn){function complete(data){data instanceof Error?(self.connecting=!1,self.onError(data.message)):fn.apply(null,data.split(":"))}var self=this,options=this.options,url=["http"+(options.secure?"s":"")+":/",options.host+":"+options.port,options.resource,io.protocol,io.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!io.util.ua.hasCORS){var insertAt=document.getElementsByTagName("script")[0],script=document.createElement("script");script.src=url+"&jsonp="+io.j.length,insertAt.parentNode.insertBefore(script,insertAt),io.j.push(function(data){complete(data),script.parentNode.removeChild(script)})}else{var xhr=io.util.request();xhr.open("GET",url,!0),this.isXDomain()&&(xhr.withCredentials=!0),xhr.onreadystatechange=function(){4==xhr.readyState&&(xhr.onreadystatechange=empty,200==xhr.status?complete(xhr.responseText):403==xhr.status?self.onError(xhr.responseText):(self.connecting=!1,!self.reconnecting&&self.onError(xhr.responseText)))},xhr.send(null)}},Socket.prototype.getTransport=function(){return new io.Transport.websocket(this,this.sessionid)},Socket.prototype.connect=function(fn){if(this.connecting)return this;var self=this;return self.connecting=!0,this.handshake(function(sid,heartbeat,close,transports){function connect(transports){return self.transport&&self.transport.clearTimeouts(),self.transport=self.getTransport(transports),self.transport?void self.transport.ready(self,function(){self.connecting=!0,self.publish("connecting",self.transport.name),self.transport.open(),self.options["connect timeout"]&&(self.connectTimeoutTimer=setTimeout(function(){if(!self.connected&&(self.connecting=!1,self.options["try multiple transports"])){for(var remaining=self.transports;remaining.length>0&&remaining.splice(0,1)[0]!=self.transport.name;);remaining.length?connect(remaining):self.publish("connect_failed")}},self.options["connect timeout"]))}):self.publish("connect_failed")}self.sessionid=sid,self.closeTimeout=1e3*close,self.heartbeatTimeout=1e3*heartbeat,self.transports||(self.transports=self.origTransports=transports?io.util.intersect(transports.split(","),self.options.transports):self.options.transports),self.setHeartbeatTimeout(),connect(self.transports),self.once("connect",function(){clearTimeout(self.connectTimeoutTimer),fn&&"function"==typeof fn&&fn()})}),this},Socket.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var self=this;this.heartbeatTimeoutTimer=setTimeout(function(){self.transport.onClose()},this.heartbeatTimeout)}},Socket.prototype.packet=function(data){return this.connected&&!this.doBuffer?this.transport.packet(data):this.buffer.push(data),this},Socket.prototype.setBuffer=function(v){this.doBuffer=v,!v&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},Socket.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},Socket.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},Socket.prototype.disconnectSync=function(){var xhr=io.util.request(),uri=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,io.protocol,"",this.sessionid].join("/")+"/?disconnect=1";xhr.open("GET",uri,!1),xhr.send(null),this.onDisconnect("booted")},Socket.prototype.isXDomain=function(){var port=global.location.port||("https:"==global.location.protocol?443:80);return this.options.host!==global.location.hostname||this.options.port!=port},Socket.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},Socket.prototype.onOpen=function(){this.open=!0},Socket.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},Socket.prototype.onPacket=function(packet){this.of(packet.endpoint).onPacket(packet)},Socket.prototype.onError=function(err){err&&err.advice&&"reconnect"===err.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",err&&err.reason?err.reason:err)},Socket.prototype.onDisconnect=function(reason){var wasConnected=this.connected,wasConnecting=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(wasConnected||wasConnecting)&&(this.transport.close(),this.transport.clearTimeouts(),wasConnected&&(this.publish("disconnect",reason),this.options.reconnect&&!this.reconnecting&&this.reconnect()))},Socket.prototype.reconnect=function(){function reset(){if(self.connected){for(var i in self.namespaces)self.namespaces.hasOwnProperty(i)&&""!==i&&self.namespaces[i].packet({type:"connect"});self.publish("reconnect",self.transport.name,self.reconnectionAttempts)}clearTimeout(self.reconnectionTimer),self.removeListener("connect_failed",maybeReconnect),self.removeListener("connect",maybeReconnect),self.reconnecting=!1,delete self.reconnectionAttempts,delete self.reconnectionDelay,delete self.reconnectionTimer,delete self.redoTransports,self.options["try multiple transports"]=tryMultiple}function maybeReconnect(){return self.reconnecting?self.connected?reset():self.connecting&&self.reconnecting?self.reconnectionTimer=setTimeout(maybeReconnect,1e3):void(self.reconnectionAttempts++>=maxAttempts?(self.publish("reconnect_failed"),reset()):(self.reconnectionDelay<limit&&(self.reconnectionDelay<9e4?self.reconnectionDelay*=2:self.reconnectionDelay=12e4),self.connect(),self.publish("reconnecting",self.reconnectionDelay,self.reconnectionAttempts),self.reconnectionTimer=setTimeout(maybeReconnect,self.reconnectionDelay))):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var self=this,maxAttempts=this.options["max reconnection attempts"],tryMultiple=this.options["try multiple transports"],limit=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(maybeReconnect,this.reconnectionDelay),this.on("connect",maybeReconnect)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(exports,io){function SocketNamespace(socket,name){this.socket=socket,this.name=name||"",this.flags={},this.json=new Flag(this,"json"),this.ackPackets=0,this.acks={}}function Flag(nsp,name){this.namespace=nsp,this.name=name}exports.SocketNamespace=SocketNamespace,io.util.mixin(SocketNamespace,io.EventEmitter),SocketNamespace.prototype.$emit=io.EventEmitter.prototype.emit,SocketNamespace.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},SocketNamespace.prototype.packet=function(packet){return packet.endpoint=this.name,this.socket.packet(packet),this.flags={},this},SocketNamespace.prototype.send=function(data,fn){var packet={type:this.flags.json?"json":"message",data:data};return"function"==typeof fn&&(packet.id=++this.ackPackets,packet.ack=!0,this.acks[packet.id]=fn),this.packet(packet)},SocketNamespace.prototype.emit=function(name){var args=Array.prototype.slice.call(arguments,1),lastArg=args[args.length-1],packet={type:"event",name:name};return"function"==typeof lastArg&&(packet.id=++this.ackPackets,packet.ack="data",this.acks[packet.id]=lastArg,args=args.slice(0,args.length-1)),packet.args=args,this.packet(packet)},SocketNamespace.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},SocketNamespace.prototype.onPacket=function(packet){function ack(){self.packet({type:"ack",args:io.util.toArray(arguments),ackId:packet.id})}var self=this;switch(packet.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(packet.reason||"booted"):this.$emit("disconnect",packet.reason);break;case"message":case"json":var params=["message",packet.data];"data"==packet.ack?params.push(ack):packet.ack&&this.packet({type:"ack",ackId:packet.id}),this.$emit.apply(this,params);break;case"event":var params=[packet.name].concat(packet.args);"data"==packet.ack&&params.push(ack),this.$emit.apply(this,params);break;case"ack":this.acks[packet.ackId]&&(this.acks[packet.ackId].apply(this,packet.args),delete this.acks[packet.ackId]);break;case"error":packet.advice?this.socket.onError(packet):"unauthorized"==packet.reason?this.$emit("connect_failed",packet.reason):this.$emit("error",packet.reason)}},Flag.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},Flag.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,io,global){function WS(){io.Transport.apply(this,arguments)}exports.websocket=WS,io.util.inherit(WS,io.Transport),WS.prototype.name="websocket",WS.prototype.open=function(){var Socket,query=io.util.query(this.socket.options.query),self=this;return Socket||(Socket=global.MozWebSocket||global.WebSocket),this.websocket=new Socket(this.prepareUrl()+query),this.websocket.onopen=function(){self.onOpen(),self.socket.setBuffer(!1)},this.websocket.onmessage=function(ev){self.onData(ev.data)},this.websocket.onclose=function(){self.onClose(),self.socket.setBuffer(!0)},this.websocket.onerror=function(e){self.onError(e)},this},WS.prototype.send=io.util.ua.iDevice?function(data){var self=this;return setTimeout(function(){self.websocket.send(data)},0),this}:function(data){return this.websocket.send(data),this},WS.prototype.payload=function(arr){for(var i=0,l=arr.length;l>i;i++)this.packet(arr[i]);return this},WS.prototype.close=function(){return this.websocket.close(),this},WS.prototype.onError=function(e){this.socket.onError(e)},WS.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},WS.check=function(){return"WebSocket"in global&&!("__addTask"in WebSocket)||"MozWebSocket"in global},WS.xdomainCheck=function(){return!0},io.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(exports,io){function Flashsocket(){io.Transport.websocket.apply(this,arguments)}exports.flashsocket=Flashsocket,io.util.inherit(Flashsocket,io.Transport.websocket),Flashsocket.prototype.name="flashsocket",Flashsocket.prototype.open=function(){var self=this,args=arguments;return WebSocket.__addTask(function(){io.Transport.websocket.prototype.open.apply(self,args)}),this},Flashsocket.prototype.send=function(){var self=this,args=arguments;return WebSocket.__addTask(function(){io.Transport.websocket.prototype.send.apply(self,args)}),this},Flashsocket.prototype.close=function(){return WebSocket.__tasks.length=0,io.Transport.websocket.prototype.close.call(this),this},Flashsocket.prototype.ready=function(socket,fn){function init(){var options=socket.options,port=options["flash policy port"],path=["http"+(options.secure?"s":"")+":/",options.host+":"+options.port,options.resource,"static/flashsocket","WebSocketMain"+(socket.isXDomain()?"Insecure":"")+".swf"];Flashsocket.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=path.join("/")),843!==port&&WebSocket.loadFlashPolicyFile("xmlsocket://"+options.host+":"+port),WebSocket.__initialize(),Flashsocket.loaded=!0),fn.call(self)}var self=this;return document.body?init():void io.util.load(init)},Flashsocket.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},Flashsocket.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),io.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function f(){if(!J){try{var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));Z.parentNode.removeChild(Z)}catch(aa){return}J=!0;for(var X=U.length,Y=0;X>Y;Y++)U[Y]()}}function K(X){J?X():U[U.length]=X}function s(Y){if(typeof O.addEventListener!=D)O.addEventListener("load",Y,!1);else if(typeof j.addEventListener!=D)j.addEventListener("load",Y,!1);else if(typeof O.attachEvent!=D)i(O,"onload",Y);else if("function"==typeof O.onload){var X=O.onload;O.onload=function(){X(),Y()}}else O.onload=Y}function h(){T?V():H()}function V(){var X=j.getElementsByTagName("body")[0],aa=C(r);aa.setAttribute("type",q);var Z=X.appendChild(aa);if(Z){var Y=0;!function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");ab&&(ab=ab.split(" ")[1].split(","),M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)])}else if(10>Y)return Y++,void setTimeout(arguments.callee,10);X.removeChild(aa),Z=null,H()}()}else H()}function H(){var ag=o.length;if(ag>0)for(var af=0;ag>af;af++){var Y=o[af].id,ab=o[af].callbackFn,aa={success:!1,id:Y};if(M.pv[0]>0){var ae=c(Y);if(ae)if(!F(o[af].swfVersion)||M.wk&&M.wk<312)if(o[af].expressInstall&&A()){var ai={};ai.data=o[af].expressInstall,ai.width=ae.getAttribute("width")||"0",ai.height=ae.getAttribute("height")||"0",ae.getAttribute("class")&&(ai.styleclass=ae.getAttribute("class")),ae.getAttribute("align")&&(ai.align=ae.getAttribute("align"));for(var ah={},X=ae.getElementsByTagName("param"),ac=X.length,ad=0;ac>ad;ad++)"movie"!=X[ad].getAttribute("name").toLowerCase()&&(ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value"));P(ai,ah,Y,ab)}else p(ae),ab&&ab(aa);else w(Y,!0),ab&&(aa.success=!0,aa.ref=z(Y),ab(aa))}else if(w(Y,!0),ab){var Z=z(Y);Z&&typeof Z.SetVariable!=D&&(aa.success=!0,aa.ref=Z),ab(aa)}}}function z(aa){var X=null,Y=c(aa);if(Y&&"OBJECT"==Y.nodeName)if(typeof Y.SetVariable!=D)X=Y;else{var Z=Y.getElementsByTagName(r)[0];Z&&(X=Z)}return X}function A(){return!a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312)}function P(aa,ab,X,Z){a=!0,E=Z||null,B={success:!1,id:X};var ae=c(X);if(ae){"OBJECT"==ae.nodeName?(l=g(ae),Q=null):(l=ae,Q=X),aa.id=R,(typeof aa.width==D||!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)&&(aa.width="310"),(typeof aa.height==D||!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)&&(aa.height="137"),j.title=j.title.slice(0,47)+" - Flash Player Installation";var ad=M.ie&&M.win?["Active"].concat("").join("X"):"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;if(typeof ab.flashvars!=D?ab.flashvars+="&"+ac:ab.flashvars=ac,M.ie&&M.win&&4!=ae.readyState){var Y=C("div");X+="SWFObjectNew",Y.setAttribute("id",X),ae.parentNode.insertBefore(Y,ae),ae.style.display="none",function(){4==ae.readyState?ae.parentNode.removeChild(ae):setTimeout(arguments.callee,10)}()}u(aa,ab,X)}}function p(Y){if(M.ie&&M.win&&4!=Y.readyState){var X=C("div");Y.parentNode.insertBefore(X,Y),X.parentNode.replaceChild(g(Y),X),Y.style.display="none",function(){4==Y.readyState?Y.parentNode.removeChild(Y):setTimeout(arguments.callee,10)}()}else Y.parentNode.replaceChild(g(Y),Y)}function g(ab){var aa=C("div");if(M.win&&M.ie)aa.innerHTML=ab.innerHTML;else{var Y=ab.getElementsByTagName(r)[0];if(Y){var ad=Y.childNodes;if(ad)for(var X=ad.length,Z=0;X>Z;Z++)1==ad[Z].nodeType&&"PARAM"==ad[Z].nodeName||8==ad[Z].nodeType||aa.appendChild(ad[Z].cloneNode(!0))}}return aa}function u(ai,ag,Y){var X,aa=c(Y);if(M.wk&&M.wk<312)return X;if(aa)if(typeof ai.id==D&&(ai.id=Y),M.ie&&M.win){var ah="";for(var ae in ai)ai[ae]!=Object.prototype[ae]&&("data"==ae.toLowerCase()?ag.movie=ai[ae]:"styleclass"==ae.toLowerCase()?ah+=' class="'+ai[ae]+'"':"classid"!=ae.toLowerCase()&&(ah+=" "+ae+'="'+ai[ae]+'"'));var af="";for(var ad in ag)ag[ad]!=Object.prototype[ad]&&(af+='<param name="'+ad+'" value="'+ag[ad]+'" />');aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>",N[N.length]=ai.id,X=c(ai.id)}else{var Z=C(r);Z.setAttribute("type",q);for(var ac in ai)ai[ac]!=Object.prototype[ac]&&("styleclass"==ac.toLowerCase()?Z.setAttribute("class",ai[ac]):"classid"!=ac.toLowerCase()&&Z.setAttribute(ac,ai[ac]));for(var ab in ag)ag[ab]!=Object.prototype[ab]&&"movie"!=ab.toLowerCase()&&e(Z,ab,ag[ab]);aa.parentNode.replaceChild(Z,aa),X=Z}return X}function e(Z,X,Y){var aa=C("param");aa.setAttribute("name",X),aa.setAttribute("value",Y),Z.appendChild(aa)}function y(Y){var X=c(Y);X&&"OBJECT"==X.nodeName&&(M.ie&&M.win?(X.style.display="none",function(){4==X.readyState?b(Y):setTimeout(arguments.callee,10)}()):X.parentNode.removeChild(X))}function b(Z){var Y=c(Z);if(Y){for(var X in Y)"function"==typeof Y[X]&&(Y[X]=null);Y.parentNode.removeChild(Y)}}function c(Z){var X=null;try{X=j.getElementById(Z)}catch(Y){}return X}function C(X){return j.createElement(X)}function i(Z,X,Y){Z.attachEvent(X,Y),I[I.length]=[Z,X,Y]}function F(Z){var Y=M.pv,X=Z.split(".");return X[0]=parseInt(X[0],10),X[1]=parseInt(X[1],10)||0,X[2]=parseInt(X[2],10)||0,Y[0]>X[0]||Y[0]==X[0]&&Y[1]>X[1]||Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]?!0:!1}function v(ac,Y,ad,ab){if(!M.ie||!M.mac){var aa=j.getElementsByTagName("head")[0];if(aa){var X=ad&&"string"==typeof ad?ad:"screen";if(ab&&(n=null,G=null),!n||G!=X){var Z=C("style");Z.setAttribute("type","text/css"),Z.setAttribute("media",X),n=aa.appendChild(Z),M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0&&(n=j.styleSheets[j.styleSheets.length-1]),G=X}M.ie&&M.win?n&&typeof n.addRule==r&&n.addRule(ac,Y):n&&typeof j.createTextNode!=D&&n.appendChild(j.createTextNode(ac+" {"+Y+"}"))}}}function w(Z,X){if(m){var Y=X?"visible":"hidden";J&&c(Z)?c(Z).style.visibility=Y:v("#"+Z,"visibility:"+Y)}}function L(Y){var Z=/[\\\"<>\.;]/,X=null!=Z.exec(Y);return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y}{var l,Q,E,B,n,G,D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=!1,U=[h],o=[],N=[],I=[],J=!1,a=!1,m=!0,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=/win/.test(Y?Y:ah),ac=/mac/.test(Y?Y:ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,X=!1,ag=[0,0,0],ab=null;if(typeof t.plugins!=D&&typeof t.plugins[S]==r)ab=t.plugins[S].description,!ab||typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin||(T=!0,X=!1,ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10),ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10),ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof O[["Active"].concat("Object").join("X")]!=D)try{var ad=new(window[["Active"].concat("Object").join("X")])(W);ad&&(ab=ad.GetVariable("$version"),ab&&(X=!0,ab=ab.split(" ")[1].split(","),ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]))}catch(Z){}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac}}();!function(){M.w3&&((typeof j.readyState!=D&&"complete"==j.readyState||typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))&&f(),J||(typeof j.addEventListener!=D&&j.addEventListener("DOMContentLoaded",f,!1),M.ie&&M.win&&(j.attachEvent(x,function(){"complete"==j.readyState&&(j.detachEvent(x,arguments.callee),f())}),O==top&&!function(){if(!J){try{j.documentElement.doScroll("left")}catch(X){return void setTimeout(arguments.callee,0)}f()}}()),M.wk&&!function(){return J?void 0:/loaded|complete/.test(j.readyState)?void f():void setTimeout(arguments.callee,0)}(),s(f)))}(),function(){M.ie&&M.win&&window.attachEvent("onunload",function(){for(var ac=I.length,ab=0;ac>ab;ab++)I[ab][0].detachEvent(I[ab][1],I[ab][2]);for(var Z=N.length,aa=0;Z>aa;aa++)y(N[aa]);for(var Y in M)M[Y]=null;M=null;for(var X in swfobject)swfobject[X]=null;swfobject=null})}()}return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab,Y.swfVersion=X,Y.expressInstall=aa,Y.callbackFn=Z,o[o.length]=Y,w(ab,!1)}else Z&&Z({success:!1,id:ab})},getObjectById:function(X){return M.w3?z(X):void 0},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:!1,id:ah};M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y?(w(ah,!1),K(function(){ae+="",ag+="";var aj={};if(af&&typeof af===r)for(var al in af)aj[al]=af[al];aj.data=ab,aj.width=ae,aj.height=ag;var am={};if(ad&&typeof ad===r)for(var ak in ad)am[ak]=ad[ak];if(Z&&typeof Z===r)for(var ai in Z)typeof am.flashvars!=D?am.flashvars+="&"+ai+"="+Z[ai]:am.flashvars=ai+"="+Z[ai];if(F(Y)){var an=u(aj,am,ah);aj.id==ah&&w(ah,!0),X.success=!0,X.ref=an}else{if(aa&&A())return aj.data=aa,void P(aj,am,ah,ac);w(ah,!0)}ac&&ac(X)})):ac&&ac(X)},switchOffAutoHideShow:function(){m=!1},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]}},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){return M.w3?u(Z,Y,X):void 0},showExpressInstall:function(Z,aa,X,Y){M.w3&&A()&&P(Z,aa,X,Y)},removeSWF:function(X){M.w3&&y(X)},createCSS:function(aa,Z,Y,X){M.w3&&v(aa,Z,Y,X)},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash;if(Z){if(/\?/.test(Z)&&(Z=Z.split("?")[1]),null==aa)return L(Z);for(var Y=Z.split("&"),X=0;X<Y.length;X++)if(Y[X].substring(0,Y[X].indexOf("="))==aa)return L(Y[X].substring(Y[X].indexOf("=")+1))}return""},expressInstallCallback:function(){if(a){var X=c(R);X&&l&&(X.parentNode.replaceChild(l,X),Q&&(w(Q,!0),M.ie&&M.win&&(l.style.display="block")),E&&E(B)),a=!1}}}}();!function(){if("undefined"!=typeof window&&!window.WebSocket){var console=window.console;if(console&&console.log&&console.error||(console={log:function(){},error:function(){}}),!swfobject.hasFlashPlayerVersion("10.0.0"))return void console.error("Flash Player >= 10.0.0 is required.");"file:"==location.protocol&&console.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(url,protocols,proxyHost,proxyPort,headers){var self=this;self.__id=WebSocket.__nextId++,WebSocket.__instances[self.__id]=self,self.readyState=WebSocket.CONNECTING,self.bufferedAmount=0,self.__events={},protocols?"string"==typeof protocols&&(protocols=[protocols]):protocols=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(self.__id,url,protocols,proxyHost||null,proxyPort||0,headers||null)})},0)},WebSocket.prototype.send=function(data){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var result=WebSocket.__flash.send(this.__id,encodeURIComponent(data));return 0>result?!0:(this.bufferedAmount+=result,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(type,listener){type in this.__events||(this.__events[type]=[]),this.__events[type].push(listener)},WebSocket.prototype.removeEventListener=function(type,listener){if(type in this.__events)for(var events=this.__events[type],i=events.length-1;i>=0;--i)if(events[i]===listener){events.splice(i,1);break}},WebSocket.prototype.dispatchEvent=function(event){for(var events=this.__events[event.type]||[],i=0;i<events.length;++i)events[i](event);var handler=this["on"+event.type];handler&&handler(event)},WebSocket.prototype.__handleEvent=function(flashEvent){"readyState"in flashEvent&&(this.readyState=flashEvent.readyState),"protocol"in flashEvent&&(this.protocol=flashEvent.protocol);var jsEvent;if("open"==flashEvent.type||"error"==flashEvent.type)jsEvent=this.__createSimpleEvent(flashEvent.type);else if("close"==flashEvent.type)jsEvent=this.__createSimpleEvent("close");else{if("message"!=flashEvent.type)throw"unknown event type: "+flashEvent.type;var data=decodeURIComponent(flashEvent.message);jsEvent=this.__createMessageEvent("message",data)}this.dispatchEvent(jsEvent)},WebSocket.prototype.__createSimpleEvent=function(type){if(document.createEvent&&window.Event){var event=document.createEvent("Event");return event.initEvent(type,!1,!1),event}return{type:type,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(type,data){if(document.createEvent&&window.MessageEvent&&!window.opera){var event=document.createEvent("MessageEvent");return event.initMessageEvent("message",!1,!1,data,null,null,window,null),event}return{type:type,data:data,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(url){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(url)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return void console.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");
var container=document.createElement("div");container.id="webSocketContainer",container.style.position="absolute",WebSocket.__isFlashLite()?(container.style.left="0px",container.style.top="0px"):(container.style.left="-100px",container.style.top="-100px");var holder=document.createElement("div");holder.id="webSocketFlash",container.appendChild(holder),document.body.appendChild(container),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(e){e.success||console.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var i=0;i<WebSocket.__tasks.length;++i)WebSocket.__tasks[i]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var events=WebSocket.__flash.receiveEvents(),i=0;i<events.length;++i)WebSocket.__instances[events[i].webSocketId].__handleEvent(events[i])}catch(e){console.error(e)}},0),!0},WebSocket.__log=function(message){console.log(decodeURIComponent(message))},WebSocket.__error=function(message){console.error(decodeURIComponent(message))},WebSocket.__addTask=function(task){WebSocket.__flash?task():WebSocket.__tasks.push(task)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var mimeType=window.navigator.mimeTypes["application/x-shockwave-flash"];return mimeType&&mimeType.enabledPlugin&&mimeType.enabledPlugin.filename&&mimeType.enabledPlugin.filename.match(/flashlite/i)?!0:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))}}(),function(exports,io,global){function XHR(socket){socket&&(io.Transport.apply(this,arguments),this.sendBuffer=[])}function empty(){}exports.XHR=XHR,io.util.inherit(XHR,io.Transport),XHR.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},XHR.prototype.payload=function(payload){for(var msgs=[],i=0,l=payload.length;l>i;i++)msgs.push(io.parser.encodePacket(payload[i]));this.send(io.parser.encodePayload(msgs))},XHR.prototype.send=function(data){return this.post(data),this},XHR.prototype.post=function(data){function stateChange(){4==this.readyState&&(this.onreadystatechange=empty,self.posting=!1,200==this.status?self.socket.setBuffer(!1):self.onClose())}function onload(){this.onload=empty,self.socket.setBuffer(!1)}var self=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),global.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=onload:this.sendXHR.onreadystatechange=stateChange,this.sendXHR.send(data)},XHR.prototype.close=function(){return this.onClose(),this},XHR.prototype.request=function(method){var req=io.util.request(this.socket.isXDomain()),query=io.util.query(this.socket.options.query,"t="+ +new Date);if(req.open(method||"GET",this.prepareUrl()+query,!0),"POST"==method)try{req.setRequestHeader?req.setRequestHeader("Content-type","text/plain;charset=UTF-8"):req.contentType="text/plain"}catch(e){}return req},XHR.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},XHR.check=function(socket,xdomain){try{var request=io.util.request(xdomain),usesXDomReq=global.XDomainRequest&&request instanceof XDomainRequest,socketProtocol=socket&&socket.options&&socket.options.secure?"https:":"http:",isXProtocol=global.location&&socketProtocol!=global.location.protocol;if(request&&(!usesXDomReq||!isXProtocol))return!0}catch(e){}return!1},XHR.xdomainCheck=function(socket){return XHR.check(socket,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(exports,io){function HTMLFile(){io.Transport.XHR.apply(this,arguments)}exports.htmlfile=HTMLFile,io.util.inherit(HTMLFile,io.Transport.XHR),HTMLFile.prototype.name="htmlfile",HTMLFile.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var iframeC=this.doc.createElement("div");iframeC.className="socketio",this.doc.body.appendChild(iframeC),this.iframe=this.doc.createElement("iframe"),iframeC.appendChild(this.iframe);var self=this,query=io.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+query,io.util.on(window,"unload",function(){self.destroy()})},HTMLFile.prototype._=function(data,doc){data=data.replace(/\\\//g,"/"),this.onData(data);try{var script=doc.getElementsByTagName("script")[0];script.parentNode.removeChild(script)}catch(e){}},HTMLFile.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},HTMLFile.prototype.close=function(){return this.destroy(),io.Transport.XHR.prototype.close.call(this)},HTMLFile.check=function(socket){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var a=new(window[["Active"].concat("Object").join("X")])("htmlfile");return a&&io.Transport.XHR.check(socket)}catch(e){}return!1},HTMLFile.xdomainCheck=function(){return!1},io.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,io,global){function XHRPolling(){io.Transport.XHR.apply(this,arguments)}function empty(){}exports["xhr-polling"]=XHRPolling,io.util.inherit(XHRPolling,io.Transport.XHR),io.util.merge(XHRPolling,io.Transport.XHR),XHRPolling.prototype.name="xhr-polling",XHRPolling.prototype.heartbeats=function(){return!1},XHRPolling.prototype.open=function(){var self=this;return io.Transport.XHR.prototype.open.call(self),!1},XHRPolling.prototype.get=function(){function stateChange(){4==this.readyState&&(this.onreadystatechange=empty,200==this.status?(self.onData(this.responseText),self.get()):self.onClose())}function onload(){this.onload=empty,this.onerror=empty,self.retryCounter=1,self.onData(this.responseText),self.get()}function onerror(){self.retryCounter++,!self.retryCounter||self.retryCounter>3?self.onClose():self.get()}if(this.isOpen){var self=this;this.xhr=this.request(),global.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=onload,this.xhr.onerror=onerror):this.xhr.onreadystatechange=stateChange,this.xhr.send(null)}},XHRPolling.prototype.onClose=function(){if(io.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=empty;try{this.xhr.abort()}catch(e){}this.xhr=null}},XHRPolling.prototype.ready=function(socket,fn){var self=this;io.util.defer(function(){fn.call(self)})},io.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(exports,io,global){function JSONPPolling(){io.Transport["xhr-polling"].apply(this,arguments),this.index=io.j.length;var self=this;io.j.push(function(msg){self._(msg)})}var indicator=global.document&&"MozAppearance"in global.document.documentElement.style;exports["jsonp-polling"]=JSONPPolling,io.util.inherit(JSONPPolling,io.Transport["xhr-polling"]),JSONPPolling.prototype.name="jsonp-polling",JSONPPolling.prototype.post=function(data){function complete(){initIframe(),self.socket.setBuffer(!1)}function initIframe(){self.iframe&&self.form.removeChild(self.iframe);try{iframe=document.createElement('<iframe name="'+self.iframeId+'">')}catch(e){iframe=document.createElement("iframe"),iframe.name=self.iframeId}iframe.id=self.iframeId,self.form.appendChild(iframe),self.iframe=iframe}var self=this,query=io.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var iframe,form=document.createElement("form"),area=document.createElement("textarea"),id=this.iframeId="socketio_iframe_"+this.index;form.className="socketio",form.style.position="absolute",form.style.top="0px",form.style.left="0px",form.style.display="none",form.target=id,form.method="POST",form.setAttribute("accept-charset","utf-8"),area.name="d",form.appendChild(area),document.body.appendChild(form),this.form=form,this.area=area}this.form.action=this.prepareUrl()+query,initIframe(),this.area.value=io.JSON.stringify(data);try{this.form.submit()}catch(e){}this.iframe.attachEvent?iframe.onreadystatechange=function(){"complete"==self.iframe.readyState&&complete()}:this.iframe.onload=complete,this.socket.setBuffer(!0)},JSONPPolling.prototype.get=function(){var self=this,script=document.createElement("script"),query=io.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),script.async=!0,script.src=this.prepareUrl()+query,script.onerror=function(){self.onClose()};var insertAt=document.getElementsByTagName("script")[0];insertAt.parentNode.insertBefore(script,insertAt),this.script=script,indicator&&setTimeout(function(){var iframe=document.createElement("iframe");document.body.appendChild(iframe),document.body.removeChild(iframe)},100)},JSONPPolling.prototype._=function(msg){return this.onData(msg),this.isOpen&&this.get(),this},JSONPPolling.prototype.ready=function(socket,fn){var self=this;return indicator?void io.util.load(function(){fn.call(self)}):fn.call(this)},JSONPPolling.check=function(){return"document"in global},JSONPPolling.xdomainCheck=function(){return!0},io.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),"function"==typeof define&&define.amd&&define("socketio",[],function(){return io})}(),function(){function EventEmitter(){}var isArray=Array.isArray;void 0===isArray&&(isArray=function(arr){return"[object Array]"===Object.prototype.toString.call(arr)});var root=this;"undefined"!=typeof module&&module.exports?module.exports.EventEmitter=EventEmitter:(root=window,root.EventEmitter=EventEmitter);var defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){this._events||(this._events={}),this._maxListeners=n},EventEmitter.prototype.emit=function(){var type=arguments[0];if("error"===type&&(!this._events||!this._events.error||isArray(this._events.error)&&!this._events.error.length)){if(this.domain){var er=arguments[1];return er.domain_emitter=this,er.domain=this.domain,er.domain_thrown=!1,this.domain.emit("error",er),!1}throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.")}if(!this._events)return!1;var handler=this._events[type];if(!handler)return!1;if("function"==typeof handler){switch(this.domain&&this.domain.enter(),arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:for(var l=arguments.length,args=new Array(l-1),i=1;l>i;i++)args[i-1]=arguments[i];handler.apply(this,args)}return this.domain&&this.domain.exit(),!0}if(isArray(handler)){this.domain&&this.domain.enter();for(var l=arguments.length,args=new Array(l-1),i=1;l>i;i++)args[i-1]=arguments[i];for(var listeners=handler.slice(),i=0,l=listeners.length;l>i;i++)listeners[i].apply(this,args);return this.domain&&this.domain.exit(),!0}return!1},EventEmitter.prototype.addListener=function(type,listener){if("function"!=typeof listener)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",type,"function"==typeof listener.listener?listener.listener:listener),this._events[type]?isArray(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isArray(this._events[type])&&!this._events[type].warned){var m;m=void 0!==this._maxListeners?this._maxListeners:defaultMaxListeners,m&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){self.removeListener(type,g),listener.apply(this,arguments)}if("function"!=typeof listener)throw new Error(".once only takes instances of Function");var self=this;return g.listener=listener,self.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){if("function"!=typeof listener)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[type])return this;var list=this._events[type];if(isArray(list)){for(var position=-1,i=0,length=list.length;length>i;i++)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(0>position)return this;list.splice(position,1)}else(list===listener||list.listener&&list.listener===listener)&&delete this._events[type];return this},EventEmitter.prototype.removeAllListeners=function(type){if(0===arguments.length)return this._events={},this;var events=this._events&&this._events[type];return events?(isArray(events)?events.splice(0):this._events[type]=null,this):this},EventEmitter.prototype.listeners=function(type){return this._events||(this._events={}),this._events[type]||(this._events[type]=[]),isArray(this._events[type])||(this._events[type]=[this._events[type]]),this._events[type]}}(),function(){"function"!=typeof Object.create&&(Object.create=function(o){function F(){}return F.prototype=o,new F});var root=window,pomelo=Object.create(EventEmitter.prototype);root.pomelo=pomelo;var heartbeat_timer,current_user,current_domain,socket=null,id=1,callbacks={},route="web-connector.messageHandler.",isRegister=!1,success=200,register_ack="register",bind_ack="bind",regBind_ack="registerAndBind",cancelBind_ack="cancelBind",specify="specify",reconnectMessage="reconnectMessage",message_store={},heartbeat_interval=6e4,cacheMessageIds=[],cacheSize=100;pomelo.init=function(host,port,reconnect,cb){var url="ws://"+host;port&&(url+=":"+port);var params;params=reconnect?{"force new connection":!0,reconnect:!0}:{"force new connection":!0,reconnect:!1},socket=io.connect(url,params),socket.on("connect",function(){console.log("[pomeloclient.init] websocket connected!"),cb()}),socket.on("reconnect",function(){pomelo.emit("reconnect")}),socket.on("message",function(data){console.log("receive message from server: ",data),message_store={},"string"==typeof data&&(data=JSON.parse(data)),data instanceof Array?processMessageBatch(data):(processMessage(data),emitMessage())}),socket.on("error",function(err){cb(err)}),socket.on("disconnect",function(reason){isRegister=!1,pomelo.emit("disconnect",reason)})};var request=function(method,opts,cb){return method?(id++,callbacks[id]=cb,void sendMsg(method,id,opts)):void console.error("request message error with no method.")},notify=function(method,msg){return method?void sendMsg(method,0,msg):void console.error("notify message error with no method.")},sendMsg=function(method,msgId,msg){var path=route+method,rs={id:msgId,route:path,msg:msg},sg=JSON.stringify(rs);console.log("client send message to server: ",sg),socket.send(sg)},processMessageBatch=function(msgs){for(var i=0,l=msgs.length;l>i;i++)processMessage(msgs[i]);emitMessage()},emitMessage=function(){for(var key in message_store)pomelo.emit(key,message_store[key])},processMessage=function(msg){if(msg.id){var cb=callbacks[msg.id];return delete callbacks[msg.id],"function"!=typeof cb?void console.log("[pomeloclient.processMessage] cb is not a function for request "+msg.id):(cb(msg.body),msg.body.type===register_ack&&msg.body.code==success&&(isRegister=!0),msg.body.type!==bind_ack&&msg.body.type!==regBind_ack||msg.body.code!=success||(heartbeat_timer=setInterval(function(){notify("heartbeat",{flag:"online",domain:current_domain,user:current_user})},heartbeat_interval)),void(msg.body.type===cancelBind_ack&&msg.body.code==success&&clearInterval(heartbeat_timer)))}if(filterMessage(msg))if(message_store[msg.route]){var arr=message_store[msg.route];if(msg.body instanceof Array)for(var messages=msg.body,i=0;i<messages.length;i++)arr.push(messages[i]);else arr.push(msg.body);message_store[msg.route]=arr}else msg.body instanceof Array?(msg.route===specify&&(msg.route=reconnectMessage),message_store[msg.route]=msg.body):message_store[msg.route]=[msg.body]},filterMessage=function(message){var msgs=message.body,ids=[];if(msgs instanceof Array){for(var i=0;i<msgs.length;i++){var id=msgs[i].msgId;ids.push(id)}var duplicatedIds=checkMessage(ids);if(0!==duplicatedIds.length)return!1;if(cacheMessageIds=cacheMessageIds.concat(ids),cacheMessageIds.length>cacheSize)for(var length=cacheMessageIds-cacheSize,i=0;length>i;i++)cacheMessageIds.shift()}return!0},checkMessage=function(ids){for(var array=[],i=0;i<cacheMessageIds.length;i++)for(var id=cacheMessageIds[i],j=0;j<ids.length;j++)ids[j]===id&&array.push(id);return array};pomelo.register=function(opts,cb){request("register",opts,cb)},pomelo.bind=function(opts,cb){isRegister?(current_domain=opts.domain,current_user=opts.user,request("bind",opts,cb)):console.log("cannot bind without registration.")},pomelo.registerAndBind=function(opts,cb){current_domain=opts.domain,current_user=opts.user,request("registerAndBind",opts,cb)},pomelo.cancelBind=function(opts,cb){current_domain=null,current_user=null,request("cancelBind",opts,cb)},pomelo.getOnlineUser=function(opts,cb){request("getOnlineUser",opts,cb)},pomelo.disconnect=function(){socket&&(socket.disconnect(),socket=null)},pomelo.ackMessage=function(domain,msgs){for(var user,msgIds="",types="",message={},i=0;i<msgs.length;i++){var data=msgs[i];user||(user=data.user),msgIds+=data.msgId,types+=data.type,i!==msgs.length-1&&(msgIds+=";",types+=";")}var message={user:user,msgIds:msgIds,types:types,domain:domain};notify("ack",message)}}(),define("pomelo",["socketio"],function(global){return function(){var ret;return ret||global.pomelo}}(this)),define("common/service/pomeloService",["underscore","util/tracker","util/trackTiming","pomelo"],function(_,tracker,trackTiming){"use strict";var host,port,domain,productKey,lastUserId,SUCCESS=200,initCount=0,initBackoffTime=1,bindTryCount=20;return function($http,$rootScope,chatService,clientProxy,PUSH_CATEGORY,EVENT_TYPE){function getBindInfo(cb){trackTiming.getBindInfo.start(),$http.get("/yws/api/push?X_USER_ID="+lastUserId+"&method=auth").success(function(bindInfo){trackTiming.getBindInfo.end().setLabel("success").send().clear(),cb(bindInfo)}).error(function(json){trackTiming.getBindInfo.end().setLabel("error").send().clear(),$rootScope.$broadcast("socket.getBindInfo.error"),console.error("getBindInfo error:"+json)})}function init(){window.pomelo.init(host,port,!0,function(err){if(err)tracker.addPushLog(lastUserId,clientProxy.platform,"init:error","initCount:"+initCount+";"+err),console.error("pomelo init error:"+err),initCount++,$rootScope.$broadcast("socket.init.error");else{console.info("pomelo init success"),tracker.addPushLog(lastUserId,clientProxy.platform,"init:success","initCount:"+initCount);var bindCount=0,bindBackoffTime=1,registerAndBind=function(bindInfo){window.pomelo.registerAndBind({user:bindInfo.uid,nonce:bindInfo.nonce,expire_time:bindInfo.expire,signature:bindInfo.sign,domain:domain,productKey:productKey},function(data){data.code===SUCCESS?(tracker.addPushLog(lastUserId,clientProxy.platform,"bind:success","bindCount:"+bindCount),console.info("registered and bind success"),$rootScope.$broadcast("socket.bind.success")):(tracker.addPushLog(lastUserId,clientProxy.platform,"bind:error","bindCount:"+bindCount+";"+String(data.code)),console.error("bind error: "+data.code),$rootScope.$broadcast("socket.bind.error"),bindCount++,bindBackoffTime*=2,bindTryCount>bindCount&&setTimeout(function(){getBindInfo(registerAndBind)},1e3*bindBackoffTime))})};getBindInfo(registerAndBind)}})}function getServer(){trackTiming.getServer.start(),$http.get("/yws/api/push",{params:{method:"getserver",pushplat:"web"}}).success(function(json){trackTiming.getServer.end().setLabel("success").send().clear(),domain=json.domain,productKey=json.productKey,host=json.host,port=json.port,initCount=0,initBackoffTime=1,init()})}function broadcastMessage(isOffline,content){isOffline?$rootScope.$broadcast("socket.message.offline",content):$rootScope.$broadcast("socket.message",content)}function broadcast(data,isOffline){$rootScope.$apply(function(){var content;console.info(data),_.each(data,function(value){content=JSON.parse(value.content),content.category===PUSH_CATEGORY.MESSAGE?content.full===!1?chatService.listMessage(content.groupId,content.id,1).then(function(json){broadcastMessage(isOffline,_.extend(content,json[0]))},function(e,status){console.error(e),console.error(status)}):broadcastMessage(isOffline,content):content.category!==PUSH_CATEGORY.NOTIFICATION||isOffline?content.category===PUSH_CATEGORY.EVENT?(content.type===EVENT_TYPE.HACK&&$rootScope.$broadcast("socket.event.hack."+content.value.hackType,JSON.parse(content.value.content)),$rootScope.$broadcast("socket.event."+content.type,content,content.value)):content.category===PUSH_CATEGORY.P2P&&(isOffline||$rootScope.$broadcast("socket.p2p.message",content,!1)):$rootScope.$broadcast("socket.notification",content)})})}function listener(){window.pomelo.removeAllListeners("specify"),window.pomelo.removeAllListeners("reconnectMessage"),window.pomelo.removeAllListeners("broadcast"),window.pomelo.removeAllListeners("disconnect"),window.pomelo.removeAllListeners("reconnect"),window.pomelo.on("specify",function(data){window.pomelo.ackMessage(domain,data),broadcast(data,!1)}),window.pomelo.on("reconnectMessage",function(data){window.pomelo.ackMessage(domain,data),broadcast(data,!0),console.log("reconnectMessage:"),console.log(data)}),window.pomelo.on("broadcast",function(){}),window.pomelo.on("disconnect",function(reason){tracker.addPushLog(lastUserId,clientProxy.platform,"disconnect",String(reason)),$rootScope.$broadcast("socket.disconnect"),"booted"===reason&&$rootScope.$broadcast("socket.booted")}),window.pomelo.on("reconnect",function(){tracker.addPushLog(lastUserId,clientProxy.platform,"reconnect"),$rootScope.$broadcast("socket.reconnect")})}function connect(userId){lastUserId=userId,getServer(),listener()}function disconnect(){console.info("pomelo disconnet"),window.pomelo.disconnect()}function reconnect(){connect(lastUserId)}this.connect=connect,this.disconnect=disconnect,this.reconnect=reconnect}}),define("common/service/chatService",["util/trackTiming"],function(trackTiming){"use strict";return function($http,$q){function listMessage(groupId,last,length,timeout,channel){var defer=$q.defer();return 0===last?defer.resolve([]):(trackTiming.listMessage.start(),$http.get("/yws/api/group/"+groupId+"/message",{params:{method:"list",last:last,length:length,channel:channel},timeout:timeout?timeout.promise:null}).success(function(json){trackTiming.listMessage.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(e,status){trackTiming.listMessage.end().setLabel("error").send().clear(),defer.reject(e,status)})),defer.promise}function sendText(groupId,message,targets,sync,localId){var defer=$q.defer();return trackTiming.sendText.start(),$http.post("/yws/api/group/"+groupId+"/message?method=sendText",{content:message,targets:targets,sync:sync,localId:localId}).success(function(json){trackTiming.sendText.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(e,status){trackTiming.sendText.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise}function sendNote(groupId,noteId){var defer=$q.defer();return trackTiming.sendNote.start(),$http.post("/yws/api/group/"+groupId+"/message?method=sendNote",{noteId:noteId}).success(function(json){trackTiming.sendNote.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(e,status){trackTiming.sendNote.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise}function sendFile(groupId,fileId){var defer=$q.defer();return trackTiming.sendFile.start(),$http.post("/yws/api/group/"+groupId+"/message?method=sendFile",{fileId:fileId}).success(function(json){trackTiming.sendFile.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(e,status){trackTiming.sendFile.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise}this.listMessage=listMessage,this.sendText=sendText,this.sendFile=sendFile,this.sendNote=sendNote}}),define("common/service/noticeService",["util/trackTiming"],function(trackTiming){"use strict";return function($http,$q){function addNotice(groupId,notice,userId){var defer=$q.defer();return trackTiming.addNotice.start(),$http.post("/yhs/api/"+groupId+"/notice",{notice:notice,userId:userId}).success(function(json){trackTiming.addNotice.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(e,status){trackTiming.addNotice.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise}function getNotice(groupId){var defer=$q.defer();return trackTiming.getNotice.start(),$http.get("/yhs/api/"+groupId+"/notice",{}).success(function(json){trackTiming.getNotice.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(e,status){trackTiming.getNotice.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise}this.addNotice=addNotice,this.getNotice=getNotice}}),define("common/service/chatTemplate",[],function(){"use strict";return function(extension){var TEMPLATE="ext.chat.template";this.extendTemplate=extension.declare(TEMPLATE),this.getTemplateUrl=function(type,data){var url=null;return extension(TEMPLATE,{type:type,data:data},function(data){url=data.templateUrl}),url},this.getTipUrl=function(type,data){var url=null;return extension(TEMPLATE,{type:type,data:data},function(data){url=data.tipUrl}),url}}}),define("common/service/aliasService",["underscore","util/trackTiming"],function(_,trackTiming){return function($http){function invoke(fn,args){_.isFunction(fn)&&fn.apply(this,args)}function init(){this.getAliasList(0,0,function(data){if(data.length){var i,key,value;for(i=0;i<data.length;i++)key=data[i].targetUserId,value=data[i].aliasName,aliasList[key]={name:value,pinyin:data[i].properties.aliasPinyin}}})}var aliasList={};this.getAliasName=function(userId,sb,fb){return aliasList[userId]?void invoke(sb,[aliasList[userId].name]):(trackTiming.getAliasName.start(),void $http.get("/yws/api/alias",{params:{method:"get",userId:userId}}).success(function(json){trackTiming.getAliasName.end().setLabel("success").send().clear(),aliasList[userId]={name:json.aliasName,pinyin:json.aliasPinyin},invoke(sb,[json.aliasName])}).error(function(json){trackTiming.getAliasName.end().setLabel("error").send().clear(),invoke(fb,[json])}))},this.updateAliasName=function(userId,aliasName,sb,fb){trackTiming.updateAliasName.start(),$http.post("/yws/api/alias",{aliasName:aliasName,userId:userId},{params:{method:"change"}}).success(function(json){trackTiming.updateAliasName.end().setLabel("success").send().clear(),aliasList[json.targetUserId]={name:json.aliasName,pinyin:json.properties.aliasPinyin},invoke(sb,[json])}).error(function(json){trackTiming.updateAliasName.end().setLabel("error").send().clear(),invoke(fb,[json])})},this.deleteAliasName=function(userId,sb,fb){trackTiming.deleteAliasName.start(),$http.post("/yws/api/alias",{userId:userId},{params:{method:"delete"}}).success(function(json){trackTiming.deleteAliasName.end().setLabel("success").send().clear(),aliasList[userId]=null,invoke(sb,[json])}).error(function(json){trackTiming.deleteAliasName.end().setLabel("error").send().clear(),invoke(fb,[json])})},this.getAliasList=function(offset,len,sb,fb){trackTiming.getAliasList.start(),$http.get("/yws/api/alias",{params:{method:"list",offset:offset,len:len}}).success(function(json){trackTiming.getAliasList.end().setLabel("success").send().clear(),invoke(sb,[json])}).error(function(json){trackTiming.getAliasList.end().setLabel("error").send().clear(),invoke(fb,[json])})},this.updateAliasList=function(members){if(members.length){var i,key;for(i=0;i<members.length;i++)key=members[i].userId,aliasList[key]={name:members[i].aliasName||members[i].name,pinyin:members[i].aliasPinyin||members[i].pinyin}}},this.init=init,this.aliasList=aliasList}}),define("common/service/downloadService",["jquery"],function(jq){"use strict";return function($http,dialogService,clientProxy){function downloadNative(name,path){clientProxy.download(name,path)}function downloadWeb(path){iframeEl.attr("src",path)}function dispatchDownload(name,path){canNativeDownload?downloadNative(name,path):downloadWeb(path)}var canNativeDownload=clientProxy.isSupport("download"),iframeEl=canNativeDownload?null:function(){var el=jq('<iframe  name="file-download-frame" id="file-download-frame"  class="file-download-frame"> </iframe>').appendTo(document.body);return el[0].contentWindow.name="file-download-frame",el}();this.download=function(name,path){dispatchDownload(name,path)},this.anchorDownload=function(name,path,event){canNativeDownload&&downloadNative(name,path),canNativeDownload&&event&&event.preventDefault()}}}),define("common/service/extension",["underscore"],function(_){"use strict";return function(){function declare(key){return function(handler,priority){_.isArray(registry[key])||(registry[key]=[]),handler.priority=priority||0,registry[key].push(handler),registry[key].sort(function(h1,h2){return h2.priority-h1.priority})}}var registry={};return _.extend(function(key,data,byDefault){var handlers=registry[key],prevented=!1;_.isArray(handlers)||_.isFunction(byDefault)&&byDefault(data,prevented),_.each(handlers,function(handler){prevented||(prevented=handler(data)===!1)}),_.isFunction(byDefault)&&byDefault(data,prevented)},{declare:declare})}}),define("common/service/commentService",[],function(){"use strict";return function($rootScope,$http,$q){function listFileComment(groupId,fileId,pageNum,pageSize,lastId){return $http.get("/yws/api/group/"+groupId+"/file/"+fileId+"/comment",{params:{method:"list",pageNum:pageNum,pageSize:pageSize,lastId:lastId}})}function listTaskComment(groupId,taskId,pageNum,pageSize,lastId){return $http.get("/yws/api/group/"+groupId+"/tasks/task/"+taskId+"/comment",{params:{method:"list",pageNum:pageNum,pageSize:pageSize,lastId:lastId}})}function addFileComment(groupId,fileId,content,replyId,targets,sync,localId){var defer=$q.defer();return targets||(targets=""),sync||(sync=!1),$http.post("/yws/api/group/"+groupId+"/file/"+fileId+"/comment?method=add",{content:content,replyId:replyId,targets:targets,sync:sync,localId:localId}).success(function(json){defer.resolve(json),$rootScope.$broadcast("comment.send.success",{localId:localId,json:json})}).error(function(e,status){defer.reject(e,status),$rootScope.$broadcast("comment.send.error",{localId:localId})}),defer.promise}function addTaskComment(groupId,taskId,content,replyId,targets,sync,localId){var defer=$q.defer();return targets||(targets=""),sync||(sync=!1),$http.post("/yws/api/group/"+groupId+"/tasks/task/"+taskId+"/comment?method=add",{content:content,replyId:replyId,targets:targets,sync:sync,localId:localId}).success(function(json){defer.resolve(json),$rootScope.$broadcast("comment.send.success",{localId:localId,json:json})}).error(function(e,status){defer.reject(e,status),$rootScope.$broadcast("comment.send.error",{localId:localId})}),defer.promise}function removeFileComment(groupId,fileId,commentId){return $http.post("/yws/api/group/"+groupId+"/file/"+fileId+"/comment/"+commentId+"?method=remove",{commentId:commentId})
}function removeTaskComment(groupId,taskId,commentId){return $http.post("/yws/api/group/"+groupId+"/tasks/task/"+taskId+"/comment/"+commentId+"?method=remove",{commentId:commentId})}function getFileComment(groupId,fileId,commentId){return $http.get("/yws/api/group/"+groupId+"/file/"+fileId+"/comment/"+commentId+"?method=get")}function getTaskComment(groupId,taskId,commentId){return $http.get("/yws/api/group/"+groupId+"/tasks/task/"+taskId+"/comment/"+commentId+"?method=get")}function locateFileComment(groupId,fileId,commentId){return $http.get("/yws/api/group/"+groupId+"/file/"+fileId+"/comment/"+commentId+"?method=locate")}function locateTaskComment(groupId,taskId,commentId){return $http.get("/yws/api/group/"+groupId+"/tasks/task"+taskId+"/comment/"+commentId+"?method=locate")}function list(type,groupId,entryId,pageNum,pageSize,lastId){return"file"===type?listFileComment(groupId,entryId,pageNum,pageSize,lastId):listTaskComment(groupId,entryId,pageNum,pageSize,lastId)}function add(type,groupId,entryId,content,replyId,targets,sync,localId){return"file"===type?addFileComment(groupId,entryId,content,replyId,targets,sync,localId):addTaskComment(groupId,entryId,content,replyId,targets,sync,localId)}function remove(type,groupId,entryId,commentId){return"file"===type?removeFileComment(groupId,entryId,commentId):removeTaskComment(groupId,entryId,commentId)}function get(type,groupId,entryId,commentId){return"file"===type?getFileComment(groupId,entryId,commentId):getTaskComment(groupId,entryId,commentId)}function locate(type,groupId,entryId,commentId){return"file"===type?locateFileComment(groupId,entryId,commentId):locateTaskComment(groupId,entryId,commentId)}this.list=list,this.add=add,this.remove=remove,this.get=get,this.locate=locate}}),define("common/service/commentFactory",[],function(){"use strict";return function(){function Commenter(json){this.userId=json.userId,this.name=json.name?String(json.name):void 0,this.photo=json.photo?String(json.photo):void 0,this.description=json.description?String(json.description):void 0,this.location=json.location,this.phone=json.phone,this.email=json.email,this.sex=json.sex,this.modifyTime=json.modifyTime}function ReplyComment(json){this.groupId=json.groupId?Number(json.groupId):void 0,this.id=json.id?Number(json.id):void 0,this.entryId=json.fileId?Number(json.fileId):json.taskId?Number(json.taskId):void 0,this.createTime=new Date(json.createTime),this.content=json.content?String(json.content):" ",this.content.length>60&&(this.content=this.content.substr(0,60)+"..."),json.commenter&&(this.commenter=new Commenter(json.commenter))}function adapter(json){var obj={commenter:json.user,content:json.content,createTime:json.time,entryId:json.fileId||json.taskId,groupId:json.groupId,id:json.commentId,removed:!1,replyComment:null,replyId:0};return"REPLY"===json.action&&(obj.replyComment={content:json.replyContent,commenter:json.object}),obj}function Comment(json,loginUid){json.action&&(json=adapter(json)),this.groupId=json.groupId?Number(json.groupId):void 0,this.id=json.id?Number(json.id):void 0,this.localId=json.localId?json.localId:void 0,this.entryId=json.fileId?Number(json.fileId):json.taskId?Number(json.taskId):void 0,this.createDate=new Date(json.createTime),this.createTime=json.createTime,this.content=json.content?String(json.content):" ",json.commenter&&(this.commenter=new Commenter(json.commenter)),json.replyComment?(this.hasReply=!0,this.replyComment=new ReplyComment(json.replyComment)):this.hasReply=!1,this.commenter&&(this.isMyself=String(this.commenter.userId)===String(loginUid)?!0:!1),this.expandReply=!1}function Factory(json,loginUid){return new Comment(json,loginUid)}return Factory}}),define("common/service/searchService",["underscore","util/trackTiming"],function(_,trackTiming){"use strict";return function($http,$q,fileMgr){function searchMessage(groupId,keyword,pageNum,pageSize,timeout){return keyword?(trackTiming.searchMessage.start(),$http.get("/yws/api/group/"+groupId+"/search?target=message",{params:{keyword:keyword,pageNum:pageNum,pageSize:pageSize},timeout:timeout?timeout.promise:null}).then(function(res){return trackTiming.searchMessage.end().setLabel("success").send().clear(),res.data}).catch(function(e){return trackTiming.searchMessage.end().setLabel("error").send().clear(),$q.reject(e.data)})):$q.when([])}function searchComment(groupId,keyword,pageNum,pageSize,timeout){return keyword?(trackTiming.searchComment.start(),$http.get("/yws/api/group/"+groupId+"/search?target=comment",{params:{keyword:keyword,pageNum:pageNum,pageSize:pageSize},timeout:timeout?timeout.promise:null}).then(function(res){return trackTiming.searchComment.end().setLabel("success").send().clear(),res.data}).catch(function(e){return trackTiming.searchComment.end().setLabel("error").send().clear(),$q.reject(e.data)})):$q.when([])}function searchFile(groupId,keyword,pageNum,pageSize,timeout){return keyword?(trackTiming.searchFile.start(),$http.get("/yws/api/group/"+groupId+"/search?target=file",{params:{keyword:keyword,pageNum:pageNum,pageSize:pageSize},timeout:timeout?timeout.promise:null}).then(function(res){trackTiming.searchFile.end().setLabel("success").send().clear();var files=_.map(res.data.value,function(fileData){return new fileMgr.File(groupId,fileData)});return files.total=res.data.total,files}).then(function(files){return 0==files.length?files:fileMgr.getFilePaths(groupId,_.map(files,function(file){return file.parentId})).then(function(paths){return _.each(files,function(file){file.path=paths[file.parentId]}),files})}).catch(function(e){return trackTiming.searchFile.end().setLabel("error").send().clear(),$q.reject(e.data)})):$q.when([])}this.searchMessage=searchMessage,this.searchFile=searchFile,this.searchComment=searchComment}}),define("common/service/storageManager",["underscore"],function(_){"use strict";function delegate(prefix){function getKey(name){return prefix+name}function isKey(name){return 0===name.indexOf(prefix)}function put(name,value,unstable){function tryPut(){var shrinked,key=getKey(name);try{pushKeyMeta({key:key,unstable:unstable}),pushKeyValue(name,value)}catch(e){return shrinked=shrink(),shrinked?shrinked.key===key?!1:tryPut():!1}return!0}function shrink(){var meta=shiftKeyMetas();return meta?(local.removeItem(meta.key),meta):null}function shiftKeyMetas(){var key,metas=local.getItem("yn:metas");return metas?(metas=JSON.parse(metas),(key=_.findWhere(metas,{unstable:!0}))?(metas=_.without(metas,key),local.setItem("yn:metas",JSON.stringify(metas)),key):null):null}function pushKeyMeta(meta){var exists,metas=local.getItem("yn:metas");return metas=metas?JSON.parse(metas):[],(exists=_.findWhere(metas,{key:meta.key}))?(_.extend(exists,meta),metas=_.without(metas,exists),metas.push(exists),local.setItem("yn:metas",JSON.stringify(metas)),exists):(metas.push(meta),local.setItem("yn:metas",JSON.stringify(metas)),meta)}function pushKeyValue(name,value){local.setItem(getKey(name),JSON.stringify(value))}if(void 0!==value)try{return tryPut()}catch(e){return local.clear(),null}}function get(name){try{var value=local.getItem(getKey(name));return null===value?null:JSON.parse(value)}catch(e){return local.clear(),null}}function has(name){return null!=local.getItem(getKey(name))}function remove(name){var key=getKey(name),value=get(name),metas=local.getItem("yn:metas");return null===value?null:(local.removeItem(key),metas?(metas=JSON.parse(metas),metas=_.without(metas,_.findWhere(metas,{key:key})),local.setItem("yn:metas",JSON.stringify(metas)),value):value)}function forEach(fn){var pos,key,value;for(pos=0;pos<local.length&&(key=local.key(pos),!isKey(key)||(value=get(key),fn(key,value)!==!1));pos++);}function clear(){var pos,key,keys=[];for(pos=0;pos<local.length;pos++)key=local.key(pos),isKey(key)&&keys.push(key);_.each(keys,function(key){local.removeItem(key)})}return{put:put,get:get,remove:remove,clear:clear,has:has,each:forEach}}var local=window.localStorage;return function(client){var internal=delegate("yn:internal:"),userStorage=delegate("yn:user:"),globalStorage=delegate("yn:all:");return{supported:function(){return!client.isPC()&&window.hasOwnProperty("localStorage")||client.isPC("3.9.5")},forUser:function(newUid){var uid=internal.get("uid");return uid&&uid!=newUid&&userStorage.clear(),internal.put("uid",newUid),userStorage},forAll:function(){return globalStorage}}}}),define("common/service/permissionService",["underscore"],function(_){return function(launcher){function Action(name){var whiteListRoles=[],blackListRoles=[],checkWhiteList=function(roleArray){return _.any(whiteListRoles,function(role){return _.indexOf(roleArray,role)>-1})},checkBlackList=function(roleArray){return _.any(blackListRoles,function(role){return _.indexOf(roleArray,role)>-1})},addWhiteRole=function(role){-1===_.indexOf(whiteListRoles,role)&&whiteListRoles.push(role)},addBlackRole=function(role){-1===_.indexOf(blackListRoles,role)&&blackListRoles.push(role)};return{name:name,addWhiteRole:addWhiteRole,addBlackRole:addBlackRole,checkWhiteList:checkWhiteList,checkBlackList:checkBlackList}}function bind(role,actions,addToBlack){_.forEach(actions,function(action){actionsMap[action]||(actionsMap[action]=new Action(action)),addToBlack?actionsMap[action].addBlackRole(role):actionsMap[action].addWhiteRole(role)})}function register(role,actions){bind(role,actions)}function deregister(role,actions){bind(role,actions,!0)}function loopCheckAction(action,flag,roles){if(flag===!0||""===action)return flag;var starName,nameList=action.split(".");return"*"!==nameList[nameList.length-1]&&(nameList[nameList.length-1]="*",starName=nameList.join(".")),flag=actionsMap[action]||actionsMap[starName]?actionsMap[starName]?actionsMap[action]?!actionsMap[action].checkBlackList(roles)&&!actionsMap[starName].checkBlackList(roles)&&(actionsMap[action].checkWhiteList(roles)||actionsMap[starName].checkWhiteList(roles)):!actionsMap[starName].checkBlackList(roles)&&actionsMap[starName].checkWhiteList(roles):!actionsMap[action].checkBlackList(roles)&&actionsMap[action].checkWhiteList(roles):!1,actionsMap[action]&&actionsMap[action].checkBlackList(roles)||actionsMap[starName]&&actionsMap[starName].checkBlackList(roles)?flag:(nameList.splice(nameList.length-1),action=nameList.join("."),loopCheckAction(action,flag,roles))}function check(action){var roles=launcher.getCurrentRole(),flag=!1,isNon=!1;return action?("!"===action[0]&&(action=action.slice(1),isNon=!0),void 0!==getCache(action,roles)?isNon?!getCache(action,roles):getCache(action,roles):(flag=loopCheckAction(action,flag,roles),saveCache(action,roles,flag),isNon?!flag:flag)):flag}var actionsMap={},cachedMap={},getRoleString=function(array){return _.reduce(_.sortBy(array,function(left,right){return left-right}),function(lastString,curString){return lastString+" "+curString},"")},saveCache=function(action,roles,flag){cachedMap[action]=cachedMap[action]||[],cachedMap[action][getRoleString(roles)]=flag},getCache=function(action,roles){return cachedMap[action]&&cachedMap[action][getRoleString(roles)]};this.register=register,this.deregister=deregister,this.check=check}}),define("common/service/applicantService",["underscore","util/trackTiming"],function(_,trackTiming){return function($http,$rootScope,$q){function Member(json){this.userId=String(json.userId||""),this.name=String(json.name||""),this.joinTime=Number(json.joinTime||json.modifyTime||0),json.photo||(json.photo="style/images/033488d9.dummy_user.jpg"),this.photo=String(json.photo||""),this.groupId=Number(json.groupId||0),this.role=String(json.role||""),this.settings={msg:Number(json.messageSetting)},this.aliasName=json.aliasName,json.properties&&json.properties.aliasName&&(this.aliasName=String(json.properties.aliasName||this.aliasName),this.aliasPinyin=String(json.properties.aliasPinyin)),this.pinyin=json.pinyin,json.properties&&(this.pinyin=String(json.properties.pinyin||this.pinyin))}function getApplicants(lastTime,lastId,length,personal){var defer=$q.defer();return trackTiming.getApplicants.start(),$http.get("/yws/api/notification",{params:{method:"list",lastTime:lastTime,lastId:lastId,length:length,personal:personal}}).success(function(json){trackTiming.getApplicants.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(json){trackTiming.getApplicants.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function getTaskMsg(lastTime,length){var defer=$q.defer();return $http.get("/yws/api/notification?method=listTask",{params:{lastTime:lastTime,length:length}}).success(function(json){defer.resolve(json)}).error(function(json){defer.reject(json)}),defer.promise}function listInvitee(groupId,timeout){var defer=$q.defer(),members=[];return trackTiming.listInvitee.start(),$http.get("/yws/api/group/"+groupId+"/applicant",{params:{method:"listInvitee"},timeout:timeout.promise}).success(function(array){trackTiming.listInvitee.end().setLabel("success").send().clear(),_.each(array,function(json){json.groupId=groupId,members.push(new Member(json))}),defer.resolve(members)}).error(function(json){trackTiming.listInvitee.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function acceptApplicant(groupId,applicantId){var defer=$q.defer();return trackTiming.acceptApplicant.start(),$http.post("/yws/api/group/"+groupId+"/applicant/"+applicantId,{},{params:{method:"accept"}}).success(function(json){trackTiming.acceptApplicant.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(json){trackTiming.acceptApplicant.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function rejectApplicant(groupId,applicantId,never){var defer=$q.defer();return trackTiming.rejectApplicant.start(),$http.post("/yws/api/group/"+groupId+"/applicant/"+applicantId,{never:never},{params:{method:"reject"}}).success(function(json){trackTiming.rejectApplicant.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(json){trackTiming.rejectApplicant.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function inviteApplicant(groupId,userId,message){var defer=$q.defer();return trackTiming.inviteApplicant.start(),$http.post("/yws/api/group/"+groupId+"/applicant",{userId:userId,message:message},{params:{method:"invite"}}).success(function(json){trackTiming.inviteApplicant.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(json){trackTiming.inviteApplicant.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function inviteApplicantByEmail(groupId,userId,message){var defer=$q.defer();return trackTiming.inviteApplicantByEmail.start(),$http.post("/yws/api/group/"+groupId+"/applicant",{userId:userId,message:message},{params:{method:"sendmail"}}).success(function(json){trackTiming.inviteApplicantByEmail.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(json){trackTiming.inviteApplicantByEmail.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function inviteOrgMembers(groupId,userIdList,message){var defer=$q.defer();return trackTiming.inviteOrgMembers.start(),$http.post("/yws/api/group/"+groupId+"/applicant",{userIdList:userIdList,message:message},{params:{method:"inviteMulti"}}).success(function(json){trackTiming.inviteOrgMembers.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(json){trackTiming.inviteOrgMembers.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function confirmApplicant(groupId,applicantId){var defer=$q.defer();return trackTiming.confirmApplicant.start(),$http.post("/yws/api/group/"+groupId+"/applicant/"+applicantId,{},{params:{method:"confirm"}}).success(function(json){trackTiming.confirmApplicant.end().setLabel("success").send().clear(),$rootScope.$broadcast("group.invited",groupId),defer.resolve(json)}).error(function(json){trackTiming.confirmApplicant.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function ignoreApplicant(groupId,applicantId){var defer=$q.defer();return trackTiming.ignoreApplicant.start(),$http.post("/yws/api/group/"+groupId+"/applicant/"+applicantId,{},{params:{method:"ignore"}}).success(function(json){trackTiming.ignoreApplicant.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(json){trackTiming.ignoreApplicant.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function deleteInvitee(groupId,userId){var defer=$q.defer();return trackTiming.deleteInvitee.start(),$http.post("/yws/api/group/"+groupId+"/applicant",{},{params:{method:"delinvite",deleteUserId:userId}}).success(function(json){trackTiming.deleteInvitee.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(json){trackTiming.deleteInvitee.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function cancelNotice(type,time){var defer=$q.defer(),content=[];content.push(2>type?{type:type,lrt:time}:{type:type,lrts:time});var i=Math.random();return trackTiming.cancelNotice.start(i),$http.post("/yws/api/notification",{content:JSON.stringify(content)},{params:{method:"cancel"}}).success(function(json){trackTiming.cancelNotice.end(i).setLabel("success").send().clear(i),defer.resolve(json)}).error(function(json){trackTiming.cancelNotice.end(i).setLabel("error").send().clear(i),defer.reject(json)}),defer.promise}function getCancelInterval(){var defer=$q.defer();return trackTiming.cancelInterval.start(),$http.get("/yws/api/notification",{params:{method:"cancelInterval"}}).success(function(json){trackTiming.cancelInterval.end().setLabel("success").send().clear(),cancelInterval=Number(json.interval||cancelInterval),defer.resolve(json)}).error(function(json){trackTiming.cancelInterval.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function processLastNoticeTime(array){array&&_.each(array,function(message){0===message.type?lastMessageTime=message.lrt:1===message.type&&(lastNotificationTime=message.lrt)})}function processLastChatTime(array){array&&_.each(array,function(group){lastReadTimeList[group.gid]=group.lrt,lastReadIdList[group.gid]=group.lrId})}function getNotificationTime(){var defer=$q.defer();return trackTiming.getNotificationTime.start(),$http.get("/yws/api/notification",{params:{method:"lastNotificationTime"}}).success(function(json){trackTiming.getNotificationTime.end().setLabel("success").send().clear(),processLastNoticeTime(json),defer.resolve(json)}).error(function(json){trackTiming.getNotificationTime.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function getLastChatReadTime(groupId){var defer=$q.defer(),data={};return groupId&&(data.groupId=groupId),trackTiming.getLastChatReadTime.start(),$http.post("/yws/api/notification",data,{params:{method:"lastGroupChatReadTime"}}).success(function(json){trackTiming.getLastChatReadTime.end().setLabel("success").send().clear(),processLastChatTime(json),defer.resolve(json)}).error(function(json){trackTiming.getLastChatReadTime.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function getLatestChatId(offset){var defer=$q.defer(),data={};return offset&&(data.offset=offset),trackTiming.getLatestChatId.start(),$http.get("/yws/api/chat",{params:{method:"lastGroupChatIds"}}).success(function(json){trackTiming.getLatestChatId.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(json){trackTiming.getLatestChatId.end().setLabel("error").send().clear(),defer.reject(json)}),defer.promise}function getInterval(){return cancelInterval}function getLastMessageTime(){return lastMessageTime}function getLastNotificationTime(){return lastNotificationTime}function setLastMessageTime(time){lastMessageTime=time}function setLastNotificationTime(time){lastNotificationTime=time}function init(){return $q.all([getCancelInterval(),getNotificationTime(),getLastChatReadTime()])}var CANCEL_TYPE={CANCEL_MESSAGE:0,CANCEL_NOTIFICATION:1,CANCEL_GROUP:2},cancelInterval=6e5,lastMessageTime=-1,lastNotificationTime=-1,lastReadTimeList={},lastReadIdList={};_.extend(this,CANCEL_TYPE),this.init=init,this.getApplicants=getApplicants,this.getTaskMsg=getTaskMsg,this.listInvitee=listInvitee,this.acceptApplicant=acceptApplicant,this.rejectApplicant=rejectApplicant,this.inviteApplicant=inviteApplicant,this.inviteApplicantByEmail=inviteApplicantByEmail,this.inviteOrgMembers=inviteOrgMembers,this.confirmApplicant=confirmApplicant,this.ignoreApplicant=ignoreApplicant,this.deleteInvitee=deleteInvitee,this.cancelNotice=cancelNotice,this.getCancelInterval=getCancelInterval,this.getLastMessageTime=getLastMessageTime,this.getLastNotificationTime=getLastNotificationTime,this.setLastMessageTime=setLastMessageTime,this.setLastNotificationTime=setLastNotificationTime,this.lastReadTimeList=lastReadTimeList,this.lastReadIdList=lastReadIdList,this.getLatestChatId=getLatestChatId,this.getInterval=getInterval}}),define("common/service/updater",[],function(){"use strict";return function($q){return function(){function bindEvents(){function needReload(){removeEvents(),appCache.status==appCache.UPDATEREADY&&(appCache.swapCache(),location.reload())}function noNeedReload(){removeEvents()}function removeEvents(){appCache.removeEventListener("cached",noNeedReload),appCache.removeEventListener("error",noNeedReload),appCache.removeEventListener("noupdate",noNeedReload),appCache.removeEventListener("obsolete",noNeedReload),appCache.removeEventListener("updateready",needReload)}appCache.addEventListener("cached",noNeedReload),appCache.addEventListener("error",noNeedReload),appCache.addEventListener("obsolete",noNeedReload),appCache.addEventListener("noupdate",noNeedReload),appCache.addEventListener("updateready",needReload)}var appCache=window.applicationCache;return appCache?(bindEvents(),$q.when()):$q.when(!1)}}}),define("common/service/organizationService",["underscore","util/trackTiming"],function(_,trackTiming){return function($http,$rootScope,$q,$cacheFactory,ROLES,EVENTS,groups){function Org(json){this.id=Number(json.orgId||0),this.owner=String(json.ownerId||""),this.ownerName=String(json.name||""),this.name=String(json.orgName||""),this.description=String(json.orgDescription||""),this.photo=String(json.orgPhoto||"style/images/491c4c20.org_icon_default.png"),this.usedSpace=Number(json.currSpaceQuotaUsed||0),json.orgLimit&&(this.totalSpace=Number(json.orgLimit.maxSpaceQuota||0)),this.expireTime=new Date(json.expireAt||0),this.trail=json.trial||!1,this.trail&&(this.leftTrailDays=Math.floor((this.expireTime.getTime()-(new Date).getTime())/864e5)),this.comboNum=Number(json.orgLimit.comboNum||0)}function createOrg(name,description,coords){var deferred=$q.defer(),params={};return name&&(params.orgName=name),description&&(params.description=description),coords&&(params.photoUrl=coords.photo,params.x=coords.x,params.y=coords.y,params.w=coords.w,params.h=coords.h),trackTiming.createOrg.start(),$http.post("/yws/api/org",params,{params:{method:"create"}}).success(function(json){trackTiming.createOrg.end().setLabel("success").send().clear(),$rootScope.$broadcast(EVENTS.CREATE),deferred.resolve(new Org(json))}).error(function(e){trackTiming.createOrg.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function listMember(orgId,offset,len){var deferred=$q.defer();return trackTiming.listMember.start(),$http.post("/yws/api/org/"+orgId,{offset:_.isNumber(offset)?offset:0,len:_.isNumber(len)?len:1e4},{params:{method:"listMember"}}).success(function(data){trackTiming.listMember.end().setLabel("success").send().clear(),deferred.resolve(_.map(data.list,function(userMappingAndInfo){return _.extend(new Member(userMappingAndInfo.userInfo),{role:userMappingAndInfo.orgMemberMapping.role,orgId:userMappingAndInfo.orgMemberMapping.orgId,joinTime:new Date(userMappingAndInfo.orgMemberMapping.joinTime)})}))}).error(function(e){trackTiming.listMember.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function listGroups(orgId,showDeleted,offset,len){var deferred=$q.defer();return trackTiming.listGroups.start(),$http.post("/yws/api/org/"+orgId,{deleted:showDeleted,offset:_.isNumber(offset)||0,len:_.isNumber(len)?len:1e3},{params:{method:"listGroup"}}).success(function(data){trackTiming.listGroups.end().setLabel("success").send().clear(),deferred.resolve(_.map(data.list,function(json){return new Group(json)}))}).error(function(e){trackTiming.listGroups.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function listGroupsForMember(memberId,orgId,offset,len){var deferred=$q.defer();return trackTiming.listGroupOfMember.start(),$http.post("/yws/api/org/"+orgId,{memberId:memberId,offset:_.isNumber(offset)?offset:0,len:_.isNumber(len)?len:50},{params:{method:"listGroupOfMember"}}).success(function(data){trackTiming.listGroupOfMember.end().setLabel("success").send().clear(),deferred.resolve([_.sortBy(_.map(data.list,function(json){return{group:new Group(json.group),member:new Member(json.groupMember)}}),function(element){return-element.member.joinTime}),data.totalNum])}).error(function(e){trackTiming.listGroupOfMember.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function eraseGroup(orgId,groupId){var deferred=$q.defer();return trackTiming.eraseGroup.start(),$http.post("/yws/api/org/"+orgId,{groupId:groupId},{params:{method:"erase"}}).success(function(){trackTiming.eraseGroup.end().setLabel("success").send().clear(),deferred.resolve()}).error(function(e){trackTiming.eraseGroup.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function recoverGroup(orgId,groupId){var deferred=$q.defer();return trackTiming.recoverGroup.start(),$http.post("/yws/api/org/"+orgId,{groupId:groupId},{params:{method:"recover"}}).success(function(json){trackTiming.recoverGroup.end().setLabel("success").send().clear(),deferred.resolve(new Group(json))}).error(function(e){trackTiming.recoverGroup.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function joinGroup(groupId,message){var deferred=$q.defer();return trackTiming.orgGroupJoin.start(),$http.post("/yws/api/group/"+groupId+"/member",{method:"join",joinMessage:message}).success(function(json){trackTiming.orgGroupJoin.end().setLabel("success").send().clear(),deferred.resolve(json)}).error(function(e){trackTiming.orgGroupJoin.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function applyJoin(){}function addMember(memberId,orgId,role){var deferred=$q.defer();return trackTiming.addMember.start(),$http.post("/yws/api/org/"+orgId+"/member",{role:role||ROLES.ORG_USER,memberId:memberId},{params:{method:"addMember"}}).success(function(json){trackTiming.addMember.end().setLabel("success").send().clear(),deferred.resolve(new Member(json))}).error(function(e){trackTiming.addMember.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function removeMember(orgId,memberId){var deferred=$q.defer();return trackTiming.removeOrgMember.start(),$http.post("/yws/api/org/"+orgId+"/member",{memberId:memberId},{params:{method:"delMember"}}).success(function(){trackTiming.removeOrgMember.end().setLabel("success").send().clear(),deferred.resolve()}).error(function(e){trackTiming.removeOrgMember.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function changeRole(orgId,memberId,role){var deferred=$q.defer();return trackTiming.orgChangeRole.start(),$http.post("/yws/api/org/"+orgId+"/member",{role:role,memberId:memberId},{params:{method:"changeRole"}}).success(function(json){trackTiming.orgChangeRole.end().setLabel("success").send().clear(),deferred.resolve(new Member(json))}).error(function(e){trackTiming.orgChangeRole.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function getRole(orgId,memberId){var deferred=$q.defer(),key=String(orgId)+String(memberId);return orgMemberRoleCache.get(key)?$q.when(orgMemberRoleCache.get(key)):(trackTiming.getRole.start(),$http.post("/yws/api/org/"+orgId+"/member",{memberId:memberId},{params:{method:"getMember"}}).success(function(json){trackTiming.getRole.end().setLabel("success").send().clear();var result=json.orgMemberMapping.role;orgMemberRoleCache.put(key,result),deferred.resolve(result)}).error(function(e){trackTiming.getRole.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise)}function confirmInvitation(){}function ignoreInvitation(){}function update(org){var params={id:org.id},deferred=$q.defer();return org.name&&(params.orgName=org.name),params.description=org.description,org.photoCroods&&(params.photoUrl=org.photoCroods.photo,params.x=org.photoCroods.x,params.y=org.photoCroods.y,params.w=org.photoCroods.w,params.h=org.photoCroods.h),trackTiming.updateOrg.start(),$http.post("/yws/api/org/"+org.id,params,{params:{method:"update"}}).success(function(json){trackTiming.updateOrg.end().setLabel("success").send().clear(),$rootScope.$broadcast(EVENTS.UPDATE),deferred.resolve(new Org(json))}).error(function(e){trackTiming.updateOrg.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function getOrg(offset,len,owned){var deferred=$q.defer();return trackTiming.listOrg.start(),$http.post("/yws/api/org",{offset:_.isNumber(offset)?offset:0,len:_.isNumber(len)?len:50,owned:!!owned},{params:{method:"listOrg"}}).success(function(data){trackTiming.listOrg.end().setLabel("success").send().clear(),deferred.resolve(_.map(data.list,function(json){return new Org(json)}))}).error(function(e){trackTiming.listOrg.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function getOrgMeta(orgId){var deferred=$q.defer();return trackTiming.getOrgMeta.start(),$http.post("/yws/api/org/"+orgId,{},{params:{method:"get"}}).success(function(json){trackTiming.getOrgMeta.end().setLabel("success").send().clear(),deferred.resolve(new Org(json))}).error(function(e){trackTiming.getOrgMeta.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function changeOwner(){console.log("this API is not yet done")}function hasOwnedOrg(){var deferred=$q.defer();return trackTiming.listOrg.start(),$http.post("/yws/api/org",{owned:!0,offset:0,len:50},{params:{method:"listOrg"}}).success(function(data){trackTiming.listOrg.end().setLabel("success").send().clear(),deferred.resolve(data.list.length>0)}).error(function(e){trackTiming.listOrg.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function startTrail(code){var deferred=$q.defer();return trackTiming.startTrail.start(),$http.get("/yws/mapi/operationCode",{params:{method:"consume",opCodeType:"ENABLE_ORG_TRIAL_FUNCTION",opCode:code}}).success(function(json){trackTiming.startTrail.end().setLabel("success").send().clear(),0===json.opCodeError?deferred.resolve(json):deferred.reject(json.opCodeError)}).error(function(e){trackTiming.startTrail.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function startTrailfromBiz(key){var deferred=$q.defer();return trackTiming.startTrailfromBiz.start(),$http.post("/yws/api/org?method=trial",{},{params:{key:key}}).success(function(json){trackTiming.startTrailfromBiz.end().setLabel("success").send().clear(),deferred.resolve(json)}).error(function(e){trackTiming.startTrailfromBiz.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function dismissOrg(orgId){var deferred=$q.defer();return trackTiming.dismissOrg.start(),$http.post("/yws/api/org/"+orgId,{},{params:{method:"dismiss"}}).success(function(data){trackTiming.dismissOrg.end().setLabel("success").send().clear(),deferred.resolve(data)}).error(function(e){trackTiming.dismissOrg.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function quitOrg(orgId){var deferred=$q.defer();return trackTiming.quitOrg.start(),$http.post("/yws/api/org/"+orgId+"/member",{},{params:{method:"quit"}}).success(function(data){trackTiming.quitOrg.end().setLabel("success").send().clear(),deferred.resolve(data)
}).error(function(e){trackTiming.quitOrg.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function onOrgMemberEvent(evt,orgId,userId,role){orgMemberRoleCache.put(String(orgId)+String(userId),role)}var Group=groups.Group,Member=groups.Member,orgMemberRoleCache=$cacheFactory("org.member.role");$rootScope.$on("org.member.roleChanged",onOrgMemberEvent),this.createOrg=createOrg,this.listGroups=listGroups,this.listMember=listMember,this.listGroupsForMember=listGroupsForMember,this.recoverGroup=recoverGroup,this.eraseGroup=eraseGroup,this.joinGroup=joinGroup,this.applyJoin=applyJoin,this.addMember=addMember,this.removeMember=removeMember,this.changeRole=changeRole,this.getRole=getRole,this.confirmInvitation=confirmInvitation,this.ignoreInvitation=ignoreInvitation,this.update=update,this.getOrg=getOrg,this.changeOwner=changeOwner,this.hasOwnedOrg=hasOwnedOrg,this.startTrail=startTrail,this.startTrailfromBiz=startTrailfromBiz,this.dismissOrg=dismissOrg,this.quitOrg=quitOrg,this.getOrgMeta=getOrgMeta,this.Member=Member,this.Org=Org}}),define("common/service/titleService",["underscore"],function(_){"use strict";var PRIORITY={GROUPNAME:1,FILENAME:2};return function(DOCUMENT_TITLE){function updateTitleByFormat(){var mid=_.compact(_.map(titleComponents,function(element){return _.isString(element)?element:_.isObject(element)?element.name:void console.info("title error: "+element)})).reverse().join(midSplit);""!==mid&&(mid+=midSplit),document.title=[prefix,mid,suffix].join("")}function setComponent(componentKey,componentValue){componentKey&&(titleComponents[componentKey]=componentValue,updateTitleByFormat())}function clearAll(){titleComponents=[],updateTitleByFormat()}function setPrefix(prefixTitle){prefix=prefixTitle,updateTitleByFormat()}function clearPrefix(){prefix="",updateTitleByFormat()}var titleComponents=[],prefix="",suffix=DOCUMENT_TITLE,midSplit="-";this.set=setComponent,this.clearAll=clearAll,this.Priority=PRIORITY,this.setPrefix=setPrefix,this.clearPrefix=clearPrefix}}),define("common/service/vipService",["underscore","util/trackTiming"],function(_,trackTiming){return function($http,$q){var vipList={};this.updateUsersVip=function(usersId){var defer=$q.defer();return trackTiming.getUsersInfo.start(),$http.post("/yws/api/self/multi?method=getMulti",{userId:usersId}).success(function(json){trackTiming.getUsersInfo.end().setLabel("success").send().clear(),_.map(json,function(value){vipList[value.userId]="true"===value.properties.isvip?!0:!1}),defer.resolve()}).error(function(){trackTiming.getUsersInfo.end().setLabel("error").send().clear()}),defer.promise},this.updateUserVip=function(userId){var defer=$q.defer();return trackTiming.getUserInfo.start(),$http.post("/yws/api/self/other?method=get",{userId:userId}).success(function(value){trackTiming.getUserInfo.end().setLabel("success").send().clear(),vipList[value.userId]="true"===value.properties.isvip?!0:!1,defer.resolve()}),defer.promise},this.vipList=vipList}}),define("common/service/filePermissionService",["underscore"],function(_){"use strict";return function(launcher,permissionService,ROLES){function check(action,fileOrFiles){var group=launcher.getGroup();if(!group)return!1;if(0==group.orgId)return permissionService.check(action);var flag,isNon,isOnlyManagerEdit=!1,isOnlyManagerView=!1;"!"===action[0]&&(action=action.slice(1),isNon=!0),_.isArray(fileOrFiles)&&fileOrFiles.length>0?(isOnlyManagerEdit=_.reduce(fileOrFiles,function(memo,value){return memo||value.isOnlyManagerEdit},!1),isOnlyManagerView=_.reduce(fileOrFiles,function(memo,value){return memo||value.isOnlyManagerView},!1)):_.isObject(fileOrFiles)&&(isOnlyManagerEdit=fileOrFiles.isOnlyManagerEdit,isOnlyManagerView=fileOrFiles.isOnlyManagerView);var roles=launcher.getCurrentRole();if(-1!==roles.indexOf(ROLES.GROUP_VIEWER)||-1!==roles.indexOf(ROLES.GROUP_RESTORER))flag=permissionService.check(action);else{if(isOnlyManagerEdit)if(-1===roles.indexOf(ROLES.GROUP_FOUNDER)&&-1===roles.indexOf(ROLES.GROUP_MANAGER)){var allowedActions=["file.open","file.trace","file.preview","file.download","file.publish","file.viewShare","file.favorite","file.viewFolderProp","file.copyTo","file.export","table.trace","comment.read","comment.send","comment.reply","comment.delete"];flag=-1===allowedActions.indexOf(action)?!1:permissionService.check(action)}else flag=permissionService.check(action);isOnlyManagerView&&(flag=-1===roles.indexOf(ROLES.GROUP_FOUNDER)&&-1===roles.indexOf(ROLES.GROUP_MANAGER)?!1:permissionService.check(action)),isOnlyManagerEdit||isOnlyManagerView||(flag=permissionService.check(action))}return isNon?!flag:flag}function canView(file){var roles=launcher.getCurrentRole();return file.isOnlyManagerView&&-1===roles.indexOf(ROLES.GROUP_FOUNDER)&&-1===roles.indexOf(ROLES.GROUP_MANAGER)?!1:!0}return{check:check,canView:canView}}}),define("common/service/groupTopService",["underscore"],function(_){"use strict";return function($rootScope,storageManager,launcher,LOCAL_STORAGE_KEY){function getTopGroups(){if(storage.get(LOCAL_STORAGE_KEY.TOP_GROUPS_ARR)){var topGroupsArr=storage.get("top_groups_arr");return topGroups=_.filter(launcher.getGroups(),function(group){return _.contains(topGroupsArr,group.id)})}}function addTopGroup(group){topGroups.push(group),$rootScope.$broadcast("group.up",topGroups),storage.put(LOCAL_STORAGE_KEY.TOP_GROUPS_ARR,_.map(topGroups,function(group){return group.id}))}function delTopGroup(gid){topGroups=_.reject(topGroups,function(group){return group.id===gid}),$rootScope.$broadcast("group.up",topGroups),storage.put(LOCAL_STORAGE_KEY.TOP_GROUPS_ARR,_.map(topGroups,function(group){return group.id}))}function isTopGroup(gid){return storage.get(LOCAL_STORAGE_KEY.TOP_GROUPS_ARR)?_.contains(storage.get(LOCAL_STORAGE_KEY.TOP_GROUPS_ARR),gid):!1}var storage=storageManager.forUser(launcher.uid()),topGroups=[];$rootScope.$on("group.quit",function(evt,gid){isTopGroup(gid)&&delTopGroup(gid)}),$rootScope.$on("group.dismiss",function(evt,group){isTopGroup(group.id)&&delTopGroup(group.id)}),$rootScope.$on("org.del.groupUp",function(evt,groups){_.each(groups,function(group){delTopGroup(group.id)})}),this.getTopGroups=getTopGroups,this.addTopGroup=addTopGroup,this.delTopGroup=delTopGroup,this.isTopGroup=isTopGroup}}),define("common/service/notification",[],function(){"use strict";return function($rootScope,clientProxy,launcher){function onNotification(evt,content){if(window.Notification&&"granted"===window.Notification.permission)if(content.p2p&&content.user.userId!==launcher.getUser().userId){var options={body:content.message},n=new Notification(content.toUser,options);setTimeout(n.close.bind(n),5e3)}else if(1===content.category&&11===content.type){var options={body:content.message},n=new Notification(content.applier.userId,options);setTimeout(n.close.bind(n),5e3)}}!clientProxy.isPC()&&window.Notification&&"denied"!==Notification.permission&&Notification.requestPermission(function(){}),$rootScope.$on("socket.notification",onNotification),$rootScope.$on("socket.p2p.message",onNotification)}}),define("common/widgets/upload/selectFileService",["jquery","underscore"],function($,_){"use strict";return function($q,uploader,fileMgr,launcher){function onSelect(){0!==inputEl[0].files.length&&handler(inputEl[0].files)}function createTask(files,parameterName,batchId){return parameterName||(parameterName="file"),_.map(files,function(file){var ioTask=uploader.createTask(parameterName,file);return{upload:function(url){return ioTask.upload(url)},resumeUpload:function(url){return ioTask.resumeUpload(url)},cancel:function(){ioTask.cancel()},append:function(name,value){ioTask.append(name,value)},name:function(){return file.name.substring(file.name.lastIndexOf("/")+1)},size:function(){return file.size},batchId:batchId}})}function open(multi,parameterName,extensions){var defer=$q.defer();return multi?inputEl.attr("multiple","multiple"):inputEl.attr("multiple",null),handler=function(files){if(1===files.length)defer.resolve(createTask(files,parameterName));else{var batchId=(new Date).getTime(),tmp=_.map(files,function(v){return v});fileMgr.setBatchUploadId(launcher.gid(),batchId,files.length).then(function(){defer.resolve(createTask(tmp,parameterName,batchId))})}inputEl.val("")},extensions?inputEl.attr("accept",extensions):inputEl.removeAttr("accept"),inputEl.click(),defer.promise}var handler,inputEl=$('<input type="file"/>').css({position:"absolute",top:"-1000px",left:"-1000px"}).on("change",onSelect).appendTo(document.body);this.open=open}}),define("common/widgets/upload/selectFolderService",["jquery","underscore"],function($,_){"use strict";return function($q,$rootScope,uploader,launcher,fileManager,dialogs){function onSelect(){0!==inputEl[0].files.length&&handler(inputEl[0].files,folder)}function open(f){folder=f,inputEl.click()}function handler(files,folder){var root={name:files[0].webkitRelativePath.split("/")[0],isFile:!1,children:[]};_.each(files,function(file){var tmp=file.webkitRelativePath,path=tmp.substring(tmp.indexOf("/")+1);createFileTree(root,path,file)}),uploadId=(new Date).getTime(),uploadFolder(root,folder,!0,folderRead),inputEl.val("")}function splitPath(path){var index=path.indexOf("/");return-1!==index?{first:path.substring(0,index),last:path.substring(index+1)}:{first:path}}function createFileTree(node,path,file){if(path){var tmpNode,child=_.last(node.children),sp=splitPath(path);child&&child.name===sp.first?createFileTree(child,sp.last,file):(sp.last?tmpNode={name:sp.first,isFile:!1,children:[]}:(file.isFile=!0,tmpNode=file),node.children.push(tmpNode),createFileTree(tmpNode,sp.last,file))}}function folderRead(entry,folder){_.each(entry.children,function(entry){entry.isFile?uploadFiles([entry],folder,!0):uploadFolder(entry,folder,!1,folderRead)})}function uploadFiles(files,folder,noMsg){var tasks=_.map(files,function(file){var ioTask=uploader.createTask("filename",file);return{upload:function(url){return ioTask.upload(url)},resumeUpload:function(url){return ioTask.resumeUpload(url)},cancel:function(){ioTask.cancel()},append:function(name,value){ioTask.append(name,value)},name:function(){return file.name.substring(file.name.lastIndexOf("/")+1)},size:function(){return file.size},uploadId:uploadId}});$rootScope.$broadcast("file.drop.upload",tasks.length,uploadId),$rootScope.$broadcast("folder.drop.upload",tasks,folder,noMsg,"folder")}function uploadFolder(entry,parent,sendMsg,next){fileManager.uploadFolder(launcher.gid(),entry.name,parent,sendMsg).then(function(data){next(entry,data)}).catch(function(e){e&&20108==e.error?dialogs.confirm("上传文件",launcher.getGroup().name+"下有重名文件夹 "+entry.name+" ，是否将这两个文件夹合并",{ok:"是",cancel:"否"}).then(function(){fileManager.getFile(launcher.gid(),e.duplicateFileId).then(function(data){next(entry,data)}).catch(function(e){260==e.error&&dialogs.alert("上传文件夹","该群存在重名的隐藏/只读文件夹，无法合并。")})}):e&&260==e.error?dialogs.alert("上传文件夹","上传文件夹失败，请重试"):_.isString(e)})}var folder,uploadId,inputEl=$('<input type="file" webkitdirectory/>').css({position:"absolute",top:"-1000px",left:"-1000px"}).on("change",onSelect).appendTo(document.body);this.open=open,this.handler=handler}}),define("common/widgets/upload/h5uploader",["underscore","jquery","bower_components/util/src/cookies","util/trackTiming"],function(_,$,cookies,trackTiming){"use strict";var SUPPORT=window.XMLHttpRequest&&void 0!==(new XMLHttpRequest).upload;return function($rooScope,$interval,$q,$http){function Task(name,file,fileName){function onProgress(evt){evt.lengthComputable&&(dirty=!0,loaded=evt.loaded/evt.total*file.size,total=file.size)}function checkProgress(){dirty&&(deferred.notify({sent:loaded,total:total,file:file}),dirty=!1)}function onFailed(){$interval.cancel(interval),$rooScope.$apply(function(){deferred.reject({status:xhr.status,text:xhr.responseText,file:file,fileName:fileName})})}function onResumeReadyStateChange(){function checkUpload(transmitId){trackTiming.checkUpload.start(),$http({method:"POST",url:addCstkParam(uploadUrl),params:{transmitId:transmitId},headers:{"Content-Range":"bytes */*"}}).success(function(data,status,headers){if(trackTiming.checkUpload.end().setLabel("success").send().clear(),successCount++,!(successCount>1)){var range=headers().range,endPosition=0/0;tryCount=0,intervalTime=1e3,clearTimeout(check),_.isUndefined(range)||_.isUndefined(range.match(/0-(\d*)/)[1])||(endPosition=parseInt(range.match(/0-(\d*)/)[1])),isNaN(endPosition)?doUpload(uploadUrl,transmitId,!0):endPosition+1===file.size?onSuccess(transmitId):continueUpload(transmitId,endPosition)}}).error(function(e){if(trackTiming.checkUpload.end().setLabel("error").send().clear(),e.error)switch(e.error){case"244":startResumeUpload(urls)}else 128e3>intervalTime&&(intervalTime*=2),200>=tryCount&&(check=setTimeout(function(){processUpload(transmitId)},intervalTime))})}function continueUpload(transmitId,endPosition){var url=addCstkParam(uploadUrl)+"&transmitId="+transmitId;continueXhr.open("POST",url),continueXhr.setRequestHeader("Content-Range","bytes "+(endPosition+1)+"-"+(file.size-1)+"/"+file.size),file.type&&continueXhr.setRequestHeader("Content-Type",file.type),upload=continueXhr.upload,upload.addEventListener("progress",onProgress),continueXhr.onreadystatechange=onResumeReadyStateChange,continueXhr.send(file.slice(endPosition+1)),loaded=endPosition+1,total=file.size,interval=$interval(checkProgress,100)}function processUpload(transmitId){return tryCount>=200?(clearTimeout(check),void deferred.reject({text:"network error"})):(tryCount++,void checkUpload(transmitId))}function attachmentComplete(url,transmitId){var defer=$q.defer();return trackTiming.completeUpload.start(),$http.post(url,null,{params:{transmitId:transmitId,resourceName:file.name?file.name:"截图.png",resourceType:/image/.test(file.type)?1:2}}).success(function(response){trackTiming.completeUpload.end().setLabel("success").send().clear(),defer.resolve(response)}).error(function(e){trackTiming.completeUpload.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise}function onSuccess(transmitId){function setResponseText(responseText){deferred.notify({sent:total,total:total,file:file}),deferred.resolve({file:file,text:responseText})}/file/.test(uploadUrl)?setResponseText('{"TransmitId" : "'+transmitId+'"}'):attachmentComplete(urls[2],transmitId).then(function(responseText){setResponseText(responseText)},function(e){deferred.reject(e)})}var check,successCount=0;4===xhr.readyState&&$rooScope.$apply(function(){xhr.responseURL&&(transmitId=xhr.responseURL.match(/transmitId=(.*)/)[1]),xhr.status>=200&&xhr.status<400?($interval.cancel(interval),userCancel?deferred.reject(null):onSuccess(transmitId)):xhr.status>=400?($interval.cancel(interval),processUpload(transmitId)):0===xhr.status&&(userCancel?($interval.cancel(interval),deferred.reject(null)):($interval.cancel(interval),processUpload(transmitId)))})}function addCstkParam(url){return url+=-1!==url.indexOf("?")?"&cstk="+cookies.get("YNOTE_CSTK"):"?cstk="+cookies.get("YNOTE_CSTK")}function getUploadUrl(url,size,parentId){var defer=$q.defer();return trackTiming.startUpload.start(),$http({method:"POST",url:url,headers:{"File-Size":size},data:{parentId:parentId},transformResponse:function(result){return{transmitId:result}}}).success(function(data,status,headers){trackTiming.startUpload.end().setLabel("success").send().clear(),defer.resolve(headers().location)}).error(function(e){trackTiming.startUpload.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise}function doUpload(url,transmitId){url=addCstkParam(url)+"&transmitId="+transmitId,xhr.open("POST",url),file.type&&xhr.setRequestHeader("Content-Type",file.type),upload=xhr.upload,upload.addEventListener("progress",onProgress),xhr.onreadystatechange=onResumeReadyStateChange,xhr.send(file),loaded=0,total=file.size,interval=$interval(checkProgress,100)}function startResumeUpload(url,parentId){return deferred=$q.defer(),urls=url,uploadUrl=url[1],userCancel=!1,tryCount=0,getUploadUrl(url[0],file.size,parentId).then(function(uploadPath){transmitId=uploadPath.match(/\/(file|noteresource)\/(.*)/)[2],doUpload(uploadUrl,transmitId)}).catch(function(e){deferred.reject(e)}),deferred.promise}function onReadyStateChange(){4===xhr.readyState&&$rooScope.$apply(function(){xhr.status>=200&&xhr.status<400?($interval.cancel(interval),deferred.notify({sent:total,total:total,file:file}),deferred.resolve({file:file,text:xhr.responseText})):xhr.status>=400?($interval.cancel(interval),deferred.reject({status:xhr.status,text:xhr.responseText,file:file,fileName:fileName})):0===xhr.status&&($interval.cancel(interval),deferred.reject({status:xhr.status,file:file,fileName:fileName}))})}function startUpload(url){url=addCstkParam(url),xhr.open("POST",url),deferred=$q.defer();var upload=xhr.upload;return upload.addEventListener("progress",onProgress),upload.addEventListener("error",onFailed),xhr.onreadystatechange=onReadyStateChange,xhr.send(formData),loaded=0,total=file.size,interval=$interval(checkProgress,100),deferred.promise}if(!SUPPORT)throw"Browser do not support XMLHttpRequest2 for upload.";var deferred,loaded,total,interval,uploadUrl,urls,transmitId,upload,formData=new FormData,xhr=new XMLHttpRequest,continueXhr=new XMLHttpRequest,dirty=!0,userCancel=!1,intervalTime=1e3,tryCount=0;this.resumeUpload=function(url,parentId){if(void 0!==deferred)throw"FormData has been uploaded.";return startResumeUpload(url,parentId)},this.upload=function(url){if(void 0!==deferred)throw"FormData has been uploaded.";return startUpload(url)},this.append=function(name,value){return formData.append(name,value),this},this.cancel=function(){if(void 0===deferred)throw"Invalid state";$interval.cancel(interval),userCancel=!0,setTimeout(function(){xhr.abort(),continueXhr.abort()},1)},fileName?formData.append(name,file,fileName):formData.append(name,file)}this.createTask=function(name,file,fileName){return new Task(name,file,fileName)},this.isSupport=function(){return SUPPORT}}});var SWFUpload,swfobject;void 0==SWFUpload&&(SWFUpload=window.SWFUpload=function(settings){this.initSWFUpload(settings)}),SWFUpload.prototype.initSWFUpload=function(userSettings){try{this.customSettings={},this.settings={},this.eventQueue=[],this.movieName="SWFUpload_"+SWFUpload.movieCount++,this.movieElement=null,SWFUpload.instances[this.movieName]=this,this.initSettings(userSettings),this.loadSupport(),this.swfuploadPreload()&&this.loadFlash(),this.displayDebugInfo()}catch(ex){throw delete SWFUpload.instances[this.movieName],ex}},SWFUpload.instances={},SWFUpload.movieCount=0,SWFUpload.version="2.5.0 2010-01-15 Beta 2",SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130},SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290,RESIZE:-300},SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5},SWFUpload.UPLOAD_TYPE={NORMAL:-1,RESIZED:-2},SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120,JAVASCRIPT:-130,NONE:-130},SWFUpload.CURSOR={ARROW:-1,HAND:-2},SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"},SWFUpload.RESIZE_ENCODING={JPEG:-1,PNG:-2},SWFUpload.completeURL=function(url){try{var path="",indexSlash=-1;return"string"!=typeof url||url.match(/^https?:\/\//i)||url.match(/^\//)||""===url?url:(indexSlash=window.location.pathname.lastIndexOf("/"),path=0>=indexSlash?"/":window.location.pathname.substr(0,indexSlash)+"/",path+url)}catch(ex){return url}},SWFUpload.onload=function(){},SWFUpload.prototype.initSettings=function(userSettings){this.ensureDefault=function(settingName,defaultValue){var setting=userSettings[settingName];this.settings[settingName]=void 0!=setting?setting:defaultValue},this.ensureDefault("upload_url",""),this.ensureDefault("preserve_relative_urls",!1),this.ensureDefault("file_post_name","Filedata"),this.ensureDefault("post_params",{}),this.ensureDefault("use_query_string",!1),this.ensureDefault("requeue_on_error",!1),this.ensureDefault("http_success",[]),this.ensureDefault("assume_success_timeout",0),this.ensureDefault("file_types","*.*"),this.ensureDefault("file_types_description","All Files"),this.ensureDefault("file_size_limit",0),this.ensureDefault("file_upload_limit",0),this.ensureDefault("file_queue_limit",0),this.ensureDefault("flash_url","swfupload.swf"),this.ensureDefault("flash9_url","swfupload_fp9.swf"),this.ensureDefault("prevent_swf_caching",!0),this.ensureDefault("button_image_url",""),this.ensureDefault("button_width",1),this.ensureDefault("button_height",1),this.ensureDefault("button_text",""),this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;"),this.ensureDefault("button_text_top_padding",0),this.ensureDefault("button_text_left_padding",0),this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES),this.ensureDefault("button_disabled",!1),this.ensureDefault("button_placeholder_id",""),this.ensureDefault("button_placeholder",null),this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW),this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW),this.ensureDefault("debug",!1),this.settings.debug_enabled=this.settings.debug,this.settings.return_upload_start_handler=this.returnUploadStart,this.ensureDefault("swfupload_preload_handler",null),this.ensureDefault("swfupload_load_failed_handler",null),this.ensureDefault("swfupload_loaded_handler",null),this.ensureDefault("file_dialog_start_handler",null),this.ensureDefault("file_queued_handler",null),this.ensureDefault("file_queue_error_handler",null),this.ensureDefault("file_dialog_complete_handler",null),this.ensureDefault("upload_resize_start_handler",null),this.ensureDefault("upload_start_handler",null),this.ensureDefault("upload_progress_handler",null),this.ensureDefault("upload_error_handler",null),this.ensureDefault("upload_success_handler",null),this.ensureDefault("upload_complete_handler",null),this.ensureDefault("mouse_click_handler",null),this.ensureDefault("mouse_out_handler",null),this.ensureDefault("mouse_over_handler",null),this.ensureDefault("debug_handler",this.debugMessage),this.ensureDefault("custom_settings",{}),this.customSettings=this.settings.custom_settings,this.settings.prevent_swf_caching&&(this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+(new Date).getTime(),this.settings.flash9_url=this.settings.flash9_url+(this.settings.flash9_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+(new Date).getTime()),this.settings.preserve_relative_urls||(this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url),this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)),delete this.ensureDefault},SWFUpload.prototype.loadSupport=function(){this.support={loading:swfobject.hasFlashPlayerVersion("9.0.28"),imageResize:swfobject.hasFlashPlayerVersion("10.0.0")}},SWFUpload.prototype.loadFlash=function(){var targetElement,tempParent,wrapperType,flashHTML,els;if(!this.support.loading)return void this.queueEvent("swfupload_load_failed_handler",["Flash Player doesn't support SWFUpload"]);if(null!==document.getElementById(this.movieName))return this.support.loading=!1,void this.queueEvent("swfupload_load_failed_handler",["Element ID already in use"]);if(targetElement=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder,void 0==targetElement)return this.support.loading=!1,void this.queueEvent("swfupload_load_failed_handler",["button place holder not found"]);wrapperType="block"!==(targetElement.currentStyle&&targetElement.currentStyle.display||window.getComputedStyle&&document.defaultView.getComputedStyle(targetElement,null).getPropertyValue("display"))?"span":"div",tempParent=document.createElement(wrapperType),flashHTML=this.getFlashHTML();try{tempParent.innerHTML=flashHTML}catch(ex){return this.support.loading=!1,void this.queueEvent("swfupload_load_failed_handler",["Exception loading Flash HTML into placeholder"])}return els=tempParent.getElementsByTagName("object"),!els||els.length>1||0===els.length?(this.support.loading=!1,void this.queueEvent("swfupload_load_failed_handler",["Unable to find movie after adding to DOM"])):(1===els.length&&(this.movieElement=els[0]),targetElement.parentNode.replaceChild(tempParent.firstChild,targetElement),void(void 0==window[this.movieName]&&(window[this.movieName]=this.getMovieElement())))},SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.support.imageResize?this.settings.flash_url:this.settings.flash9_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.support.imageResize?this.settings.flash_url:this.settings.flash9_url,'" />','<param name="quality" value="high" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")},SWFUpload.prototype.getFlashVars=function(){var httpSuccessString,paramString;return paramString=this.buildParamString(),httpSuccessString=this.settings.http_success.join(","),["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(httpSuccessString),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(paramString),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")},SWFUpload.prototype.getMovieElement=function(){if(void 0==this.movieElement&&(this.movieElement=document.getElementById(this.movieName)),null===this.movieElement)throw"Could not find Flash element";return this.movieElement},SWFUpload.prototype.buildParamString=function(){var name,postParams,paramStringPairs=[];if(postParams=this.settings.post_params,"object"==typeof postParams)for(name in postParams)postParams.hasOwnProperty(name)&&paramStringPairs.push(encodeURIComponent(name.toString())+"="+encodeURIComponent(postParams[name].toString()));return paramStringPairs.join("&amp;")},SWFUpload.prototype.destroy=function(){var movieElement;try{if(this.cancelUpload(null,!1),movieElement=this.cleanUp())try{movieElement.parentNode.removeChild(movieElement)}catch(ex){}return window[this.movieName]=null,SWFUpload.instances[this.movieName]=null,delete SWFUpload.instances[this.movieName],this.movieElement=null,this.settings=null,this.customSettings=null,this.eventQueue=null,this.movieName=null,!0}catch(ex2){return!1}},SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","	","upload_url:               ",this.settings.upload_url,"\n","	","flash_url:                ",this.settings.flash_url,"\n","	","flash9_url:                ",this.settings.flash9_url,"\n","	","use_query_string:         ",this.settings.use_query_string.toString(),"\n","	","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","	","http_success:             ",this.settings.http_success.join(", "),"\n","	","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","	","file_post_name:           ",this.settings.file_post_name,"\n","	","post_params:              ",this.settings.post_params.toString(),"\n","	","file_types:               ",this.settings.file_types,"\n","	","file_types_description:   ",this.settings.file_types_description,"\n","	","file_size_limit:          ",this.settings.file_size_limit,"\n","	","file_upload_limit:        ",this.settings.file_upload_limit,"\n","	","file_queue_limit:         ",this.settings.file_queue_limit,"\n","	","debug:                    ",this.settings.debug.toString(),"\n","	","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","	","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","	","button_placeholder:       ",this.settings.button_placeholder?"Set":"Not Set","\n","	","button_image_url:         ",this.settings.button_image_url.toString(),"\n","	","button_width:             ",this.settings.button_width.toString(),"\n","	","button_height:            ",this.settings.button_height.toString(),"\n","	","button_text:              ",this.settings.button_text.toString(),"\n","	","button_text_style:        ",this.settings.button_text_style.toString(),"\n","	","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","	","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","	","button_action:            ",this.settings.button_action.toString(),"\n","	","button_cursor:            ",this.settings.button_cursor.toString(),"\n","	","button_disabled:          ",this.settings.button_disabled.toString(),"\n","	","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","	","swfupload_preload_handler assigned:  ",("function"==typeof this.settings.swfupload_preload_handler).toString(),"\n","	","swfupload_load_failed_handler assigned:  ",("function"==typeof this.settings.swfupload_load_failed_handler).toString(),"\n","	","swfupload_loaded_handler assigned:  ",("function"==typeof this.settings.swfupload_loaded_handler).toString(),"\n","	","mouse_click_handler assigned:       ",("function"==typeof this.settings.mouse_click_handler).toString(),"\n","	","mouse_over_handler assigned:        ",("function"==typeof this.settings.mouse_over_handler).toString(),"\n","	","mouse_out_handler assigned:         ",("function"==typeof this.settings.mouse_out_handler).toString(),"\n","	","file_dialog_start_handler assigned: ",("function"==typeof this.settings.file_dialog_start_handler).toString(),"\n","	","file_queued_handler assigned:       ",("function"==typeof this.settings.file_queued_handler).toString(),"\n","	","file_queue_error_handler assigned:  ",("function"==typeof this.settings.file_queue_error_handler).toString(),"\n","	","upload_resize_start_handler assigned:      ",("function"==typeof this.settings.upload_resize_start_handler).toString(),"\n","	","upload_start_handler assigned:      ",("function"==typeof this.settings.upload_start_handler).toString(),"\n","	","upload_progress_handler assigned:   ",("function"==typeof this.settings.upload_progress_handler).toString(),"\n","	","upload_error_handler assigned:      ",("function"==typeof this.settings.upload_error_handler).toString(),"\n","	","upload_success_handler assigned:    ",("function"==typeof this.settings.upload_success_handler).toString(),"\n","	","upload_complete_handler assigned:   ",("function"==typeof this.settings.upload_complete_handler).toString(),"\n","	","debug_handler assigned:             ",("function"==typeof this.settings.debug_handler).toString(),"\n","Support:\n","	","Load:                     ",this.support.loading?"Yes":"No","\n","	","Image Resize:             ",this.support.imageResize?"Yes":"No","\n"].join(""))
},SWFUpload.prototype.addSetting=function(name,value,default_value){return this.settings[name]=void 0==value?default_value:value},SWFUpload.prototype.getSetting=function(name){return void 0!=this.settings[name]?this.settings[name]:""},SWFUpload.prototype.callFlash=function(functionName,argumentArray){var movieElement,returnValue,returnString;argumentArray=argumentArray||[],movieElement=this.getMovieElement();try{void 0!=movieElement?(returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>"),returnValue=eval(returnString)):this.debug("Can't call flash because the movie wasn't found.")}catch(ex){this.debug("Exception calling flash function '"+functionName+"': "+ex.message)}return void 0!=returnValue&&"object"==typeof returnValue.post&&(returnValue=this.unescapeFilePostParams(returnValue)),returnValue},SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")},SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")},SWFUpload.prototype.startUpload=function(fileID){this.callFlash("StartUpload",[fileID])},SWFUpload.prototype.startResizedUpload=function(fileID,width,height,encoding,quality,allowEnlarging){this.callFlash("StartUpload",[fileID,{width:width,height:height,encoding:encoding,quality:quality,allowEnlarging:allowEnlarging}])},SWFUpload.prototype.cancelUpload=function(fileID,triggerErrorEvent){triggerErrorEvent!==!1&&(triggerErrorEvent=!0),this.callFlash("CancelUpload",[fileID,triggerErrorEvent])},SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")},SWFUpload.prototype.requeueUpload=function(indexOrFileID){return this.callFlash("RequeueUpload",[indexOrFileID])},SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")},SWFUpload.prototype.setStats=function(statsObject){this.callFlash("SetStats",[statsObject])},SWFUpload.prototype.getFile=function(fileID){return"number"==typeof fileID?this.callFlash("GetFileByIndex",[fileID]):this.callFlash("GetFile",[fileID])},SWFUpload.prototype.getQueueFile=function(fileID){return"number"==typeof fileID?this.callFlash("GetFileByQueueIndex",[fileID]):this.callFlash("GetFile",[fileID])},SWFUpload.prototype.addFileParam=function(fileID,name,value){return this.callFlash("AddFileParam",[fileID,name,value])},SWFUpload.prototype.removeFileParam=function(fileID,name){this.callFlash("RemoveFileParam",[fileID,name])},SWFUpload.prototype.setUploadURL=function(url){this.settings.upload_url=url.toString(),this.callFlash("SetUploadURL",[url])},SWFUpload.prototype.setPostParams=function(paramsObject){this.settings.post_params=paramsObject,this.callFlash("SetPostParams",[paramsObject])},SWFUpload.prototype.addPostParam=function(name,value){this.settings.post_params[name]=value,this.callFlash("SetPostParams",[this.settings.post_params])},SWFUpload.prototype.removePostParam=function(name){delete this.settings.post_params[name],this.callFlash("SetPostParams",[this.settings.post_params])},SWFUpload.prototype.setFileTypes=function(types,description){this.settings.file_types=types,this.settings.file_types_description=description,this.callFlash("SetFileTypes",[types,description])},SWFUpload.prototype.setFileSizeLimit=function(fileSizeLimit){this.settings.file_size_limit=fileSizeLimit,this.callFlash("SetFileSizeLimit",[fileSizeLimit])},SWFUpload.prototype.setFileUploadLimit=function(fileUploadLimit){this.settings.file_upload_limit=fileUploadLimit,this.callFlash("SetFileUploadLimit",[fileUploadLimit])},SWFUpload.prototype.setFileQueueLimit=function(fileQueueLimit){this.settings.file_queue_limit=fileQueueLimit,this.callFlash("SetFileQueueLimit",[fileQueueLimit])},SWFUpload.prototype.setFilePostName=function(filePostName){this.settings.file_post_name=filePostName,this.callFlash("SetFilePostName",[filePostName])},SWFUpload.prototype.setUseQueryString=function(useQueryString){this.settings.use_query_string=useQueryString,this.callFlash("SetUseQueryString",[useQueryString])},SWFUpload.prototype.setRequeueOnError=function(requeueOnError){this.settings.requeue_on_error=requeueOnError,this.callFlash("SetRequeueOnError",[requeueOnError])},SWFUpload.prototype.setHTTPSuccess=function(http_status_codes){"string"==typeof http_status_codes&&(http_status_codes=http_status_codes.replace(" ","").split(",")),this.settings.http_success=http_status_codes,this.callFlash("SetHTTPSuccess",[http_status_codes])},SWFUpload.prototype.setAssumeSuccessTimeout=function(timeout_seconds){this.settings.assume_success_timeout=timeout_seconds,this.callFlash("SetAssumeSuccessTimeout",[timeout_seconds])},SWFUpload.prototype.setDebugEnabled=function(debugEnabled){this.settings.debug_enabled=debugEnabled,this.callFlash("SetDebugEnabled",[debugEnabled])},SWFUpload.prototype.setButtonImageURL=function(buttonImageURL){void 0==buttonImageURL&&(buttonImageURL=""),this.settings.button_image_url=buttonImageURL,this.callFlash("SetButtonImageURL",[buttonImageURL])},SWFUpload.prototype.setButtonDimensions=function(width,height){this.settings.button_width=width,this.settings.button_height=height;var movie=this.getMovieElement();void 0!=movie&&(movie.style.width=width+"px",movie.style.height=height+"px"),this.callFlash("SetButtonDimensions",[width,height])},SWFUpload.prototype.setButtonText=function(html){this.settings.button_text=html,this.callFlash("SetButtonText",[html])},SWFUpload.prototype.setButtonTextPadding=function(left,top){this.settings.button_text_top_padding=top,this.settings.button_text_left_padding=left,this.callFlash("SetButtonTextPadding",[left,top])},SWFUpload.prototype.setButtonTextStyle=function(css){this.settings.button_text_style=css,this.callFlash("SetButtonTextStyle",[css])},SWFUpload.prototype.setButtonDisabled=function(isDisabled){this.settings.button_disabled=isDisabled,this.callFlash("SetButtonDisabled",[isDisabled])},SWFUpload.prototype.setButtonAction=function(buttonAction){this.settings.button_action=buttonAction,this.callFlash("SetButtonAction",[buttonAction])},SWFUpload.prototype.setButtonCursor=function(cursor){this.settings.button_cursor=cursor,this.callFlash("SetButtonCursor",[cursor])},SWFUpload.prototype.queueEvent=function(handlerName,argumentArray){var self=this;if(void 0==argumentArray?argumentArray=[]:argumentArray instanceof Array||(argumentArray=[argumentArray]),"function"==typeof this.settings[handlerName])this.eventQueue.push(function(){this.settings[handlerName].apply(this,argumentArray)}),setTimeout(function(){self.executeNextEvent()},0);else if(null!==this.settings[handlerName])throw"Event handler "+handlerName+" is unknown or is not a function"},SWFUpload.prototype.executeNextEvent=function(){var f=this.eventQueue?this.eventQueue.shift():null;"function"==typeof f&&f.apply(this)},SWFUpload.prototype.unescapeFilePostParams=function(file){var uk,k,match,reg=/[$]([0-9a-f]{4})/i,unescapedPost={};if(void 0!=file){for(k in file.post)if(file.post.hasOwnProperty(k)){for(uk=k;null!==(match=reg.exec(uk));)uk=uk.replace(match[0],String.fromCharCode(parseInt("0x"+match[1],16)));unescapedPost[uk]=file.post[k]}file.post=unescapedPost}return file},SWFUpload.prototype.swfuploadPreload=function(){var returnValue;if("function"==typeof this.settings.swfupload_preload_handler)returnValue=this.settings.swfupload_preload_handler.call(this);else if(void 0!=this.settings.swfupload_preload_handler)throw"upload_start_handler must be a function";return void 0===returnValue&&(returnValue=!0),!!returnValue},SWFUpload.prototype.flashReady=function(){var movieElement=this.cleanUp();return movieElement?void this.queueEvent("swfupload_loaded_handler"):void this.debug("Flash called back ready but the flash movie can't be found.")},SWFUpload.prototype.cleanUp=function(){var key,movieElement=this.getMovieElement();try{if(movieElement&&"unknown"==typeof movieElement.CallFunction){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(key in movieElement)try{"function"==typeof movieElement[key]&&key[0]<="Z"&&(movieElement[key]=null)}catch(ex){}}}catch(ex1){}return window.__flash__removeCallback=function(instance,name){try{instance&&(instance[name]=null)}catch(flashEx){}},movieElement},SWFUpload.prototype.mouseClick=function(){this.queueEvent("mouse_click_handler")},SWFUpload.prototype.mouseOver=function(){this.queueEvent("mouse_over_handler")},SWFUpload.prototype.mouseOut=function(){this.queueEvent("mouse_out_handler")},SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")},SWFUpload.prototype.fileQueued=function(file){file=this.unescapeFilePostParams(file),this.queueEvent("file_queued_handler",file)},SWFUpload.prototype.fileQueueError=function(file,errorCode,message){file=this.unescapeFilePostParams(file),this.queueEvent("file_queue_error_handler",[file,errorCode,message])},SWFUpload.prototype.fileDialogComplete=function(numFilesSelected,numFilesQueued,numFilesInQueue){this.queueEvent("file_dialog_complete_handler",[numFilesSelected,numFilesQueued,numFilesInQueue])},SWFUpload.prototype.uploadResizeStart=function(file,resizeSettings){file=this.unescapeFilePostParams(file),this.queueEvent("upload_resize_start_handler",[file,resizeSettings.width,resizeSettings.height,resizeSettings.encoding,resizeSettings.quality])},SWFUpload.prototype.uploadStart=function(file){file=this.unescapeFilePostParams(file),this.queueEvent("return_upload_start_handler",file)},SWFUpload.prototype.returnUploadStart=function(file){var returnValue;if("function"==typeof this.settings.upload_start_handler)file=this.unescapeFilePostParams(file),returnValue=this.settings.upload_start_handler.call(this,file);else if(void 0!=this.settings.upload_start_handler)throw"upload_start_handler must be a function";void 0===returnValue&&(returnValue=!0),returnValue=!!returnValue,this.callFlash("ReturnUploadStart",[returnValue])},SWFUpload.prototype.uploadProgress=function(file,bytesComplete,bytesTotal){file=this.unescapeFilePostParams(file),this.queueEvent("upload_progress_handler",[file,bytesComplete,bytesTotal])},SWFUpload.prototype.uploadError=function(file,errorCode,message){file=this.unescapeFilePostParams(file),this.queueEvent("upload_error_handler",[file,errorCode,message])},SWFUpload.prototype.uploadSuccess=function(file,serverData,responseReceived){file=this.unescapeFilePostParams(file),this.queueEvent("upload_success_handler",[file,serverData,responseReceived])},SWFUpload.prototype.uploadComplete=function(file){file=this.unescapeFilePostParams(file),this.queueEvent("upload_complete_handler",file)},SWFUpload.prototype.debug=function(message){this.queueEvent("debug_handler",message)},SWFUpload.prototype.debugMessage=function(message){var exceptionMessage,exceptionValues,key;if(this.settings.debug)if(exceptionValues=[],"object"==typeof message&&"string"==typeof message.name&&"string"==typeof message.message){for(key in message)message.hasOwnProperty(key)&&exceptionValues.push(key+": "+message[key]);exceptionMessage=exceptionValues.join("\n")||"",exceptionValues=exceptionMessage.split("\n"),exceptionMessage="EXCEPTION: "+exceptionValues.join("\nEXCEPTION: "),SWFUpload.Console.writeLine(exceptionMessage)}else SWFUpload.Console.writeLine(message)},SWFUpload.Console={},SWFUpload.Console.writeLine=function(message){var console,documentForm;try{console=document.getElementById("SWFUpload_Console"),console||(documentForm=document.createElement("form"),document.getElementsByTagName("body")[0].appendChild(documentForm),console=document.createElement("textarea"),console.id="SWFUpload_Console",console.style.fontFamily="monospace",console.setAttribute("wrap","off"),console.wrap="off",console.style.overflow="auto",console.style.width="700px",console.style.height="350px",console.style.margin="5px",documentForm.appendChild(console)),console.value+=message+"\n",console.scrollTop=console.scrollHeight-console.clientHeight}catch(ex){alert("Exception: "+ex.name+" Message: "+ex.message)}},swfobject=window.swfobject=function(){function f(){if(!J){try{var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));Z.parentNode.removeChild(Z)}catch(aa){return}J=!0;for(var X=U.length,Y=0;X>Y;Y++)U[Y]()}}function K(X){J?X():U[U.length]=X}function s(Y){if(typeof O.addEventListener!=D)O.addEventListener("load",Y,!1);else if(typeof j.addEventListener!=D)j.addEventListener("load",Y,!1);else if(typeof O.attachEvent!=D)i(O,"onload",Y);else if("function"==typeof O.onload){var X=O.onload;O.onload=function(){X(),Y()}}else O.onload=Y}function h(){T?V():H()}function V(){var X=j.getElementsByTagName("body")[0],aa=C(r);aa.setAttribute("type",q);var Z=X.appendChild(aa);if(Z){var Y=0;!function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");ab&&(ab=ab.split(" ")[1].split(","),M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)])}else if(10>Y)return Y++,void setTimeout(arguments.callee,10);X.removeChild(aa),Z=null,H()}()}else H()}function H(){var ag=o.length;if(ag>0)for(var af=0;ag>af;af++){var Y=o[af].id,ab=o[af].callbackFn,aa={success:!1,id:Y};if(M.pv[0]>0){var ae=c(Y);if(ae)if(!F(o[af].swfVersion)||M.wk&&M.wk<312)if(o[af].expressInstall&&A()){var ai={};ai.data=o[af].expressInstall,ai.width=ae.getAttribute("width")||"0",ai.height=ae.getAttribute("height")||"0",ae.getAttribute("class")&&(ai.styleclass=ae.getAttribute("class")),ae.getAttribute("align")&&(ai.align=ae.getAttribute("align"));for(var ah={},X=ae.getElementsByTagName("param"),ac=X.length,ad=0;ac>ad;ad++)"movie"!=X[ad].getAttribute("name").toLowerCase()&&(ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value"));P(ai,ah,Y,ab)}else p(ae),ab&&ab(aa);else w(Y,!0),ab&&(aa.success=!0,aa.ref=z(Y),ab(aa))}else if(w(Y,!0),ab){var Z=z(Y);Z&&typeof Z.SetVariable!=D&&(aa.success=!0,aa.ref=Z),ab(aa)}}}function z(aa){var X=null,Y=c(aa);if(Y&&"OBJECT"==Y.nodeName)if(typeof Y.SetVariable!=D)X=Y;else{var Z=Y.getElementsByTagName(r)[0];Z&&(X=Z)}return X}function A(){return!a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312)}function P(aa,ab,X,Z){a=!0,E=Z||null,B={success:!1,id:X};var ae=c(X);if(ae){"OBJECT"==ae.nodeName?(l=g(ae),Q=null):(l=ae,Q=X),aa.id=R,(typeof aa.width==D||!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)&&(aa.width="310"),(typeof aa.height==D||!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)&&(aa.height="137"),j.title=j.title.slice(0,47)+" - Flash Player Installation";var ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;if(typeof ab.flashvars!=D?ab.flashvars+="&"+ac:ab.flashvars=ac,M.ie&&M.win&&4!=ae.readyState){var Y=C("div");X+="SWFObjectNew",Y.setAttribute("id",X),ae.parentNode.insertBefore(Y,ae),ae.style.display="none",function(){4==ae.readyState?ae.parentNode.removeChild(ae):setTimeout(arguments.callee,10)}()}u(aa,ab,X)}}function p(Y){if(M.ie&&M.win&&4!=Y.readyState){var X=C("div");Y.parentNode.insertBefore(X,Y),X.parentNode.replaceChild(g(Y),X),Y.style.display="none",function(){4==Y.readyState?Y.parentNode.removeChild(Y):setTimeout(arguments.callee,10)}()}else Y.parentNode.replaceChild(g(Y),Y)}function g(ab){var aa=C("div");if(M.win&&M.ie)aa.innerHTML=ab.innerHTML;else{var Y=ab.getElementsByTagName(r)[0];if(Y){var ad=Y.childNodes;if(ad)for(var X=ad.length,Z=0;X>Z;Z++)1==ad[Z].nodeType&&"PARAM"==ad[Z].nodeName||8==ad[Z].nodeType||aa.appendChild(ad[Z].cloneNode(!0))}}return aa}function u(ai,ag,Y){var X,aa=c(Y);if(M.wk&&M.wk<312)return X;if(aa)if(typeof ai.id==D&&(ai.id=Y),M.ie&&M.win){var ah="";for(var ae in ai)ai[ae]!=Object.prototype[ae]&&("data"==ae.toLowerCase()?ag.movie=ai[ae]:"styleclass"==ae.toLowerCase()?ah+=' class="'+ai[ae]+'"':"classid"!=ae.toLowerCase()&&(ah+=" "+ae+'="'+ai[ae]+'"'));var af="";for(var ad in ag)ag[ad]!=Object.prototype[ad]&&(af+='<param name="'+ad+'" value="'+ag[ad]+'" />');aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>",N[N.length]=ai.id,X=c(ai.id)}else{var Z=C(r);Z.setAttribute("type",q);for(var ac in ai)ai[ac]!=Object.prototype[ac]&&("styleclass"==ac.toLowerCase()?Z.setAttribute("class",ai[ac]):"classid"!=ac.toLowerCase()&&Z.setAttribute(ac,ai[ac]));for(var ab in ag)ag[ab]!=Object.prototype[ab]&&"movie"!=ab.toLowerCase()&&e(Z,ab,ag[ab]);aa.parentNode.replaceChild(Z,aa),X=Z}return X}function e(Z,X,Y){var aa=C("param");aa.setAttribute("name",X),aa.setAttribute("value",Y),Z.appendChild(aa)}function y(Y){var X=c(Y);X&&"OBJECT"==X.nodeName&&(M.ie&&M.win?(X.style.display="none",function(){4==X.readyState?b(Y):setTimeout(arguments.callee,10)}()):X.parentNode.removeChild(X))}function b(Z){var Y=c(Z);if(Y){for(var X in Y)"function"==typeof Y[X]&&(Y[X]=null);Y.parentNode.removeChild(Y)}}function c(Z){var X=null;try{X=j.getElementById(Z)}catch(Y){}return X}function C(X){return j.createElement(X)}function i(Z,X,Y){Z.attachEvent(X,Y),I[I.length]=[Z,X,Y]}function F(Z){var Y=M.pv,X=Z.split(".");return X[0]=parseInt(X[0],10),X[1]=parseInt(X[1],10)||0,X[2]=parseInt(X[2],10)||0,Y[0]>X[0]||Y[0]==X[0]&&Y[1]>X[1]||Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]?!0:!1}function v(ac,Y,ad,ab){if(!M.ie||!M.mac){var aa=j.getElementsByTagName("head")[0];if(aa){var X=ad&&"string"==typeof ad?ad:"screen";if(ab&&(n=null,G=null),!n||G!=X){var Z=C("style");Z.setAttribute("type","text/css"),Z.setAttribute("media",X),n=aa.appendChild(Z),M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0&&(n=j.styleSheets[j.styleSheets.length-1]),G=X}M.ie&&M.win?n&&typeof n.addRule==r&&n.addRule(ac,Y):n&&typeof j.createTextNode!=D&&n.appendChild(j.createTextNode(ac+" {"+Y+"}"))}}}function w(Z,X){if(m){var Y=X?"visible":"hidden";J&&c(Z)?c(Z).style.visibility=Y:v("#"+Z,"visibility:"+Y)}}function L(Y){var Z=/[\\\"<>\.;]/,X=null!=Z.exec(Y);return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y}{var l,Q,E,B,n,G,D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=!1,U=[h],o=[],N=[],I=[],J=!1,a=!1,m=!0,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=/win/.test(Y?Y:ah),ac=/mac/.test(Y?Y:ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,X=!1,ag=[0,0,0],ab=null;if(typeof t.plugins!=D&&typeof t.plugins[S]==r)ab=t.plugins[S].description,!ab||typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin||(T=!0,X=!1,ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10),ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10),ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof O.ActiveXObject!=D)try{var ad=new ActiveXObject(W);ad&&(ab=ad.GetVariable("$version"),ab&&(X=!0,ab=ab.split(" ")[1].split(","),ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]))}catch(Z){}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac}}();!function(){M.w3&&((typeof j.readyState!=D&&"complete"==j.readyState||typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))&&f(),J||(typeof j.addEventListener!=D&&j.addEventListener("DOMContentLoaded",f,!1),M.ie&&M.win&&(j.attachEvent(x,function(){"complete"==j.readyState&&(j.detachEvent(x,arguments.callee),f())}),O==top&&!function(){if(!J){try{j.documentElement.doScroll("left")}catch(X){return void setTimeout(arguments.callee,0)}f()}}()),M.wk&&!function(){return J?void 0:/loaded|complete/.test(j.readyState)?void f():void setTimeout(arguments.callee,0)}(),s(f)))}(),function(){M.ie&&M.win&&window.attachEvent("onunload",function(){for(var ac=I.length,ab=0;ac>ab;ab++)I[ab][0].detachEvent(I[ab][1],I[ab][2]);for(var Z=N.length,aa=0;Z>aa;aa++)y(N[aa]);for(var Y in M)M[Y]=null;M=null;for(var X in swfobject)swfobject[X]=null;swfobject=null})}()}return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab,Y.swfVersion=X,Y.expressInstall=aa,Y.callbackFn=Z,o[o.length]=Y,w(ab,!1)}else Z&&Z({success:!1,id:ab})},getObjectById:function(X){return M.w3?z(X):void 0},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:!1,id:ah};M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y?(w(ah,!1),K(function(){ae+="",ag+="";var aj={};if(af&&typeof af===r)for(var al in af)aj[al]=af[al];aj.data=ab,aj.width=ae,aj.height=ag;var am={};if(ad&&typeof ad===r)for(var ak in ad)am[ak]=ad[ak];if(Z&&typeof Z===r)for(var ai in Z)typeof am.flashvars!=D?am.flashvars+="&"+ai+"="+Z[ai]:am.flashvars=ai+"="+Z[ai];if(F(Y)){var an=u(aj,am,ah);aj.id==ah&&w(ah,!0),X.success=!0,X.ref=an}else{if(aa&&A())return aj.data=aa,void P(aj,am,ah,ac);w(ah,!0)}ac&&ac(X)})):ac&&ac(X)},switchOffAutoHideShow:function(){m=!1},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]}},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){return M.w3?u(Z,Y,X):void 0},showExpressInstall:function(Z,aa,X,Y){M.w3&&A()&&P(Z,aa,X,Y)},removeSWF:function(X){M.w3&&y(X)},createCSS:function(aa,Z,Y,X){M.w3&&v(aa,Z,Y,X)},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash;if(Z){if(/\?/.test(Z)&&(Z=Z.split("?")[1]),null==aa)return L(Z);for(var Y=Z.split("&"),X=0;X<Y.length;X++)if(Y[X].substring(0,Y[X].indexOf("="))==aa)return L(Y[X].substring(Y[X].indexOf("=")+1))}return""},expressInstallCallback:function(){if(a){var X=c(R);X&&l&&(X.parentNode.replaceChild(l,X),Q&&(w(Q,!0),M.ie&&M.win&&(l.style.display="block")),E&&E(B)),a=!1}}}}(),swfobject.addDomLoadEvent(function(){"function"==typeof SWFUpload.onload&&SWFUpload.onload.call(window)}),define("swfupload",function(){}),define("common/widgets/upload/uploadDirective",["jquery","underscore","swfupload"],function(jq,_){"use strict";return function($q,fileMgr,uploader,client,launcher){function parseType(scope){return TYPES[scope.type()||"all"]}function linkWithH5(scope,el){function createTask(files){return _.map(files,function(file){var ioTask=uploader.createTask(scope.name(),file);return{upload:function(url){return ioTask.upload(url)},resumeUpload:function(url,parentId){return ioTask.resumeUpload(url,parentId)},cancel:function(){ioTask.cancel()},append:function(name,value){ioTask.append(name,value)},name:function(){return file.name.substring(file.name.lastIndexOf("/")+1)},size:function(){return file.size},batchId:batchId,batchLength:files.length}})}var batchId,inputEl=el.find("input[type=file]"),type=parseType(scope);scope.accept=type.accept,el.addClass("widget-upload-btn").on("click",function(){inputEl.val("")}),scope.multiple&&inputEl.attr("multiple","multiple"),inputEl.on("change",function(){var files=inputEl[0].files;0!==files.length&&scope.$apply(function(){1===files.length?scope.select({tasks:createTask(files)}):(batchId=(new Date).getTime(),fileMgr.setBatchUploadId(launcher.getGroup().id,batchId,files.length).then(function(){scope.select({tasks:createTask(files)})}))})}),scope.setAcceptType=function(){var type=parseType(scope).accept;client.setDialogType(type)}}function linkWithSwf(scope){function init(){swf=new SWFUpload({flash_url:"vendor/swfupload/swfupload.swf",button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,button_placeholder_id:id,button_cursor:SWFUpload.CURSOR.HAND,file_size_limit:26214400,file_types:type.names,file_types_description:type.desc,prevent_swf_caching:!1,file_dialog_start_handler:onStartSelect,file_queued_handler:onFileQueued,file_dialog_complete_handler:onSelectComplete,upload_success_handler:onSuccess,upload_error_handler:onError,upload_progress_handler:onProgress})}function createTask(){return{upload:function(url){return canceled=!1,deferred=$q.defer(),swf.setUploadURL(url),swf.setFilePostName(scope.name()),swf.startUpload(fileId),deferred.promise},cancel:function(){swf.cancelUpload(fileId,!1)},append:function(name,value){swf.addPostParam(name,String(value))}}}function onStartSelect(){files=[]}function onFileQueued(file){fileId=file.id,files.push({name:file.name,size:file.size})}function onSelectComplete(count,queued){queued>0&&scope.$apply(function(){scope.select({task:createTask()})})}function onProgress(file,sent,total){canceled||scope.$apply(function(){deferred.notify({sent:sent,total:total})})}function onSuccess(file,data){canceled||scope.$apply(function(){deferred.resolve(JSON.parse(data))})}function onError(file,code,message){canceled||scope.$apply(function(){deferred.reject({status:code,text:message})})}function onDestroy(){void 0!==swf&&(jq(id).remove(),swf.destroy(),swf=void 0)}var swf,files,deferred,fileId,id="swf-upload-"+ ++swfId,type=parseType(scope),canceled=!1;scope.id=id,scope.$on("$destroy",onDestroy),setTimeout(function(){init()},10)}var support=uploader.isSupport(),swfId=0,TYPES={image:{accept:"image/*",names:"*.jpg;*.jpeg;*.gif;*.png;*.bmp",desc:"图片"},all:{accept:"*/*",names:"*.*",desc:"所有文件"}};return support?{restrict:"A",link:linkWithH5,transclude:!0,replace:!0,templateUrl:"common/widgets/upload/h5upload.html",scope:{name:"&widgetUpload",type:"&uploadType",multiple:"=uploadMultiple",select:"&uploadSelect"}}:{restrict:"A",link:linkWithSwf,transclude:!0,replace:!0,templateUrl:"common/widgets/upload/swfupload.html",scope:{name:"&widgetUpload",type:"&uploadType",multiple:"=uploadMultiple",select:"&uploadSelect"}}}}),define("common/widgets/menu/contextMenuDirective",["jquery","underscore"],function(jq,_){"use strict";return function($parse,menuService){function link(scope,el,attr){var fn=$parse(attr.widgetContextMenu);el.bind("contextmenu",function(e){var items=fn(scope);items&&_.isArray(items)&&0!==items.length&&(e.preventDefault(),e.stopPropagation(),menuService.open({items:items,x:e.pageX+5,y:e.pageY+5},attr.menuType))})}return{restrict:"A",link:link}}}),define("common/widgets/progress/progressDirective",[],function(){"use strict";return function(){function link(scope,el,attr){function update(){var percent=value/max;bar.css("width",Math.round(100*percent)+"%")}var bar=el.find(".widget-progress-bar"),value=0,max=1/0;scope.$watch(attr.value,function(newValue){value=newValue,update()}),scope.$watch(attr.max,function(newValue){max=newValue,update()})}return{restrict:"A",templateUrl:"common/widgets/progress/progress.html",link:link,replace:!0}}}),define("dragable",["jquery"],function(jQuery){"use strict";var $=jQuery,emptyFun=function(){},defaults={onDragStart:emptyFun,onDrag:emptyFun,onDragEnd:emptyFun},togglerDocSelection=function(isEnable){document.body.onselectstart=function(){return isEnable}},_isDraggable=!0,draggable=function($elem,options){if(options=$.extend(defaults,options),_isDraggable){var drag=function(evt){evt.preventDefault(),evt.stopPropagation(),options.onDrag(evt)},dragEnd=function(evt){$(document).off("mousemove",drag),$(document).off("mouseup",dragEnd),togglerDocSelection(!0),options.onDragEnd(evt)},dragStart=function(evt){evt.preventDefault(),$(document).on("mousemove",drag),$(document).on("mouseup",dragEnd),togglerDocSelection(!0),options.onDragStart(evt)};$elem.on("mousedown",dragStart)}else $elem.on("dragstart",function(e){options.onDragStart(e)}),$elem.on("drag",options.onDrag),$elem.on("dragend",options.onDragEnd)};return draggable}),define("util/keycode",[],function(){"use strict";return{ENTER:13,BACKSPACE:8,TAB:9,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,A:65,F:70,S:83,NUM_LOCK:144,SCROLL_LOCK:145,"'":222}}),define("common/widgets/preview/previewSlide",["jquery","underscore","dragable","util/keycode"],function(jq,_,dragable,KEYCODE){"use strict";return function($compile,$http,$rootScope,downloadService,$templateCache,storageMgr,laucher,$timeout){function showTip(){return!1}function fixExtension(name){var itemName=name||"",regexp=/^.*(\.png|\.jpg|\.jpeg|\.gif|\.bmp)$/i;return regexp.test(itemName)||(itemName+=".jpg"),itemName}function listenCtrlDown(e){e.keyCode===KEYCODE.CTRL&&(ctrlDown=!0)}function listenCtrlUp(e){e.keyCode===KEYCODE.CTRL&&(ctrlDown=!1)}function floorByScale(num,scale){return num=parseInt(num)+scale/2,num-num%scale}function zoomImage(multiple){var style,targetPercent,originPercent=100*parseFloat(boxEl.css("height"))/imgHeight,scales=[5,10,25,100],scale=scales[scales.length-1],ranges=[20,100,300];ranges.some(function(element,index){return multiple>0&&element>originPercent?(scale=scales[index],!0):0>multiple&&element>=originPercent?(scale=scales[index],!0):void 0}),targetPercent=floorByScale(originPercent,scale)+scale*multiple,targetPercent=Math.max(5,targetPercent),targetPercent=Math.min(1e3,targetPercent),targetPercent!=floorByScale(originPercent,scale)&&(style={height:parseInt(imgHeight*targetPercent*.01)+"px",width:parseInt(imgWidth*targetPercent*.01)+"px",top:parseInt(parseFloat(boxEl.css("top"))-imgHeight*(targetPercent-originPercent)*.005)+"px",left:parseInt(parseFloat(boxEl.css("left"))-imgWidth*(targetPercent-originPercent)*.005)+"px"},boxEl.css(style),updateImgPercent())}function updateImgPercent(){$timeout(function(){previewer.imageSizePercent=Math.ceil(100*parseFloat(boxEl.css("height"))/imgHeight)})}function fitSize(){if(previewer.isOriginSize)locate(!0);else{var style={height:imgHeight+"px",width:imgWidth+"px",top:(ctEl.height()-imgHeight)/2-20+"px",left:(ctEl.width()-imgWidth)/2+"px"};boxEl.animate(style,300,updateImgPercent)}previewer.isOriginSize=!previewer.isOriginSize}function scrollImage(value){var preview=jq(".widget-preview"),current=preview.scrollTop();preview.scrollTop(current-50*value)}function listenScroll(e){return ctrlDown?zoomImage(e.originalEvent.wheelDelta/120>0?1:-1):scrollImage(e.originalEvent.wheelDelta/120>0?1:-1),!1}function toggleResize(add){var doc=jq(document);doc.off("keydown",listenCtrlDown),doc.off("keyup",listenCtrlUp),doc.off("mousewheel",listenScroll),add&&(doc.on("keydown",listenCtrlDown),doc.on("keyup",listenCtrlUp),doc.on("mousewheel",listenScroll))}function deepIndexOf(array,value){var result=-1;return _.some(array,function(element,index){_.isEqual(element,value)&&(result=index)}),result}function prepare(){null==ctEl&&(void 0!==tpl?compile():$http.get(TPL_SRC,{cache:$templateCache}).success(function(res){tpl=res,compile()}))}function compile(){ctEl=$(tpl),ctEl.click(function(e){e.target===ctEl[0]&&(hide(),previewer.$digest())}),boxEl=ctEl.find(".box"),imgEl=ctEl.find(".image").on("load",function(){onLoad()}).error(function(){var invalidImg="style/images/b0cfb560.chat_image_break.png";_.isUndefined(imgEl.attr("src"))||imgEl.attr("src")===invalidImg||imgEl.attr("src",invalidImg)}),imgPerEl=ctEl.find(".image-size-percent"),ctEl.attr("tabindex",0),ctEl.appendTo(bodyEl),$compile(ctEl)(previewer),show(),dragable(boxEl,{onDragStart:function(evt){evt=evt.originalEvent,startPos.clientX=evt.clientX,startPos.clientY=evt.clientY,startPos.pageX=evt.pageX,startPos.pageY=evt.pageY,startPos.startLeft=parseFloat(boxEl.css("left")),startPos.startTop=parseFloat(boxEl.css("top"))},onDrag:function(evt){boxEl.css("left",startPos.startLeft+(evt.clientX-startPos.clientX)),boxEl.css("top",startPos.startTop+(evt.clientY-startPos.clientY))},onDragEnd:function(){}})}function updatePrevInfo(newItem,newItems){newItem&&$timeout(function(){previewer.imageTitle=newItem.name,previewer.isOriginSize=!1,newItems?(index=newItems?deepIndexOf(newItems,newItem):0,previewer.index=index+1,previewer.listLength=newItems.length):(index=previewer.index=-1,previewer.listLength=0)})}function open(newItem,newItems){if(item=newItem,items=newItems,item){if(updatePrevInfo(item,items),null==ctEl)return void prepare();show(),boxEl.removeData(INCREMENT)}}function show(){ctEl.show(),imgEl.attr("src",null).css({display:"none",position:"absolute",width:"",height:""}),boxEl.css({width:"72px",height:"72px",left:ctEl.width()/2-36,top:ctEl.height()/2-36-20}),previewer.imageSizePercent=100,setTimeout(function(){imgEl.attr("src",item.src)},5),toggleResize(!0),ctEl.focus(),$(window).off("keydown",onKeyDown),$(window).on("keydown",onKeyDown)}function onLoad(){zoomIn()}function zoomIn(){setTimeout(function(){imgWidth=imgEl.width(),imgHeight=imgEl.height(),locate(!0)
},5)}function locate(anim){var styles,width=imgWidth,height=imgHeight,restrict={width:.75*ctEl.width(),height:.75*ctEl.height()};width>restrict.width&&(height*=restrict.width/width,width=restrict.width),height>restrict.height&&(width*=restrict.height/height,height=restrict.height),imgEl.css({display:"block",position:"static",width:"100%",height:"100%"}),boxWidth=width,boxHeight=height,styles={width:boxWidth+"px",height:boxHeight+"px",top:(ctEl.height()-boxHeight)/2-20+"px",left:(ctEl.width()-boxWidth)/2+"px"},anim?boxEl.animate(styles,300,updateImgPercent):(boxEl.css(styles),updateImgPercent())}function hide(){ctEl.hide(),boxWidth=72,boxHeight=72,toggleResize(!1),$(window).off("keydown",onKeyDown),$rootScope.$broadcast("image.preview.hide")}function next(){hasNext()&&open(items[index+1],items)}function prev(){hasPrev()&&open(items[index-1],items)}function download(event){downloadService.anchorDownload(item.name,item.src,event)}function close(){hide(),index=-1,item=null,previewer.index=-1,previewer.listLength=0}function hasPrev(){return index>0}function hasNext(){return _.isArray(items)?index<items.length-1:!1}function hasPager(){return _.isArray(items)}function onResize(){null!=item&&locate(!1)}function setItems(newItems){items=newItems,updatePrevInfo(item,items)}var item,tpl,ctEl,boxEl,imgEl,imgPerEl,imgWidth,imgHeight,TPL_SRC="common/widgets/preview/preview.html",items=[],bodyEl=jq(document.body),index=-1,boxWidth=72,boxHeight=72,previewer=$rootScope.$new(),startPos={clientX:0,clientY:0,pageX:0,pageY:0,startTop:0,startLeft:0},INCREMENT="image_size_increment",ctrlDown=!1;previewer.close=close,previewer.prev=prev,previewer.next=next,previewer.download=download,previewer.hasPrev=hasPrev,previewer.hasNext=hasNext,previewer.hasPager=hasPager,previewer.showTip=showTip,previewer.imageSizePercent=100,previewer.zoomImage=zoomImage,previewer.fitSize=fitSize,previewer.imageSrc=function(){return item&&item.src?item.src:""},previewer.imageName=function(){return item&&item.name?fixExtension(item.name):""},jq(window).on("resize",onResize);var onKeyDown=_.throttle(function(evt){-1===["TEXTAREA","INPUT"].indexOf(evt.target.tagName)&&(evt.keyCode===KEYCODE.LEFT&&hasPrev()?(prev(),evt.stopPropagation()):evt.keyCode===KEYCODE.RIGHT&&hasNext()?(next(),evt.stopPropagation()):evt.keyCode===KEYCODE.UP?(zoomImage(1),evt.stopPropagation()):evt.keyCode===KEYCODE.DOWN?(zoomImage(-1),evt.stopPropagation()):evt.keyCode===KEYCODE.ESCAPE&&(close(),evt.stopPropagation()))},500);this.open=open,this.setItems=setItems}}),define("common/widgets/preview/previewDirective",[],function(){"use strict";return function(previewSlide){function link(scope,el){el.click(function(){scope.$apply(function(){previewSlide.open(scope.item(),scope.items())})}),scope.$watchCollection("items()",function(newCollection){previewSlide.setItems(newCollection)})}return{restrict:"A",link:link,scope:{item:"&widgetPreview",items:"&widgetPreviewList"}}}}),define("common/widgets/scroller/scrollDownDirective",["underscore","jquery"],function(){"use strict";return function(){return{scope:{scrollLoadObj:"=scrollDown"},restrict:"A",link:function(scope,element){function calcHeight(){height=0,elHeight=element.height(),element.children().each(function(index,el){height+=el.offsetHeight})}function handler(){calcHeight();var pos=height-element.scrollTop();pos-elHeight<scope.scrollLoadObj.itemHeight?loading||(loading=!0,scope.$apply(scope.scrollLoadObj.callbackHandler)):loading=!1}var elHeight,height=0,loading=!1;calcHeight(),element.scroll(handler)}}}}),define("common/widgets/maxInputLengthDirective",["underscore","jquery"],function(){"use strict";return function(){return{restrict:"A",require:"?ngModel",link:function(scope,element,attrs,ngModel){function countLength(str){if(!str)return 0;var cArr=str.match(/[^\x00-\xff]/gi);return str.length+(null===cArr?0:cArr.length)}function cutLength(){var i,cnt=0,newStr="",value=ngModel.$viewValue;if(countLength(value)>maxLength){for(i=0;i<value.length&&(/[^\x00-\xff]/gi.test(value[i])?cnt+=2:cnt++,!(cnt>maxLength));i++)newStr+=value[i];ngModel.$setViewValue(newStr),element.val(ngModel.$viewValue)}}var maxLength=Number(attrs.maxInputLength||32);element.on("blur keyup change",function(){cutLength(),scope.$digest()})}}}}),function(factory){"function"==typeof define&&define.amd?define("jqueryMousewheel",["jquery"],factory):"object"==typeof exports?module.exports=factory:factory(jQuery)}(function($){function handler(event){var orgEvent=event||window.event,args=slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,offsetX=0,offsetY=0;if(event=$.event.fix(orgEvent),event.type="mousewheel","detail"in orgEvent&&(deltaY=-1*orgEvent.detail),"wheelDelta"in orgEvent&&(deltaY=orgEvent.wheelDelta),"wheelDeltaY"in orgEvent&&(deltaY=orgEvent.wheelDeltaY),"wheelDeltaX"in orgEvent&&(deltaX=-1*orgEvent.wheelDeltaX),"axis"in orgEvent&&orgEvent.axis===orgEvent.HORIZONTAL_AXIS&&(deltaX=-1*deltaY,deltaY=0),delta=0===deltaY?deltaX:deltaY,"deltaY"in orgEvent&&(deltaY=-1*orgEvent.deltaY,delta=deltaY),"deltaX"in orgEvent&&(deltaX=orgEvent.deltaX,0===deltaY&&(delta=-1*deltaX)),0!==deltaY||0!==deltaX){if(1===orgEvent.deltaMode){var lineHeight=$.data(this,"mousewheel-line-height");delta*=lineHeight,deltaY*=lineHeight,deltaX*=lineHeight}else if(2===orgEvent.deltaMode){var pageHeight=$.data(this,"mousewheel-page-height");delta*=pageHeight,deltaY*=pageHeight,deltaX*=pageHeight}if(absDelta=Math.max(Math.abs(deltaY),Math.abs(deltaX)),(!lowestDelta||lowestDelta>absDelta)&&(lowestDelta=absDelta,shouldAdjustOldDeltas(orgEvent,absDelta)&&(lowestDelta/=40)),shouldAdjustOldDeltas(orgEvent,absDelta)&&(delta/=40,deltaX/=40,deltaY/=40),delta=Math[delta>=1?"floor":"ceil"](delta/lowestDelta),deltaX=Math[deltaX>=1?"floor":"ceil"](deltaX/lowestDelta),deltaY=Math[deltaY>=1?"floor":"ceil"](deltaY/lowestDelta),special.settings.normalizeOffset&&this.getBoundingClientRect){var boundingRect=this.getBoundingClientRect();offsetX=event.clientX-boundingRect.left,offsetY=event.clientY-boundingRect.top}return event.deltaX=deltaX,event.deltaY=deltaY,event.deltaFactor=lowestDelta,event.offsetX=offsetX,event.offsetY=offsetY,event.deltaMode=0,args.unshift(event,delta,deltaX,deltaY),nullLowestDeltaTimeout&&clearTimeout(nullLowestDeltaTimeout),nullLowestDeltaTimeout=setTimeout(nullLowestDelta,200),($.event.dispatch||$.event.handle).apply(this,args)}}function nullLowestDelta(){lowestDelta=null}function shouldAdjustOldDeltas(orgEvent,absDelta){return special.settings.adjustOldDeltas&&"mousewheel"===orgEvent.type&&absDelta%120===0}var nullLowestDeltaTimeout,lowestDelta,toFix=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],toBind="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],slice=Array.prototype.slice;if($.event.fixHooks)for(var i=toFix.length;i;)$.event.fixHooks[toFix[--i]]=$.event.mouseHooks;var special=$.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=toBind.length;i;)this.addEventListener(toBind[--i],handler,!1);else this.onmousewheel=handler;$.data(this,"mousewheel-line-height",special.getLineHeight(this)),$.data(this,"mousewheel-page-height",special.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=toBind.length;i;)this.removeEventListener(toBind[--i],handler,!1);else this.onmousewheel=null;$.removeData(this,"mousewheel-line-height"),$.removeData(this,"mousewheel-page-height")},getLineHeight:function(elem){var $elem=$(elem),$parent=$elem["offsetParent"in $.fn?"offsetParent":"parent"]();return $parent.length||($parent=$("body")),parseInt($parent.css("fontSize"),10)||parseInt($elem.css("fontSize"),10)||16},getPageHeight:function(elem){return $(elem).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}})}),define("common/widgets/scroller/scrollerDirective",["jqueryMousewheel","underscore","util/keycode"],function(jm,_,KEYCODE){"use strict";var MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return function(client){function link(scope,el,attr,ctrl){function enterToShow(e){e.currentTarget===el[0]&&(mouseEntered=!0,startMonitor(),update())}function leaveToHide(e){e&&e.currentTarget!==el[0]||(mouseEntered=!1,stopMonitor(),update())}function startMonitor(){defaultView.bind("resize",bufferedUpdate),observer.observe(ct[0],{subtree:!0,attributes:!0,attributeFilter:["style"]}),ct.on("scroll",handleScroll)}function stopMonitor(){defaultView.unbind("resize",bufferedUpdate),observer.disconnect()}function handleScroll(){return prevent?void(prevent=!1):void update()}function handleKey(e){var code=e.keyCode;switch(code){case KEYCODE.PAGE_UP:scrollBy(.8*-ct.height());break;case KEYCODE.PAGE_DOWN:scrollBy(.8*ct.height());break;case KEYCODE.END:scrollBy(Number.POSITIVE_INFINITY);break;case KEYCODE.HOME:scrollBy(Number.NEGATIVE_INFINITY);break;case KEYCODE.UP:scrollBy(-40);break;case KEYCODE.DOWN:scrollBy(40)}}function wheelScroll(e){var ch=ct.height(),bh=measure(ct.children());if(!(ch>=bh)){var deltaFactor=e.deltaFactor;client.isPC()&&(deltaFactor=100),scrollBy(-e.deltaY*deltaFactor,bh,ch)}}function startDrag(e){var ctDom=ct[0];e.preventDefault(),e.stopPropagation(),dragY=e.pageY,startRelatedY=dragY-bar.offset().top,ctDom.setCapture?(ctDom.setCapture(),ct.bind("mousemove",dragScroll).bind("mouseup",stopDrag)):$(window).bind("mousemove",dragScroll).bind("mouseup",stopDrag),el.unbind("mouseenter",enterToShow).unbind("mouseleave",leaveToHide),bar.addClass("drag")}function dragScroll(e){var offsetY=e.pageY-dragY,offsetPercent=offsetY/ct.height(),relatedOffset=e.pageY-bar.offset().top,bh=measure(ct.children());dragY=e.pageY,offsetY>0&&startRelatedY>relatedOffset||0>offsetY&&relatedOffset>startRelatedY||scrollBy(offsetPercent*bh,bh)}function stopDrag(e){var ctDom=ct[0];ctDom.releaseCapture?(ctDom.releaseCapture(),ct.unbind("mousemove",dragScroll).unbind("mouseup",stopDrag)):$(window).unbind("mousemove",dragScroll).unbind("mouseup",stopDrag),withIn(e.target)||leaveToHide(),el.bind("mouseenter",enterToShow).bind("mouseleave",leaveToHide),bar.removeClass("drag")}function scrollBy(offset,bh,ch){var top;bh=void 0!==bh?bh:measure(ct.children()),ch=void 0!==ch?ch:ct.height(),top=Math.max(0,Math.min(ct.scrollTop()+offset,bh-ch)),scrollTo(top,bh,ch)}function scrollTo(top,bh,ch){var evtData;bh=void 0!==bh?bh:measure(ct.children()),ch=void 0!==ch?ch:ct.height(),evtData={height:bh,visible:ch,top:top,bottom:bh-top-ch},prevent=!0,ct.scrollTop(top),prevent=!1,scope.onScroll(evtData),ctrl.notify(evtData),bufferedUpdate()}function update(){var visible=bar.is(":visible"),bh=measure(ct.children()),ch=ct.height(),top=ct.scrollTop();return ch>=bh||!mouseEntered?void(visible&&bar.hide()):(!visible&&mouseEntered&&bh>ch&&bar.show(),void((bh!==cache.inner||ch!==cache.outer||top!==cache.top)&&(!function(height){bar.height(Math.floor(height)).css("top",Math.floor(ct.scrollTop()/(bh-ch)*(ch-height)))}(Math.max(ch/bh*ch,BAR_MIN_HEIGHT)),cache.inner=bh,cache.outer=ch,cache.top=top)))}function getScrollTop(){return ct.scrollTop()}function getViewportHeight(){return ct.height()}function measure(children){var height=0;return children.each(function(i,el){el=$(el),el.is(":visible")&&(height+=el.outerHeight(!0))}),height}function withIn(target){for(var root=el[0];null!=target;){if(target==root)return!0;target=target.parentNode}return!1}var startRelatedY,dragY,ct=el.find(".widget-scroller-wrap"),bar=el.find(".widget-scroller-bar"),defaultView=$(window),mouseEntered=!1,BAR_MIN_HEIGHT=50,cache={},prevent=!1,bufferedUpdate=_.throttle(update,10),observer=new MutationObserver(bufferedUpdate);el.bind("mousewheel",wheelScroll).bind("mouseenter",enterToShow).bind("mouseleave",leaveToHide),ct.bind("keydown",handleKey),bar.bind("selectstart",function(e){e.preventDefault()}),bar.mousedown(startDrag).click(function(e){e.stopPropagation()}),scope.$on("$destroy",stopMonitor),scope.listeners=[],scope.scrollTo=scrollTo,scope.scrollBy=scrollBy,scope.getScrollTop=getScrollTop,scope.getViewportHeight=getViewportHeight,scope.update=bufferedUpdate}var ctrl=function(scope){var handlers=[];this.setHandler=function(handler){handlers.push(handler)},this.removeHandler=function(handler){handlers.splice(handlers.indexOf(handler),1)},this.notify=function(evtData){_.each(handlers,function(handler){handler(evtData)})},this.update=function(){scope.update()},this.scrollTo=function(top){scope.scrollTo(top)},this.scrollBy=function(offset){scope.scrollBy(offset)},this.getScrollTop=function(){return scope.getScrollTop()},this.getViewportHeight=function(){return scope.getViewportHeight()}};return{restrict:"A",templateUrl:"common/widgets/scroller/scroller.html",transclude:!0,replace:!0,link:link,controller:["$scope",ctrl],scope:{onScroll:"&widgetScroller"}}}}),function(){"use strict";var currentElement,_getStyle=function(el,prop){var y=el.style[prop];if(el.currentStyle?y=el.currentStyle[prop]:window.getComputedStyle&&(y=document.defaultView.getComputedStyle(el,null).getPropertyValue(prop)),"auto"==y&&"cursor"==prop)for(var possiblePointers=["a"],i=0;i<possiblePointers.length;i++)if(el.tagName.toLowerCase()==possiblePointers[i])return"pointer";return y},_elementMouseOver=function(event){if(ZeroClipboard.prototype._singleton){event||(event=window.event);var target;this!==window?target=this:event.target?target=event.target:event.srcElement&&(target=event.srcElement),ZeroClipboard.prototype._singleton.setCurrent(target)}},_addEventHandler=function(element,method,func){element.addEventListener?element.addEventListener(method,func,!1):element.attachEvent&&element.attachEvent("on"+method,func)},_removeEventHandler=function(element,method,func){element.removeEventListener?element.removeEventListener(method,func,!1):element.detachEvent&&element.detachEvent("on"+method,func)},_addClass=function(element,value){if(element.addClass)return element.addClass(value),element;if(value&&"string"==typeof value){var classNames=(value||"").split(/\s+/);if(1===element.nodeType)if(element.className){for(var className=" "+element.className+" ",setClass=element.className,c=0,cl=classNames.length;cl>c;c++)className.indexOf(" "+classNames[c]+" ")<0&&(setClass+=" "+classNames[c]);element.className=setClass.replace(/^\s+|\s+$/g,"")}else element.className=value}return element},_removeClass=function(element,value){if(element.removeClass)return element.removeClass(value),element;if(value&&"string"==typeof value||void 0===value){var classNames=(value||"").split(/\s+/);if(1===element.nodeType&&element.className)if(value){for(var className=(" "+element.className+" ").replace(/[\n\t]/g," "),c=0,cl=classNames.length;cl>c;c++)className=className.replace(" "+classNames[c]+" "," ");element.className=className.replace(/^\s+|\s+$/g,"")}else element.className=""}return element},_getDOMObjectPosition=function(obj){var info={left:0,top:0,width:obj.width||obj.offsetWidth||0,height:obj.height||obj.offsetHeight||0,zIndex:999999999},zi=_getStyle(obj,"zIndex");return zi&&"auto"!=zi&&(info.zIndex=parseInt(zi,10)),info.top=obj.getBoundingClientRect().top+window.pageYOffset-document.documentElement.clientTop,info.left=obj.getBoundingClientRect().left+window.pageXOffset-document.documentElement.clientLeft,info},_noCache=function(path){return(path.indexOf("?")>=0?"&":"?")+"nocache="+(new Date).getTime()},_vars=function(options){var str=[];return options.trustedDomains&&str.push("string"==typeof options.trustedDomains?"trustedDomain="+options.trustedDomains:"trustedDomain="+options.trustedDomains.join(",")),str.join("&")},_inArray=function(elem,array){if(array.indexOf)return array.indexOf(elem);for(var i=0,length=array.length;length>i;i++)if(array[i]===elem)return i;return-1},_prepGlue=function(elements){if("string"==typeof elements)throw new TypeError("ZeroClipboard doesn't accept query strings.");return elements.length?elements:[elements]},ZeroClipboard=function(elements,options){if(elements&&(ZeroClipboard.prototype._singleton||this).glue(elements),ZeroClipboard.prototype._singleton)return ZeroClipboard.prototype._singleton;ZeroClipboard.prototype._singleton=this,this.options={};for(var kd in _defaults)this.options[kd]=_defaults[kd];for(var ko in options)this.options[ko]=options[ko];this.handlers={},ZeroClipboard.detectFlashSupport()&&_bridge()},gluedElements=[];ZeroClipboard.prototype.setCurrent=function(element){currentElement=element,this.reposition(),element.getAttribute("title")&&this.setTitle(element.getAttribute("title")),this.setHandCursor("pointer"==_getStyle(element,"cursor"))},ZeroClipboard.prototype.setText=function(newText){newText&&""!==newText&&(this.options.text=newText,this.ready()&&this.flashBridge.setText(newText))},ZeroClipboard.prototype.setTitle=function(newTitle){newTitle&&""!==newTitle&&this.htmlBridge.setAttribute("title",newTitle)},ZeroClipboard.prototype.setSize=function(width,height){this.ready()&&this.flashBridge.setSize(width,height)},ZeroClipboard.prototype.setHandCursor=function(enabled){this.ready()&&this.flashBridge.setHandCursor(enabled)},ZeroClipboard.version="1.1.7";var _defaults={moviePath:"ZeroClipboard.swf",trustedDomains:null,text:null,hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",allowScriptAccess:"sameDomain"};ZeroClipboard.setDefaults=function(options){for(var ko in options)_defaults[ko]=options[ko]},ZeroClipboard.destroy=function(){ZeroClipboard.prototype._singleton.unglue(gluedElements);var bridge=ZeroClipboard.prototype._singleton.htmlBridge;bridge.parentNode.removeChild(bridge),delete ZeroClipboard.prototype._singleton},ZeroClipboard.detectFlashSupport=function(){var hasFlash=!1;try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(hasFlash=!0)}catch(error){navigator.mimeTypes["application/x-shockwave-flash"]&&(hasFlash=!0)}return hasFlash};var _bridge=function(){var client=ZeroClipboard.prototype._singleton,container=document.getElementById("global-zeroclipboard-html-bridge");if(!container){var html='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+client.options.moviePath+_noCache(client.options.moviePath)+'"/>         <param name="allowScriptAccess" value="'+client.options.allowScriptAccess+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+_vars(client.options)+'"/>         <embed src="'+client.options.moviePath+_noCache(client.options.moviePath)+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="always"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+_vars(client.options)+'"           scale="exactfit">         </embed>       </object>';container=document.createElement("div"),container.id="global-zeroclipboard-html-bridge",container.setAttribute("class","global-zeroclipboard-container"),container.setAttribute("data-clipboard-ready",!1),container.style.position="absolute",container.style.left="-9999px",container.style.top="-9999px",container.style.width="15px",container.style.height="15px",container.style.zIndex="9999",container.innerHTML=html,document.body.appendChild(container)}client.htmlBridge=container,client.flashBridge=document["global-zeroclipboard-flash-bridge"]||container.children[0].lastElementChild};ZeroClipboard.prototype.resetBridge=function(){this.htmlBridge.style.left="-9999px",this.htmlBridge.style.top="-9999px",this.htmlBridge.removeAttribute("title"),this.htmlBridge.removeAttribute("data-clipboard-text"),_removeClass(currentElement,this.options.activeClass),currentElement=null,this.options.text=null},ZeroClipboard.prototype.ready=function(){var ready=this.htmlBridge.getAttribute("data-clipboard-ready");return"true"===ready||ready===!0},ZeroClipboard.prototype.reposition=function(){if(!currentElement)return!1;var pos=_getDOMObjectPosition(currentElement);this.htmlBridge.style.top=pos.top+"px",this.htmlBridge.style.left=pos.left+"px",this.htmlBridge.style.width=pos.width+"px",this.htmlBridge.style.height=pos.height+"px",this.htmlBridge.style.zIndex=pos.zIndex+1,this.setSize(pos.width,pos.height)},ZeroClipboard.dispatch=function(eventName,args){ZeroClipboard.prototype._singleton.receiveEvent(eventName,args)},ZeroClipboard.prototype.on=function(eventName,func){for(var events=eventName.toString().split(/\s/g),i=0;i<events.length;i++)eventName=events[i].toLowerCase().replace(/^on/,""),this.handlers[eventName]||(this.handlers[eventName]=func);this.handlers.noflash&&!ZeroClipboard.detectFlashSupport()&&this.receiveEvent("onNoFlash",null)},ZeroClipboard.prototype.addEventListener=ZeroClipboard.prototype.on,ZeroClipboard.prototype.off=function(eventName,func){for(var events=eventName.toString().split(/\s/g),i=0;i<events.length;i++){eventName=events[i].toLowerCase().replace(/^on/,"");for(var event in this.handlers)event===eventName&&this.handlers[event]===func&&delete this.handlers[event]}},ZeroClipboard.prototype.removeEventListener=ZeroClipboard.prototype.off,ZeroClipboard.prototype.receiveEvent=function(eventName,args){eventName=eventName.toString().toLowerCase().replace(/^on/,"");var element=currentElement;switch(eventName){case"load":if(args&&parseFloat(args.flashVersion.replace(",",".").replace(/[^0-9\.]/gi,""))<10)return void this.receiveEvent("onWrongFlash",{flashVersion:args.flashVersion});this.htmlBridge.setAttribute("data-clipboard-ready",!0);break;case"mouseover":_addClass(element,this.options.hoverClass);var event=new Event("zeroclipboard-is-hover");element.dispatchEvent(event);var outEvent=new Event("mouseover",{bubbles:!0});element.dispatchEvent(outEvent);break;case"mouseout":_removeClass(element,this.options.hoverClass);var event=new Event("zeroclipboard-not-hover");element.dispatchEvent(event);var outEvent=new Event("mouseout",{bubbles:!0});element.dispatchEvent(outEvent),this.resetBridge();break;case"mousedown":_addClass(element,this.options.activeClass);break;case"mouseup":_removeClass(element,this.options.activeClass);break;case"datarequested":var targetId=element.getAttribute("data-clipboard-target"),targetEl=targetId?document.getElementById(targetId):null;if(targetEl){var textContent=targetEl.value||targetEl.textContent||targetEl.innerText;textContent&&this.setText(textContent)}else{var defaultText=element.getAttribute("data-clipboard-text");defaultText&&this.setText(defaultText)}break;case"complete":this.options.text=null;var event=new Event("complete",{bubbles:!0});element.dispatchEvent(event)}if(this.handlers[eventName]){var func=this.handlers[eventName];"function"==typeof func?func.call(element,this,args):"string"==typeof func&&window[func].call(element,this,args)}},ZeroClipboard.prototype.glue=function(elements){elements=_prepGlue(elements);for(var i=0;i<elements.length;i++)-1==_inArray(elements[i],gluedElements)&&(gluedElements.push(elements[i]),_addEventHandler(elements[i],"mouseover",_elementMouseOver))},ZeroClipboard.prototype.unglue=function(elements){elements=_prepGlue(elements);for(var i=0;i<elements.length;i++){_removeEventHandler(elements[i],"mouseover",_elementMouseOver);var arrayIndex=_inArray(elements[i],gluedElements);-1!=arrayIndex&&gluedElements.splice(arrayIndex,1)}},"undefined"!=typeof module?module.exports=ZeroClipboard:"function"==typeof define&&define.amd?define("ZeroClipboard",[],function(){return ZeroClipboard}):window.ZeroClipboard=ZeroClipboard}(),define("common/widgets/clipboard/clipboardDirective",["angular","ZeroClipboard","jquery","underscore"],function(angular,ZeroClipboard,jQuery,_){"use strict";function onNoflash(){$window.alert("您浏览器没有flash插件")}function bind(){clip.on("load",singletonLoad),clip.on("complete",singletonComplete),clip.on("mousedown",singletonMouseDown),clip.on("noflash",onNoflash)}function unbind(){clip.off("load",singletonLoad),clip.off("complete",singletonComplete),clip.off("mousedown",singletonMouseDown),clip.off("noflash",onNoflash)}var $=jQuery;window.ZeroClipboard=ZeroClipboard;var clip,elementAndScope=[],getSingletonFunction=function(methodName){return function(client,args){var node=_.findWhere(elementAndScope,{element:this});if(node){var scope=node.scope;_.isFunction(scope[methodName])&&scope[methodName].call(scope,this,client,args)}}},singletonMouseDown=getSingletonFunction("onMouseDown"),singletonLoad=getSingletonFunction("onLoad"),singletonComplete=getSingletonFunction("onComplete");return function($window,clientProxy){ZeroClipboard.setDefaults({moviePath:"/group/util/ZeroClipboard.swf"});var linkCommon=function(scope,element){function init(){elementAndScope.push({scope:scope,element:element[0]}),clip?clip.glue(element[0]):(clip=new ZeroClipboard(element[0]),clip.setHandCursor(!0),bind()),scope.$on("$destroy",function(){clip.unglue(element[0]),elementAndScope=_.without(elementAndScope,_.findWhere(elementAndScope,{element:element})),0===elementAndScope.length&&unbind()})}var options=$.extend({copyValue:null,onload:function(){},oncomplete:function(){},onmousedown:function(){}},scope.options);scope.$watch("options",function(){options=$.extend(options,scope.options)}),scope.onLoad=function(element,client,args){angular.isFunction(options.onload)&&options.onload.apply(element,[client,args])},scope.onComplete=function(element,client,args){clip.setText(options.copyValue),angular.isFunction(options.oncomplete)&&options.oncomplete.apply(element,[client,args])},scope.onMouseDown=function(element,client,args){clip.setText(options.copyValue),angular.isFunction(options.onmousedown)&&options.onmousedown.apply(element,[client,args])},init()},linkYnoteClient=function(scope,element){function onComplete(){angular.isFunction(options.oncomplete)&&options.oncomplete.apply(this,arguments)}function onMousedown(){clientProxy.copyText(options.copyValue),angular.isFunction(options.onmousedown)&&options.onmousedown.apply(this,arguments),onComplete.apply(this,arguments)}function bind(){element.on("mousedown",onMousedown)}function unbind(){element.off("mousedown",onMousedown)}function init(){bind(),scope.$on("$destroy",function(){unbind()})}var options=$.extend({copyValue:null,oncomplete:function(){var event=new Event("complete",{bubbles:!0});element.dispatchEvent(event)},onmousedown:function(){}},scope.options);scope.$watch("options",function(){options=$.extend(options,scope.options)}),init()},link=clientProxy.isPC()?linkYnoteClient:linkCommon;return{scope:{options:"=clipboard"},restrict:"A",link:link}}}),define("common/widgets/toggle/toggle",["jquery"],function(jq){"use strict";function ToggleDirective($q,$timeout){function link(scope,el,attrs){function onElClick(){return prevent?(prevent=!prevent,void el.one("click",onElClick)):void(attrs.widgetToggleBefore?$q.when(scope.before()).then(function(){$timeout(function(){scope.visible=!0,attrs.widgetToggleAfter&&scope.after()},0)}):(scope.$apply(function(){scope.visible=!0}),attrs.widgetToggleAfter&&scope.after()))}function onMouseDown(){prevent=!0,scope.$apply(function(){scope.visible=!1})}function show(){scope.contentEl.css("visibility","hidden").show(),body.bind("mousedown",onBodyMouseDown),el.one("mousedown",onMouseDown),el.addClass("widget-toggle-active"),setTimeout(ensurePosition,10)}function hide(){var align=scope.align;scope.contentEl.hide().css(align,"").css("top",""),body.unbind("mousedown",onBodyMouseDown),el.unbind("mousedown",onMouseDown),el.one("click",onElClick),el.removeClass("widget-toggle-active")}function ensurePosition(){var contentEl=scope.contentEl,align=scope.align,contentHeight=contentEl.outerHeight(),contentOffset=contentEl.offset(),triggerHeight=el.outerHeight(),docHeight=docEl.height();contentEl.css("visibility","visible").css(align,"0px"),contentOffset.top+contentEl.height()>docHeight?contentEl.css("top",-contentHeight+"px"):contentEl.css("top",triggerHeight+"px"),contentEl.offset().left<0&&contentEl.css("left",0)}function onBodyMouseDown(){prevent=!1,scope.$apply(function(){scope.visible=!1})}var prevent=!1;el.one("click",onElClick),scope.$watch("visible",function(visible){scope.contentEl&&(visible?show():hide())}),scope.$on("$destroy",function(){body.unbind("mousedown",onBodyMouseDown),scope.contentEl=null})}var ctrl=function($scope){this.setContent=function(el,align){$scope.contentEl=el,$scope.contentEl.mousedown(function(e){e.stopPropagation()}).click(function(e){e.stopPropagation(),$scope.$apply(function(){$scope.visible=!1})}),$scope.align=align}};return{restrict:"A",link:link,scope:{visible:"=widgetToggle",before:"&widgetToggleBefore",after:"&widgetToggleAfter"},controller:["$scope",ctrl]}}function ContentDirective(){function link(scope,element,attrs,toggle){toggle.setContent(element,attrs.widgetToggleContent||"left")}return{restrict:"A",link:link,require:"^widgetToggle"}}var body=jq(document.body),docEl=jq(window);return{directive:ToggleDirective,contentDirective:ContentDirective}}),define("util/emoji",[],function(){"use strict";return[{ID:"_yixin_emoticon_emoji_124_",Tag:"/开心",Class:"icon-emoji_124"},{ID:"_yixin_emoticon_emoji_123",Tag:"/大哭",Class:"icon-emoji_123"},{ID:"_yixin_emoticon_emoji_08_",Tag:"/鬼脸",Class:"icon-emoji_08"},{ID:"_yixin_emoticon_emoji_01_",Tag:"/可爱",Class:"icon-emoji_01"},{ID:"_yixin_emoticon_emoji_117_",Tag:"/吻",Class:"icon-emoji_117"},{ID:"_yixin_emoticon_emoji_160_",Tag:"/拜一拜",Class:"icon-emoji_160"},{ID:"_yixin_emoticon_emoji_19_",Tag:"/惊恐",Class:"icon-emoji_19"},{ID:"_yixin_emoticon_emoji_118",Tag:"/哀伤",Class:"icon-emoji_118"},{ID:"_yixin_emoticon_emoji_119_",Tag:"/吐舌",Class:"icon-emoji_119"},{ID:"_yixin_emoticon_emoji_120_",Tag:"/撇嘴",Class:"icon-emoji_120"},{ID:"_yixin_emoticon_emoji_121_",Tag:"/痛苦",Class:"icon-emoji_121"},{ID:"_yixin_emoticon_emoji_122_",Tag:"/惶恐",Class:"icon-emoji_122"},{ID:"_yixin_emoticon_emoji_125_",Tag:"/皱眉",Class:"icon-emoji_125"},{ID:"_yixin_emoticon_emoji_163_",Tag:"/卖萌",Class:"icon-emoji_163"},{ID:"_yixin_emoticon_emoji_0_",Tag:"/大笑",Class:"icon-emoji_00"},{ID:"_yixin_emoticon_emoji_02_",Tag:"/色",Class:"icon-emoji_02"},{ID:"_yixin_emoticon_emoji_03_",Tag:"/嘘",Class:"icon-emoji_03"},{ID:"_yixin_emoticon_emoji_04_",Tag:"/亲",Class:"icon-emoji_04"},{ID:"_yixin_emoticon_emoji_05_",Tag:"/呆",Class:"icon-emoji_05"},{ID:"_yixin_emoticon_emoji_145_",Tag:"/汗",Class:"icon-emoji_145"},{ID:"_yixin_emoticon_emoji_07_",Tag:"/呲牙",Class:"icon-emoji_07"},{ID:"_yixin_emoticon_emoji_09_",Tag:"/害羞",Class:"icon-emoji_09"},{ID:"_yixin_emoticon_emoji_10_",Tag:"/偷笑",Class:"icon-emoji_10"},{ID:"_yixin_emoticon_emoji_11_",Tag:"/调皮",Class:"icon-emoji_11"},{ID:"_yixin_emoticon_emoji_12_",Tag:"/可怜",Class:"icon-emoji_12"},{ID:"_yixin_emoticon_emoji_13",Tag:"/敲",Class:"icon-emoji_13"},{ID:"_yixin_emoticon_emoji_15_",Tag:"/流感",Class:"icon-emoji_15"},{ID:"_yixin_emoticon_emoji_16_",Tag:"/委屈",Class:"icon-emoji_16"},{ID:"_yixin_emoticon_emoji_17_",Tag:"/流泪",Class:"icon-emoji_17"},{ID:"_yixin_emoticon_emoji_18_",Tag:"/嚎哭",Class:"icon-emoji_18"},{ID:"_yixin_emoticon_emoji_34_",Tag:"/强",Class:"icon-emoji_34"},{ID:"_yixin_emoticon_emoji_35_",Tag:"/弱",Class:"icon-emoji_35"},{ID:"_yixin_emoticon_emoji_36_",Tag:"/OK",Class:"icon-emoji_36"},{ID:"_yixin_emoticon_emoji_37_",Tag:"/拳头",Class:"icon-emoji_37"},{ID:"_yixin_emoticon_emoji_38_",Tag:"/胜利",Class:"icon-emoji_38"},{ID:"_yixin_emoticon_emoji_39_",Tag:"/鼓掌",Class:"icon-emoji_39"},{ID:"_yixin_emoticon_emoji_167_",Tag:"/握手",Class:"icon-emoji_167"},{ID:"_yixin_emoticon_emoji_30_",Tag:"/疑问",Class:"icon-emoji_30"},{ID:"_yixin_emoticon_emoji_27_",Tag:"/口罩",Class:"icon-emoji_27"},{ID:"_yixin_emoticon_emoji_20_",Tag:"/怒",Class:"icon-emoji_20"},{ID:"_yixin_emoticon_emoji_21_",Tag:"/酷",Class:"icon-emoji_21"},{ID:"_yixin_emoticon_emoji_116_",Tag:"/憨笑",Class:"icon-emoji_116"},{ID:"_yixin_emoticon_emoji_14_",Tag:"/惊讶",Class:"icon-emoji_14"},{ID:"_yixin_emoticon_emoji_22_",Tag:"/不说",Class:"icon-emoji_22"},{ID:"_yixin_emoticon_emoji_06_",Tag:"/口水",Class:"icon-emoji_06"},{ID:"_yixin_emoticon_emoji_23_",Tag:"/鄙视",Class:"icon-emoji_23"},{ID:"_yixin_emoticon_emoji_24_",Tag:"/阿弥陀佛",Class:"icon-emoji_24"},{ID:"_yixin_emoticon_emoji_25_",Tag:"/奸笑",Class:"icon-emoji_25"},{ID:"_yixin_emoticon_emoji_26_",Tag:"/睡着",Class:"icon-emoji_26"},{ID:"_yixin_emoticon_emoji_28_",Tag:"/努力",Class:"icon-emoji_28"},{ID:"_yixin_emoticon_emoji_29_",Tag:"/抠鼻孔",Class:"icon-emoji_29"},{ID:"_yixin_emoticon_emoji_31_",Tag:"/怒骂",Class:"icon-emoji_31"},{ID:"_yixin_emoticon_emoji_32_",Tag:"/晕",Class:"icon-emoji_32"},{ID:"_yixin_emoticon_emoji_33_",Tag:"/呕吐",Class:"icon-emoji_33"},{ID:"_yixin_emoticon_emoji_161_",Tag:"/惊喜",Class:"icon-emoji_161"},{ID:"_yixin_emoticon_emoji_162_",Tag:"/流汗",Class:"icon-emoji_162"},{ID:"_yixin_emoticon_emoji_164_",Tag:"/默契眨眼",Class:"icon-emoji_164"},{ID:"_yixin_emoticon_emoji_165_",Tag:"/烧香拜佛",Class:"icon-emoji_165"},{ID:"_yixin_emoticon_emoji_166_",Tag:"/晚安",Class:"icon-emoji_166"},{ID:"_yixin_emoticon_emoji_146_",Tag:"/生病",Class:"icon-emoji_146"},{ID:"_yixin_emoticon_emoji_126_",Tag:"/喜欢",Class:"icon-emoji_126"},{ID:"_yixin_emoticon_emoji_127_",Tag:"/星星",Class:"icon-emoji_127"},{ID:"_yixin_emoticon_emoji_128",Tag:"/生气",Class:"icon-emoji_128"},{ID:"_yixin_emoticon_emoji_129_",Tag:"/牵手",Class:"icon-emoji_129"},{ID:"_yixin_emoticon_emoji_130_",Tag:"/跳舞",Class:"icon-emoji_130"},{ID:"_yixin_emoticon_emoji_131_",Tag:"/禁止",Class:"icon-emoji_131"},{ID:"_yixin_emoticon_emoji_132_",Tag:"/示爱",Class:"icon-emoji_132"},{ID:"_yixin_emoticon_emoji_133",Tag:"/狗",Class:"icon-emoji_133"},{ID:"_yixin_emoticon_emoji_134_",Tag:"/猫",Class:"icon-emoji_134"},{ID:"_yixin_emoticon_emoji_135_",Tag:"/猪",Class:"icon-emoji_135"},{ID:"_yixin_emoticon_emoji_136_",Tag:"/兔子",Class:"icon-emoji_136"},{ID:"_yixin_emoticon_emoji_137_",Tag:"/小鸡",Class:"icon-emoji_137"},{ID:"_yixin_emoticon_emoji_138",Tag:"/公鸡",Class:"icon-emoji_138"},{ID:"_yixin_emoticon_emoji_139_",Tag:"/幽灵",Class:"icon-emoji_139"},{ID:"_yixin_emoticon_emoji_140_",Tag:"/圣诞",Class:"icon-emoji_140"},{ID:"_yixin_emoticon_emoji_141_",Tag:"/外星",Class:"icon-emoji_141"},{ID:"_yixin_emoticon_emoji_142_",Tag:"/礼物",Class:"icon-emoji_142"},{ID:"_yixin_emoticon_emoji_143_",Tag:"/男孩",Class:"icon-emoji_143"},{ID:"_yixin_emoticon_emoji_144_",Tag:"/女孩",Class:"icon-emoji_144"},{ID:"_yixin_emoticon_emoji_147_",Tag:"/这边",Class:"icon-emoji_147"},{ID:"_yixin_emoticon_emoji_148",Tag:"/爱意",Class:"icon-emoji_148"},{ID:"_yixin_emoticon_emoji_149_",Tag:"/嘴唇",Class:"icon-emoji_149"},{ID:"_yixin_emoticon_emoji_151_",Tag:"/圈",Class:"icon-emoji_151"},{ID:"_yixin_emoticon_emoji_152_",Tag:"/叉",Class:"icon-emoji_152"},{ID:"_yixin_emoticon_emoji_40_",Tag:"/发怒",Class:"icon-emoji_40"},{ID:"_yixin_emoticon_emoji_41_",Tag:"/骷髅",Class:"icon-emoji_41"},{ID:"_yixin_emoticon_emoji_42_",Tag:"/便便",Class:"icon-emoji_42"},{ID:"_yixin_emoticon_emoji_43_",Tag:"/火",Class:"icon-emoji_43"},{ID:"_yixin_emoticon_emoji_44_",Tag:"/溜",Class:"icon-emoji_44"},{ID:"_yixin_emoticon_emoji_45_",Tag:"/爱心",Class:"icon-emoji_45"},{ID:"_yixin_emoticon_emoji_46_",Tag:"/心碎",Class:"icon-emoji_46"},{ID:"_yixin_emoticon_emoji_47_",Tag:"/钟情",Class:"icon-emoji_47"},{ID:"_yixin_emoticon_emoji_48_",Tag:"/唇",Class:"icon-emoji_48"},{ID:"_yixin_emoticon_emoji_49_",Tag:"/戒指",Class:"icon-emoji_49"},{ID:"_yixin_emoticon_emoji_50_",Tag:"/钻石",Class:"icon-emoji_50"},{ID:"_yixin_emoticon_emoji_51_",Tag:"/太阳",Class:"icon-emoji_51"},{ID:"_yixin_emoticon_emoji_52_",Tag:"/有时晴",Class:"icon-emoji_52"},{ID:"_yixin_emoticon_emoji_53_",Tag:"/多云",Class:"icon-emoji_53"},{ID:"_yixin_emoticon_emoji_54_",Tag:"/雷",Class:"icon-emoji_54"},{ID:"_yixin_emoticon_emoji_55",Tag:"/雨",Class:"icon-emoji_55"},{ID:"_yixin_emoticon_emoji_56_",Tag:"/雪花",Class:"icon-emoji_56"},{ID:"_yixin_emoticon_emoji_57_",Tag:"/爱人",Class:"icon-emoji_57"},{ID:"_yixin_emoticon_emoji_58_",Tag:"/帽子",Class:"icon-emoji_58"},{ID:"_yixin_emoticon_emoji_59_",Tag:"/皇冠",Class:"icon-emoji_59"},{ID:"_yixin_emoticon_emoji_60",Tag:"/篮球",Class:"icon-emoji_60"},{ID:"_yixin_emoticon_emoji_61_",Tag:"/足球",Class:"icon-emoji_61"},{ID:"_yixin_emoticon_emoji_62_",Tag:"/垒球",Class:"icon-emoji_62"},{ID:"_yixin_emoticon_emoji_63_",Tag:"/网球",Class:"icon-emoji_63"},{ID:"_yixin_emoticon_emoji_64_",Tag:"/台球",Class:"icon-emoji_64"},{ID:"_yixin_emoticon_emoji_65",Tag:"/咖啡",Class:"icon-emoji_65"},{ID:"_yixin_emoticon_emoji_66_",Tag:"/啤酒",Class:"icon-emoji_66"},{ID:"_yixin_emoticon_emoji_67_",Tag:"/干杯",Class:"icon-emoji_67"},{ID:"_yixin_emoticon_emoji_68_",Tag:"/柠檬汁",Class:"icon-emoji_68"},{ID:"_yixin_emoticon_emoji_69_",Tag:"/餐具",Class:"icon-emoji_69"},{ID:"_yixin_emoticon_emoji_70",Tag:"/汉堡",Class:"icon-emoji_70"},{ID:"_yixin_emoticon_emoji_71_",Tag:"/鸡腿",Class:"icon-emoji_71"},{ID:"_yixin_emoticon_emoji_72_",Tag:"/面条",Class:"icon-emoji_72"},{ID:"_yixin_emoticon_emoji_73_",Tag:"/冰淇淋",Class:"icon-emoji_73"},{ID:"_yixin_emoticon_emoji_74_",Tag:"/沙冰",Class:"icon-emoji_74"},{ID:"_yixin_emoticon_emoji_75_",Tag:"/生日蛋糕",Class:"icon-emoji_75"},{ID:"_yixin_emoticon_emoji_76_",Tag:"/蛋糕",Class:"icon-emoji_76"},{ID:"_yixin_emoticon_emoji_77_",Tag:"/糖果",Class:"icon-emoji_77"},{ID:"_yixin_emoticon_emoji_78_",Tag:"/葡萄",Class:"icon-emoji_78"},{ID:"_yixin_emoticon_emoji_79_",Tag:"/西瓜",Class:"icon-emoji_79"},{ID:"_yixin_emoticon_emoji_80",Tag:"/光碟",Class:"icon-emoji_80"},{ID:"_yixin_emoticon_emoji_81_",Tag:"/手机",Class:"icon-emoji_81"},{ID:"_yixin_emoticon_emoji_82_",Tag:"/电话",Class:"icon-emoji_82"},{ID:"_yixin_emoticon_emoji_83_",Tag:"/电视",Class:"icon-emoji_83"},{ID:"_yixin_emoticon_emoji_84_",Tag:"/声音开启",Class:"icon-emoji_84"},{ID:"_yixin_emoticon_emoji_85",Tag:"/声音关闭",Class:"icon-emoji_85"},{ID:"_yixin_emoticon_emoji_86_",Tag:"/铃铛",Class:"icon-emoji_86"},{ID:"_yixin_emoticon_emoji_87_",Tag:"/锁头",Class:"icon-emoji_87"},{ID:"_yixin_emoticon_emoji_88_",Tag:"/放大镜",Class:"icon-emoji_88"},{ID:"_yixin_emoticon_emoji_89_",Tag:"/灯泡",Class:"icon-emoji_89"},{ID:"_yixin_emoticon_emoji_90",Tag:"/锤头",Class:"icon-emoji_90"},{ID:"_yixin_emoticon_emoji_91_",Tag:"/烟",Class:"icon-emoji_91"},{ID:"_yixin_emoticon_emoji_92_",Tag:"/炸弹",Class:"icon-emoji_92"},{ID:"_yixin_emoticon_emoji_93_",Tag:"/枪",Class:"icon-emoji_93"},{ID:"_yixin_emoticon_emoji_94_",Tag:"/刀",Class:"icon-emoji_94"},{ID:"_yixin_emoticon_emoji_95",Tag:"/药",Class:"icon-emoji_95"},{ID:"_yixin_emoticon_emoji_96_",Tag:"/打针",Class:"icon-emoji_96"},{ID:"_yixin_emoticon_emoji_97_",Tag:"/钱袋",Class:"icon-emoji_97"},{ID:"_yixin_emoticon_emoji_98_",Tag:"/钞票",Class:"icon-emoji_98"},{ID:"_yixin_emoticon_emoji_99_",Tag:"/银行卡",Class:"icon-emoji_99"},{ID:"_yixin_emoticon_emoji_100",Tag:"/手柄",Class:"icon-emoji_100"},{ID:"_yixin_emoticon_emoji_101_",Tag:"/麻将",Class:"icon-emoji_101"},{ID:"_yixin_emoticon_emoji_102_",Tag:"/调色板",Class:"icon-emoji_102"},{ID:"_yixin_emoticon_emoji_103_",Tag:"/电影",Class:"icon-emoji_103"},{ID:"_yixin_emoticon_emoji_104_",Tag:"/麦克风",Class:"icon-emoji_104"},{ID:"_yixin_emoticon_emoji_105",Tag:"/耳机",Class:"icon-emoji_105"},{ID:"_yixin_emoticon_emoji_106_",Tag:"/音乐",Class:"icon-emoji_106"},{ID:"_yixin_emoticon_emoji_107_",Tag:"/吉他",Class:"icon-emoji_107"},{ID:"_yixin_emoticon_emoji_108_",Tag:"/火箭",Class:"icon-emoji_108"},{ID:"_yixin_emoticon_emoji_109_",Tag:"/飞机",Class:"icon-emoji_109"},{ID:"_yixin_emoticon_emoji_110",Tag:"/火车",Class:"icon-emoji_110"},{ID:"_yixin_emoticon_emoji_111_",Tag:"/公交",Class:"icon-emoji_111"},{ID:"_yixin_emoticon_emoji_112_",Tag:"/轿车",Class:"icon-emoji_112"},{ID:"_yixin_emoticon_emoji_113_",Tag:"/出租车",Class:"icon-emoji_113"},{ID:"_yixin_emoticon_emoji_114_",Tag:"/警车",Class:"icon-emoji_114"},{ID:"_yixin_emoticon_emoji_115_",Tag:"/自行车",Class:"icon-emoji_115"}]
}),define("common/widgets/toggle/emojiToggle",["jquery","underscore","util/emoji"],function($,_,emojis){"use strict";var body=$(document.body),docEl=$(window),alignTop=135,alignLeft=159,emojiTemplate=_.reduce(emojis,function(memo,emoji){return memo+'<div class="emoji" title="'+emoji.Tag+';"><div class="emoji-item '+emoji.Class+'"></div></div>'},"");return function(){function link(scope,el){function onElClick(){return prevent?(prevent=!prevent,void el.one("click",onElClick)):void scope.$apply(function(){scope.visible=!0})}function onMouseDown(){prevent=!0,scope.$apply(function(){scope.visible=!1})}function show(){ensurePosition(),$content.show(),body.bind("mousedown",onBodyMouseDown),el.bind("mousedown",onMouseDown),$content.find(".emoji").bind("mousedown",function(){return scope.addEmoji({tag:this.title}),scope.$apply(function(){scope.visible=!1}),!1}),$content.bind("mousedown",function(){return!1})}function hide(){$content.hide(),body.unbind("mousedown",onBodyMouseDown),el.unbind("mousedown",onMouseDown),el.one("click",onElClick),$content.find(".emoji").unbind("mousedown")}function ensurePosition(){var offset=el.offset();$content.css({top:offset.top-alignTop,left:offset.left-alignLeft})}function onBodyMouseDown(){prevent=!1,scope.$apply(function(){scope.visible=!1})}var prevent=!1,$content=$('<div class="emoji-container"><div class="emoji-board"><div class="emoji-main">'+emojiTemplate+"</div></div></div>");body.append($content),el.one("click",onElClick),docEl.on("resize",ensurePosition),scope.$on("emoji.ensurePosition",ensurePosition),scope.$watch("visible",function(visible){visible?show():hide()}),scope.$on("$destroy",function(){body.unbind("mousedown",onBodyMouseDown),el.unbind("mousedown",onMouseDown),el.unbind("click"),docEl.off("resize",ensurePosition),$content.find(".emoji").unbind("mousedown"),$content.unbind("mousedown"),$content.remove()})}return{restrict:"A",link:link,scope:{visible:"=emojiToggle",addEmoji:"&"}}}}),define("common/widgets/autofocus",[],function(){"use strict";return function(){function link(scope,el){setTimeout(function(){el[0].focus()},75)}return{link:link}}}),function(){!function(factory){return"function"==typeof define&&define.amd?define("caret",["jquery"],factory):factory(window.jQuery)}(function($){"use strict";var EditableCaret,InputCaret,Mirror,Utils,methods,pluginName;return pluginName="caret",EditableCaret=function(){function EditableCaret($inputor){this.$inputor=$inputor,this.domInputor=this.$inputor[0]}return EditableCaret.prototype.setPos=function(){return this.domInputor},EditableCaret.prototype.getIEPosition=function(){return $.noop()},EditableCaret.prototype.getPosition=function(){return $.noop()},EditableCaret.prototype.getOldIEPos=function(){var preCaretTextRange,textRange;return textRange=document.selection.createRange(),preCaretTextRange=document.body.createTextRange(),preCaretTextRange.moveToElementText(this.domInputor),preCaretTextRange.setEndPoint("EndToEnd",textRange),preCaretTextRange.text.length},EditableCaret.prototype.getPos=function(){var clonedRange,pos,range;return(range=this.range())?(clonedRange=range.cloneRange(),clonedRange.selectNodeContents(this.domInputor),clonedRange.setEnd(range.endContainer,range.endOffset),pos=clonedRange.toString().length,clonedRange.detach(),pos):document.selection?this.getOldIEPos():void 0},EditableCaret.prototype.getOldIEOffset=function(){var range,rect;return range=document.selection.createRange().duplicate(),range.moveStart("character",-1),rect=range.getBoundingClientRect(),{height:rect.bottom-rect.top,left:rect.left,top:rect.top}},EditableCaret.prototype.getOffset=function(){var clonedRange,offset,range,rect;if(offset=null,window.getSelection&&(range=this.range())){if(range.endOffset-1<0)return null;clonedRange=range.cloneRange(),clonedRange.setStart(range.endContainer,range.endOffset-1),clonedRange.setEnd(range.endContainer,range.endOffset),rect=clonedRange.getBoundingClientRect(),offset={height:rect.height,left:rect.left+rect.width,top:rect.top},clonedRange.detach()}else document.selection&&this.getOldIEOffset();return Utils.adjustOffset(offset,this.$inputor)},EditableCaret.prototype.range=function(){var sel;if(window.getSelection)return sel=window.getSelection(),sel.rangeCount>0?sel.getRangeAt(0):null},EditableCaret}(),InputCaret=function(){function InputCaret($inputor){this.$inputor=$inputor,this.domInputor=this.$inputor[0]}return InputCaret.prototype.getIEPos=function(){var endRange,inputor,len,normalizedValue,pos,range,textInputRange;return inputor=this.domInputor,range=document.selection.createRange(),pos=0,range&&range.parentElement()===inputor&&(normalizedValue=inputor.value.replace(/\r\n/g,"\n"),len=normalizedValue.length,textInputRange=inputor.createTextRange(),textInputRange.moveToBookmark(range.getBookmark()),endRange=inputor.createTextRange(),endRange.collapse(!1),pos=textInputRange.compareEndPoints("StartToEnd",endRange)>-1?len:-textInputRange.moveStart("character",-len)),pos},InputCaret.prototype.getPos=function(){return document.selection?this.getIEPos():this.domInputor.selectionStart},InputCaret.prototype.setPos=function(pos){var inputor,range;return inputor=this.domInputor,document.selection?(range=inputor.createTextRange(),range.move("character",pos),range.select()):inputor.setSelectionRange&&inputor.setSelectionRange(pos,pos),inputor},InputCaret.prototype.getIEOffset=function(pos){var h,range,textRange,x,y;return textRange=this.domInputor.createTextRange(),pos?textRange.move("character",pos):(range=document.selection.createRange(),textRange.moveToBookmark(range.getBookmark())),x=textRange.boundingLeft,y=textRange.boundingTop,h=textRange.boundingHeight,{left:x,top:y,height:h}},InputCaret.prototype.getOffset=function(pos){var $inputor,offset,position;return $inputor=this.$inputor,document.selection?Utils.adjustOffset(this.getIEOffset(pos),$inputor):(offset=$inputor.offset(),position=this.getPosition(pos),offset={left:offset.left+position.left,top:offset.top+position.top,height:position.height})},InputCaret.prototype.getPosition=function(pos){var $inputor,at_rect,format,html,mirror,start_range;return $inputor=this.$inputor,format=function(value){return value.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />")},void 0===pos&&(pos=this.getPos()),start_range=$inputor.val().slice(0,pos),html="<span>"+format(start_range)+"</span>",html+="<span id='caret'>|</span>",mirror=new Mirror($inputor),at_rect=mirror.create(html).rect()},InputCaret.prototype.getIEPosition=function(pos){var h,inputorOffset,offset,x,y;return offset=this.getIEOffset(pos),inputorOffset=this.$inputor.offset(),x=offset.left-inputorOffset.left,y=offset.top-inputorOffset.top,h=offset.height,{left:x,top:y,height:h}},InputCaret}(),Mirror=function(){function Mirror($inputor){this.$inputor=$inputor}return Mirror.prototype.css_attr=["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX","text-align"],Mirror.prototype.mirrorCss=function(){var css,_this=this;return css={position:"absolute",left:-9999,top:0,zIndex:-2e4,"white-space":"pre-wrap"},$.each(this.css_attr,function(i,p){return css[p]=_this.$inputor.css(p)}),css},Mirror.prototype.create=function(html){return this.$mirror=$("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(html),this.$inputor.after(this.$mirror),this},Mirror.prototype.rect=function(){var $flag,pos,rect;return $flag=this.$mirror.find("#caret"),pos=$flag.position(),rect={left:pos.left,top:pos.top,height:$flag.height()},this.$mirror.remove(),rect},Mirror}(),Utils={adjustOffset:function(offset,$inputor){return offset?(offset.top+=$(window).scrollTop()+$inputor.scrollTop(),offset.left+=+$(window).scrollLeft()+$inputor.scrollLeft(),offset):void 0},contentEditable:function($inputor){return!(!$inputor[0].contentEditable||"true"!==$inputor[0].contentEditable)}},methods={pos:function(pos){return pos?this.setPos(pos):this.getPos()},position:function(pos){return document.selection?this.getIEPosition(pos):this.getPosition(pos)},offset:function(pos){return this.getOffset(pos)}},$.fn.caret=function(method){var caret;return caret=Utils.contentEditable(this)?new EditableCaret(this):new InputCaret(this),methods[method]?methods[method].apply(caret,Array.prototype.slice.call(arguments,1)):$.error("Method "+method+" does not exist on jQuery.caret")},$.fn.caret.EditableCaret=EditableCaret,$.fn.caret.InputCaret=InputCaret,$.fn.caret.Utils=Utils,$.fn.caret.apis=methods})}.call(this),function(){$.fn.bindFirst=function(which,handler){var $el=$(this);which=which.split(".")[0],$el.unbind(which,handler),$el.bind(which,handler);var events=$._data($el[0]).events,registered=events[which];return registered&&(registered.unshift(registered.pop()),events[which]=registered),this};var __slice=[].slice;!function(factory){return"function"==typeof define&&define.amd?define("atwho",["jquery","caret"],factory):factory(window.jQuery)}(function($){var Api,App,Atwho,Controller,DEFAULT_CALLBACKS,KEY_CODE,Model,View;return App=function(){function App(inputor){this.current_flag=null,this.controllers={},this.alias_maps={},this.$inputor=$(inputor),this.listen()}return App.prototype.controller=function(at){return this.controllers[this.alias_maps[at]||at||this.current_flag]},App.prototype.set_context_for=function(at){return this.current_flag=at,this},App.prototype.reg=function(flag,setting){var controller,_base;return controller=(_base=this.controllers)[flag]||(_base[flag]=new Controller(this,flag)),setting.alias&&(this.alias_maps[setting.alias]=flag),controller.init(setting),this},App.prototype.listen=function(){var _this=this;return this.$inputor.on("keyup.atwho",function(e){return _this.on_keyup(e)}).bindFirst("keydown.atwho",function(e){return _this.on_keydown(e)}).on("scroll.atwho",function(){var _ref;return null!=(_ref=_this.controller())?_ref.view.hide():void 0}).on("blur.atwho",function(){var c;return(c=_this.controller())?c.view.hide(c.get_opt("display_timeout")):void 0})},App.prototype.dispatch=function(){var _this=this;return $.map(this.controllers,function(c){return c.look_up()?_this.set_context_for(c.at):void 0})},App.prototype.on_keyup=function(e){var _ref;switch(e.keyCode){case KEY_CODE.ESC:e.preventDefault(),null!=(_ref=this.controller())&&_ref.view.hide();break;case KEY_CODE.TAB:case KEY_CODE.DOWN:case KEY_CODE.UP:$.noop();break;default:this.dispatch()}},App.prototype.on_keydown=function(e){var view,_ref;if(view=null!=(_ref=this.controller())?_ref.view:void 0,view&&view.visible())switch(e.keyCode){case KEY_CODE.ESC:e.preventDefault(),view.hide();break;case KEY_CODE.UP:e.preventDefault(),view.prev();break;case KEY_CODE.DOWN:e.preventDefault(),view.next();break;case KEY_CODE.TAB:e.preventDefault(),view.next();break;case KEY_CODE.ENTER:if(!view.visible())return;e.preventDefault(),e.stopPropagation(),view.choose();break;default:$.noop()}},App}(),Controller=function(){function Controller(app,at){this.app=app,this.at=at,this.$inputor=this.app.$inputor,this.id=this.$inputor[0].id||uuid(),this.$inputor[0].atwhoId="atwho-ground-"+this.id,this.setting=null,this.query=null,this.pos=0,this.cur_rect=null,this.range=null,$("body").append(this.$el=$("<div id='atwho-ground-"+this.id+"'></div>")),this.model=new Model(this),this.view=new View(this)}var uuid,_uuid;return _uuid=0,uuid=function(){return _uuid+=1},Controller.prototype.init=function(setting){return this.setting=$.extend({},this.setting||$.fn.atwho["default"],setting),this.view.init(),this.model.reload(this.setting.data)},Controller.prototype.call_default=function(){var args,func_name;func_name=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];try{return DEFAULT_CALLBACKS[func_name].apply(this,args)}catch(error){return $.error(""+error+" Or maybe At.js doesn't have function "+func_name)}},Controller.prototype.trigger=function(name,data){var alias,event_name;return data.push(this),alias=this.get_opt("alias"),event_name=alias?""+name+"-"+alias+".atwho":""+name+".atwho",this.$inputor.trigger(event_name,data)},Controller.prototype.callbacks=function(func_name){return this.get_opt("callbacks")[func_name]||DEFAULT_CALLBACKS[func_name]},Controller.prototype.get_opt=function(at){try{return this.setting[at]}catch(e){return null}},Controller.prototype.content=function(){return this.$inputor.is("textarea, input")?this.$inputor.val():this.$inputor.text()},Controller.prototype.catch_query=function(){var caret_pos,content,end,query,start,subtext;return content=this.content(),caret_pos=this.$inputor.caret("pos"),subtext=content.slice(0,caret_pos),query=this.callbacks("matcher").call(this,this.at,subtext,this.get_opt("start_with_space")),"string"==typeof query&&query.length<=this.get_opt("max_len",20)?(start=caret_pos-query.length,end=start+query.length,this.pos=start,query={text:query.toLowerCase(),head_pos:start,end_pos:end},this.trigger("matched",[this.at,query.text])):this.view.hide(),this.query=query},Controller.prototype.rect=function(){var c,scale_bottom;if(c=this.$inputor.caret("offset",this.pos-1))return"true"===this.$inputor.attr("contentEditable")&&(c=this.cur_rect||(this.cur_rect=c)||c),scale_bottom=document.selection?0:2,{left:c.left,top:c.top,bottom:c.top+c.height+scale_bottom}},Controller.prototype.reset_rect=function(){return"true"===this.$inputor.attr("contentEditable")?this.cur_rect=null:void 0},Controller.prototype.mark_range=function(){return this.range=this.get_range()||this.get_ie_range()},Controller.prototype.clear_range=function(){return this.range=null},Controller.prototype.get_range=function(){return this.range||(window.getSelection?window.getSelection().getRangeAt(0):void 0)},Controller.prototype.get_ie_range=function(){return this.range||(document.selection?document.selection.createRange():void 0)},Controller.prototype.insert_content_for=function($li){var data,data_value,tpl;return data_value=$li.data("value"),tpl=this.get_opt("insert_tpl"),this.$inputor.is("textarea, input")||!tpl?data_value:(data=$.extend({},$li.data("item-data"),{"atwho-data-value":data_value,"atwho-at":this.at}),this.callbacks("tpl_eval").call(this,tpl,data))},Controller.prototype.insert=function(content,$li){var $inputor,$insert_node,class_name,content_node,insert_node,pos,range,sel,source,start_str,text;return $inputor=this.$inputor,"true"===$inputor.attr("contentEditable")&&(class_name="atwho-view-flag atwho-view-flag-"+(this.get_opt("alias")||this.at),content_node=""+content+"<span contenteditable='false'>&nbsp;<span>",insert_node="<span contenteditable='false' class='"+class_name+"'>"+content_node+"</span>",$insert_node=$(insert_node).data("atwho-data-item",$li.data("item-data")),document.selection&&($insert_node=$("<span contenteditable='true'></span>").html($insert_node))),$inputor.is("textarea, input")?(content=""+content,source=$inputor.val(),start_str=source.slice(0,Math.max(this.query.head_pos-this.at.length,0)),text=""+start_str+content+" "+source.slice(this.query.end_pos||0),$inputor.val(text),$inputor.caret("pos",start_str.length+content.length+1)):(range=this.get_range())?(pos=range.startOffset-(this.query.end_pos-this.query.head_pos)-this.at.length,range.setStart(range.endContainer,Math.max(pos,0)),range.setEnd(range.endContainer,range.endOffset),range.deleteContents(),range.insertNode($insert_node[0]),range.collapse(!1),sel=window.getSelection(),sel.removeAllRanges(),sel.addRange(range)):(range=this.get_ie_range())&&(range.moveStart("character",this.query.end_pos-this.query.head_pos-this.at.length),range.pasteHTML($insert_node[0]),range.collapse(!1),range.select()),$inputor.focus(),$inputor.change()},Controller.prototype.render_view=function(data){var search_key;search_key=this.get_opt("search_key"),data=this.callbacks("sorter").call(this,this.query.text,data.slice(0,1001),search_key);for(var result,limitNum=this.get_opt("limit"),holdNum=0,holdData=[],noHoldData=[],i=0;i<data.length;i++)data[i].isHold?(holdData.push(data[i]),holdNum++):noHoldData.push(data[i]);result=noHoldData.slice(0,limitNum-holdNum);for(var i=0;i<holdData.length;i++)result.push(holdData[i]);return this.view.render(result)},Controller.prototype.look_up=function(){var query,_callback;if(query=this.catch_query())return _callback=function(data){return data&&data.length>0?this.render_view(data):this.view.hide()},this.model.query(query.text,$.proxy(_callback,this)),query},Controller}(),Model=function(){function Model(context){this.context=context,this.at=this.context.at,this.storage=this.context.$inputor}return Model.prototype.saved=function(){return this.fetch()>0},Model.prototype.query=function(query,callback){var data,search_key,_remote_filter;return data=this.fetch(),search_key=this.context.get_opt("search_key"),data=this.context.callbacks("filter").call(this.context,query,data,search_key)||[],_remote_filter=this.context.callbacks("remote_filter"),data.length>0||!_remote_filter&&0===data.length?callback(data):_remote_filter.call(this.context,query,callback)},Model.prototype.fetch=function(){return this.storage.data(this.at)||[]},Model.prototype.save=function(data){return this.storage.data(this.at,this.context.callbacks("before_save").call(this.context,data||[]))},Model.prototype.load=function(data){return!this.saved()&&data?this._load(data):void 0},Model.prototype.reload=function(data){return this._load(data)},Model.prototype._load=function(data){var _this=this;return"string"==typeof data?$.ajax(data,{dataType:"json"}).done(function(data){return _this.save(data)}):this.save(data)},Model}(),View=function(){function View(context){this.context=context,this.$el=$("<div class='atwho-view'><ul class='atwho-view-ul'></ul></div>"),this.timeout_id=null,this.context.$el.append(this.$el),this.bind_event()}return View.prototype.init=function(){var id;return id=this.context.get_opt("alias")||this.context.at.charCodeAt(0),this.$el.attr({id:"at-view-"+id})},View.prototype.bind_event=function(){var $menu,_this=this;return $menu=this.$el.find("ul"),$menu.on("mouseenter.atwho-view","li",function(e){return $menu.find(".cur").removeClass("cur"),$(e.currentTarget).addClass("cur")}).on("click",function(e){return _this.choose(),e.preventDefault()}),this.$el.on("mouseenter.atwho-view","ul",function(){return _this.context.mark_range()}).on("mouseleave.atwho-view","ul",function(){return _this.context.clear_range()})},View.prototype.visible=function(){return this.$el.is(":visible")},View.prototype.choose=function(){var $li,content;return $li=this.$el.find(".cur"),content=this.context.insert_content_for($li),this.context.insert(this.context.callbacks("before_insert").call(this.context,content,$li),$li),this.context.trigger("inserted",[$li]),this.hide()},View.prototype.reposition=function(rect){this.$el.scrollTop(0);var offset;return rect.bottom+this.$el.height()-$(window).scrollTop()>$(window).height()&&(rect.bottom=rect.top-this.$el.height()),rect.left+this.$el.width()-$(window).scrollLeft()>$(window).width()&&(rect.left-=this.$el.width()-11),offset={left:rect.left,top:rect.bottom},this.$el.offset(offset),this.context.trigger("reposition",[offset])},View.prototype.next=function(){var cur,next;cur=this.$el.find(".cur").removeClass("cur");var index;if(index=this.$el.find("li").index(cur),index>3){var curScrollTop=this.$el.scrollTop();this.$el.scrollTop(curScrollTop+cur.outerHeight())}return next=cur.next(),next.length||(next=this.$el.find("li:first"),this.$el.scrollTop(0)),next.addClass("cur")},View.prototype.prev=function(){var cur,prev;cur=this.$el.find(".cur").removeClass("cur"),prev=cur.prev();var length,index,$li;if($li=this.$el.find("li"),length=$li.length,index=$li.index(cur),length-index>4){var curScrollTop=this.$el.scrollTop();this.$el.scrollTop(curScrollTop-cur.outerHeight())}return prev.length||(prev=this.$el.find("li:last"),this.$el.scrollTop(this.$el.find("ul").height())),prev.addClass("cur")},View.prototype.show=function(){var rect;return this.visible()||this.$el.show(),(rect=this.context.rect())?this.reposition(rect):void 0},View.prototype.hide=function(time){var callback,_this=this;return isNaN(time&&this.visible())?(this.context.reset_rect(),this.$el.hide()):(callback=function(){return _this.hide()},clearTimeout(this.timeout_id),this.timeout_id=setTimeout(callback,time))},View.prototype.render=function(list){var $li,$ul,item,li,tpl,_i,_len;if(!($.isArray(list)&&list.length>0))return void this.hide();for(this.$el.find("ul").empty(),$ul=this.$el.find("ul"),tpl=this.context.get_opt("tpl"),_i=0,_len=list.length;_len>_i;_i++)item=list[_i],item=$.extend({},item,{"atwho-at":this.context.at}),li=this.context.callbacks("tpl_eval").call(this.context,tpl,item),$li=$(this.context.callbacks("highlighter").call(this.context,li,this.context.query.text)),$li.data("item-data",item),$ul.append($li);return this.show(),$ul.find("li:first").addClass("cur")},View}(),KEY_CODE={DOWN:40,UP:38,ESC:27,TAB:9,ENTER:13},DEFAULT_CALLBACKS={before_save:function(data){var item,_i,_len,_results;if(!$.isArray(data))return data;for(_results=[],_i=0,_len=data.length;_len>_i;_i++)item=data[_i],_results.push($.isPlainObject(item)?item:{name:item});return _results},matcher:function(flag,subtext,should_start_with_space){var match,regexp;return flag=flag.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),should_start_with_space&&(flag="(?:^|\\s)"+flag),regexp=new RegExp(flag+"([A-Za-z0-9_+-]*)$|"+flag+"(([A-Za-z0-9_+-]*[^\\x00-\\xff]*)+)$","gi"),match=regexp.exec(subtext),match?match[2]||match[1]:null},filter:function(query,data,search_key){var item,_i,_len,_results;for(_results=[],_i=0,_len=data.length;_len>_i;_i++){item=data[_i];var flag=!0,t=item[search_key].toLowerCase();for(_j=0;_j<query.length;_j++){var value=query[_j],index=t.indexOf(value);-1===index?flag=!1:(index++,t=t.slice(0,index-1)+t.slice(index,t.length))}(item.isHold||flag)&&_results.push(item)}return _results},remote_filter:null,sorter:function(query,items,search_key){var item,_i,_len,_results;if(!query)return items;for(_results=[],_i=0,_len=items.length;_len>_i;_i++)item=items[_i],item.isHold?(item.atwho_order=1e5,_results.push(item)):(item.atwho_order=item[search_key].toLowerCase().indexOf(query[0]),_results.push(item));return _results.sort(function(a,b){return a.atwho_order-b.atwho_order})},tpl_eval:function(tpl,map){try{return tpl.replace(/\$\{([^\}]*)\}/g,function(tag,key){return map[key]})}catch(error){return""}},highlighter:function(li,query){var regexp;return query?(regexp=new RegExp(">\\s*(\\w*)("+query.replace("+","\\+")+")(\\w*)\\s*<","ig"),li.replace(regexp,function(str,$1,$2,$3){return"> "+$1+"<strong>"+$2+"</strong>"+$3+" <"})):li},before_insert:function(value){return value}},Api={load:function(at,data){var c;return(c=this.controller(at))?c.model.load(data):void 0},getInsertedItemsWithIDs:function(at){var c,ids,items;return(c=this.controller(at))?(at&&(at="-"+(c.get_opt("alias")||c.at)),ids=[],items=$.map(this.$inputor.find("span.atwho-view-flag"+(at||"")),function(item){var data;return data=$(item).data("atwho-data-item"),ids.indexOf(data.id)>-1?void 0:(data.id&&(ids.push=data.id),data)}),[ids,items]):[null,null]},getInsertedItems:function(at){return Api.getInsertedItemsWithIDs.apply(this,[at])[1]},getInsertedIDs:function(at){return Api.getInsertedItemsWithIDs.apply(this,[at])[0]},run:function(){return this.dispatch()}},Atwho={init:function(options){var $this,app;return app=($this=$(this)).data("atwho"),app||$this.data("atwho",app=new App(this)),app.reg(options.at,options),this}},$.fn.atwho=function(method){var result,_args;return _args=arguments,result=null,this.filter("textarea, input, [contenteditable=true]").each(function(){var app;return"object"!=typeof method&&method?Api[method]?(app=$(this).data("atwho"))?result=Api[method].apply(app,Array.prototype.slice.call(_args,1)):void 0:$.error("Method "+method+" does not exist on jQuery.caret"):Atwho.init.apply(this,_args)}),result||this},$.fn.atwho["default"]={at:void 0,alias:void 0,data:null,tpl:"<li data-value='${atwho-at}${name}'>${name}</li>",insert_tpl:"<span>${atwho-data-value}</span>",callbacks:DEFAULT_CALLBACKS,search_key:"name",start_with_space:!0,limit:5,max_len:20,display_timeout:300}})}.call(this),define("common/widgets/at/atDirective",["underscore","jquery","atwho"],function(_,$){"use strict";return function(memberService,aliasService,launcher){function link(scope,element){function initAtWho(members){if(members=_.reject(members,function(value){return value.userId===launcher.getUser().userId}),0!==members.length){var names=_.map(members,function(value){var name,pinyin,aliasPinyin,result;return name=value.name,pinyin=value.pinyin,result="",pinyin!==name&&(pinyin+=name),aliasService.aliasList[value.userId]&&(value.aliasName=aliasService.aliasList[value.userId].name,value.aliasPinyin=aliasService.aliasList[value.userId].pinyin),value.aliasName?(aliasPinyin=value.aliasPinyin,aliasPinyin!==value.aliasName&&(aliasPinyin+=value.aliasName),result=name+"("+value.aliasName+")"):(aliasPinyin="",result=name),{name:name,photo:value.photo,photoCls:"normal",filter:pinyin+aliasPinyin,userId:value.userId,isHold:!1,result:result}});names.push({name:"所有人",photo:"",photoCls:"all",filter:"所有人suoyoureneveryone",userId:"all",isHold:!1,result:"所有人"}),element.atwho({at:"@",tpl:'<li title="${result}" class="at-li" data-value="@${name}"><img class="${photoCls}" src="${photo}"/> <div class="username">${result}</div></li>',data:names,limit:50,search_key:"filter",start_with_space:!1})}}scope.$on(memberService.EVENT.CHANGED,function(evt,members){initAtWho(members)}),initAtWho(memberService.getMembers()),scope.$on("$destroy",function(){var id=element[0].atwhoId;$("#"+id).remove()})}return{restrict:"A",link:link}}}),define("common/widgets/focus",["jquery"],function(){"use strict";return function($parse){function link(scope,el,attr){function onChange(newState){state=newState,setTimeout(function(){el[state?"focus":"blur"]()},100)}function onFocus(){state||setter&&(state=!0,scope.$apply(function(){setter(scope,!0)}))}function onBlur(){state&&setter&&(state=!1,scope.$apply(function(){setter(scope,!1)}))}var state,getter=$parse(attr.widgetFocus),setter=getter.assign;el.on("focus",onFocus).on("blur",onBlur),scope.$watch(function(){return getter(scope)},onChange)}return{link:link}}}),define("common/widgets/loading/loadingDirective",["underscore"],function(){"use strict";return function(){return{restrict:"AC",templateUrl:"common/widgets/loading/loading.html"}}}),define("common/widgets/trackerDirective",["underscore","util/tracker"],function(_,tracker){"use strict";return function(){function link(scope,el,attr){var category=attr.trackCategory,action=attr.trackAction,opt_label=attr.trackLabel,opt_value=attr.trackValue;category&&action&&el.click(function(){tracker.event(category,action,opt_label,opt_value)})}return{restrict:"A",link:link}}}),define("common/widgets/highlight",["underscore","util/emoji"],function(_,emoji){"use strict";return function($filter){function link(scope,el,attr){function parse(){var keywords,str=scope.highValue,value=scope.keyword,result="";if(str=str.replace(new RegExp("&","g"),"&amp;").replace(new RegExp('"',"g"),"&quot;").replace(new RegExp("<","g"),"&lt;").replace(new RegExp(">","g"),"&gt;").replace(new RegExp(" ","g"),"&nbsp;"),!value)return void el.html(str);keywords=value.split(/[\s\'\"\‘\“\”\’\’\,\，\。\*\、\~\!\@\#\$\%\&\<\>\《\》\?\|\(\)\（\）\[\]\【\】\.\^\/\+\_\-\=\{\}\;\`\·\！\￥\……\——\-\：\；\？]+/),keywords=_.without(keywords,"");for(var emotionRegexp=emoji[0].Tag+";",i=1;i<emoji.length;i++)emotionRegexp=emotionRegexp+"|"+emoji[i].Tag+";";emotionRegex=new RegExp(emotionRegexp,"g"),keywordRegex=new RegExp("("+keywords.join("|").replace("\\","\\\\")+")","ig");var contentArray=str.split(emotionRegex)?str.split(emotionRegex):[""],emotionArray=str.match(emotionRegex)?str.match(emotionRegex):[""];if(contentArray)for(var i=0;i<contentArray.length;i++)contentArray[i]=contentArray[i].replace(keywordRegex,'<span class="highlight">$1</span>');if(0==str.search(emotionRegex))for(var i=0;i<contentArray.length;i++)emotionArray[i]&&(result+=emotionArray[i]),contentArray[i+1]&&(result+=contentArray[i+1]);else for(var i=0;i<contentArray.length;i++)contentArray[i]&&(result+=contentArray[i]),emotionArray[i]&&(result+=emotionArray[i]);if(beforeFilters){beforeFilters=beforeFilters.split(",");for(var i=0;i<beforeFilters.length;i++)result=$filter(beforeFilters[i])(result)}if(afterFilters){afterFilters=afterFilters.split(",");for(var i=0;i<afterFilters.length;i++)result=$filter(afterFilters[i])(result)}el.html(result),enableLinkify&&el.linkify()}var keywordRegex,emotionRegex,beforeFilters=attr.beforeFilters,afterFilters=attr.afterFilters,enableLinkify=attr.enableLinkify;scope.$watch("highValue",function(){parse()})}return{restrict:"A",link:link,scope:{highValue:"@",keyword:"@"}}}}),define("common/widgets/menu/copyMenu",[],function(){"use strict";return function(menuService,clientProxy){function link(scope,el){clientProxy.isPC()&&el.on("contextmenu",openMenu)}function openMenu(e){var sel=window.getSelection();"Range"===sel.type&&(e.preventDefault(),menuService.open({x:e.pageX,y:e.pageY,items:[{label:"复制",handler:copy}]}))}function copy(){document.execCommand("copy")}return{link:link}}}),define("common/widgets/mask",["jquery"],function($){"use strict";return function(){var ct=0;return{push:function(){ct++,$(".mask-all").show()},pop:function(){ct--,0>=ct&&$(".mask-all").hide()}}}}),define("common/widgets/permissionCheckDirective",[],function(){"use strict";return function(permission,launcher,ROLES){function link(scope,el,attr){var action=attr.permissionCheck,gray=attr.gray;scope.$watch(function(){return launcher.getCurrentRole()},function(newVal){permission.check(action)?el.show():-1!==newVal.indexOf(ROLES.GROUP_READER)&&"true"==gray?el.show():el.hide()},!0)}return{restrict:"A",link:link}}}),define("common/widgets/filePermissionCheckDirective",[],function(){"use strict";return function($rootScope,$parse,filePermission){function link(scope,el,attr){function init(file){("true"==needReadonly&&file.isOnlyManagerEdit||!needReadonly)&&filePermission.check(action,file)?("true"==needReadonly&&el.parent().addClass("hasReadOnlyTip"),el.show()):el.hide()}var action=attr.filePermissionCheck,needReadonly=attr.filePermissionNeedReadonly;scope.$watch(function(){return $parse(attr.filePermissionFile)(scope)},function(newValue){newValue&&init(newValue)})}return{restrict:"A",link:link}}}),define("common/widgets/icon/showIconDirective",["jquery"],function($){return function(dialogs){var link=function($scope,ele,attrs){var $dialog=$scope.$dialog;$scope.title=attrs.errorTitle||"错误",$dialog.width=435,$dialog.height=230,$scope.imgReady=!1;var confirm=function(){$dialog.dismiss($scope.coords)},cancel=function(){$dialog.cancel()};$scope.coords={},$dialog.title="上传新头像",$dialog.buttons=[{text:"保存",cls:"btn btn-confirm",handler:confirm},{text:"取消",cls:"btn btn-cancel cancel",handler:cancel}],$scope.task.upload("/yws/api/image?method=upload").then(function(res){var json=$.parseJSON(res.text);$scope.iconImagePath="/yws/api/image/"+json.imagePath+"?method=getTempUpload",$scope.imagePath=json.imagePath,$scope.imgReady=!0}).catch(function(res){if($dialog.dismiss(),res.status&&500===res.status){var json=$.parseJSON(res.text);json.error&&"10013"===json.error?dialogs.alert($scope.title,"上传图片格式不正确"):json.error&&"10011"===json.error?dialogs.alert($scope.title,"上传图片过大"):dialogs.alert($scope.title,"服务器异常，请稍后重试")}else res.status&&413===res.status&&dialogs.alert($scope.title,"上传图片过大")})};return{restrict:"A",link:link,templateUrl:"common/widgets/icon/showIcon.html"}}}),function($){$.Jcrop=function(obj,opt){function px(n){return Math.round(n)+"px"}function cssClass(cl){return options.baseClass+"-"+cl}function supportsColorFade(){return $.fx.step.hasOwnProperty("backgroundColor")}function getPos(obj){var pos=$(obj).offset();return[pos.left,pos.top]}function mouseAbs(e){return[e.pageX-docOffset[0],e.pageY-docOffset[1]]
}function setOptions(opt){"object"!=typeof opt&&(opt={}),options=$.extend(options,opt),$.each(["onChange","onSelect","onRelease","onDblClick"],function(i,e){"function"!=typeof options[e]&&(options[e]=function(){})})}function startDragMode(mode,pos,touch){if(docOffset=getPos($img),Tracker.setCursor("move"===mode?mode:mode+"-resize"),"move"===mode)return Tracker.activateHandlers(createMover(pos),doneSelect,touch);var fc=Coords.getFixed(),opp=oppLockCorner(mode),opc=Coords.getCorner(oppLockCorner(opp));Coords.setPressed(Coords.getCorner(opp)),Coords.setCurrent(opc),Tracker.activateHandlers(dragmodeHandler(mode,fc),doneSelect,touch)}function dragmodeHandler(mode,f){return function(pos){if(options.aspectRatio)switch(mode){case"e":pos[1]=f.y+1;break;case"w":pos[1]=f.y+1;break;case"n":pos[0]=f.x+1;break;case"s":pos[0]=f.x+1}else switch(mode){case"e":pos[1]=f.y2;break;case"w":pos[1]=f.y2;break;case"n":pos[0]=f.x2;break;case"s":pos[0]=f.x2}Coords.setCurrent(pos),Selection.update()}}function createMover(pos){var lloc=pos;return KeyManager.watchKeys(),function(pos){Coords.moveOffset([pos[0]-lloc[0],pos[1]-lloc[1]]),lloc=pos,Selection.update()}}function oppLockCorner(ord){switch(ord){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function createDragger(ord){return function(e){return options.disabled?!1:"move"!==ord||options.allowMove?(docOffset=getPos($img),btndown=!0,startDragMode(ord,mouseAbs(e)),e.stopPropagation(),e.preventDefault(),!1):!1}}function presize($obj,w,h){var nw=$obj.width(),nh=$obj.height();nw>w&&w>0&&(nw=w,nh=w/$obj.width()*$obj.height()),nh>h&&h>0&&(nh=h,nw=h/$obj.height()*$obj.width()),xscale=$obj.width()/nw,yscale=$obj.height()/nh,$obj.width(nw).height(nh)}function unscale(c){return{x:c.x*xscale,y:c.y*yscale,x2:c.x2*xscale,y2:c.y2*yscale,w:c.w*xscale,h:c.h*yscale}}function doneSelect(){var c=Coords.getFixed();c.w>options.minSelect[0]&&c.h>options.minSelect[1]?(Selection.enableHandles(),Selection.done()):Selection.release(),Tracker.setCursor(options.allowSelect?"crosshair":"default")}function newSelection(e){if(options.disabled)return!1;if(!options.allowSelect)return!1;btndown=!0,docOffset=getPos($img),Selection.disableHandles(),Tracker.setCursor("crosshair");var pos=mouseAbs(e);return Coords.setPressed(pos),Selection.update(),Tracker.activateHandlers(selectDrag,doneSelect,"touch"===e.type.substring(0,5)),KeyManager.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function selectDrag(pos){Coords.setCurrent(pos),Selection.update()}function newTracker(){var trk=$("<div></div>").addClass(cssClass("tracker"));return is_msie&&trk.css({opacity:0,backgroundColor:"white"}),trk}function setClass(cname){$div.removeClass().addClass(cssClass("holder")).addClass(cname)}function animateTo(a,callback){function queueAnimator(){window.setTimeout(animator,interv)}var x1=a[0]/xscale,y1=a[1]/yscale,x2=a[2]/xscale,y2=a[3]/yscale;if(!animating){var animto=Coords.flipCoords(x1,y1,x2,y2),c=Coords.getFixed(),initcr=[c.x,c.y,c.x2,c.y2],animat=initcr,interv=options.animationDelay,ix1=animto[0]-initcr[0],iy1=animto[1]-initcr[1],ix2=animto[2]-initcr[2],iy2=animto[3]-initcr[3],pcent=0,velocity=options.swingSpeed;x1=animat[0],y1=animat[1],x2=animat[2],y2=animat[3],Selection.animMode(!0);var animator=function(){return function(){pcent+=(100-pcent)/velocity,animat[0]=Math.round(x1+pcent/100*ix1),animat[1]=Math.round(y1+pcent/100*iy1),animat[2]=Math.round(x2+pcent/100*ix2),animat[3]=Math.round(y2+pcent/100*iy2),pcent>=99.8&&(pcent=100),100>pcent?(setSelectRaw(animat),queueAnimator()):(Selection.done(),Selection.animMode(!1),"function"==typeof callback&&callback.call(api))}}();queueAnimator()}}function setSelect(rect){setSelectRaw([rect[0]/xscale,rect[1]/yscale,rect[2]/xscale,rect[3]/yscale]),options.onSelect.call(api,unscale(Coords.getFixed())),Selection.enableHandles()}function setSelectRaw(l){Coords.setPressed([l[0],l[1]]),Coords.setCurrent([l[2],l[3]]),Selection.update()}function tellSelect(){return unscale(Coords.getFixed())}function tellScaled(){return Coords.getFixed()}function setOptionsNew(opt){setOptions(opt),interfaceUpdate()}function disableCrop(){options.disabled=!0,Selection.disableHandles(),Selection.setCursor("default"),Tracker.setCursor("default")}function enableCrop(){options.disabled=!1,interfaceUpdate()}function cancelCrop(){Selection.done(),Tracker.activateHandlers(null,null)}function destroy(){$div.remove(),$origimg.show(),$origimg.css("visibility","visible"),$(obj).removeData("Jcrop")}function setImage(src,callback){Selection.release(),disableCrop();var img=new Image;img.onload=function(){var iw=img.width,ih=img.height,bw=options.boxWidth,bh=options.boxHeight;$img.width(iw).height(ih),$img.attr("src",src),$img2.attr("src",src),presize($img,bw,bh),boundx=$img.width(),boundy=$img.height(),$img2.width(boundx).height(boundy),$trk.width(boundx+2*bound).height(boundy+2*bound),$div.width(boundx).height(boundy),Shade.resize(boundx,boundy),enableCrop(),"function"==typeof callback&&callback.call(api)},img.src=src}function colorChangeMacro($obj,color,now){var mycolor=color||options.bgColor;options.bgFade&&supportsColorFade()&&options.fadeTime&&!now?$obj.animate({backgroundColor:mycolor},{queue:!1,duration:options.fadeTime}):$obj.css("backgroundColor",mycolor)}function interfaceUpdate(alt){options.allowResize?alt?Selection.enableOnly():Selection.enableHandles():Selection.disableHandles(),Tracker.setCursor(options.allowSelect?"crosshair":"default"),Selection.setCursor(options.allowMove?"move":"default"),options.hasOwnProperty("trueSize")&&(xscale=options.trueSize[0]/boundx,yscale=options.trueSize[1]/boundy),options.hasOwnProperty("setSelect")&&(setSelect(options.setSelect),Selection.done(),delete options.setSelect),Shade.refresh(),options.bgColor!=bgcolor&&(colorChangeMacro(options.shade?Shade.getShades():$div,options.shade?options.shadeColor||options.bgColor:options.bgColor),bgcolor=options.bgColor),bgopacity!=options.bgOpacity&&(bgopacity=options.bgOpacity,options.shade?Shade.refresh():Selection.setBgOpacity(bgopacity)),xlimit=options.maxSize[0]||0,ylimit=options.maxSize[1]||0,xmin=options.minSize[0]||0,ymin=options.minSize[1]||0,options.hasOwnProperty("outerImage")&&($img.attr("src",options.outerImage),delete options.outerImage),Selection.refresh()}var docOffset,options=$.extend({},$.Jcrop.defaults),_ua=navigator.userAgent.toLowerCase(),is_msie=/msie/.test(_ua),ie6mode=/msie [1-6]\./.test(_ua);"object"!=typeof obj&&(obj=$(obj)[0]),"object"!=typeof opt&&(opt={}),setOptions(opt);var img_css={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},$origimg=$(obj),img_mode=!0;if("IMG"==obj.tagName){if(0!=$origimg[0].width&&0!=$origimg[0].height)$origimg.width($origimg[0].width),$origimg.height($origimg[0].height);else{var tempImage=new Image;tempImage.src=$origimg[0].src,$origimg.width(tempImage.width),$origimg.height(tempImage.height)}var $img=$origimg.clone().removeAttr("id").css(img_css).show();$img.width($origimg.width()),$img.height($origimg.height()),$origimg.after($img).hide()}else $img=$origimg.css(img_css).show(),img_mode=!1,null===options.shade&&(options.shade=!0);presize($img,options.boxWidth,options.boxHeight);var boundx=$img.width(),boundy=$img.height(),$div=$("<div />").width(boundx).height(boundy).addClass(cssClass("holder")).css({position:"relative",backgroundColor:options.bgColor}).insertAfter($origimg).append($img);options.addClass&&$div.addClass(options.addClass);var $img2=$("<div />"),$img_holder=$("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),$hdl_holder=$("<div />").width("100%").height("100%").css("zIndex",320),$sel=$("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var c=Coords.getFixed();options.onDblClick.call(api,c)}).insertBefore($img).append($img_holder,$hdl_holder);img_mode&&($img2=$("<img />").attr("src",$img.attr("src")).css(img_css).width(boundx).height(boundy),$img_holder.append($img2)),ie6mode&&$sel.css({overflowY:"hidden"});var xlimit,ylimit,xmin,ymin,xscale,yscale,btndown,animating,shift_down,bound=options.boundary,$trk=newTracker().width(boundx+2*bound).height(boundy+2*bound).css({position:"absolute",top:px(-bound),left:px(-bound),zIndex:290}).mousedown(newSelection),bgcolor=options.bgColor,bgopacity=options.bgOpacity;docOffset=getPos($img);var Touch=function(){function hasTouchSupport(){var i,support={},events=["touchstart","touchmove","touchend"],el=document.createElement("div");try{for(i=0;i<events.length;i++){var eventName=events[i];eventName="on"+eventName;var isSupported=eventName in el;isSupported||(el.setAttribute(eventName,"return;"),isSupported="function"==typeof el[eventName]),support[events[i]]=isSupported}return support.touchstart&&support.touchend&&support.touchmove}catch(err){return!1}}function detectSupport(){return options.touchSupport===!0||options.touchSupport===!1?options.touchSupport:hasTouchSupport()}return{createDragger:function(ord){return function(e){return options.disabled?!1:"move"!==ord||options.allowMove?(docOffset=getPos($img),btndown=!0,startDragMode(ord,mouseAbs(Touch.cfilter(e)),!0),e.stopPropagation(),e.preventDefault(),!1):!1}},newSelection:function(e){return newSelection(Touch.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:hasTouchSupport,support:detectSupport()}}(),Coords=function(){function setPressed(pos){pos=rebound(pos),x2=x1=pos[0],y2=y1=pos[1]}function setCurrent(pos){pos=rebound(pos),ox=pos[0]-x2,oy=pos[1]-y2,x2=pos[0],y2=pos[1]}function getOffset(){return[ox,oy]}function moveOffset(offset){var ox=offset[0],oy=offset[1];0>x1+ox&&(ox-=ox+x1),0>y1+oy&&(oy-=oy+y1),y2+oy>boundy&&(oy+=boundy-(y2+oy)),x2+ox>boundx&&(ox+=boundx-(x2+ox)),x1+=ox,x2+=ox,y1+=oy,y2+=oy}function getCorner(ord){var c=getFixed();switch(ord){case"ne":return[c.x2,c.y];case"nw":return[c.x,c.y];case"se":return[c.x2,c.y2];case"sw":return[c.x,c.y2]}}function getFixed(){if(!options.aspectRatio)return getRect();var xx,yy,w,h,aspect=options.aspectRatio,min_x=options.minSize[0]/xscale,max_x=options.maxSize[0]/xscale,max_y=options.maxSize[1]/yscale,rw=x2-x1,rh=y2-y1,rwa=Math.abs(rw),rha=Math.abs(rh),real_ratio=rwa/rha;return 0===max_x&&(max_x=10*boundx),0===max_y&&(max_y=10*boundy),aspect>real_ratio?(yy=y2,w=rha*aspect,xx=0>rw?x1-w:w+x1,0>xx?(xx=0,h=Math.abs((xx-x1)/aspect),yy=0>rh?y1-h:h+y1):xx>boundx&&(xx=boundx,h=Math.abs((xx-x1)/aspect),yy=0>rh?y1-h:h+y1)):(xx=x2,h=rwa/aspect,yy=0>rh?y1-h:y1+h,0>yy?(yy=0,w=Math.abs((yy-y1)*aspect),xx=0>rw?x1-w:w+x1):yy>boundy&&(yy=boundy,w=Math.abs(yy-y1)*aspect,xx=0>rw?x1-w:w+x1)),xx>x1?(min_x>xx-x1?xx=x1+min_x:xx-x1>max_x&&(xx=x1+max_x),yy=yy>y1?y1+(xx-x1)/aspect:y1-(xx-x1)/aspect):x1>xx&&(min_x>x1-xx?xx=x1-min_x:x1-xx>max_x&&(xx=x1-max_x),yy=yy>y1?y1+(x1-xx)/aspect:y1-(x1-xx)/aspect),0>xx?(x1-=xx,xx=0):xx>boundx&&(x1-=xx-boundx,xx=boundx),0>yy?(y1-=yy,yy=0):yy>boundy&&(y1-=yy-boundy,yy=boundy),makeObj(flipCoords(x1,y1,xx,yy))}function rebound(p){return p[0]<0&&(p[0]=0),p[1]<0&&(p[1]=0),p[0]>boundx&&(p[0]=boundx),p[1]>boundy&&(p[1]=boundy),[Math.round(p[0]),Math.round(p[1])]}function flipCoords(x1,y1,x2,y2){var xa=x1,xb=x2,ya=y1,yb=y2;return x1>x2&&(xa=x2,xb=x1),y1>y2&&(ya=y2,yb=y1),[xa,ya,xb,yb]}function getRect(){var delta,xsize=x2-x1,ysize=y2-y1;return xlimit&&Math.abs(xsize)>xlimit&&(x2=xsize>0?x1+xlimit:x1-xlimit),ylimit&&Math.abs(ysize)>ylimit&&(y2=ysize>0?y1+ylimit:y1-ylimit),ymin/yscale&&Math.abs(ysize)<ymin/yscale&&(y2=ysize>0?y1+ymin/yscale:y1-ymin/yscale),xmin/xscale&&Math.abs(xsize)<xmin/xscale&&(x2=xsize>0?x1+xmin/xscale:x1-xmin/xscale),0>x1&&(x2-=x1,x1-=x1),0>y1&&(y2-=y1,y1-=y1),0>x2&&(x1-=x2,x2-=x2),0>y2&&(y1-=y2,y2-=y2),x2>boundx&&(delta=x2-boundx,x1-=delta,x2-=delta),y2>boundy&&(delta=y2-boundy,y1-=delta,y2-=delta),x1>boundx&&(delta=x1-boundy,y2-=delta,y1-=delta),y1>boundy&&(delta=y1-boundy,y2-=delta,y1-=delta),makeObj(flipCoords(x1,y1,x2,y2))}function makeObj(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var ox,oy,x1=0,y1=0,x2=0,y2=0;return{flipCoords:flipCoords,setPressed:setPressed,setCurrent:setCurrent,getOffset:getOffset,moveOffset:moveOffset,getCorner:getCorner,getFixed:getFixed}}(),Shade=function(){function resizeShades(w,h){shades.left.css({height:px(h)}),shades.right.css({height:px(h)})}function updateAuto(){return updateShade(Coords.getFixed())}function updateShade(c){shades.top.css({left:px(c.x),width:px(c.w),height:px(c.y)}),shades.bottom.css({top:px(c.y2),left:px(c.x),width:px(c.w),height:px(boundy-c.y2)}),shades.right.css({left:px(c.x2),width:px(boundx-c.x2)}),shades.left.css({width:px(c.x)})}function createShade(){return $("<div />").css({position:"absolute",backgroundColor:options.shadeColor||options.bgColor}).appendTo(holder)}function enableShade(){enabled||(enabled=!0,holder.insertBefore($img),updateAuto(),Selection.setBgOpacity(1,0,1),$img2.hide(),setBgColor(options.shadeColor||options.bgColor,1),Selection.isAwake()?setOpacity(options.bgOpacity,1):setOpacity(1,1))}function setBgColor(color,now){colorChangeMacro(getShades(),color,now)}function disableShade(){enabled&&(holder.remove(),$img2.show(),enabled=!1,Selection.isAwake()?Selection.setBgOpacity(options.bgOpacity,1,1):(Selection.setBgOpacity(1,1,1),Selection.disableHandles()),colorChangeMacro($div,0,1))}function setOpacity(opacity,now){enabled&&(options.bgFade&&!now?holder.animate({opacity:1-opacity},{queue:!1,duration:options.fadeTime}):holder.css({opacity:1-opacity}))}function refreshAll(){options.shade?enableShade():disableShade(),Selection.isAwake()&&setOpacity(options.bgOpacity)}function getShades(){return holder.children()}var enabled=!1,holder=$("<div />").css({position:"absolute",zIndex:240,opacity:0}),shades={top:createShade(),left:createShade().height(boundy),right:createShade().height(boundy),bottom:createShade()};return{update:updateAuto,updateRaw:updateShade,getShades:getShades,setBgColor:setBgColor,enable:enableShade,disable:disableShade,resize:resizeShades,refresh:refreshAll,opacity:setOpacity}}(),Selection=function(){function insertBorder(type){var jq=$("<div />").css({position:"absolute",opacity:options.borderOpacity}).addClass(cssClass(type));return $img_holder.append(jq),jq}function dragDiv(ord,zi){var jq=$("<div />").mousedown(createDragger(ord)).css({cursor:ord+"-resize",position:"absolute",zIndex:zi}).addClass("ord-"+ord);return Touch.support&&jq.bind("touchstart.jcrop",Touch.createDragger(ord)),$hdl_holder.append(jq),jq}function insertHandle(ord){var hs=options.handleSize,div=dragDiv(ord,hdep++).css({opacity:options.handleOpacity}).addClass(cssClass("handle"));return hs&&div.width(hs).height(hs),div}function insertDragbar(ord){return dragDiv(ord,hdep++).addClass("jcrop-dragbar")}function createDragbars(li){var i;for(i=0;i<li.length;i++)dragbar[li[i]]=insertDragbar(li[i])}function createBorders(li){var cl,i;for(i=0;i<li.length;i++){switch(li[i]){case"n":cl="hline";break;case"s":cl="hline bottom";break;case"e":cl="vline right";break;case"w":cl="vline"}borders[li[i]]=insertBorder(cl)}}function createHandles(li){var i;for(i=0;i<li.length;i++)handle[li[i]]=insertHandle(li[i])}function moveto(x,y){options.shade||$img2.css({top:px(-y),left:px(-x)}),$sel.css({top:px(y),left:px(x)})}function resize(w,h){$sel.width(Math.round(w)).height(Math.round(h))}function refresh(){var c=Coords.getFixed();Coords.setPressed([c.x,c.y]),Coords.setCurrent([c.x2,c.y2]),updateVisible()}function updateVisible(select){return awake?update(select):void 0}function update(select){var c=Coords.getFixed();resize(c.w,c.h),moveto(c.x,c.y),options.shade&&Shade.updateRaw(c),awake||show(),select?options.onSelect.call(api,unscale(c)):options.onChange.call(api,unscale(c))}function setBgOpacity(opacity,force,now){(awake||force)&&(options.bgFade&&!now?$img.animate({opacity:opacity},{queue:!1,duration:options.fadeTime}):$img.css("opacity",opacity))}function show(){$sel.show(),options.shade?Shade.opacity(bgopacity):setBgOpacity(bgopacity,!0),awake=!0}function release(){disableHandles(),$sel.hide(),options.shade?Shade.opacity(1):setBgOpacity(1),awake=!1,options.onRelease.call(api)}function showHandles(){seehandles&&$hdl_holder.show()}function enableHandles(){return seehandles=!0,options.allowResize?($hdl_holder.show(),!0):void 0}function disableHandles(){seehandles=!1,$hdl_holder.hide()}function animMode(v){v?(animating=!0,disableHandles()):(animating=!1,enableHandles())}function done(){animMode(!1),refresh()}var awake,hdep=370,borders={},handle={},dragbar={},seehandles=!1;options.dragEdges&&$.isArray(options.createDragbars)&&createDragbars(options.createDragbars),$.isArray(options.createHandles)&&createHandles(options.createHandles),options.drawBorders&&$.isArray(options.createBorders)&&createBorders(options.createBorders),$(document).bind("touchstart.jcrop-ios",function(e){$(e.currentTarget).hasClass("jcrop-tracker")&&e.stopPropagation()});var $track=newTracker().mousedown(createDragger("move")).css({cursor:"move",position:"absolute",zIndex:360});return Touch.support&&$track.bind("touchstart.jcrop",Touch.createDragger("move")),$img_holder.append($track),disableHandles(),{updateVisible:updateVisible,update:update,release:release,refresh:refresh,isAwake:function(){return awake},setCursor:function(cursor){$track.css("cursor",cursor)},enableHandles:enableHandles,enableOnly:function(){seehandles=!0},showHandles:showHandles,disableHandles:disableHandles,animMode:animMode,setBgOpacity:setBgOpacity,done:done}}(),Tracker=function(){function toFront(touch){$trk.css({zIndex:450}),touch?$(document).bind("touchmove.jcrop",trackTouchMove).bind("touchend.jcrop",trackTouchEnd):trackDoc&&$(document).bind("mousemove.jcrop",trackMove).bind("mouseup.jcrop",trackUp)}function toBack(){$trk.css({zIndex:290}),$(document).unbind(".jcrop")}function trackMove(e){return onMove(mouseAbs(e)),!1}function trackUp(e){return e.preventDefault(),e.stopPropagation(),btndown&&(btndown=!1,onDone(mouseAbs(e)),Selection.isAwake()&&options.onSelect.call(api,unscale(Coords.getFixed())),toBack(),onMove=function(){},onDone=function(){}),!1}function activateHandlers(move,done,touch){return btndown=!0,onMove=move,onDone=done,toFront(touch),!1}function trackTouchMove(e){return onMove(mouseAbs(Touch.cfilter(e))),!1}function trackTouchEnd(e){return trackUp(Touch.cfilter(e))}function setCursor(t){$trk.css("cursor",t)}var onMove=function(){},onDone=function(){},trackDoc=options.trackDocument;return trackDoc||$trk.mousemove(trackMove).mouseup(trackUp).mouseout(trackUp),$img.before($trk),{activateHandlers:activateHandlers,setCursor:setCursor}}(),KeyManager=function(){function watchKeys(){options.keySupport&&($keymgr.show(),$keymgr.focus())}function onBlur(){$keymgr.hide()}function doNudge(e,x,y){options.allowMove&&(Coords.moveOffset([x,y]),Selection.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}function parseKey(e){if(e.ctrlKey||e.metaKey)return!0;shift_down=e.shiftKey?!0:!1;var nudge=shift_down?10:1;switch(e.keyCode){case 37:doNudge(e,-nudge,0);break;case 39:doNudge(e,nudge,0);break;case 38:doNudge(e,0,-nudge);break;case 40:doNudge(e,0,nudge);break;case 27:options.allowSelect&&Selection.release();break;case 9:return!0}return!1}var $keymgr=$('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),$keywrap=$("<div />").css({position:"absolute",overflow:"hidden"}).append($keymgr);return options.keySupport&&($keymgr.keydown(parseKey).blur(onBlur),ie6mode||!options.fixedSupport?($keymgr.css({position:"absolute",left:"-20px"}),$keywrap.append($keymgr).insertBefore($img)):$keymgr.insertBefore($img)),{watchKeys:watchKeys}}();Touch.support&&$trk.bind("touchstart.jcrop",Touch.newSelection),$hdl_holder.hide(),interfaceUpdate(!0);var api={setImage:setImage,animateTo:animateTo,setSelect:setSelect,setOptions:setOptionsNew,tellSelect:tellSelect,tellScaled:tellScaled,setClass:setClass,disable:disableCrop,enable:enableCrop,cancel:cancelCrop,release:Selection.release,destroy:destroy,focus:KeyManager.watchKeys,getBounds:function(){return[boundx*xscale,boundy*yscale]},getWidgetSize:function(){return[boundx,boundy]},getScaleFactor:function(){return[xscale,yscale]},getOptions:function(){return options},ui:{holder:$div,selection:$sel}};return is_msie&&$div.bind("selectstart",function(){return!1}),$origimg.data("Jcrop",api),api},$.fn.Jcrop=function(options,callback){var api;return this.each(function(){if($(this).data("Jcrop")){if("api"===options)return $(this).data("Jcrop");$(this).data("Jcrop").setOptions(options)}else"IMG"==this.tagName?$.Jcrop.Loader(this,function(){$(this).css({display:"block",visibility:"hidden"}),api=$.Jcrop(this,options),$.isFunction(callback)&&callback.call(api)}):($(this).css({display:"block",visibility:"hidden"}),api=$.Jcrop(this,options),$.isFunction(callback)&&callback.call(api))}),this},$.Jcrop.Loader=function(imgobj,success,error){function completeCheck(){img.complete?($img.unbind(".jcloader"),$.isFunction(success)&&success.call(img)):window.setTimeout(completeCheck,50)}var $img=$(imgobj),img=$img[0];$img.bind("load.jcloader",completeCheck).bind("error.jcloader",function(){$img.unbind(".jcloader"),$.isFunction(error)&&error.call(img)}),img.complete&&$.isFunction(success)&&($img.unbind(".jcloader"),success.call(img))},$.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery),define("jcrop",["jquery"],function(global){return function(){var ret;return ret||global.jQuery}}(this)),define("common/widgets/icon/changeIconDirective",["underscore","jquery","jcrop"],function(_,$){"use strict";return function(){function link(scope,el){function updateCoords(c){if(c.photo=scope.imagePath,$(".img-loading").hide(),scope.$parent.coords=c,parseInt(c.w,10)>0){var rx=xsize/c.w,ry=ysize/c.h;$pimg.css({width:Math.round(rx*boundx)+"px",height:Math.round(ry*boundy)+"px",marginLeft:"-"+Math.round(rx*c.x)+"px",marginTop:"-"+Math.round(ry*c.y)+"px"})}}var jcrop_api,boundx,boundy,$el=$(el),$pcnt=($(".show-icon-box"),$(".show-icon .preview"),$(".show-icon .preview .preview-container")),$pimg=$(".show-icon .preview .preview-img"),xsize=$pcnt.width(),ysize=$pcnt.height(),loaded=!1;$el.Jcrop({onSelect:updateCoords,onChange:updateCoords,onRelease:function(){if(loaded){var dim=jcrop_api.getBounds(),w=dim[0],h=dim[1],x1=w/2-96,x2=w/2+96,y1=h/2-96,y2=h/2+96;jcrop_api.setSelect([x1,y1,x2,y2])}},minSize:[1,1],maxSize:[2e3,2e3],aspectRatio:1,allowSelect:!1,boxWidth:260,boxHeight:200,bgOpacity:.4},function(){jcrop_api=this,jcrop_api.setImage(scope.iconImagePath,function(){loaded=!0;var margin,dim=jcrop_api.getBounds(),w=dim[0],h=dim[1],x1=w/2-96,x2=w/2+96,y1=h/2-96,y2=h/2+96,height=jcrop_api.ui.holder.height();200>height&&(margin=(200-height)/2,jcrop_api.ui.holder.css("margin-top",margin)),boundx=w,boundy=h,jcrop_api.setSelect([x1,y1,x2,y2]),jcrop_api.animateTo([x1,y1,x2,y2])})})}return{restrict:"A",link:link}}}),define("common/widgets/icon/defaultImageDirective",[],function(){"use strict";return function(){var link=function($scope,element,attrs){element.bind("error",function(){attrs.src!==attrs.defaultSrc&&attrs.$set("src",attrs.defaultSrc)})};return{restrict:"A",link:link}}}),define("common/widgets/clipboard/clipButtonDirective",["underscore","jquery"],function(_,$){"use strict";var preventDismiss=_.once(function(){$("#global-zeroclipboard-html-bridge").on("mousedown",function(event){event.stopPropagation()})});return function(clientProxy){var templateString="";if(!clientProxy.isMac()){templateString=clientProxy.isPC()?'<div class="btn-copy" ng-bind="copyBtnText()" ng-disabled="copyBtnDisabled" ng-click="copyTextFromClient()"></div>':'<div class="btn-copy" ng-bind="copyBtnText()" ng-disabled="copyBtnDisabled" clipboard="clipboardOptions"></div>';var preLink=function($scope,element){var copyBtn={text:"",disabled:!1},onComplete=function(){_.isFunction($scope.callback)&&$scope.callback.apply($scope,copyBtn);var event=new Event("complete",{bubbles:!0});element[0].dispatchEvent(event)};$scope.copyBtnText=function(){return copyBtn.text},$scope.clipboardOptions={copyValue:$scope.content,oncomplete:onComplete},$scope.copyTextFromClient=function(){clientProxy.copyText($scope.content),onComplete()}},postLink=function($scope,element){var flashBtn=element.find(".btn-copy")[0],rootEl=$(".share-manager");flashBtn.addEventListener("zeroclipboard-is-hover",function(){element.parent().addClass("share-hover"),element.addClass("share-hover"),rootEl.addClass("share-hover")}),flashBtn.addEventListener("zeroclipboard-not-hover",function(){element.parent().trigger("mouseover"),element.parent().removeClass("share-hover"),setTimeout(function(){element.removeClass("share-hover"),rootEl.removeClass("share-hover")},50)}),preventDismiss()};return{restrict:"A",link:{pre:preLink,post:postLink},template:templateString,scope:{callback:"=clipCallback",content:"@clipContent"}}}}}),define("common/widgets/bubble/bubbleDirective",["jquery","underscore"],function($,_){"use strict";return function(){function link(scope,el,attrs){function hide(){$content&&($content.removeClass("active"),attrs.widgetBubbleComplete?$content&&($content.remove(),$content=null):setTimeout(function(){$content&&($content.remove(),$content=null)},300))}function show(content,isComplete){var width,elWidth,offset=el.offset();$content&&($content.remove(),$content=null),$content=$('<div class="widget-bubble"><span>'+content+'</span><i class="arrow"></i></div>'),isComplete&&$content.addClass("complete"),$("body").append($content),width=$content.outerWidth(),elWidth=el.width(),$content.css({left:offset.left+elWidth/2-width/2,top:offset.top+TOP_OFFSET,display:"block"}),setTimeout(function(){$content&&$content.addClass("active")},50),$content.find(".arrow").css("left",width/2-ARROW_WIDTH/2)}var $content,showTime=attrs.widgetBubbleTimes?JSON.parse(attrs.widgetBubbleTimes):1e3;attrs.widgetBubbleOn||attrs.widgetBubbleComplete||(el.on("mouseenter",function(){return show(attrs.widgetBubble),!1}),el.on("mouseout",function(){return hide(),!1})),attrs.widgetBubbleComplete&&(el.on("mouseover",function(){return show(attrs.widgetBubble),!1}),el.on("mouseout",function(){return hide(),!1}),el.on("complete",function(){return show(attrs.widgetBubbleComplete,!0),!1})),scope.$on(attrs.widgetBubbleOn,function(){_.throttle(function(){show(attrs.widgetBubble),setTimeout(function(){hide()},showTime)},showTime+PENDING_TIME)()}),scope.$on("$destroy",function(){hide()})}var TOP_OFFSET=-30,ARROW_WIDTH=10,PENDING_TIME=1e3;return{restrict:"A",link:link}}}),define("common/widgets/shadowModelDirective",[],function(){"use strict";return[function(){function prelink(scope,element,attrs){var name=attrs.shadowModel,originalModel=scope[name];scope[name]=angular.copy(originalModel),scope.shadowModelCommit=function(){"object"==typeof scope[name]?angular.copy(scope[name],originalModel):scope.$parent[name]=scope[name]},scope.shadowModelOriginal=function(){return originalModel}}return{restrict:"A",compile:function(){return{pre:prelink}},scope:!0}}]}),define("common/widgets/popover",[],function(){return function(module){module.directive("popover",["$compile",function($compile){var $body=$(document.body);return{restrict:"A",scope:{popover:"@",data:"="},link:function($scope,$element){$scope.target=$element,$scope.close=function(){$scope.opened=!1,$scope.$apply()},$scope.open=function(){$scope.opened=!0,$scope.$apply()},$element.on("click",function(){"undefined"==typeof $scope.opened&&$body.prepend($compile('<popover-popup ng-if="opened"></popover-popup>')($scope)),$scope.opened?$scope.close():$scope.open()})}}}]),module.directive("popoverPopup",[function(){var $body=$(document.body);return{restrict:"E",replace:!0,templateUrl:"common/widgets/popover.html",link:function($scope,$element){function close(evt){$element.has(evt.target).length||$element.is(evt.target)||$target.has(evt.target).length||$target.is(evt.target)||$scope.close()}var $target=$scope.target,offset=$target.offset();$scope.top=offset.top,$scope.left=offset.left+$target.outerWidth(),$body.on("click",close),$scope.$on("$destroy",function(){$element.remove(),$body.off("click",close)})}}}])}}),define("common/widgets/comment/comment",[],function(){return function(module){module.directive("comment",["$location",function($location){function link(scope,element){el=element}var gid,uid,el,$scroll,pages,PAGE_SIZE=10,pageIndex=0,comments=[],versionList=[],ctrl=function($rootScope,$scope,$q,$filter,dialogService,launcher,commentService,commentFactory,tableService,fileManager){function remove(id){dialogService.confirm("删除评论","确定要删除本评论吗？").then(function(){commentService.remove($scope.type,gid,$scope.entryId,id).then(function(json){var json=json.data;_.findWhere($scope.comments,{id:json.id})&&getPageComments(1===$scope.comments.length?pageIndex:pageIndex+1)},function(){})})}function reply(comment){comment.expandReply=!comment.expandReply,$rootScope.isReplying||(comments=[]);var replyExpandedComments;comments[comment.id]=comment.expandReply,replyExpandedComments=_.filter(comments,function(tempComment){return tempComment===!0}),$rootScope.isReplying=replyExpandedComments.length>0?!0:!1,$rootScope.isReplying||(comments=[],resetPages(),getPageComments(pageIndex+1))}function getRevisions(file){function getVersionList(list){var tempVersion;versionList=[],_.each(list,function(version){tempVersion={},tempVersion.time=Number(version.histTbLastOpsTime||version.lastModifiedDate.getTime()),tempVersion.date=new Date(tempVersion.time),tempVersion.versionNo=Number(version.histTbVerNO||version.version),versionList.unshift(tempVersion)}),defer.resolve(versionList)}function getTableVersionList(gid,fileId,token,userId){tableService.getRevisions(gid,fileId,token,userId).then(function(list){getVersionList(list)},function(){defer.reject()})}var defer=$q.defer();if(2===file.domain){var token;_.isUndefined($scope.fileToken)?tableService.allocate(gid,Number(file.id)).then(function(res){token=res,getTableVersionList(gid,Number(file.id),token,uid)}):(token=$scope.fileToken,getTableVersionList(gid,Number(file.id),token,uid))}else fileManager.listRevision(gid,Number(file.id)).then(function(list){getVersionList(list)},function(){defer.reject()});return defer.promise}function getPageComments(pageNum){function getVersion(time,versionList){var i,result;for(i=0;i<versionList.length-1;i++)if(time>=versionList[i].time&&time<versionList[i+1].time){result=versionList[i].versionNo;break}return _.isUndefined(result)&&(result=versionList[versionList.length-1].versionNo),result}function setCommentsWithoutVersion(json){$scope.comments=[],_.each(json,function(data){var comment=commentFactory(data,uid);$scope.comments.push(comment)})}commentService.list($scope.type,gid,$scope.entryId,pageNum,PAGE_SIZE).then(function(json){var json=json.data;return $scope.comments=[],0===json.length?void($scope.comments=json):"task"===$scope.type?void setCommentsWithoutVersion(json):void getRevisions($scope.file).then(function(versionList){var i,comment,lastCommentVersion,previousCommentVersion;for(lastCommentVersion=previousCommentVersion=getVersion(json[json.length-1].createTime,versionList),i=json.length-1;i>=0;i--)comment=commentFactory(json[i],uid),i<json.length-1&&previousCommentVersion<versionList.length&&comment.createTime>=versionList[previousCommentVersion].time&&(comment.version=previousCommentVersion=getVersion(comment.createTime,versionList)),_.findWhere($scope.comments,{id:comment.id})||$scope.comments.unshift(comment);
commentService.list($scope.type,gid,$scope.entryId,pageNum+1,PAGE_SIZE).then(function(json){var json=json.data;(0===json.length||lastCommentVersion!==getVersion(json[0].createTime,versionList))&&$scope.comments.length>=1&&($scope.comments[$scope.comments.length-1].version=lastCommentVersion)})},function(){setCommentsWithoutVersion(json)})},function(){$scope.comments=[],console.log("load comments error")})}function getPage(){return Math.floor($scope.sum/PAGE_SIZE)+($scope.sum%PAGE_SIZE?1:0)}function getPages(){return pages}function getPageSize(){return PAGE_SIZE}function getPageIndex(){return pageIndex}function resetPagesWithOverflow(page){var left,right,index=getPageIndex();left=0>=index-3?_.range(0,index):index+3>=page-1?_.union([0,-1],_.range(index-(5-page+index),index)):_.union([0,-1],_.range(index-2,index)),right=index+3>=page-1?_.range(index,page):0>=index-3?_.union(_.range(index,5),[-2,page-1]):_.union(_.range(index+1,index+3),[-2,page-1]),pages=_.union(left,[index],right)}function resetPages(){var page=getPage();return pageIndex=Math.max(0,Math.min(pageIndex,page-1)),7>=page?void(pages=_.range(page)):void resetPagesWithOverflow(page)}function setPageIndex(newIndex){0>newIndex||newIndex>=getPage()||(pageIndex=newIndex,resetPages(),getPageComments(pageIndex+1))}function init(){$scope.highlightId=$scope.commentId,gid=launcher.getGroup()?launcher.getGroup().id:$location.url().split("-")[2],uid=launcher.getUser().userId,$scroll=el.find(".comment-bd"),$scope.comments=[],pageIndex=0;var isFull=-1!=$location.url().search("full");$scope.highlightId&&!isFull?commentService.locate($scope.type,gid,$scope.entryId,$scope.highlightId).then(function(json){var json=json.data,locate=json.index;-1===locate&&(dialogService.alert("打开评论","评论已被删除"),getPageComments(pageIndex+1),resetPages()),pageIndex=parseInt(locate/PAGE_SIZE),getPageComments(pageIndex+1),resetPages()},function(){dialogService.alert("打开评论","评论已被删除"),getPageComments(pageIndex+1),resetPages()}):(getPageComments(pageIndex+1),resetPages())}$scope.$on("socket.event.8",function(evt,content,value){Number(value.groupId)!==Number(gid)||Number(value.fileId)!==Number($scope.entryId)&&Number(value.taskId)!==Number($scope.entryId)||3===content.operation&&($scope.sum--,resetPages(),getPageComments(pageIndex+1))}),$scope.$on("comment.send",function(evt,comment){Number(comment.groupId)!==Number(gid)||Number(comment.fileId)!==Number($scope.entryId)&&Number(comment.taskId)!==Number($scope.entryId)||(0===pageIndex&&(comment=commentFactory(comment,uid),"file"===$scope.type&&0===$scope.sum&&(comment.version=$scope.file.version),$scope.comments.length===PAGE_SIZE&&$scope.comments.splice($scope.comments.length-1),$scope.comments.unshift(comment)),$scope.sum++,resetPages())}),$scope.$on("comment.send.success",function(evt,data){var localId=data.localId;$scope.comments=_.map($scope.comments,function(comment){return comment.localId===localId&&(comment=commentFactory(data.json,uid)),comment})}),$scope.$on("comment.send.error",function(evt,data){var localId=data.localId;_.each($scope.comments,function(comment){return comment.localId===localId?void(comment.error=!0):void 0})}),$scope.$watch("[entryId, commentId]",function(newValue){{var fileId=newValue[0];newValue[1]}fileId&&newValue&&init()},!0),$scope.$on("comment.fresh",init),$scope.getPage=getPage,$scope.getPageSize=getPageSize,$scope.getPageIndex=getPageIndex,$scope.setPageIndex=setPageIndex,$scope.getPages=getPages,$scope.remove=remove,$scope.reply=reply};return{restrict:"A",templateUrl:"common/widgets/comment/comment.html",controller:["$rootScope","$scope","$q","$filter","dialogService","launcher","commentService","commentFactory","tableService","fileManager",ctrl],scope:{sum:"@",file:"=",type:"@",entryId:"@",commentId:"@",getUser:"&",fileToken:"=",groupId:"@"},link:link}}])}}),define("util/inputTool",["underscore"],function(){"use strict";function setCursor(node,pos){var node="string"==typeof node||node instanceof String?document.getElementById(node):node;if(!node)return!1;if(node.createTextRange){var textRange=node.createTextRange();return textRange.collapse(!0),textRange.moveEnd(pos),textRange.moveStart(pos),textRange.select(),!0}return node.setSelectionRange?(node.setSelectionRange(pos,pos),!0):!1}function insertValue(element,caretPos,value){var newValue,oldValue=element.val();return newValue=oldValue.substring(0,caretPos)+value+oldValue.substring(caretPos),element.val(newValue),setCursor(element[0],caretPos+value.length),newValue}return{insertValue:insertValue}}),define("util/guid",[],function(){"use strict";var guid;return guid=function(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}}()}),define("common/widgets/comment/input/sendCommentDirective",["underscore","jquery","util/inputTool","util/keycode","util/guid"],function(_,$,inputTool,KEYCODE,GUID){"use strict";return function(commentService,commentLocal,launcher,memberService){function link(scope,element){function sendComment(){var targets,sync,content,comment,localId;content=$textarea.val(),content&&(targets=memberService.getAtTargets(content),sync=-1===targets.indexOf("all"),localId=GUID(),comment={commenter:launcher.getUser(),content:content,createTime:(new Date).getTime(),localId:localId,id:localId,groupId:Number(launcher.gid()||scope.gid),removed:!1,replyComment:null,replyId:0},scope.fileId?(_.extend(comment,{fileId:scope.fileId}),commentLocal.trigger(localId,comment),commentService.add("file",launcher.getGroup().id,scope.fileId,content,0,targets,sync,localId).then(function(json){scope.$emit("comment.send.success",{localId:localId,json:json})},function(){console.log("add comment failed"),scope.$emit("comment.send.error",{localId:localId})})):scope.taskId&&(_.extend(comment,{taskId:scope.taskId}),commentLocal.trigger(localId,comment),commentService.add("task",launcher.getGroup()?launcher.getGroup().id:scope.gid,scope.taskId,content,0,targets,sync,localId).then(function(json){scope.$emit("comment.send.success",{localId:localId,json:json})},function(){console.log("add comment failed"),scope.$emit("comment.send.error",{localId:localId})})),scope.content="",$textarea.animate({height:"40px"},{duration:400,queue:!1}),$sendBtn.hide(),$emojiBtn.hide(),$textarea.attr("placeholder","输入评论或@群成员…"),element.css("margin-bottom","10px"))}function onTextareaBlur(){caretPos=$textarea[0].selectionStart}function onSendBtnClick(){return sendComment(),!1}function onTextareaKeydown(e){return e.altKey&&e.keyCode===KEYCODE.S?(sendComment(),$(this).blur(),!1):e.keyCode!==KEYCODE.ENTER||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey?e.keyCode===KEYCODE.ENTER?(document.execCommand("insertParagraph"),!1):void 0:(e.isPropagationStopped()||(sendComment(),$(this).blur()),!1)}function onTextareFocusin(){return $textarea.animate({height:"108px"},{duration:400,queue:!1}),$sendBtn.css("display","inline-block"),$emojiBtn.css("display","block"),element.css("margin-bottom","40px"),!1}function onBodyClick(evt){if(!$textarea.val()){var className=evt.target.className;_.isFunction(className.indexOf)&&-1===className.indexOf("comment-send-emoji")&&-1===className.indexOf("comment-input")&&-1===className.indexOf("comment-send")&&"108px"===$textarea.css("height")&&($textarea.animate({height:"40px"},{duration:400,queue:!1}),$sendBtn.hide(),$emojiBtn.hide(),element.css("margin-bottom","10px"))}}var $sendBtn,$textarea,$emojiBtn,caretPos=0;$sendBtn=element.find(".comment-sendBtn"),$textarea=element.find("textarea"),$emojiBtn=element.find(".comment-send-emoji"),scope.addEmoji=function(tag){scope.content=inputTool.insertValue($textarea,caretPos,tag)},$textarea.on("blur",onTextareaBlur),$sendBtn.on("click",onSendBtnClick),$textarea.on("keydown",onTextareaKeydown),$textarea.on("focusin",onTextareFocusin),$("body").on("click",onBodyClick),scope.$on("$destroy",function(){$("body").unbind("click",onBodyClick),$textarea.unbind("focusin",onTextareFocusin),$textarea.unbind("keydown",onTextareaBlur),$sendBtn.unbind("click",onSendBtnClick),$textarea.unbind("blur",onTextareaBlur)})}return{restrict:"A",templateUrl:"common/widgets/comment/input/send-comment.html",scope:{gid:"@",fileId:"@",taskId:"@"},link:link}}}),define("common/widgets/comment/input/replyCommentDirective",["underscore","jquery","util/inputTool","util/keycode","util/guid"],function(_,$,inputTool,KEYCODE,GUID){"use strict";return function(commentService,commentLocal,launcher,$filter,$rootScope,memberService){function link(scope,element){function replyComment(){var targets,sync,content,comment,localId;content=$textarea.val(),$rootScope.isReplying=!1,content&&(targets=memberService.getAtTargets(content),sync=-1===targets.indexOf("all"),localId=GUID(),comment={commenter:launcher.getUser(),content:content,createTime:(new Date).getTime(),localId:localId,id:localId,groupId:Number(launcher.gid()),replyComment:{content:scope.replyContent,commenter:{name:scope.replyCommenter}},replyId:scope.replyId},scope.fileId?(_.extend(comment,{fileId:scope.fileId}),commentLocal.trigger(localId,comment),commentService.add("file",launcher.getGroup().id,scope.fileId,content,scope.replyId,targets,sync,localId).then(function(json){scope.$emit("comment.send.success",{localId:localId,json:json})},function(){console.log("add comment failed"),scope.$emit("comment.send.error",{localId:localId})})):scope.taskId&&(_.extend(comment,{taskId:scope.taskId}),commentLocal.trigger(localId,comment),commentService.add("task",launcher.getGroup().id,scope.taskId,content,scope.replyId,targets,sync,localId).then(function(json){scope.$emit("comment.send.success",{localId:localId,json:json})},function(){console.log("add comment failed"),scope.$emit("comment.send.error",{localId:localId})})),scope.content="",scope.$parent.$parent.comment.expandReply=!1)}function onTextareBlur(){caretPos=$textarea[0].selectionStart}function onSendBtnClick(){return replyComment(),!1}function onTextareaKeydown(e){return e.altKey&&e.keyCode===KEYCODE.S?(replyComment(),!1):e.keyCode!==KEYCODE.ENTER||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey?e.keyCode===KEYCODE.ENTER?(document.execCommand("insertParagraph"),!1):void 0:(e.isPropagationStopped()||replyComment(),!1)}function onElFocusin(){$textarea.animate({height:"94px"}),$sendBtn.css("display","inline-block"),$emojiBtn.css("display","block"),element.css("margin-bottom","40px")}function onBodyClick(evt){if(!$textarea.val()){var className=evt.target.className;_.isFunction(className.indexOf)&&scope.$parent.$parent.comment.expandReply&&className.indexOf("comment-reply-btn")&&-1===className.indexOf("comment-reply-emoji")&&-1===className.indexOf("comment-reply-input")&&-1===className.indexOf("comment-reply-sendBtn")&&($textarea.animate({height:"40px"}),$sendBtn.hide(),$emojiBtn.hide(),element.css("margin-bottom","0px"))}}function onCommentbdScroll(){scope.$broadcast("emoji.ensurePosition")}var $sendBtn,$emojiBtn,$textarea,caretPos=0;$sendBtn=element.find(".comment-reply-sendBtn"),$emojiBtn=element.find(".comment-reply-emoji"),$textarea=element.find(".comment-reply-input"),scope.addEmoji=function(tag){scope.content=inputTool.insertValue($textarea,caretPos,tag)},onElFocusin(),$textarea.focus(),$textarea.on("blur",onTextareBlur),$sendBtn.on("click",onSendBtnClick),$textarea.on("keydown",onTextareaKeydown),element.on("focusin",onElFocusin),$("body").on("click",onBodyClick),element.parents(".comment-bd").on("scroll",onCommentbdScroll),scope.$on("$destroy",function(){$textarea.unbind("blur",onTextareBlur),$sendBtn.unbind("click",onSendBtnClick),$textarea.unbind("keydown",onTextareaKeydown),element.unbind("focusin",onElFocusin),$("body").unbind("click",onBodyClick),element.parents(".comment-bd").unbind("scroll",onCommentbdScroll)})}return{restrict:"AC",templateUrl:"common/widgets/comment/input/reply-comment.html",scope:{gid:"&",fileId:"@",taskId:"@",replyId:"@",replyCommenter:"@",replyUserId:"@",replyContent:"@"},link:link}}}),define("common/widgets/comment/commentLocal",["underscore"],function(){"use strict";return function($rootScope){function showComment(json){$rootScope.$broadcast("comment.send",json)}function getLocalId(comment){return comment.localId}function trigger(localId,value){-1===localIdCache.indexOf(localId)&&(localId&&localIdCache.push(localId),localIdCache.length>1e3&&(localIdCache=localIdCache.slice(800)),showComment(value))}function handleComment(evt,comment){trigger(getLocalId(comment),comment)}var localIdCache=[];$rootScope.$on("socket.message",function(evt,value){8!==Number(value.type)||"ADD"!==value.action&&"REPLY"!==value.action||handleComment(evt,value)}),this.trigger=trigger,this.getLocalId=getLocalId}}),define("common/widgets/comment/highlight",["jquery"],function($){"use strict";return function(){function link(scope,el){var highlightId=scope.highlightId;if(void 0!==highlightId){var commentId=scope.comment.id;commentId===Number(highlightId)&&($(el).find(".item-container").addClass("highlight"),setTimeout(function(){var $hp=el,height=0;$hp.prevAll().each(function(index,element){height+=element.offsetHeight}),$(".detail-aside").scrollTop(height)},100),setTimeout(function(){$(el).find(".item-container").removeClass("highlight"),scope.$parent.highlightId=null},3e3))}}return{restrict:"A",link:link}}}),function(factory){"function"==typeof define&&define.amd?define("select2",["jquery"],factory):factory("object"==typeof exports?require("jquery"):jQuery)}(function(jQuery){var S2=function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var S2=jQuery.fn.select2.amd;var S2;return function(){if(!S2||!S2.requirejs){S2?require=S2:S2={};var requirejs,require,define;!function(undef){function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,lastIndex,foundI,foundStarMap,starI,i,j,part,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{};if(name&&"."===name.charAt(0))if(baseName){for(name=name.split("/"),lastIndex=name.length-1,config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])&&(name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")),name=baseParts.slice(0,baseParts.length-1).concat(name),i=0;i<name.length;i+=1)if(part=name[i],"."===part)name.splice(i,1),i-=1;else if(".."===part){if(1===i&&(".."===name[2]||".."===name[0]))break;i>0&&(name.splice(i-1,2),i-=2)}name=name.join("/")}else 0===name.indexOf("./")&&(name=name.substring(2));if((baseParts||starMap)&&map){for(nameParts=name.split("/"),i=nameParts.length;i>0;i-=1){if(nameSegment=nameParts.slice(0,i).join("/"),baseParts)for(j=baseParts.length;j>0;j-=1)if(mapValue=map[baseParts.slice(0,j).join("/")],mapValue&&(mapValue=mapValue[nameSegment])){foundMap=mapValue,foundI=i;break}if(foundMap)break;!foundStarMap&&starMap&&starMap[nameSegment]&&(foundStarMap=starMap[nameSegment],starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return name}function makeRequire(relName,forceSync){return function(){var args=aps.call(arguments,0);return"string"!=typeof args[0]&&1===args.length&&args.push(null),req.apply(undef,args.concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name],defining[name]=!0,main.apply(undef,args)}if(!hasProp(defined,name)&&!hasProp(defining,name))throw new Error("No "+name);return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;return index>-1&&(prefix=name.substring(0,index),name=name.substring(index+1,name.length)),[prefix,name]}function makeConfig(name){return function(){return config&&config.config&&config.config[name]||{}}}var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice,jsSuffixRegExp=/\.js$/;makeMap=function(name,relName){var plugin,parts=splitPrefix(name),prefix=parts[0];return name=parts[1],prefix&&(prefix=normalize(prefix,relName),plugin=callDep(prefix)),prefix?name=plugin&&plugin.normalize?plugin.normalize(name,makeNormalize(relName)):normalize(name,relName):(name=normalize(name,relName),parts=splitPrefix(name),prefix=parts[0],name=parts[1],prefix&&(plugin=callDep(prefix))),{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}},handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];return"undefined"!=typeof e?e:defined[name]={}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)}}},main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,usingExports,args=[],callbackType=typeof callback;if(relName=relName||name,"undefined"===callbackType||"function"===callbackType){for(deps=!deps.length&&callback.length?["require","exports","module"]:deps,i=0;i<deps.length;i+=1)if(map=makeMap(deps[i],relName),depName=map.f,"require"===depName)args[i]=handlers.require(name);else if("exports"===depName)args[i]=handlers.exports(name),usingExports=!0;else if("module"===depName)cjsModule=args[i]=handlers.module(name);else if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName))args[i]=callDep(depName);else{if(!map.p)throw new Error(name+" missing "+depName);map.p.load(map.n,makeRequire(relName,!0),makeLoad(depName),{}),args[i]=defined[depName]}ret=callback?callback.apply(defined[name],args):void 0,name&&(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]?defined[name]=cjsModule.exports:ret===undef&&usingExports||(defined[name]=ret))}else name&&(defined[name]=callback)},requirejs=require=req=function(deps,callback,relName,forceSync,alt){if("string"==typeof deps)return handlers[deps]?handlers[deps](callback):callDep(makeMap(deps,callback).f);if(!deps.splice){if(config=deps,config.deps&&req(config.deps,config.callback),!callback)return;callback.splice?(deps=callback,callback=relName,relName=null):deps=undef}return callback=callback||function(){},"function"==typeof relName&&(relName=forceSync,forceSync=alt),forceSync?main(undef,deps,callback,relName):setTimeout(function(){main(undef,deps,callback,relName)},4),req},req.config=function(cfg){return req(cfg)},requirejs._defined=defined,define=function(name,deps,callback){if("string"!=typeof name)throw new Error("See almond README: incorrect module build, no module name");deps.splice||(callback=deps,deps=[]),hasProp(defined,name)||hasProp(waiting,name)||(waiting[name]=[name,deps,callback])},define.amd={jQuery:!0}}(),S2.requirejs=requirejs,S2.require=require,S2.define=define}}(),S2.define("almond",function(){}),S2.define("jquery",[],function(){var _$=jQuery||$;return null==_$&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),_$}),S2.define("select2/utils",["jquery"],function($){function getMethods(theClass){var proto=theClass.prototype,methods=[];for(var methodName in proto){var m=proto[methodName];"function"==typeof m&&"constructor"!==methodName&&methods.push(methodName)}return methods}var Utils={};Utils.Extend=function(ChildClass,SuperClass){function BaseConstructor(){this.constructor=ChildClass}var __hasProp={}.hasOwnProperty;for(var key in SuperClass)__hasProp.call(SuperClass,key)&&(ChildClass[key]=SuperClass[key]);return BaseConstructor.prototype=SuperClass.prototype,ChildClass.prototype=new BaseConstructor,ChildClass.__super__=SuperClass.prototype,ChildClass},Utils.Decorate=function(SuperClass,DecoratorClass){function DecoratedClass(){var unshift=Array.prototype.unshift,argCount=DecoratorClass.prototype.constructor.length,calledConstructor=SuperClass.prototype.constructor;argCount>0&&(unshift.call(arguments,SuperClass.prototype.constructor),calledConstructor=DecoratorClass.prototype.constructor),calledConstructor.apply(this,arguments)}function ctr(){this.constructor=DecoratedClass}var decoratedMethods=getMethods(DecoratorClass),superMethods=getMethods(SuperClass);DecoratorClass.displayName=SuperClass.displayName,DecoratedClass.prototype=new ctr;for(var m=0;m<superMethods.length;m++){var superMethod=superMethods[m];DecoratedClass.prototype[superMethod]=SuperClass.prototype[superMethod]}for(var calledMethod=(function(methodName){var originalMethod=function(){};methodName in DecoratedClass.prototype&&(originalMethod=DecoratedClass.prototype[methodName]);var decoratedMethod=DecoratorClass.prototype[methodName];return function(){var unshift=Array.prototype.unshift;return unshift.call(arguments,originalMethod),decoratedMethod.apply(this,arguments)}}),d=0;d<decoratedMethods.length;d++){var decoratedMethod=decoratedMethods[d];DecoratedClass.prototype[decoratedMethod]=calledMethod(decoratedMethod)}return DecoratedClass};var Observable=function(){this.listeners={}};return Observable.prototype.on=function(event,callback){this.listeners=this.listeners||{},event in this.listeners?this.listeners[event].push(callback):this.listeners[event]=[callback]},Observable.prototype.trigger=function(event){var slice=Array.prototype.slice;this.listeners=this.listeners||{},event in this.listeners&&this.invoke(this.listeners[event],slice.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},Observable.prototype.invoke=function(listeners,params){for(var i=0,len=listeners.length;len>i;i++)listeners[i].apply(this,params)},Utils.Observable=Observable,Utils.generateChars=function(length){for(var chars="",i=0;length>i;i++){var randomChar=Math.floor(36*Math.random());chars+=randomChar.toString(36)}return chars},Utils.bind=function(func,context){return function(){func.apply(context,arguments)}},Utils._convertData=function(data){for(var originalKey in data){var keys=originalKey.split("-"),dataLevel=data;if(1!==keys.length){for(var k=0;k<keys.length;k++){var key=keys[k];key=key.substring(0,1).toLowerCase()+key.substring(1),key in dataLevel||(dataLevel[key]={}),k==keys.length-1&&(dataLevel[key]=data[originalKey]),dataLevel=dataLevel[key]}delete data[originalKey]}}return data},Utils.hasScroll=function(index,el){var $el=$(el),overflowX=el.style.overflowX,overflowY=el.style.overflowY;return overflowX!==overflowY||"hidden"!==overflowY&&"visible"!==overflowY?"scroll"===overflowX||"scroll"===overflowY?!0:$el.innerHeight()<el.scrollHeight||$el.innerWidth()<el.scrollWidth:!1},Utils.escapeMarkup=function(markup){var replaceMap={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof markup?markup:String(markup).replace(/[&<>"'\/\\]/g,function(match){return replaceMap[match]})},Utils.appendMany=function($element,$nodes){if("1.7"===$.fn.jquery.substr(0,3)){var $jqNodes=$();$.map($nodes,function(node){$jqNodes=$jqNodes.add(node)}),$nodes=$jqNodes}$element.append($nodes)},Utils}),S2.define("select2/results",["jquery","./utils"],function($,Utils){function Results($element,options,dataAdapter){this.$element=$element,this.data=dataAdapter,this.options=options,Results.__super__.constructor.call(this)}return Utils.Extend(Results,Utils.Observable),Results.prototype.render=function(){var $results=$('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&$results.attr("aria-multiselectable","true"),this.$results=$results,$results},Results.prototype.clear=function(){this.$results.empty()},Results.prototype.displayMessage=function(params){var escapeMarkup=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var $message=$('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),message=this.options.get("translations").get(params.message);$message.append(escapeMarkup(message(params.args))),$message[0].className+=" select2-results__message",this.$results.append($message)},Results.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},Results.prototype.append=function(data){this.hideLoading();var $options=[];if(null==data.results||0===data.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));data.results=this.sort(data.results);for(var d=0;d<data.results.length;d++){var item=data.results[d],$option=this.option(item);$options.push($option)}this.$results.append($options)},Results.prototype.position=function($results,$dropdown){var $resultsContainer=$dropdown.find(".select2-results");$resultsContainer.append($results)},Results.prototype.sort=function(data){var sorter=this.options.get("sorter");return sorter(data)},Results.prototype.setClasses=function(){var self=this;this.data.current(function(selected){var selectedIds=$.map(selected,function(s){return s.id.toString()}),$options=self.$results.find(".select2-results__option[aria-selected]");$options.each(function(){var $option=$(this),item=$.data(this,"data"),id=""+item.id;null!=item.element&&item.element.selected||null==item.element&&$.inArray(id,selectedIds)>-1?$option.attr("aria-selected","true"):$option.attr("aria-selected","false")});var $selected=$options.filter("[aria-selected=true]");$selected.length>0?$selected.first().trigger("mouseenter"):$options.first().trigger("mouseenter")})},Results.prototype.showLoading=function(params){this.hideLoading();var loadingMore=this.options.get("translations").get("searching"),loading={disabled:!0,loading:!0,text:loadingMore(params)},$loading=this.option(loading);$loading.className+=" loading-results",this.$results.prepend($loading)},Results.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},Results.prototype.option=function(data){var option=document.createElement("li");option.className="select2-results__option";var attrs={role:"treeitem","aria-selected":"false"};data.disabled&&(delete attrs["aria-selected"],attrs["aria-disabled"]="true"),null==data.id&&delete attrs["aria-selected"],null!=data._resultId&&(option.id=data._resultId),data.title&&(option.title=data.title),data.children&&(attrs.role="group",attrs["aria-label"]=data.text,delete attrs["aria-selected"]);for(var attr in attrs){var val=attrs[attr];option.setAttribute(attr,val)}if(data.children){var $option=$(option),label=document.createElement("strong");label.className="select2-results__group";{$(label)}this.template(data,label);for(var $children=[],c=0;c<data.children.length;c++){var child=data.children[c],$child=this.option(child);$children.push($child)}var $childrenContainer=$("<ul></ul>",{"class":"select2-results__options select2-results__options--nested"});$childrenContainer.append($children),$option.append(label),$option.append($childrenContainer)}else this.template(data,option);return $.data(option,"data",data),option},Results.prototype.bind=function(container){var self=this,id=container.id+"-results";this.$results.attr("id",id),container.on("results:all",function(params){self.clear(),self.append(params.data),container.isOpen()&&self.setClasses()}),container.on("results:append",function(params){self.append(params.data),container.isOpen()&&self.setClasses()}),container.on("query",function(params){self.hideMessages(),self.showLoading(params)}),container.on("select",function(){container.isOpen()&&self.setClasses()}),container.on("unselect",function(){container.isOpen()&&self.setClasses()}),container.on("open",function(){self.$results.attr("aria-expanded","true"),self.$results.attr("aria-hidden","false"),self.setClasses(),self.ensureHighlightVisible()}),container.on("close",function(){self.$results.attr("aria-expanded","false"),self.$results.attr("aria-hidden","true"),self.$results.removeAttr("aria-activedescendant")}),container.on("results:toggle",function(){var $highlighted=self.getHighlightedResults();0!==$highlighted.length&&$highlighted.trigger("mouseup")}),container.on("results:select",function(){var $highlighted=self.getHighlightedResults();if(0!==$highlighted.length){var data=$highlighted.data("data");"true"==$highlighted.attr("aria-selected")?self.trigger("close",{}):self.trigger("select",{data:data})}}),container.on("results:previous",function(){var $highlighted=self.getHighlightedResults(),$options=self.$results.find("[aria-selected]"),currentIndex=$options.index($highlighted);if(0!==currentIndex){var nextIndex=currentIndex-1;0===$highlighted.length&&(nextIndex=0);var $next=$options.eq(nextIndex);$next.trigger("mouseenter");var currentOffset=self.$results.offset().top,nextTop=$next.offset().top,nextOffset=self.$results.scrollTop()+(nextTop-currentOffset);0===nextIndex?self.$results.scrollTop(0):0>nextTop-currentOffset&&self.$results.scrollTop(nextOffset)}}),container.on("results:next",function(){var $highlighted=self.getHighlightedResults(),$options=self.$results.find("[aria-selected]"),currentIndex=$options.index($highlighted),nextIndex=currentIndex+1;if(!(nextIndex>=$options.length)){var $next=$options.eq(nextIndex);$next.trigger("mouseenter");var currentOffset=self.$results.offset().top+self.$results.outerHeight(!1),nextBottom=$next.offset().top+$next.outerHeight(!1),nextOffset=self.$results.scrollTop()+nextBottom-currentOffset;0===nextIndex?self.$results.scrollTop(0):nextBottom>currentOffset&&self.$results.scrollTop(nextOffset)}}),container.on("results:focus",function(params){params.element.addClass("select2-results__option--highlighted")}),container.on("results:message",function(params){self.displayMessage(params)}),$.fn.mousewheel&&this.$results.on("mousewheel",function(e){var top=self.$results.scrollTop(),bottom=self.$results.get(0).scrollHeight-self.$results.scrollTop()+e.deltaY,isAtTop=e.deltaY>0&&top-e.deltaY<=0,isAtBottom=e.deltaY<0&&bottom<=self.$results.height();isAtTop?(self.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):isAtBottom&&(self.$results.scrollTop(self.$results.get(0).scrollHeight-self.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(evt){var $this=$(this),data=$this.data("data");return"true"===$this.attr("aria-selected")?void(self.options.get("multiple")?self.trigger("unselect",{originalEvent:evt,data:data}):self.trigger("close",{})):void self.trigger("select",{originalEvent:evt,data:data})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(){var data=$(this).data("data");self.getHighlightedResults().removeClass("select2-results__option--highlighted"),self.trigger("results:focus",{data:data,element:$(this)})})},Results.prototype.getHighlightedResults=function(){var $highlighted=this.$results.find(".select2-results__option--highlighted");return $highlighted},Results.prototype.destroy=function(){this.$results.remove()},Results.prototype.ensureHighlightVisible=function(){var $highlighted=this.getHighlightedResults();if(0!==$highlighted.length){var $options=this.$results.find("[aria-selected]"),currentIndex=$options.index($highlighted),currentOffset=this.$results.offset().top,nextTop=$highlighted.offset().top,nextOffset=this.$results.scrollTop()+(nextTop-currentOffset),offsetDelta=nextTop-currentOffset;nextOffset-=2*$highlighted.outerHeight(!1),2>=currentIndex?this.$results.scrollTop(0):(offsetDelta>this.$results.outerHeight()||0>offsetDelta)&&this.$results.scrollTop(nextOffset)}},Results.prototype.template=function(result,container){var template=this.options.get("templateResult"),escapeMarkup=this.options.get("escapeMarkup"),content=template(result,container);null==content?container.style.display="none":"string"==typeof content?container.innerHTML=escapeMarkup(content):$(container).append(content)},Results}),S2.define("select2/keys",[],function(){var KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return KEYS}),S2.define("select2/selection/base",["jquery","../utils","../keys"],function($,Utils,KEYS){function BaseSelection($element,options){this.$element=$element,this.options=options,BaseSelection.__super__.constructor.call(this)
}return Utils.Extend(BaseSelection,Utils.Observable),BaseSelection.prototype.render=function(){var $selection=$('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),$selection.attr("title",this.$element.attr("title")),$selection.attr("tabindex",this._tabindex),this.$selection=$selection,$selection},BaseSelection.prototype.bind=function(container){var self=this,resultsId=(container.id+"-container",container.id+"-results");this.container=container,this.$selection.on("focus",function(evt){self.trigger("focus",evt)}),this.$selection.on("blur",function(evt){self._handleBlur(evt)}),this.$selection.on("keydown",function(evt){self.trigger("keypress",evt),evt.which===KEYS.SPACE&&evt.preventDefault()}),container.on("results:focus",function(params){self.$selection.attr("aria-activedescendant",params.data._resultId)}),container.on("selection:update",function(params){self.update(params.data)}),container.on("open",function(){self.$selection.attr("aria-expanded","true"),self.$selection.attr("aria-owns",resultsId),self._attachCloseHandler(container)}),container.on("close",function(){self.$selection.attr("aria-expanded","false"),self.$selection.removeAttr("aria-activedescendant"),self.$selection.removeAttr("aria-owns"),self.$selection.focus(),self._detachCloseHandler(container)}),container.on("enable",function(){self.$selection.attr("tabindex",self._tabindex)}),container.on("disable",function(){self.$selection.attr("tabindex","-1")})},BaseSelection.prototype._handleBlur=function(evt){var self=this;window.setTimeout(function(){document.activeElement==self.$selection[0]||$.contains(self.$selection[0],document.activeElement)||self.trigger("blur",evt)},1)},BaseSelection.prototype._attachCloseHandler=function(container){$(document.body).on("mousedown.select2."+container.id,function(e){var $target=$(e.target),$select=$target.closest(".select2"),$all=$(".select2.select2-container--open");$all.each(function(){var $this=$(this);if(this!=$select[0]){var $element=$this.data("element");$element.select2("close")}})})},BaseSelection.prototype._detachCloseHandler=function(container){$(document.body).off("mousedown.select2."+container.id)},BaseSelection.prototype.position=function($selection,$container){var $selectionContainer=$container.find(".selection");$selectionContainer.append($selection)},BaseSelection.prototype.destroy=function(){this._detachCloseHandler(this.container)},BaseSelection.prototype.update=function(){throw new Error("The `update` method must be defined in child classes.")},BaseSelection}),S2.define("select2/selection/single",["jquery","./base","../utils","../keys"],function($,BaseSelection,Utils){function SingleSelection(){SingleSelection.__super__.constructor.apply(this,arguments)}return Utils.Extend(SingleSelection,BaseSelection),SingleSelection.prototype.render=function(){var $selection=SingleSelection.__super__.render.call(this);return $selection.addClass("select2-selection--single"),$selection.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),$selection},SingleSelection.prototype.bind=function(container){var self=this;SingleSelection.__super__.bind.apply(this,arguments);var id=container.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",id),this.$selection.attr("aria-labelledby",id),this.$selection.on("mousedown",function(evt){1===evt.which&&self.trigger("toggle",{originalEvent:evt})}),this.$selection.on("focus",function(){}),this.$selection.on("blur",function(){}),container.on("selection:update",function(params){self.update(params.data)})},SingleSelection.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},SingleSelection.prototype.display=function(data,container){var template=this.options.get("templateSelection"),escapeMarkup=this.options.get("escapeMarkup");return escapeMarkup(template(data,container))},SingleSelection.prototype.selectionContainer=function(){return $("<span></span>")},SingleSelection.prototype.update=function(data){if(0===data.length)return void this.clear();var selection=data[0],$rendered=this.$selection.find(".select2-selection__rendered"),formatted=this.display(selection,$rendered);$rendered.empty().append(formatted),$rendered.prop("title",selection.title||selection.text)},SingleSelection}),S2.define("select2/selection/multiple",["jquery","./base","../utils"],function($,BaseSelection,Utils){function MultipleSelection(){MultipleSelection.__super__.constructor.apply(this,arguments)}return Utils.Extend(MultipleSelection,BaseSelection),MultipleSelection.prototype.render=function(){var $selection=MultipleSelection.__super__.render.call(this);return $selection.addClass("select2-selection--multiple"),$selection.html('<ul class="select2-selection__rendered"></ul>'),$selection},MultipleSelection.prototype.bind=function(){var self=this;MultipleSelection.__super__.bind.apply(this,arguments),this.$selection.on("click",function(evt){self.trigger("toggle",{originalEvent:evt})}),this.$selection.on("click",".select2-selection__choice__remove",function(evt){if(!self.options.get("disabled")){var $remove=$(this),$selection=$remove.parent(),data=$selection.data("data");self.trigger("unselect",{originalEvent:evt,data:data})}})},MultipleSelection.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},MultipleSelection.prototype.display=function(data,container){var template=this.options.get("templateSelection"),escapeMarkup=this.options.get("escapeMarkup");return escapeMarkup(template(data,container))},MultipleSelection.prototype.selectionContainer=function(){var $container=$('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>');return $container},MultipleSelection.prototype.update=function(data){if(this.clear(),0!==data.length){for(var $selections=[],d=0;d<data.length;d++){var selection=data[d],$selection=this.selectionContainer(),formatted=this.display(selection,$selection);$selection.append(formatted),$selection.prop("title",selection.title||selection.text),$selection.data("data",selection),$selections.push($selection)}var $rendered=this.$selection.find(".select2-selection__rendered");Utils.appendMany($rendered,$selections)}},MultipleSelection}),S2.define("select2/selection/placeholder",["../utils"],function(){function Placeholder(decorated,$element,options){this.placeholder=this.normalizePlaceholder(options.get("placeholder")),decorated.call(this,$element,options)}return Placeholder.prototype.normalizePlaceholder=function(_,placeholder){return"string"==typeof placeholder&&(placeholder={id:"",text:placeholder}),placeholder},Placeholder.prototype.createPlaceholder=function(decorated,placeholder){var $placeholder=this.selectionContainer();return $placeholder.html(this.display(placeholder)),$placeholder.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),$placeholder},Placeholder.prototype.update=function(decorated,data){var singlePlaceholder=1==data.length&&data[0].id!=this.placeholder.id,multipleSelections=data.length>1;if(multipleSelections||singlePlaceholder)return decorated.call(this,data);this.clear();var $placeholder=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append($placeholder)},Placeholder}),S2.define("select2/selection/allowClear",["jquery","../keys"],function($,KEYS){function AllowClear(){}return AllowClear.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(evt){self._handleClear(evt)}),container.on("keypress",function(evt){self._handleKeyboardClear(evt,container)})},AllowClear.prototype._handleClear=function(_,evt){if(!this.options.get("disabled")){var $clear=this.$selection.find(".select2-selection__clear");if(0!==$clear.length){evt.stopPropagation();for(var data=$clear.data("data"),d=0;d<data.length;d++){var unselectData={data:data[d]};if(this.trigger("unselect",unselectData),unselectData.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},AllowClear.prototype._handleKeyboardClear=function(_,evt,container){container.isOpen()||(evt.which==KEYS.DELETE||evt.which==KEYS.BACKSPACE)&&this._handleClear(evt)},AllowClear.prototype.update=function(decorated,data){if(decorated.call(this,data),!(this.$selection.find(".select2-selection__placeholder").length>0||0===data.length)){var $remove=$('<span class="select2-selection__clear">&times;</span>');$remove.data("data",data),this.$selection.find(".select2-selection__rendered").prepend($remove)}},AllowClear}),S2.define("select2/selection/search",["jquery","../utils","../keys"],function($,Utils,KEYS){function Search(decorated,$element,options){decorated.call(this,$element,options)}return Search.prototype.render=function(decorated){var $search=$('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=$search,this.$search=$search.find("input");var $rendered=decorated.call(this);return this._transferTabIndex(),$rendered},Search.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),container.on("open",function(){self.$search.trigger("focus")}),container.on("close",function(){self.$search.val(""),self.$search.removeAttr("aria-activedescendant"),self.$search.trigger("focus")}),container.on("enable",function(){self.$search.prop("disabled",!1),self._transferTabIndex()}),container.on("disable",function(){self.$search.prop("disabled",!0)}),container.on("focus",function(){self.$search.trigger("focus")}),container.on("results:focus",function(params){self.$search.attr("aria-activedescendant",params.id)}),this.$selection.on("focusin",".select2-search--inline",function(evt){self.trigger("focus",evt)}),this.$selection.on("focusout",".select2-search--inline",function(evt){self._handleBlur(evt)}),this.$selection.on("keydown",".select2-search--inline",function(evt){evt.stopPropagation(),self.trigger("keypress",evt),self._keyUpPrevented=evt.isDefaultPrevented();var key=evt.which;if(key===KEYS.BACKSPACE&&""===self.$search.val()){var $previousChoice=self.$searchContainer.prev(".select2-selection__choice");if($previousChoice.length>0){var item=$previousChoice.data("data");self.searchRemoveChoice(item),evt.preventDefault()}}});var msie=document.documentMode,disableInputEvents=msie&&11>=msie;this.$selection.on("input.searchcheck",".select2-search--inline",function(){return disableInputEvents?void self.$selection.off("input.search input.searchcheck"):void self.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(evt){if(disableInputEvents&&"input"===evt.type)return void self.$selection.off("input.search input.searchcheck");var key=evt.which;key!=KEYS.SHIFT&&key!=KEYS.CTRL&&key!=KEYS.ALT&&key!=KEYS.TAB&&self.handleSearch(evt)})},Search.prototype._transferTabIndex=function(){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},Search.prototype.createPlaceholder=function(decorated,placeholder){this.$search.attr("placeholder",placeholder.text)},Search.prototype.update=function(decorated,data){var searchHadFocus=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),decorated.call(this,data),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),searchHadFocus&&this.$search.focus()},Search.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var input=this.$search.val();this.trigger("query",{term:input})}this._keyUpPrevented=!1},Search.prototype.searchRemoveChoice=function(decorated,item){this.trigger("unselect",{data:item}),this.$search.val(item.text),this.handleSearch()},Search.prototype.resizeSearch=function(){this.$search.css("width","25px");var width="";if(""!==this.$search.attr("placeholder"))width=this.$selection.find(".select2-selection__rendered").innerWidth();else{var minimumWidth=this.$search.val().length+1;width=.75*minimumWidth+"em"}this.$search.css("width",width)},Search}),S2.define("select2/selection/eventRelay",["jquery"],function($){function EventRelay(){}return EventRelay.prototype.bind=function(decorated,container,$container){var self=this,relayEvents=["open","opening","close","closing","select","selecting","unselect","unselecting"],preventableEvents=["opening","closing","selecting","unselecting"];decorated.call(this,container,$container),container.on("*",function(name,params){if(-1!==$.inArray(name,relayEvents)){params=params||{};var evt=$.Event("select2:"+name,{params:params});self.$element.trigger(evt),-1!==$.inArray(name,preventableEvents)&&(params.prevented=evt.isDefaultPrevented())}})},EventRelay}),S2.define("select2/translation",["jquery","require"],function($,require){function Translation(dict){this.dict=dict||{}}return Translation.prototype.all=function(){return this.dict},Translation.prototype.get=function(key){return this.dict[key]},Translation.prototype.extend=function(translation){this.dict=$.extend({},translation.all(),this.dict)},Translation._cache={},Translation.loadPath=function(path){if(!(path in Translation._cache)){var translations=require(path);Translation._cache[path]=translations}return new Translation(Translation._cache[path])},Translation}),S2.define("select2/diacritics",[],function(){var diacritics={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};return diacritics}),S2.define("select2/data/base",["../utils"],function(Utils){function BaseAdapter(){BaseAdapter.__super__.constructor.call(this)}return Utils.Extend(BaseAdapter,Utils.Observable),BaseAdapter.prototype.current=function(){throw new Error("The `current` method must be defined in child classes.")},BaseAdapter.prototype.query=function(){throw new Error("The `query` method must be defined in child classes.")},BaseAdapter.prototype.bind=function(){},BaseAdapter.prototype.destroy=function(){},BaseAdapter.prototype.generateResultId=function(container,data){var id=container.id+"-result-";return id+=Utils.generateChars(4),id+=null!=data.id?"-"+data.id.toString():"-"+Utils.generateChars(4)},BaseAdapter}),S2.define("select2/data/select",["./base","../utils","jquery"],function(BaseAdapter,Utils,$){function SelectAdapter($element,options){this.$element=$element,this.options=options,SelectAdapter.__super__.constructor.call(this)}return Utils.Extend(SelectAdapter,BaseAdapter),SelectAdapter.prototype.current=function(callback){var data=[],self=this;this.$element.find(":selected").each(function(){var $option=$(this),option=self.item($option);data.push(option)}),callback(data)},SelectAdapter.prototype.select=function(data){var self=this;if(data.selected=!0,$(data.element).is("option"))return data.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(currentData){var val=[];data=[data],data.push.apply(data,currentData);for(var d=0;d<data.length;d++){var id=data[d].id;-1===$.inArray(id,val)&&val.push(id)}self.$element.val(val),self.$element.trigger("change")});else{var val=data.id;this.$element.val(val),this.$element.trigger("change")}},SelectAdapter.prototype.unselect=function(data){var self=this;if(this.$element.prop("multiple"))return data.selected=!1,$(data.element).is("option")?(data.element.selected=!1,void this.$element.trigger("change")):void this.current(function(currentData){for(var val=[],d=0;d<currentData.length;d++){var id=currentData[d].id;id!==data.id&&-1===$.inArray(id,val)&&val.push(id)}self.$element.val(val),self.$element.trigger("change")})},SelectAdapter.prototype.bind=function(container){var self=this;this.container=container,container.on("select",function(params){self.select(params.data)}),container.on("unselect",function(params){self.unselect(params.data)})},SelectAdapter.prototype.destroy=function(){this.$element.find("*").each(function(){$.removeData(this,"data")})},SelectAdapter.prototype.query=function(params,callback){var data=[],self=this,$options=this.$element.children();$options.each(function(){var $option=$(this);if($option.is("option")||$option.is("optgroup")){var option=self.item($option),matches=self.matches(params,option);null!==matches&&data.push(matches)}}),callback({results:data})},SelectAdapter.prototype.addOptions=function($options){Utils.appendMany(this.$element,$options)},SelectAdapter.prototype.option=function(data){var option;data.children?(option=document.createElement("optgroup"),option.label=data.text):(option=document.createElement("option"),void 0!==option.textContent?option.textContent=data.text:option.innerText=data.text),data.id&&(option.value=data.id),data.disabled&&(option.disabled=!0),data.selected&&(option.selected=!0),data.title&&(option.title=data.title);var $option=$(option),normalizedData=this._normalizeItem(data);return normalizedData.element=option,$.data(option,"data",normalizedData),$option},SelectAdapter.prototype.item=function($option){var data={};if(data=$.data($option[0],"data"),null!=data)return data;if($option.is("option"))data={id:$option.val(),text:$option.text(),disabled:$option.prop("disabled"),selected:$option.prop("selected"),title:$option.prop("title")};else if($option.is("optgroup")){data={text:$option.prop("label"),children:[],title:$option.prop("title")};for(var $children=$option.children("option"),children=[],c=0;c<$children.length;c++){var $child=$($children[c]),child=this.item($child);children.push(child)}data.children=children}return data=this._normalizeItem(data),data.element=$option[0],$.data($option[0],"data",data),data},SelectAdapter.prototype._normalizeItem=function(item){$.isPlainObject(item)||(item={id:item,text:item}),item=$.extend({},{text:""},item);var defaults={selected:!1,disabled:!1};return null!=item.id&&(item.id=item.id.toString()),null!=item.text&&(item.text=item.text.toString()),null==item._resultId&&item.id&&null!=this.container&&(item._resultId=this.generateResultId(this.container,item)),$.extend({},defaults,item)},SelectAdapter.prototype.matches=function(params,data){var matcher=this.options.get("matcher");return matcher(params,data)},SelectAdapter}),S2.define("select2/data/array",["./select","../utils","jquery"],function(SelectAdapter,Utils,$){function ArrayAdapter($element,options){var data=options.get("data")||[];ArrayAdapter.__super__.constructor.call(this,$element,options),this.addOptions(this.convertToOptions(data))}return Utils.Extend(ArrayAdapter,SelectAdapter),ArrayAdapter.prototype.select=function(data){var $option=this.$element.find("option").filter(function(i,elm){return elm.value==data.id.toString()});0===$option.length&&($option=this.option(data),this.addOptions($option)),ArrayAdapter.__super__.select.call(this,data)},ArrayAdapter.prototype.convertToOptions=function(data){function onlyItem(item){return function(){return $(this).val()==item.id}}for(var self=this,$existing=this.$element.find("option"),existingIds=$existing.map(function(){return self.item($(this)).id}).get(),$options=[],d=0;d<data.length;d++){var item=this._normalizeItem(data[d]);if($.inArray(item.id,existingIds)>=0){var $existingOption=$existing.filter(onlyItem(item)),existingData=this.item($existingOption),newData=$.extend(!0,{},existingData,item),$newOption=this.option(newData);$existingOption.replaceWith($newOption)}else{var $option=this.option(item);if(item.children){var $children=this.convertToOptions(item.children);Utils.appendMany($option,$children)}$options.push($option)}}return $options},ArrayAdapter}),S2.define("select2/data/ajax",["./array","../utils","jquery"],function(ArrayAdapter,Utils,$){function AjaxAdapter($element,options){this.ajaxOptions=this._applyDefaults(options.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),AjaxAdapter.__super__.constructor.call(this,$element,options)}return Utils.Extend(AjaxAdapter,ArrayAdapter),AjaxAdapter.prototype._applyDefaults=function(options){var defaults={data:function(params){return $.extend({},params,{q:params.term})},transport:function(params,success,failure){var $request=$.ajax(params);return $request.then(success),$request.fail(failure),$request}};return $.extend({},defaults,options,!0)},AjaxAdapter.prototype.processResults=function(results){return results},AjaxAdapter.prototype.query=function(params,callback){function request(){var $request=options.transport(options,function(data){var results=self.processResults(data,params);self.options.get("debug")&&window.console&&console.error&&(results&&results.results&&$.isArray(results.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),callback(results)},function(){});self._request=$request}var self=this;null!=this._request&&($.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var options=$.extend({type:"GET"},this.ajaxOptions);"function"==typeof options.url&&(options.url=options.url.call(this.$element,params)),"function"==typeof options.data&&(options.data=options.data.call(this.$element,params)),this.ajaxOptions.delay&&""!==params.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(request,this.ajaxOptions.delay)):request()},AjaxAdapter}),S2.define("select2/data/tags",["jquery"],function($){function Tags(decorated,$element,options){var tags=options.get("tags"),createTag=options.get("createTag");if(void 0!==createTag&&(this.createTag=createTag),decorated.call(this,$element,options),$.isArray(tags))for(var t=0;t<tags.length;t++){var tag=tags[t],item=this._normalizeItem(tag),$option=this.option(item);this.$element.append($option)}}return Tags.prototype.query=function(decorated,params,callback){function wrapper(obj,child){for(var data=obj.results,i=0;i<data.length;i++){var option=data[i],checkChildren=null!=option.children&&!wrapper({results:option.children},!0),checkText=option.text===params.term;if(checkText||checkChildren)return child?!1:(obj.data=data,void callback(obj))}if(child)return!0;var tag=self.createTag(params);if(null!=tag){var $option=self.option(tag);$option.attr("data-select2-tag",!0),self.addOptions([$option]),self.insertTag(data,tag)}obj.results=data,callback(obj)}var self=this;return this._removeOldTags(),null==params.term||null!=params.page?void decorated.call(this,params,callback):void decorated.call(this,params,wrapper)},Tags.prototype.createTag=function(decorated,params){var term=$.trim(params.term);return""===term?null:{id:term,text:term}},Tags.prototype.insertTag=function(_,data,tag){data.unshift(tag)},Tags.prototype._removeOldTags=function(){var $options=(this._lastTag,this.$element.find("option[data-select2-tag]"));$options.each(function(){this.selected||$(this).remove()})},Tags}),S2.define("select2/data/tokenizer",["jquery"],function($){function Tokenizer(decorated,$element,options){var tokenizer=options.get("tokenizer");void 0!==tokenizer&&(this.tokenizer=tokenizer),decorated.call(this,$element,options)}return Tokenizer.prototype.bind=function(decorated,container,$container){decorated.call(this,container,$container),this.$search=container.dropdown.$search||container.selection.$search||$container.find(".select2-search__field")},Tokenizer.prototype.query=function(decorated,params,callback){function select(data){self.trigger("select",{data:data})}var self=this;params.term=params.term||"";var tokenData=this.tokenizer(params,this.options,select);tokenData.term!==params.term&&(this.$search.length&&(this.$search.val(tokenData.term),this.$search.focus()),params.term=tokenData.term),decorated.call(this,params,callback)},Tokenizer.prototype.tokenizer=function(_,params,options,callback){for(var separators=options.get("tokenSeparators")||[],term=params.term,i=0,createTag=this.createTag||function(params){return{id:params.term,text:params.term}};i<term.length;){var termChar=term[i];if(-1!==$.inArray(termChar,separators)){var part=term.substr(0,i),partParams=$.extend({},params,{term:part}),data=createTag(partParams);null!=data?(callback(data),term=term.substr(i+1)||"",i=0):i++}else i++}return{term:term}},Tokenizer}),S2.define("select2/data/minimumInputLength",[],function(){function MinimumInputLength(decorated,$e,options){this.minimumInputLength=options.get("minimumInputLength"),decorated.call(this,$e,options)}return MinimumInputLength.prototype.query=function(decorated,params,callback){return params.term=params.term||"",params.term.length<this.minimumInputLength?void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:params.term,params:params}}):void decorated.call(this,params,callback)
},MinimumInputLength}),S2.define("select2/data/maximumInputLength",[],function(){function MaximumInputLength(decorated,$e,options){this.maximumInputLength=options.get("maximumInputLength"),decorated.call(this,$e,options)}return MaximumInputLength.prototype.query=function(decorated,params,callback){return params.term=params.term||"",this.maximumInputLength>0&&params.term.length>this.maximumInputLength?void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:params.term,params:params}}):void decorated.call(this,params,callback)},MaximumInputLength}),S2.define("select2/data/maximumSelectionLength",[],function(){function MaximumSelectionLength(decorated,$e,options){this.maximumSelectionLength=options.get("maximumSelectionLength"),decorated.call(this,$e,options)}return MaximumSelectionLength.prototype.query=function(decorated,params,callback){var self=this;this.current(function(currentData){var count=null!=currentData?currentData.length:0;return self.maximumSelectionLength>0&&count>=self.maximumSelectionLength?void self.trigger("results:message",{message:"maximumSelected",args:{maximum:self.maximumSelectionLength}}):void decorated.call(self,params,callback)})},MaximumSelectionLength}),S2.define("select2/dropdown",["jquery","./utils"],function($,Utils){function Dropdown($element,options){this.$element=$element,this.options=options,Dropdown.__super__.constructor.call(this)}return Utils.Extend(Dropdown,Utils.Observable),Dropdown.prototype.render=function(){var $dropdown=$('<span class="select2-dropdown"><span class="select2-results"></span></span>');return $dropdown.attr("dir",this.options.get("dir")),this.$dropdown=$dropdown,$dropdown},Dropdown.prototype.bind=function(){},Dropdown.prototype.position=function(){},Dropdown.prototype.destroy=function(){this.$dropdown.remove()},Dropdown}),S2.define("select2/dropdown/search",["jquery","../utils"],function($){function Search(){}return Search.prototype.render=function(decorated){var $rendered=decorated.call(this),$search=$('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=$search,this.$search=$search.find("input"),$rendered.prepend($search),$rendered},Search.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),this.$search.on("keydown",function(evt){self.trigger("keypress",evt),self._keyUpPrevented=evt.isDefaultPrevented()}),this.$search.on("input",function(){$(this).off("keyup")}),this.$search.on("keyup input",function(evt){self.handleSearch(evt)}),container.on("open",function(){self.$search.attr("tabindex",0),self.$search.focus(),window.setTimeout(function(){self.$search.focus()},0)}),container.on("close",function(){self.$search.attr("tabindex",-1),self.$search.val("")}),container.on("results:all",function(params){if(null==params.query.term||""===params.query.term){var showSearch=self.showSearch(params);showSearch?self.$searchContainer.removeClass("select2-search--hide"):self.$searchContainer.addClass("select2-search--hide")}})},Search.prototype.handleSearch=function(){if(!this._keyUpPrevented){var input=this.$search.val();this.trigger("query",{term:input})}this._keyUpPrevented=!1},Search.prototype.showSearch=function(){return!0},Search}),S2.define("select2/dropdown/hidePlaceholder",[],function(){function HidePlaceholder(decorated,$element,options,dataAdapter){this.placeholder=this.normalizePlaceholder(options.get("placeholder")),decorated.call(this,$element,options,dataAdapter)}return HidePlaceholder.prototype.append=function(decorated,data){data.results=this.removePlaceholder(data.results),decorated.call(this,data)},HidePlaceholder.prototype.normalizePlaceholder=function(_,placeholder){return"string"==typeof placeholder&&(placeholder={id:"",text:placeholder}),placeholder},HidePlaceholder.prototype.removePlaceholder=function(_,data){for(var modifiedData=data.slice(0),d=data.length-1;d>=0;d--){var item=data[d];this.placeholder.id===item.id&&modifiedData.splice(d,1)}return modifiedData},HidePlaceholder}),S2.define("select2/dropdown/infiniteScroll",["jquery"],function($){function InfiniteScroll(decorated,$element,options,dataAdapter){this.lastParams={},decorated.call(this,$element,options,dataAdapter),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return InfiniteScroll.prototype.append=function(decorated,data){this.$loadingMore.remove(),this.loading=!1,decorated.call(this,data),this.showLoadingMore(data)&&this.$results.append(this.$loadingMore)},InfiniteScroll.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),container.on("query",function(params){self.lastParams=params,self.loading=!0}),container.on("query:append",function(params){self.lastParams=params,self.loading=!0}),this.$results.on("scroll",function(){var isLoadMoreVisible=$.contains(document.documentElement,self.$loadingMore[0]);if(!self.loading&&isLoadMoreVisible){var currentOffset=self.$results.offset().top+self.$results.outerHeight(!1),loadingMoreOffset=self.$loadingMore.offset().top+self.$loadingMore.outerHeight(!1);currentOffset+50>=loadingMoreOffset&&self.loadMore()}})},InfiniteScroll.prototype.loadMore=function(){this.loading=!0;var params=$.extend({},{page:1},this.lastParams);params.page++,this.trigger("query:append",params)},InfiniteScroll.prototype.showLoadingMore=function(_,data){return data.pagination&&data.pagination.more},InfiniteScroll.prototype.createLoadingMore=function(){var $option=$('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),message=this.options.get("translations").get("loadingMore");return $option.html(message(this.lastParams)),$option},InfiniteScroll}),S2.define("select2/dropdown/attachBody",["jquery","../utils"],function($,Utils){function AttachBody(decorated,$element,options){this.$dropdownParent=options.get("dropdownParent")||$(document.body),decorated.call(this,$element,options)}return AttachBody.prototype.bind=function(decorated,container,$container){var self=this,setupResultsEvents=!1;decorated.call(this,container,$container),container.on("open",function(){self._showDropdown(),self._attachPositioningHandler(container),setupResultsEvents||(setupResultsEvents=!0,container.on("results:all",function(){self._positionDropdown(),self._resizeDropdown()}),container.on("results:append",function(){self._positionDropdown(),self._resizeDropdown()}))}),container.on("close",function(){self._hideDropdown(),self._detachPositioningHandler(container)}),this.$dropdownContainer.on("mousedown",function(evt){evt.stopPropagation()})},AttachBody.prototype.destroy=function(decorated){decorated.call(this),this.$dropdownContainer.remove()},AttachBody.prototype.position=function(decorated,$dropdown,$container){$dropdown.attr("class",$container.attr("class")),$dropdown.removeClass("select2"),$dropdown.addClass("select2-container--open"),$dropdown.css({position:"absolute",top:-999999}),this.$container=$container},AttachBody.prototype.render=function(decorated){var $container=$("<span></span>"),$dropdown=decorated.call(this);return $container.append($dropdown),this.$dropdownContainer=$container,$container},AttachBody.prototype._hideDropdown=function(){this.$dropdownContainer.detach()},AttachBody.prototype._attachPositioningHandler=function(decorated,container){var self=this,scrollEvent="scroll.select2."+container.id,resizeEvent="resize.select2."+container.id,orientationEvent="orientationchange.select2."+container.id,$watchers=this.$container.parents().filter(Utils.hasScroll);$watchers.each(function(){$(this).data("select2-scroll-position",{x:$(this).scrollLeft(),y:$(this).scrollTop()})}),$watchers.on(scrollEvent,function(){var position=$(this).data("select2-scroll-position");$(this).scrollTop(position.y)}),$(window).on(scrollEvent+" "+resizeEvent+" "+orientationEvent,function(){self._positionDropdown(),self._resizeDropdown()})},AttachBody.prototype._detachPositioningHandler=function(decorated,container){var scrollEvent="scroll.select2."+container.id,resizeEvent="resize.select2."+container.id,orientationEvent="orientationchange.select2."+container.id,$watchers=this.$container.parents().filter(Utils.hasScroll);$watchers.off(scrollEvent),$(window).off(scrollEvent+" "+resizeEvent+" "+orientationEvent)},AttachBody.prototype._positionDropdown=function(){var $window=$(window),isCurrentlyAbove=this.$dropdown.hasClass("select2-dropdown--above"),isCurrentlyBelow=this.$dropdown.hasClass("select2-dropdown--below"),newDirection=null,offset=(this.$container.position(),this.$container.offset());offset.bottom=offset.top+this.$container.outerHeight(!1);var container={height:this.$container.outerHeight(!1)};container.top=offset.top,container.bottom=offset.top+container.height;var dropdown={height:this.$dropdown.outerHeight(!1)},viewport={top:$window.scrollTop(),bottom:$window.scrollTop()+$window.height()},enoughRoomAbove=viewport.top<offset.top-dropdown.height,enoughRoomBelow=viewport.bottom>offset.bottom+dropdown.height,css={left:offset.left,top:container.bottom};if("static"!==this.$dropdownParent[0].style.position){var parentOffset=this.$dropdownParent.offset();css.top-=parentOffset.top,css.left-=parentOffset.left}isCurrentlyAbove||isCurrentlyBelow||(newDirection="below"),enoughRoomBelow||!enoughRoomAbove||isCurrentlyAbove?!enoughRoomAbove&&enoughRoomBelow&&isCurrentlyAbove&&(newDirection="below"):newDirection="above",("above"==newDirection||isCurrentlyAbove&&"below"!==newDirection)&&(css.top=container.top-dropdown.height),null!=newDirection&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+newDirection),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+newDirection)),this.$dropdownContainer.css(css)},AttachBody.prototype._resizeDropdown=function(){var css={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(css.minWidth=css.width,css.width="auto"),this.$dropdown.css(css)},AttachBody.prototype._showDropdown=function(){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},AttachBody}),S2.define("select2/dropdown/minimumResultsForSearch",[],function(){function countResults(data){for(var count=0,d=0;d<data.length;d++){var item=data[d];item.children?count+=countResults(item.children):count++}return count}function MinimumResultsForSearch(decorated,$element,options,dataAdapter){this.minimumResultsForSearch=options.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),decorated.call(this,$element,options,dataAdapter)}return MinimumResultsForSearch.prototype.showSearch=function(decorated,params){return countResults(params.data.results)<this.minimumResultsForSearch?!1:decorated.call(this,params)},MinimumResultsForSearch}),S2.define("select2/dropdown/selectOnClose",[],function(){function SelectOnClose(){}return SelectOnClose.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),container.on("close",function(){self._handleSelectOnClose()})},SelectOnClose.prototype._handleSelectOnClose=function(){var $highlightedResults=this.getHighlightedResults();if(!($highlightedResults.length<1)){var data=$highlightedResults.data("data");null!=data.element&&data.element.selected||null==data.element&&data.selected||this.trigger("select",{data:data})}},SelectOnClose}),S2.define("select2/dropdown/closeOnSelect",[],function(){function CloseOnSelect(){}return CloseOnSelect.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),container.on("select",function(evt){self._selectTriggered(evt)}),container.on("unselect",function(evt){self._selectTriggered(evt)})},CloseOnSelect.prototype._selectTriggered=function(_,evt){var originalEvent=evt.originalEvent;originalEvent&&originalEvent.ctrlKey||this.trigger("close",{})},CloseOnSelect}),S2.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(args){var overChars=args.input.length-args.maximum,message="Please delete "+overChars+" character";return 1!=overChars&&(message+="s"),message},inputTooShort:function(args){var remainingChars=args.minimum-args.input.length,message="Please enter "+remainingChars+" or more characters";return message},loadingMore:function(){return"Loading more results…"},maximumSelected:function(args){var message="You can only select "+args.maximum+" item";return 1!=args.maximum&&(message+="s"),message},noResults:function(){return"No results found"},searching:function(){return"Searching…"}}}),S2.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function($,require,ResultsList,SingleSelection,MultipleSelection,Placeholder,AllowClear,SelectionSearch,EventRelay,Utils,Translation,DIACRITICS,SelectData,ArrayData,AjaxData,Tags,Tokenizer,MinimumInputLength,MaximumInputLength,MaximumSelectionLength,Dropdown,DropdownSearch,HidePlaceholder,InfiniteScroll,AttachBody,MinimumResultsForSearch,SelectOnClose,CloseOnSelect,EnglishTranslation){function Defaults(){this.reset()}Defaults.prototype.apply=function(options){if(options=$.extend({},this.defaults,options),null==options.dataAdapter){if(options.dataAdapter=null!=options.ajax?AjaxData:null!=options.data?ArrayData:SelectData,options.minimumInputLength>0&&(options.dataAdapter=Utils.Decorate(options.dataAdapter,MinimumInputLength)),options.maximumInputLength>0&&(options.dataAdapter=Utils.Decorate(options.dataAdapter,MaximumInputLength)),options.maximumSelectionLength>0&&(options.dataAdapter=Utils.Decorate(options.dataAdapter,MaximumSelectionLength)),options.tags&&(options.dataAdapter=Utils.Decorate(options.dataAdapter,Tags)),(null!=options.tokenSeparators||null!=options.tokenizer)&&(options.dataAdapter=Utils.Decorate(options.dataAdapter,Tokenizer)),null!=options.query){var Query=require(options.amdBase+"compat/query");options.dataAdapter=Utils.Decorate(options.dataAdapter,Query)}if(null!=options.initSelection){var InitSelection=require(options.amdBase+"compat/initSelection");options.dataAdapter=Utils.Decorate(options.dataAdapter,InitSelection)}}if(null==options.resultsAdapter&&(options.resultsAdapter=ResultsList,null!=options.ajax&&(options.resultsAdapter=Utils.Decorate(options.resultsAdapter,InfiniteScroll)),null!=options.placeholder&&(options.resultsAdapter=Utils.Decorate(options.resultsAdapter,HidePlaceholder)),options.selectOnClose&&(options.resultsAdapter=Utils.Decorate(options.resultsAdapter,SelectOnClose))),null==options.dropdownAdapter){if(options.multiple)options.dropdownAdapter=Dropdown;else{var SearchableDropdown=Utils.Decorate(Dropdown,DropdownSearch);options.dropdownAdapter=SearchableDropdown}if(0!==options.minimumResultsForSearch&&(options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,MinimumResultsForSearch)),options.closeOnSelect&&(options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,CloseOnSelect)),null!=options.dropdownCssClass||null!=options.dropdownCss||null!=options.adaptDropdownCssClass){var DropdownCSS=require(options.amdBase+"compat/dropdownCss");options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,DropdownCSS)}options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,AttachBody)}if(null==options.selectionAdapter){if(options.selectionAdapter=options.multiple?MultipleSelection:SingleSelection,null!=options.placeholder&&(options.selectionAdapter=Utils.Decorate(options.selectionAdapter,Placeholder)),options.allowClear&&(options.selectionAdapter=Utils.Decorate(options.selectionAdapter,AllowClear)),options.multiple&&(options.selectionAdapter=Utils.Decorate(options.selectionAdapter,SelectionSearch)),null!=options.containerCssClass||null!=options.containerCss||null!=options.adaptContainerCssClass){var ContainerCSS=require(options.amdBase+"compat/containerCss");options.selectionAdapter=Utils.Decorate(options.selectionAdapter,ContainerCSS)}options.selectionAdapter=Utils.Decorate(options.selectionAdapter,EventRelay)}if("string"==typeof options.language)if(options.language.indexOf("-")>0){var languageParts=options.language.split("-"),baseLanguage=languageParts[0];options.language=[options.language,baseLanguage]}else options.language=[options.language];if($.isArray(options.language)){var languages=new Translation;options.language.push("en");for(var languageNames=options.language,l=0;l<languageNames.length;l++){var name=languageNames[l],language={};try{language=Translation.loadPath(name)}catch(e){try{name=this.defaults.amdLanguageBase+name,language=Translation.loadPath(name)}catch(ex){options.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+name+'" could not be automatically loaded. A fallback will be used instead.');continue}}languages.extend(language)}options.translations=languages}else{var baseTranslation=Translation.loadPath(this.defaults.amdLanguageBase+"en"),customTranslation=new Translation(options.language);customTranslation.extend(baseTranslation),options.translations=customTranslation}return options},Defaults.prototype.reset=function(){function stripDiacritics(text){function match(a){return DIACRITICS[a]||a}return text.replace(/[^\u0000-\u007E]/g,match)}function matcher(params,data){if(""===$.trim(params.term))return data;if(data.children&&data.children.length>0){for(var match=$.extend(!0,{},data),c=data.children.length-1;c>=0;c--){var child=data.children[c],matches=matcher(params,child);null==matches&&match.children.splice(c,1)}return match.children.length>0?match:matcher(params,match)}var original=stripDiacritics(data.text).toUpperCase(),term=stripDiacritics(params.term).toUpperCase();return original.indexOf(term)>-1?data:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:Utils.escapeMarkup,language:EnglishTranslation,matcher:matcher,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(data){return data},templateResult:function(result){return result.text},templateSelection:function(selection){return selection.text},theme:"default",width:"resolve"}},Defaults.prototype.set=function(key,value){var camelKey=$.camelCase(key),data={};data[camelKey]=value;var convertedData=Utils._convertData(data);$.extend(this.defaults,convertedData)};var defaults=new Defaults;return defaults}),S2.define("select2/options",["require","jquery","./defaults","./utils"],function(require,$,Defaults,Utils){function Options(options,$element){if(this.options=options,null!=$element&&this.fromElement($element),this.options=Defaults.apply(this.options),$element&&$element.is("input")){var InputCompat=require(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=Utils.Decorate(this.options.dataAdapter,InputCompat)}}return Options.prototype.fromElement=function($e){var excludedData=["select2"];null==this.options.multiple&&(this.options.multiple=$e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=$e.prop("disabled")),null==this.options.language&&($e.prop("lang")?this.options.language=$e.prop("lang").toLowerCase():$e.closest("[lang]").prop("lang")&&(this.options.language=$e.closest("[lang]").prop("lang"))),null==this.options.dir&&(this.options.dir=$e.prop("dir")?$e.prop("dir"):$e.closest("[dir]").prop("dir")?$e.closest("[dir]").prop("dir"):"ltr"),$e.prop("disabled",this.options.disabled),$e.prop("multiple",this.options.multiple),$e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),$e.data("data",$e.data("select2Tags")),$e.data("tags",!0)),$e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),$e.attr("ajax--url",$e.data("ajaxUrl")),$e.data("ajax--url",$e.data("ajaxUrl")));var dataset={};dataset=$.fn.jquery&&"1."==$.fn.jquery.substr(0,2)&&$e[0].dataset?$.extend(!0,{},$e[0].dataset,$e.data()):$e.data();var data=$.extend(!0,{},dataset);data=Utils._convertData(data);for(var key in data)$.inArray(key,excludedData)>-1||($.isPlainObject(this.options[key])?$.extend(this.options[key],data[key]):this.options[key]=data[key]);return this},Options.prototype.get=function(key){return this.options[key]},Options.prototype.set=function(key,val){this.options[key]=val},Options}),S2.define("select2/core",["jquery","./options","./utils","./keys"],function($,Options,Utils,KEYS){var Select2=function($element,options){null!=$element.data("select2")&&$element.data("select2").destroy(),this.$element=$element,this.id=this._generateId($element),options=options||{},this.options=new Options(options,$element),Select2.__super__.constructor.call(this);var tabindex=$element.attr("tabindex")||0;$element.data("old-tabindex",tabindex),$element.attr("tabindex","-1");var DataAdapter=this.options.get("dataAdapter");this.dataAdapter=new DataAdapter($element,this.options);var $container=this.render();this._placeContainer($container);var SelectionAdapter=this.options.get("selectionAdapter");this.selection=new SelectionAdapter($element,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,$container);var DropdownAdapter=this.options.get("dropdownAdapter");this.dropdown=new DropdownAdapter($element,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,$container);var ResultsAdapter=this.options.get("resultsAdapter");this.results=new ResultsAdapter($element,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var self=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(initialData){self.trigger("selection:update",{data:initialData})}),$element.addClass("select2-hidden-accessible"),$element.attr("aria-hidden","true"),this._syncAttributes(),$element.data("select2",this)};return Utils.Extend(Select2,Utils.Observable),Select2.prototype._generateId=function($element){var id="";return id=null!=$element.attr("id")?$element.attr("id"):null!=$element.attr("name")?$element.attr("name")+"-"+Utils.generateChars(2):Utils.generateChars(4),id="select2-"+id},Select2.prototype._placeContainer=function($container){$container.insertAfter(this.$element);var width=this._resolveWidth(this.$element,this.options.get("width"));null!=width&&$container.css("width",width)},Select2.prototype._resolveWidth=function($element,method){var WIDTH=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==method){var styleWidth=this._resolveWidth($element,"style");return null!=styleWidth?styleWidth:this._resolveWidth($element,"element")}if("element"==method){var elementWidth=$element.outerWidth(!1);return 0>=elementWidth?"auto":elementWidth+"px"}if("style"==method){var style=$element.attr("style");if("string"!=typeof style)return null;for(var attrs=style.split(";"),i=0,l=attrs.length;l>i;i+=1){var attr=attrs[i].replace(/\s/g,""),matches=attr.match(WIDTH);if(null!==matches&&matches.length>=1)return matches[1]}return null}return method},Select2.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},Select2.prototype._registerDomEvents=function(){var self=this;this.$element.on("change.select2",function(){self.dataAdapter.current(function(data){self.trigger("selection:update",{data:data})})}),this._sync=Utils.bind(this._syncAttributes,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._sync);var observer=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=observer?(this._observer=new observer(function(mutations){$.each(mutations,self._sync)}),this._observer.observe(this.$element[0],{attributes:!0,subtree:!1})):this.$element[0].addEventListener&&this.$element[0].addEventListener("DOMAttrModified",self._sync,!1)},Select2.prototype._registerDataEvents=function(){var self=this;this.dataAdapter.on("*",function(name,params){self.trigger(name,params)})},Select2.prototype._registerSelectionEvents=function(){var self=this,nonRelayEvents=["toggle","focus"];this.selection.on("toggle",function(){self.toggleDropdown()}),this.selection.on("focus",function(params){self.focus(params)}),this.selection.on("*",function(name,params){-1===$.inArray(name,nonRelayEvents)&&self.trigger(name,params)})},Select2.prototype._registerDropdownEvents=function(){var self=this;this.dropdown.on("*",function(name,params){self.trigger(name,params)})},Select2.prototype._registerResultsEvents=function(){var self=this;this.results.on("*",function(name,params){self.trigger(name,params)})},Select2.prototype._registerEvents=function(){var self=this;this.on("open",function(){self.$container.addClass("select2-container--open")}),this.on("close",function(){self.$container.removeClass("select2-container--open")}),this.on("enable",function(){self.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){self.$container.addClass("select2-container--disabled")}),this.on("blur",function(){self.$container.removeClass("select2-container--focus")}),this.on("query",function(params){self.isOpen()||self.trigger("open",{}),this.dataAdapter.query(params,function(data){self.trigger("results:all",{data:data,query:params})})}),this.on("query:append",function(params){this.dataAdapter.query(params,function(data){self.trigger("results:append",{data:data,query:params})})}),this.on("keypress",function(evt){var key=evt.which;self.isOpen()?key===KEYS.ESC||key===KEYS.TAB||key===KEYS.UP&&evt.altKey?(self.close(),evt.preventDefault()):key===KEYS.ENTER?(self.trigger("results:select",{}),evt.preventDefault()):key===KEYS.SPACE&&evt.ctrlKey?(self.trigger("results:toggle",{}),evt.preventDefault()):key===KEYS.UP?(self.trigger("results:previous",{}),evt.preventDefault()):key===KEYS.DOWN&&(self.trigger("results:next",{}),evt.preventDefault()):(key===KEYS.ENTER||key===KEYS.SPACE||key===KEYS.DOWN&&evt.altKey)&&(self.open(),evt.preventDefault())})},Select2.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},Select2.prototype.trigger=function(name,args){var actualTrigger=Select2.__super__.trigger,preTriggerMap={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(void 0===args&&(args={}),name in preTriggerMap){var preTriggerName=preTriggerMap[name],preTriggerArgs={prevented:!1,name:name,args:args};if(actualTrigger.call(this,preTriggerName,preTriggerArgs),preTriggerArgs.prevented)return void(args.prevented=!0)}actualTrigger.call(this,name,args)},Select2.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},Select2.prototype.open=function(){this.isOpen()||this.trigger("query",{})},Select2.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},Select2.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},Select2.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},Select2.prototype.focus=function(){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},Select2.prototype.enable=function(args){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),(null==args||0===args.length)&&(args=[!0]);var disabled=!args[0];this.$element.prop("disabled",disabled)},Select2.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var data=[];return this.dataAdapter.current(function(currentData){data=currentData}),data},Select2.prototype.val=function(args){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==args||0===args.length)return this.$element.val();var newVal=args[0];$.isArray(newVal)&&(newVal=$.map(newVal,function(obj){return obj.toString()})),this.$element.val(newVal).trigger("change")},Select2.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._sync),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&this.$element[0].removeEventListener("DOMAttrModified",this._sync,!1),this._sync=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},Select2.prototype.render=function(){var $container=$('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return $container.attr("dir",this.options.get("dir")),this.$container=$container,this.$container.addClass("select2-container--"+this.options.get("theme")),$container.data("element",this.$element),$container},Select2}),S2.define("jquery-mousewheel",["jquery"],function($){return $}),S2.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function($,_,Select2,Defaults){if(null==$.fn.select2){var thisMethods=["open","close","destroy"];$.fn.select2=function(options){if(options=options||{},"object"==typeof options)return this.each(function(){{var instanceOptions=$.extend(!0,{},options);new Select2($(this),instanceOptions)}}),this;if("string"==typeof options){var ret;return this.each(function(){var instance=$(this).data("select2");null==instance&&window.console&&console.error&&console.error("The select2('"+options+"') method was called on an element that is not using Select2.");var args=Array.prototype.slice.call(arguments,1);ret=instance[options].apply(instance,args)}),$.inArray(options,thisMethods)>-1?this:ret}throw new Error("Invalid arguments for Select2: "+options)}}return null==$.fn.select2.defaults&&($.fn.select2.defaults=Defaults),Select2}),{define:S2.define,require:S2.require}
}(),select2=S2.require("jquery.select2");return jQuery.fn.select2.amd=S2,select2}),define("common/widgets/selectMember",["jquery","select2"],function($){return function(module){module.directive("selectMember",["members",function(memberService){return{restrict:"A",scope:{selectMemberPlaceholder:"@"},link:function(scope,$element){function init(members){function templateResult(state){return state.id&&state.text?$('<span><img src="'+state.photo+'" width="24" height="24"> '+state.name+"</span>"):void 0}function templateSelection(state){return state.id?state.name:state.text}members=members.map(function(member){return{id:member.userId,text:member.pinyin,name:member.name,photo:member.photo}}),$element.select2({data:members,placeholder:scope.selectMemberPlaceholder||"查找成员",allowClear:!0,templateResult:templateResult,templateSelection:templateSelection})}init(memberService.getMembers()),scope.$on(memberService.EVENT.CHANGED,function(evt,members){$element.select2("destroy"),init(members)})}}}])}}),define("common/filters/timesizeFilter",["jquery","underscore"],function(){"use strict";return function(){return function(input){var result;return result=parseInt(input/1e3+.5,10)+'"'}}}),define("common/filters/aliasFilter",["jquery","underscore"],function($,_){"use strict";return function(aliasService,launcher){return function(userOrUserId){if(!userOrUserId)return"";if(_.isString(userOrUserId)){if(aliasService.aliasList[userOrUserId])return aliasService.aliasList[userOrUserId].name;var aliasName=userOrUserId;return aliasName==launcher.getUser().userId?launcher.getUser().name:(aliasService.getAliasName(userOrUserId,function(name){aliasName=name}),aliasName)}if(_.isObject(userOrUserId)){if(aliasService.aliasList[userOrUserId.userId])return aliasService.aliasList[userOrUserId.userId].name;if(aliasService.aliasList[userOrUserId.id])return aliasService.aliasList[userOrUserId.id].name;if(userOrUserId.name)return userOrUserId.name}return""}}}),define("common/filters/photoFilter",["jquery","underscore"],function(){"use strict";return function(){return function(input){var result;return result=input||"style/images/033488d9.dummy_user.jpg"}}}),define("common/filters/keyword",["underscore"],function(_){"use strict";var regexpCache={},re=/[\.\\\+\*\?\^\,\$\=\!\{\}\(\)\[\]]/g;return function(){return function(text,kw,cls){var regexp;return _.isString(text)&&_.isString(kw)?(regexp=regexpCache[kw],void 0===regexp&&(regexp=new RegExp(kw.replace(re,"\\$&"),"g"),regexpCache[kw]=regexp),text.replace(regexp,'<span class="'+(cls||"keyword")+'">$&</span>')):text}}}),define("common/filters/dateFormat",["underscore"],function(_){"use strict";return function(dateFilter){var cache={};return function(date,fmt){var key,value;if(void 0!==date&&_.isString(fmt))return key=date.getTime()/1e3+"@"+fmt,value=cache[key],void 0!==value?value:(value=dateFilter(date,fmt),cache[key]=value,value)}}}),define("common/filters/cutStringFilter",["jquery","underscore"],function(){"use strict";return function(){function countLength(str){if(!str)return 0;var cArr=str.match(/[^\x00-\xff]/gi);return str.length+(null===cArr?0:cArr.length)}return function(str,length){var i,cnt=0,newStr="";if(!str)return str;if(length=Number(length),str=str.replace(/\n/g,""),str=str.replace(/\r/g,""),countLength(str)>length){for(i=0;i<str.length&&(/[^\x00-\xff]/gi.test(str[i])?cnt+=2:cnt++,!(cnt>length));i++)newStr+=str[i];return newStr+"..."}return str}}}),define("common/filters/longdateFilter",["jquery","underscore"],function(){"use strict";return function(){return function(input){var result,today,date;switch(today=parseInt(((new Date).getTime()+288e5)/864e5,10),date=parseInt((input+288e5)/864e5,10),today-date){case 0:result="今天";break;case 1:result="昨天";break;default:result=""}return result}}}),define("common/filters/highlightFilter",["jquery","underscore"],function($,_){"use strict";return function(){return function(str,value){var result,keywords;return str&&value?(keywords=value.split(/[\s'"‘“”’’,，。*、~!@#$%&<>《》?\|\(\)\（\）\[\]\【\】\.\^\/]+/),keywords=_.without(keywords,""),result=str.replace(new RegExp("("+keywords.join("|")+")","ig"),'<span class="highlight">$1</span>')):str}}}),define("common/filters/emojiFilter",["jquery","underscore","util/emoji"],function($,_,emojis){"use strict";return function(){return function(input){if(!input)return input;var result=input;return _.each(emojis,function(emoji){if(-1!==result.indexOf(emoji.Tag)){var re=new RegExp(emoji.Tag+";","g");result=result.replace(re,'<div class="emoji '+emoji.Class+'"></div>')}}),result}}}),!function($,window,document,undefined){"use strict";function Linkified(element,options){this._defaults=defaults,this.element=element,this.setOptions(options),this.init()}var defaults={tagName:"a",newLine:"\n",target:"_blank",linkClass:null,linkClasses:[],linkAttributes:null};Linkified.prototype={constructor:Linkified,init:function(){1===this.element.nodeType?Linkified.linkifyNode.call(this,this.element):this.element=Linkified.linkify.call(this,this.element.toString())},setOptions:function(options){this.settings=Linkified.extendSettings(options,this.settings)},toString:function(){return this.element.toString()}},Linkified.extendSettings=function(options,settings){var prop;settings=settings||{};for(prop in defaults)settings[prop]||(settings[prop]=defaults[prop]);for(prop in options)settings[prop]=options[prop];return settings},Linkified.linkMatch=new RegExp(["(",'\\s|[^a-zA-Z0-9.\\+_\\/"\\>\\-]|^',")(?:","(","[a-zA-Z0-9\\+_\\-]+","(?:","\\.[a-zA-Z0-9\\+_\\-]+",")*@",")?(","http:\\/\\/|https:\\/\\/|ftp:\\/\\/",")?(","(?:(?:[a-z0-9][a-z0-9_%\\-_+]*\\.)+)",")(","(?:com|ca|co|edu|gov|net|org|dev|biz|cat|int|pro|tel|mil|aero|asia|coop|info|jobs|mobi|museum|name|post|travel|local|[a-z]{2})",")(","(?:","[\\/|\\?]","(?:","[\\-a-zA-Z0-9_%#*&+=~!?,;:.\\/]*",")*",")","[\\-\\/a-zA-Z0-9_%#*&+=~]","|","\\/?",")?",")(",'[^a-zA-Z0-9\\+_\\/"\\<\\-]|$',")"].join(""),"g"),Linkified.emailLinkMatch=/(<[a-z]+ href=\")(http:\/\/)([a-zA-Z0-9\+_\-]+(?:\.[a-zA-Z0-9\+_\-]+)*@)/g,Linkified.linkify=function(text,options){var attr,settings,linkClasses,linkReplace=[];this.constructor===Linkified&&this.settings?(settings=this.settings,options&&(settings=Linkified.extendSettings(options,settings))):settings=Linkified.extendSettings(options),linkClasses=settings.linkClass?settings.linkClass.split(/\s+/):[],linkClasses.push.apply(linkClasses,settings.linkClasses),text=text.replace(/</g,"&lt;").replace(/(\s)/g,"$1$1"),linkReplace.push("$1<"+settings.tagName,'href="http://$2$4$5$6"'),linkReplace.push('class="linkified'+(linkClasses.length>0?" "+linkClasses.join(" "):"")+'"'),settings.target&&linkReplace.push('target="'+settings.target+'"');for(attr in settings.linkAttributes)linkReplace.push([attr,'="',settings.linkAttributes[attr].replace(/\"/g,"&quot;").replace(/\$/g,"&#36;"),'"'].join(""));return linkReplace.push(">$2$3$4$5$6</"+settings.tagName+">$7"),text=text.replace(Linkified.linkMatch,linkReplace.join(" ")),text=text.replace(Linkified.emailLinkMatch,"$1mailto:$3"),text=text.replace(/(\s){2}/g,"$1"),text=text.replace(/\n/g,settings.newLine)},Linkified.linkifyNode=function(node){var children,childNode,childCount,dummyElement,i;if(node&&"object"==typeof node&&1===node.nodeType&&"a"!==node.tagName.toLowerCase()&&!/[^\s]linkified[\s$]/.test(node.className)){for(children=[],dummyElement=Linkified._dummyElement||document.createElement("div"),childNode=node.firstChild,childCount=node.childElementCount;childNode;){if(3===childNode.nodeType){for(;dummyElement.firstChild;)dummyElement.removeChild(dummyElement.firstChild);for(dummyElement.innerHTML=Linkified.linkify.call(this,childNode.textContent||childNode.innerText),children.push.apply(children,dummyElement.childNodes);dummyElement.firstChild;)dummyElement.removeChild(dummyElement.firstChild)}else children.push(1===childNode.nodeType?Linkified.linkifyNode(childNode):childNode);childNode=childNode.nextSibling}for(;node.firstChild;)node.removeChild(node.firstChild);for(i=0;i<children.length;i++)node.appendChild(children[i])}return node},Linkified._dummyElement=document.createElement("div"),$.fn.linkify=function(options){return this.each(function(){var linkified;(linkified=$.data(this,"plugin-linkify"))?(linkified.setOptions(options),linkified.init()):$.data(this,"plugin-linkify",new Linkified(this,options))})},$.fn.linkify.Constructor=Linkified,$(window).on("load",function(){$("[data-linkify]").each(function(){var $target,$this=$(this),target=$this.attr("data-linkify"),options={tagName:$this.attr("data-linkify-tagname")||undefined,newLine:$this.attr("data-linkify-newline")||undefined,target:$this.attr("data-linkify-target")||undefined,linkClass:$this.attr("data-linkify-linkclass")||undefined};$target="this"===target?$this:$this.find(target),$target.linkify(options)})}),$("body").on("click",".linkified",function(){var $link=$(this),url=$link.attr("href"),isEmail=/^mailto:/i.test(url),target=$link.attr("target");return isEmail?window.location.href=url:window.open(url,target),!1})}(jQuery,window,document),define("linkify",["jquery"],function(global){return function(){var ret;return ret||global.jQuery}}(this)),define("common/filters/htmlFilter",["jquery","linkify"],function($){"use strict";return function(){return function(input){if(!input)return input;var result,el=$("<div>"+input.replace(new RegExp("&","g"),"&amp;amp;").replace(new RegExp('"',"g"),"&quot;").replace(new RegExp("<","g"),"&lt;").replace(new RegExp(">","g"),"&gt;").replace(new RegExp(" ","g"),"&nbsp;").replace(new RegExp("\n","g"),"<br>")+"</div>").linkify();return result=el.html(),el.remove(),result}}}),define("common/filters/linkFilter",["jquery","linkify"],function($){"use strict";return function(){return function(input){if(!input)return input;var result,el=$("<div>"+input+"</div>").linkify();return result=el.html(),el.remove(),result}}}),define("common/filters/roleNameFilter",["underscore"],function(){"use strict";return function(ROLES){return function(roleKey){var roleName="";switch(roleKey){case ROLES.ORG_OWNER:roleName="创建者";break;case ROLES.ORG_MANAGER:roleName="管理员";break;case ROLES.ORG_USER:roleName="普通用户";break;default:roleName="普通用户"}return roleName}}}),define("common/filters/cutStringWithSuffix",[],function(){return function($filter){return function(str,length){if(!str)return str;length=Number(length),str=str.replace(/[\n\r]/g,"");var index=str.lastIndexOf(".");return-1===index?$filter("cut")(str,length):length>=index?str:$filter("cut")(str.slice(0,index),length)+" "+str.slice(index)}}}),define("common/filters/jsonParse",[],function(){return function(module){module.filter("jsonParse",[function(){return function(string){return JSON.parse(string)}}])}}),define("common/client/proxy",["underscore"],function(_){"use strict";return function($rootScope){var EVENTS={MENU_SELECT:"proxy.selectCtxMenu",SCREENSHOT_TAKE:"proxy.showScreenshot",SCREENSHOT_UPLOAD:"proxy.onUploadScreenshotDone",FILE_DROP:"proxy.onDropFile",FILE_UPLOAD:"proxy.onUploadFile",SET_NOTIFY_LIST:"proxy.setNotifyMsg"},domain=document.domain,enablePC=window.hasOwnProperty("YGroup"),enableMac=window.hasOwnProperty("YGroupMac"),PLATFORM_FUNCTION={takeScreenshot:["takeScreenshot"],uploadScreenshot:["uploadScreenshot"],uploadChatImage:["uploadChatImage"],uploadP2PImage:["uploadP2PImage"],dropFile:["dropFile"],uploadFile:["uploadFile"],updateFile:["updateFile"],uploadFolder:["uploadDir"],download:["download","downloadFile"],downloadDir:["downloadDir","downloadFile"],ctxMenu:["ctxMenu"],setMessage:["setNumber"],copyText:["copyText"],updateSetting:["groupSettingChanged"],edit:["edit"],compareDocument:["compareDocument"],setDialogType:["setDialogType"],registerUrlPattern:["registerUrlPattern"]},proxy=function(){return enablePC&&(window.YGroup.setGroupDomain(domain),window.YGroup.Ready(function(name,args){_.each(EVENTS,function(evtKey){evtKey==="proxy."+name&&$rootScope.$apply(function(){$rootScope.$broadcast.apply($rootScope,[evtKey].concat(args))})})}.bind(proxy),document)),{takeScreenshot:function(hideWindow){var fn=this.isSupport("takeScreenshot");return fn?(this.platformObject[fn](hideWindow!==!1),!0):!1},uploadScreenshot:function(imageSrc,groupId){var fn=this.isSupport("uploadScreenshot");return fn?(this.platformObject[fn](String(imageSrc),String(groupId)),!0):!1},uploadChatImage:function(groupId){var fn=this.isSupport("uploadChatImage");return fn?(this.platformObject[fn](String(groupId)),!0):!1},uploadP2PImage:function(otherId){var fn=this.isSupport("uploadP2PImage");return fn?(this.platformObject[fn](String(otherId)),!0):!1},dropFile:function(groupId,folderId,MAX_UPLOAD_SIZE){var fn=this.isSupport("dropFile");return fn?(this.platformObject[fn](String(groupId),String(folderId),Number(MAX_UPLOAD_SIZE)),!0):!1},uploadFile:function(groupId,folderId,MAX_UPLOAD_SIZE){var fn=this.isSupport("uploadFile");return fn?(this.platformObject[fn](String(groupId),String(folderId),Number(MAX_UPLOAD_SIZE)),!0):!1},updateFile:function(groupId,fileId,fileName,MAX_UPLOAD_SIZE){var fn=this.isSupport("updateFile");return fn?(this.platformObject[fn](String(groupId),String(fileId),String(fileName),Number(MAX_UPLOAD_SIZE)),!0):!1},uploadFolder:function(groupId,folderId,MAX_UPLOAD_SIZE){var fn=this.isSupport("uploadFolder");return fn?(this.platformObject[fn](String(groupId),String(folderId),Number(MAX_UPLOAD_SIZE)),!0):!1},download:function(name,path){var fn=this.isSupport("download");return fn?(this.platformObject[fn](String(path),String(name)),!0):!1},downloadDir:function(name,path){var fn=this.isSupport("downloadDir");return fn?(this.isPC()?this.platformObject[fn](String(path),String(name)):this.isMac()&&this.platformObject[fn](String(path),String(name+".zip")),!0):!1},ctxMenu:function(args){var fn=this.isSupport("ctxMenu");return fn?(this.platformObject[fn](_.map(args,function(arg){return _.defaults(arg,{isDefault:!1,isDisabled:!1,isChecked:!1,key:"",type:0})})),!0):!1},setMessage:function(sum){var fn=this.isSupport("setMessage");return fn?(sum>=0&&this.platformObject[fn](sum),!0):!1},copyText:function(text){var fn=this.isSupport("copyText");return fn?(this.platformObject[fn](text),!0):!1},updateSetting:function(){var fn=this.isSupport("updateSetting");return fn?(this.platformObject[fn](),!0):!1},edit:function(name,path){var fn=this.isSupport("edit");return fn?(this.platformObject[fn](String(path),String(name)),!0):!1},compareDocument:function(name1,path1,name2,path2){var fn=this.isSupport("compareDocument");return fn?(this.platformObject[fn](String(path1),String(name1),String(path2),String(name2)),!0):!1},setDialogType:function(type){var fn=this.isSupport("setDialogType");return fn?(this.platformObject[fn](type),!0):!1},registerUrlPattern:function(urlPattern){var fn=this.isSupport("registerUrlPattern");return fn?(this.platformObject[fn](urlPattern),!0):!1},isSupport:function(name){if(_.isFunction(this[name])){var fn,fns=PLATFORM_FUNCTION[name];if(_.each(fns,function(value){(enablePC&&_.isFunction(window.YGroup[value])||enableMac&&"function"==typeof window.YGroupMac[value])&&(fn=value)}),fn)return fn}return!1},isNative:function(){return enablePC||enableMac},isPC:function(minVersionCode){var versionCode,ua=navigator.userAgent;return minVersionCode?(versionCode=ua.match(/YNoteCEF\/(\d+\.\d+.\d+.\d+)/i))?(versionCode=versionCode[1],function(v1,v2){for(var t1,t2,i=0,a1=v1.split("."),a2=v2.split(".");;){if(i==a1.length||i==a2.length)return a1.length>=a2.length;if(t1=a1[i],t2=a2[i],t1>t2)return!0;if(t2>t1)return!1;i++}}(versionCode,minVersionCode)):!1:enablePC},isMac:function(){return enableMac},isMacBrowser:function(){var ua=window.navigator.userAgent,result=!1;return-1!==ua.toLowerCase().indexOf("mac")&&(result=!0),result&&!this.isMac()},isSafari:function(){return/version\/[\d]+.*safari/i.test(navigator.userAgent)||this.isMac()},isEdge:function(){return-1!==window.navigator.userAgent.indexOf("Edge")},platform:enablePC?"PC":enableMac?"Mac":"Web",platformObject:enablePC?window.YGroup:enableMac?window.YGroupMac:null}}();return _.extend(proxy,EVENTS),proxy}}),define("common/service/labService",["underscore","util/tracker"],function(_,tracker){"use strict";return function($http,storageManager,launcher,LOCAL_STORAGE_KEY){function addGroupIds(setting){setting.isGroup&&(setting.groupIds=launcher.getGroupsOwnedByMe().map(function(group){return group.id}))}function getSettings(){return migrateLocalStorageSettings.then(function(){return $http.get("/yhs/api/lab-settings")}).then(function(res){return settings.map(function(setting){return setting.active=!!res.data[setting.id],addGroupIds(setting),setting})})}function putSetting(setting){if(setting.active){var data="";return setting.isGroup&&(addGroupIds(setting),data=angular.toJson(setting.groupIds)),$http.post("/yhs/api/lab-settings/"+setting.id,data,{transformRequest:!1,headers:{"Content-Type":"application/json"}})}return $http.delete("/yhs/api/lab-settings/"+setting.id)}var settings=[{id:1,title:"全局加星文件",description:"无论身在何处，重要文件都可在这里找到"},{id:2,title:"群加星",description:"将你时刻关注的协作群保持在最上"},{id:100,isGroup:!0,title:"群公告",description:"您为群主的协作群内可发布信息，提示所有人关注"},{id:101,isGroup:!0,title:"群日历",description:"您为群主的协作群将拥有群成员日历功能"}],migrateLocalStorageSettings=launcher.wait().then(function(){var userStorage=storageManager.forUser(launcher.getUser().userId),activeIds=_.chain(settings).filter(function(setting){return!!userStorage.get(LOCAL_STORAGE_KEY.LAB_PREFIX+setting.id)}).map(function(setting){return userStorage.remove(LOCAL_STORAGE_KEY.LAB_PREFIX+setting.id),setting.id}).value();return activeIds.length?$http.post("/yhs/api/lab-settings",angular.toJson(activeIds),{transformRequest:!1,headers:{"Content-Type":"application/json"}}):void 0});return{get:function(){return getSettings()},put:function(setting){putSetting(setting),tracker.event("lab","open",setting.title+(setting.active?"on":"off"))},isActive:function(featureId){return getSettings().then(function(list){var setting=_.findWhere(list,{id:featureId});return setting?setting.active:!1})}}}}),define("common/service/eventService",[],function(){return function(module){module.service("eventService",["$http",function($http){function toJson(event){return angular.toJson(_.omit(event,function(value,key){return/^_/.test(key)||"source"===key}))}this.getQueryUrl=function(gid){return"/yhs/api/"+gid+"/events"},this.create=function(gid,event){$http.post("/yhs/api/"+gid+"/events",toJson(event),{transformRequest:!1,headers:{"Content-Type":"application/json"}})},this.update=function(gid,event){$http.patch("/yhs/api/"+gid+"/events/"+event.id,toJson(event),{transformRequest:!1,headers:{"Content-Type":"application/json"}})},this.destroy=function(gid,event){$http.delete("/yhs/api/"+gid+"/events/"+event.id,{transformRequest:!1,headers:{"Content-Type":"application/json"}})}}])}}),define("common/widgets/labSetting/labSettingDirective",["jquery"],function($){"use strict";return function(labService,$rootScope,dialogService,$timeout){function _link($scope,$el){function hide(){containerEl.removeClass(SHOW),$(".main").unbind("click",hide)}var SHOW="show",containerEl=$el.find(".lab-container");labService.get().then(function(list){$scope.list=list}),$scope.switchActive=function(setting,$event){var setActive=function(){$timeout(function(){setting.active=!setting.active,labService.put(setting),$rootScope.$broadcast("labs.change",setting)})};setting.active?setActive():dialogService.confirmBySrc("提示","common/widgets/labSetting/labWarning.html").then(setActive),$event.preventDefault()},$el.find(".title").click(function(evt){containerEl.toggleClass(SHOW),$(".main").unbind("click",hide).bind("click",hide),evt.stopPropagation()}),$el.click(function(evt){evt.stopPropagation()})}return{restrict:"A",templateUrl:"common/widgets/labSetting/labSetting.html",link:_link}}}),define("commonModule",["angular","jplayer","common/service/groupService","common/service/fileManager","common/service/voiceService","common/service/voiceState","common/service/noteManager","common/service/userService","common/service/pomeloService","common/service/chatService","common/service/noticeService","common/service/chatTemplate","common/service/aliasService","common/service/downloadService","common/service/extension","common/service/commentService","common/service/commentFactory","common/service/searchService","common/service/storageManager","common/service/permissionService","common/service/applicantService","common/service/updater","common/service/organizationService","common/service/titleService","common/service/vipService","common/service/filePermissionService","common/service/groupTopService","common/service/notification","common/widgets/upload/selectFileService","common/widgets/upload/selectFolderService","common/widgets/upload/h5uploader","common/widgets/upload/uploadDirective","common/widgets/menu/contextMenuDirective","common/widgets/progress/progressDirective","common/widgets/preview/previewSlide","common/widgets/preview/previewDirective","common/widgets/scroller/scrollDownDirective","common/widgets/maxInputLengthDirective","common/widgets/scroller/scrollerDirective","common/widgets/clipboard/clipboardDirective","common/widgets/toggle/toggle","common/widgets/toggle/emojiToggle","common/widgets/autofocus","common/widgets/at/atDirective","common/widgets/focus","common/widgets/loading/loadingDirective","common/widgets/trackerDirective","common/widgets/highlight","common/widgets/menu/copyMenu","common/widgets/mask","common/widgets/permissionCheckDirective","common/widgets/filePermissionCheckDirective","common/widgets/icon/showIconDirective","common/widgets/icon/changeIconDirective","common/widgets/icon/defaultImageDirective","common/widgets/clipboard/clipButtonDirective","common/widgets/bubble/bubbleDirective","common/widgets/shadowModelDirective","common/widgets/popover","common/widgets/comment/comment","common/widgets/comment/input/sendCommentDirective","common/widgets/comment/input/replyCommentDirective","common/widgets/comment/commentLocal","common/widgets/comment/highlight","common/widgets/selectMember","common/filters/timesizeFilter","common/filters/aliasFilter","common/filters/photoFilter","common/filters/keyword","common/filters/dateFormat","common/filters/cutStringFilter","common/filters/longdateFilter","common/filters/highlightFilter","common/filters/emojiFilter","common/filters/htmlFilter","common/filters/linkFilter","common/filters/roleNameFilter","common/filters/cutStringWithSuffix","common/filters/jsonParse","common/client/proxy","common/service/labService","common/service/eventService","common/widgets/labSetting/labSettingDirective"],function(angular,jplayer,groupService,fileManager,voiceService,voiceState,noteManager,userService,pomeloService,chatService,noticeService,chatTemplate,aliasService,downloadService,extension,commentService,commentFactory,searchService,storageManager,permissionService,applicantService,updater,organizationService,titleService,vipService,filePermissionService,groupTopService,notification,selectFileService,selectFolderService,uploader,uploadDirective,contextMenuDirective,progressDirective,previewSlide,previewDirective,scrollDownDirective,maxInputLengthDirective,scrollerDirective,clipboardDirective,toggle,emojiToggle,autoFocusDirective,atDirective,focusDirective,loadingDirective,trackerDirective,highlightDirective,copyMenuDirective,mask,permissionCheckDirective,filePermissionCheckDirective,showIconDirective,changeIconDirective,defaultImgDirective,clipButtonDirective,bubbleDirective,shadowModelDirective,popover,comment,sendCommentDirective,replyCommentDirective,commentLocal,highlightComment,selectMember,timesizeFilter,aliasFilter,photoFilter,keyword,dateFormat,cutStringFilter,longdateFilter,highlightFilter,emojiFilter,htmlFilter,linkFilter,roleNameFilter,cutStringWithSuffixFilter,jsonParseFilter,clientProxy,labService,eventService,labSettingDirective){"use strict";var module=angular.module("common",[]);return eventService(module),jsonParseFilter(module),comment(module),popover(module),selectMember(module),module.service("groupService",["$http","$rootScope","$q","$cacheFactory","ROLES",groupService]).service("fileManager",["$http","$q","uploader","downloadService","clientProxy","$timeout","dialogService","storageManager","LOCAL_STORAGE_KEY",fileManager]).service("uploader",["$rootScope","$interval","$q","$http",uploader]).service("voiceService",["clientProxy",voiceService]).service("noteManager",["$http","$q","fileManager",noteManager]).service("userService",["$http","$q",userService]).service("clientProxy",["$rootScope","$location",clientProxy]).service("pomeloService",["$http","$rootScope","chatService","clientProxy","PUSH_CATEGORY","EVENT_TYPE",pomeloService]).service("chatService",["$http","$q",chatService]).service("noticeService",["$http","$q",noticeService]).service("chatTemplate",["extension",chatTemplate]).service("aliasService",["$http",aliasService]).service("downloadService",["$http","dialogService","clientProxy",downloadService]).service("selectFileService",["$q","uploader","fileManager","launcher",selectFileService]).service("selectFolderService",["$q","$rootScope","uploader","launcher","fileManager","dialogService",selectFolderService]).service("extension",["$rootScope",extension]).service("commentService",["$rootScope","$http","$q",commentService]).factory("commentFactory",commentFactory).service("commentLocal",["$rootScope",commentLocal]).service("searchService",["$http","$q","fileManager",searchService]).service("storageManager",[storageManager]).service("permissionService",["launcher","ROLES",permissionService]).service("applicantService",["$http","$rootScope","$q",applicantService]).service("updater",["$q",updater]).service("titleService",["DOCUMENT_TITLE",titleService]).service("vipService",["$http","$q",vipService]).service("filePermissionService",["launcher","permissionService","ROLES",filePermissionService]).service("groupTopService",["$rootScope","storageManager","launcher","LOCAL_STORAGE_KEY",groupTopService]).service("notification",["$rootScope","clientProxy","launcher",notification]).directive("widgetContextMenu",["$parse","menuService",contextMenuDirective]).directive("widgetProgress",progressDirective).directive("widgetUpload",["$q","fileManager","uploader","clientProxy","launcher",uploadDirective]).directive("scrollDown",["$rootScope",scrollDownDirective]).directive("maxInputLength",maxInputLengthDirective).directive("widgetScroller",["clientProxy",scrollerDirective]).directive("clipboard",["$window","clientProxy",clipboardDirective]).directive("widgetToggle",["$q","$timeout",toggle.directive]).directive("widgetToggleContent",[toggle.contentDirective]).directive("emojiToggle",["$parse",emojiToggle]).service("previewSlide",["$compile","$http","$rootScope","downloadService","$templateCache","storageManager","launcher","$timeout",previewSlide]).directive("widgetPreview",["previewSlide",previewDirective]).directive("widgetAutoFocus",[autoFocusDirective]).directive("widgetAt",["members","aliasService","launcher",atDirective]).directive("widgetFocus",["$parse",focusDirective]).directive("loadingStyle",loadingDirective).directive("tracker",trackerDirective).directive("widgetHighlight",["$filter",highlightDirective]).directive("widgetCopy",["menuService","clientProxy",copyMenuDirective]).service("widgetMasker",mask).directive("permissionCheck",["permissionService","launcher","ROLES",permissionCheckDirective]).directive("filePermissionCheck",["$rootScope","$parse","filePermissionService",filePermissionCheckDirective]).directive("showIcon",["dialogService",showIconDirective]).directive("changeIcon",["uploader","$parse",changeIconDirective]).directive("defaultSrc",[defaultImgDirective]).service("organizationService",["$http","$rootScope","$q","$cacheFactory","ROLES","ORG_EVENTS","groupService",organizationService]).directive("clipButton",["clientProxy",clipButtonDirective]).directive("widgetBubble",[bubbleDirective]).directive("shadowModel",shadowModelDirective).directive("sendComment",["commentService","commentLocal","launcher","members",sendCommentDirective]).directive("replyComment",["commentService","commentLocal","launcher","$filter","$rootScope","members",replyCommentDirective]).directive("highlightComment",["$location",highlightComment]).service("labService",["$http","storageManager","launcher","LOCAL_STORAGE_KEY",labService]).directive("labSetting",["labService","$rootScope","dialogService","$timeout",labSettingDirective]).filter("timesize",timesizeFilter).filter("alias",["aliasService","launcher",aliasFilter]).filter("photo",photoFilter).filter("keyword",keyword).filter("dateFormat",["dateFilter",dateFormat]).filter("cut",cutStringFilter).filter("longdate",["$filter",longdateFilter]).filter("highlight",highlightFilter).filter("emojiFilter",emojiFilter).filter("htmlFilter",htmlFilter).filter("linkFilter",linkFilter).filter("roleName",["ROLES",roleNameFilter]).filter("cutStringWithSuffix",["$filter",cutStringWithSuffixFilter]).constant("PUSH_CATEGORY",{MESSAGE:0,NOTIFICATION:1,EVENT:2,P2P:3}).constant("MESSAGE_TYPE",{TEXT:0,MEMBER:1,IMAGE:2,VOICE:3,FILE:4,GROUPNOTE:5,USERNOTE:6,GROUP:7,COMMENT:8,MEMBERSETTINGS:9,GROUPTABLE:12,CLEARTRASH:13,BATCHUPLOAD:15,HACK:16,TASK:17}).constant("NOTIFICATION_TYPE",{INVITE:0,ACCEPT_INVITE:1,IGNORE_INVIT:2,APPLY:3,CONFIRM:4,REJECT:5,ADD:6,REMOVE:7,DISSOVE:8,APPLY_USER_EXIST:9,INVITE_USER_EXIST:10,AT_IN_MESSAGE:11,AT_IN_COMMENT:12,COMMENT_REPLIED:13,GIVE_GROUP_TO_OTHER:14,CHANGE_ROLE:15,DELETE_INVITE:16,DEACTIVE_APPLY:17,ENROLLED_IN_ORG:18,KICKED_OUT_FROM_ORG:19,INNER_GRP_RECOVERD:20,INNER_GRP_ERASED:21,NEVER:22,ORG_ROLE_CHANGED:25,ORG_DISMISS:26,ORG_TRANSFER:27,TASK_ASSIGN:30,TASK_FINISH:31,TASK_DELETE:32,TASK_EXPIRE:33,TASK_AT_COMMENT:34}).constant("TASKMESSAGE_TYPE",{COMPLETE:1,DELETE:2,OVERDUE:3,NEW_MSG:4,NEW_TASK:5}).constant("EVENT_TYPE",{MEMBER:1,FILE:4,GROUPNOTE:5,GROUP:7,COMMENT:8,MEMBERSETTINGS:9,LAST_READ_TIME:10,USERSETTINGS:11,GROUPTABLE:12,HACK:16,TASK:17}).constant("LOCAL_STORAGE_KEY",{FILE_META_EXPANDED:"file_meta_expanded",TOP_GROUPS_ARR:"top_groups_arr",LAB_PREFIX:"LAB_",DISABLE_FAVORITE:"disable_favorite",LAST_CLOSED_GROUP:"last_closed_group",TRAIL_EXPIRE_WARNING:"trail_expire_warning",DISABLE_DEMO_TIPS:"disable_demo_tips",DISABLE_ENTERPRISE_AD:"disable_enterprise_ad_second",GROUP_CHAT_PREFIX:"group_chat_",EXPLORER_SORT:"explorer_sort",EXPLORER_TREE:"explorer_tree",HAS_DO_ADD_STAR:"has_do_add_star",NOTE_NEW_PREFIX:"note_new_",NOTE_PREFIX:"note_",DOWNLOAD_FOLDER_HINT:"download_folder_hint"})}),define("pagelet/sidebar/sidebarCtrl",["underscore","util/trackTiming","util/tracker"],function(_,trackTiming,tracker){"use strict";return function($rootScope,$scope,$location,launcher,groupService,userService,dialogs,aliasService,clientProxy,settings,$timeout,storageMgr,groupTopService,applicants,router,orgService,labService,$q,ORG_EVENTS,NOTIFICATION_TYPE,pomeloService,titleService,explorer,dialogService){function openNotifyDialog(){notifyDialog||(notifyDialog=dialogs.open($scope,{src:"pagelet/sidebar/notify/notifyList-dialog.html",userId:$scope.uid(),cls:"notification-list",notificationNum:$scope.notificationUnread,messageNum:$scope.myMessageUnread,tasksNotificationNum:$scope.taskNotificationUnread,segment:$scope.openNotify}).finally(function(){$location.search("notify",null),$location.replace(),notifyDialog=null}))}function setTrail(){var ERROR={INVALID:-1,CONSUMED:-2},trailSuccess=function(){$scope.orgTutorial=!0,$location.search("try",null)};if(void 0!==launcher.getTrailCode()){if(launcher.hasOwnedOrg())return void dialogs.alert("激活失败","尊敬的用户，您已经拥有组织，请勿重复激活。").finally(function(){$location.search("try",null)});launcher.getUser().org_trail&&trailSuccess(),orgService.startTrail(launcher.getTrailCode()).then(function(){launcher.getUser().org_purchased=!0,trailSuccess()},function(errorCode){switch(errorCode){case ERROR.INVALID:dialogs.alert("激活失败","尊敬的用户，激活链接已经失效，请重新申请。");break;case ERROR.CONSUMED:dialogs.alert("激活失败","尊敬的用户，激活链接已经失效，请重新申请。");break;default:dialogs.alert("激活失败","尊敬的用户，您的企业版试用激活链接已经失效，请联系我们youdaogroup@service.netease.com。")
}})}}function setTrailfromBiz(){var trailSuccess=function(){$scope.orgTutorial=!0,$location.search("key",null)};if(void 0!==launcher.getTrailCode()){if(launcher.hasOwnedOrg())return void dialogs.alert("激活失败","尊敬的用户，您已经拥有组织，请勿重复激活。").finally(function(){$location.search("key",null)});launcher.getUser().org_trail&&trailSuccess(),orgService.startTrailfromBiz(launcher.getTrailCode()).then(function(){launcher.getUser().org_purchased=!0,trailSuccess()},function(){})}}function selectTrail(){$location.search()["try"]?setTrail():setTrailfromBiz()}var lastReadTimeList,notifyDialog=null,hidden="undefined",visibilityChange="visibilitychange",unreadTimeList={},setDocumentTitle=function(){$scope.chatNum?titleService.setPrefix("("+$scope.chatNum+")"):titleService.clearPrefix()},addNotification=function(type,time){if(type===NOTIFICATION_TYPE.AT_IN_MESSAGE||type===NOTIFICATION_TYPE.AT_IN_COMMENT||type===NOTIFICATION_TYPE.COMMENT_REPLIED){if(time<applicants.getLastMessageTime())return;$scope.openNotify="message",$scope.myMessageUnread++}else if(type===NOTIFICATION_TYPE.TASK_ASSIGN||type===NOTIFICATION_TYPE.TASK_FINISH||type===NOTIFICATION_TYPE.TASK_DELETE||type===NOTIFICATION_TYPE.TASK_EXPIRE||type===NOTIFICATION_TYPE.TASK_AT_COMMENT)$scope.openNotify="tasksNotification",$scope.taskNotificationUnread++;else{if(time<applicants.getLastNotificationTime())return;$scope.openNotify="notification",$scope.notificationUnread++}},addUnreadAndTop=function(message,unreadNum){var i,firstData,org,groupId=Number(message.groupId||0),fromPull=unreadNum;if(unreadNum||(unreadNum=1),2!==settings.getList()[groupId])for(i=0;i<$scope.groups.length;i++)if(groupId===$scope.groups[i].id){if((groupId!==$scope.gid()||groupId===$scope.gid()&&document[hidden]||groupId===$scope.gid()&&fromPull)&&(!lastReadTimeList[groupId]||lastReadTimeList[groupId]<=message.time)&&($scope.unreads[groupId]+=unreadNum,$scope.chatNum+=unreadNum,unreadTimeList[groupId]=message.time,$scope.fullScreen||setDocumentTitle()),i>0)if(firstData=$scope.groups[i],$scope.groups.splice(i,1),$scope.groups.unshift(firstData),0===firstData.orgId)$scope.personalGroups=_.reject($scope.personalGroups,function(g){return g.id===firstData.id}),$scope.personalGroups.unshift(firstData);else{if(org=_.findWhere($scope.organizations,{id:firstData.orgId}),_.isUndefined(org))return;org.groups=_.reject(org.groups,function(g){return g.id===firstData.id}),org.groups.unshift(firstData)}break}},addOfflineUnreadNum=function(){var lastReadId,unreadNum;$scope.chatNum=0,$scope.unreads={},_.map($scope.groups,function(group){$scope.unreads[group.id]=0}),applicants.getLatestChatId().then(function(groups){_.each(groups,function(group){lastReadId=applicants.lastReadIdList[group.gid],lastReadId&&lastReadId<group.lgmId&&(unreadNum=group.lgmId-lastReadId,addUnreadAndTop({time:group.lgmTime,groupId:group.gid},unreadNum))})})},countUnreadNotificationNum=function(messages){messages=_.filter(messages,function(message){return message.time>applicants.getLastNotificationTime()&&2!==settings.getList()[message.groupId]}),$scope.notificationUnread=messages.length,$scope.myMessageUnread||0===$scope.notificationUnread||($scope.openNotify="notification")},countUnreadMyMessageNum=function(messages){messages=_.filter(messages,function(message){return message.time>applicants.getLastMessageTime()&&2!==settings.getList()[message.groupId]}),$scope.myMessageUnread=messages.length,$scope.myMessageUnread||0===$scope.notificationUnread||($scope.openNotify="notification")},togglePersonalGroups=function(){$scope.showPersonalGroups=!$scope.showPersonalGroups},init=function(){$scope.chatNum=0,$scope.openNotify="message",$scope.client=clientProxy,$scope.launcher=launcher,$scope.groups=[].concat(launcher.getGroups()),$scope.unreads={},$scope.hasOrganization=!1,$scope.ableToCreateOrg=!1,$scope.showPersonalGroups=!0,$scope.togglePersonalGroups=togglePersonalGroups,$scope.personalGroups=$scope.groups,lastReadTimeList=applicants.lastReadTimeList,_.map($scope.groups,function(group){$scope.unreads[group.id]=0}),$scope.notificationUnread=0,$scope.myMessageUnread=0,$scope.taskNotificationUnread=0,$scope.topGroups=groupTopService.getTopGroups(),labService.isActive(1).then(function(result){$scope.globalStarOn=result}),labService.isActive(2).then(function(result){$rootScope.groupTopOn=result}),addOfflineUnreadNum(),applicants.getApplicants(null,null,11,!1).then(countUnreadNotificationNum),applicants.getApplicants(null,null,11,!0).then(countUnreadMyMessageNum)};launcher.wait().then(applicants.init).then(init);var handleGroup=function(groups){void 0!==groups&&($scope.groups=[].concat(groups),_.each($scope.groups,function(group){$scope.unreads[group.id]||($scope.unreads[group.id]=0)}),_.each($scope.unreads,function(num,gid){var g=_.findWhere($scope.groups,{id:Number(gid)});void 0===g&&delete $scope.unreads[gid]}),$scope.chatNum=_.reduce($scope.unreads,function(memo,num){return memo+num},0),setDocumentTitle())},setIconMessageNum=function(num){clientProxy.isMac()&&clientProxy.setMessage(num)},clearUnread=function(num,gid){$scope.unreads[gid]&&($scope.unreads[gid]=0,$scope.chatNum-=num,$scope.chatNum<0&&($scope.chatNum=0),$scope.fullScreen||setDocumentTitle(),unreadTimeList[gid]&&applicants.cancelNotice(applicants.CANCEL_GROUP,[{gid:gid,lrt:unreadTimeList[gid]}]).then(function(){lastReadTimeList[gid]=unreadTimeList[gid],unreadTimeList[gid]=0}))},handleVisibilityChange=function(){document[hidden]||$scope.unreads&&$scope.unreads[$scope.gid()]&&$timeout(function(){clearUnread($scope.unreads[$scope.gid()],$scope.gid())},3e3)},visiblityListener=function(){void 0!==document.hidden?(hidden="hidden",visibilityChange="visibilitychange"):void 0!==document.mozHidden?(hidden="mozHidden",visibilityChange="mozvisibilitychange"):void 0!==document.msHidden?(hidden="msHidden",visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(hidden="webkitHidden",visibilityChange="webkitvisibilitychange"),void 0!==document[hidden]&&document.addEventListener&&document.addEventListener(visibilityChange,handleVisibilityChange,!1)},processCancelType=function(evt,content,value){_.each(value.value,function(message){0===message.type?applicants.getLastMessageTime()<message.lrt&&(applicants.setLastMessageTime(message.lrt),$scope.$emit("mymessage.number.empty")):1===message.type?applicants.getLastNotificationTime()<message.lrt&&(applicants.setLastNotificationTime(message.lrt),$scope.$emit("notification.number.empty")):2===message.type&&_.each(message.lrts,function(group){(!lastReadTimeList[group.gid]||lastReadTimeList[group.gid]<group.lrt)&&(lastReadTimeList[group.gid]=group.lrt,clearUnread($scope.unreads[group.gid],group.gid))})})},processNotificationEvent=function(event,message){message.type===NOTIFICATION_TYPE.KICKED_OUT_FROM_ORG&&($scope.showPersonalGroups=!0),(message.applier.userId!==$scope.uid()||message.applier.userId===$scope.uid()&&(message.type===NOTIFICATION_TYPE.CONFIRM||message.type===NOTIFICATION_TYPE.REJECT||message.type===NOTIFICATION_TYPE.ACCEPT_INVITE||message.type===NOTIFICATION_TYPE.IGNORE_INVIT))&&2!==settings.getList()[message.groupId]&&addNotification(message.type,message.time)};$scope.$watchCollection("launcher.getGroups()",handleGroup),$scope.$watch("launcher.getOrgs()",function(value){void 0!==value&&($scope.hasOrganization=value.length>1?!0:!1,$scope.organizations=value.slice(0,value.length-1),$scope.personalGroups=value[value.length-1].groups,$scope.orgWithTask=$scope.organizations?_.find($scope.organizations,function(org){return org.expireTime.getTime()>Date.now()&&8!==org.comboNum}):null)}),$scope.$on("socket.message",function(event,message){1===message.type&&0===message.action&&message.user.userId===$scope.uid()&&applicants.cancelNotice(applicants.CANCEL_GROUP,[{gid:message.groupId,lrt:message.time,lrId:message.id}]),addUnreadAndTop(message)}),$scope.$on("socket.event.10",processCancelType),$scope.$on("socket.notification",processNotificationEvent),$scope.$on("socket.reconnect",function(){applicants.init().then(launcher.reload).then(init)}),$scope.$on("mymessage.number.empty",function(){$scope.myMessageUnread=0,$scope.notificationUnread&&($scope.openNotify="notification")}),$scope.$on("notification.number.empty",function(){$scope.notificationUnread=0,$scope.openNotify="message"}),$scope.$on("tasksNotification.number.empty",function(){$scope.taskNotificationUnread=0,$scope.openNotify="tasksNotification"}),$scope.$on("labs.change",function($evt,setting){1===setting.id?$scope.globalStarOn=setting.active:2===setting.id&&($rootScope.groupTopOn=setting.active)}),$scope.$on("group.changed",handleVisibilityChange),$scope.$watch("chatNum",setIconMessageNum),$scope.notifyList=function(){openNotifyDialog()},$scope.createGroup=function(){dialogs.open($scope,{src:"pagelet/sidebar/createGroup/createGroup-dialog.html",userId:$scope.uid(),cls:"create-group"})},$scope.$on("org.createGroup",function(evt,orgId){dialogs.open($scope,{src:"pagelet/sidebar/createGroup/createGroup-dialog.html",userId:$scope.uid(),cls:"create-group",organizationId:orgId})}),$scope.joinGroup=function(){dialogs.open($scope,{src:"pagelet/sidebar/joinGroup/joinGroup-dialog.html",userId:$scope.uid(),cls:"join-group"})},$scope.createOrganization=function(){dialogs.open($scope,{src:"pagelet/sidebar/createOrganization/createOrganization-dialog.html",userId:$scope.uid(),cls:"create-organization"})},$scope.clearUnread=clearUnread,$scope.forwardGroup=function(groupId){groupId!==$scope.gid()&&(trackTiming.changeGroupLoadFiles.setLabel("groupId-"+groupId).start(),trackTiming.changeGroupLoadChat.setLabel("groupId-"+groupId).start()),clearUnread($scope.unreads[groupId],groupId),launcher.forward(groupId)},$scope.forwardOrg=function(orgId){router.forward("/org/"+orgId+"/groups")},$scope.$on(groupService.FORWARD,function(evt,groupId){$scope.forwardGroup(groupId)}),$scope.$on(ORG_EVENTS.CREATE,function(){$scope.ableToCreateOrg=!1}),$scope.$on("p2p.chat",function(){$scope.showP2P=!0}),$scope.$on("p2p.unread",function($evt,unread){$scope.unread=unread&&!$scope.showP2P?!0:!1}),$scope.$on("group.up",function(evt,list){$scope.topGroups=list}),$scope.checkOrgLimit=function(){return launcher.hasPurchasedOrg()&&!launcher.hasOwnedOrg()?orgService.hasOwnedOrg().then(function(resFlag){$scope.ableToCreateOrg=!resFlag}):($scope.ableToCreateOrg=!1,$q.when(null))},$scope.toggleP2P=function(){$scope.showP2P=!$scope.showP2P,$scope.showP2P&&($scope.unread=!1),$rootScope.$broadcast("startP2P")},$scope.forwardGlobalStar=function(){tracker.event("lab_global_star","click"),launcher.clearGroupAndOrg(),explorer.openGlobalStars()},$scope.forwardMyTask=function(){launcher.clearGroupAndOrg(),explorer.openMyTask()},$scope.myTasks=function(){dialogService.open($scope,{src:"pagelet/task/myTasksDialog.html"})},selectTrail(),visiblityListener()}}),define("util/locationData",[],function(){"use strict";return[{name:"北京",cities:["通州","房山","昌平","顺义","怀柔","大兴","密云","平谷","延庆","东城","崇文","西城","朝阳","宣武","石景山","丰台","门头沟","海淀"]},{name:"上海",cities:["普陀","闸北","虹口","杨浦","卢湾","徐汇","长宁","静安","黄浦","金山","浦东新","嘉定","闵行","宝山","南汇","青浦","松江","奉贤","崇明"]},{name:"天津",cities:["武清","河东","和平","西青","津南","大港","东丽","塘沽","汉沽","河北","红桥","河西","南开","蓟县","宁河","静海","宝坻","北辰"]},{name:"重庆",cities:["开县","江北","沙坪坝","九龙坡","南岸","北碚","万盛","双桥","渝北","巴南","黔江","垫江","武隆","巫山","巫溪","云阳","奉节","忠县","梁平","璧山","荣昌","大足","铜梁","潼南","綦江","长寿","彭水","酉阳","合川","江津","南川","永川","丰都","城口","大渡口","渝中","涪陵","万州","石柱","秀山"]},{name:"浙江",cities:["丽水","舟山","宁波","衢州","温州","杭州","台州","嘉兴","绍兴","金华","湖州"]},{name:"广东",cities:["珠海","惠州","清远","韶关","江门","揭阳","云浮","佛山","广州","深圳","河源","汕头","汕尾","茂名","肇庆","东莞","湛江","潮州","阳江","中山","梅州"]},{name:"江苏",cities:["连云港","盐城","无锡","宿迁","扬州","镇江","南京","徐州","泰州","南通","常州","淮安","苏州"]},{name:"山东",cities:["淄博","烟台","日照","荷泽","潍坊","济南","济宁","青岛","临沂","威海","莱芜","泰安","东营","聊城","枣庄","滨州","德州"]},{name:"福建",cities:["南平","厦门","福州","宁德","龙岩","莆田","漳州","泉州","三明"]},{name:"安徽",cities:["淮南","黄山","蚌埠","合肥","宿州","六安","池州","芜湖","宣城","巢湖","亳州","阜阳","铜陵","淮北","滁州","马鞍山","安庆"]},{name:"四川",cities:["宜宾","巴中","南充","成都","凉山彝族","眉山","阿坝","乐山","绵阳","广安","广元","德阳","资阳","达州","泸州","自贡","遂宁","甘孜藏族","雅安","内江","攀枝花"]},{name:"湖北",cities:["咸宁","宜昌","黄冈","荆州","孝感","荆门","十堰","鄂州","天门","潜江","恩施","武汉","仙桃","神农架","随州","黄石","襄樊"]},{name:"河北",cities:["张家口","邯郸","邢台","衡水","秦皇岛","廊坊","保定","承德","唐山","沧州","石家庄"]},{name:"云南",cities:["德宏","玉溪","曲靖","保山","怒江","迪庆","昭通","昆明","楚雄","文山","西双版纳","丽江","红河","大理","临沧","思茅"]},{name:"黑龙江",cities:["鹤岗","大兴安岭地","大庆","七台河","齐齐哈尔","牡丹江","黑河","双鸭山","绥化","伊春","佳木斯","哈尔滨","鸡西"]},{name:"吉林",cities:["松原","四平","白城","白山","吉林","通化","长春","延边朝鲜族","辽源"]},{name:"辽宁",cities:["铁岭","葫芦岛","营口","本溪","辽阳","盘锦","阜新","朝阳","锦州","抚顺","丹东","沈阳","鞍山","大连"]},{name:"海南",cities:["保亭","澄迈","南沙群岛","陵水黎族","中沙群岛","屯昌","昌江黎族","乐东黎族","琼海","儋州","文昌","万宁","白沙黎族","海口","三亚","五指山","琼中","东方","定安","西沙群岛","临高"]},{name:"湖南",cities:["郴州","岳阳","怀化","娄底","张家界","益阳","湘西土家族苗族","常德","湘潭","永州","衡阳","株洲","长沙","邵阳"]},{name:"河南",cities:["南阳","洛阳","三门峡","商丘","焦作","开封","驻马店","濮阳","许昌","安阳","信阳","漯河","平顶山","郑州","新乡","鹤壁","周口"]},{name:"贵州",cities:["毕节地","黔南","六盘水","黔东南","贵阳","遵义","铜仁地","黔西南","安顺"]},{name:"江西",cities:["南昌","萍乡","景德镇","吉安","九江","新余","鹰潭","抚州","赣州","上饶","宜春"]},{name:"广西",cities:["贺州","梧州","河池","百色","来宾","贵港","玉林","钦州","北海","柳州","桂林","南宁","防城港","崇左"]},{name:"陕西",cities:["咸阳","铜川","商洛","榆林","渭南","汉中","安康","延安","宝鸡","西安"]},{name:"山西",cities:["临汾","晋中","朔州","运城","晋城","阳泉","忻州","大同","长治","太原","吕梁"]},{name:"青海",cities:["黄南","海东地","果洛","西宁","海北","玉树","海南","海西"]},{name:"宁夏",cities:["石嘴山","固原","中卫","银川","吴忠"]},{name:"甘肃",cities:["兰州","金昌","甘南藏族","平凉","嘉峪关","天水","白银","武威","张掖","庆阳","定西","临夏回族","酒泉","陇南"]},{name:"西藏",cities:["阿里地","拉萨","山南地","日喀则地","那曲地","昌都地","林芝地"]},{name:"内蒙古",cities:["巴彦淖尔","锡林郭勒盟","兴安盟","乌兰察布","鄂尔多斯","乌海","包头","呼和浩特","呼伦贝尔","通辽","阿拉善盟","赤峰"]},{name:"新疆",cities:["伊犁","克拉玛依","哈密地","石河子","吐鲁番地","阿拉尔","阿勒泰地","乌鲁木齐","塔城地","昌吉","克孜勒","图木舒克","阿克苏地","五家渠","巴音郭楞","和田地","博尔塔拉","喀什地"]},{name:"台湾",cities:["新竹","基隆","高雄","台北","台南","嘉义","台中","宜兰","屏东","桃园","台东","苗栗","金门","花莲","云林","连江","澎湖","南投","彰化"]},{name:"香港",cities:["油尖旺","黄大仙","深水埗","观塘","九龙城","湾仔","葵青","离岛","中西","南","东","荃湾","元朗","沙田","西贡","屯门","大埔","北"]},{name:"澳门",cities:["花地玛堂","圣安多尼堂","大堂","望德堂","风顺堂","嘉模堂","圣方济各堂"]},{name:"国外",cities:["德国","新加坡","美国","加拿大","澳大利亚","日本","英国","巴西","俄罗斯","尼日利亚","马来西亚","爱尔兰","奥地利","挪威","意大利","西班牙","泰国","芬兰","丹麦","荷兰","阿联酋","瑞典","瑞士","比利时","新西兰","法国","韩国","匈牙利","其他","越南","以色列","科威特","希腊","南非","葡萄牙","墨西哥","印尼"]}]}),define("pagelet/sidebar/userInfo/userInfoDialogCtrl",["underscore","jquery","util/locationData"],function(_,$,locationData){"use strict";return function($rootScope,$scope,$location,$timeout,userService,groupService,dialogs,aliasService,uploader,launcher,applicants,orgService,ROLES){var locations,$dialog=$scope.$dialog;$dialog.title="个人信息",$dialog.width=400,$scope.isMyself=!1,$scope.errorShow=!1,$scope.locationData=locationData,$scope.$watch("userInfo.name",function(name){$scope.isMyself&&$dialog.buttons&&($dialog.buttons[0].disabled=name?!1:!0)});var formatLocation=function(location){var i,j;if(locations=location.split(" "),2===locations.length)for(i=0;i<locationData.length;i++)if(locationData[i].name===locations[0])for(locationData.selected=locationData[i],j=0;j<locationData.selected.cities.length;j++)if(locationData.selected.cities[j]===locations[1]){locationData.selected.cities.selected=locationData.selected.cities[j];break}locationData.selected&&locationData.selected.cities.selected||(locationData.selected=locationData[0],locationData.selected.cities.selected=locationData.selected.cities[0])},getLargePhoto=function(src){return src.replace(/normal/i,"large")},getUserInfo=function(data){$scope.userInfo=data,$scope.userInfo.phone=data.phone||"暂无",$scope.image={src:getLargePhoto($scope.userInfo.photo),name:$scope.userInfo.name},$scope.aliasName="",data.properties&&data.properties.aliasName?($scope.aliasName=data.properties.aliasName,aliasService.updateAliasList([].concat(data))):aliasService.aliasList[$scope.userId]&&($scope.aliasName=aliasService.aliasList[$scope.userId].name),$dialog.buttons&&$dialog.buttons[0].handler===visitWithAlias&&($dialog.buttons[0].disabled=!1)},getMyInfo=function(){$scope.userInfo={},_.extend($scope.userInfo,$scope.getUser()),$scope.userInfo.phone=$scope.userInfo.phone||"暂无",$scope.image={src:getLargePhoto($scope.userInfo.photo),name:$scope.userInfo.name},formatLocation($scope.userInfo.location)},cancel=function(){$dialog.dismiss()},dataError=function(data){data&&"10004"===data.error||dialogs.alert("错误","服务器错误")},nameError=function(){dialogs.alert("提示","昵称或备注仅支持中英文、数字和下划线")},confirm=function(){var params={nickname:$scope.userInfo.name,description:$scope.userInfo.description,ss_location:locationData.selected.name+" "+locationData.selected.cities.selected,sex:$scope.userInfo.sex};userService.updateUserInfo(params,function(data){_.extend($scope.getUser(),data),$dialog.dismiss()},function(data){data&&"10003"===data.error?$scope.errorShow=!0:data&&"10008"===data.error&&nameError()})},visitMember=function(){$dialog.buttons[0].disabled=!0,$scope.orgId()&&!$scope.gid()?orgService.addMember($scope.userId,$scope.orgId(),ROLES.ORG_USER).then(function(member){userService.getUserInfo(member.userId).then(function(json){member=_.extend(member,json),$rootScope.$broadcast("org.member.add",member,launcher.orgId()),$dialog.dismiss()}),$dialog.buttons=[{text:"已添加",cls:"btn primary",disabled:!0,handler:null}]},function(e){if(e.error)switch(e.error){case"51009":dialogs.alert("提示","组织人数已满，请联系我们升级您的套餐，您可以发送问题到客服邮箱youdaogroup@service.netease.com。");break;case"51011":dialogs.alert("提示","该用户已属于其他组织，无法再加入您的组织。");break;case"51012":dialogs.alert("提示","抱歉，企业版已过期，暂时无法添加。购买请联系youdaogroup@service.netease.com。");break;default:dialogs.alert("邀请成员","输入账号不存在")}}):applicants.inviteApplicant($scope.gid(),$scope.userId,null).then(function(json){$dialog.buttons=[{text:"已添加，等待对方确认",cls:"btn primary",disabled:!0,handler:null}],$timeout(function(){$dialog.buttons=[{text:"添加",cls:"btn primary",disabled:!1,handler:visitWithAlias}]},5e3),$scope.$emit("userInfo.visit.success",json.confirmer)},function(e){e&&"10026"===e.error?dialogs.alert("邀请成员","该群已经满员。购买企业版，支持更多成员、更大空间以及更多特权！"):dialogs.alert("邀请成员","邀请失败，请稍后重试")})},updateAliasName=function(){$scope.aliasName.length>0?aliasService.updateAliasName($scope.userId,$scope.aliasName,function(){$dialog.dismiss()},nameError):aliasService.deleteAliasName($scope.userId,function(){$dialog.dismiss()})},visitWithAlias=function(){$scope.aliasName.length>0?aliasService.updateAliasName($scope.userId,$scope.aliasName,visitMember,nameError):aliasService.deleteAliasName($scope.userId,visitMember)};$scope.userId===launcher.getUser().userId?($scope.isMyself=!0,$dialog.buttons=[{text:"保存",cls:"btn primary",handler:confirm},{text:"取消",cls:"btn cancel",handler:cancel}]):$scope.isVisit?($dialog.buttonAlign="center",$dialog.buttons=$scope.added?[{text:"已添加",cls:"btn gray disabled"}]:[{text:"添加",cls:"btn primary",handler:visitWithAlias,disabled:!0}]):($scope.isMyself=!1,$scope.fromNotify?($dialog.width=400,$dialog.height=260):($dialog.width=400,$dialog.buttons=[{text:"保存",cls:"btn primary",handler:updateAliasName},{text:"取消",cls:"btn cancel",handler:cancel}])),$scope.onImageSelect=function(tasks){var task=tasks[0];dialogs.open({cls:"show-icon-dialog",src:"pagelet/sidebar/showIcon/showIcon-dialog.html",task:task}).then(function(coords){userService.updateUserInfo(coords,function(data){$scope.getUser().photo=data.photo},function(){dialogs.alert("服务器错误","获取数据失败")})})},$scope.logout=function(){launcher.logout()},$scope.newP2PDialog=function(user){$dialog.dismiss(),$rootScope.$broadcast("p2p.chat",user)},$scope.$watch("locationData.selected",function(state,oldState){state!==oldState&&oldState&&locationData.selected&&locationData.selected.cities&&locationData.selected.cities.length>0&&(locationData.selected.cities.selected=locationData.selected.cities[0])}),$scope.$watch("getUser().photo",function(src){$scope.userInfo&&$scope.userInfo.name&&($scope.image={src:getLargePhoto(src),name:$scope.userInfo.name})}),launcher.getUser().userId!==$scope.userId?userService.getUserInfo($scope.userId).then(function(res){getUserInfo(res)}).catch(function(e){dataError(e)}):getMyInfo()}}),define("pagelet/sidebar/notify/notifyListCtrl",["underscore","util/tracker"],function(_,tracker){"use strict";return function(router,$scope,dialogs,groupService,$filter,explorer,$location,launcher,applicants,NOTIFICATION_TYPE,ROLES){function forwardComment(groupId,fileId,fileName,srcId){$dialog.dismiss(),launcher.forwardOrJoin(groupId).then(function(){_.isUndefined(fileId)||_.isUndefined(srcId)||explorer.openFile(Number(fileId),null,{commentId:srcId})})}var curMessage,groupInfo,$dialog=$scope.$dialog,scrollEnd=!1,loading=!1,lastId=-1,lastTime=-1;$dialog.title="通知",$dialog.width=500,$dialog.height=450,$scope.noNotification=!1,$scope.pageLoading=!0,$scope.NOTIFICATION_TYPE=NOTIFICATION_TYPE,$scope.ROLES=ROLES,$scope.hasOrg=launcher.getOrgs().length>1;var getApplicantData=function(messages){$scope.pageLoading=!1,$scope.messages=messages,messages.length?(applicants.getLastNotificationTime()<messages[0].time&&(applicants.setLastNotificationTime(messages[0].time),applicants.cancelNotice(applicants.CANCEL_NOTIFICATION,applicants.getLastNotificationTime())),lastId=messages[messages.length-1].id,lastTime=messages[messages.length-1].time,messages.length<6&&scrollLoad()):$scope.noNotification=!0},getPersonalData=function(messages){$scope.pageLoading=!1,$scope.myMessages=messages,messages.length?(applicants.getLastMessageTime()<messages[0].time&&(applicants.setLastMessageTime(messages[0].time),applicants.cancelNotice(applicants.CANCEL_MESSAGE,applicants.getLastMessageTime())),lastId=messages[messages.length-1].id,lastTime=messages[messages.length-1].time):$scope.noNotification=!0},getTasksNotificationData=function(messages){$scope.pageLoading=!1,$scope.taskMessages=messages,messages.length?(lastId=messages[messages.length-1].id,lastTime=messages[messages.length-1].time):$scope.noNotification=!0},serverError=function(json){json.error&&"10000"===json.error?dialogs.alert("通知","该群已经被解散"):json.error&&"10026"===json.error?(groupInfo=_.findWhere($scope.getGroups(),{id:curMessage.groupId}),groupInfo&&groupInfo.isVip?dialogs.alert("通知","该群已经满员，无法加入新成员。"):groupInfo&&groupInfo.owner===$scope.uid()?(tracker.event("exceed","exceed-member-show"),dialogs.alertBySrc("通知","pagelet/sidebar/notify/exceed-memberQuota.html",{height:"auto"})):dialogs.alert("通知","该群已经满员。购买企业版，支持更多成员、更大空间以及更多特权！")):json.error&&"41000"===json.error?dialogs.alert("通知","该用户已被禁止加入"):json.error&&"41003"===json.error?dialogs.alert("通知","其他成员已接受"):json.error&&"41004"===json.error?dialogs.alert("通知","其他成员已拒绝"):json.error&&"30001"===json.error?dialogs.alert("通知","你已不在该群"):json.error&&"41008"===json.error?dialogs.alert("通知","该邀请已失效"):dialogs.alert("通知","服务器错误")},scrollLoad=function(type){function success(messages){$scope.pageLoading=!1,loading=!1,console.log(type),messages.length?(type===!0?$scope.myMessages=_.union($scope.myMessages,messages):"tasks"===type?$scope.taskMessages=_.union($scope.taskMessages,messages):$scope.messages=_.union($scope.messages,messages),lastId=messages[messages.length-1].id,lastTime=messages[messages.length-1].time):scrollEnd=!0}function error(){$scope.pageLoading=!1,loading=!1}scrollEnd||(loading=!0,$scope.pageLoading=!0,"tasks"==type?applicants.getTaskMsg(lastTime,5).then(success,error):applicants.getApplicants(lastTime,lastId,5,type).then(success,error))};$scope.formatTime=function(time){var date=new Date(time),nowDate=new Date;return date.getFullYear()<nowDate.getFullYear()?$filter("date")(time,"yyyy-MM-dd HH:mm"):$filter("date")(time,"MM-dd HH:mm")},$scope.checkShowMessage=function(userId,type){return userId!==$scope.uid()&&(type===NOTIFICATION_TYPE.APPLY||type===NOTIFICATION_TYPE.CONFIRM||type===NOTIFICATION_TYPE.REJECT||type===NOTIFICATION_TYPE.ADD||type===NOTIFICATION_TYPE.APPLY_FAILURE||type===NOTIFICATION_TYPE.APPLY_USER_EXIST||type===NOTIFICATION_TYPE.NERVER_ALLOW)||userId===$scope.uid()&&(type===NOTIFICATION_TYPE.REJECT||type===NOTIFICATION_TYPE.NERVER_ALLOW)?!0:!1},$scope.acceptApplicant=function(message){message.disabled=!0,curMessage=message,applicants.acceptApplicant(message.groupId,message.id).then(function(json){message.type=json.type?json.type:NOTIFICATION_TYPE.CONFIRM,$scope.$emit("applicant.accept.success")},serverError)},$scope.rejectApplicant=function(message,never){message.disabled=!0,curMessage=message,applicants.rejectApplicant(message.groupId,message.id,never).then(function(json){message.type=json.type?json.type:NOTIFICATION_TYPE.REJECT,$scope.$emit("applicant.reject.success")},serverError)},$scope.confirmInvite=function(message){message.disabled=!0,curMessage=message,applicants.confirmApplicant(message.groupId,message.id).then(function(json){message.type=json.type?json.type:NOTIFICATION_TYPE.ACCEPT_INVITE,$scope.$emit("applicant.confirm.invit")},serverError)},$scope.ignoreInvite=function(message){message.disabled=!0,curMessage=message,applicants.ignoreApplicant(message.groupId,message.id).then(function(json){message.type=json.type?json.type:NOTIFICATION_TYPE.IGNORE_INVIT,$scope.$emit("applicant.ignore.invit")},serverError)},$scope.isInGroup=function(groupId){var found=!1;return _.each(launcher.getGroups(),function(group){group.id===groupId&&(found=!0)}),found},$scope.onScroll=function(bottom,personal){bottom>80||scrollEnd||loading||scrollLoad(personal)},$scope.openFile=function(groupId,fileId){launcher.forwardOrJoin(groupId).then(function(){explorer.openFile(fileId)}),$dialog.dismiss()},$scope.forward=function(groupId,srcId){$dialog.dismiss(),launcher.forwardOrJoin(groupId).then(function(){srcId&&($location.search("chathistory",""),$location.search("chathistory",srcId))})},$scope.forwardAction=function(message){11===message.type?$scope.forward(message.groupId,message.atSrcId):12===message.type?forwardComment(message.groupId,message.fileId,message.fileName,message.atSrcId):13===message.type&&(message.commentId&&-1!==message.commentId?forwardComment(message.groupId,message.fileId,message.fileName,message.commentId):$scope.openFile(message.groupId,message.fileId))},$scope.forwardTask=function(message){$dialog.dismiss(),router.forward("/"+message.groupId+"/tasks/task-"+message.taskId)},$scope.$watch("segment",function(){scrollEnd=!1,loading=!1,$scope.noNotification=!1,$scope.pageLoading=!0,$scope.messages=[],$scope.myMessages=[],"notification"===$scope.segment?($scope.notificationNum=0,$scope.$emit("notification.number.empty"),applicants.getApplicants(null,null,6,!1).then(getApplicantData,serverError)):"tasksNotification"===$scope.segment?($scope.tasksNotificationNum=0,$scope.$emit("tasksNotification.number.empty"),applicants.getTaskMsg(null,6).then(getTasksNotificationData,serverError)):($scope.messageNum=0,$scope.$emit("mymessage.number.empty"),applicants.getApplicants(null,null,6,!0).then(getPersonalData,serverError))})}}),define("pagelet/sidebar/createGroup/createGroupCtrl",["util/tracker","underscore"],function(tracker,_){"use strict";return function($scope,$rootScope,groupService,dialogs,$location,launcher,router,explorer){function init(){var orgs=launcher.getOrgs(),currentOrg=launcher.getOrg();$scope.orgs=orgs,$scope.orgs.selected=_.clone(currentOrg?currentOrg:orgs[orgs.length-1])}var $dialog=$scope.$dialog;$dialog.width=400,$scope.step1=!0,$scope.step2=!1,$scope.acl=1,$scope.$watch("groupName",function(groupName){$dialog.buttons[0].disabled=groupName?!1:!0}),init();var cancel=function(){$dialog.dismiss()},gotoSetting=function(){explorer.clearState(),router.forward("/"+$scope.groupId+"/setting/members"),$dialog.dismiss()},inviteStep=function(){$scope.step1=!1,$scope.step2=!0,$dialog.width=360,$scope.description=$scope.description||"暂无",$dialog.buttons=[{text:"现在邀请成员",cls:"btn btn-invite",handler:gotoSetting}]},confirm=function(){return $scope.groupName?($dialog.buttons[0].disabled=!0,void groupService.createGroup($scope.groupName,$scope.orgs.selected.id?$scope.orgs.selected.id:void 0,$scope.description,$scope.acl,function(json){$dialog.buttons[0].disabled=!1,$scope.groupId=json.id,inviteStep()},function(json){if($dialog.buttons[0].disabled=!1,json.error)switch(json.error){case"10008":dialogs.alert("创建群","群名或群简介包含特殊字符，请修改后重新保存");break;case"10025":tracker.event("exceed","exceed-group-show"),dialogs.alertBySrc("提示","pagelet/sidebar/createGroup/exceed-groupQuota.html",{height:"auto"});break;case"51010":dialogs.alert("提示","组织空间已满，请联系youdaogroup@service.netease.com升级您的套餐。");break;case"51012":dialogs.alert("提示","抱歉，企业版已过期，无法添加内部群。购买请联系youdaogroup@service.netease.com。")}else dialogs.alert("创建群","创建失败，请稍后重试")})):void window.alert("请输入群名")};$dialog.title="新建群",$dialog.buttons=[{text:"确定",cls:"btn btn-confirm",handler:confirm},{text:"取消",cls:"btn btn-cancel cancel",handler:cancel}]}}),define("pagelet/sidebar/createOrganization/createOrganizationCtrl",["jquery","jcrop"],function($){"use strict";return function($scope,$rootScope,groupService,dialogs,$location,launcher,router,organizations,ORG_EVENTS){var $dialog=$scope.$dialog,xsize=66,ysize=66,previewXSize=120,previewYSize=120;$dialog.width=410,$scope.step1=!0,$scope.step2=!1,$scope.acl=1,$scope.orgIcon="style/images/491c4c20.org_icon_default.png",$scope.photo=function(){return $scope.orgIcon},$scope.$watch("orgName",function(orgName){$dialog.buttons[0].disabled=orgName?!1:!0}),$scope.uploadIcon=function(tasks){var task=tasks[0];dialogs.open($scope,{cls:"show-icon-dialog",src:"pagelet/orgSetting/setting/org-icon-upload.html",task:task}).then(function(coords){var $pimg=$(".show-icon .preview .preview-img"),rx=xsize/previewXSize,ry=ysize/previewYSize,w=$pimg.width(),h=$pimg.height(),tempMarginLeft=parseInt($pimg.css("margin-left").replace("px","")),tempMarginTop=parseInt($pimg.css("margin-top").replace("px","")),width=Math.round(rx*w)+"px",height=Math.round(ry*h)+"px",marginLeft=Math.round(rx*tempMarginLeft)+"px",marginTop=Math.round(ry*tempMarginTop)+"px";$scope.orgIcon="/yws/api/image/"+coords.photo+"?method=getTempUpload",$scope.coords=coords,$scope.resizeIcon={width:width,height:height,"margin-left":marginLeft,"margin-top":marginTop}})};var cancel=function(){$dialog.dismiss()},gotoSetting=function(){router.forward("/org/"+$scope.orgId+"/members"),$dialog.dismiss()},inviteStep=function(){$scope.step1=!1,$scope.step2=!0,$dialog.width=360,$scope.description=$scope.description||"暂无",$dialog.buttons=[{text:"现在邀请成员",cls:"btn btn-invite",handler:gotoSetting}]},confirm=function(){return $scope.orgName?($dialog.buttons[0].disabled=!0,void organizations.createOrg($scope.orgName,$scope.orgDesc,$scope.coords).then(function(org){$dialog.buttons[0].disabled=!1,$scope.orgId=org.id,inviteStep(),$rootScope.$broadcast(ORG_EVENTS.CREATE,org)},function(){$dialog.buttons[0].disabled=!1,dialogs.alert("提示","抱歉，创建组织时遇到了一些问题，请稍后再试。")})):void window.alert("请输入组织名")};$dialog.title="新建组织",$dialog.buttons=[{text:"确定",cls:"btn btn-confirm",handler:confirm},{text:"取消",cls:"btn btn-cancel cancel",handler:cancel}]}}),define("pagelet/sidebar/joinGroup/joinGroupCtrl",[],function(){"use strict";return function($scope,$rootScope,$location,groupService,dialogs,launcher){function openGroup(){launcher.forward($scope.group.id)}function onAlreadyMember(){dialogs.alert("加入群","您已经加入群“"+$scope.group.name+"”。",{ok:"查看"}).then(openGroup),$dialog.dismiss()}function onNotMember(){$scope.group.acl&&3===$scope.group.acl?dialogs.alert("加入群","该群“"+$scope.group.name+"”不允许任何人加入。"):dialogs.open({title:"加入群",group:$scope.group,cls:"join-group",src:"pagelet/sidebar/joinGroup/joinConfirm-dialog.html"}),$dialog.dismiss()}function onGetGroup(group){$scope.group=group,groupService.getMyRole($scope.groupId).then(onAlreadyMember).catch(onNotMember)}function onGroupNotFound(){$scope.notFound=!0}function confirm(){groupService.getGroup($scope.groupId,onGetGroup,onGroupNotFound)}var $dialog=$scope.$dialog;$dialog.title="加入",$dialog.width=300,$dialog.height=160,$scope.notFound=!1,$scope.$watch("groupId",function(groupId){$dialog.btnDisabled=groupId?!1:!0
}),$scope.confirm=confirm}}),define("pagelet/sidebar/joinGroup/joinConfirmCtrl",["underscore"],function(){"use strict";return function($scope,$rootScope,$location,groupService,dialogs){function joinGroup(){groupService.joinGroup($scope.group.id,$scope.applyMessage,function(){$dialog.dismiss()},function(json){json.error&&"10026"===json.error?dialogs.alert("加入群","该群已经满员。如需添加更多成员，请联系群主升级到企业版。"):json.error&&"51002"===json.error?dialogs.alert("加入群",$scope.group.name+" 群是 "+json.orgName+" 组织中的内部群。您不是该组织中的成员，目前无法加入该群。请联系该组织管理员处理。"):json.error&&"41000"===json.error?dialogs.alert("加入群","您被禁止加入该群，请联系管理员更改群设置或通过账号邀请您加入。"):dialogs.alert("加入群","无法加入该群！")}),$dialog.dismiss()}var $dialog=$scope.$dialog;$scope.applyMessage="",1===$scope.group.acl?($dialog.width=340,$dialog.buttons=[{text:"加入",cls:"btn btn-join primary",handler:joinGroup}]):2===$scope.group.acl?($dialog.width=340,$dialog.buttons=[{text:"发送",cls:"btn btn-join primary",handler:joinGroup}]):(dialogs.alert("加入群","该群“"+$scope.group.name+"”不允许任何人加入。"),$dialog.dismiss())}}),define("pagelet/sidebar/shakeIntervalDirective",["underscore","jquery","jcrop"],function(){"use strict";return function(){function link(scope,el){var id1=0;scope.$watch(function(){return scope.notificationUnread||scope.myMessageUnread||scope.taskNotificationUnread},function(res){function shakeIt(){el.addClass("shake"),setTimeout(function(){el.removeClass("shake")},1e4)}clearInterval(id1),res?(shakeIt(),id1=setInterval(function(){shakeIt()},6e4)):el.removeClass("shake")})}return{restrict:"A",link:link}}}),define("pagelet/sidebar/funnyDragDirective",["underscore","jquery"],function(_,$){"use strict";return function(){function link(scope,el){function shake(){el.addClass("shake")}function removeShake(){el.removeClass("shake")}function startWatching(e){function stopWatching(){removeShake(),el.unbind("mousemove",watchMove).unbind("mouseup",stopWatching)}function startDrag(e){function releaseDragEvents(e){el.css(initialPosition),(Math.abs(e.clientX-fromX)>40||Math.abs(e.clientY-fromY)>40)&&(scope.resetPosition=!0,scope.clearUnread(scope.unreads[scope.group.id],scope.group.id)),$(window).unbind("mousemove",moveProxy)}function captureDragEvents(){$(window).bind("mousemove",moveProxy).one("mouseup",releaseDragEvents)}function moveProxy(e){el.offset({top:e.clientY-5,left:e.clientX-5})}var initialPosition={position:el.css("position"),right:el.css("right"),top:el.css("top"),left:el.css("left")};captureDragEvents(),el.css("position","fixed"),el.css("z-index","99"),el.css("right","auto"),moveProxy(e)}function watchMove(e){stopWatching(e),startDrag(e)}fromX=e.clientX,fromY=e.clientY,scope.resetPosition=!1,el.bind("mousemove",watchMove).bind("mouseup",stopWatching)}function onMouseDown(e){e.preventDefault(),startWatching(e)}var fromX,fromY;el.bind("mousedown",onMouseDown).bind("mouseover",shake).bind("mouseleave",removeShake)}return{restrict:"A",link:link}}}),define("pagelet/sidebar/userInfo/userInfoDirective",["underscore","jquery"],function(){"use strict";return function(dialogService){function link(scope,el,attr){el.bind("click",function(){var params;params={},params.src="pagelet/sidebar/userInfo/userInfo-dialog.html",attr.userId&&(params.userId=attr.userId),attr.invitee&&(params.isVisit="true"===attr.invitee?!0:!1),attr.isVisit&&(params.isVisit="true"===attr.isVisit?!0:!1),attr.fromNotify&&(params.fromNotify="true"===attr.fromNotify?!0:!1),attr.added&&(params.added="true"===attr.added?!0:!1),params.cls=attr.cls?attr.cls:"user-info",attr.orgId&&(params.orgId=attr.orgId),params.added||scope.$apply(function(){dialogService.open(scope,params)})})}return{restrict:"A",link:link}}}),define("pagelet/sidebar/sidebarOrgGroupsCtrl",[],function(){"use strict";return function($scope){var toggleOrgGroups=function(){$scope.showOrgGroups=!$scope.showOrgGroups};$scope.showOrgGroups=!0,$scope.toggleOrgGroups=toggleOrgGroups}}),define("pagelet/sidebar/orgTutorial/orgTutorialDirective",[],function(){return function(){var link=function(scope,element){element.find("#tutorial-close").click(function(){element.hide()})};return{restrict:"A",link:link,templateUrl:"pagelet/sidebar/orgTutorial/org-tutorial.html"}}}),define("sidebarModule",["angular","commonModule","pagelet/sidebar/sidebarCtrl","pagelet/sidebar/userInfo/userInfoDialogCtrl","pagelet/sidebar/notify/notifyListCtrl","pagelet/sidebar/createGroup/createGroupCtrl","pagelet/sidebar/createOrganization/createOrganizationCtrl","pagelet/sidebar/joinGroup/joinGroupCtrl","pagelet/sidebar/joinGroup/joinConfirmCtrl","pagelet/sidebar/shakeIntervalDirective","pagelet/sidebar/funnyDragDirective","pagelet/sidebar/userInfo/userInfoDirective","pagelet/sidebar/sidebarOrgGroupsCtrl","pagelet/sidebar/orgTutorial/orgTutorialDirective"],function(angular,commonModule,sidebarCtrl,userInfoDialogCtrl,notifyListCtrl,createGroupCtrl,createOrganizationCtrl,joinGroupCtrl,joinConfirmCtrl,shakeIntervalDirective,funnyDragDirective,userInfoDirective,sidebarOrgGroupsCtrl,orgTutorialDirective){"use strict";return angular.module("sidebarModule",[commonModule.name]).controller("sidebarCtrl",["$rootScope","$scope","$location","launcher","groupService","userService","dialogService","aliasService","clientProxy","settings","$timeout","storageManager","groupTopService","applicantService","router","organizationService","labService","$q","ORG_EVENTS","NOTIFICATION_TYPE","pomeloService","titleService","explorer","dialogService",sidebarCtrl]).controller("userInfoDialogCtrl",["$rootScope","$scope","$location","$timeout","userService","groupService","dialogService","aliasService","uploader","launcher","applicantService","organizationService","ROLES",userInfoDialogCtrl]).controller("notifyListCtrl",["router","$scope","dialogService","groupService","$filter","explorer","$location","launcher","applicantService","NOTIFICATION_TYPE","ROLES",notifyListCtrl]).controller("createGroupCtrl",["$scope","$rootScope","groupService","dialogService","$location","launcher","router","explorer",createGroupCtrl]).controller("createOrganizationCtrl",["$scope","$rootScope","groupService","dialogService","$location","launcher","router","organizationService","ORG_EVENTS",createOrganizationCtrl]).controller("joinGroupCtrl",["$scope","$rootScope","$location","groupService","dialogService","launcher",joinGroupCtrl]).controller("joinConfirmCtrl",["$scope","$rootScope","$location","groupService","dialogService",joinConfirmCtrl]).controller("sidebarOrgGroupsCtrl",["$scope","$rootScope","groupService","dialogService","$location","launcher","viewport",sidebarOrgGroupsCtrl]).directive("shakeInterval",shakeIntervalDirective).directive("funnyDrag",funnyDragDirective).directive("userInfo",["dialogService",userInfoDirective]).directive("orgTutorial",[orgTutorialDirective])}),define("util/fileComparator",[],function(){"use strict";var Comparator={type:function(f1,f2){return f1.isFolder&&!f2.isFolder?-1:!f1.isFolder&&f2.isFolder?1:0},nameAsc:function(f1,f2){var type=Comparator.type(f1,f2);return 0!==type?type:f1.name.toLowerCase().localeCompare(f2.name.toLowerCase())},nameDesc:function(f1,f2){var type=Comparator.type(f1,f2);return 0!==type?type:-f1.name.toLowerCase().localeCompare(f2.name.toLowerCase())},sizeAsc:function(f1,f2){var res,type=Comparator.type(f1,f2);return 0!==type?type:(res=(f1.size||0)-(f2.size||0),0!==res?res:Comparator.nameAsc(f1,f2))},sizeDesc:function(f1,f2){var res,type=Comparator.type(f1,f2);return 0!==type?type:(res=(f2.size||0)-(f1.size||0),0!==res?res:Comparator.nameDesc(f1,f2))},timeAsc:function(f1,f2){var type=Comparator.type(f1,f2),t1=f1.lastModifiedDate.getTime(),t2=f2.lastModifiedDate.getTime();return 0!==type?type:t1!==t2?t1-t2:Comparator.nameAsc(f1,f2)},timeDesc:function(f1,f2){var type=Comparator.type(f1,f2),t1=f1.lastModifiedDate.getTime(),t2=f2.lastModifiedDate.getTime();return 0!==type?type:t2!==t1?t2-t1:Comparator.nameDesc(f1,f2)},modifierAsc:function(f1,f2){var type=comparators.type(f1,f2);if(0!==type)return type;var res=f1.modifier.name.toLowerCase().localeCompare(f2.modifier.name.toLowerCase());return 0!==res?res:comparators.nameAsc(f1,f2)},modifierDesc:function(f1,f2){var type=comparators.type(f1,f2);if(0!==type)return type;var res=-f1.modifier.name.toLowerCase().localeCompare(f2.modifier.name.toLowerCase());return 0!==res?res:comparators.nameAsc(f1,f2)}};return Comparator}),define("pagelet/file/explorer",["underscore","util/fileComparator"],function(_){"use strict";var FILE_TYPE="ext.file.type",FILE_TOOLS="ext.file.tools",FILE_CONTEXT_MENU="ext.file.contextmenu",LIST_SRC="pagelet/file/list/list.html",DEFAULT_DETAIL_SRC="pagelet/file/detail/default.html",GLOBAL_STAR_SRC="pagelet/file/list/globalStar/globalStar.html";return function($rootScope,$location,$q,fileMgr,downloadService,groupService,chatService,dialogs,extension,launcher,viewport,messageAdapter,executor,client,permission,filePermission,shareService,SHARE_EVENTS,router){function initailize(){viewport.extendView(function(register){register("folder",LIST_SRC,!0)}),viewport.extendView(function(register){register("detail",DEFAULT_DETAIL_SRC)}),viewport.extendView(function(register){register("globalStar",GLOBAL_STAR_SRC)}),loadPlugins(),baseRouter=launcher.getGroupRouter(),baseRouter.bind(routeRootFolder),baseRouter.bind("/folder/{folderId}",routeFolder),baseRouter.bind("/file/{fileId}",routeFile),baseRouter.bind("/detail/{fileId}",routeDefaultOpener),baseRouter.bind("/search/{search}",routeSearch),baseRouter.bind("/trash",routeTrash),baseRouter.bind("/stars",routeStars),router.bind("/globalStars",routeGlobalStars)}function loadPlugins(){extension(FILE_TYPE,function(name,regexp,domain,options){var fileType=new FileType(name,regexp,domain,options);return fileTypes.push(fileType),fileType}),extension(FILE_TOOLS,function(tool){tools.push(tool)}),extension(FILE_CONTEXT_MENU,function(filter){contextMenuFilter.push(filter)})}function routeRootFolder(params){return viewport.open("folder",_.extend({path:"/"},params)).then(function(){state.push("/")})}function routeFolder(params){return $rootScope.$broadcast("folderId.change",params.folderId),viewport.open("folder",params).then(function(){state.push("/folder/"+params.folderId)})}function routeFile(params){return viewport.open("folder",params).then(function(){state.push("/file/"+params.fileId)})}function routeDefaultOpener(params){return viewport.open("detail",params)}function routeSearch(params){return viewport.open("folder",params).then(function(){/^\/search/.test(state[state.length-1])?(state.pop(),state.push("/search/"+params.search)):state.push("/search/"+params.search)})}function routeTrash(params){return params.trash=!0,viewport.open("folder",params)}function routeStars(params){return params.stars=!0,viewport.open("folder",params)}function routeGlobalStars(params){return viewport.open("globalStar",params)}function MenuOption(files){var list=[];this.append=function(name,label,handler,otherOpt){this.insertAfter(null,name,label,handler,otherOpt)},this.insertAfter=function(after,name,label,handler,otherOpt){var option,index=0;index=after?_.indexOf(list,_.findWhere(list,{name:after}))+1:list.length,option="-"!==name?otherOpt?{name:name,label:label,handler:handler,type:otherOpt.type,copyValue:otherOpt.copyValue}:{name:name,label:label,handler:handler}:{type:3},list.splice(index,0,option)},this.get=function(pos){return _.isNumber(pos)?list[pos]:_.findWhere(list,{name:pos})},this.remove=function(pos){var item;if(_.isNumber(pos))list.splice(pos,1);else if(_.isString(pos)){if(item=_.findWhere(list,{name:pos}),!item)return;list.splice(list.indexOf(item))}},this.files=function(){return files},this.items=function(){return list}}function getGid(){return launcher.gid()}function canOpen(fileOrId,name){return ableTo(fileOrId,name,"open")}function canTrace(fileOrId,name){return ableTo(fileOrId,name,"trace")}function canPreview(fileOrId,name){return ableTo(fileOrId,name,"preview",!0)}function canEdit(fileOrId,name){return filePermission.check("file.edit",fileOrId)?ableTo(fileOrId,name,"edit",!0):!1}function canShare(fileOrId,name){return filePermission.check("file.share",fileOrId)?ableTo(fileOrId,name,"share"):void 0}function canUpload(fileOrId,name){return ableTo(fileOrId,name,"upload")}function canDownload(fileOrId,name){return _.isArray(fileOrId)?0==fileOrId.length?!1:fileOrId.length>1&&client.isPC()&&!client.isPC("3.9.5")?!1:_.every(fileOrId,function(file){return file.parentId===fileOrId[0].parentId&&canDownload(file)}):fileOrId.isFolder?!0:ableTo(fileOrId,name,"download")}function canPrint(fileOrId,name){return ableTo(fileOrId,name,"print",!0)}function getRouterPrefix(fileOrId,name){var routerPrefix,domain=1;return _.isObject(fileOrId)&&(name=fileOrId.name,domain=fileOrId.domain),routerPrefix=getFeature(name,domain,"routerPrefix"),routerPrefix?routerPrefix:"detail"}function hint(message,theme,undo){$rootScope.$broadcast("ynote.toast",message,theme,undo)}function ableTo(fileOrId,name,feature,provide){var domain=1;return _.isObject(fileOrId)&&(name=fileOrId.name,domain=fileOrId.domain),provide?_.isFunction(getFeature(name,domain,feature)):getFeature(name,domain,feature)!==!1}function openFile(fileOrId,version,opt){(function(){return _.isObject(fileOrId)?(opt=version,$q.when(fileOrId)):(_.isObject(version)&&(opt=version,version=null),fileMgr.getFile(launcher.gid(),fileOrId,version))})().then(function(file){var opener=getFeature(file.name,file.domain,"open");_.isFunction(opener)||(opener=openFileByDefault),opener(file.id,file.version,opt)},function(e){e&&"260"===e.error?dialogs.alert("打开文件","无法查看该文件，仅群管理员或群主可见"):dialogs.alert("打开文件","文件不存在或已被删除")})}function locateFile(fileId){baseRouter.forward("/file/"+fileId)}function openRootFolder(){baseRouter.forward("/")}function openFolder(folderId){baseRouter.forward("/folder/"+folderId)}function search(kw){baseRouter.forward("/search/"+kw)}function openTrash(){baseRouter.forward("/trash")}function openStars(){baseRouter.forward("/stars")}function openGlobalStars(){router.forward("/globalStars")}function openMyTask(){router.forward("/tasks")}function restore(step){if(_.isNumber(step))for(;step>1;)state.pop(),step--;baseRouter.forward(state.pop()||"/",{},{restore:!0})}function clearState(){state=["/"]}function openRevision(file,version){var trace=getFeature(file.name,file.domain,"trace");return _.isFunction(trace)?void trace(file,version):void dialogs.open({file:file,version:version,gid:launcher.gid(),src:"pagelet/file/revision/revision.html"})}function openFileByDefault(id,version,opt){baseRouter.forward("/detail/"+id,opt)}function getTools(){return tools}function getContextMenuFilter(){return contextMenuFilter}function getCreatable(){return _.filter(fileTypes,function(fileType){return _.isFunction(fileType.create)})}function upload(file){return file?override(file):client.isPC()?void client.uploadFile(gid,folder.id,launcher.getGroup().MAX_UPLOAD_SIZE):void dialogs.open({src:"pagelet/file/upload/upload-dialog.html",url:"/yws/api/group/"+gid+"/file?method=uploadFileData",gid:gid,folder:folder})}function override(file){return client.isPC()?void client.updateFile(gid,file.id,file.name,launcher.getGroup().MAX_UPLOAD_SIZE):void dialogs.open({src:"pagelet/file/upload/upload-dialog.html",url:"/yws/api/group/"+gid+"/file?method=uploadFileData",file:file,gid:gid})}function publish(file){chatService.sendFile(launcher.gid(),file.id)}function edit(file){var editor=getFeature(file.name,file.domain,"edit");_.isFunction(editor)&&editor(file)}function download(files){fileMgr.download(launcher.gid(),files)}function preview(file){var previewer=getFeature(file.name,file.domain,"preview");_.isFunction(preview)&&previewer(file)}function print(file){function outer(ele){return $($("<div></div>").html(ele.clone())).html()}var config=getFeature(file.name,file.domain,"print")();if(null!==config){var iframe=$("<iframe />"),newWin=null,div=$(config.divToPrint);iframe.appendTo("body"),newWin=iframe[0].contentWindow,newWin.document.write(outer(div)),newWin.document.close(),_.defaults(config.css,{position:"absolute",width:"100%",height:"95%"}),$(newWin.document.body).css(config.css);var waitForEle=$("[src]",newWin.document);waitForEle.length?(waitForEle=_.map(waitForEle,function(ele){var defer=$q.defer();return ele.onload=function(){defer.resolve()},ele.onerror=function(){defer.reject()},defer.promise}),$q.all(waitForEle).then(function(){newWin.print()}).finally(function(){iframe.remove()})):(newWin.print(),iframe.remove())}}function FileType(name,regexp,domain,options){_.extend(this,{name:name},options),this.match=function(fileName,fileDomain){return fileDomain===domain&&regexp.test(fileName)}}function getFeature(name,domain,featureName){var feature=null;return _.each(fileTypes,function(fileType){feature||fileType.match(name,domain)&&fileType.hasOwnProperty(featureName)&&(feature=fileType[featureName])}),feature}function shareFile(file){var deferred=$q.defer();return shareService.startShare(launcher.gid(),file.id).then(function(shareFile){shareFile?($rootScope.$broadcast(SHARE_EVENTS.SHARE,{file:file,shareEntry:shareFile}),openShareDialog(shareFile),deferred.resolve()):(dialogs.alert("分享链接","生成分享链接失败，请稍后重试"),deferred.reject())}),deferred.promise}function unShareFile(file){var deferred=$q.defer();return shareService.stopShare(launcher.gid(),file.id).then(function(){$rootScope.$broadcast(SHARE_EVENTS.UNSHARE,file),deferred.resolve()},function(){dialogs.alert("分享链接","暂时无法取消该文件的分享，请稍后重试"),deferred.reject()}),deferred.promise}function openShareDialog(shareFile){dialogs.open({title:"分享链接",src:"pagelet/file/share/share-dialog.html",width:500,height:165,cls:"share-dialog-wrap",message:shareFile.link})}var baseRouter,tools=[],contextMenuFilter=[],fileTypes=[],state=["/"];this.gid=getGid,this.getTools=getTools,this.getContextMenuFilter=getContextMenuFilter,this.getCreatable=getCreatable,this.publish=publish,this.getFeature=getFeature,this.openFile=openFile,this.openFolder=openFolder,this.search=search,this.locateFile=locateFile,this.canOpen=canOpen,this.openRevision=openRevision,this.ableToTrace=canTrace,this.preview=preview,this.ableToPreview=canPreview,this.ableToEdit=canEdit,this.ableToShare=canShare,this.upload=upload,this.ableToUpload=canUpload,this.edit=edit,this.download=download,this.restore=restore,this.ableToDownload=canDownload,this.ableToPrint=canPrint,this.print=print,this.getRouterPrefix=getRouterPrefix,this.MenuOption=MenuOption,this.openTrash=openTrash,this.openStars=openStars,this.openRootFolder=openRootFolder,this.openGlobalStars=openGlobalStars,this.openMyTask=openMyTask,this.clearState=clearState,this.extendType=extension.declare(FILE_TYPE),this.extendTools=extension.declare(FILE_TOOLS),this.extendContextMenu=extension.declare(FILE_CONTEXT_MENU),this.shareFile=shareFile,this.unShareFile=unShareFile,this.openShareDialog=openShareDialog,this.hint=hint,launcher.wait().then(initailize)}}),define("pagelet/file/msg/adapter",["underscore"],function(_){"use strict";return function($rootScope,launcher,templates,fileMgr,filePermission,MESSAGE_TYPE){templates.extendTemplate(function(data){return data.type===MESSAGE_TYPE.FILE||data.type===MESSAGE_TYPE.BATCHUPLOAD?(data.templateUrl="pagelet/file/msg/message.html",data.tipUrl="pagelet/file/msg/message-tip.html",!1):data.type===MESSAGE_TYPE.COMMENT?(data.templateUrl="pagelet/file/comment/msg/message.html",!1):void 0}),_.each({create:[4,1],update:[4,2],remove:[4,3],move:[4,4],"import":[4,5],upload:[4,6],recover:[4,8],favorite:[4,10],cancelFavorite:[4,11]},function(conf,key){$rootScope.$on("socket.event."+conf[0],function($evt,msg){var op=msg.operation;if(op==conf[1]&&msg.groupId==launcher.gid()){msg.opTime&&(msg.value.opTime=msg.opTime);var file=new fileMgr.File(msg.groupId,msg.value);(filePermission.canView(file)||"update"===key)&&$rootScope.$broadcast("file."+key,file)}})}),_.each({share:[4,12],unshare:[4,13]},function(conf,key){$rootScope.$on("socket.event."+conf[0],function($evt,msg){var op=msg.operation;op==conf[1]&&$rootScope.$broadcast("file."+key,new fileMgr.File(msg.groupId,msg.value),{token:msg.shareToken,shareTime:msg.shareTime},msg.sharer)})}),_.each({"comment-create":[8,1],"comment-remove":[8,3]},function(conf,key){$rootScope.$on("socket.event."+conf[0],function($evt,msg){var op=msg.operation;op==conf[1]&&$rootScope.$broadcast("file."+key,msg.value)})})}}),define("pagelet/file/list/listCtrl",["underscore","util/trackTiming","util/keycode"],function(_,trackTiming,KEYCODE){"use strict";return function($rootScope,$scope,$timeout,$q,$filter,explorer,fileMgr,dialogs,executor,launcher,viewport,comparator,client,selectFiles,selectFolder,router,storageMgr,DOCUMENT_TITLE,permission,filePermission,menuService,starService,shareService,ROLES,SHARE_EVENTS,FILE_LIST_MODE,LOCAL_STORAGE_KEY){function onOpen(opt){return onInvoke(opt,!0).then(bindAll)}function onInvoke(opt,force){function forwardByArguments(){function locateError(e){e&&"20101"===e.error?(dialogs.alert("打开文件夹","文件不存在或已被删除"),launcher.forward(gid)):e&&"260"===e.error?(dialogs.alert("打开文件夹","无法查看该文件夹，仅群管理员或群主可见"),launcher.forward(gid)):e&&($scope.files=[],$scope.stack=[],dialogs.alert("打开文件夹","加载错误，请稍候重试"))}return _.isUndefined(search)?($scope.search=null,showShare=!0,trash?(showShare=!1,$scope.trashSelected=!0,$scope.listMode=FILE_LIST_MODE.trash,$scope.enableTools=!1,$scope.$broadcast("files.trash",gid),$q.when(!1)):star?($scope.listMode=FILE_LIST_MODE.star,$scope.enableTools=!1,$scope.starsSelected=!0,listStars(),$scope.$broadcast("files.star",gid),$q.when(!1)):(listInitializedGid=gid,$scope.listMode=FILE_LIST_MODE.list,_.isNaN(fileId)?_.isString(path)?forward(path,force).catch(function(e){locateError(e)}):_.isNaN(folderId)?forwardToRoot():forward(folderId,force).catch(function(e){locateError(e)}):fileMgr.getFile(gid,fileId).then(function(file){return forward(file.parentId,force)}).then(function(){$timeout(function(){$scope.$broadcast("file.locate",fileId)})}).catch(function(e){$scope.trashSelected=!1,$scope.starsSelected=!1,locateError(e)}),$q.when())):($scope.listMode=FILE_LIST_MODE.search,$scope.search=search,$scope.$broadcast("files.search",search),$q.when(!1))}if(opt.restore===!0&&listInitializedGid===opt.gid)return $scope.folder||explorer.openRootFolder(),$scope.listMode=FILE_LIST_MODE.list,opt.search?$scope.search=opt.search:($scope.search=null,$rootScope.$broadcast("search.clear")),$timeout(function(){trackTiming.closeTable.end().send().clear(),trackTiming.closeOffice.end().send().clear(),trackTiming.closeNote.end().send().clear()}),$q.when();var folderId=Number(opt.folderId),path=opt.path,fileId=Number(opt.fileId),search=opt.search,trash=opt.trash,star=opt.stars;return gid=opt.gid,forwardByArguments().then(function(res){$scope.fullScreen,res!==!1&&$rootScope.$broadcast("search.clear")}).catch(function(e){return e&&dialogs.alert("打开文件夹",e),$q.reject(e)}).finally(function(){$rootScope.fileTreeLoading=!1,$scope.fileTreeLoading=!1,$scope.$parent.$parent.loading=!1})}function onKeyDown(evt){-1===["TEXTAREA","INPUT"].indexOf(evt.target.tagName)&&((evt.ctrlKey||evt.metaKey)&&evt.keyCode===KEYCODE.A&&(evt.preventDefault(),$rootScope.$broadcast("list.selectAll")),(evt.keyCode===KEYCODE.DELETE||(client.isMacBrowser()||client.isMac())&&evt.keyCode===KEYCODE.BACKSPACE)&&"visible"!==$(".widget-dialog").css("visibility")&&(evt.preventDefault(),$rootScope.$broadcast("list.deleteSelection")))}function updateEnableTool(folder){var roles=launcher.getCurrentRole();$scope.enableTools=-1!==roles.indexOf(ROLES.GROUP_READER)?!1:-1===roles.indexOf(ROLES.GROUP_FOUNDER)&&-1===roles.indexOf(ROLES.GROUP_MANAGER)?!folder.isOnlyManagerEdit:!0,$scope.listMode&&$scope.listMode!=FILE_LIST_MODE.list&&($scope.enableTools=!1)}function bindAll(){_.each(watchers,function(unwatch){unwatch()}),watchers=[$scope.$on("dropenter",onDropEnter),$scope.$on("drop",onDrop),$scope.$on("file.create",function($evt,file){onFileCreate(file)}),$scope.$on("file.update",function($evt,file){onFileUpdate(file)}),$scope.$on("file.remove",function($evt,file){onFileRemove(file)}),$scope.$on("file.move",function($evt,file){onFileMove(file)}),$scope.$on("file.import",function($evt,file){onFileImport(file)}),$scope.$on("file.upload",function($evt,file){onFileCreate(file)}),$scope.$on("file.recover",function($evt,file){onFileRecover(file)}),$scope.$on("file.favorite",function($evt,file){onFavorite(file)}),$scope.$on("file.cancelFavorite",function($evt,file){onCancelFavorite(file)}),$scope.$on("file.share",function($evt,file,shareEntry,sharer){onFileShare(file,shareEntry,sharer)}),$scope.$on("file.unshare",function($evt,file){onFileUnshare(file)}),$scope.$watchCollection(function(){return $scope.files},resort)],$(window).on("keydown",onKeyDown)}function onClose(){$scope.listMode=null,$(window).off("keydown",onKeyDown)}function openFolder(forderOrId){var fileId=_.isObject(forderOrId)?forderOrId.id:forderOrId,label="groupId-"+launcher.gid()+":fileId-"+fileId;trackTiming.upFolder.setLabel(label).start(),explorer.openFolder(fileId)}function forwardToRoot(){return forward("/")}function forward(pathOrId,force){function dispatch(){return _.isNaN(id)?_.isString(pathOrId)?forwardByPath(pathOrId):_.isObject(pathOrId)?forwardByFolder(pathOrId):$q.reject():(folder=_.findWhere($scope.files,{id:String(id)}),folder?forward(folder):forwardByFolderId(id))}function forwardByFolderId(folderId){return!force&&$scope.folder&&$scope.folder.id===folderId&&$scope.$broadcast("file.list.open.current",folderId),fileMgr.getFilePath(gid,folderId).then(forward)}function forwardByPath(path){return fileMgr.getFileByPath(gid,path,!0).then(function(toFolder){return folder=toFolder,stack=composeStack(folder),updateEnableTool(folder),loadFiles(folder,stack)})}function forwardByFolder(folder){var index=$scope.stack.indexOf(folder);return stack=index>=0?$scope.stack.slice(0,index+1):[].concat($scope.stack,folder),updateEnableTool(folder),loadFiles(folder,stack)}function loadFiles(folder,stack){var path=_.reduce(stack,function(path,folder,index){return 0===index?path:1===index?"/"+folder.name:path+"/"+folder.name},"/");return null!==listFileTimeoutDeferred&&(listFileTimeoutDeferred.promise.status=499,listFileTimeoutDeferred.resolve()),listFileTimeoutDeferred=$q.defer(),fileMgr.listFiles(gid,path,null,listFileTimeoutDeferred).then(function(files){$scope.stack=stack,$scope.folder=folder,$scope.files=files,permission.check("file.viewShare")&&shareService.listShareFiles(gid).then(function(shareFiles){_.forEach(shareFiles,function(shareFile){var file=_.findWhere($scope.files,{id:shareFile.id});_.isUndefined(file)||(file.shareEntry=shareFile)})}),starService.listStars(gid).then(function(starFiles){_.each(starFiles,function(starFile){var file=_.findWhere($scope.files,{id:String(starFile.id)});_.isUndefined(file)||(file.favorite=!0)})},function(){explorer.hint("获取加星状态失败","error")}),$timeout(function(){trackTiming.changeGroupLoadFiles.end().send().clear(),trackTiming.downFolder.end().send().clear(),trackTiming.upFolder.end().send().clear(),trackTiming.closeTable.end().send().clear(),trackTiming.closeOffice.end().send().clear(),trackTiming.closeNote.end().send().clear()})})}function composeStack(folder){for(var newStack=[];folder;)newStack.unshift(folder),folder=folder.parent;return newStack}var stack,folder,id=Number(pathOrId);return $scope.loading=!0,dispatch().finally(function(){$timeout(function(){$scope.loading=!1})})}function createFolder(){$scope.$broadcast("file.newFolder",$scope.folder)}function onDropEnter(evt){client.isPC()&&(evt.effect="copy")}function onDrop(evt){var scope=evt.targetScope;client.isPC()&&(scope.file&&scope.file.isFolder?client.dropFile($scope.gid(),$scope.file.id,launcher.getGroup().MAX_UPLOAD_SIZE):client.dropFile($scope.gid(),$scope.folder.id,launcher.getGroup().MAX_UPLOAD_SIZE))}function openRevision(file){explorer.openRevision(file)}function uploadFile(){var MULTIPLE=!0;selectFiles.open(MULTIPLE,"file").then(uploadDirectly)}function uploadFolder(){client.isPC()?client.uploadFolder($scope.gid(),$scope.folder.id,launcher.getGroup().MAX_UPLOAD_SIZE):selectFolder.open($scope.folder)}function uploadDirectly(tasks,folder,isFolder,noMsg,uploadType){function hint(config){var hintMsg;switch(uploadType){case"mixed":hintMsg="";break;case"files":hintMsg="文件";break;case void 0:case"folder":hintMsg="文件夹"}explorer.hint("上传"+hintMsg+("success"===config?"成功":"失败"),config)}isFolder?dialogs.open({src:"pagelet/file/upload/upload-dialog.html",gid:$scope.gid(),folder:folder||$scope.folder,multiple:!0,tasks:tasks,hideAlert:!0,noMsg:noMsg}).then(function(){currentUpload[tasks[0].uploadId]-=tasks.length,0===currentUpload[tasks[0].uploadId]&&(delete currentUpload[tasks[0].uploadId],hint("success"))},function(e){currentUpload[tasks[0].uploadId]-=tasks.length,0===currentUpload[tasks[0].uploadId]&&delete currentUpload[tasks[0].uploadId],e&&hint("error")}):dialogs.open({src:"pagelet/file/upload/upload-dialog.html",gid:$scope.gid(),folder:folder||$scope.folder,multiple:!0,tasks:tasks}).then(function(){explorer.hint("上传文件成功","success")},function(e){e&&explorer.hint("上传文件失败","error")},function(file){onFileCreate(file)})}function backward(){var stack=$scope.stack;if(1!=stack.length){var label="groupId-"+$scope.gid()+":fileId-"+stack[stack.length-2].id;trackTiming.upFolder.setLabel(label).start(),explorer.openFolder(stack[stack.length-2].id)}}function moveFiles(files,folder){$scope.$broadcast("file.moveFiles",files,folder)}function getContextMenu(){function checkPermission(action,title,cb){filePermission.check("file."+action,$scope.folder)&&menuOption.append(action,title,cb)}var fileTypes=explorer.getCreatable(),menuOption=wrapMenuOption($scope.folder),filters=explorer.getContextMenuFilter();if($scope.folder)return _.each(fileTypes,function(fileType,index){checkPermission("create."+index,"新建"+fileType.name,function(){fileType.create($scope.folder)})}),checkPermission("create.folder","新建文件夹",function(){createFolder()}),menuOption.append("-"),checkPermission("upload.file","上传文件",uploadFile),client.isSafari()||client.isEdge()||checkPermission("upload.folder","上传文件夹",uploadFolder),menuOption.append("-"),_.each(filters,function(filter){filter([],menuOption,$scope.folder)}),menuOption.items()}function wrapMenuOption(folder){var option=new menuService.MenuOption([folder]),insertAfter=option.insertAfter;return option.insertAfter=function(after,name,label,handler){var wrap=function(){$q.when(handler(folder)).then(function(retValue){retValue&&explorer.hint(retValue,"success")}).catch(function(retValue){retValue&&explorer.hint(retValue,"error")})};return insertAfter.call(option,after,name,label,wrap)},option}function invokeTool(handler){$scope.enableTools&&$q.when(handler($scope.folder)).then(function(retValue){retValue&&explorer.hint(retValue,"success")}).catch(function(retValue){retValue&&explorer.hint(retValue,"error")})}function sortBy(type){comparator.type(type),resort()}function resort(){_.isNull($scope.files)||($scope.files.sort(comparator),$scope.$broadcast("file.list.resort"))}function onFileCreate(newFile){var relatedFile=getFileFromList(newFile.id);if(_.isNull($scope.folder)||newFile.parentId==$scope.folder.id)return null!=relatedFile?void _.extend(relatedFile,newFile):void $scope.files.push(newFile)}function onFileRecover(newFile){var tempStarFile,tempShareFile,relatedFile=getFileFromList(newFile.id);if(_.isNull($scope.folder)||newFile.parentId==$scope.folder.id)return null!=relatedFile?void _.extend(relatedFile,newFile):void starService.listStars(launcher.gid()).then(function(starFiles){tempStarFile=_.findWhere(starFiles,{id:String(newFile.id)}),tempShareFile=_.findWhere(shareService.getShareFilesIncludingRemoved(),{id:String(newFile.id)}),tempStarFile&&(newFile.favorite=!0,newFile.favoriteDate=tempStarFile.favoriteDate,$scope.starFiles.push(newFile),$scope.starFiles=orderStars($scope.starFiles)),tempShareFile&&(newFile.shareEntry=tempShareFile)}).finally(function(){$scope.files.push(newFile)})}function onFileImport(newFile){var relatedFile=getFileFromList(newFile.id),tempFavorite=!1;if(_.isNull($scope.folder)||newFile.parentId==$scope.folder.id)return null!=relatedFile?(tempFavorite=relatedFile.favorite,_.extend(relatedFile,newFile),void(relatedFile.favorite=tempFavorite)):void $scope.files.push(newFile)
}function onFavorite(file){var relatedFile=getFileFromList(file.id);if($scope.listMode===FILE_LIST_MODE.star&&file.gid===launcher.gid())null!=relatedFile?(relatedFile.favoriteDate=file.favoriteDate,_.findWhere($scope.starFiles,{id:String(file.id)})||$scope.starFiles.push(relatedFile)):(_.isUndefined(file.lastUpdater)&&(file.lastUpdater=file.modifier),_.findWhere($scope.starFiles,{id:String(file.id)})||$scope.starFiles.push(file)),$scope.starFiles=orderStars($scope.starFiles);else if(($scope.listMode===FILE_LIST_MODE.list||$scope.listMode===FILE_LIST_MODE.search)&&file.gid===launcher.gid()&&$scope.folder&&file.parentId===String($scope.folder.id)){if(_.isUndefined(relatedFile))return;relatedFile.favorite=!0}}function onCancelFavorite(file){var relatedFile=getFileFromList(file.id);if($scope.listMode===FILE_LIST_MODE.star&&file.gid===launcher.gid())$scope.starFiles=_.reject($scope.starFiles,function(fileToCancelFavorite){return fileToCancelFavorite.id==file.id});else if(($scope.listMode===FILE_LIST_MODE.list||$scope.listMode===FILE_LIST_MODE.search)&&file.gid===launcher.gid()&&$scope.folder&&file.parentId===String($scope.folder.id)){if(_.isUndefined(relatedFile)||_.isNull(relatedFile))return;relatedFile.favorite=!1}}function onFileShare(file,shareEntry,sharer){if(file.gid==launcher.gid()){var shareFile=new shareService.ShareFile({name:file.name,groupId:file.gid,fileId:file.id},shareEntry,sharer),relatedFile=getFileFromList(file.id),relatedStarFile=_.findWhere($scope.starFiles,{id:Number(file.id)});null!=relatedFile&&(relatedFile.shareEntry=shareFile),null!=relatedStarFile&&(relatedStarFile.shareEntry=shareFile)}}function onFileUnshare(file){file.gid==launcher.gid()&&$rootScope.$broadcast(SHARE_EVENTS.UNSHARE,file)}function onFileUpdate(newFile){function isFileAncestor(ancestorFile,file){var deferred=$q.defer();return $q.all([fileMgr.getFilePath(launcher.gid(),file.id),fileMgr.getFilePath(launcher.gid(),ancestorFile.id)]).then(function(res){deferred.resolve(0===res[0].indexOf(res[1]))}).catch(function(e){deferred.reject(e)}),deferred.promise}var tempStarFile,relatedFile=getFileFromList(newFile.id);null==relatedFile?(isFileAncestor(newFile,$scope.folder).then(function(res){if(res)if(filePermission.canView(newFile)){$scope.folder.isOnlyManagerEdit=newFile.isOnlyManagerEdit,$scope.folder.isOnlyManagerView=newFile.isOnlyManagerView,updateEnableTool($scope.folder);for(var i=0;i<$scope.files.length;i++)$scope.files[i].isOnlyManagerEdit=newFile.isOnlyManagerEdit,$scope.files[i].isOnlyManagerView=newFile.isOnlyManagerView}else dialogs.alert("提醒","该文件夹已被设置为隐藏文件夹，仅管理员可查看").then(function(){explorer.openRootFolder()})}),newFile.parentId===$scope.folder.id&&filePermission.canView(newFile)&&$scope.files.unshift(newFile)):(filePermission.canView(newFile)||($scope.files=_.reject($scope.files,function(file){return file.id==newFile.id})),starService.listStars(launcher.gid()).then(function(starFiles){tempStarFile=_.findWhere(starFiles,{id:parseInt(newFile.id)}),tempStarFile&&(newFile.favorite=!0,newFile.favoriteDate=tempStarFile.favoriteDate)}).finally(function(){_.extend(relatedFile,newFile),resort()}))}function onFileMove(newFile){var relatedFile=getFileFromList(newFile.id);null==relatedFile&&$scope.folder&&$scope.folder.id===newFile.parentId?$scope.files.push(newFile):null!=relatedFile&&$scope.folder&&newFile.parentId!==$scope.folder.id&&removeFromList(relatedFile)}function onFileRemove(removedFile){var relatedFile=getFileFromList(removedFile.id);null!=relatedFile?removeFromList(relatedFile):_.each($scope.stack,function(folder){folder.id==removedFile.id&&($scope.folder=null,$scope.listMode===FILE_LIST_MODE.list&&dialogs.alert("文件夹已被删除","文件夹 "+folder.name+" 已被删除").then(function(){launcher.getGroupRouter().forward("/")}))}),$scope.listMode===FILE_LIST_MODE.star&&($scope.starFiles=_.reject($scope.starFiles,function(starFile){return starFile.id==removedFile.id}))}function removeFromList(files){_.isArray(files)||(files=[files]),_.each(files,function(file){var related=getFileFromList(file.id);related&&$scope.files.splice(_.indexOf($scope.files,related),1)})}function getFileFromList(fileId){return _.findWhere($scope.files,{id:_.isString(fileId)?fileId:String(fileId)})}function toggleTreeStatus(){$scope.treeSelected=!$scope.treeSelected,storage.put(LOCAL_STORAGE_KEY.EXPLORER_TREE,$scope.treeSelected)}function forwardTrash(){explorer.openTrash()}function selectTrash(){$scope.trashSelected=!0,$scope.starsSelected=!1,$scope.$broadcast("filetree.folder.change")}function forwardStars(){explorer.openStars()}function selectStars(){$scope.trashSelected=!1,$scope.starsSelected=!0,$scope.$broadcast("filetree.folder.change")}function orderStars(starFiles){var favoriteFolders=[],favoriteFiles=[];return _.each(starFiles,function(starFile){starFile.isFolder?favoriteFolders.push(starFile):favoriteFiles.push(starFile)}),favoriteFolders=orderBy(favoriteFolders,"favoriteTime",!0),favoriteFiles=orderBy(favoriteFiles,"favoriteTime",!0),[].concat(favoriteFolders).concat(favoriteFiles)}function listStars(){$scope.starFiles=[],starService.listStars(launcher.gid()).then(function(starFiles){$scope.starFiles=orderStars(starFiles),permission.check("file.viewShare")&&shareService.listShareFiles(gid).then(function(shareFiles){_.forEach(shareFiles,function(shareFile){var file=_.findWhere($scope.starFiles,{fileId:parseInt(shareFile.id)});_.isUndefined(file)||(file.shareEntry=shareFile)})})},function(){explorer.hint("获取加星文件列表失败，请重试","error")})}function unshare(file){return explorer.unShareFile(file).then(function(){explorer.hint("已取消分享链接","success")},function(){explorer.hint("取消分享链接失败","error")})}function haveSharedFiles(){var sharedFiles=shareService.getSharedFiles();return showShare&&sharedFiles&&sharedFiles.length>0}function getSharedFiles(all){var sharedFiles=shareService.getSharedFiles();return sharedFiles=orderBy(sharedFiles,"-shareTime"),all?sharedFiles:sharedFiles&&sharedFiles.slice(0,MIN_NUM)}function fetchAll(e){$scope.getAll=!0,e.stopPropagation()}function stopPropagation(e){e.stopPropagation()}function openShared(sharedFile){sharedFile.isFolder?($scope.shareManagerVisible.show=!1,explorer.openFolder(Number(sharedFile.id))):explorer.openFile(Number(sharedFile.id))}var gid,watchers=[],storage=storageMgr.forUser(launcher.uid()),orderBy=$filter("orderBy"),showShare=!0,listInitializedGid=null,MIN_NUM=7,listFileTimeoutDeferred=null,currentUpload={};$scope.launcher=launcher,$scope.group=launcher.getGroup(),$scope.client=client,$scope.explorer=explorer,$scope.forward=openFolder,$scope.createFolder=createFolder,$scope.openRevision=openRevision,$scope.uploadDirectly=uploadDirectly,$scope.uploadFile=uploadFile,$scope.uploadFolder=uploadFolder,$scope.sortBy=sortBy,$scope.backward=backward,$scope.invokeTool=invokeTool,$scope.moveFiles=moveFiles,$scope.comparator=comparator,$scope.selection={},$scope.creating=null,$scope.createName="",$scope.posting=!1,$scope.loading=!1,$scope.files=null,$scope.folder=null,$scope.stack=[],$scope.getContextMenu=getContextMenu,$scope.toggleTreeStatus=toggleTreeStatus,$scope.shareManagerVisible={},$scope.showExpiredHint=launcher.getOrg()?launcher.getOrg().expireTime.getTime()<Date.now():!1,null==storage.get(LOCAL_STORAGE_KEY.EXPLORER_TREE)?($scope.treeSelected=!0,storage.put(LOCAL_STORAGE_KEY.EXPLORER_TREE,!0)):$scope.treeSelected=storage.get(LOCAL_STORAGE_KEY.EXPLORER_TREE),$scope.listMode=FILE_LIST_MODE.list,$scope.enableTools=!0,$scope.forwardTrash=forwardTrash,$scope.selectTrash=selectTrash,$scope.forwardStars=forwardStars,$scope.selectStars=selectStars,$scope.starFiles=[],$scope.unshare=unshare,$scope.getSharedFiles=getSharedFiles,$scope.fetchAll=fetchAll,$scope.haveSharedFiles=haveSharedFiles,$scope.stopPropagation=stopPropagation,$scope.openShared=openShared,$scope.$open(onOpen),$scope.$invoke(onInvoke),$scope.$close(onClose),$scope.$on("$destroy",function(){_.each(watchers,function(unwatch){unwatch()}),$(window).off("keydown",onKeyDown)}),$scope.$on("filetree.select",function(){$scope.trashSelected=!1,$scope.starsSelected=!1}),$scope.$on("group.changed",function(){$scope.files=[],$scope.loading=!0}),$scope.$on("org.changed",function(evt,newOrg,oldOrg){newOrg!=oldOrg&&($scope.showExpiredHint=newOrg?newOrg.expireTime.getTime()<Date.now():!1)}),$scope.$on("group.myRole.changed",function(evt,newRole){updateEnableTool($scope.folder),$scope.listMode!==FILE_LIST_MODE.trash||newRole!==ROLES.GROUP_READER&&newRole!==ROLES.GROUP_EDITOR||explorer.openRootFolder()}),$scope.$on("folder.drop.upload",function(evt,tasks,folder,noMsg,uploadType){uploadDirectly(tasks,folder,!0,noMsg,uploadType)}),$scope.$on("file.drop.upload",function(evt,length,uploadId){currentUpload[uploadId]||(currentUpload[uploadId]=0),currentUpload[uploadId]+=length}),$scope.$on("note.importDialog.open",function(){$(window).off("keydown",onKeyDown)}),$scope.$on("note.importDialog.close",function(){$(window).on("keydown",onKeyDown)}),$rootScope.$on(SHARE_EVENTS.SHARE,function(event,json){json.file.shareEntry=json.shareEntry}),$rootScope.$on(SHARE_EVENTS.UNSHARE,function(event,file){_.each($scope.files,function(value){value.id===file.id&&(value.shareEntry=null)}),_.each($scope.starFiles,function(value){value.id==file.id&&(value.shareEntry=null)})})}}),define("pagelet/file/list/trash/recycleCtrl",["underscore","jquery","util/keycode"],function(_,$,KEYCODE){"use strict";return function($scope,$q,$filter,launcher,trashService,dialogs,explorer,executor,permission,fileMgr,menuService,$element,$timeout,client){function wait(){var defer=$q.defer();return defer.promise.then(function(){delete $scope.waiting},function(){delete $scope.waiting},function(msg){$scope.waiting=msg}),defer}function get(fileId){return _.findWhere($scope.trashes,{id:fileId})}function remove(files){_.isArray(files)||(files=[files]),_.each(files,function(file){var related=get(file.id);related&&$scope.trashes.splice(_.indexOf($scope.trashes,related),1)})}function restoreFiles(gid,selectedFiles){function doFileRestore(){executor.execute("restore",[gid,selectedFiles]).then(success,error,progress)}function success(cmd){var finished=cmd.finished();explorer.hint("还原了"+finished.length+"个项目","success"),remove(finished),$scope.selection={},$scope.selectedFiles=[],waiting.resolve()}function error(cmd){var e=cmd.exception(),restoredFileId=_.isObject(cmd.file())?cmd.file().id:cmd.file();e&&"20108"===e.error?$scope.trashes=tempTrashes:e&&"10024"===e.error?($scope.trashes.push(tempFile),explorer.hint("还原失败，群空间不足","error")):e&&"20101"===e.error?$scope.trashes=_.reject($scope.trashes,function(trash){return trash.id===restoredFileId}):(explorer.hint("还原失败","error"),$scope.trashes=tempTrashes),waiting.reject()}function progress(cmd){var finished=cmd.finished(),files=cmd.files(),restoredFileId=_.isObject(cmd.file())?cmd.file().id:cmd.file();tempFile=_.findWhere($scope.trashes,{id:restoredFileId}),tempTrashes=$scope.trashes,$scope.trashes=_.reject($scope.trashes,function(trash){return trash.id===restoredFileId}),waiting.notify("正在还原第 "+(finished.length+1)+"/"+files.length+" 个文件...")}var tempFile,alertMsg="",alertTitle="",tempTrashes=[];if(_.isArray(selectedFiles)||(selectedFiles=[selectedFiles]),0!==selectedFiles.length){1===selectedFiles.length?(alertTitle="还原",alertMsg=selectedFiles[0].isFolder?"您确定要还原被选中的文件夹吗？":"您确定要还原被选中的文件吗？"):(alertTitle="还原多个文件/文件夹",alertMsg="您确定要还原被选中的文件/文件夹吗？");var waiting=wait();dialogs.confirm(alertTitle,alertMsg).then(doFileRestore)}}function deleteTrashes(gid,selectedFiles,all){function doTrashDelete(){executor.execute("deleteTrash",[gid,selectedFiles]).then(success,error,progress)}function success(cmd){var finished=cmd.finished();explorer.hint("清空了"+finished.length+"个项目","success"),remove(finished),$scope.selection={},$scope.selectedFiles=[],waiting.resolve()}function error(cmd){var e=cmd.exception();e&&explorer.hint("清空失败","error"),waiting.reject()}function progress(cmd){var finished=cmd.finished(),files=cmd.files(),deletedFileId=_.isObject(cmd.file())?cmd.file().id:cmd.file();$scope.trashes=_.reject($scope.trashes,function(trash){return trash.id===deletedFileId}),waiting.notify("正在清空第 "+(finished.length+1)+"/"+files.length+" 个文件...")}if(permission.check("file.restoreOrClearTrash")){var alertMsg="",alertTitle="";if(_.isArray(selectedFiles)||(selectedFiles=[selectedFiles]),0!==selectedFiles.length){1===selectedFiles.length?(alertTitle="清空",alertMsg=selectedFiles[0].isFolder?"您确定要彻底删除被选中的文件夹吗？":"您确定要彻底删除被选中的文件吗？"):(alertTitle="清空多个文件/文件夹",alertMsg="您确定要彻底删除被选中的文件/文件夹吗？"),all&&(alertTitle="清空",alertMsg="确认要清空回收站？清空后所有文件将不可恢复。");var waiting=wait();dialogs.confirm(alertTitle,alertMsg).then(doTrashDelete)}}}function orderTrashes(trashes){var trashFolders=[],trashFiles=[];return _.each(trashes,function(trash){trash.isFolder?trashFolders.push(trash):trashFiles.push(trash)}),trashFolders=orderBy(trashFolders,"lastUpdateTime",!0),trashFiles=orderBy(trashFiles,"lastUpdateTime",!0),[].concat(trashFolders).concat(trashFiles)}function listTrashes(gid){$scope.theme=null,$scope.selection={},$scope.selectedFiles=[],trashService.listTrashes(gid).then(function(trashes){$scope.trashes=orderTrashes(trashes),$scope.selection={}},function(){$scope.trashes=[]})}function wrapMenuOption(selection){var option=new menuService.MenuOption(selection),insertAfter=option.insertAfter;return option.insertAfter=function(after,name,label,handler){var wrap=function(file){$q.when(handler(file)).then(function(retValue){retValue&&explorer.hint(retValue,"success")}).catch(function(retValue){retValue&&explorer.hint(retValue,"error")})};return insertAfter.call(option,after,name,label,wrap)},option}function checkPermission(menuOption,action,title,cb){permission.check("file."+action)&&menuOption.append(action,title,cb)}function defaultMenuFilter(selection,menuOption){function remove(){deleteTrashes($scope.gid(),selection)}function restore(){restoreFiles($scope.gid(),selection)}checkPermission(menuOption,"restoreOrClearTrash","还原",restore),checkPermission(menuOption,"restoreOrClearTrash","彻底删除",remove)}function getTrashContextMenu(){var selection=getSelectedFiles(),menuOption=wrapMenuOption(selection),filters=[defaultMenuFilter];return 0===selection.length?menuOption.items():(_.each(filters,function(filter){filter(selection,menuOption)}),menuOption.items())}function selectAll(){_.each($scope.trashes,function(file){select(file)})}function deselectAll(){$scope.$apply(function(){$scope.selection={}})}function toggleSelectAll(){isAllSelected()?deselectAll():selectAll()}function select(file){$timeout(function(){$scope.selection[file.id]=!0})}function deselect(file){$scope.selection[file.id]&&($scope.selection[file.id]=!1)}function toggleSelect(file){$scope.selection[file.id]?deselect(file):select(file)}function isSelected(file){return $scope.selection[file.id]===!0}function getSelectedFiles(){return $scope.selectedFiles}function isAllSelected(){var all=!0,list=$scope.trashes;return 0==list.length?!1:(_.each(list,function(file){$scope.selection[file.id]||(all=!1)}),all)}function clearSelection(){$scope.selection={}}function processTrashChange(evt,content,file){var REMOVE_FILE=3,RESTORE_FILE=8,DELETE_FILE=9;file.gid=file.gid||file.groupId,file=new fileMgr.File(file.gid,file),content.operation===REMOVE_FILE&&file.gid==launcher.gid()?($scope.trashes.push(file),$scope.trashes=orderTrashes($scope.trashes)):content.operation!==RESTORE_FILE&&content.operation!==DELETE_FILE||file.gid!=launcher.gid()||($scope.trashes=_.reject($scope.trashes,function(trash){return trash.id===file.id}))}function onSelectAll(evt){"trash"===$scope.$parent.$parent.listMode&&-1===["TEXTAREA","INPUT"].indexOf(evt.target.tagName)&&(evt.ctrlKey||evt.metaKey)&&evt.keyCode===KEYCODE.A&&($scope.$apply("selectAll()"),evt.preventDefault())}function listenDel(evt){if("trash"===$scope.$parent.$parent.listMode&&(evt.keyCode===KEYCODE.DELETE||(client.isMacBrowser()||client.isMac())&&evt.keyCode===KEYCODE.BACKSPACE)&&"visible"!==$(".widget-dialog").css("visibility")){var files=$scope.getSelectedFiles();files&&files.length>0&&(deleteTrashes($scope.gid(),files),evt.preventDefault())}}var orderBy=$filter("orderBy");$scope.trashes=[],$scope.selection={},$scope.selectedFiles=[],$scope.canMove=!1,permission.check("file.viewRecycleBin")&&listTrashes($scope.gid()),$scope.restoreFiles=restoreFiles,$scope.deleteTrashes=deleteTrashes,$scope.getTrashContextMenu=getTrashContextMenu,$scope.select=select,$scope.deselect=deselect,$scope.toggleSelect=toggleSelect,$scope.selectAll=selectAll,$scope.deselectAll=deselectAll,$scope.toggleSelectAll=toggleSelectAll,$scope.isSelected=isSelected,$scope.isAllSelected=isAllSelected,$scope.clearSelection=clearSelection,$scope.getSelectedFiles=getSelectedFiles,$scope.$on("files.trash",function($evt,gid){listTrashes(gid)}),$scope.$watch("selection",function(selection){var i;$scope.selectedFiles=[];for(i in selection)selection.hasOwnProperty(i)&&selection[i]&&$scope.selectedFiles.push(i)},!0),$(window).keydown(listenDel),$(window).off("keydown",onSelectAll).on("keydown",onSelectAll),$scope.$on("$destroy",function(){$(window).unbind("keydown",listenDel),$(window).off("keydown",onSelectAll)}),$scope.$on("socket.event.4",processTrashChange)}}),define("pagelet/file/list/trash/trashService",["underscore","util/trackTiming"],function(_,trackTiming){return function($http,$q,fileMgr){function listTrashes(gid){var deferred=$q.defer();return trackTiming.listTrashes.start(),$http.get("/yws/api/group/"+gid+"/trash",{params:{method:"list"}}).success(function(trashes){trackTiming.listTrashes.end().setLabel("success").send().clear();var files=[];_.each(trashes,function(json){var file=new fileMgr.File(gid,json);files.push(file)}),deferred.resolve(files)}).error(function(e){trackTiming.listTrashes.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function restoreFile(gid,fileOrId,adviceName){var fileId,fileName,deferred=$q.defer();return _.isObject(fileOrId)?(fileId=fileOrId.id,fileName=fileOrId.name):(fileId=fileOrId,fileName=""),_.isUndefined(adviceName)||(fileName=adviceName),trackTiming.restoreFile.start(),$http.get("/yws/api/group/"+gid+"/trash/"+fileId,{params:{method:"recover",name:fileName}}).success(function(json){trackTiming.restoreFile.end().setLabel("success").send().clear(),deferred.resolve(new fileMgr.File(json,json))}).error(function(e){trackTiming.restoreFile.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function eraseTrash(gid,fileToDelete){var fileId,deferred=$q.defer();return fileId=_.isObject(fileToDelete)?fileToDelete.id:fileToDelete,trackTiming.eraseTrash.start(),$http.get("/yws/api/group/"+gid+"/trash/"+fileId,{params:{method:"eraseFile"}}).success(function(json){trackTiming.eraseTrash.end().setLabel("success").send().clear(),deferred.resolve(json)}).error(function(e){trackTiming.eraseTrash.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function eraseTrashes(gid){var deferred=$q.defer();return trackTiming.eraseTrashes.start(),$http.get("/yws/api/group/"+gid+"/trash",{params:{method:"erase"}}).success(function(json){trackTiming.eraseTrashes.end().setLabel("success").send().clear(),deferred.resolve(json)}).error(function(e){trackTiming.eraseTrashes.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}this.listTrashes=listTrashes,this.restoreFile=restoreFile,this.eraseTrash=eraseTrash,this.eraseTrashes=eraseTrashes}}),define("pagelet/file/list/stars/starService",["underscore","util/trackTiming"],function(_,trackTiming){function AdapterStarFile(json){return json.fileModel.favorite=!0,json.fileModel.isFolder=json.fileModel.dir,json.fileModel.id=String(json.fileModel.fileId),json.fileModel.lastModifiedDate=new Date(json.fileModel.lastUpdateTime),json.fileModel.createDate=new Date(json.fileModel.createTime),json.fileModel.favoriteTime=json.favoriteEntry.lastUpdateTime,json.fileModel.favoriteDate=new Date(json.fileModel.favoriteTime),json.fileModel.isOnlyManagerEdit=json.fileModel.properties.onlyManagerEdit,json.fileModel.isOnlyManagerView=json.fileModel.properties.onlyManagerView,json.fileModel}return function($http,$q,$rootScope,fileMgr,launcher){function listStars(gid){var deferred=$q.defer();if(gid===preGid)deferred.resolve(_.uniq(staredFilesCache));else{var i=Math.random();trackTiming.listStars.start(i),$http.get("/yws/api/group/"+gid+"/favorite",{params:{method:"list"}}).success(function(starFiles){trackTiming.listStars.end(i).setLabel("success").send().clear(i);var starResults=[];_.each(starFiles,function(file){starResults.push(AdapterStarFile(file))}),preGid=gid,staredFilesCache=starResults,staredFilesCacheIncludingRemoved=staredFilesCache,deferred.resolve(starResults)}).error(function(e){trackTiming.listStars.end(i).setLabel("error").send().clear(i),deferred.reject(e)})}return deferred.promise}function addFavorite(gid,fileOrId){var fileId,deferred=$q.defer();return fileId=_.isObject(fileOrId)?fileOrId.id:fileOrId,trackTiming.addFavorite.start(),$http.get("/yws/api/group/"+gid+"/favorite/"+fileId,{params:{method:"favorite"}}).success(function(json){trackTiming.addFavorite.end().setLabel("success").send().clear();var starFile=AdapterStarFile(json),relatedFile=_.findWhere(staredFilesCache,{id:String(starFile.id)});relatedFile||(staredFilesCache.push(starFile),staredFilesCacheIncludingRemoved=staredFilesCache),deferred.resolve(new fileMgr.File(json.fileModel.groupId,json))}).error(function(e){trackTiming.addFavorite.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}function cancelFavorite(gid,fileOrId){var fileId,deferred=$q.defer();return fileId=_.isObject(fileOrId)?fileOrId.id:fileOrId,trackTiming.cancelFavorite.start(),$http.get("/yws/api/group/"+gid+"/favorite/"+fileId,{params:{method:"cancel"}}).success(function(json){trackTiming.cancelFavorite.end().setLabel("success").send().clear(),staredFilesCache=_.reject(staredFilesCache,function(file){return file.id==fileId}),staredFilesCacheIncludingRemoved=staredFilesCache,deferred.resolve(json)}).error(function(e){trackTiming.cancelFavorite.end().setLabel("error").send().clear(),deferred.reject(e)}),deferred.promise}var staredFilesCache=[],staredFilesCacheIncludingRemoved=[],preGid=null;$rootScope.$on("file.remove",function($evt,file){file.gid==launcher.gid()&&(staredFilesCache=_.reject(staredFilesCache,function(starFile){return starFile.id==file.id}))}),$rootScope.$on("file.update",function($evt,file){if(file.gid==launcher.gid()){var relatedFile=_.findWhere(staredFilesCache,{id:String(file.id)});relatedFile&&(relatedFile.name=file.name)}}),$rootScope.$on("file.favorite",function($evt,file){if(file.gid==launcher.gid()){var relatedFile=_.findWhere(staredFilesCache,{id:String(file.id)});relatedFile||(file.favorite=!0,staredFilesCache.push(file),staredFilesCacheIncludingRemoved=staredFilesCache)}}),$rootScope.$on("file.cancelFavorite",function($evt,file){file.gid==launcher.gid()&&(staredFilesCache=_.reject(staredFilesCache,function(starFile){return starFile.id==file.id}),staredFilesCacheIncludingRemoved=staredFilesCache)}),$rootScope.$on("file.recover",function($evt,file){if(file.gid==launcher.gid()){var relatedFile=_.findWhere(staredFilesCacheIncludingRemoved,{id:String(file.id)});relatedFile&&(relatedFile.favorite=!0,staredFilesCache.push(relatedFile))}}),$rootScope.$on("file.changeReadOnly",function($evt,file){if(file.gid==launcher.gid()){var relatedFile=_.findWhere(staredFilesCache,{id:String(file.id)});relatedFile&&(relatedFile.isOnlyManagerEdit=file.isOnlyManagerEdit)}}),this.listStars=listStars,this.addFavorite=addFavorite,this.cancelFavorite=cancelFavorite}}),define("pagelet/file/list/stack",["jquery","underscore"],function($,_){"use strict";var TPL_VISIBLE='<li class="path-item"ng-class="{root:root}"ng-click="forward(file)"file-droppable="file" file-droppable-support="true">{{file.name}}</li><i class="path-break">&gt;</i>',TPL_MENU='<li class="trigger" widget-toggle="menuVisible"><svg class="path-folder"><use xlink:href="#stack_path_folder"/></svg><ul class="widget-menu" widget-toggle-content><li class="widget-menu-item" file-droppable="file"file-droppable-support="true"ng-repeat="file in invisibleItems"ng-click="forward(file)">{{file.name}}</li></ul></li>';return function($parse,$compile,dd){function link(scope,el,attr){function onStackChanged(newStack){stack=newStack,render()}function startMonitor(){function monitor(){var newWidth=el.width();0!==newWidth&&width!=newWidth&&(width=newWidth,render(),scope.$digest())}var width=el.width();monitorInterval=setInterval(monitor,200)}function render(){renderTimeout&&clearTimeout(renderTimeout),menuEl&&menuEl.scope()&&menuEl.scope().$destroy(),_.each(listElements,function(el){el.scope()&&el.scope().$destroy()}),listElements=[],_.each(stack,function(stackItem,index){var newEl,newScope=scope.$new();newScope.root=0==index,newScope.file=stackItem,newEl=$(TPL_VISIBLE),$compile(newEl)(newScope),listElements.push(newEl)}),scope.$$postDigest(renderElements)}function renderElements(){var ctWidth=el.width(),width=50,invisibleItems=[];return renderTimeout=null,el.empty().append(listElements).css("visibility","hidden"),listElements.reverse(),_.each(listElements,function(listEl,index){return width+=listEl.outerWidth(),0==index?void listEl.css("max-width",ctWidth-50+"px"):void(ctWidth>width||(invisibleItems.push(listEl.scope().file),listEl.scope().$destroy(),listEl.remove()))}),0==invisibleItems.length?void el.css("visibility","visible"):void renderMenu(invisibleItems)}function renderMenu(invisibleItems){var menuScope=scope.$new();menuEl=$(TPL_MENU).on("mouseover",onTriggerMouseOver),menuScope.invisibleItems=invisibleItems,$compile(menuEl)(menuScope),menuEl.prependTo(el),menuScope.$digest(),el.css("visibility","visible")}function onTriggerMouseOver(){function start(){menuScope.menuVisible=!0,menuScope.$digest(),menuEl.one("mouseleave mouseup",end)}function end(){menuScope.menuVisible=!1,menuScope.$digest()}var menuScope=menuEl.scope();dd.files()&&dd.files().length>0&&start()}var monitorInterval,menuEl,stack=[],listElements=[],renderTimeout=null;scope.$watchCollection(attr.fileStack,onStackChanged),scope.$on("$destroy",function(){menuEl&&menuEl.remove()}),setTimeout(startMonitor,0)}return{restrict:"A",link:link}}}),define("pagelet/file/list/editor",["jquery","underscore","util/keycode"],function($,_,KEYCODE){"use strict";return function($compile,$parse,$http,$templateCache,$q){function link(parentScope,el,attr){function matchEditor($evt,target){target==file&&($evt.editor={open:open,close:close,setValue:setValue,getValue:getValue})}function open(file){return deferred=$q.defer(),scope.editing=!0,$http.get(TPL_SRC,{cache:$templateCache}).success(function(response){ctEl=$(response),inputEl=ctEl.find("input").val(scope.value).on("blur",onBlur).on("mousedown click contextmenu",stopPropagation).on("keydown",onKeyDown),el.append(ctEl),$compile(ctEl)(scope),show(file)}).error(function(e){deferred.reject(e)}),deferred.promise}function show(file){var name,reg=/\.\w+$/;_.isString(file)?(name=file.replace(reg,""),extName=file.match(reg)):file.isFolder?(name=file.name,extName=""):(name=file?file.name.replace(reg,""):"",extName=file?file.name.match(reg):""),setValue(name),setTimeout(function(){inputEl.focus().select()},5),document.body.addEventListener("mousedown",captureBodyMousedown,!0)}function close(){return null!==ctEl?(ctEl.remove(),ctEl=null,scope.editing=!1,document.body.removeEventListener("mousedown",captureBodyMousedown,!0),scope):void 0}function setValue(value){return inputEl.val(value),scope}function getValue(){return inputEl.val()+(extName||"")}function finishEdit(){deferred.resolve(scope)}function cancelEdit(){deferred.reject(scope)}function captureBodyMousedown(e){e.target!=inputEl[0]&&onBlur()}function onBlur(){scope.$apply(finishEdit)}function onKeyDown(evt){switch(evt.keyCode){case KEYCODE.ESCAPE:evt.preventDefault(),evt.stopPropagation(),scope.$apply(cancelEdit);break;case KEYCODE.ENTER:evt.preventDefault(),evt.stopPropagation(),scope.$apply(finishEdit)}}function stopPropagation(evt){evt.stopPropagation()}var file,deferred,extName,TPL_SRC="pagelet/file/list/editor.html",scope=parentScope.$new(),ctEl=null,inputEl=null;file=$parse(attr.fileEditor)(scope),scope.$on("file.editor.match",matchEditor)}return{restrict:"A",link:link}}}),define("pagelet/file/list/noticeDirective",["underscore","jquery"],function(){"use strict";return function($filter,launcher,noticeService){function link(scope){function init(){scope.isNotice=!1,scope.isDetail=!1,scope.isMore=!1,scope.isManager=!1,scope.isEdit=!1,scope.isAdd=!1,scope.isAddNotice=!1,scope.noticeAbbrev="",scope.noticeContent="",getNotice()}function showMore(){scope.isMore=scope.isMore?!1:!0}function addNotice(){scope.isAddNotice=!0}function cancelAdd(){scope.isAddNotice=!1}function editNotice(){scope.isEdit=!0,scope.isMore=!1,preContent=scope.noticeContent,preAbbrev=scope.noticeAbbrev,scope.noticeContent=scope.noticeContent.replace(/<br>/g,"\n")}function cancelEdit(){scope.noticeContent=preContent,scope.noticeAbbrev=preAbbrev,scope.isEdit=!1}function saveNotice(){return console.log(scope),0==scope.noticeContent.length?void alert("公告不能为空！"):(scope.isAdd=!1,scope.isEdit=!1,scope.isAddNotice=!1,void noticeService.addNotice(launcher.gid(),scope.noticeContent,launcher.uid()).then(function(suc){dataProcess(suc)},function(err){console.log(err)}))}function getNotice(){noticeService.getNotice(launcher.gid()).then(function(suc){suc&&dataProcess(suc)},function(err){console.log(err)})}function dataProcess(suc){if(notice=suc.notice.toString(),notice=notice.replace(/\n/g,"<br>"),time=$filter("date")(suc.update_time,"yyyy-MM-dd"),scope.noticeAbbrev="公告 "+time+": ",notice.match("<br>")){var brev=notice.split("<br>")[0];scope.noticeAbbrev+=(brev.length>MAX_LEN?brev.slice(0,MAX_LEN):brev)+"...",scope.isNotice=!0,scope.isDetail=!0}else notice.length>=MAX_LEN?(scope.noticeAbbrev+=notice.slice(0,MAX_LEN)+"...",scope.isNotice=!0,scope.isDetail=!0):notice.length>0&&notice.length<MAX_LEN&&(scope.noticeAbbrev+=notice,scope.isNotice=!0);scope.noticeContent=notice}var preContent,preAbbrev,notice,time,MAX_LEN=30;init(),scope.showMore=showMore,scope.editNotice=editNotice,scope.cancelEdit=cancelEdit,scope.saveNotice=saveNotice,scope.addNotice=addNotice,scope.cancelAdd=cancelAdd,scope.$on("group.changed",function(evt,gid){void 0!==gid&&init()}),scope.$on("socket.reconnect",function(){init()}),scope.$on("socket.event.hack.1",function(event,data){dataProcess(data)})}return{restrict:"A",link:link,replace:!0,templateUrl:"pagelet/file/list/notice.html"}}}),define("pagelet/file/list/table",["underscore","jquery"],function(_,$){"use strict";function table(){function link(){}var ctrl=function(tableEl,$scope,comparator,FILE_LIST_MODE){function isSupportSort(){return $scope.listMode===FILE_LIST_MODE.list}function sortBy(sortAttr){$scope.sortAttr=comparator.type().match(/name|time|size|modifier/)[0]?comparator.type().match(/name|time|size|modifier/)[0]:"time",$scope.sortDirection=sortAttr===$scope.sortAttr?"Asc"===$scope.sortDirection?"Desc":"Asc":"Desc",comparator.type(sortAttr+$scope.sortDirection),$scope.sortAttr=sortAttr,resort()}function resort(){_.isNull($scope.files)||($scope.files.sort(comparator),$scope.$broadcast("file.list.resort"))}function updatePaging(){paging&&pagingScroll()&&$scope.$digest()}function updateColumn(){var totalWidth=tableEl.width(),sum=0,calculated=[],expandCol=-1;thead.children().each(function(index,col){var width,colWidth=col.getAttribute("col-width");"fill"==colWidth?(expandCol=index,width=minFillWidth):width=Number(colWidth),calculated[index]=width,sum+=width}),expandCol>=0&&totalWidth>sum&&(calculated[expandCol]+=totalWidth-sum,sum+=totalWidth-sum),thead.width(sum),applyWidth(thead.children(),calculated),tbody.width(sum).children().each(function(index,row){var $row=$(row);$row.width(sum),applyWidth($row.find(".cell"),calculated)})}function applyWidth(elements,calculated){elements.each(function(index,el){el=$(el),el.css({width:calculated[index]+"px"})
})}function resetPaging(files){tbody&&(tbody.css({paddingTop:"0px",paddingBottom:"0px"}),files?files.length<PAGING_THRESHOLD?($scope.visibleFiles=files,paging=!1):(scrollTop=0,paging=!0,scrollFiles=files,$scope.visibleFiles=[],startIndex=0,endIndex=0):paging=!1)}function pagingScroll(){return scrollTop?scrollTop>startIndex*ITEM_HEIGHT&&(scrollFiles.length-endIndex)*ITEM_HEIGHT<scrollBottom?!1:(startIndex=Math.max(Math.floor(scrollTop/ITEM_HEIGHT)-PAGING_BUFFER,0),endIndex=Math.min(Math.ceil((getCtHeight()+scrollTop)/ITEM_HEIGHT)+PAGING_BUFFER,scrollFiles.length),tbody.css({paddingTop:59*startIndex+"px",paddingBottom:59*(scrollFiles.length-endIndex)+"px"}),$scope.visibleFiles=scrollFiles.slice(startIndex,endIndex),!0):($scope.visibleFiles=scrollFiles.slice(0,20),tbody.css({paddingTop:"0px",paddingBottom:59*(scrollFiles.length-20)}),!0)}function locateFile($evt,fileId){var remain,file=_.findWhere($scope.files,{id:_.isString(fileId)?fileId:String(fileId)}),index=_.indexOf($scope.files,file),bh=getBodyHeight(),ch=getCtHeight(),visible=Math.ceil(ch/ITEM_HEIGHT);file&&($scope.deselectAll(),$scope.select(file),paging?(remain=$scope.files.length-index,visible>remain&&(index=$scope.files.length-visible),scrollTop=index*ITEM_HEIGHT,scrollBottom=bh-scrollTop-ch,pagingScroll(),$scope.$$postDigest(function(){$scope.$broadcast("file.scroll",file)})):$scope.$broadcast("file.scroll",file))}function getCtHeight(){return tbodyScroll.height()}function getBodyHeight(){return tbody.height()}var thead,tbody,scrollTop,scrollBottom,scrollFiles,tbodyScroll,minFillWidth=290,paging=!1,startIndex=0,endIndex=0,updatePagingBuffered=_.debounce(updatePaging,100),updateColumnBuffered=_.throttle(updateColumn,50);$scope.sortBy=sortBy,$scope.isSupportSort=isSupportSort,$scope.sortAttr=comparator.type().match(/name|time|size|modifier/)[0]?comparator.type().match(/name|time|size|modifier/)[0]:"time",$scope.sortDirection=comparator.type().match(/Asc|Desc/)[0]?comparator.type().match(/Asc|Desc/)[0]:"Desc",$scope.$on("flexible.resize",updateColumn),$scope.$on("file.locate",locateFile),$scope.showColumn=function(name){return $scope.columns.indexOf(name)>=0},$scope.onTableScroll=function(height,ctHeight,top,bottom){scrollTop=top,scrollBottom=bottom,updatePagingBuffered()},$scope.$watch(function(){$scope.$$postDigest(updateColumnBuffered)}),$scope.$watchCollection(function(){return $scope.files},function(files){resetPaging(files),$scope.$$postDigest(updatePaging)}),$scope.$watch(function(){return $scope.creating},function(creating){creating&&(scrollBottom+=scrollTop,scrollTop=0),$scope.$$postDigest(updatePaging)}),this.setHead=function(el){thead=el},this.setBody=function(el){tbody=el,tbodyScroll=tableEl.find(".table-bd")}};return{link:link,controller:["$element","$scope","fileComparator","FILE_LIST_MODE",ctrl]}}function head(){function link(scope,el,attr,tableCtrl){tableCtrl.setHead(el)}return{require:"^fileLayoutTable",link:link}}function body(){function link(scope,el,attr,tableCtrl){tableCtrl.setBody(el)}return{require:"^fileLayoutTable",link:link}}var PAGING_THRESHOLD=50,PAGING_BUFFER=10,ITEM_HEIGHT=59;return{table:table,head:head,body:body}}),define("pagelet/file/list/selection",[],function(){"use strict";return function($compile,$templateCache,$http,dd,filePermission){function link(scope,el,attr,scroller){function scrollToFile($evt,targetFile){el.find(selector).each(function(index,item){var file=$(item).scope().file;file===targetFile&&(item.scrollIntoView(),scope.deselectAll(),scope.select(file),digest())})}function onContonextMenu(e){var scope=$(e.target).scope();if(!region||e.target!=region[0])return scope.file?void(scope.isSelected(scope.file)||(scope.deselectAll(),select(scope.file),digest())):(scope.deselectAll(),void digest())}function onMouseDown(e){var target=$(e.target);1===e.which&&(target.is('input[type="checkbox"]')||(e.preventDefault(),startWatching(e)))}function onMainClick(e){function selectRange(toFile){var fromFile=lastSelected,list=/trash/.test(selector)?scope.trashes:scope.files,fromIndex=list.indexOf(fromFile),toIndex=list.indexOf(toFile);-1!=toIndex&&(-1==fromIndex&&(fromIndex=0),_.each(list.slice(Math.min(fromIndex,toIndex),Math.max(fromIndex,toIndex)+1),function(file){select(file,!0)}))}var target=$(e.target),file=target.scope().file;if(file){if(target.is('input[type="checkbox"]'))return void toggleSelect(target);e.stopPropagation(),e.ctrlKey||e.metaKey?scope.isSelected(file)?deselect(file):select(file,!0):(scope.deselectAll(),select(file,!0)),e.shiftKey?selectRange(file):lastSelected=file,digest()}}function onBodyClick(){scope.deselectAll(),digest()}function toggleSelect(checkbox){var file=checkbox.scope().file;scope.isSelected(file)?deselect(file):select(file)}function startWatching(e){function watchMove(e){var startScope,target,selection;Math.abs(e.clientX-fromX)<5&&Math.abs(e.clientY-fromY)<5||(stopWatching(),target=$(e.target),selection=scope.getSelectedFiles(),startScope=startEl.scope(),startScope&&selection&&scope.isSelected(startScope.file)?filePermission.check("file.dropout",selection)&&!scope.isStar&&!scope.isGlobalstar&&scope.canMove&&startDrag(e):target.is("li.file-item .icon")||target.parents("li.file-item .icon").size()||target.is("li.file-item .name span")?(scope.deselectAll(),select(startScope.file),filePermission.check("file.dropout",selection)&&!scope.isStar&&startDrag(e),digest()):startSelect(e,shiftOrCtrl))}function stopWatching(){el.unbind("mousemove",watchMove).unbind("mouseup",stopWatching)}var target=$(e.target),shiftOrCtrl=e.ctrlKey||e.metaKey||e.shiftKey;fromX=e.clientX,fromY=e.clientY,startEl=target.is(selector)?target:target.parents(selector),el.bind("mousemove",watchMove).bind("mouseup",stopWatching)}function startDrag(e){function finishDrag(){dd.clean(),proxyEl.remove(),proxyScope.$destroy(),releaseDragEvents()}function renderProxy(){proxyEl=$(tpl).appendTo(bodyEl),$compile(proxyEl)(proxyScope),moveProxy(e),captureDragEvents()}function captureDragEvents(){$(window).bind("mousemove",moveProxy).one("mouseup",finishDrag),el.unbind("click",onMainClick),bodyEl.unbind("click",onBodyClick)}function releaseDragEvents(){$(window).unbind("mousemove",moveProxy),setTimeout(function(){el.bind("click",onMainClick),bodyEl.bind("click",onBodyClick)})}function moveProxy(e){proxyEl.offset({top:e.clientY+8,left:e.clientX+8})}var proxyEl,tpl=$templateCache.get(TPL),proxyScope=scope.$new(),files=scope.getSelectedFiles();proxyScope.selection=files,void 0===tpl?$http.get(TPL,{cache:$templateCache}).success(function(res){$templateCache.put(TPL,tpl=res),renderProxy()}):(renderProxy(),proxyScope.$digest()),dd.provide(files)}function startSelect(e,keepSelection){function finishSelect(){region.remove(),scroller.removeHandler(scrollHandler),releaseSelectEvents()}function captureSelectEvents(){$(window).bind("mousemove",resizeSelect).one("mouseup",finishSelect),el.unbind("click",onMainClick),bodyEl.unbind("click",onBodyClick)}function releaseSelectEvents(){$(window).unbind("mousemove",resizeSelect),setTimeout(function(){el.bind("click",onMainClick),bodyEl.bind("click",onBodyClick)})}function scrollHandler(evt){scrollOffset=evt.top-startOffset,updateRegion()}function resizeSelect(e){toX=e.clientX,toY=e.clientY,updateRegion()}function updateRegion(){var ox=offset.left,oy=offset.top,adjustY=toY+scrollOffset,top=Math.max(Math.min(fromY,adjustY)-oy,0),left=Math.max(Math.min(fromX,toX)-ox,0);region.css({top:top+"px",left:left+"px",width:(fromX>toX?Math.min(fromX-toX,fromX-ox):Math.min(toX-fromX,ox+width-fromX))+"px",height:(fromY>adjustY?Math.min(fromY-adjustY,fromY-oy):Math.min(adjustY-fromY,oy+height-fromY))+"px"}).show(),selectRegion({top:top,left:left,right:left+region.outerWidth(),bottom:top+region.outerHeight()})}function selectRegion(coordinate){var relatedScopes=[],all=scope.isAllSelected(),newAll=!0;el.find(selector).each(function(index,li){li=$(li);var pos=li.position(),left=pos.left,right=pos.left+li.outerWidth(),top=pos.top,bottom=pos.top+li.outerHeight(),childScope=li.scope(),file=childScope.file;coordinate.left>right||coordinate.right<left||coordinate.bottom<top||coordinate.top>bottom?keepSelection||(scope.isSelected(file)&&(deselect(file),relatedScopes.push(childScope)),newAll=!1):scope.isSelected(file)||(select(file),relatedScopes.push(childScope))}),newAll!=all||/trash/.test(selector)?digest():_.each(relatedScopes,function(childScope){childScope.$digest()})}var offset=el.offset(),width=el.innerWidth(),height=el.innerHeight(),startOffset=scroller.getScrollTop(),scrollOffset=0,toX=fromX,toY=fromY;region=$('<div class="file-region"></div>').appendTo(el),captureSelectEvents(),scroller.setHandler(scrollHandler)}function select(file,prevent){prevent||(lastSelected=file),scope.select(file)}function deselect(file){lastSelected==file&&(lastSelected=null),scope.deselect(file)}function digest(){scope.$parent&&scope.$parent.$parent&&scope.$parent.$parent.$digest()}var startEl,fromX,fromY,region,lastSelected,selector=attr.fileSelection,bodyEl=$(document.body).find(".main");el.bind("mousedown",onMouseDown).bind("click",onMainClick).bind("contextmenu",onContonextMenu),bodyEl.bind("click",onBodyClick),scope.$on("file.scroll",scrollToFile)}var TPL="pagelet/file/list/drag-proxy.html";return{require:"^widgetScroller",link:link}}}),define("pagelet/file/list/dragdrop",[],function(){"use strict";return function($q){function provide(newData){return clean(),data=newData,defer=$q.defer(),defer.promise}function consume(evt){var consumeData=data;return defer?(defer.resolve(evt),defer=data=null,consumeData):null}function files(){return data}function clean(){defer&&defer.reject(),defer=data=null}var data=null,defer=null;this.provide=provide,this.files=files,this.consume=consume,this.clean=clean}}),define("pagelet/file/list/droppable",["underscore","jquery"],function(_){"use strict";return function($parse,$q,dd,explorer,launcher,client,filePermission,uploader,dialogs,fileMgr){function link(scope,el,attr){function handler(){if(filePermission.check("file.dropin",expr(scope))&&droppableSupportExpr(scope)){var $target="true"===attr.fileDroppableGlobalRegion?$("body"):el;$target.unbind("dragover",onDragOver).unbind("dragleave",onDragLeave).unbind("drop",onDrop).bind("dragover",onDragOver).bind("dragleave",onDragLeave).bind("drop",onDrop),el.unbind("mouseover",startTrack).bind("mouseover",startTrack)}else"true"===attr.fileDroppableGlobalRegion?$("body").unbind("dragover",onDragOver).unbind("dragleave",onDragLeave).unbind("drop",onDrop):el.unbind("dragover",onDragOver).unbind("dragleave",onDragLeave).unbind("drop",onDrop),el.unbind("mouseover",startTrack)}function startTrack(){function drop(){var defer=$q.defer(),files=dd.consume(defer.promise);files&&(scope.moveFiles(files,targetFolder),cancel())}function cancel(){el.removeClass("drop-hover").unbind("mouseup",drop).unbind("mouseout",cancel)}var targetFolder=expr(scope),files=dd.files();dd.files()&&0!=dd.files().length&&targetFolder&&targetFolder.isFolder&&(_.findWhere(files,{id:targetFolder.id})||_.findWhere(files,{parentId:targetFolder.id})||el.addClass("drop-hover").bind("mouseup",drop).bind("mouseout",cancel))}function onDragOver(e){var folder=expr(scope);$region.removeClass("drop-body"),folder.isFolder&&(e=e.originalEvent,e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy",el.unbind("mouseover",startTrack).bind("dragleave",onDragLeave).addClass("drop-hover"),leaveTimeout&&(clearTimeout(leaveTimeout),leaveTimeout=null))}function onDragLeave(){var folder=expr(scope);folder.isFolder&&clear()}function onDrop(e){function doUpload(entryList,batchId){var uploadType=_.reduce(entryList,function(memo,entry){switch(memo){case null:return entry.isFile?"files":"folder";case"files":return entry.isDirectory?"mixed":memo;case"folder":return entry.isFile?"mixed":memo;case"mixed":return memo}},null);_.each(entryList,function(entry){entry.isFile?entry.file(function(file){uploadFiles([file],folder,!1,batchId,uploadType)}):uploadFolder(gid,entry,folder,!0,folderRead,batchId,uploadType)})}function folderRead(entry,folder,uploadType){entry.createReader().readEntries(function(entries){_.each(entries,function(entry){entry.isFile?entry.file(function(file){uploadFiles([file],folder,!0,void 0,uploadType)}):entry.isDirectory&&uploadFolder(gid,entry,folder,!1,folderRead,void 0,uploadType)})})}function uploadFiles(files,folder,noMsg,batchId,uploadType){var tasks=_.map(files,function(file){var ioTask=uploader.createTask("filename",file);return{upload:function(url){return ioTask.upload(url)},resumeUpload:function(url){return ioTask.resumeUpload(url)},cancel:function(){ioTask.cancel()},append:function(name,value){ioTask.append(name,value)},name:function(){return file.name.substring(file.name.lastIndexOf("/")+1)},size:function(){return file.size},batchId:batchId,batchLength:fileNum,uploadId:uploadId}});scope.$emit("file.drop.upload",tasks.length,uploadId),scope.$emit("folder.drop.upload",tasks,folder,noMsg,uploadType)}function uploadFolder(gid,entry,parent,sendMsg,next,batchId,uploadType){fileMgr.uploadFolder(gid,entry.name,parent,sendMsg,batchId).then(function(data){next(entry,data,uploadType)}).catch(function(e){e&&20108==e.error?dialogs.confirm("上传文件",launcher.getGroup().name+"下有重名文件夹 "+entry.name+" ，是否将这两个文件夹合并",{ok:"是",cancel:"否"}).then(function(){fileMgr.getFile(gid,e.duplicateFileId,void 0,batchId).then(function(data){next(entry,data)}).catch(function(e){260==e.error&&dialogs.alert("上传文件夹","该群存在重名的隐藏/只读文件夹，无法合并。")})},function(){fileMgr.setBatchUploadId(gid,batchId,fileNum-1)}):e&&260==e.error?dialogs.alert("上传文件夹","上传文件夹失败，请重试"):_.isString(e)})}function filterFolder(files,next){var realFiles=[],folders=[];$q.all(_.map(files,function(file){var deferred=$q.defer();if(file.size>1048576)return realFiles.push(file),deferred.resolve(),deferred;var reader=new FileReader;return reader.onload=function(){realFiles.push(file),deferred.resolve()},reader.onerror=function(){folders.push(file),deferred.resolve()},reader.readAsArrayBuffer(file),deferred})).then(function(){next(realFiles,folders)})}var folder=expr(scope),files=e.originalEvent.dataTransfer.files,items=e.originalEvent.dataTransfer.items,gid=launcher.getGroup().id,fileNum=items?items.length:files.length,uploadId=(new Date).getTime();if(folder.isFolder){if(e.preventDefault(),e.stopPropagation(),client.isPC())client.dropFile(launcher.getGroup().id,folder.id,launcher.getGroup().MAX_UPLOAD_SIZE);else if(items&&items.length>0){var entryList=[];if(_.each(items,function(item){var entry=item.webkitGetAsEntry();entry&&entryList.push(entry)}),1==items.length)doUpload(entryList);else{var batchId=(new Date).getTime();fileMgr.setBatchUploadId(gid,batchId,items.length).then(function(){doUpload(entryList,batchId)})}}else filterFolder(files,function(files,folders){if(files.length>0)if(1===files.length)uploadFiles(files,folder,!1);else{var batchId=(new Date).getTime();fileMgr.setBatchUploadId(gid,batchId,files.length).then(function(){uploadFiles(files,folder,!1,batchId)})}folders.length>0&&dialogs.alert("提示","不支持上传文件夹，请使用 chrome 浏览器上传")});clear()}}function clear(){leaveTimeout&&clearTimeout(leaveTimeout),leaveTimeout=setTimeout(function(){el.removeClass("drop-hover").unbind("dragleave",onDragLeave).bind("mouseover",startTrack),leaveTimeout=null},10)}var leaveTimeout,expr=$parse(attr.fileDroppable),droppableSupportExpr=$parse(attr.fileDroppableSupport),$region=$(".region");scope.$watch(function(){return launcher.getCurrentRole()},function(){handler()}),scope.$watch(function(){return droppableSupportExpr(scope)},function(){handler()}),scope.$watch(function(){return expr(scope)},function(){handler()})}return{link:link}}}),define("pagelet/file/list/context",["underscore"],function(){"use strict";return function(menus){function link(scope,el){el.on("click",function(e){var target=$(e.target),pos=target.offset();menus.open({x:pos.left+target.outerWidth()/2,y:pos.top+target.outerHeight()/2,items:scope.items()},"web")}),el.on("dblclick",function(e){return e.stopPropagation(),!1})}return{restrict:"A",link:link,scope:{items:"&fileContextMenu"}}}}),function(){!function(factory){return"function"==typeof define&&define.amd?define("bower_components/util/src/stringComparator",[],factory):factory()}(function(){return function(input1,input2){function compareByLeadingNumber(f1,f2){var name1=f1.toLowerCase(),name2=f2.toLowerCase(),leadingNumber1=/^\d+/.exec(name1),leadingNumber2=/^\d+/.exec(name2);if(leadingNumber1&&leadingNumber2){leadingNumber1=leadingNumber1[0],leadingNumber2=leadingNumber2[0];var leadingNumberCompare=leadingNumber1-leadingNumber2;return 0!==leadingNumberCompare?leadingNumberCompare>0?1:-1:name1.slice(leadingNumber1.length).localeCompare(name2.slice(leadingNumber2.length))}return 0}function compareByUnicode(f1,f2){function unicodeCompareAt(f1,f2,i){return/[^\x00-\xff]/gi.test(f1[i])&&!/[^\x00-\xff]/gi.test(f2[i])?1:!/[^\x00-\xff]/gi.test(f1[i])&&/[^\x00-\xff]/gi.test(f2[i])?-1:f1[i].toLowerCase().localeCompare(f2[i].toLowerCase())}function compareEachCharacter(f1,f2){for(var tempCompare,length=f1.length<f2.length?f1.length:f2.length,i=0;length>i;i++)if(tempCompare=unicodeCompareAt(f1,f2,i),0!=tempCompare)return tempCompare;return 0}var f1NoChinese=!1,f2NoChinese=!1;return/[^\x00-\xff]/gi.test(f1)||(f1NoChinese=!0),/[^\x00-\xff]/gi.test(f2)||(f2NoChinese=!0),f1NoChinese&&f2NoChinese?0:compareEachCharacter(f1,f2)}var number=compareByLeadingNumber(input1,input2);if(0!==number)return number;var unicode=compareByUnicode(input1,input2);return 0!==unicode?unicode:input1.toLowerCase().localeCompare(input2.toLowerCase())}})}.call(this),define("pagelet/file/list/comparator",["underscore","bower_components/util/src/stringComparator"],function(_,comparator){"use strict";var comparators={type:function(f1,f2){return f1.isFolder&&!f2.isFolder?-1:!f1.isFolder&&f2.isFolder?1:0},nameAsc:function(f1,f2){var type=comparators.type(f1,f2);return 0!==type?type:comparator(f1.name,f2.name)},nameDesc:function(f1,f2){var type=comparators.type(f1,f2);return 0!==type?type:comparator(f2.name,f1.name)},sizeAsc:function(f1,f2){var res,type=comparators.type(f1,f2);return 0!==type?type:(res=(f1.size||0)-(f2.size||0),0!==res?res:comparators.nameAsc(f1,f2))},sizeDesc:function(f1,f2){var res,type=comparators.type(f1,f2);return 0!==type?type:(res=(f2.size||0)-(f1.size||0),0!==res?res:comparators.nameDesc(f1,f2))},timeAsc:function(f1,f2){var type=comparators.type(f1,f2),t1=f1.lastModifiedDate.getTime(),t2=f2.lastModifiedDate.getTime();return 0!==type?type:t1!==t2?t1-t2:comparators.nameAsc(f1,f2)},timeDesc:function(f1,f2){var type=comparators.type(f1,f2),t1=f1.lastModifiedDate.getTime(),t2=f2.lastModifiedDate.getTime();return 0!==type?type:t2!==t1?t2-t1:comparators.nameDesc(f1,f2)},modifierAsc:function(f1,f2){var type=comparators.type(f1,f2);if(0!==type)return type;var res=f1.modifier.name.toLowerCase().localeCompare(f2.modifier.name.toLowerCase());return 0!==res?res:comparators.nameAsc(f1,f2)},modifierDesc:function(f1,f2){var type=comparators.type(f1,f2);if(0!==type)return type;var res=-f1.modifier.name.toLowerCase().localeCompare(f2.modifier.name.toLowerCase());return 0!==res?res:comparators.nameAsc(f1,f2)}};return function(launcher,storageMgr,LOCAL_STORAGE_KEY){function compare(f1,f2){return comparators[sortType](f1,f2)}function getterOrSetter(type){return type?void(_.isFunction(comparators[type])&&(sortType=type,storage.put(LOCAL_STORAGE_KEY.EXPLORER_SORT,type))):sortType}var storage=storageMgr.forUser(launcher.uid()),sortType=function(){var stored=storage.get(LOCAL_STORAGE_KEY.EXPLORER_SORT);return _.isFunction(comparators[stored])?stored:"timeDesc"}();return _.extend(compare,{type:getterOrSetter})}}),define("pagelet/file/list/view",["underscore","jquery","util/keycode","util/tracker","util/trackTiming"],function(_,$,KEYCODE,tracker,trackTiming){"use strict";function fileViewCtrl($rootScope,$scope,$q,explorer,dialogs,executor,launcher,client,selectFiles,permission,filePermission,starService,storageMgr,$timeout,fileMgr,noteMgr,menuService,SHARE_EVENTS,LOCAL_STORAGE_KEY,FILE_LIST_MODE){function openOrForward(file,opt){var groupId=file.gid||file.groupId;if(groupId!==launcher.gid())return void launcher.forwardOrJoin(groupId).then(function(){file.isFolder?explorer.openFolder(file.id):explorer.openFile(file.id)});if(file.isFolder){var label="groupId-"+file.gid+":fileId-"+file.id;trackTiming.downFolder.setLabel(label).start(),explorer.openFolder(file.id)}else{var fileName=file.name;if(fileName){var label="groupId-"+file.gid+":fileId-"+file.id;/\.table$/.test(fileName)?trackTiming.openTable.setLabel(label).start():/\.(doc|docx|ppt|pptx|xls|xlsx)$/i.test(fileName)?trackTiming.openOffice.setLabel(label).start():/\.note$/.test(fileName)&&trackTiming.openNote.setLabel(label).start()}explorer.openFile(file,opt)}}function getContextMenu(){var selection=getSelectedFiles(),menuOption=wrapMenuOption(selection),filters=[defaultMenuFilter].concat(explorer.getContextMenuFilter());return 0===selection.length?menuOption.items():(_.each(filters,function(filter){filter(selection,menuOption)}),menuOption.items())}function defaultMenuFilter(selection,menuOption){function checkPermission(action,title,cb,parent,otherOpt){filePermission.check("file."+action,selection)&&(parent?menuOption.appendChildren(parent,action,title,cb,otherOpt):menuOption.append(action,title,cb,otherOpt))}function preview(){explorer.preview(file)}function trace(){explorer.openRevision(file)}function upload(){uploadAndOverwrite(file)}function rename(){renameFile(file)}function remove(){removeFiles(selection)}function innerLink(){return client.isPC()&&client.copyText(getInnerLink(file)),explorer.hint("内链复制成功","success"),tracker.event("lab_innerLink_mode","innerLink_copy"),"内链复制成功"}function publish(){_.each(selection,function(file){explorer.publish(file)})}function download(){explorer.download(selection)}function allAbleToDownload(files){return explorer.ableToDownload(files)}function toggleFavorite(){toggleStar(file)}function inFavoriteSelection(){unStarSelection(selection)}function favoriteSelection(){starSelection(selection)}function share(){return explorer.shareFile(file)}function unShare(){return explorer.unShareFile(file).then(function(){explorer.hint("已取消分享链接","success")},function(){explorer.hint("取消分享链接失败","error")})}function openShareDialog(){return explorer.openShareDialog(file.shareEntry)}function moveOrCopyTo(){moveOrCopy(selection)}function viewFolderProp(){openFolderPropDialog(file)}function getType(file){return file.name.slice(file.name.lastIndexOf(".")+1)}function exportFiles(){return fileMgr.exportMultiFiles(selection).then(function(){return"保存成功，请稍候查看"}).catch(onExportError)}function exportNotes(){return $q.all(_.map(selection,function(file){return noteMgr.exportAsMyNotes(launcher.gid(),file.id)})).then(function(){return"保存成功，请稍候查看"}).catch(onExportError)}function onExportError(e){return e&&"401"===e.error?(tracker.event("exceed","exceed-noteattachment-show"),dialogs.alertBySrc("提示","pagelet/file/dialog/exceed-attachmentSpaceQuota.html",{height:"auto"}),$q.reject()):$q.reject(e&&"210"===e.error?"我的笔记空间已满，保存失败":"保存至我的笔记失败")}var file=selection[0],selectionAllFavorite=!0,selectionAllNotFavorite=!0,ableToUpload=!1,ableToImport=!1,ableToUpdate=!1;if($scope.listMode!==FILE_LIST_MODE.globalStar&&0!==selection.length&&(1===selection.length&&(!file.isFolder&&explorer.ableToPreview(file)&&checkPermission("preview","预览",preview),!file.isFolder&&explorer.ableToTrace(file)&&(2===file.domain?permission.check("file.trace")&&permission.check("table.trace")&&menuOption.append("trace","历史版本",trace):checkPermission("trace","历史版本",trace)),ableToUpdate=permission.check("file.upload")||permission.check("file.import"),ableToUpload=!file.isFolder&&explorer.ableToUpload(file),ableToImport=/\.note$/.test(file.name)&&0===file.domain||launcher.getUser().isYDocUser&&!(2==file.domain)&&!file.isFolder,ableToUpdate&&ableToUpload&&ableToImport?(menuOption.append("update","更新文件"),checkPermission("upload","上传新版本",upload,"update")):ableToUpload&&checkPermission("upload","上传新版本",upload),menuOption.append("-"),checkPermission("rename","重命名",rename)),checkPermission("moveOrCopyTo","复制或移动",moveOrCopyTo),$scope.listMode!==FILE_LIST_MODE.star&&checkPermission("remove","删除",remove),1===selection.length&&explorer.ableToShare(file)&&(menuOption.append("-"),file.shareEntry?(checkPermission("unshare","查看分享链接",openShareDialog),checkPermission("unshare","取消分享",unShare)):checkPermission("share","分享",share)),menuOption.append("-"),allAbleToDownload(selection)&&checkPermission("download","下载到本地",download),$scope.folder&&1===selection.length&&selection[0].isFolder&&(menuOption.append("-"),checkPermission("viewFolderProp","文件夹属性",viewFolderProp)),launcher.getUser().isYDocUser?_.every(selection,function(file){return"table"!==getType(file)&&!file.isFolder})&&checkPermission("export","保存到我的笔记",exportFiles):_.every(selection,function(file){return"note"==getType(file)})&&checkPermission("export","保存到我的笔记",exportNotes),(filePermission.check("file.favorite",selection)||filePermission.check("file.publish",selection)||filePermission.check("file.innerLink",selection))&&(menuOption.append("more","更多操作"),1===selection.length?file.favorite?checkPermission("favorite","取消星标",toggleFavorite,"more"):checkPermission("favorite","添加星标",toggleFavorite,"more"):selection.length>1&&(_.each(selection,function(selectedFile){selectionAllFavorite=selectionAllFavorite&&selectedFile.favorite,selectionAllNotFavorite=selectionAllNotFavorite&&!selectedFile.favorite}),selectionAllFavorite&&checkPermission("favorite","取消星标",inFavoriteSelection,"more"),selectionAllNotFavorite&&checkPermission("favorite","添加星标",favoriteSelection,"more")),_.reduce(selection,function(memo,v){return memo||v.isOnlyManagerView},!1)||checkPermission("publish","发送到讨论",publish,"more"),1===selection.length))){var opt={type:4,copyValue:getInnerLink(file)};checkPermission("innerLink","复制内部链接",innerLink,"more",opt)}}function getFileMenu(file){var selection=[file],menuOption=wrapMenuOption(selection),filters=[defaultMenuFilter].concat(explorer.getContextMenuFilter());return _.each(filters,function(filter){filter(selection,menuOption)}),menuOption.items()}function newFolder(parent){function create(){var name=editor.getValue();editor.close(),doCreate(name)}function doCreate(name){$scope.createName=name,$scope.posting=!0,executor.execute("create",[gid,name,parent]).then(success).catch(error)}function success(command){var newFile=command.file(),file=_.findWhere($scope.files,{id:newFile.id});file||$scope.files.push(newFile),$scope.creating=null,explorer.hint("文件夹建立成功","success")}function error(command){var e=command.exception();$scope.creating=null,e&&20108==e.error?e.adviceName?dialogs.confirm("新建文件夹","目录中有重名文件夹，是否新建为："+e.adviceName+"？",{ok:"是",cancel:"否"}).then(function(){doCreate(e.adviceName)}):dialogs.alert("新建文件夹","目录中有重名文件夹，请选择其他文件夹名称。",{width:380}).then(function(){newFolder(parent)}):_.isString(e)?dialogs.alert("新建文件夹",e):e&&explorer.hint("文件夹建立失败","error")}function userCanceled(){editor.close(),$scope.creating=null}var editor,name="新建文件夹",i=0,gid=launcher.gid();if(!$scope.creating){for(;null!=_.findWhere($scope.files,{name:name});)name="新建文件夹("+ ++i+")";$scope.creating=parent.id,$scope.createName="",editor=$scope.$broadcast("file.editor.match",null).editor,editor.open(name).then(create).catch(userCanceled)}}function uploadAndOverwrite(file){selectFiles.open().then(function(tasks){dialogs.open({src:"pagelet/file/upload/upload-dialog.html",multiple:!1,gid:launcher.gid(),tasks:tasks,file:file}).then(function(files){_.extend(file,files[0]),explorer.hint("上传文件成功","success")},function(e){e&&explorer.hint("上传文件失败","error")})})}function moveOrCopy(totalFiles){function executeCopyOrMove(message){function executeCopy(){function copySuccess(cmd){var finished=cmd.finished();tempfinished=finished,$scope.folder&&toFolder.id!==$scope.folder.id&&remove(finished),waiting.resolve(),copyFolders()}function copyError(cmd){var e=cmd.exception();e&&"10024"===e.error?explorer.hint("复制失败，群空间不足","error"):e&&"20101"===e.error?explorer.hint("复制失败，目标文件夹不存在","error"):e&&"51010"===e.error?explorer.hint("复制失败，组织空间不足","error"):e&&"401"===e.error?explorer.hint("复制失败，文件大小超过上限","error"):e&&"223"===e.error?explorer.hint("不支持移动到只读文件夹","error"):explorer.hint("复制失败","error"),waiting.reject()}function copyProgress(cmd){var finished=cmd.finished();waiting.notify("正在复制第 "+(finished.length+1)+"/"+totalFiles.length+" 个文件（夹）...")}function copyFolderSuccess(cmd){var finished=cmd.finished().concat(tempfinished);$timeout(function(){var successed=_.reject(finished,function(v){return!v});explorer.hint("复制了"+successed.length+"个文件（夹）至群“"+dstGroup.name+"”","success"),$scope.folder&&toFolder.id!==$scope.folder.id&&remove(_.reject(cmd.finished(),function(v){return!v})),waiting.resolve()},1e3)}function copyFolderProgress(cmd){var finishedLength,finished=cmd.finished().concat(tempfinished);finishedLength=finished.length+1>totalFiles.length?totalFiles.length:finished.length+1,waiting.notify("正在复制第 "+finishedLength+"/"+totalFiles.length+" 个文件（夹）..."+cmd.percent()+"%")}function copyFolders(){waiting=wait(),executor.execute("copyFolder",[gid,folders,toFolder]).then(copyFolderSuccess,copyError,copyFolderProgress)}_.each(totalFiles,function(file){file.isFolder?folders.push(file):files.push(file)}),executor.execute("copy",[gid,files,toFolder]).then(copySuccess,copyError,copyProgress)}function executeMove(){function success(cmd){var finished=cmd.finished();explorer.hint("移动了"+finished.length+"个文件至“"+cmd.target().name+"”","success"),$scope.folder&&toFolder.id!==$scope.folder.id&&remove(finished),$scope.$emit("files.move",finished,cmd.target()),waiting.resolve()}function error(cmd){if(cmd){var exception=cmd.exception();exception&&"223"===exception.error?explorer.hint("不支持移动到只读文件夹","error"):explorer.hint("移动失败","error")}waiting.reject()}function progress(cmd){var finished=cmd.finished(),files=cmd.files();waiting.notify("正在移动第 "+(finished.length+1)+"/"+files.length+" 个文件...")}executor.execute("move",[gid,totalFiles,toFolder]).then(success,error,progress)}var toFolder=message[0],dstGroup=message[1],action=message[2],files=[],folders=[],tempfinished=[];"copy"==action?executeCopy():"move"==action&&executeMove()}_.each(totalFiles,function(file){file.id=String(file.id)});var waiting=wait(),gid=launcher.gid();dialogs.open({src:"pagelet/file/selector/copy-dialog.html",title:"复制或移动",width:"360",height:"360",gid:gid,except:totalFiles}).then(executeCopyOrMove)}function moveFiles(originFiles,toFolder){function executeMove(toFolder){function success(cmd){var finished=cmd.finished();explorer.hint("移动了"+finished.length+"个文件至“"+cmd.target().name+"”","success"),$scope.folder&&toFolder.id!==$scope.folder.id&&remove(finished),$scope.$emit("files.move",finished,cmd.target()),waiting.resolve()}function error(cmd){if(cmd){var exception=cmd.exception();exception&&"223"===exception.error?explorer.hint("不支持移动到只读文件夹","error"):explorer.hint("移动失败","error")}waiting.reject()}function progress(cmd){var finished=cmd.finished(),files=cmd.files();waiting.notify("正在移动第 "+(finished.length+1)+"/"+files.length+" 个文件...")}executor.execute("move",[gid,files,toFolder]).then(success,error,progress)}var waiting=wait(),files=[].concat(originFiles),gid=launcher.gid();return toFolder?void executeMove(toFolder):void dialogs.open({src:"pagelet/file/selector/selector-dialog.html",title:"移动到",width:360,height:360,gid:gid,except:files,selectType:"folder"}).then(executeMove)}function openFolderPropDialog(folder){var gid=launcher.gid();dialogs.open({src:"pagelet/file/dialog/folder-prop.html",title:"文件夹属性",width:"330",height:"230",overflow:"hidden",gid:gid,folder:folder,parentFolder:$scope.folder}).then(function(code){null!==code&&($scope.files=_.map($scope.files,function(value){return value.id==folder.id&&(value.isOnlyManagerEdit=!Boolean(1&code),value.isOnlyManagerView=!Boolean(2&code),$rootScope.$broadcast("file.changeReadOnly",value)),value}))})}function removeFiles(files){function doRemove(){executor.execute("remove",[gid,files]).then(success,error,progress)
}function success(cmd){var finished=cmd.finished();explorer.hint("删除了"+finished.length+"个项目","success"),remove(finished),waiting.resolve()}function error(cmd){var e=cmd.exception();e&&explorer.hint("删除失败","error"),waiting.reject()}function progress(cmd){var finished=cmd.finished(),files=cmd.files();waiting.notify("正在删除第 "+(finished.length+1)+"/"+files.length+" 个文件...")}if(permission.check("file.remove")){var waiting=wait(),gid=launcher.gid();1==files.length?files[0].isFolder?dialogs.confirmBySrc("删除文件夹","pagelet/file/dialog/remove-folder.html").then(doRemove):dialogs.confirm("删除文件","您确定要删除这个文件吗？").then(doRemove):dialogs.confirm("删除多个文件/文件夹","确定删除这些文件/文件夹吗？").then(doRemove)}}function getInnerLink(file){var href="http://note.youdao.com/group/"+file.gid,full="?full";if(file.isFolder)return href+"/folder/"+file.id;var type=explorer.getRouterPrefix(file);return href+"/"+type+"/"+file.id+full}function renameFile(file){function rename(){var name=editor.getValue();editor.close(),doRename(name)}function doRename(name){file.name!==name&&executor.execute("rename",[gid,file,name]).then(success).catch(error)}function success(command){var newFile=command.file();_.extend(file,newFile),explorer.hint("重命名成功","success")}function error(command){var e=command.exception();e&&(e&&20108==e.error?e.adviceName?dialogs.confirm("重命名","目录中有重名"+(file.isFolder?"文件夹":"文件")+"，是否重命名为："+e.adviceName+"？",{ok:"是",cancel:"否"}).then(function(){doRename(e.adviceName)}):dialogs.alert("重命名","目录中有重名"+(file.isFolder?"文件夹":"文件")+"，请选择其他"+(file.isFolder?"文件夹":"文件")+"名称。").then(function(){renameFile(file)}):_.isString(e)?dialogs.alert("重命名",e):explorer.hint("重命名失败","error"))}function userCanceled(){editor.close()}var gid=launcher.gid(),editor=$scope.$broadcast("file.editor.match",file).editor;editor.open(file).then(rename).catch(userCanceled)}function locateFile(file){explorer.locateFile(file.id)}function forwardToGroup(file){var groupId=file.gid||file.groupId;$rootScope.$broadcast("group.forward",groupId)}function wrapMenuOption(selection){var option=new menuService.MenuOption(selection),insertAfter=option.insertAfter;return option.insertAfter=function(after,name,label,handler,otherOpt){var wrap=function(file){_.isUndefined(handler)||$q.when(handler(file)).then(function(retValue){retValue&&explorer.hint(retValue,"success")}).catch(function(retValue){retValue&&explorer.hint(retValue,"error")})};return insertAfter.call(option,after,name,label,wrap,otherOpt)},option}function selectAll(){_.each($scope.files,function(file){select(file)})}function deselectAll(){_.each($scope.files,function(file){deselect(file)})}function toggleSelectAll(){isAllSelected()?deselectAll():selectAll()}function select(file){$scope.selection[file.id]=!0}function deselect(file){$scope.selection[file.id]&&($scope.selection[file.id]=!1)}function toggleSelect(file){$scope.selection[file.id]?deselect(file):select(file)}function isSelected(file){return $scope.selection[file.id]===!0}function getSelectedFiles(){return _.filter($scope.files,function(file){return isSelected(file)})}function isAllSelected(){var all=!0,list=$scope.files;return 0==list.length?!1:(_.each(list,function(file){$scope.selection[file.id]||(all=!1)}),all)}function wait(){var defer=$q.defer();return defer.promise.then(function(){delete $scope.waiting},function(){delete $scope.waiting},function(msg){$scope.waiting=msg}),defer}function remove(files){_.isArray(files)||(files=[files]),_.each(files,function(file){var related=get(file.id);related&&$scope.files.splice(_.indexOf($scope.files,related),1)})}function get(fileId){return _.findWhere($scope.files,{id:fileId})}function doStarSuccess(){var storage=storageMgr.forUser(launcher.uid()),sf=storage.get(LOCAL_STORAGE_KEY.HAS_DO_ADD_STAR);sf||(storage.put(LOCAL_STORAGE_KEY.HAS_DO_ADD_STAR,!0),$rootScope.$broadcast($scope.$parent.treeSelected?"file.star.intro":"file.star.expandFileTree"))}function triggerShare(file){file.shareEntry?explorer.openShareDialog(file.shareEntry):explorer.shareFile(file)}function toggleStar(file,undo){isDisabled||(file.favorite?(file.favorite=!1,isDisabled=!0,starService.cancelFavorite(file.gid||file.groupId,file.id).then(function(){file.favorite=!1,isDisabled=!1,undo?explorer.hint("撤销成功","success"):explorer.hint("取消星标成功","success",function(){toggleStar(file,!0)})},function(){file.favorite=!0,isDisabled=!1,explorer.hint("取消星标失败","error")})):(file.favorite=!0,isDisabled=!0,starService.addFavorite(file.gid||file.groupId,file.id).then(function(){file.favorite=!0,isDisabled=!1,undo?explorer.hint("撤销成功","success"):explorer.hint("添加星标成功","success",function(){toggleStar(file,!0)}),doStarSuccess()},function(){file.favorite=!1,isDisabled=!1,explorer.hint("添加星标失败","error")})))}function unStarSelection(selection,undo){var promises=[];_.each(selection,function(file){promises.push(starService.cancelFavorite(file.gid||file.groupId,file.id))}),$q.all(promises).then(function(){$scope.listMode===FILE_LIST_MODE.star?_.each(selection,function(file){$scope.$parent.starFiles=_.reject($scope.$parent.starFiles,function(f){return f.id===file.id})}):_.each(selection,function(file){file.favorite=!1}),undo?explorer.hint("撤销成功","success"):explorer.hint("取消星标成功","success",function(){starSelection(selection,!0)})},function(){explorer.hint("取消星标失败","error")})}function starSelection(selection,undo){var promises=[];_.each(selection,function(file){promises.push(starService.addFavorite(file.gid||file.groupId,file.id))}),$q.all(promises).then(function(){$scope.listMode!==FILE_LIST_MODE.star&&_.each(selection,function(file){file.favorite=!0}),undo?explorer.hint("撤销成功","success"):explorer.hint("添加星标成功","success",function(){unStarSelection(selection,!0)})},function(){explorer.hint("添加星标失败","error")})}var isDisabled=!1;$scope.client=client,$scope.explorer=explorer,$scope.openOrForward=openOrForward,$scope.getContextMenu=getContextMenu,$scope.getFileMenu=getFileMenu,$scope.triggerShare=triggerShare,$scope.toggleStar=toggleStar,$scope.canMove=!0,$scope.selection={},$scope.select=select,$scope.deselect=deselect,$scope.toggleSelect=toggleSelect,$scope.selectAll=selectAll,$scope.deselectAll=deselectAll,$scope.toggleSelectAll=toggleSelectAll,$scope.isSelected=isSelected,$scope.isAllSelected=isAllSelected,$scope.getSelectedFiles=getSelectedFiles,$scope.moveFiles=moveFiles,$scope.locateFile=locateFile,$scope.forwardToGroup=forwardToGroup,$scope.renameFile=renameFile,$scope.$watch(function(){return launcher.getCurrentRole()},function(){$scope.ableToFavorite=permission.check("file.favorite")}),$rootScope.$on(SHARE_EVENTS.SHARE,function(event,json){json.file.shareEntry=json.shareEntry}),$rootScope.$on(SHARE_EVENTS.UNSHARE,function(event,file){_.each($scope.files,function(value){value.id===file.id&&(value.shareEntry=null)}),_.each($scope.starFiles,function(value){value.id==file.id&&(value.shareEntry=null)})}),$scope.$on("file.newFolder",function(){$scope.folder&&$scope.listMode!==FILE_LIST_MODE.star&&$scope.listMode!==FILE_LIST_MODE.globalStar&&newFolder($scope.folder)}),$scope.$on("file.moveFiles",function($evt,files,folder){$scope.folder&&$scope.listMode!==FILE_LIST_MODE.star&&$scope.listMode!==FILE_LIST_MODE.globalStar&&moveFiles(files,folder)}),$rootScope.$on("list.selectAll",function(){$scope.$apply("selectAll()")}),$rootScope.$on("list.deleteSelection",function(){var files=$scope.getSelectedFiles();files&&files.length>0&&removeFiles(files)})}return function(){function link(){}return{link:link,templateUrl:"pagelet/file/list/view.html",controller:["$rootScope","$scope","$q","explorer","dialogService","executor","launcher","clientProxy","selectFileService","permissionService","filePermissionService","starService","storageManager","$timeout","fileManager","noteManager","menuService","SHARE_EVENTS","LOCAL_STORAGE_KEY","FILE_LIST_MODE",fileViewCtrl],scope:{files:"=fileView",layout:"=fileViewLayout",folder:"=fileViewBase",loading:"=fileViewLoading",keyword:"=fileViewKeyword",columns:"=fileViewColumns",listMode:"@fileViewListMode",supportDroppable:"=fileDroppableSupport"}}}}),define("pagelet/file/list/globalStar/globalStarCtrl",["underscore","jquery"],function(_){"use strict";return function($scope,$q,$filter,launcher,starService,shareService){function openGlobalStar(){return $q.when(null)}function orderStars(starFiles){var favoriteFolders=[],favoriteFiles=[];return _.each(starFiles,function(starFile){starFile.isFolder?favoriteFolders.push(starFile):favoriteFiles.push(starFile)}),favoriteFolders=orderBy(favoriteFolders,"favoriteTime",!0),favoriteFiles=orderBy(favoriteFiles,"favoriteTime",!0),[].concat(favoriteFolders).concat(favoriteFiles)}function getStarFiles(){$scope.globalStarFiles=[],_.each(myGroups,function(group){starService.listStars(group.id).then(function(starFiles){_.each(starFiles,function(file){tempGroup=_.findWhere(myGroups,{id:Number(file.gid||file.groupId)}),tempFile=_.findWhere($scope.globalStarFiles,{id:Number(file.id)}),_.isNull(tempGroup)&&_.isUndefined(tempGroup)||!_.isUndefined(tempFile)&&!_.isNull(tempFile)||(file.groupName=tempGroup.name,$scope.globalStarFiles.push(file))}),$scope.globalStarFiles=orderStars($scope.globalStarFiles)})})}function removeStarFiles($evt,removedFile){$scope.globalStarFiles=_.reject($scope.globalStarFiles,function(starFile){return Number(starFile.id)===Number(removedFile.id)})}var tempGroup,tempFile,tempShareFile,orderBy=$filter("orderBy"),myGroups=launcher.getGroups();$scope.globalStarFiles=[],$scope.canMove=!1,$scope.$open(function(){return openGlobalStar()}),$scope.$invoke(function(){return openGlobalStar()}),$scope.$on("file.favorite",function($evt,file){_.findWhere($scope.globalStarFiles,{id:Number(file.id)})||(tempGroup=_.findWhere(myGroups,{id:Number(file.gid||file.groupId)}),tempGroup&&(file.groupName=tempGroup.name,file.id=Number(file.id),file.favorite=!0,$scope.globalStarFiles.push(file),$scope.globalStarFiles=orderStars($scope.globalStarFiles)))}),$scope.$on("file.cancelFavorite",removeStarFiles),$scope.$on("file.remove",removeStarFiles),$scope.$on("file.update",function($evt,file){tempFile=_.findWhere($scope.globalStarFiles,{id:Number(file.id)}),tempFile&&(file.favoriteDate=tempFile.favoriteDate,_.extend(tempFile,file))}),$scope.$on("file.recover",function($evt,file){starService.listStars(file.gid||file.groupId).then(function(starFiles){tempFile=_.findWhere(starFiles,{id:Number(file.id)}),tempShareFile=_.findWhere(shareService.getShareFilesIncludingRemoved(),{id:String(file.id)}),tempFile&&(file.favorite=!0,file.favoriteDate=tempFile.favoriteDate,file.id=Number(file.id),tempShareFile&&(file.shareEntry=tempShareFile),$scope.globalStarFiles.push(file),$scope.globalStarFiles=orderStars($scope.globalStarFiles))})}),getStarFiles()}}),define("pagelet/file/tree/fileTreeCtrl",["underscore","jquery"],function(){"use strict";return function($scope,fileMgr,launcher){function getRootFile(gid){gid&&($scope.treeFile=[],fileMgr.getFileByPath(gid,"/").then(function(root){$scope.treeFile=root,$scope.rootFolderId=root.id}))}function highlightSelected(){var find=!1,stack=[].concat($scope.stack);for($scope.$emit("filetree.select");!find&&stack.length>0;)find=$scope.$broadcast("filetree.folder.change",stack.pop()).defaultPrevented}$scope.$on("file.list.open.current",highlightSelected),$scope.$on("file.list.filetree.selected",highlightSelected),$scope.$on("group.changed",function(evt,gid){getRootFile(gid)}),$scope.$watch("folder",highlightSelected),$scope.selection={},getRootFile(launcher.gid())}}),define("pagelet/file/tree/fileTreeSelection",[],function(){"use strict";return function($compile,$templateCache,$http,dd,filePermission){function link(scope,el,attr){function onMouseDown(e){$(e.target);1===e.which&&(e.preventDefault(),startWatching(e))}function startWatching(e){function watchMove(e){Math.abs(e.clientX-fromX)<5&&Math.abs(e.clientY-fromY)<5||(stopWatching(),filePermission.check("file.dropout",selectedFile)&&startDrag(e),scope.selection={})}function stopWatching(){el.unbind("mousemove",watchMove).unbind("mouseup",stopWatching)}var target=$(e.target);fromX=e.clientX,fromY=e.clientY,startEl=target.is(selector)?target:target.parents(selector),startEl.scope()&&(scope.selection[startEl.scope().treeFile.id]=!0,selectedFile[0]=startEl.scope().treeFile,el.bind("mousemove",watchMove).bind("mouseup",stopWatching))}function startDrag(e){function finishDrag(){dd.clean(),proxyEl.remove(),proxyScope.$destroy(),releaseDragEvents()}function renderProxy(){proxyEl=$(tpl).appendTo(bodyEl),$compile(proxyEl)(proxyScope),moveProxy(e),captureDragEvents()}function captureDragEvents(){$(window).bind("mousemove",moveProxy).one("mouseup",finishDrag)}function releaseDragEvents(){$(window).unbind("mousemove",moveProxy)}function moveProxy(e){proxyEl.offset({top:e.clientY+8,left:e.clientX+8})}var proxyEl,tpl=$templateCache.get(TPL),proxyScope=scope.$new();proxyScope.selection=selectedFile,void 0===tpl?$http.get(TPL,{cache:$templateCache}).success(function(res){$templateCache.put(TPL,tpl=res),renderProxy()}):(renderProxy(),proxyScope.$digest()),dd.provide(selectedFile)}var startEl,fromX,fromY,selector=attr.fileTreeSelection,bodyEl=$(document.body).find(".main"),selectedFile=[];el.bind("mousedown",onMouseDown)}var TPL="pagelet/file/list/drag-proxy.html";return{link:link}}}),define("pagelet/file/tree/fileTreeSelectNodeCtrl",["underscore","jquery"],function(_){"use strict";return function($scope,fileMgr,comparator,viewport,explorer){function filter(treeFile){return treeFile.isFolder?_.findWhere($scope.except,{id:treeFile.id})?!1:!0:!1}function openOrForward(file){file.isFolder?explorer.openFolder(file.id):explorer.openFile(file)}function init(treeFile){void 0!==treeFile&&($scope.treeFile.parentId||($scope.path=void 0),$scope.name=$scope.treeFile.name,$scope.path=$scope.path?"/"===$scope.path?"/"+$scope.treeFile.name:$scope.path+"/"+$scope.treeFile.name:"/",$scope.expanded=!1,$scope.selected="",$scope.toggle=toggle,$scope.select=select,$scope.expandable=!!$scope.treeFile.folders)}function toggle(){$scope.expanded?collapse():expand()}function expand(){fileMgr.listFiles($scope.gid(),$scope.path,filter).then(function(treeFiles){treeFiles.sort(comparator),$scope.treeFiles=treeFiles,$scope.expandable=$scope.treeFiles.length>0,$scope.expanded=!0})}function collapse(){$scope.expanded=!1}function select(){$scope.folder&&$scope.folder.id===$scope.treeFile.id&&$scope.$emit("file.list.filetree.selected")}function onFileSelect(evt,newFile){newFile&&$scope.treeFile&&newFile.id===$scope.treeFile.id?(evt.preventDefault(),$scope.selected="selected"):$scope.selected=""}function onFileCreate(evt,file){var treeFiles=[];if(file.isFolder&&file.parentId===$scope.treeFile.id){if(treeFiles=[].concat($scope.treeFiles),_.findWhere(treeFiles,{id:file.id}))return;treeFiles.unshift(file),treeFiles.sort(comparator),$scope.treeFiles=treeFiles,$scope.expandable=!!treeFiles.length}}function onFileUpdate(evt,file){var path;file.isFolder&&file.id===$scope.treeFile.id&&($scope.treeFile=file,path=$scope.path.split("/"),path.pop(),$scope.path=path.join("/")||"/")}function onFileRemove(evt,file){var treeFiles=[];file.parentId===$scope.treeFile.id&&(treeFiles=[].concat($scope.treeFiles),treeFiles=_.reject(treeFiles,function(one){return file.id===one.id}),$scope.treeFiles=treeFiles,$scope.expandable=!!treeFiles.length)}function onFileMove(evt,file){var treeFiles=[];if(file.isFolder)if(file.parentId===$scope.treeFile.id){if(treeFiles=[].concat($scope.treeFiles),_.findWhere(treeFiles,{id:file.id}))return;treeFiles.unshift(file),treeFiles.sort(comparator),$scope.treeFiles=treeFiles,$scope.expandable=!!treeFiles.length}else{if(treeFiles=[].concat($scope.treeFiles),!_.findWhere(treeFiles,{id:file.id}))return;treeFiles=_.reject(treeFiles,function(one){return file.id===one.id}),$scope.treeFiles=treeFiles,$scope.expandable=!!treeFiles.length}}function onFileUpload(evt,file){file.parentId===$scope.treeFile.id&&expand()}function resort(){$scope.treeFiles.sort(comparator)}function highlightRoot(){$scope.treeFile.parentId||($scope.selected="selected")}$scope.gid();$scope.treeFiles=[],$scope.$watch("[files, gid()]",function(newValue){if(!($scope.treeFile&&$scope.treeFile.parentId||_.isNull(newValue[0])||0===newValue[0].length)){var treeFiles=_.reject(newValue[0],function(file){return!filter(file)});0!==treeFiles.length&&treeFiles[0].parentId===$scope.rootFolderId&&(treeFiles.sort(comparator),$scope.treeFiles=treeFiles,$scope.expandable=$scope.treeFiles.length>0,$scope.expanded=!0)}},!0),$scope.openOrForward=openOrForward,$scope.expand=expand,$scope.$watch("treeFile",init),$scope.$on("filetree.folder.change",onFileSelect),$scope.$on("file.list.resort",resort),$scope.$on("file.create",onFileCreate),$scope.$on("file.update",onFileUpdate),$scope.$on("file.remove",onFileRemove),$scope.$on("file.move",onFileMove),$scope.$on("file.upload",onFileUpload),$scope.$on("file.recover",onFileCreate),$scope.$on("file.forwardRoot",highlightRoot)}}),define("pagelet/file/msg/message",["underscore","jquery"],function(_,$){"use strict";function FileMessage(json){if(this.type=4,this.id=json.id?Number(json.id):void 0,this.groupId=json.groupId?Number(json.groupId):void 0,this.longInterval=Boolean(json.longInterval),this.time=json.time?Number(json.time):void 0,this.user=json.user||{},this.operation=Number(json.operation),this.isDir=Boolean(json.dir),this.files=[],_.isUndefined(json.batchId))this.files.push({fileId:Number(json.fileId),parentId:Number(json.parentId),fileName:json.fileName?String(json.fileName):void 0,version:Number(json.version),isDir:Boolean(json.dir),onlyManagerEdit:json.onlyManagerEdit?Boolean(json.onlyManagerEdit):!1,onlyManagerView:json.onlyManagerView?Boolean(json.onlyManagerEdit):!1});else{var jsonMessage=JSON.parse(json.jsonMessage);_.each(jsonMessage[1],function(msg){msg=JSON.parse(msg),this.files.push({fileId:msg.id,parentId:msg.pid,fileName:msg.n,version:msg.v,isDir:msg.r?!0:!1,onlyManagerEdit:!1,onlyManagerView:!1})}.bind(this))}}return function($scope,explorer){function openFolder(folderId){folderId&&explorer.openFolder(folderId)}function locateFile(fileId){explorer.locateFile(fileId)}function openFile(fileId){explorer.openFile(fileId)}function showMoreFiles(){var node=$("#"+$scope.messageId),chat=$(".chat-display-bd .widget-scroller-wrap");$scope.displayedNumber+20<=$scope.files.length?$scope.displayedNumber+=20:$scope.displayedNumber=$scope.files.length,window.setTimeout(function(){var delta=node.height()+node.offset().top-(chat.height()+chat.offset().top);delta>0&&chat.scrollTop(chat.scrollTop()+delta)},0)}function packFiles(){$scope.displayedNumber=5}function fileIconAdapter(file){return{id:file.fileId,gid:message.groupId,name:file.fileName,version:file.version,isFolder:file.isDir}}var message=$scope.message=new FileMessage($scope.message.data);$scope.files=message.files,$scope.displayedNumber=$scope.files.length<=5?$scope.files.length:5,1===$scope.files.length&&($scope.file=$scope.files[0]),$scope.openFolder=openFolder,$scope.locateFile=locateFile,$scope.openFile=openFile,$scope.getIcon=fileIconAdapter,$scope.showMoreFiles=showMoreFiles,$scope.packFiles=packFiles,$scope.messageId="chatMessage"+message.id}}),define("pagelet/file/revision/revisionCtrl",[],function(){"use strict";return function($scope,fileManager,dialogs,selectFiles,clientProxy,filePermission){function list(){fileManager.getFile(gid,fileId).then(listFileRevision)}function listFileRevision(){fileManager.listRevision(gid,fileId).then(function(revs){$scope.revisions=revs})}function uploadDirectly(tasks){dialogs.open({src:"pagelet/file/upload/upload-dialog.html",gid:gid,file:$scope.file,multiple:!1,tasks:tasks}).then(list)}function overwrite(){selectFiles.open().then(uploadDirectly)}function isCanCompareDocument(file){return 1===file.version?!1:clientProxy.isSupport("compareDocument")&&/\.(doc|docx)$/i.test(file.name)?!0:!1}function compareDocument(rev){var url1,url2,url="/yws/api/group/"+rev.gid+"/file/"+rev.id+"?method=download&version=",name=rev.name;url1=url+rev.version,url2=url+(rev.version-1),clientProxy.compareDocument(name,url1,name,url2)}var $dialog=$scope.$dialog,fileId=$scope.file.id,gid=$scope.gid;$dialog.title=$scope.file.name,$dialog.buttonAlign="center",$dialog.buttons=filePermission.check("file.upload",$scope.file)?[{text:"上传新版本",handler:overwrite,cls:"blue"}]:[],$dialog.width=400,$dialog.list=list,$dialog.cls="revision-dialog",list(),$scope.compareDocument=compareDocument,$scope.isCanCompareDocument=isCanCompareDocument,$scope.download=fileManager.download}}),define("pagelet/file/selector/fileSelectCtrl",["underscore"],function(_){"use strict";return function($scope,fileMgr,$filter){function confirm(){$dialog.dismiss($scope.selection)}function cancel(){$dialog.cancel()}function selectFile(file,path){$scope.selection=file,$scope.paths=path,$scope.$broadcast("file.selector.choose",file)}function processPath(path){var paths;return path&&-1!==path.indexOf("/")&&(paths=path.split("/"),paths=_.map(paths,function(pa){return pa=$filter("cut")(pa,20)}),paths.length>=3&&(paths=_.last(paths,3),paths[0]="..."),path=paths.join(" / ")),path}function showName(files){var name="";return name=files[0].name}var $dialog=$scope.$dialog;fileMgr.getFileByPath($scope.gid,"/").then(function(root){$scope.file=root}),$scope.selection=null,$scope.upload||_.extend($dialog,{width:400,height:320,buttons:[{text:"确定",cls:"primary",handler:confirm},{text:"取消",cls:"cancel",handler:cancel}]}),$scope.$watch("selection",function(selection){$dialog.buttons&&($dialog.buttons[0].disabled=null===selection)}),$scope.$watch("showFiles",function(showFiles){showFiles?_.extend($dialog,{width:395,height:408}):$scope.upload&&_.extend($dialog,{width:395,height:210})}),$scope.selectFile=selectFile,$scope.processPath=processPath,$scope.confirm=confirm,$scope.cancel=cancel,$scope.showName=showName}}),define("pagelet/file/selector/fileSelectNodeCtrl",["underscore"],function(_){"use strict";return function($scope,fileMgr,comparator){function filter(file){return file.isFolder?_.findWhere($scope.except,{id:file.id})?!1:!0:!1}function init(file){void 0!=file&&($scope.file.parentId||($scope.path=void 0),$scope.name=$scope.file.name,$scope.path=$scope.path?"/"===$scope.path?"/"+$scope.file.name:$scope.path+"/"+$scope.file.name:"/",$scope.expanded=!1,$scope.files=[],$scope.selected="",$scope.toggle=toggle,$scope.select=select,$scope.expandable=!!$scope.file.folders,$scope.$on("file.selector.choose",onFileSelect),$scope.file.parentId||expand())}function toggle(){$scope.expanded?collapse():expand()}function expand(){var groupId=$scope.file.gid||gid;fileMgr.listFiles(groupId,$scope.path,filter).then(function(files){files.sort(comparator),$scope.files=files,$scope.expandable=$scope.files.length>0,$scope.expanded=!0})}function collapse(){$scope.files=[],$scope.expanded=!1}function select(){$scope.selectFile($scope.file,$scope.path)}function onFileSelect(evt,file){$scope.selected=file===$scope.file?"selected":""}var gid=$scope.gid;$scope.$watch("file",init)}}),define("pagelet/file/selector/copyCtrl",["jquery","underscore"],function($,_){"use strict";return function($scope,$q,$timeout,fileMgr,$filter,groupService,launcher,permission){function copy(){$dialog.dismiss([$scope.selection,$scope.dstGroups.selected,"copy"])}function move(){$dialog.dismiss([$scope.selection,$scope.dstGroups.selected,"move"])}function cancel(){$dialog.cancel()}function showName(files){return files[0].name}function selectFile(file,path){$scope.selection=file,$scope.paths=path,$scope.showPath=!1,$scope.$broadcast("file.selector.choose",file)}function processPath(path){var paths;return path&&-1!==path.indexOf("/")&&(paths=path.split("/"),paths=_.map(paths,function(pa){return pa=$filter("cut")(pa,10)}),paths.length>=3&&(paths=_.last(paths,3),paths[0]="..."),path=paths.join(" / ")),path}function togglePath(){$scope.showPath=!$scope.showPath}function hidePath(){$scope.showPath=!1}function exitOrDismiss(evt,value){$scope.dstGroups=_.reject($scope.dstGroups,function(g){return g.id===value.groupId})}function init(){launcher.getGroupsCanCopyTo().then(function(groups){$scope.dstGroups=orderBy(groups,"modifyTime",!0),$scope.dstGroups.selected=_.find($scope.dstGroups,function(g){return g.id===$scope.gid})}),$(".widget-dialog-footer").click(function(){$timeout(function(){$scope.showPath=!1},0)}),$timeout(function(){$(".multi-file-name").height()>60&&($scope.fileName=$scope.fileName.substr(0,15)+"..."),$(".multi-file-name").height()<30&&$(".multi-files").css("margin-top","11px")},50)}var $dialog=$scope.$dialog,orderBy=$filter("orderBy"),moveDisabled=!0,copyDisabled=!0;_.extend($dialog,{width:400,height:140,buttons:[{text:"复制",cls:"primary",handler:copy,disabled:copyDisabled},{text:"移动",cls:"primary",handler:move,disabled:moveDisabled},{text:"取消",cls:"cancel",handler:cancel}]});var moveButton=_.findWhere($dialog.buttons,{text:"移动"}),copyButton=_.findWhere($dialog.buttons,{text:"复制"});$scope.selectFile=selectFile,$scope.showName=showName,$scope.processPath=processPath,$scope.togglePath=togglePath,$scope.hidePath=hidePath,$scope.fileName=showName($scope.except),$scope.selectedPath=processPath($scope.paths),$scope.showPath=!1,$scope.selection=null,$scope.currentGroup=launcher.getGroup(),$scope.groupSelected=launcher.getGroup(),$scope.$watch("dstGroups.selected",function(groupSelected){groupSelected||(groupSelected=$scope.currentGroup),$scope.paths="",$scope.showPath=!1,$scope.selection=null,fileMgr.getFileByPath(groupSelected.id,"/").then(function(root){copyButton.disabled=copyDisabled=!permission.check("file.copyTo"),moveButton.disabled=moveDisabled=groupSelected.id==$scope.currentGroup.id&&moveButton?!permission.check("file.move"):!0,$scope.file=root,selectFile(root,"/")})}),$scope.$watch("selection",function(){$scope.selectedPath=processPath($scope.paths)}),$scope.$on("group.exit.this",exitOrDismiss),$scope.$on("group.dismiss.copy",exitOrDismiss),$scope.$on("group.remove.copy",exitOrDismiss),$scope.$on("group.update.copy",function(evt,value){var tempGroup=_.findWhere($scope.dstGroups,{id:value.groupId});tempGroup&&(tempGroup.name=value.groupName)}),init()}}),define("pagelet/file/upload/uploadService",["underscore","util/tracker"],function(_,tracker){"use strict";return function($q,fileMgr,dialogs,launcher){function getRunningList(){return runningQueue}function getWaitingList(){return waitingList}function getFinishList(){return doneList}function getUploadUrl(gid){return["/yws/api/group/"+gid+"/file?method=startUpload","/yws/api/group/"+gid+"/file?method=upload"]}function getGroupName(gid){var groupName;return _.each(launcher.getGroups(),function(group){group.id===gid&&(groupName=group.name)}),groupName}function exceedSpaceAlert(gid){groupInfo=_.findWhere(launcher.getGroups(),{id:gid}),groupInfo.isVip?dialogs.alert("上传文件",getGroupName(gid)+"("+gid+")群存储容量已满，无法增加新文件。请删除不必要的文件后重新上传"):groupInfo.owner===launcher.getUser().userId?(tracker.event("exceed","exceed-space-show"),dialogs.alertBySrc("上传文件","pagelet/file/upload/exceed-spaceQuota.html",{height:"auto",message:getGroupName(gid)+"("+gid+")"})):dialogs.alert("上传文件",getGroupName(gid)+"("+gid+")群存储容量已满，无法增加新文件。如需添加更多文件，请联系群主升级到企业版。")}function onDuplicatedName(e,transId,folder,gid,batchId,batchLegnth){function uploadAndOverwrite($confirm){$confirm.dismiss(Number(e.duplicateFileId))}var dupDefer=$q.defer();return dialogs.confirm("上传文件",getGroupName(gid)+"("+gid+")下有重名文件，是否重命名为："+e.adviceName+"？",{ok:"是",cancel:"否",width:"420px",buttons:[{text:"覆盖原版本",cls:"cancel",handler:uploadAndOverwrite}]}).then(function(fileId){_.isNumber(fileId)?overwrite(transId,Number(e.duplicateFileId),gid,void 0,void 0,batchId).then(dupDefer.resolve).catch(dupDefer.reject):create(transId,e.adviceName,folder,gid,void 0,void 0,batchId).then(dupDefer.resolve).catch(dupDefer.reject)}).catch(function(){batchId&&fileMgr.setBatchUploadId(launcher.gid(),batchId,batchLegnth-1),dupDefer.reject()}),dupDefer.promise}function createFileError(e,folder,fileName,gid,groupName){e&&"42001"===e.error?exceedSpaceAlert(gid):e&&"10024"===e.error?exceedSpaceAlert(gid):e&&"30001"===e.error?dialogs.alert("上传文件","您已不在"+groupName+"("+gid+")，请重新加入该群上传"+fileName):e&&"20101"===e.error?folder?dialogs.alert("上传文件",getGroupName(gid)+"("+gid+')不存在文件夹"'+folder.name+'"，或该文件夹已被删除，请重新上传'+fileName):dialogs.alert("上传文件",groupName+"("+gid+")不存在该文件或已被删除，请重新上传"+fileName):e&&"20114"===e.error?dialogs.alert("上传文件",getGroupName(gid)+"("+gid+")中的文件数已经到达上限，请删除不必要的文件后重新上传"):e&&"51010"===e.error?dialogs.alert("上传文件","组织空间已用尽，无法上传文件。请清理空间或者购买更大的套餐"):dialogs.alert("上传文件",fileName+"上传失败，请稍后重试")}function create(transId,fileName,folder,gid,groupName,noMsg,batchId,batchLength){var fileDefer=$q.defer();return fileMgr.newFile(gid,fileName,folder,transId,noMsg,batchId).then(function(file){fileDefer.resolve(file)}).catch(function(e){return e&&"20108"===e.error?void onDuplicatedName(e,transId,folder,gid,batchId,batchLength).then(fileDefer.resolve).catch(fileDefer.reject):(createFileError(e,folder,fileName,gid,groupName),void fileDefer.reject(e))}),fileDefer.promise}function overwrite(transId,fileId,gid,fileName,groupName,batchId){var fileDefer=$q.defer();return fileMgr.overwrite(gid,fileId,transId,batchId).then(fileDefer.resolve).catch(function(e){createFileError(e,null,fileName,gid,groupName),fileDefer.reject(e)}),fileDefer.promise}function Uploader(gid,task,onUploadFinish){function doNext(that){runningQueue=_.without(runningQueue,that),waitingList.length&&waitingList.shift().start()}function start(parentId){function success(res){onUploadFinish(res).then(function(res){defer.resolve(res),doneList.unshift(_.extend(that,{name:res.name,status:"done",id:res.id,gid:res.gid,version:res.version}))}).catch(function(e){defer.reject(e),e&&doneList.unshift(_.extend(that,{status:"error"}))}).finally(function(){doNext(that)})}function error(e){if(null===e||_.isUndefined(e.status)||0!==e.status){if(e){try{e=JSON.parse(e.text||"")}catch(er){return(e.status&&500===e.status||"network error"===e.text)&&dialogs.alert("上传文件",task.name()+"上传失败，请稍后重试"),doNext(that),void defer.reject(e)}"30001"===e.error?dialogs.alert("上传文件","您已不在"+groupName+"("+gid+")，请重新加入该群上传"+task.name()):dialogs.alert("上传文件",task.name()+"上传失败，请稍后重试"),doneList.unshift(_.extend(that,{status:"error"}))}doNext(that),defer.reject(e)}}function progress(evt){that.sent=evt.sent,that.percent=that.total?Math.floor(100*that.sent/that.total):0}var that=this;return runningQueue.length<2?(runningQueue.unshift(that),task.resumeUpload(getUploadUrl(gid),parentId).then(success,error,progress)):waitingList.unshift(this),defer.promise}function cancel(){var that=this,found=!1;waitingList=_.reject(waitingList,function(uploader){return uploader===that&&(found=!0),uploader===that}),found||(doneList=_.reject(doneList,function(uploader){return uploader===that&&(found=!0),uploader===that}),found||task.cancel())}var defer=$q.defer(),sent=0,percent=0,groupName=getGroupName(gid),total=task.size(),name=task.name();this.start=start,this.cancel=cancel,this.sent=sent,this.percent=percent,this.total=total,this.name=name,this.batchId=task.batchId}function doUpload(gid,task,folder,noMsg){function onUploadFinish(res){return res=JSON.parse(res.text),create(res.TransmitId,task.name(),folder,gid,groupName,noMsg,task.batchId,task.batchLength)}var groupName=getGroupName(gid),uploader=new Uploader(gid,task,onUploadFinish);return uploader.start(folder.id)}function doOverwrite(gid,task,fileId){function onUploadFinish(res){return res=JSON.parse(res.text),overwrite(res.TransmitId,fileId,gid,task.name(),groupName,task.batchId,task.batchLength)}var groupName=getGroupName(gid),uploader=new Uploader(gid,task,onUploadFinish);return uploader.start()}function cancelAll(){_.each(runningQueue,function(uploader){uploader.cancel()}),runningQueue=[],waitingList=[],doneList=[]}var groupInfo,runningQueue=[],waitingList=[],doneList=[];this.doUpload=doUpload,this.doOverwrite=doOverwrite,this.getRunningList=getRunningList,this.getWaitingList=getWaitingList,this.getFinishList=getFinishList,this.cancelAll=cancelAll
}}),define("pagelet/file/upload/uploadCtrl",["underscore"],function(_){"use strict";return function($rootScope,$scope,launcher,dialogs,fileMgr,$q,uploads){function isOverwrite(){return void 0!==$scope.file}function equalsExtName(name){var originName=$scope.file.name;return originName.substring(originName.lastIndexOf(".")+1)===name.substring(name.lastIndexOf(".")+1)?!0:!1}function doMultiUpload(tasks,noMsg){_.each(tasks,function(task){uploads.doUpload(gid,task,folder,noMsg).then(function(){$dialog.dismiss()})})}function doOverWriteUpload(){$dialog.hide(),uploads.doOverwrite(gid,deferredTask,$scope.file.id).then(function(newFile){$dialog.notify(newFile),$dialog.dismiss([newFile])}).catch(function(){$dialog.dismiss()})}function onFileSelected(tasks,hideAlert,noMsg){function executeUpload(toFolder,noMsg){var task=tasks[0],overSize=!1,errMessage="";return toFolder&&(folder=toFolder),$dialog.errMsg=null,_.each(tasks,function(fileTask){return!overSize&&fileTask.size()>$scope.maxSize?void(overSize=!0):void 0}),overSize?void(launcher.getGroup().isVip||0!==launcher.getGroup().orgId?($dialog.show(),$dialog.errMsg="抱歉，暂不支持添加1GB以上的文件"):(errMessage="抱歉，暂不支持添加200MB以上的文件",dialogs.alertBySrc("上传文件","pagelet/file/upload/exceed-uploadLimitQuota.html",{height:"auto",message:errMessage}))):(deferredTask=task,isOverwrite()?void(equalsExtName(task.name())?doOverWriteUpload(task.name()):($dialog.hide(),dialogs.confirm("上传新版本","您上传的文件类型与当前版本不一致，确定要继续上传？",{width:340}).then(function(){doOverWriteUpload(task.name())}).catch(function(){$dialog.cancel()}))):void doMultiUpload(tasks,noMsg))}var files,file={};files=_.map(tasks,function(task){return file.name=task.name(),file}),$dialog.hide(),isOverwrite()?executeUpload():hideAlert?executeUpload(!1,noMsg):fileMgr.getFilePath(gid,folder.id).then(function(path){dialogs.open({src:"pagelet/file/upload/upload-selector-dialog.html",title:"上传文件",width:400,height:165,gid:gid,except:files,selectType:"folder",upload:!0,paths:path}).then(executeUpload).catch($dialog.cancel)}).catch(function(){dialogs.alert("上传文件","上传文件失败，请重试")})}var deferredTask,$dialog=$scope.$dialog,gid=$scope.gid,folder=$scope.folder,tasks=$scope.tasks,hideAlert=$scope.hideAlert,noMsg=$scope.noMsg;$dialog.title=$dialog.title||"上传文件",$dialog.width=360,$dialog.height=100,$scope.isVIP=launcher.getGroup().isVip,$scope.maxSize=launcher.getGroup().MAX_UPLOAD_SIZE,$scope.onFileSelected=onFileSelected,tasks&&(hideAlert?onFileSelected(tasks,hideAlert,noMsg):onFileSelected(tasks))}}),define("pagelet/file/upload/uploaderCtrl",["underscore","jquery"],function(_,$){"use strict";return function($scope,dialogs,$q,uploads,viewport,launcher,explorer,$location,fileMgr){function close(){$scope.runnings().length>0?dialogs.confirm("取消上传","您有文件正在上传，确认取消上传吗？ ",{ok:"是",cancel:"否"}).then(function(){uploads.cancelAll()}):uploads.cancelAll()}function locationFile(groupId,fileId){$scope.fullScreen||groupId&&fileId&&launcher.forwardOrJoin(groupId).then(function(){explorer.locateFile(fileId)})}function openFile(groupId,fileId){$scope.fullScreen||groupId&&fileId&&launcher.forwardOrJoin(groupId).then(function(){explorer.openFile(Number(fileId))})}function cancel(uploader){if(uploader.batchId){var fileNum=_.reduce($scope.waitings().concat($scope.runnings()).concat($scope.finishes()),function(memo,task){return memo+(task.batchId===uploader.batchId?1:0)},0);fileMgr.setBatchUploadId(launcher.gid(),uploader.batchId,fileNum-1)}uploader.cancel()}function interceptUnload(){return $scope.runnings().length?"您有文件正在上传，确认取消上传吗？":void 0}$(window).on("beforeunload",interceptUnload),$scope.$watchCollection(function(){return $location.search()},function(search){$scope.fullScreen=search.full,$scope.hintTitle=$scope.fullScreen?"":"打开文件夹"}),$scope.fullScreen=!1,$scope.runnings=uploads.getRunningList,$scope.waitings=uploads.getWaitingList,$scope.finishes=uploads.getFinishList,$scope.close=close,$scope.locationFile=locationFile,$scope.openFile=openFile,$scope.cancel=cancel}}),define("pagelet/file/upload/progressCtrl",["underscore"],function(){"use strict";return function($scope){function onCancel(){$dialog.cancel()}function onProgress(evt){var sent=evt.sent,total=evt.total;$scope.text=evt.file.name.substring(evt.file.name.lastIndexOf("/")+1),$scope.sent=sent,$scope.total=total,$scope.percent=total?Math.floor(99*sent/total):0}var $dialog=$scope.$dialog,progress=$scope.progress;$dialog.title="添加文件",$dialog.buttons=[{text:"取消",cls:"gray",handler:onCancel}],$dialog.width=362,$dialog.height=60,$scope.percent=0,$scope.sent=0,$scope.total=1/0,progress.then($dialog.dismiss,onCancel,onProgress)}}),define("pagelet/file/upload/uploaderProgressDirective",[],function(){"use strict";return function(){function link(scope,el,attr){function update(){var percent=1*value/max;bar.css("width",160*percent+"px")}var bar=el,value=0,max=1/0;scope.$watch(attr.value,function(newValue){value=newValue,update()}),scope.$watch(attr.max,function(newValue){max=newValue,update()}),scope.$watch(attr.status,function(status){"done"===status?bar.parent().addClass("done"):"error"===status&&bar.addClass("error")})}return{restrict:"AC",link:link}}}),define("pagelet/file/detail/detailCommentDirective",["underscore","util/trackTiming"],function(_,trackTiming){"use strict";return function(){function link(scope,el,attr){scope.viewName=attr.detailCommentView}var ctrl=function($scope,$location,$interval,fileMgr,viewport,explorer,$attrs,$q,dialogs,launcher,clientProxy,titleService){function onOpen(opt){return onInvoke(opt).then(bindAll)}function onInvoke(opt){return openFile(opt.fileId).then(function(file){opt.hasOwnProperty("commentId")?($scope.commentId=opt.commentId,$scope.max=!1):delete $scope.commentId;var type=explorer.getRouterPrefix(file);return("office"==type&&!clientProxy.isPC()||"pdf"==type||"image"==type||"text"==type)&&($scope.showDownload=!0),file})}function onClose(){return unbindAll(),$scope.fileData=null,_.isFunction(quitFn)&&quitFn(),$q.when()}function watchFile(fn){var unwatch=this.$watchCollection("fileData",fn);this.$on("$destroy",unwatch)}function onQuit(fn){quitFn=fn}function returnList(){return/\.(doc|docx|ppt|pptx|xls|xlsx)$/i.test($scope.fileData.name)&&trackTiming.closeOffice.clear().start(),$location.search("full",null),explorer.restore()}function bindAll(file){return watchers=[$scope.$on("file.remove",onFileRemove),$scope.$on("file.update",onFileUpdate)],editingInterval=$interval(editing,6e4,0,!1),editing(),file.name}function unbindAll(){_.each(watchers,function(unwatch){unwatch()}),$interval.cancel(editingInterval)}function onError(e){return $scope.loading=!1,$scope.fileData=null,e&&"260"===e.error?dialogs.alert("打开文件","无法查看该文件，仅群管理员或群主可见"):dialogs.alert("打开文件","文件已被删除"),$q.reject()}function render(file){return $scope.fileData=file,fileMgr.getFilePath(file.gid,file.parentId).then(function(path){$scope.filePath=path}).catch(function(){$scope.filePath="读取路径失败"}),$scope.loading=!1,file}function openFile(fileId){return $scope.fileData=null,void 0===fileId?(onError(),$q.reject(fileId)):($scope.loading=!0,fileMgr.getFile($scope.gid(),fileId).then(render).catch(onError))}function onFileRemove($evt,file){$scope.fileData.id==file.id&&dialogs.alert("提示","该文件已被群内其他成员删除了").then(returnList)}function onFileUpdate($evt,file){null!==$scope.fileData&&$scope.fileData.id===file.id&&($scope.fileData=file,$scope.fullScreen&&titleService.set(titleService.Priority.FILENAME,file.name))}function editing(){return fileMgr.getModifiers($scope.gid(),$scope.fileData.id).then(function(modifiers){var uid=launcher.getUser().userId;$scope.modifiers=_.filter(modifiers,function(modifier){return modifier.userId!=uid})}).catch(function(e){e&&e.data&&"260"===e.data.error&&$interval.cancel(editingInterval)})}var quitFn,editingInterval,watchers=[];$scope.max=!1,$scope.showDownload=!1,$scope.$open(onOpen),$scope.$invoke(onInvoke),$scope.$close(onClose),$scope.$quit=onQuit,$scope.$watchFile=watchFile,$scope.returnList=returnList,$scope.getAction=explorer.getAction,$scope.openRevision=explorer.openRevision,$scope.download=fileMgr.download};return{restrict:"A",templateUrl:"pagelet/file/detail/detail-comment.html",transclude:!0,replace:!0,link:link,controller:["$scope","$location","$interval","fileManager","viewport","explorer","$attrs","$q","dialogService","launcher","clientProxy","titleService",ctrl]}}}),define("pagelet/file/detail/tools",["util/tracker","jquery","underscore"],function(tracker,$,_){"use strict";return function($rootScope,$q,explorer,dialogs,clientProxy,executor,launcher,selectFiles,menuService,filePermission,$location,starService,shareService,SHARE_EVENTS,demoService,fileMgr,noteMgr,storageMgr,LOCAL_STORAGE_KEY){function link(scope){function toggleMeta(){scope.$parent.meta=!scope.$parent.meta,storage.put(LOCAL_STORAGE_KEY.FILE_META_EXPANDED,scope.$parent.meta)}function removeMoreSplits(items){for(var newItems=[],i=0;i<items.length;i++)3===items[i].type&&(0>i-1||3===items[i-1].type)||newItems.push(items[i]);items=newItems,newItems=[];for(var i=0;i<items.length;i++)3===items[i].type&&(i+1>=items.length||3===items[i+1].type)||newItems.push(items[i]);return newItems}function onFileChanged(file){file&&starService.listStars(launcher.gid()).then(function(starFiles){var starFile=_.findWhere(starFiles,{id:String(file.id)});return file.favorite=starFile?!0:!1,shareService.listShareFiles(launcher.gid()).then(function(shareFiles){file.shareEntry=_.findWhere(shareFiles,{id:String(file.id)}),scope.file=file,scope.$broadcast("file.detail.change",file),scope.dropdownMenu=removeMoreSplits(getMenuOption(file))})}).finally(function(){scope.file=file,scope.$broadcast("file.detail.change",file),scope.dropdownMenu=removeMoreSplits(getMenuOption(file))})}function getMenuOption(file){var files=[file],menuOption=wrapMenuOption(files),filters=[defaultMenuFilter].concat(explorer.getContextMenuFilter());return _.each(filters,function(filter){filter(files,menuOption,!1,!0)}),menuOption.items()}function defaultMenuFilter(files,menuOption){function checkMenuPermission(action,title,cb){filePermission.check("file."+action,files)&&menuOption.append(action,title,cb)}function preview(){explorer.preview(file)}function trace(){explorer.openRevision(file)}function upload(){selectFiles.open().then(function(tasks){dialogs.open({src:"pagelet/file/upload/upload-dialog.html",gid:launcher.gid(),file:scope.file,tasks:tasks}).then(function(files){_.extend(scope.file,files[0])})})}function publish(){return explorer.publish(file),"成功发送到讨论"}function print(){explorer.print(file)}function rename(file){function doRename(name){file.name!==name&&executor.execute("rename",[launcher.gid(),file,name+ext]).then(success).catch(error)}function success(command){var newFile=command.file();_.extend(file,newFile),explorer.hint("重命名成功","success")}function error(command){var e=command.exception();e&&(e&&20108==e.error?dialogs.alert("重命名","目录中有重名"+(file.isFolder?"文件夹":"文件")+"，请选择其他"+(file.isFolder?"文件夹":"文件")+"名称。").then(renameFile):_.isString(e)?dialogs.alert("重命名",e).then(function(){rename(file)}):explorer.hint("重命名失败","error"))}var reg=/\.\w+$/,name=file.name,ext=name.match(reg);dialogs.prompt("重命名",file.name.replace(reg,""),{maxlength:240}).then(doRename)}function copyTo(){function executeCopy(message){function success(){dialogs.alert("复制文件","复制文件成功")}function error(cmd){var e=cmd.exception();e&&"10024"===e.error?dialogs.alert("复制文件","复制失败，群空间不足"):dialogs.alert("复制文件","复制失败")}{var toFolder=message[0];message[1]}executor.execute("copy",[gid,files,toFolder]).then(success,error)}var gid=launcher.gid();dialogs.open({src:"pagelet/file/selector/copy-dialog.html",title:"复制到其他群",width:"360",height:"360",gid:gid,except:files}).then(executeCopy)}function move(file){function executeMove(toFolder){executor.execute("move",[gid,[file],toFolder]).then(success).catch(error)}function success(){dialogs.alert("移动文件","移动文件成功")}function error(cmd){cmd&&dialogs.alert("移动文件","移动失败")}var gid=launcher.gid();dialogs.open({src:"pagelet/file/selector/selector-dialog.html",title:"移动到",width:360,height:360,gid:gid,selectType:"folder",except:[file]}).then(executeMove)}function remove(file){function doRemove(){executor.execute("remove",[gid,[file]]).then(success).catch(error)}function success(){scope.close(),-1!=$location.url().search("full")&&($location.search("full",null),explorer.openRootFolder())}function error(cmd){cmd.exception()&&dialogs.alert("删除文件","删除失败")}var gid=launcher.gid();dialogs.confirm("删除文件","您确定要删除这个文件吗？").then(doRemove)}function toggleFavorite(file){file.favorite?starService.cancelFavorite(file.gid||file.groupId,file.id).then(function(){scope.file.favorite=!1,scope.dropdownMenu=removeMoreSplits(getMenuOption(scope.file)),explorer.hint("取消加星成功","success")},function(){explorer.hint("取消加星失败","error")}):starService.addFavorite(file.gid||file.groupId,file.id).then(function(){scope.file.favorite=!0,scope.dropdownMenu=removeMoreSplits(getMenuOption(scope.file)),explorer.hint("加星文件成功","success")},function(){explorer.hint("加星文件失败","error")})}function share(){return explorer.shareFile(file)}function unShare(){return explorer.unShareFile(file).then(function(){explorer.hint("已取消分享链接","success")},function(){explorer.hint("取消分享链接失败","error")})}function openShareDialog(){return explorer.openShareDialog(file.shareEntry)}function getType(file){return file.name.slice(file.name.lastIndexOf(".")+1)}function exportFiles(){return fileMgr.exportSingleFile(file).then(function(){return"保存成功，请稍候查看"}).catch(onExportError)}function exportNotes(){return noteMgr.exportAsMyNotes(launcher.gid(),file.id).then(function(){return"保存成功，请稍候查看"}).catch(onExportError)}function onExportError(e){return e&&"401"===e.error?(tracker.event("exceed","exceed-noteattachment-show"),dialogs.alertBySrc("提示","pagelet/file/dialog/exceed-attachmentSpaceQuota.html",{height:"auto"}),$q.reject()):$q.reject(e&&"210"===e.error?"我的笔记空间已满，保存失败":"保存至我的笔记失败")}var file=files[0];!file.isFolder&&explorer.ableToPreview(file)&&checkMenuPermission("preview","预览",preview),!file.isFolder&&explorer.ableToTrace(file)&&(2===file.domain?filePermission.check("file.trace",files)&&filePermission.check("table.trace",files)&&menuOption.append("trace","历史版本",trace):checkMenuPermission("trace","历史版本",trace)),!file.isFolder&&explorer.ableToUpload(file)&&checkMenuPermission("upload","上传新版本",upload),menuOption.items().length>0&&menuOption.append("-"),explorer.ableToPrint(file,file.name)&&checkMenuPermission("print","打印",print),checkMenuPermission("rename","重命名",rename),checkMenuPermission("move","移动到",move),file.isFolder||checkMenuPermission("copyTo","复制到其他群",copyTo),file.favorite?checkMenuPermission("favorite","取消星标",toggleFavorite):checkMenuPermission("favorite","添加星标",toggleFavorite),checkMenuPermission("remove","删除",remove),explorer.ableToShare(file)&&(menuOption.append("-"),file.shareEntry?(checkMenuPermission("unshare","查看分享链接",openShareDialog),checkMenuPermission("unshare","取消分享",unShare)):file.isFolder||checkMenuPermission("share","分享",share)),menuOption.append("-"),checkMenuPermission("publish","发送到讨论",publish),explorer.ableToDownload(file)&&checkMenuPermission("download","下载到本地",explorer.download),launcher.getUser().isYDocUser?"table"===getType(file)||file.isFolder||checkMenuPermission("export","保存到我的笔记",exportFiles):"note"==getType(file)&&checkMenuPermission("export","保存到我的笔记",exportNotes)}function triggerHandler(action){action.handler(scope.file)}function togglePanel(){var parentScope=scope.$parent;parentScope.max=!parentScope.max}function openNewPage(){window.open(location.href+(location.href.indexOf("?")>0?"&full":"?full")),scope.close()}function triggerShare(file){file.shareEntry?explorer.openShareDialog(file.shareEntry):explorer.shareFile(file)}function disableDemoTips(){storage.put(LOCAL_STORAGE_KEY.DISABLE_DEMO_TIPS,!0),scope.showDemoTips=!1}function wrapMenuOption(selection){var option=new menuService.MenuOption(selection),insertAfter=option.insertAfter;return option.insertAfter=function(after,name,label,handler){var wrap=function(file){$q.when(handler(file)).then(function(retValue){retValue&&explorer.hint(retValue,"success")}).catch(function(retValue){retValue&&explorer.hint(retValue,"error")})};return insertAfter.call(option,after,name,label,wrap)},option}function enterDemo(){tracker.event("lab_demo_mode","click"),$rootScope.$broadcast("lab.enterDemo");var el=document.documentElement,rfs=el.requestFullScreen||el.webkitRequestFullScreen||el.mozRequestFullScreen;rfs.call(el),demoService.invoke()}var storage=storageMgr.forAll(),showDemoTips=storage.get(LOCAL_STORAGE_KEY.DISABLE_DEMO_TIPS);scope.showDemoTips=showDemoTips?!1:!0,scope.$watch("file",onFileChanged),scope.triggerHandler=triggerHandler,scope.togglePanel=togglePanel,scope.triggerShare=triggerShare,scope.disableDemoTips=disableDemoTips,scope.openNewPage=openNewPage,scope.clientProxy=clientProxy,scope.enterDemoMode=enterDemo,scope.toggleMeta=toggleMeta,scope.openRevision=explorer.openRevision,scope.$on("group.myRole.changed",function(){scope.dropdownMenu=removeMoreSplits(getMenuOption(scope.file))}),scope.$on(SHARE_EVENTS.SHARE,function(event,json){scope.file&&json.file.id==scope.file.id&&(scope.file.shareEntry=json.shareEntry,scope.dropdownMenu=removeMoreSplits(getMenuOption(scope.file)))}),scope.$on(SHARE_EVENTS.UNSHARE,function(event,file){scope.file&&file.id==scope.file.id&&(scope.file.shareEntry=void 0,scope.dropdownMenu=removeMoreSplits(getMenuOption(scope.file)))})}return{link:link,replace:!0,templateUrl:"pagelet/file/detail/tools.html",scope:{file:"=fileDetailTools",close:"&toolsClose",openWindow:"=toolsOpenWindow",mode:"=mode",saving:"=saving",showInfoRevision:"=showInfoRevision",tableVersion:"=tableVersion"}}}}),define("pagelet/file/detail/defaultCtrl",[],function(){"use strict";return function($scope,$location,fileMgr,viewport,explorer){function onOpenFolder(fileId){explorer.locateFile(fileId)}$scope.download=fileMgr.download,$scope.preview=explorer.preview,$scope.ableToPreview=explorer.ableToPreview,$scope.edit=explorer.edit,$scope.ableToEdit=explorer.ableToEdit,$scope.onOpenFolder=onOpenFolder}}),define("pagelet/file/comment/msg/message",[],function(){"use strict";return function($scope){var message;message=$scope.message.data,$scope.commentMsg=message}}),define("pagelet/file/directive/open",["util/trackTiming"],function(trackTiming){"use strict";return function($parse,explorer){function compile(el,attr){var fileExpr=$parse(attr.fileOpen),groupIdExpr=$parse(attr.groupId),fileIdExpr=$parse(attr.fileId),fileNameExpr=$parse(attr.fileName),versionExpr=$parse(attr.fileVersion||"");return function(scope,el){var file=fileExpr(scope),groupId=groupIdExpr(scope),fileId=fileIdExpr(scope),fileName=fileNameExpr(scope),version=versionExpr(scope);fileName=fileName||file.name,el.click(function(){if((fileId||file)&&groupId){if(fileName){var label="groupId-"+groupId+":fileId-"+fileId;/\.table$/.test(fileName)?trackTiming.openTable.setLabel(label).start():/\.(doc|docx|ppt|pptx|xls|xlsx)$/i.test(fileName)?trackTiming.openOffice.setLabel(label).start():/\.note$/.test(fileName)&&trackTiming.openNote.setLabel(label).start()}scope.$apply(function(){file?explorer.openFile(file):explorer.openFile(Number(fileId),version)})}})}}return{restrict:"A",compile:compile}}}),define("pagelet/file/directive/openExistDir",[],function(){"use strict";return function($parse,explorer){function compile(el,attr){var fileIdExpr=$parse(attr.fileId);return function(scope,el){var fileId=fileIdExpr(scope);el.click(function(e){e.stopPropagation(),explorer.locateFile(fileId)})}}return{restrict:"A",compile:compile}}}),define("pagelet/file/directive/openRevision",[],function(){"use strict";return function($parse,explorer,fileMgr,dialogs){function compile(el,attr){var fileIdExpr=$parse(attr.fileId),groupIdExpr=$parse(attr.groupId),versionExpr=$parse(attr.fileVersion||"");return function(scope,el){var groupId=groupIdExpr(scope),fileId=fileIdExpr(scope),version=versionExpr(scope);el.click(function(){fileMgr.getFile(groupId,fileId).then(function(file){explorer.openRevision(file,version)}).catch(function(e){e&&"260"===e.error?dialogs.alert("打开文件","无法打开该文件，仅群管理员或群主可打开"):dialogs.alert("打开文件","文件已被删除")})})}}return{restrict:"A",compile:compile}}}),define("pagelet/file/directive/openComment",[],function(){"use strict";return function($parse,explorer){function compile(el,attr){var groupIdExpr=$parse(attr.groupId),fileIdExpr=$parse(attr.fileId),versionExpr=$parse(attr.fileVersion||""),commentIdExpr=($parse(attr.fileName),$parse(attr.commentId));return function(scope,el){var groupId=groupIdExpr(scope),fileId=fileIdExpr(scope),version=versionExpr(scope),commentId=commentIdExpr(scope);el.click(function(){fileId&&groupId&&commentId&&scope.$apply(function(){explorer.openFile(Number(fileId),version,{commentId:commentId})})})}}return{restrict:"A",compile:compile}}}),define("util/mime",[],function(){"use strict";return{pdf:"pdf",txt:"txt",text:"txt",doc:"word",docx:"word",rtf:"word",excel:"excel",xls:"excel",xlsx:"excel",csv:"excel",ppt:"ppt",pps:"ppt",pptx:"ppt",ppsx:"ppt",flash:"flash",swf:"flash",flv:"flash",compress:"compress",zip:"compress",rar:"compress","7z":"compress",html:"html",htm:"html",mht:"html",audio:"audio",mp3:"audio",aac:"audio",ogg:"audio",wav:"audio",flac:"audio",m4a:"audio",ape:"audio",wma:"audio",video:"video",rm:"video",rmvb:"video",avi:"video",mkv:"video",mpg:"video",mpeg:"video",wmv:"video",ts:"video",m4v:"video",mp4:"video",image:"image",jpg:"image",jpeg:"image",gif:"image",png:"image",bmp:"image",psd:"image",svg:"image",note:"note",table:"table",md:"md"}}),define("pagelet/file/directive/icon",["underscore","util/mime","jquery","bower_components/util/src/cookies"],function(_,mime,$,cookies){"use strict";var previewImageCls="icon-image",previewExt=["jpg","jpeg","png","bmp","gif"];return function(){function link(scope,el,attr){function parseTypeAndClass(file,size,grey){ext=file.name?file.name.toLowerCase().substring(file.name.lastIndexOf(".")+1):"",type=mime[ext],cls=""===size?"file_icon":"file_icon_"+size,el.html('<svg class="'+cls+'"><use xlink:href="#type_'+(type?type:"other")+(size?"_"+size:"")+(grey?"_grey":"")+'"/></svg>')}function createImage(gid,id,version){return version||(version=-1),"/yws/api/group/"+gid+"/file/"+id+"?method=getImage&width=32&height=32&version="+version+"&cstk="+cookies.get("YNOTE_CSTK")}function onImageLoad(){el.html(""),el.append(this),el.find("img").css("vertical-align","middle"),el.addClass(previewImageCls)}var ext,type,cls,imgEl,tempgid,tempfileId,tempfileVersion,expr=attr.fileIcon,size=attr.fileSize||"",grey=!!attr.fileGrey;scope.$watchCollection(expr,function(file){if(file){if(file.isFolder){cls=""===size?"folder_icon":"folder_icon_"+size;var svgName=file.isOnlyManagerView?"manager_view_folder":file.isOnlyManagerEdit?"read_only_folder":"type_folder"+(size?"_"+size:"")+(grey?"_grey":"");return void el.html('<svg class="'+cls+'"><use xlink:href="#'+svgName+'"/></svg>')}if((_.isUndefined(file.gid)||file.gid!==tempgid||file.id!==tempfileId||tempfileVersion!==file.version)&&(ext="",parseTypeAndClass(file,size,grey),file.gid=file.gid?file.gid:file.groupId,tempgid=file.gid,tempfileId=file.id,tempfileVersion=file.version,"small"!==size&&-1!==previewExt.indexOf(ext)&&file.gid&&file.id)){var imgTag='<img src="'+createImage(file.gid,file.id,file.version)+'" />';imgEl&&imgEl.remove(),imgEl=$(imgTag).on("load",onImageLoad)}}}),scope.$on("$destroy",function(){imgEl&&imgEl.remove()})}return{restrict:"A",link:link}}}),define("pagelet/file/filter/action",[],function(){"use strict";return function(){return function(file){return file?file.isFolder?file.lastModifiedDate.getTime()==file.createDate.getTime()?"创建":"修改":1==file.version?"创建":"修改":void 0}}}),define("pagelet/file/filter/size",[],function(){"use strict";return function(){var TEXT=["字节","KB","MB","GB","TB"];return function(size){var t=0;for(size=size||0;size>=1024&&3>t;)t++,size/=1024;return String(Math.floor(100*size)/100)+" "+TEXT[t]}}}),define("pagelet/file/filter/modifier",[],function(){"use strict";return function(){return function(file,fileType){return file?file.isFolder?file.lastModifiedDate.getTime()==file.createDate.getTime()?file.creator:"lastUpdater"===fileType?file.lastUpdater:file.modifier:"deleter"===fileType?file.modifier:"lastUpdater"===fileType?file.lastUpdater:1===file.version?file.creator:file.modifier:void 0}}}),define("pagelet/file/filter/date",[],function(){"use strict";return function(){return function(file,fileType){return file?"favoriteDate"===fileType?file.favoriteDate:"messageTime"===fileType?file.time:file.lastModifiedDate:void 0}}}),define("pagelet/file/filter/name",["underscore"],function(_){"use strict";return function(){return function(name){return _.isString(name)?name.replace(/\\\//g,"/"):""}}}),define("pagelet/file/filter/modifyTime",[],function(){"use strict";return function(){return function(file){return 1==file.version?file.createDate:file.lastModifiedDate}}}),define("pagelet/file/cmd/move",["underscore"],function(){"use strict";return function($injector,gid,files,to){function execute(){return defer&&defer.reject(),defer=$q.defer(),setTimeout(function(){moveNext(to,remain,finished)}),defer.promise}function rollback(){return $q.reject()}function moveNext(target,fromList,toList){function doChain(newFile){toList.push(newFile),moveNext(target,fromList,toList)}function error(e){e&&"20108"==e.error?onConflict(e):(exception=e,defer.reject(command))}function onConflict(e){dialogs.confirm("移动到",file.isFolder?"您的目标目录中有重名文件夹，请先重命名后再移动。":"您的目标目录中有重名文件，请先重命名后再移动。",{width:file.isFolder?360:340,ok:"自动重命名"}).then(function(){fileMgr.moveAndRename(gid,file,target,e.adviceName).then(doChain).catch(error)}).catch(function(){defer.reject(command)})}return 0==fromList.length?(file=null,void defer.resolve(command)):(exception=null,file=fromList.shift(),defer.notify(command),void fileMgr.move(gid,file,target).then(doChain).catch(error))}var command,fileMgr=$injector.get("fileManager"),$q=$injector.get("$q"),dialogs=$injector.get("dialogService"),defer=null,file=null,finished=[],exception=null,remain=[].concat(files);return command={gid:function(){return gid},target:function(){return to},file:function(){return file},files:function(){return files},finished:function(){return finished},exception:function(){return exception},execute:execute,rollback:rollback}}}),define("util/fileValidator",[],function(){"use strict";return function(name,allowEmpty){return allowEmpty||name&&0!==name.replace(/\..+$/,"").length?/[\\\/:*?"<>|]/.test(name)?'文件名含有不合法字符，请修改后再试。不合法字符包括\\ / : * ? " < > | ':void 0:"文件名不能为空"}}),define("pagelet/file/cmd/create",["underscore","util/fileValidator"],function(_,validator){"use strict";return function($injector,gid,name,folder){function execute(){function success(newFile){file=newFile,defer.resolve(command)}function error(e){exception=e,defer.reject(command)}var err;return defer&&defer.reject(),defer=$q.defer(),(err=validator(name))?(exception=err,$q.reject(command)):(fileMgr.newFolder(gid,name,folder).then(success).catch(error),defer.promise)}function rollback(){return $q.reject()}var command,fileMgr=$injector.get("fileManager"),$q=$injector.get("$q"),file=($injector.get("dialogService"),null),defer=null,exception=null;return name=name.trim(),command={gid:function(){return gid},file:function(){return file},folder:function(){return folder},name:function(){return name},exception:function(){return exception},execute:execute,rollback:rollback}}}),define("pagelet/file/cmd/rename",["underscore","util/fileValidator"],function(_,validator){"use strict";return function($injector,gid,file,name){function execute(){function post(){fileMgr.rename(gid,file,name).then(function(newFile){file=newFile,defer.resolve(command)}).catch(function(e){exception=e,defer.reject(command)})}function cancel(){defer.reject(!1)}var err;return defer&&defer.reject(),defer=$q.defer(),err=validator(name),err?(exception=err,defer.reject(command)):file.isFolder||extName(name)===extName(file.name)?post():dialogs.confirm("重命名","改变扩展名会导致文件/笔记不可用，您确定要更改吗？").then(post).catch(cancel),defer.promise}function rollback(){return $q.reject()}function extName(name){var ext=name.match(/\.\w+?$/);if(null!==ext)return ext[0]}var command,fileMgr=$injector.get("fileManager"),$q=$injector.get("$q"),dialogs=$injector.get("dialogService"),defer=null,exception=null;return name=name.trim(),command={gid:function(){return gid},file:function(){return file},name:function(){return name},exception:function(){return exception},execute:execute,rollback:rollback}}}),define("pagelet/file/cmd/remove",["underscore"],function(){"use strict";return function($injector,gid,files){function execute(){return defer&&defer.reject(),defer=$q.defer(),setTimeout(function(){removeNext()}),defer.promise}function rollback(){return $q.reject()}function removeNext(){function onError(e){exception=e,defer.reject(command)}return 0==remain.length?(file=null,void defer.resolve(command)):(exception=null,file=remain.shift(),defer.notify(command),void fileMgr.remove(gid,file).then(function(){finished.push(file),removeNext()}).catch(onError))}var command,fileMgr=$injector.get("fileManager"),$q=$injector.get("$q"),defer=($injector.get("dialogService"),null),file=null,exception=null,remain=[].concat(files),finished=[];return command={gid:function(){return gid},file:function(){return file},files:function(){return files},finished:function(){return finished},exception:function(){return exception},execute:execute,rollback:rollback}}}),define("pagelet/file/cmd/restore",["underscore"],function(){"use strict";return function($injector,gid,files){function execute(){return defer&&defer.reject(),defer=$q.defer(),setTimeout(function(){restoreNext()}),defer.promise}function rollback(){return $q.reject()}function restoreNext(){function onError(e){exception=e,e&&"20108"===e.error?dialogs.confirm("还原","您将还原的路径已存在同名的文件或文件夹。要重命名当前文件并还原吗？",{ok:"自动重命名"}).then(function(){trashService.restoreFile(gid,file,e.adviceName).then(function(){finished.push(file),restoreNext()}).catch(onError)},function(){defer.reject(command)}):defer.reject(command)}return 0==remain.length?(file=null,void defer.resolve(command)):(exception=null,file=remain.shift(),defer.notify(command),void trashService.restoreFile(gid,file).then(function(){finished.push(file),restoreNext()}).catch(onError))}var command,trashService=$injector.get("trashService"),$q=$injector.get("$q"),dialogs=$injector.get("dialogService"),defer=null,file=null,exception=null,remain=[].concat(files),finished=[];return command={gid:function(){return gid},file:function(){return file},files:function(){return files},finished:function(){return finished},exception:function(){return exception},execute:execute,rollback:rollback}}}),define("pagelet/file/cmd/deleteTrash",["underscore"],function(){"use strict";return function($injector,gid,files){function execute(){return defer&&defer.reject(),defer=$q.defer(),setTimeout(function(){deleteNext()}),defer.promise}function rollback(){return $q.reject()}function deleteNext(){function onError(e){exception=e,defer.reject(command)}return 0==remain.length?(file=null,void defer.resolve(command)):(exception=null,file=remain.shift(),defer.notify(command),void trashService.eraseTrash(gid,file).then(function(){finished.push(file),deleteNext()}).catch(onError))}var command,trashService=$injector.get("trashService"),$q=$injector.get("$q"),defer=($injector.get("dialogService"),null),file=null,exception=null,remain=[].concat(files),finished=[];return command={gid:function(){return gid},file:function(){return file},files:function(){return files},finished:function(){return finished},exception:function(){return exception},execute:execute,rollback:rollback}}}),define("pagelet/file/cmd/copy",["underscore"],function(){"use strict";return function($injector,gid,files,dstFolder){function execute(){return defer&&defer.reject(),defer=$q.defer(),setTimeout(function(){copyNext()}),defer.promise}function rollback(){return $q.reject()}function copyNext(){function doChain(file){finished.push(file),copyNext()
}function onError(e){e&&"20108"==e.error?onConflict(e):(exception=e,defer.reject(command))}function onConflict(e){dialogs.confirm("复制到其他群","您的目标目录中有重名文件，请先重命名后再复制。",{ok:"自动重命名"}).then(function(){fileMgr.copyTo(file,gid,dstFolder.gid,parseInt(dstFolder.id),e.adviceName).then(doChain).catch(onError)}).catch(function(){copyNext()})}return 0==remain.length?(file=null,void defer.resolve(command)):(exception=null,file=remain.shift(),defer.notify(command),void fileMgr.copyTo(file,gid,dstFolder.gid,parseInt(dstFolder.id)).then(doChain).catch(onError))}var command,fileMgr=$injector.get("fileManager"),$q=$injector.get("$q"),dialogs=$injector.get("dialogService"),defer=null,file=null,finished=[],exception=null,remain=[].concat(files);return command={gid:function(){return gid},target:function(){return dstFolder},file:function(){return file},files:function(){return files},finished:function(){return finished},exception:function(){return exception},execute:execute,rollback:rollback}}}),define("pagelet/file/cmd/copyFolder",["underscore"],function(){"use strict";return function($injector,gid,files,dstFolder){function execute(){return defer&&defer.reject(),defer=$q.defer(),setTimeout(function(){copyNext()}),defer.promise}function rollback(){return $q.reject()}function copyNext(){function doCopy(copyId,adviceName){fileMgr.copyFolderTo(file,gid,dstFolder.gid,parseInt(dstFolder.id),adviceName,copyId).then(doChain,onError,progress)}function doChain(file){percent=100,defer.notify(command),finished.push(file),copyNext()}function onError(e){e&&"20108"==e.error?onConflict(e):(exception=e,defer.reject(command))}function progress(status){percent=status,defer.notify(command)}function onConflict(e){dialogs.confirm("复制到其他群","您的目标目录中有重名文件夹，请先重命名后再复制。",{ok:"自动重命名"}).then(function(){fileMgr.getCopyId(file,gid,dstFolder.gid,parseInt(dstFolder.id)).then(function(copyId){fileMgr.copyFolderTo(file,gid,dstFolder.gid,parseInt(dstFolder.id),e.adviceName,copyId).then(doChain,onError,progress)}).catch(onError)}).catch(function(){percent=100,defer.notify(command),finished.push(null),copyNext()})}return 0==remain.length?(file=null,void defer.resolve(command)):(exception=null,file=remain.shift(),percent=0,defer.notify(command),void fileMgr.getCopyId(file,gid,dstFolder.gid,parseInt(dstFolder.id)).then(doCopy).catch(onError))}var command,fileMgr=$injector.get("fileManager"),$q=$injector.get("$q"),dialogs=$injector.get("dialogService"),defer=null,file=null,finished=[],exception=null,remain=[].concat(files),percent=0;return command={gid:function(){return gid},target:function(){return dstFolder},file:function(){return file},files:function(){return files},finished:function(){return finished},exception:function(){return exception},percent:function(){return percent},execute:execute,rollback:rollback}}}),define("pagelet/file/cmd/executor",["underscore","pagelet/file/cmd/move","pagelet/file/cmd/create","pagelet/file/cmd/rename","pagelet/file/cmd/remove","pagelet/file/cmd/restore","pagelet/file/cmd/deleteTrash","pagelet/file/cmd/copy","pagelet/file/cmd/copyFolder"],function(_,move,create,rename,remove,restore,deleteTrash,copy,copyFolder){"use strict";return function($injector){function factoryMethod(name,args){var constr=def[name];if(!_.isFunction(constr))throw'Cannot find command "'+name+'"';return constr.apply(null,[$injector].concat(args))}function execute(name,args){var cmd=factoryMethod(name,args);return cmd.execute().then(logUndoStack)}function logUndoStack(cmd){return undoStack.push(cmd),redoStack=[],cmd}function undo(){return undoStack.pop().rollback().then(function(cmd){return redoStack.push(cmd),cmd}).catch(function(cmd){return undoStack.push(cmd),$q.reject(cmd)})}function redo(){return redoStack.pop().execute().then(function(cmd){return undoStack.push(cmd),cmd}).catch(function(cmd){return redoStack.push(cmd),$q.reject(cmd)})}var def={move:move,create:create,rename:rename,remove:remove,restore:restore,deleteTrash:deleteTrash,copy:copy,copyFolder:copyFolder},undoStack=[],redoStack=[],$q=$injector.get("$q");return{execute:execute,redo:redo,undo:undo}}}),define("pagelet/file/share/shareService",["underscore","util/trackTiming"],function(_,trackTiming){return function($http,$q,$location,$rootScope,launcher){function ShareFile(fileModel,shareEntry,sharer){var token=shareEntry.token?String(shareEntry.token):null,groupId=String(fileModel.groupId);return{name:String(fileModel.name),id:String(fileModel.fileId),isFolder:fileModel.dir?Boolean(fileModel.dir):!1,isOnlyManagerEdit:!Boolean(1&fileModel.authCode),isOnlyManagerView:!Boolean(2&fileModel.authCode),token:token,sharer:sharer,shareTime:new Date(shareEntry.shareTime||0),groupId:groupId,link:$location.protocol()+"://"+$location.host()+"/groupshare/?token="+token+"&gid="+groupId}}var sharedFilesCache=[],sharedFilesCacheIncludingRemoved=[],preGid=null;this.startShare=function(gid,fileId){return trackTiming.startShare.start(),$http.get("/yws/api/group/"+gid+"/share/"+fileId,{params:{method:"share"}}).then(function(res){trackTiming.startShare.end().setLabel("success").send().clear();var shareFile=new ShareFile(res.data.fileModel,res.data.shareEntry,res.data.sharer);return _.isUndefined(_.findWhere(sharedFilesCache,{id:shareFile.id}))?sharedFilesCache.unshift(shareFile):_.extend(_.findWhere(sharedFilesCache,{id:shareFile.id}),shareFile),sharedFilesCacheIncludingRemoved=sharedFilesCache,shareFile})},this.stopShare=function(gid,fileId){return trackTiming.stopShare.start(),$http.get("/yws/api/group/"+gid+"/share/"+fileId,{params:{method:"unshare"}}).then(function(){trackTiming.stopShare.end().setLabel("success").send().clear(),sharedFilesCache=_.reject(sharedFilesCache,function(shareFile){return shareFile.id==fileId}),sharedFilesCacheIncludingRemoved=sharedFilesCache})},this.getShareFile=function(gid,shareToken){return trackTiming.getShareFile.start(),$http.get("/yws/api/group/"+gid+"/share",{params:{method:"get",shareToke:shareToken}}).then(function(data){return trackTiming.getShareFile.end().setLabel("success").send().clear(),new File(data)})},this.listShareFiles=function(gid){var deferred=$q.defer();if(gid===preGid)deferred.resolve(sharedFilesCache);else{var i=Math.random();trackTiming.listShareFiles.start(i),$http.get("/yws/api/group/"+gid+"/share",{params:{method:"list"}}).success(function(res){trackTiming.listShareFiles.end(i).setLabel("success").send().clear(i);var result=_.map(res,function(json){return new ShareFile(json.fileModel,json.shareEntry,json.sharer)});preGid=gid,sharedFilesCache=result,sharedFilesCacheIncludingRemoved=sharedFilesCache,deferred.resolve(result)}).error(function(e){trackTiming.listShareFiles.end(i).setLabel("error").send().clear(i),deferred.reject(e)})}return deferred.promise},this.getSharedFiles=function(){return sharedFilesCache},this.getShareFilesIncludingRemoved=function(){return sharedFilesCacheIncludingRemoved},$rootScope.$on("file.remove",function($evt,file){file.gid==launcher.gid()&&(sharedFilesCache=_.reject(sharedFilesCache,function(shareFile){return shareFile.id==file.id}))}),$rootScope.$on("file.share",function($evt,file,shareEntry,sharer){if(file.gid==launcher.gid()){var shareFile=new ShareFile({name:file.name,groupId:file.gid,fileId:file.id,dir:file.isFolder},shareEntry,sharer);_.isUndefined(_.findWhere(sharedFilesCache,{id:shareFile.id}))?sharedFilesCache.unshift(shareFile):_.extend(_.findWhere(sharedFilesCache,{id:shareFile.id}),shareFile),sharedFilesCacheIncludingRemoved=sharedFilesCache}}),$rootScope.$on("file.unshare",function($evt,file){file.gid==launcher.gid()&&(sharedFilesCache=_.reject(sharedFilesCache,function(shareFile){return shareFile.id==file.id}),sharedFilesCacheIncludingRemoved=sharedFilesCache)}),$rootScope.$on("file.recover",function($evt,file){if(file.gid==launcher.gid()){var relatedFileShareEntry=_.findWhere(sharedFilesCacheIncludingRemoved,{id:String(file.id)});relatedFileShareEntry&&sharedFilesCache.push(relatedFileShareEntry)}}),this.ShareFile=ShareFile}}),function(r){r.fn.qrcode=function(h){function u(a){this.mode=s,this.data=a}function o(a,c){this.typeNumber=a,this.errorCorrectLevel=c,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function q(a,c){if(void 0==a.length)throw Error(a.length+"/"+c);for(var d=0;d<a.length&&0==a[d];)d++;this.num=Array(a.length-d+c);for(var b=0;b<a.length-d;b++)this.num[b]=a[b+d]}function p(a,c){this.totalCount=a,this.dataCount=c}function t(){this.buffer=[],this.length=0}var s;u.prototype={getLength:function(){return this.data.length},write:function(a){for(var c=0;c<this.data.length;c++)a.put(this.data.charCodeAt(c),8)}},o.prototype={addData:function(a){this.dataList.push(new u(a)),this.dataCache=null},isDark:function(a,c){if(0>a||this.moduleCount<=a||0>c||this.moduleCount<=c)throw Error(a+","+c);return this.modules[a][c]},getModuleCount:function(){return this.moduleCount},make:function(){if(1>this.typeNumber){for(var a=1,a=1;40>a;a++){for(var c=p.getRSBlocks(a,this.errorCorrectLevel),d=new t,b=0,e=0;e<c.length;e++)b+=c[e].dataCount;for(e=0;e<this.dataList.length;e++)c=this.dataList[e],d.put(c.mode,4),d.put(c.getLength(),j.getLengthInBits(c.mode,a)),c.write(d);if(d.getLengthInBits()<=8*b)break}this.typeNumber=a}this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,c){this.moduleCount=4*this.typeNumber+17,this.modules=Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++){this.modules[d]=Array(this.moduleCount);for(var b=0;b<this.moduleCount;b++)this.modules[d][b]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(a,c),7<=this.typeNumber&&this.setupTypeNumber(a),null==this.dataCache&&(this.dataCache=o.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,c)},setupPositionProbePattern:function(a,c){for(var d=-1;7>=d;d++)if(!(-1>=a+d||this.moduleCount<=a+d))for(var b=-1;7>=b;b++)-1>=c+b||this.moduleCount<=c+b||(this.modules[a+d][c+b]=d>=0&&6>=d&&(0==b||6==b)||b>=0&&6>=b&&(0==d||6==d)||d>=2&&4>=d&&b>=2&&4>=b?!0:!1)},getBestMaskPattern:function(){for(var a=0,c=0,d=0;8>d;d++){this.makeImpl(!0,d);var b=j.getLostPoint(this);(0==d||a>b)&&(a=b,c=d)}return c},createMovieClip:function(a,c,d){for(a=a.createEmptyMovieClip(c,d),this.make(),c=0;c<this.modules.length;c++)for(var d=1*c,b=0;b<this.modules[c].length;b++){var e=1*b;this.modules[c][b]&&(a.beginFill(0,100),a.moveTo(e,d),a.lineTo(e+1,d),a.lineTo(e+1,d+1),a.lineTo(e,d+1),a.endFill())}return a},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2);for(a=8;a<this.moduleCount-8;a++)null==this.modules[6][a]&&(this.modules[6][a]=0==a%2)},setupPositionAdjustPattern:function(){for(var a=j.getPatternPosition(this.typeNumber),c=0;c<a.length;c++)for(var d=0;d<a.length;d++){var b=a[c],e=a[d];if(null==this.modules[b][e])for(var f=-2;2>=f;f++)for(var i=-2;2>=i;i++)this.modules[b+f][e+i]=-2==f||2==f||-2==i||2==i||0==f&&0==i?!0:!1}},setupTypeNumber:function(a){for(var c=j.getBCHTypeNumber(this.typeNumber),d=0;18>d;d++){var b=!a&&1==(c>>d&1);this.modules[Math.floor(d/3)][d%3+this.moduleCount-8-3]=b}for(d=0;18>d;d++)b=!a&&1==(c>>d&1),this.modules[d%3+this.moduleCount-8-3][Math.floor(d/3)]=b},setupTypeInfo:function(a,c){for(var d=j.getBCHTypeInfo(this.errorCorrectLevel<<3|c),b=0;15>b;b++){var e=!a&&1==(d>>b&1);6>b?this.modules[b][8]=e:8>b?this.modules[b+1][8]=e:this.modules[this.moduleCount-15+b][8]=e}for(b=0;15>b;b++)e=!a&&1==(d>>b&1),8>b?this.modules[8][this.moduleCount-b-1]=e:9>b?this.modules[8][15-b-1+1]=e:this.modules[8][15-b-1]=e;this.modules[this.moduleCount-8][8]=!a},mapData:function(a,c){for(var d=-1,b=this.moduleCount-1,e=7,f=0,i=this.moduleCount-1;i>0;i-=2)for(6==i&&i--;;){for(var g=0;2>g;g++)if(null==this.modules[b][i-g]){var n=!1;f<a.length&&(n=1==(a[f]>>>e&1)),j.getMask(c,b,i-g)&&(n=!n),this.modules[b][i-g]=n,e--,-1==e&&(f++,e=7)}if(b+=d,0>b||this.moduleCount<=b){b-=d,d=-d;break}}}},o.PAD0=236,o.PAD1=17,o.createData=function(a,c,d){for(var c=p.getRSBlocks(a,c),b=new t,e=0;e<d.length;e++){var f=d[e];b.put(f.mode,4),b.put(f.getLength(),j.getLengthInBits(f.mode,a)),f.write(b)}for(e=a=0;e<c.length;e++)a+=c[e].dataCount;if(b.getLengthInBits()>8*a)throw Error("code length overflow. ("+b.getLengthInBits()+">"+8*a+")");for(b.getLengthInBits()+4<=8*a&&b.put(0,4);0!=b.getLengthInBits()%8;)b.putBit(!1);for(;!(b.getLengthInBits()>=8*a)&&(b.put(o.PAD0,8),!(b.getLengthInBits()>=8*a));)b.put(o.PAD1,8);return o.createBytes(b,c)},o.createBytes=function(a,c){for(var d=0,b=0,e=0,f=Array(c.length),i=Array(c.length),g=0;g<c.length;g++){var n=c[g].dataCount,h=c[g].totalCount-n,b=Math.max(b,n),e=Math.max(e,h);f[g]=Array(n);for(var k=0;k<f[g].length;k++)f[g][k]=255&a.buffer[k+d];for(d+=n,k=j.getErrorCorrectPolynomial(h),n=new q(f[g],k.getLength()-1).mod(k),i[g]=Array(k.getLength()-1),k=0;k<i[g].length;k++)h=k+n.getLength()-i[g].length,i[g][k]=h>=0?n.get(h):0}for(k=g=0;k<c.length;k++)g+=c[k].totalCount;for(d=Array(g),k=n=0;b>k;k++)for(g=0;g<c.length;g++)k<f[g].length&&(d[n++]=f[g][k]);for(k=0;e>k;k++)for(g=0;g<c.length;g++)k<i[g].length&&(d[n++]=i[g][k]);return d},s=4;for(var j={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var c=a<<10;0<=j.getBCHDigit(c)-j.getBCHDigit(j.G15);)c^=j.G15<<j.getBCHDigit(c)-j.getBCHDigit(j.G15);return(a<<10|c)^j.G15_MASK},getBCHTypeNumber:function(a){for(var c=a<<12;0<=j.getBCHDigit(c)-j.getBCHDigit(j.G18);)c^=j.G18<<j.getBCHDigit(c)-j.getBCHDigit(j.G18);return a<<12|c},getBCHDigit:function(a){for(var c=0;0!=a;)c++,a>>>=1;return c},getPatternPosition:function(a){return j.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,c,d){switch(a){case 0:return 0==(c+d)%2;case 1:return 0==c%2;case 2:return 0==d%3;case 3:return 0==(c+d)%3;case 4:return 0==(Math.floor(c/2)+Math.floor(d/3))%2;case 5:return 0==c*d%2+c*d%3;case 6:return 0==(c*d%2+c*d%3)%2;case 7:return 0==(c*d%3+(c+d)%2)%2;default:throw Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){for(var c=new q([1],0),d=0;a>d;d++)c=c.multiply(new q([1,l.gexp(d)],0));return c},getLengthInBits:function(a,c){if(c>=1&&10>c)switch(a){case 1:return 10;case 2:return 9;case s:return 8;case 8:return 8;default:throw Error("mode:"+a)}else if(27>c)switch(a){case 1:return 12;case 2:return 11;case s:return 16;case 8:return 10;default:throw Error("mode:"+a)}else{if(!(41>c))throw Error("type:"+c);switch(a){case 1:return 14;case 2:return 13;case s:return 16;case 8:return 12;default:throw Error("mode:"+a)}}},getLostPoint:function(a){for(var c=a.getModuleCount(),d=0,b=0;c>b;b++)for(var e=0;c>e;e++){for(var f=0,i=a.isDark(b,e),g=-1;1>=g;g++)if(!(0>b+g||b+g>=c))for(var h=-1;1>=h;h++)0>e+h||e+h>=c||0==g&&0==h||i==a.isDark(b+g,e+h)&&f++;f>5&&(d+=3+f-5)}for(b=0;c-1>b;b++)for(e=0;c-1>e;e++)f=0,a.isDark(b,e)&&f++,a.isDark(b+1,e)&&f++,a.isDark(b,e+1)&&f++,a.isDark(b+1,e+1)&&f++,(0==f||4==f)&&(d+=3);for(b=0;c>b;b++)for(e=0;c-6>e;e++)a.isDark(b,e)&&!a.isDark(b,e+1)&&a.isDark(b,e+2)&&a.isDark(b,e+3)&&a.isDark(b,e+4)&&!a.isDark(b,e+5)&&a.isDark(b,e+6)&&(d+=40);for(e=0;c>e;e++)for(b=0;c-6>b;b++)a.isDark(b,e)&&!a.isDark(b+1,e)&&a.isDark(b+2,e)&&a.isDark(b+3,e)&&a.isDark(b+4,e)&&!a.isDark(b+5,e)&&a.isDark(b+6,e)&&(d+=40);for(e=f=0;c>e;e++)for(b=0;c>b;b++)a.isDark(b,e)&&f++;return a=Math.abs(100*f/c/c-50)/5,d+10*a}},l={glog:function(a){if(1>a)throw Error("glog("+a+")");return l.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;a>=256;)a-=255;return l.EXP_TABLE[a]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},m=0;8>m;m++)l.EXP_TABLE[m]=1<<m;for(m=8;256>m;m++)l.EXP_TABLE[m]=l.EXP_TABLE[m-4]^l.EXP_TABLE[m-5]^l.EXP_TABLE[m-6]^l.EXP_TABLE[m-8];for(m=0;255>m;m++)l.LOG_TABLE[l.EXP_TABLE[m]]=m;return q.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var c=Array(this.getLength()+a.getLength()-1),d=0;d<this.getLength();d++)for(var b=0;b<a.getLength();b++)c[d+b]^=l.gexp(l.glog(this.get(d))+l.glog(a.get(b)));return new q(c,0)},mod:function(a){if(0>this.getLength()-a.getLength())return this;for(var c=l.glog(this.get(0))-l.glog(a.get(0)),d=Array(this.getLength()),b=0;b<this.getLength();b++)d[b]=this.get(b);for(b=0;b<a.getLength();b++)d[b]^=l.gexp(l.glog(a.get(b))+c);return new q(d,0).mod(a)}},p.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],p.getRSBlocks=function(a,c){var d=p.getRsBlockTable(a,c);if(void 0==d)throw Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+c);for(var b=d.length/3,e=[],f=0;b>f;f++)for(var h=d[3*f+0],g=d[3*f+1],j=d[3*f+2],l=0;h>l;l++)e.push(new p(g,j));return e},p.getRsBlockTable=function(a,c){switch(c){case 1:return p.RS_BLOCK_TABLE[4*(a-1)+0];case 0:return p.RS_BLOCK_TABLE[4*(a-1)+1];case 3:return p.RS_BLOCK_TABLE[4*(a-1)+2];case 2:return p.RS_BLOCK_TABLE[4*(a-1)+3]}},t.prototype={get:function(a){return 1==(this.buffer[Math.floor(a/8)]>>>7-a%8&1)},put:function(a,c){for(var d=0;c>d;d++)this.putBit(1==(a>>>c-d-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var c=Math.floor(this.length/8);this.buffer.length<=c&&this.buffer.push(0),a&&(this.buffer[c]|=128>>>this.length%8),this.length++}},"string"==typeof h&&(h={text:h}),h=r.extend({},{render:"canvas",width:256,height:256,typeNumber:-1,correctLevel:2,background:"#ffffff",foreground:"#000000"},h),this.each(function(){var a;if("canvas"==h.render){a=new o(h.typeNumber,h.correctLevel),a.addData(h.text),a.make();var c=document.createElement("canvas");c.width=h.width,c.height=h.height;for(var d=c.getContext("2d"),b=h.width/a.getModuleCount(),e=h.height/a.getModuleCount(),f=0;f<a.getModuleCount();f++)for(var i=0;i<a.getModuleCount();i++){d.fillStyle=a.isDark(f,i)?h.foreground:h.background;var g=Math.ceil((i+1)*b)-Math.floor(i*b),j=Math.ceil((f+1)*b)-Math.floor(f*b);d.fillRect(Math.round(i*b),Math.round(f*e),g,j)}}else for(a=new o(h.typeNumber,h.correctLevel),a.addData(h.text),a.make(),c=r("<table></table>").css("width",h.width+"px").css("height",h.height+"px").css("border","0px").css("border-collapse","collapse").css("background-color",h.background),d=h.width/a.getModuleCount(),b=h.height/a.getModuleCount(),e=0;e<a.getModuleCount();e++)for(f=r("<tr></tr>").css("height",b+"px").appendTo(c),i=0;i<a.getModuleCount();i++)r("<td></td>").css("width",d+"px").css("background-color",a.isDark(e,i)?h.foreground:h.background).appendTo(f);a=c,jQuery(a).appendTo(this)})}}(jQuery),define("jqueryQrcode",function(){}),define("pagelet/file/share/shareDialogCtrl",["jquery","jqueryQrcode"],function($){"use strict";return function(clientProxy,$timeout,scope){var onComplete=function(){$timeout(function(){scope.copyBtnText="复制成功",scope.copyDone=!0,$timeout(function(){scope.copyBtnText="复制链接",scope.copyDone=!1},2e3)})};scope.copyBtnText="复制链接",scope.client=clientProxy,scope.clipboardOptions={copyValue:scope.message,oncomplete:onComplete},scope.copyTextFromClient=function(){clientProxy.copyText(scope.message),onComplete()},scope.showQrcode=!1,$("#wx-qrcode").qrcode({width:130,height:130,text:scope.message})}}),define("pagelet/file/dialog/folderPropDialogCtrl",["jquery","underscore"],function($,_){"use strict";return function($scope,$q,launcher,fileMgr,executor,dialogs,ROLES){function init(){var group=launcher.getGroup(),roles=launcher.getCurrentRole();$scope.isAllowedGroup=0!=group.orgId,$scope.folderName=$scope.folder.name,$scope.isOnlyManagerEdit=$scope.folder.isOnlyManagerEdit,$scope.isOnlyManagerView=$scope.folder.isOnlyManagerView,$scope.canChangeProp=-1!==roles.indexOf(ROLES.GROUP_FOUNDER)||-1!==roles.indexOf(ROLES.GROUP_MANAGER),$scope.parentFolderIsReadOnly=$scope.parentFolder.isOnlyManagerEdit,$scope.parentFolderIsViewOnly=$scope.parentFolder.isOnlyManagerView,$scope.isAllowedGroup&&($dialog.height="200px")}function confirm(){var code=255,group=launcher.getGroup();if(0!=group.orgId&&(code-=$scope.isOnlyManagerEdit?1:0,code-=$scope.isOnlyManagerView?2:0),$scope.isOnlyManagerView===$scope.folder.isOnlyManagerView&&$scope.isOnlyManagerEdit===$scope.folder.isOnlyManagerEdit&&$scope.folderName===$scope.folder.name)return void $dialog.dismiss(null);var newFolderName=$scope.folderName===$scope.folder.name?null:$scope.folderName;fileMgr.updateFile($scope.gid,$scope.folder,newFolderName,code).then(function(){$dialog.dismiss(code)}).catch(function(error){if(_.isObject(error)&&_.isFunction(error.exception)){var e=error.exception();if(!e)return;"20108"===e.error?dialogs.alert("错误","目录中有重名文件夹，请选择其他文件夹名称。"):"260"===e.error?dialogs.alert("错误","重命名失败，该文件夹被设置为仅管理员可见"):dialogs.alert("错误","重命名错误")}else $dialog.dismiss(null)})}function cancel(){$dialog.cancel()}var $dialog=$scope.$dialog;_.extend($dialog,{buttons:[{text:"保存",cls:"primary",handler:confirm},{text:"取消",cls:"cancel",handler:cancel}]}),init()}}),define("fileModule",["angular","commonModule","pagelet/file/explorer","pagelet/file/msg/adapter","pagelet/file/list/listCtrl","pagelet/file/list/trash/recycleCtrl","pagelet/file/list/trash/trashService","pagelet/file/list/stars/starService","pagelet/file/list/stack","pagelet/file/list/editor","pagelet/file/list/noticeDirective","pagelet/file/list/table","pagelet/file/list/selection","pagelet/file/list/dragdrop","pagelet/file/list/droppable","pagelet/file/list/context","pagelet/file/list/comparator","pagelet/file/list/view","pagelet/file/list/globalStar/globalStarCtrl","pagelet/file/tree/fileTreeCtrl","pagelet/file/tree/fileTreeSelection","pagelet/file/tree/fileTreeSelectNodeCtrl","pagelet/file/msg/message","pagelet/file/revision/revisionCtrl","pagelet/file/selector/fileSelectCtrl","pagelet/file/selector/fileSelectNodeCtrl","pagelet/file/selector/copyCtrl","pagelet/file/upload/uploadService","pagelet/file/upload/uploadCtrl","pagelet/file/upload/uploaderCtrl","pagelet/file/upload/progressCtrl","pagelet/file/upload/uploaderProgressDirective","pagelet/file/detail/detailCommentDirective","pagelet/file/detail/tools","pagelet/file/detail/defaultCtrl","pagelet/file/comment/msg/message","pagelet/file/directive/open","pagelet/file/directive/openExistDir","pagelet/file/directive/openRevision","pagelet/file/directive/openComment","pagelet/file/directive/icon","pagelet/file/filter/action","pagelet/file/filter/size","pagelet/file/filter/modifier","pagelet/file/filter/date","pagelet/file/filter/name","pagelet/file/filter/modifyTime","pagelet/file/cmd/executor","pagelet/file/share/shareService","pagelet/file/share/shareDialogCtrl","pagelet/file/dialog/folderPropDialogCtrl"],function(angular,commonModule,explorer,messageAdapter,listCtrl,recycleCtrl,trashService,starService,stackDirective,editorDirective,noticeDirective,tableLayout,selectionDirective,fileDragdrop,fileDroppable,fileContextMenu,fileComparator,fileView,globalStarCtrl,fileTreeCtrl,fileTreeSelection,fileTreeSelectNodeCtrl,messageCtrl,revisionCtrl,fileSelectCtrl,fileSelectNodeCtrl,copyCtrl,uploadService,uploadCtrl,uploaderCtrl,progressCtrl,uploaderProgressDirective,detailCommentDirective,detailToolsDirective,defaultCtrl,commentMsgCtrl,openDirective,openExistDirDirective,openRevisionDirective,openCommentDirective,iconDirective,actionFilter,sizeFilter,modifierFilter,dateFilter,nameFilter,modTimeFilter,executor,shareService,shareDialogCtrl,folderPropDialogCtrl){"use strict";function register(permission,ROLES){permission.register(ROLES.GROUP_FOUNDER,["file.*"]),permission.register(ROLES.GROUP_MANAGER,["file.*"]),permission.register(ROLES.GROUP_EDITOR,["file.create","file.open","file.trace","file.download","file.preview","file.upload","file.publish","file.dropout","file.dropin","file.remove","file.edit","file.favorite","file.viewShare","file.share","file.unshare","file.rename","file.move","file.copyTo","file.viewFolderProp","file.innerLink","file.export","file.print","file.moveOrCopyTo"]),permission.register(ROLES.GROUP_READER,["file.open","file.trace","file.preview","file.download","file.publish","file.viewShare","file.favorite","file.viewFolderProp","file.innerLink","file.export","file.print"]),permission.register(ROLES.GROUP_RESTORER,["file.open","file.trace","file.preview","file.download","file.viewRecycleBin","file.viewFolderProp","file.innerLink","file.export","file.print"]),permission.register(ROLES.GROUP_VIEWER,["file.open","file.trace","file.preview","file.download","file.viewRecycleBin","file.viewShare","file.viewFolderProp","file.innerLink","file.export"]),permission.deregister(ROLES.ORG_EXPIRED,["file.create","file.create.*","file.upload","file.upload.*","file.publish","file.dropin","file.rename","file.move","file.remove","file.edit","file.restoreOrClearTrash"]),permission.register(ROLES.GROUP_FOUNDER,["comment.*"]),permission.register(ROLES.GROUP_MANAGER,["comment.*"]),permission.register(ROLES.GROUP_EDITOR,["comment.*"]),permission.register(ROLES.GROUP_READER,["comment.*"]),permission.register(ROLES.GROUP_RESTORER,["comment.read"]),permission.register(ROLES.GROUP_VIEWER,["comment.read"]),permission.deregister(ROLES.ORG_EXPIRED,["comment.send","comment.reply","comment.delete"])}return angular.module("file",[commonModule.name]).service("explorer",["$rootScope","$location","$q","fileManager","downloadService","groupService","chatService","dialogService","extension","launcher","viewport","fileMessageAdapter","executor","clientProxy","permissionService","filePermissionService","shareService","SHARE_EVENTS","router",explorer]).service("fileMessageAdapter",["$rootScope","launcher","chatTemplate","fileManager","filePermissionService","MESSAGE_TYPE",messageAdapter]).controller("explorerListCtrl",["$rootScope","$scope","$timeout","$q","$filter","explorer","fileManager","dialogService","executor","launcher","viewport","fileComparator","clientProxy","selectFileService","selectFolderService","router","storageManager","DOCUMENT_TITLE","permissionService","filePermissionService","menuService","starService","shareService","ROLES","SHARE_EVENTS","FILE_LIST_MODE","LOCAL_STORAGE_KEY",listCtrl]).controller("recycleCtrl",["$scope","$q","$filter","launcher","trashService","dialogService","explorer","executor","permissionService","fileManager","menuService","$element","$timeout","clientProxy",recycleCtrl]).controller("globalStarCtrl",["$scope","$q","$filter","launcher","starService","shareService",globalStarCtrl]).controller("fileTreeCtrl",["$scope","fileManager","launcher",fileTreeCtrl]).directive("fileTreeSelection",["$compile","$templateCache","$http","fileDragDrop","filePermissionService",fileTreeSelection]).controller("fileTreeSelectNodeCtrl",["$scope","fileManager","fileComparator","viewport","explorer",fileTreeSelectNodeCtrl]).directive("fileLayoutTable",["fileComparator",tableLayout.table]).directive("fileLayoutThead",[tableLayout.head]).directive("fileLayoutTbody",[tableLayout.body]).directive("fileSelection",["$compile","$templateCache","$http","fileDragDrop","filePermissionService",selectionDirective]).directive("fileDroppable",["$parse","$q","fileDragDrop","explorer","launcher","clientProxy","filePermissionService","uploader","dialogService","fileManager",fileDroppable]).directive("fileContextMenu",["menuService",fileContextMenu]).directive("fileView",[fileView]).service("fileComparator",["launcher","storageManager","LOCAL_STORAGE_KEY",fileComparator]).service("fileDragDrop",["$q",fileDragdrop]).directive("fileEditor",["$compile","$parse","$http","$templateCache","$q",editorDirective]).directive("notice",["$filter","launcher","noticeService",noticeDirective]).controller("fileMessageCtrl",["$scope","explorer",messageCtrl]).controller("revisionCtrl",["$scope","fileManager","dialogService","selectFileService","clientProxy","filePermissionService",revisionCtrl]).controller("fileSelectCtrl",["$scope","fileManager","$filter",fileSelectCtrl]).controller("fileSelectNodeCtrl",["$scope","fileManager","fileComparator",fileSelectNodeCtrl]).controller("copyCtrl",["$scope","$q","$timeout","fileManager","$filter","groupService","launcher","permissionService",copyCtrl]).service("uploadService",["$q","fileManager","dialogService","launcher",uploadService]).service("trashService",["$http","$q","fileManager","dialogService",trashService]).service("starService",["$http","$q","$rootScope","fileManager","launcher",starService]).controller("uploadCtrl",["$rootScope","$scope","launcher","dialogService","fileManager","$q","uploadService",uploadCtrl]).controller("uploaderCtrl",["$scope","dialogService","$q","uploadService","viewport","launcher","explorer","$location","fileManager",uploaderCtrl]).controller("progressCtrl",["$scope",progressCtrl]).directive("uploaderProgress",[uploaderProgressDirective]).directive("fileDetailTools",["$rootScope","$q","explorer","dialogService","clientProxy","executor","launcher","selectFileService","menuService","filePermissionService","$location","starService","shareService","SHARE_EVENTS","demoService","fileManager","noteManager","storageManager","LOCAL_STORAGE_KEY",detailToolsDirective]).directive("detailComment",["commentService",detailCommentDirective]).controller("defaultDetailCtrl",["$scope","$location","fileManager","viewport","explorer",defaultCtrl]).controller("commentMsgCtrl",["$scope",commentMsgCtrl]).directive("fileOpen",["$parse","explorer",openDirective]).directive("fileOpenExistDir",["$parse","explorer","viewport","fileManager","dialogService",openExistDirDirective]).directive("fileOpenRevision",["$parse","explorer","fileManager","dialogService",openRevisionDirective]).directive("openComment",["$parse","explorer",openCommentDirective]).directive("fileIcon",["$http",iconDirective]).directive("fileStack",["$parse","$compile","fileDragDrop",stackDirective]).service("shareService",["$http","$q","$location","$rootScope","launcher",shareService]).controller("shareDialogCtrl",["clientProxy","$timeout","$scope",shareDialogCtrl]).filter("fileAction",actionFilter).filter("fileSize",sizeFilter).filter("fileModifier",modifierFilter).filter("fileDate",dateFilter).filter("fileName",nameFilter).filter("fileModifyTime",modTimeFilter).service("executor",["$injector",executor]).controller("folderPropDialogCtrl",["$scope","$q","launcher","fileManager","executor","dialogService","ROLES",folderPropDialogCtrl]).constant("FILE_LIST_MODE",{list:"list",star:"star",trash:"trash",search:"search",globalStar:"globalStar"}).run(["permissionService","ROLES",register])
}),define("pagelet/chat/normal/display/displayCtrl",["underscore","util/trackTiming"],function(_,trackTiming){"use strict";return function($scope,$rootScope,$location,$timeout,launcher,userService,vipService,chatService,chatTemplate,dialogService,$document,$q,applicants,permission,MESSAGE_TYPE){function parseMessage(json){var result;return result={data:json,templateUrl:chatTemplate.getTemplateUrl(json.type,json)},result.templateUrl?(result.error=!1,result):void 0}function isLongDate(curTime,preTime){var preDate=parseInt((preTime+288e5)/864e5,10),curDate=parseInt((curTime+288e5)/864e5,10);return curDate-preDate>=1?!0:!1}function parseDate(data){var curTime,preTime,i;for(preTime=data[0].time,i=1;i<data.length;i++)curTime=data[i].time,data[i].longDate=isLongDate(curTime,preTime),preTime=curTime;return data}function createLrts(groudId,time){var lrts=[];return lrts.push({gid:groudId,lrt:time}),lrts}function unreadShow(message){var lastReadMsgId=chatIdList[$scope.gid()],unReadMsgNum=message.data.id-lastReadMsgId;$scope.lastReadMsgId=lastReadMsgId,$scope.unreadMsgNum=unReadMsgNum,$scope.unreadShow=!1,unReadMsgNum>=6&&($scope.unread=!0),$scope.history=unReadMsgNum>=20?!0:!1,chatIdList[$scope.gid()]=message.data.id}function InitMessages(data){console.log(data);var messages,users;timeoutDefer=null,messages=[],users=[],$scope.messages=[],$scope.loadingData=!1,$scope.chatState.hasOlderMessage=!0,data.length&&lastCancelTime<data[0].time&&(lastCancelTime=chatTimeList[$scope.gid()]=data[0].time,applicants.cancelNotice(applicants.CANCEL_GROUP,createLrts($scope.gid(),chatTimeList[$scope.gid()]))),data=data.reverse(),data.length<21&&data.length>0?(data=parseDate(data),data[0].longDate=!0,$scope.chatState.hasOlderMessage=!1):data.length>0&&(data=parseDate(data),data.shift(),$scope.chatState.lastMessageId=data[0].id-1),data.length>0&&(_.each(data,function(message){message=parseMessage(message),message&&(messages.push(message),void 0===$scope.vipList[message.data.user.userId]&&-1===users.indexOf(message.data.user.userId)&&users.push(message.data.user.userId))}),unreadShow(messages[messages.length-1])),users.length>0&&vipService.updateUsersVip(users.join(":")).then(function(){$scope.vipList=vipService.vipList}),$scope.messages=messages,$scope.chatState.pages++,$timeout(function(){trackTiming.changeGroupLoadChat.end().send().clear()})}function PrependOlderMessage(data){var messages,users;users=[],$scope.loadingData=!1,data=data.reverse(),data.length<21&&data.length>0?(data=parseDate(data),data[0].longDate=!0,$scope.chatState.hasOlderMessage=!1):data.length>0&&(data=parseDate(data),data.shift(),$scope.chatState.lastMessageId=data[0].id-1),data.length>0&&($scope.chatState.lastMessageId=data[0].id-1,messages=[],_.each(data,function(message){message=parseMessage(message),message&&(messages.push(message),void 0===$scope.vipList[message.data.user.userId]&&-1===users.indexOf(message.data.user.userId)&&users.push(message.data.user.userId))}),$scope.messages=$scope.messages.reverse().concat(messages.reverse()).reverse(),$scope.chatState.pages++),users.length>0&&vipService.updateUsersVip(users.join(":")).then(function(){$scope.vipList=vipService.vipList})}function getOlderMessage(){loadMore||$scope.chatState.pages>=3||$scope.chatState.hasOlderMessage&&(loadMore=!0,chatService.listMessage($scope.gid(),$scope.chatState.lastMessageId,21).then(PrependOlderMessage).catch(function(e,status){console.log(e),console.log(status)}).finally(function(){loadMore=!1}))}function pushNewMessage(message){if(message&&message.data){if(chatTimeList[$scope.gid()]=message.data.time,chatIdList[$scope.gid()]=message.data.id,$scope.messages.length>0){var preMessage=$scope.messages[$scope.messages.length-1];message.data.longDate=isLongDate(message.data.time,preMessage.data.time)}else message.data.longDate=!0,$scope.chatState.hasOlderMessage=!1;$scope.messages.push(message),message.data.user&&void 0===$scope.vipList[message.data.user.userId]&&vipService.updateUserVip(message.data.user.userId).then(function(){$scope.vipList=vipService.vipList})}}function showHistory(){var hrId=$scope.chatState.lastMessageId;$location.search("hrId",hrId)}function init(){loadMore=!1,$scope.gid()&&($scope.chatState={pages:0},errorMessageId=-1,$scope.loadingData=!0,null!==timeoutDefer&&(timeoutDefer.promise.status=499,timeoutDefer.resolve()),timeoutDefer=$q.defer(),lastCancelTime=-1,cancelInterval&&clearInterval(cancelInterval),cancelInterval=setInterval(function(){document.hidden||document.webkitHidden||chatTimeList[$scope.gid()]&&lastCancelTime<chatTimeList[$scope.gid()]&&(lastCancelTime=chatTimeList[$scope.gid()],applicants.cancelNotice(applicants.CANCEL_GROUP,createLrts($scope.gid(),chatTimeList[$scope.gid()])))},applicants.getInterval()),chatService.listMessage($scope.gid(),void 0,21,timeoutDefer,channel).then(InitMessages,function(e,status){console.log(e),console.log(status)}))}var chatNode,errorMessageId,timeoutDefer=null,chatTimeList=applicants.lastReadTimeList,chatIdList=applicants.lastReadIdList,cancelInterval=null,lastCancelTime=-1,loadMore=!1,channel="all",channelMessageTypes={file:[MESSAGE_TYPE.FILE,MESSAGE_TYPE.GROUPNOTE,MESSAGE_TYPE.GROUPTABLE,MESSAGE_TYPE.COMMENT,MESSAGE_TYPE.CLEARTRASH],talk:[MESSAGE_TYPE.TEXT,MESSAGE_TYPE.IMAGE,MESSAGE_TYPE.VOICE],task:[MESSAGE_TYPE.TASK]};$scope.$on("$includeContentLoaded",function(){chatNode=$document.find(".chat-display-bd .widget-scroller-wrap")}),$scope.chatState={},$scope.vipList={},init(),$scope.$on("group.changed",function(evt,gid,preGid){void 0!==gid&&(preGid!==gid&&preGid&&applicants.cancelNotice(applicants.CANCEL_GROUP,createLrts(preGid,chatTimeList[preGid])),init(),$location.search("chathistory",null),$location.search("hrId",null))}),$scope.$watch(function(){return launcher.getCurrentRole()},function(){$scope.isCoverSendContainer=permission.check("!chat.send")}),$scope.$on("socket.reconnect",function(){init()}),$scope.$on("chat.changeChannel",function(evt,ch){channel=ch,init()}),$scope.$on("chat.display.show",function(evt,json){if(Number($scope.gid())===json.groupId&&9!==json.operation){if("all"!==channel&&!_.contains(channelMessageTypes[channel],json.type))return;var message=parseMessage(json);message&&pushNewMessage(message)}}),$scope.$on("chat.send.textError",function(event,content){for(var i=0;i<$scope.messages.length;i++)if($scope.messages[i].data.localId===content.localId)return void($scope.messages[i].error=!0)}),$scope.$on("chat.send.imageError",function(){var message,data;data={fileId:"",fileName:"breakImage.png",groupId:$scope.gid(),id:errorMessageId,longInterval:!1,size:0,time:0,type:2,user:$scope.getUser()},message={data:data,templateUrl:chatTemplate.getTemplateUrl(data.type,data)},errorMessageId--,message.error=!0,pushNewMessage(message),chatNode.animate({scrollTop:1e5},"slow")}),$scope.$on("chat-voice-play",function(evt,data){$scope.$broadcast("chat.voice.play",data)}),$scope.vipList=vipService.vipList,$scope.getOlderMessage=getOlderMessage,$scope.showHistory=showHistory}}),define("pagelet/chat/normal/display/text/textCtrl",["jquery"],function(){"use strict";return function($scope){var messageData=$scope.message.data;$scope.$on("chat.send.text.success",function(evt,data){var tag=data.tag;tag===String(messageData.groupId)+":"+String(messageData.localId)&&(messageData.id=data.id)}),$scope.$on("chat.send.text.error",function(evt,data){var tag=data.tag;tag===String(messageData.groupId)+":"+String(messageData.localId)&&($scope.message.error=!0)})}}),define("pagelet/chat/normal/display/voice/voiceCtrl",["jquery"],function($){"use strict";return function($scope){var message,fileName;message=$scope.message.data,fileName=message.fileName,$scope.voiceMsg=message,$scope.voiceSrc="/yws/api/group/"+message.groupId+"/message/"+message.id+"?method=getSound&fileId="+message.fileId,$scope.voiceType=fileName.substring(fileName.lastIndexOf(".")+1),$scope.play=function(){$(".voice").click()}}}),define("pagelet/chat/normal/display/image/imageCtrl",["underscore"],function(_){"use strict";var images=[];return function($scope,downloadService,client){function succuss(){messageData.height=messageData.height|messageData.imageHeight,messageData.width=messageData.width|messageData.imageWidth,messageData.height>messageData.width&&messageData.height>threshold?(height=threshold,width=messageData.width*threshold/messageData.height):messageData.height<=messageData.width&&messageData.width>threshold?(width=threshold,height=messageData.height*threshold/messageData.width):(height=messageData.height,width=messageData.width),$scope.previewSrc=height>width?"/yws/api/group/"+messageData.groupId+"/message/"+messageData.id+"?method=getImage&fileId="+messageData.fileId+"&height="+threshold:"/yws/api/group/"+messageData.groupId+"/message/"+messageData.id+"?method=getImage&fileId="+messageData.fileId+"&width="+threshold,height+="px",width+="px",image={id:messageData.id,height:height,width:width,name:messageData.fileName,src:"/yws/api/group/"+messageData.groupId+"/message/"+messageData.id+"?method=getImage&fileId="+messageData.fileId};var insertIndex=_.sortedIndex(images,image,"id");images.splice(insertIndex,0,image),$scope.image=image,$scope.images=images}var messageData,image,height,width,threshold;$scope.isNative=client.isNative(),messageData=$scope.message.data,image={},threshold=140,messageData.local||succuss(),$scope.$on("chat.send.image.process",function(evt,data){var percent=data.percent,tag=data.tag;tag===String(messageData.groupId)+":"+String(messageData.localId)&&($scope.percent=percent)}),$scope.$on("chat.send.image.uploadSuccess",function(evt,data){var tag=data.tag;tag===String(messageData.groupId)+":"+String(messageData.localId)&&($scope.percent=100,messageData.local=!1,messageData.fileId=data.fileId,messageData.fileName=data.fileName,messageData.height=data.height,messageData.width=data.width,messageData.id=data.id,succuss())}),$scope.$on("chat.send.image.error",function(evt,data){var tag=data.tag;tag===String(messageData.groupId)+":"+String(messageData.localId)&&(messageData.local=!1,$scope.message.error=!0)}),$scope.contextMenu=function(image){var items=[];return items.push({name:"saveAsImage",label:"另存为",handler:function(){downloadService.download(image.name,image.src)}}),items},$scope.$on("$destroy",function(){var index=_.indexOf(images,image);0>index||images.splice(index,1)})}}),define("pagelet/chat/normal/display/chatScrollDirective",["underscore","jquery"],function(){"use strict";return function($timeout){function link(scope,element){function getHeight(){var height=0;return $chat.children().each(function(index,el){height+=el.offsetHeight}),height}function handler(){return $chat.scrollTop()<=20&&scope.getOlderMessage(),!1}function checkScrollerReady(){var $dom=element.find(".chat-display-bd .widget-scroller-wrap");$dom.length<=0?setTimeout(checkScrollerReady,50):($chat=$dom,$chat.animate({scrollTop:1e5},"slow"),$chat.scroll(handler))}var $chat,$loadOlderMessage,preHeight=0,preScrollTop=0;$loadOlderMessage=element.find("#loadOlderMessage"),scope.$watch("chatState.pages",function(newValue){newValue&&$chat&&$chat.length>0&&(preScrollTop=$chat.scrollTop(),$timeout(function(){if(1===newValue)preHeight=getHeight(),$chat.stop(),$chat.animate({scrollTop:1e5},"slow");else{var height=getHeight();height>preHeight+preScrollTop&&$chat.scrollTop(height-preHeight-preScrollTop),preHeight=height}},0))}),scope.$watch("chatState.hasOlderMessage",function(newValue){newValue?$loadOlderMessage.css("display","block"):$loadOlderMessage.css("display","none")}),setTimeout(checkScrollerReady,50)}return{restrict:"A",link:link}}}),define("pagelet/chat/normal/display/chatTipDirective",["underscore","jquery"],function(){"use strict";return function($rootScope,$location,chatTemplate){function link(scope,element){function handler(){var height=0,elHeight=$chat.height();$chat.children().each(function(index,el){height+=el.offsetHeight});var pos=height-$chat.scrollTop();return!isLocked&&elHeight+10>pos&&(scope.isShowTip=!1,$chatTip.hide()),!1}function showChatTip(userId,json){var height=0,elHeight=$chat.height();$chat.children().each(function(index,el){height+=el.offsetHeight});var pos=height-$chat.scrollTop();(!$rootScope.isReplying||$rootScope.isReplying&&userId===scope.uid())&&(pos>elHeight+100&&userId!==scope.uid()&&chatTemplate.getTipUrl(json.type,json)?(scope.tip=json,scope.tipUrl=chatTemplate.getTipUrl(json.type,json),isLocked=!1,$chatTip.show()):($chat.show(),$chat.stop(),$chat.animate({scrollTop:1e5},"slow")))}var $chatTip,$chat,isLocked;scope.$on("$includeContentLoaded",function(){$chat=element.find(".chat-display-bd .widget-scroller-wrap"),$chat.scroll(handler)}),$chatTip=element.find("#chatTip"),$chatTip.click(function(){return $chat.stop(),$chat.animate({scrollTop:1e5},"slow"),isLocked||$chatTip.hide(),!1}),scope.$on("chat.display.show",function(event,json){if(Number(scope.gid())===json.groupId){var userId;userId=json.user.userId,showChatTip(userId,json)}})}return{restrict:"A",link:link}}}),define("pagelet/chat/normal/display/chatUnreadDirective",["underscore","jquery"],function(_,$){"use strict";return function($timeout,$animate,$location){function link(scope,element){function isVisible(element){var rect=element[0].getBoundingClientRect();return rect.bottom-rect.top>0&&rect.top>100}function unreadHide(lastRead){scope.unreadShow=!1,$timeout(function(){$animate.removeClass(lastRead,"unread-last")},2e3)}function scrollCheck(event){var $parent=$(event.target),$lastRead=$parent.find(".unread");$lastRead.length<=0||isVisible($lastRead)&&($parent.unbind("scroll",scrollCheck),unreadHide($lastRead))}var $lastRead,unreadClose=function(event){var $lastRead=$(event.target).parent().parent().find(".unread");unreadHide($lastRead)},readPast=function(event){var $lastRead=$(event.target).parent().parent().find(".unread"),$parent=$(event.target).parent().parent().find(".chat-display-bd .widget-scroller-wrap");$parent.scrollTop($parent.scrollTop()+$lastRead.offset().top-$parent.offset().top-10),unreadHide($lastRead)},readHistory=function(event){var $lastRead=$(event.target).parent().parent().find(".unread"),hrId=scope.lastReadMsgId+1;unreadHide($lastRead),$location.search("chathistory",""),$location.search("chathistory",hrId)};scope.$on("$includeContentLoaded",function(){$timeout(function(){var scroll=element.find(".widget-scroller-wrap");if(0==scope.history&&scope.unread?(scope.unread=!1,scroll.scrollTop(1e5),$lastRead=element.find(".unread"),isVisible($lastRead)?unreadHide($lastRead):(scope.unreadShow=!0,scope.$apply(),$lastRead.addClass("unread-last"),scroll.bind("scroll",scrollCheck),scope.unreadClose=unreadClose,scope.readPast=readPast)):scope.history&&scope.unread&&(scope.unread=!1,scope.unreadShow=!0,scope.readHistory=readHistory,scope.unreadClose=unreadClose,scroll.bind("scroll",scrollCheck)),scope.history){if($lastRead=element.find(".unread"),$lastRead.length<=0)return;scope.history=!1,$lastRead.addClass("unread-last")}})}),scope.$on("chat.load.more",function(){})}return{restrict:"A",link:link}}}),define("util/nameByTime",[],function(){"use strict";var fileName;return fileName=function(){return function(){var date=new Date,monthPlus=date.getMonth()+1,month=monthPlus>=10?monthPlus+"":"0"+monthPlus,day=date.getDate()>=10?date.getDate()+"":"0"+date.getDate(),hour=date.getHours()>=10?date.getHours()+"":"0"+date.getHours(),minute=date.getMinutes()>=10?date.getMinutes()+"":"0"+date.getMinutes(),second=date.getSeconds()>=10?date.getSeconds()+"":"0"+date.getSeconds(),dateString=date.getFullYear()+month+day+"_"+hour+minute+second;return"图片"+dateString+".jpg"}}()}),define("pagelet/chat/normal/send/sendMessageDirective",["underscore","jquery","util/inputTool","util/keycode","util/guid","util/nameByTime","atwho"],function(_,$,inputTool,KEYCODE,GUID,screentShotName){"use strict";return function($rootScope,storageMgr,launcher,chatService,chatLocalMsg,chatTemplate,dialogs,fileMgr,client,uploader,memberService,LOCAL_STORAGE_KEY){function link(scope,element){function sendText(){var targets,sync,localId,content,message=scope.message;if(message){targets=memberService.getAtTargets(message),sync=-1===targets.indexOf("all"),localId=GUID(),content={user:launcher.getUser(),type:0,groupId:Number(launcher.gid()),localId:localId,time:(new Date).getTime(),message:message},chatLocalMsg.trigger(localId,content);var tag=String(launcher.gid())+":"+String(localId);chatService.sendText(launcher.gid(),message,targets,sync,localId).then(function(json){$rootScope.$broadcast("chat.send.text.success",{tag:tag,id:json.id}),storage.remove(LOCAL_STORAGE_KEY.GROUP_CHAT_PREFIX+launcher.gid())},function(){$rootScope.$broadcast("chat.send.text.error",{tag:tag})}),scope.message=""}}function sendImage(){var localId,content,type=scope.imagePreview.type,groupId=launcher.gid();if("screenshot"===type&&client.uploadScreenshot(scope.imagePreview.src,groupId),"paste"===type){localId=GUID(),content={user:launcher.getUser(),type:2,groupId:Number(launcher.gid()),localId:localId,time:(new Date).getTime(),local:!0},chatLocalMsg.trigger(localId,content);var tag=String(groupId)+":"+String(localId),fileName=screentShotName();uploader.createTask("content",scope.imagePreview.blob,fileName).upload("/yws/api/group/"+groupId+"/message?method=sendImage&localId="+localId).then(function(json){var data=JSON.parse(json.text);scope.$broadcast("chat.send.image.uploadSuccess",{tag:tag,fileId:data.fileId,id:data.id,longInterval:data.longInterval,height:data.height,width:data.width,fileName:fileName})},function(){scope.$broadcast("chat.send.image.error",{tag:tag})},function(evt){var sent=evt.sent,total=evt.total;scope.$broadcast("chat.send.image.process",{tag:tag,percent:total?Math.floor(99*sent/total):0})})}scope.imagePreview.show=!1}function clipScreen(hideWindow){client.takeScreenshot(hideWindow)}function onScreenshotTake(evt,imageSrc){scope.imagePreview.show=!0,scope.imagePreview.type="screenshot",scope.imagePreview.src=imageSrc}function onScreenshotUpload(evt,res){}function onImageSelect(tasks){var localId,content,task=tasks[0];localId=GUID(),content={user:launcher.getUser(),type:2,groupId:Number(launcher.gid()),localId:localId,time:(new Date).getTime(),local:!0},chatLocalMsg.trigger(localId,content);var tag=String(launcher.gid())+":"+String(localId);task.upload("/yws/api/group/"+launcher.gid()+"/message?method=sendImage&localId="+localId).then(function(json){var data=JSON.parse(json.text),fileName=json.file.name;scope.$broadcast("chat.send.image.uploadSuccess",{tag:tag,fileId:data.fileId,id:data.id,longInterval:data.longInterval,height:data.height,width:data.width,fileName:fileName})},function(){scope.$broadcast("chat.send.image.error",{tag:tag})},function(evt){var sent=evt.sent,total=evt.total;scope.$broadcast("chat.send.image.process",{tag:tag,percent:total?Math.floor(99*sent/total):0})})}function onInputBlur(){$(function(){$input.animate({height:"60px"},{duration:400,queue:!1})}),caretPos=this.selectionStart}function onInputFocus(){$(function(){$input.animate({height:"75px"},{duration:400,queue:!1})})}function onInputKeyDown(e){return e.altKey&&e.keyCode===KEYCODE.S?(scope.send(),!1):e.keyCode!==KEYCODE.ENTER||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey?e.keyCode===KEYCODE.ENTER?(document.execCommand("insertParagraph"),!1):void 0:(e.isPropagationStopped()||sendText(),!1)}function onInputPaste(event){{var blob,i,clipboardData=event.clipboardData||event.originalEvent.clipboardData,items=clipboardData.items;clipboardData.files}if(items)for(i=0;i<items.length;i++)if(0===items[i].type.indexOf("image")&&(blob=items[i].getAsFile(),null!==blob)){var src=URL.createObjectURL(blob);return src&&(scope.imagePreview.src=src,scope.imagePreview.show=!0,scope.imagePreview.blob=blob,scope.imagePreview.type="paste"),event.preventDefault(),!1}}function onUnload(){scope.message&&storage.put(LOCAL_STORAGE_KEY.GROUP_CHAT_PREFIX+launcher.gid(),scope.message)}function init(){scope.sendText=sendText,scope.sendImage=sendImage,scope.clipScreen=clipScreen,scope.onImageSelect=onImageSelect,scope.client=client,scope.imagePreview={show:!1},scope.addEmoji=function(tag){scope.message=inputTool.insertValue($input,caretPos,tag)},scope.uploadChatImage=function(){client.uploadChatImage(launcher.gid())},scope.$on(client.SCREENSHOT_TAKE,onScreenshotTake),scope.$on(client.SCREENSHOT_UPLOAD,onScreenshotUpload),scope.$on("group.changed",function(evt,gid,oldGid){oldGid&&scope.message&&storage.put(LOCAL_STORAGE_KEY.GROUP_CHAT_PREFIX+oldGid,scope.message),!scope.message&&storage.get(LOCAL_STORAGE_KEY.GROUP_CHAT_PREFIX+oldGid)&&storage.remove(LOCAL_STORAGE_KEY.GROUP_CHAT_PREFIX+oldGid),scope.message=storage.get(LOCAL_STORAGE_KEY.GROUP_CHAT_PREFIX+gid),scope.imagePreview.show=!1}),$input.bind("blur",onInputBlur),$input.bind("focus",onInputFocus),$input.bind("keydown",onInputKeyDown),$input.bind("paste",onInputPaste),$(window).bind("beforeunload",onUnload),scope.$on("$destroy",function(){$input.unbind("blur",onInputBlur),$input.unbind("focus",onInputFocus),$input.unbind("keydown",onInputKeyDown),$input.unbind("paste",onInputPaste),$(window).unbind("beforeunload",onUnload)})}var caretPos=0,storage=storageMgr.forUser(launcher.uid()),$input=element.find("textarea");init()}return{restrict:"A",templateUrl:"pagelet/chat/normal/send/send-message.html",link:link}}}),define("pagelet/chat/normal/display/voice/voiceDirective",["underscore"],function(_){"use strict";var VoiceState={players:[],registerPlayer:function(id,player){this.players.push({id:id,player:player})},removePlayer:function(id){this.players=_.reject(this.players,function(value){return value.id===id})},stopAllPlayers:function(){_.each(this.players,function(value){value.player.stop()})}};return function(voiceService){function link(scope,element){function setPlayCss(){$icon.removeClass("voice-stop"),$icon.addClass("voice-play")}function setStopCss(){$icon.removeClass("voice-play"),$icon.addClass("voice-stop")}function stop(){myState="stop",setStopCss()}function play(){myState="play",setPlayCss()}var myState,$icon,id,player;myState="stop",$icon=element.find("div"),id=String(scope.gid()+":"+scope.messageId),player={stop:stop},VoiceState.registerPlayer(id,player),element.click(function(e){"stop"===myState?(VoiceState.stopAllPlayers(),play(),voiceService.play(scope.voiceSrc,scope.voiceType,stop)):"play"===myState&&(stop(),voiceService.stop()),e.stopPropagation()}),scope.$on("$destroy",function(){VoiceState.removePlayer(id)}),scope.$on("group.changed",function(){"play"===myState&&(stop(),voiceService.stop())});var width;width=parseInt(scope.duration/1e3+.5,10),width=1.667*width+50,width=50>width?50:width,width=width>150?150:width,element.css("width",width)}return{restrict:"A",template:'<div class="voice-icon voice-stop" ng-transclude></div>',scope:{gid:"&",duration:"@",voiceSrc:"@",voiceType:"@",messageId:"@"},transclude:!0,link:link}}}),define("pagelet/chat/normal/chatLocalMsg",["underscore"],function(){"use strict";return function($rootScope){function showMessage(json){$rootScope.$broadcast("chat.display.show",json)}function getLocalId(message){return message.localId}function trigger(localId,value){-1===localIdCache.indexOf(localId)&&(localId&&localIdCache.push(localId),localIdCache.length>1e3&&(localIdCache=localIdCache.slice(800)),showMessage(value))}function handleMessage(evt,message){trigger(getLocalId(message),message)}var localIdCache=[];$rootScope.$on("socket.message",handleMessage),this.trigger=trigger,this.getLocalId=getLocalId}}),define("pagelet/chat/history/historyCtrl",["underscore","jquery"],function(_,$){"use strict";return function($rootScope,$scope,$location,$q,$timeout,chatService,vipService,chatTemplate){function parseDate(data){var preDate,curDate,i;for(preDate=parseInt((data[0].time+288e5)/864e5,10),i=1;i<data.length;i++)curDate=parseInt((data[i].time+288e5)/864e5,10),data[i].longDate=curDate-preDate>=1?!0:!1,preDate=curDate;return data}function parseMessage(json){var result;return result={data:json,templateUrl:chatTemplate.getTemplateUrl(json.type,json)},result.templateUrl?(result.error=!1,result):void 0}function setScopeMessages(data){var messages=[],users=[];return data.length<=0?void($scope.noMessage=!0):($scope.noMessage=!1,$scope.messages=[],data=data.reverse(),data=parseDate(data),data[0].longDate=!0,_.each(data,function(message){message=parseMessage(message),message&&(messages.push(message),void 0===$scope.vipList[message.data.user.userId]&&-1===users.indexOf(message.data.user.userId)&&users.push(message.data.user.userId))}),$scope.messages=messages,$scope.loadingData=!1,users.length>0&&vipService.updateUsersVip(users.join(":")).then(function(){$scope.vipList=vipService.vipList}),void(isScrollBottom?$timeout(function(){historyNode.scrollTop(1e5)},0):$timeout(function(){historyNode.scrollTop(0)},0)))}function getMessages(l){var length=l;"hr"===$scope.pageMode&&20>curId&&(length=curId),"ch"===$scope.pageMode&&20>lastId-curId&&(length=lastId-(curId-20)),$scope.loadingData=!0,null!==timeoutDefer&&(timeoutDefer.promise.status=499,timeoutDefer.resolve()),timeoutDefer=$q.defer(),chatService.listMessage($scope.gid(),curId,length,timeoutDefer).then(setScopeMessages,function(e,status){console.log(e),console.log(status)})}function gotoUp(){20>=curId||(curId-=20,20>=curId&&($scope.noUpPage=!0),$scope.noDownPage=!1,isScrollBottom=!0,getMessages(pageSize))}function gotoDown(){curId-lastId>=0||(curId+=20,curId-lastId>=0&&($scope.noDownPage=!0),$scope.noUpPage=!1,isScrollBottom=!1,getMessages("hr"===$scope.pageMode?0>lastId-curId?lastId-curId+20:pageSize:pageSize))}function back(){$location.search("chathistory",null),$location.search("hrId",null),preHistoryId=null,preHrId=null}function getData(id){chatService.listMessage($scope.gid(),null,1).then(function(res){lastId=res.length?res[0].id:0,"hr"===$scope.pageMode&&(curId=id,isScrollBottom=!0),"ch"===$scope.pageMode&&(curId=20*(parseInt((id-1)/20)+1),curId-lastId>=0&&($scope.noDownPage=!0)),20>=curId&&($scope.noUpPage=!0),getMessages(pageSize)},function(e,status){console.log(e),console.log(status)})}function init(){var historyId=$location.search().chathistory,hrId=$location.search().hrId;historyId&&historyId!==preHistoryId?($location.search("pmessage",!0),$scope.loadingData=!0,$scope.noUpPage=!1,$scope.noDownPage=!1,$scope.pageMode="ch",getData(historyId),preHistoryId=historyId):hrId&&hrId!==preHrId&&($scope.loadingData=!0,$scope.noUpPage=!1,$scope.noDownPage=!1,$scope.pageMode="hr",getData(hrId),preHrId=hrId)}var curId,lastId,pageSize=20,timeoutDefer=null,isScrollBottom=!0,preHistoryId=null,preHrId=null,historyNode=$(".chat-history-bd");$scope.noMessage=!1,$scope.back=back,$scope.gotoUp=gotoUp,$scope.gotoDown=gotoDown,$scope.noUpPage=!1,$scope.noDownPage=!1,$scope.vipList={},$rootScope.$on("$locationChangeSuccess",function(){init()}),$scope.vipList=vipService.vipList,init()}}),define("pagelet/chat/history/highlight",[],function(){"use strict";return function($location,$document){function link(scope,el){var historyId=$location.search().chathistory,pmessage=$location.search().pmessage,$historyNode=$document.find(".chat-history-bd");if(void 0!==historyId){var messageId=scope.message.data.id;messageId===Number(historyId)&&(el.addClass("highlight"),pmessage&&setTimeout(function(){var $hp=$historyNode.find(".highlight").parent(),height=0,elHeight=$historyNode.height();$hp.prevAll().each(function(index,element){height+=element.offsetHeight}),$historyNode.scrollTop(height-elHeight/2+$hp.height()/2),scope.$apply(function(){$location.search("pmessage",null),$location.replace()})},100))}}return{restrict:"A",link:link}}}),define("pagelet/chat/chatInit",["underscore"],function(){"use strict";return function(chatTemplate,permission,ROLES){permission.register(ROLES.GROUP_FOUNDER,["chat.*"]),permission.register(ROLES.GROUP_MANAGER,["chat.*"]),permission.register(ROLES.GROUP_EDITOR,["chat.*"]),permission.register(ROLES.GROUP_READER,["chat.*"]),permission.register(ROLES.GROUP_RESTORER,[]),permission.register(ROLES.GROUP_VIEWER,[]),permission.deregister(ROLES.ORG_EXPIRED,["chat.send"]),chatTemplate.extendTemplate(function(data){return 0===data.type?(data.templateUrl="pagelet/chat/normal/display/text/text-item.html",data.tipUrl="pagelet/chat/normal/display/text/text-tip.html",!1):void 0}),chatTemplate.extendTemplate(function(data){return 2===data.type?(data.templateUrl="pagelet/chat/normal/display/image/image-item.html",data.tipUrl="pagelet/chat/normal/display/image/image-tip.html",!1):void 0}),chatTemplate.extendTemplate(function(data){return 3===data.type?(data.templateUrl="pagelet/chat/normal/display/voice/voice-item.html",data.tipUrl="pagelet/chat/normal/display/voice/voice-tip.html",!1):void 0}),chatTemplate.extendTemplate(function(data){return 7===data.type?(data.templateUrl="pagelet/setting/options/groupmessage/groupmessage-item.html",!1):void 0}),chatTemplate.extendTemplate(function(data){if(16===data.type)switch(data.data.hackType){case"1":data.templateUrl="pagelet/chat/normal/display/hack/notice.html",data.tipUrl="pagelet/chat/normal/display/hack/notice-tip.html";break;case"2":data.templateUrl="pagelet/chat/normal/display/hack/event.html",data.tipUrl="pagelet/chat/normal/display/hack/event-tip.html"}})}}),define("pagelet/chat/p2p/p2pService",["underscore","bower_components/util/src/cookies","util/trackTiming"],function(_,cookies,trackTiming){"use strict";return function($http,$q,launcher){function Message(json){var content,tempWidth,tempHeight;switch(json.type){case 0:content=json.message;break;case 2:var userId=json.user.userId===launcher.getUser().userId?json.toUser:json.user.userId;content={imageHeight:json.imageHeight,imageWidth:json.imageWidth,imageOrientation:json.imageOrientation,link:"/yws/api/p2p/message/"+json.id+"?method=getImage&other="+userId+"&width=140&cstk="+cookies.get("YNOTE_CSTK")};break;default:console.log("message content not set because of error type")}return 2===json.type&&(json.imageWidth>140?(tempHeight=140*json.imageHeight/json.imageWidth,tempWidth=140):(tempWidth=json.imageWidth,tempHeight=json.imageHeight)),{id:String(json.id||""),type:Number(json.type),time:new Date(json.time||0),content:content,localId:String(json.localId||0),isSend:json.toUser===launcher.getUser().userId,fromUser:json.user||null,fileName:String(json.fileName||""),toUser:String(json.toUser||""),height:(tempHeight||0)+"px",width:(tempWidth||0)+"px"}}function Contact(json){return{userId:json.userId,name:json.name,photo:json.photo||"style/images/033488d9.dummy_user.jpg"}}function getRecentContacts(length){var defer=$q.defer();return trackTiming.getRecentContacts.start(),$http.post("/yws/api/p2p",{limit:_.isNumber(length)?length:50},{params:{method:"recent"}}).success(function(array){trackTiming.getRecentContacts.end().setLabel("success").send().clear();var contacts=[];_.each(array,function(json){contacts.push(new Contact(json))}),defer.resolve(contacts)}).error(function(e,status){trackTiming.getRecentContacts.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise}function sendText(other,content,localId){var defer=$q.defer();return trackTiming.p2pSendText.start(),$http.post("/yws/api/p2p?method=sendText",{other:other,content:content,localId:localId}).success(function(json){trackTiming.p2pSendText.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(e,status){trackTiming.p2pSendText.end().setLabel("error").send().clear(),defer.reject(e,status)}),defer.promise}function getImageURL(messageId,otherId,width,height){var url="/yws/api/p2p/message/"+messageId+"?method=getImage&other="+otherId+"&cstk="+cookies.get("YNOTE_CSTK");return width&&_.isNumber(width)&&(url+="&width="+width),height&&_.isNumber(height)&&(url+="&height="+height),url}function getRecentMessage(other,last,limit,timeoutDefer){var defer=$q.defer();return trackTiming.getRecentMessage.start(),$http.post("/yws/api/p2p?method=list",{other:other,last:_.isNumber(last)?last:0,limit:_.isNumber(limit)?limit:20},{timeout:timeoutDefer?timeoutDefer.promise:$q.defer().promise}).success(function(array){trackTiming.getRecentMessage.end().setLabel("success").send().clear();
var messages=[];_.each(array,function(json){messages.push(new Message(json))}),defer.resolve(messages)}).error(function(e){trackTiming.getRecentMessage.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise}function getLatestReadP2PId(userIdList){var defer=$q.defer();return trackTiming.getLatestReadP2PId.start(),$http.post("/yws/api/p2p?method=getLastP2PChatId",{userIdList:userIdList}).success(function(json){trackTiming.getLatestReadP2PId.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(e){trackTiming.getLatestReadP2PId.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise}function getLastP2PId(userIdList){var defer=$q.defer();return trackTiming.getLastP2PId.start(),$http.post("/yws/api/p2p?method=getLastId",{userIdList:userIdList}).success(function(json){trackTiming.getLastP2PId.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(e){trackTiming.getLastP2PId.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise}function updateLatestP2PId(other,id){var defer=$q.defer();return trackTiming.updateLatestP2PId.start(),$http.post("/yws/api/p2p?method=updateLastP2PChatId",{userIdList:other,versionList:id}).success(function(json){trackTiming.updateLatestP2PId.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(e){trackTiming.updateLatestP2PId.end().setLabel("error").send().clear(),defer.reject(e)}),defer.promise}function getContacts(){return contactsArray}var contactsArray=[];this.getRecentContacts=function(length){return getRecentContacts(length).then(function(array){return contactsArray=array})},this.sendText=sendText,this.getImageURL=getImageURL,this.getContacts=getContacts,this.getRecentMessage=getRecentMessage,this.updateLatestP2PId=updateLatestP2PId,this.getLatestReadP2PId=getLatestReadP2PId,this.getLastP2PId=getLastP2PId,this.Message=Message,this.Contact=Contact}}),define("pagelet/chat/p2p/p2pCtrl",["underscore","jquery","util/guid","util/nameByTime"],function(_,$,GUID,screenShotName){"use strict";return _.mixin({before:function(times,func){var memo;return function(){return--times>0?memo=func.apply(this,arguments):func=null,memo}}}),function($scope,$rootScope,$timeout,$filter,p2pService,p2pLocalMsg,launcher,uploader,$q,pomeloService,$element,clientProxy){function unreadStyle(isSet){if(isSet){var toggleFunc=_.before(12,function(){dialogEl.toggleClass("unread")});styleInterval=setInterval(function(){toggleFunc()},500)}else clearInterval(styleInterval),styleInterval=void 0,dialogEl.removeClass("unread")}function messageToImage(message){return 2===message.type?{id:message.id,height:message.content.imageHeight,width:message.content.imageWidth,name:message.fileName||"聊天内容",src:p2pService.getImageURL(message.id,$scope.chatting.userId)}:void 0}function addImage(message){var image=messageToImage(message);if(image){var insertIndex=_.sortedIndex(images,image,"id");images.splice(insertIndex,0,image),$scope.images=images}}function init(){p2pService.getRecentContacts().then(function(contacts){var contactIdList="";$scope.recentContacts=contacts,$scope.hasMoreContacts=contacts.length===CONTACTSINCREMENT,_.each($scope.recentContacts,function(contact){$scope.errorMessages[contact.userId]=[],$scope.unreadMessages[contact.userId]=$scope.unreadMessages[contact.userId]||[],contactIdList+=contact.userId+","}),p2pService.getLatestReadP2PId(contactIdList).then(function(latestReadP2PId){p2pService.getLastP2PId(contactIdList).then(function(lastP2PId){if(latestReadP2PId.length===lastP2PId.length){for(var i=0;i<latestReadP2PId.length;i++)if(0!==latestReadP2PId[i]&&latestReadP2PId[i]<lastP2PId[i])for(var j=0;j<lastP2PId[i]-latestReadP2PId[i];j++)$scope.unreadMessages[contacts[i].userId].push({});handleUnread()}})}),$scope.recentContacts&&$scope.recentContacts.length>0&&chatWith($scope.recentContacts[0],!1,!0)}).catch(function(){console.log("获取最近联系人失败")})}function addEmoji(tag){$scope.$broadcast("sendEmoji",tag)}function closeP2P(){$scope.$parent.$parent.showP2P=!1,unreadStyle(!1)}function toggleMinimize(){$scope.minimized=!$scope.minimized,$scope.minimized?$scope.minimizedLatestContact=$scope.chatting:(unreadStyle(!1),$scope.messages.length>0&&$timeout(function(){asyncLatestP2PId($scope.chatting.userId,_.last($scope.messages).id)},3e3))}function maximize(minimized){minimized&&($scope.minimized=!1,unreadStyle(!1),$scope.messages.length>0&&$timeout(function(){asyncLatestP2PId($scope.chatting.userId,_.last($scope.messages).id)},3e3))}function scrollBottom(){$(".p2p-messages").scrollTop(1e5)}function clearInput(){$(".p2p-ft textarea").val("")}function focusInput(){$(".p2p-ft textarea").focus()}function asyncLatestP2PId(other,id){p2pService.updateLatestP2PId(other,id).then(function(){console.log("success in querying lastest id")},function(e,status){console.log(e),console.log(status)})}function chatWith(person,notScroll,isInitial,notClearUnread){var tempMessages=[],switchPerson=!1;person.userId!==$scope.chatting.userId&&($scope.p2pMessagesReady=!1,$scope.messages=[],$scope.loadingMore=!0,switchPerson=!0,images=[],loadMore=!1,$scope.imagePreview.show=!1,$scope.p2pState.pageTailIndex=0),person.userId===$scope.chatting.userId&&(notScroll=!0),$scope.chatting.isChatting=!1,$scope.chatting=person,_.isUndefined($scope.unreadMessages[person.userId])&&($scope.unreadMessages[person.userId]=[]),isInitial||notClearUnread||($scope.unreadMessages[person.userId]=[]),handleUnread(),$scope.showP2Ptip=!1,$scope.p2pState.hasOlderMessage=!0,$scope.messageHeight=0,person.isChatting=!0,timeoutDefer&&timeoutDefer.resolve(),timeoutDefer=$q.defer(),p2pService.getRecentMessage(person.userId,0,20,timeoutDefer).then(function(messages){$scope.lastChatTime=messages.length>0?messages[0].time:new Date,$scope.p2pState.hasOlderMessage=messages.length>=20,$scope.loadingMore=!1,focusInput(),switchPerson&&($scope.errorMessages[person.userId]&&$scope.errorMessages[person.userId].length>0?(tempMessages=[].concat(messages).concat($scope.errorMessages[person.userId]),$scope.messages=orderBy(tempMessages,"time",!1)):$scope.messages=messages.reverse(),$scope.imagePreview.show=!1,_.forEach($scope.messages,function(message){addImage(message)}),clearInput()),$scope.messages.length>0&&($scope.p2pState.lastMessageId=$scope.messages[0].id,isInitial||notClearUnread||asyncLatestP2PId($scope.chatting.userId,_.last($scope.messages).id)),notScroll||$timeout(function(){scrollBottom(),$scope.p2pMessagesReady=!0},10)},function(){}).finally(function(){$scope.loadingMore=!1})}function talkWith(person){if($scope.minimized){var tempPerson=_.findWhere($scope.recentContacts,{userId:person.userId});tempPerson?chatWith(tempPerson,void 0,void 0,!0):chatWith(person,void 0,void 0,!0)}}function sendText(text,isResend,originalLocalId){var localId,content,message=$scope.message,otherId=$scope.chatting.userId;text&&(message=text),localId=GUID(),content={user:$scope.user,type:0,time:-1,localId:localId,content:message,isSend:!1,fromLocal:!0,toUser:otherId},p2pLocalMsg.trigger(localId,content),p2pService.sendText(otherId,message,localId).then(function(json){content.id=json.id,content.time=new Date(json.time)},function(){var errorMessage=_.findWhere($scope.messages,{localId:localId});errorMessage&&(errorMessage.error=!0,$scope.errorMessages[otherId].push(errorMessage))}).finally(function(){isResend&&($scope.messages=_.reject($scope.messages,function(toBeRemovedErrorMsg){return toBeRemovedErrorMsg.localId===originalLocalId}))}),$scope.message=""}function resend(message){switch(message.type){case 0:sendText(message.content,!0,message.localId);break;case 2:onImageSelect([uploader.createTask("content",message.content,message.fileName)],!0,message.localId)}}function clickTip(){$scope.showP2Ptip=!1,scrollBottom()}function handleUnread(){var unreadNum=0;_.each($scope.unreadMessages,function(unread){unreadNum+=unread.length}),unreadNum>0?$scope.$emit("p2p.unread",!0):(unreadStyle(!1),$scope.$emit("p2p.unread",!1))}function onImageSelect(tasks,isResend,originalLocalId){var localId,message,task=tasks[0],otherId=$scope.chatting.userId;0!==otherId&&(localId=GUID(),message={user:$scope.user,type:2,localId:localId,time:new Date,isSend:!1,fromLocal:!0,percent:0,toUser:otherId},p2pLocalMsg.trigger(localId,message),task.append("other",$scope.chatting.userId),task.append("localId",localId),task.upload("/yws/api/p2p?method=sendImage").then(function(json){var data=JSON.parse(json.text),fileName=json.file.name,url=p2pService.getImageURL(data.id,otherId);_.extend(message,{id:data.id,content:{imageHeight:data.height,imageWidth:data.width,fileName:fileName}}),message.content.link=url+"&width=140",message.fromLocal=!1,addImage(message)},function(e){_.isObject(e)&&(message.content=e.file,message.fileName=e.fileName||screenShotName(),message.error=!0,$scope.errorMessages[otherId].push(message))},function(evt){var sent=evt.sent,total=evt.total;message.percent=total?Math.floor(99*sent/total):0}).finally(function(){isResend&&($scope.messages=_.reject($scope.messages,function(toBeRemovedErrorMsg){return toBeRemovedErrorMsg.localId===originalLocalId}))}))}function sendImage(){if(0!==$scope.chatting.userId){var fileName=screenShotName(),task=uploader.createTask("content",$scope.imagePreview.blob,fileName);onImageSelect([task]),$scope.imagePreview.show=!1}}function PrependOlderMessage(data){data=data.reverse(),data.pop(),$scope.p2pState.hasOlderMessage=data.length>=20,data.length>0&&($scope.p2pState.lastMessageId=data[0].id,$timeout(function(){$scope.p2pState.pageTailIndex++},0),$scope.messages=_.filter(data,function(message){return 0===$scope.messages.length?!0:parseInt(message.id)<parseInt($scope.messages[0].id)}).concat($scope.messages))}function getOlderMessage(){loadMore||$scope.p2pState.hasOlderMessage&&(loadMore=!0,$scope.loadingMore=!0,p2pService.getRecentMessage($scope.chatting.userId,Number($scope.p2pState.lastMessageId),21).then(PrependOlderMessage).catch(function(e,status){console.log(e),console.log(status)}).finally(function(){loadMore=!1,$scope.loadingMore=!1}))}function getMoreContact(bottom){if(10>bottom&&$scope.hasMoreContacts){var recentList=$scope.recentContacts,n=recentList.length+CONTACTSINCREMENT;$scope.hasMoreContacts=!1,$timeout(function(){$scope.loadingContacts=!0},0),p2pService.getRecentContacts(n).then(function(contacts){$scope.hasMoreContacts=contacts.length===n;var index=_.indexOf(contacts,_.findWhere(contacts,{userId:_.last(recentList).userId})),newContacts=contacts.splice(index+1);_.each(newContacts,function(contact){recentList.push(contact),$scope.errorMessages[contact.userId]=[],$scope.unreadMessages[contact.userId]=[]}),$scope.loadingContacts=!1})}}function reorderContacts(message){var recentContact=_.findWhere($scope.recentContacts,{userId:message.fromUser.userId});recentContact?($scope.recentContacts=_.reject($scope.recentContacts,function(contact){return contact.userId==recentContact.userId}),$scope.recentContacts.unshift(recentContact)):$scope.recentContacts.unshift(message.fromUser)}function uploadP2PImage(){clientProxy.uploadP2PImage($scope.chatting.userId)}var check,images,styleInterval,timeoutDefer,orderBy=$filter("orderBy"),loadMore=!1,dialogEl=$(".p2p"),CONTACTSINCREMENT=50;$scope.user=launcher.getUser(),$scope.errorMessages={},$scope.unreadMessages={},$scope.imagePreview={show:!1},$scope.chatting={userId:0},images=[],$scope.images=images,$scope.p2pState={},$scope.getImage=function(message){return _.findWhere(images,{id:message.id})||messageToImage(message)},$scope.client=clientProxy,$scope.uploadP2PImage=uploadP2PImage,$scope.closeP2P=closeP2P,$scope.toggleMinimize=toggleMinimize,$scope.maximize=maximize,$scope.addEmoji=addEmoji,$scope.chatWith=chatWith,$scope.sendText=sendText,$scope.resend=resend,$scope.clickTip=clickTip,$scope.onImageSelect=onImageSelect,$scope.sendImage=sendImage,$scope.getOlderMessage=getOlderMessage,$scope.getMoreContact=getMoreContact,$scope.talkWith=talkWith,$scope.$watchCollection([$scope.gid(),$scope.chatting.userId],function(){$scope.imagePreview.show=!1}),$scope.$on("startP2P",function(){$scope.minimized=!1,$timeout(scrollBottom,10)}),$scope.$watch("showP2P",function(showP2P){showP2P?($scope.lastChatTime=new Date,check=setInterval(function(){(new Date).getTime()-$scope.lastChatTime.getTime()>=6e4&&chatWith($scope.chatting,!0,void 0,!0)},6e4),$timeout(focusInput,100),$timeout(function(){_.isUndefined($scope.chatting)||0===$scope.chatting.userId||($scope.unreadMessages[$scope.chatting.userId]=[])},3e3),$scope.messages&&$scope.messages.length>0&&$timeout(function(){asyncLatestP2PId($scope.chatting.userId,_.last($scope.messages).id)},3e3)):clearInterval(check)}),$scope.$on("p2p.display.show",function($evt,message){message.isSend||message.toUser!=$scope.chatting.userId||($scope.messages.push(message),$scope.recentContacts[0].userId!==$scope.chatting.userId&&($scope.recentContacts=_.reject($scope.recentContacts,function(contact){return contact.userId==$scope.chatting.userId}),$scope.recentContacts.unshift($scope.chatting)),$timeout(scrollBottom,10))}),$scope.$on("p2p.local.async",function($evt,message){message.isSend||message.toUser!=$scope.chatting.userId||!$scope.showP2P||$scope.minimized||asyncLatestP2PId($scope.chatting.userId,message.id)}),$scope.$on("p2p.display.show",function($evt,message){if(message.isSend){if(0===$scope.chatting.userId)return message.fromUser.chatting=!0,$scope.chatting=message.fromUser,$scope.minimizedLatestContact=message.fromUser,$scope.recentContacts=[message.fromUser],$scope.messages=[message],$scope.showP2P||(_.isUndefined($scope.unreadMessages[message.fromUser.userId])&&($scope.unreadMessages[message.fromUser.userId]=[]),$scope.unreadMessages[message.fromUser.userId].push(message),handleUnread()),$scope.minimized&&(unreadStyle(!1),unreadStyle(!0)),void addImage(message);if(message.fromUser.userId===$scope.chatting.userId&&addImage(message),!$scope.showP2P)return _.isUndefined($scope.unreadMessages[message.fromUser.userId])&&($scope.unreadMessages[message.fromUser.userId]=[]),$scope.unreadMessages[message.fromUser.userId].push(message),reorderContacts(message),message.fromUser.userId==$scope.chatting.userId&&$scope.messages.push(message),void handleUnread();if($scope.minimized&&(unreadStyle(!1),unreadStyle(!0),$scope.minimizedLatestContact=message.fromUser),message.fromUser.userId!==$scope.chatting.userId){var recentContact=_.findWhere($scope.recentContacts,{userId:message.fromUser.userId});return recentContact?($scope.unreadMessages[message.fromUser.userId].push(message),$scope.recentContacts=_.reject($scope.recentContacts,function(contact){return contact.userId==recentContact.userId}),$scope.recentContacts.unshift(recentContact)):($scope.unreadMessages[message.fromUser.userId]=[message],$scope.recentContacts.unshift(message.fromUser)),void handleUnread()}return message.fromUser.userId==$scope.chatting.userId?($scope.messages.push(message),$scope.minimized?$scope.unreadMessages[message.fromUser.userId].push(message):$timeout(function(){asyncLatestP2PId($scope.chatting.userId,message.id)},3e3),void($scope.chatting.userId!==$scope.recentContacts[0].userId&&reorderContacts(message))):void $scope.messages.push(message)}}),$scope.$on("p2p.chat",function($evt,user){if($scope.chatting.userId!=user.userId){var chattingPerson=_.findWhere($scope.recentContacts,{userId:user.userId});$scope.minimized=!1,chattingPerson?($scope.recentContacts=_.reject($scope.recentContacts,function(contact){return contact.userId==chattingPerson.userId}),$scope.recentContacts.unshift(chattingPerson),$(".p2p-chat-list  .widget-scroller-wrap").scrollTop(0)):(chattingPerson=new p2pService.Contact(user),$scope.recentContacts.unshift(chattingPerson)),chatWith(chattingPerson,!1)}else{$scope.minimized=!1;var tempContact=_.findWhere($scope.recentContacts,{userId:user.userId});if(tempContact){var idx=_.indexOf($scope.recentContacts,tempContact);-1!==idx&&$(".p2p-chat-list  .widget-scroller-wrap").scrollTop(60*idx<60*$scope.recentContacts.length-450?60*idx:60*$scope.recentContacts.length-450)}}}),$scope.$on("socket.event.14",function($evt,content,value){var otherId=value.fromUser,lastChatId=Number(value.unreadId),tempUnread=$scope.unreadMessages[otherId]||[];tempUnread.length>0&&($scope.unreadMessages[otherId]=_.reject(tempUnread,function(unreadMsg){return Number(unreadMsg.id)<=lastChatId})),handleUnread()}),$scope.$on("socket.reconnect",function(){init()}),init()}}),function(window,document,$){function args(elem){var newAttrs={},rinlinejQuery=/^jQuery\d+$/;return $.each(elem.attributes,function(i,attr){attr.specified&&!rinlinejQuery.test(attr.name)&&(newAttrs[attr.name]=attr.value)}),newAttrs}function clearPlaceholder(event,value){var input=this,$input=$(input);if(input.value==$input.attr("placeholder")&&$input.hasClass("placeholder"))if($input.data("placeholder-password")){if($input=$input.hide().next().show().attr("id",$input.removeAttr("id").data("placeholder-id")),event===!0)return $input[0].value=value;$input.focus()}else input.value="",$input.removeClass("placeholder"),input==document.activeElement&&input.select()}function setPlaceholder(){var $replacement,input=this,$input=$(input),id=this.id;if(""==input.value){if("password"==input.type){if(!$input.data("placeholder-textinput")){try{$replacement=$input.clone().attr({type:"text"})}catch(e){$replacement=$("<input>").attr($.extend(args(this),{type:"text"}))}$replacement.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":id}).bind("focus.placeholder",clearPlaceholder),$input.data({"placeholder-textinput":$replacement,"placeholder-id":id}).before($replacement)}$input=$input.removeAttr("id").hide().prev().attr("id",id).show()}$input.addClass("placeholder"),$input[0].value=$input.attr("placeholder")}else $input.removeClass("placeholder")}var hooks,placeholder,isInputSupported="placeholder"in document.createElement("input"),isTextareaSupported="placeholder"in document.createElement("textarea"),prototype=$.fn,valHooks=$.valHooks;isInputSupported&&isTextareaSupported?(placeholder=prototype.placeholder=function(){return this},placeholder.input=placeholder.textarea=!0):(placeholder=prototype.placeholder=function(){var $this=this;return $this.filter((isInputSupported?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":clearPlaceholder,"blur.placeholder":setPlaceholder}).data("placeholder-enabled",!0).trigger("blur.placeholder"),$this},placeholder.input=isInputSupported,placeholder.textarea=isTextareaSupported,hooks={get:function(element){var $element=$(element);return $element.data("placeholder-enabled")&&$element.hasClass("placeholder")?"":element.value},set:function(element,value){var $element=$(element);return $element.data("placeholder-enabled")?(""==value?(element.value=value,element!=document.activeElement&&setPlaceholder.call(element)):$element.hasClass("placeholder")?clearPlaceholder.call(element,!0,value)||(element.value=value):element.value=value,$element):element.value=value}},isInputSupported||(valHooks.input=hooks),isTextareaSupported||(valHooks.textarea=hooks),$(function(){$(document).delegate("form","submit.placeholder",function(){var $inputs=$(".placeholder",this).each(clearPlaceholder);setTimeout(function(){$inputs.each(setPlaceholder)},10)})}),$(window).bind("beforeunload.placeholder",function(){$(".placeholder").each(function(){this.value=""})}))}(this,document,jQuery),define("placeholder",["jquery"],function(global){return function(){var ret;return ret||global.jQuery}}(this)),define("pagelet/chat/p2p/sendP2PDirective",["underscore","jquery","util/inputTool","util/keycode","atwho","placeholder"],function(_,$,inputTool,KEYCODE){"use strict";return function(){function link(scope,element,attr,ngModel){var caretPos=0;element.attr("placeholder","按回车键发送消息…").placeholder(),element.unbind("input change"),element.bind("input change",function(){var value=this.value;ngModel.$setViewValue(value),scope.$digest()}),scope.$on("sendEmoji",function(evt,emoji){var newValue=inputTool.insertValue(element,caretPos,emoji);ngModel.$setViewValue(newValue),$(".p2p-ft textarea").focus()}),element.on("blur",function(){caretPos=element[0].selectionStart}),element.on("keydown",function(e){return e.keyCode!==KEYCODE.ENTER||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey?e.keyCode===KEYCODE.ENTER&&(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)?(document.execCommand("insertParagraph"),!1):void 0:(scope.send(),!1)}),element.on("paste",function(event){var blob,i,clipboardData=event.clipboardData||event.originalEvent.clipboardData,items=clipboardData.items;if(items)for(i=0;i<items.length;i++)if(0===items[i].type.indexOf("image")&&(blob=items[i].getAsFile(),null!==blob)){var src=URL.createObjectURL(blob);return src&&(scope.imagepreview.src=src,scope.imagepreview.show=!0,scope.imagepreview.blob=blob,scope.imagepreview.type="paste"),event.preventDefault(),scope.$parent.$digest(),!1}})}return{restrict:"A",template:'<textarea placeholder="按回车键发送消息…" max-input-length="2000"></textarea>',replace:!0,require:"^ngModel",scope:{imagepreview:"=",gid:"&",send:"&"},link:link}}}),define("pagelet/chat/p2p/p2pDateFormat",["underscore"],function(_){"use strict";return function(dateFilter){var cache={};return function(date,fmt){var key,value,intervalTime;if(void 0!==date){if(-1===date)return"刚刚";if(intervalTime=Math.round(((new Date).getTime()-date.getTime())/1e3),10>intervalTime)return"刚刚";if(30>intervalTime)return"半分钟前";if(3600>intervalTime)return Math.round(1>intervalTime/60)?"1分钟前":Math.round(intervalTime/60)+"分钟前";if(86400>intervalTime)return Math.round(intervalTime/3600)+"小时前";if(_.isString(fmt)){if(key=date.getTime()/1e3+"@"+fmt,value=cache[key],void 0!==value)return value;value=dateFilter(date,fmt),cache[key]=value}}}}}),define("pagelet/chat/p2p/p2pLocalMsg",["underscore"],function(){"use strict";return function($rootScope,p2pService){function showMessage(json){$rootScope.$broadcast("p2p.display.show",json)}function asyncLocalMessage(json){$rootScope.$broadcast("p2p.local.async",json)}function getLocalId(message){return message.localId}function trigger(localId,value){-1===localIdCache.indexOf(localId)?(localId&&"0"!==localId&&localIdCache.push(localId),localIdCache.length>1e3&&(localIdCache=localIdCache.slice(800)),showMessage(value)):asyncLocalMessage(value)}function handleMessage(evt,json,offLine){if(!offLine){var message=p2pService.Message(json);trigger(getLocalId(message),message)}}var localIdCache=[];$rootScope.$on("socket.p2p.message",handleMessage),this.trigger=trigger,this.getLocalId=getLocalId}}),define("pagelet/chat/p2p/p2pTipDirective",["underscore","jquery"],function(_,$){"use strict";return function($rootScope,$location,$timeout){function link(scope,element){function handler(){var messageHeight=0,elHeight=$p2pMessages.height();$p2pMessages.children().each(function(index,el){messageHeight+=el.offsetHeight}),scope.messageHeight=messageHeight;var position=messageHeight-$p2pMessages.scrollTop();return!isLocked&&elHeight+10>position&&($(".p2p-tip").hide(),scope.showP2Ptip=!1),$p2pMessages.scrollTop()<=20&&scope.getOlderMessage(),!1}function showP2pTip(userId,message){function scrollBottom(){$p2pMessages.scrollTop(1e5)}$p2pMessages=element.find(".p2p-messages"),$p2pTip=element.find(".p2p-tip");var height=0,elHeight=$p2pMessages.height();$p2pMessages.children().each(function(index,el){height+=el.offsetHeight});var pos=height-$p2pMessages.scrollTop();pos>elHeight+100&&0===message.type?(scope.tip=message.fromUser.name+" : "+message.content,isLocked=!1,scope.showP2Ptip=!0):pos>elHeight+100&&2===message.type?(scope.tip=message.fromUser.name+" : 发送了图片",isLocked=!1,scope.showP2Ptip=!0):($timeout(scrollBottom,10),scope.showP2Ptip=!1)}var $p2pTip,$p2pMessages,isLocked;scope.$on("p2p.display.show",function($evt,message){if(message.isSend&&message.fromUser.userId===scope.chatting.userId){var userId=message.fromUser.userId;showP2pTip(userId,message)}}),scope.$watch("p2pMessagesReady",function(ifReady){ifReady?($p2pMessages=element.find(".p2p-messages"),$p2pMessages.bind("scroll",handler)):_.isUndefined($(".p2p-messages"))||$(".p2p-messages").unbind("scroll",handler)})}return{restrict:"A",link:link}}}),define("pagelet/chat/p2p/p2pScrollDirective",["underscore","jquery"],function(){"use strict";return function($rootScope,$timeout){function link(scope,element){function checkUp(){var messageHeight=0;$p2pMessages.children().each(function(index,el){messageHeight+=el.offsetHeight}),messageHeight>preHeight+preScrollTop&&$p2pMessages.scrollTop(messageHeight-preHeight-preScrollTop),scope.messageHeight=messageHeight}var preScrollTop,$p2pMessages,preHeight;scope.$watch("p2pState.pageTailIndex",function(){preHeight=scope.messageHeight,$p2pMessages=element.find(".p2p-messages"),scope.p2pState.pageTailIndex&&(preScrollTop=$p2pMessages.scrollTop(),$timeout(checkUp,5))})}return{restrict:"A",link:link}}}),define("pagelet/chat/p2p/imageFallbackDirective",["underscore"],function(_){return function(){function link($scope,$el,$attr){$el.error(function(e){console.log(e);var altUrl=$attr.src||$el.attr("src");altUrl&&!$scope.fallback&&(altUrl=_.filter(altUrl.split("&"),function(arg){return!(/^width=/.test(arg)||/^height=/.test(arg))}).join("&"),$el.attr("src","style/images/e1588849.placeholder.png"),$el.attr("src",altUrl),$scope.fallback=!0)})}return{restrict:"A",link:link}}}),define("chatModule",["angular","commonModule","pagelet/chat/normal/display/displayCtrl","pagelet/chat/normal/display/text/textCtrl","pagelet/chat/normal/display/voice/voiceCtrl","pagelet/chat/normal/display/image/imageCtrl","pagelet/chat/normal/display/chatScrollDirective","pagelet/chat/normal/display/chatTipDirective","pagelet/chat/normal/display/chatUnreadDirective","pagelet/chat/normal/send/sendMessageDirective","pagelet/chat/normal/display/voice/voiceDirective","pagelet/chat/normal/chatLocalMsg","pagelet/chat/history/historyCtrl","pagelet/chat/history/highlight","pagelet/chat/chatInit","pagelet/chat/p2p/p2pService","pagelet/chat/p2p/p2pCtrl","pagelet/chat/p2p/sendP2PDirective","pagelet/chat/p2p/p2pDateFormat","pagelet/chat/p2p/p2pLocalMsg","pagelet/chat/p2p/p2pTipDirective","pagelet/chat/p2p/p2pScrollDirective","pagelet/chat/p2p/imageFallbackDirective"],function(angular,commonModule,displayCtrl,textCtrl,voiceCtrl,imageCtrl,chatScrollDirective,chatTipDirective,chatUnreadDirective,sendMessageDirective,voiceDirective,chatLocalMsg,chatHistoryCtrl,highlight,chatInit,p2pService,p2pCtrl,sendP2PDirective,p2pDateFormat,p2pLocalMsg,p2pTipDirective,p2pScrollDirective,imageFallbackDirective){return angular.module("chat",[commonModule.name]).config(["$compileProvider",function($compileProvider){$compileProvider.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|file|blob):|data:image\//)}]).controller("displayCtrl",["$scope","$rootScope","$location","$timeout","launcher","userService","vipService","chatService","chatTemplate","dialogService","$document","$q","applicantService","permissionService","MESSAGE_TYPE",displayCtrl]).controller("displayTextCtrl",["$scope","$filter",textCtrl]).controller("displayVoiceCtrl",["$scope",voiceCtrl]).controller("imageCtrl",["$scope","downloadService","clientProxy",imageCtrl]).directive("chatscroll",["$timeout",chatScrollDirective]).directive("chattip",["$rootScope","$location","chatTemplate","pomeloService",chatTipDirective]).directive("chatunread",["$timeout","$animate","$location",chatUnreadDirective]).directive("sendMessage",["$rootScope","storageManager","launcher","chatService","chatLocalMsg","chatTemplate","dialogService","fileManager","clientProxy","uploader","members","LOCAL_STORAGE_KEY",sendMessageDirective]).directive("sendp2p",[sendP2PDirective]).directive("jplayer",["voiceService",voiceDirective]).service("chatLocalMsg",["$rootScope","chatService",chatLocalMsg]).service("p2pLocalMsg",["$rootScope","p2pService",p2pLocalMsg]).controller("chatHistoryCtrl",["$rootScope","$scope","$location","$q","$timeout","chatService","vipService","chatTemplate",chatHistoryCtrl]).directive("highlightMessage",["$location","$document",highlight]).service("p2pService",["$http","$q","launcher",p2pService]).controller("p2pCtrl",["$scope","$rootScope","$timeout","$filter","p2pService","p2pLocalMsg","launcher","uploader","$q","pomeloService","$element","clientProxy",p2pCtrl]).directive("p2ptip",["$rootScope","$location","$timeout",p2pTipDirective]).filter("p2pDateFormat",["dateFilter",p2pDateFormat]).directive("p2pscroll",["$rootScope","$timeout",p2pScrollDirective]).directive("imageFallback",[imageFallbackDirective]).run(["chatTemplate","permissionService","ROLES",chatInit])}),define("pagelet/orgSetting/members/orgMemberService",["underscore"],function(_){"use strict";return function(orgService,dialogs,applicants,$q,$rootScope,alias,launcher,ROLES,NOTIFICATION_TYPE){function getMyRole(){return myRole}function getMembers(){return memberList}function setMemberSortKey(member){return member.sortKey=member.role===ROLES.ORG_OWNER?0:member.role===ROLES.ORG_MANAGER?1:member.role===ROLES.ORG_USER?2:3,member}function sortMembersByRole(members){return _.sortBy(members,function(member){return[member.sortKey,member.aliasName||member.name].join("_")})}function addMember(member,orgId){member.orgId=orgId,member.role=ROLES.ORG_USER,member.sortKey=2,memberList=_.union(memberList,[member])}function removeMember(member){return memberList=_.reject(memberList,function(value){return value.userId===member.userId}),$q.when(memberList)}function changeMemberRole(news){news=new orgService.Member(news),memberList=_.map(memberList,function(member){return member.userId===news.userId&&(member.role=news.role,member=setMemberSortKey(member)),member}),memberList=sortMembersByRole(memberList)}function removeMemberByOther(member){var deferred=$q.defer();return dialogs.confirm("移除","您确定要移除"+member.name+"吗？移除后，该成员所拥有的群将转入您名下。").then(function(){orgService.removeMember(member.orgId,member.userId).then(function(){deferred.resolve(removeMember(member))},function(e){switch(e.error){case"51012":dialogs.alert("提示","抱歉，企业版已过期，暂时无法进行删除操作。购买请联系youdaogroup@service.netease.com。");break;default:dialogs.alert("成员管理","删除失败")}deferred.reject()})}),deferred.promise}function fetchMembers(orgId,user){return null!==defer&&defer.resolve(),defer=$q.defer(),memberList=[],orgService.listMember(orgId).then(function(members){return defer=null,myRole=null,members=_.map(members,function(member){return member.userId===user.userId&&(myRole=member.role,member.name=user.name),member=setMemberSortKey(member)}),members=sortMembersByRole(members),alias.updateAliasList(members),memberList=members,$q.when(null)})}function changeRole(orgId,member,role){return defer=$q.defer(),orgService.changeRole(orgId,member.userId,role).then(function(news){changeMemberRole(news),defer.resolve(news)},function(e){switch(e.error){case"51012":dialogs.alert("提示","抱歉，企业版已过期，暂时无法进行角色修改操作。购买请联系youdaogroup@service.netease.com。").then(function(){defer.reject(e)});break;default:dialogs.alert("成员管理","删除失败").then(function(){defer.reject(e)})}}),defer.promise}function onOrgMemberEvent(evt,content){content.type===NOTIFICATION_TYPE.ORG_ROLE_CHANGED&&(myRole=content.role,$rootScope.$broadcast("org.member.roleChanged",content.orgId,launcher.uid(),myRole))}var memberList=[],myRole=null,defer=null;$rootScope.$on("org.member.add",function(evt,member,orgId){addMember(member,orgId)}),$rootScope.$on("socket.notification",onOrgMemberEvent),this.getMembers=getMembers,this.getMyRole=getMyRole,this.removeMember=removeMemberByOther,this.changeRole=changeRole,this.fetchMembers=fetchMembers}}),define("pagelet/setting/settingCtrl",["underscore"],function(){"use strict";return function($scope,$q){function openTab(tab){return $scope.segment=tab,$q.when(null)}$scope.$open(function(opt){return openTab(opt.tab)}),$scope.$close(function(){$scope.segment=null}),$scope.$invoke(function(opt){return openTab(opt.tab)})}}),define("analyzer",["underscore"],function(){"use strict";var loaded=!1;return window.__rl_npid="ynote-group",function(){var _rl=document.createElement("script");
_rl.type="text/javascript",_rl.async=!0,_rl.src="http://rlogs.youdao.com/rlog.js",_rl.onload=function(){loaded=!0},window.__rl_click=!0,window.__rl_post=[];var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(_rl,s)}(),{event:function(arg){loaded&&window.__rl_event(String(arg))}}}),define("pagelet/setting/members/invitationCtrl",["underscore","analyzer"],function(_,analyzer){"use strict";return function($scope,launcher,dialogs,userService,groupService,dialogService,$timeout,$q,$filter,memberService,client){var timeoutDefer=null,members=null,checkUserAdded=function(list,prefix){var i;for(i=0;i<list.length;i++)list[i].added=!_.isUndefined(_.findWhere(members,{userId:list[i].userId}));$scope.noFound=!1,prefix?($scope.results=[],$scope.users=list):($scope.results=list,$scope.users=[])},getSearchList=function(name){null!==timeoutDefer&&(timeoutDefer.promise.status=499,timeoutDefer.resolve()),$scope.users=[],timeoutDefer=$q.defer(),$scope.searchCompleted=!1,userService.searchPrefix(name,timeoutDefer,launcher.orgId()).then(function(list){return timeoutDefer=null,$scope.searchCompleted=!0,0===list.length?void($scope.noFound=!0):void checkUserAdded(list,!0)})},copyAction=function(){$scope.copyBtnText="复制成功",$scope.copyDone=!0,$timeout(function(){$scope.copyBtnText="复制",$scope.copyDone=!1},5e3)},copyComplete=function(isClient){analyzer.event("clipborad-btn"),isClient===!0?copyAction():$scope.$apply(copyAction)},createQQLink=function(shareUrl){var i,summary=$filter("alias")(launcher.getUser())+"邀请您加入有道云协作"+$scope.group.name+"群",p={url:shareUrl,desc:summary,title:"有道云协作",summary:summary,pics:"http://note.youdao.com/styles/images/logo-icon.png",flash:"",site:"有道云协作",style:"203",width:16,height:16},s=[];for(i in p)p.hasOwnProperty(i)&&s.push(i+"="+encodeURIComponent(p[i]||""));return"http://connect.qq.com/widget/shareqq/index.html?"+s.join("&")},init=function(){$scope.searchName="",$scope.users=[],$scope.copyBtnText="复制",groupService.createInvitationLink(launcher.gid(),function(invitationLink){$scope.invitationUrl=invitationLink.url,$scope.qqInviteLink=createQQLink($scope.invitationUrl),$scope.clipboardOptions={copyValue:invitationLink.url,oncomplete:copyComplete}},function(){console.log("can't get invitationLink")}),members=memberService.getMembers()};$scope.is_3rdLogin=launcher.getUser().is_3rd,$scope.launcher=launcher,$scope.client=client,$scope.searchCompleted=!0,$scope.inviteForUserId=function(userId,added){added||(dialogService.open($scope,{src:"pagelet/sidebar/userInfo/userInfo-dialog.html",userId:userId,isVisit:!0,added:added,cls:"user-info"}),$scope.prefixName="")},$scope.copyTextFromClient=function(){client.copyText($scope.invitationUrl),copyComplete(!0)},$scope.quickAddMember=function(){dialogs.open($scope,{src:"pagelet/setting/members/quickAdd/quickAdd-dialog.html",userId:$scope.uid(),cls:"quick-add"})},$scope.openEmailInvite=function(){dialogs.open($scope,{src:"pagelet/setting/members/invitation/invitation-email.html",userId:$scope.uid(),cls:"invite-by-email"})},$scope.searchPrefix=getSearchList,$scope.copyAction=copyAction,init(),$scope.$on("group.changed",init),$scope.$watch("launcher.getInviteUrl()",function(url){$scope.clipboardOptions={copyValue:url,oncomplete:copyComplete}}),$scope.$on(memberService.EVENT.CHANGED,function(evt,mems){members=mems}),$scope.$watch("prefixName",function(name){name?getSearchList(name):($scope.users=[],$scope.results=[],null!==timeoutDefer&&(timeoutDefer.promise.status=499,timeoutDefer.resolve()))})}}),define("pagelet/setting/members/quickAdd/quickAddCtrl",["underscore"],function(_){"use strict";return function($scope,$rootScope,orgService,dialogService,members,orgMemberService,userService,launcher,applicants,NOTIFICATION_TYPE){function getMembers(){orgMemberService.fetchMembers($scope.orgId,$scope.uid).then(function(){memberList=orgMemberService.getMembers(),$scope.quickList=removeRepeat()})}function removeRepeat(){return _.each($scope.alreadyList,function(member){delById(member.userId)}),memberList}function delById(uid){for(var i=0;i<memberList.length;i++)if(memberList[i].userId==uid)return void(memberList=memberList.slice(0,i).concat(memberList.slice(i+1)))}function getIndex(memberId){for(var i=0;i<memberList.length;i++)if(memberList[i].userId===memberId)return i}function getName(memberId){for(var i=0;i<$scope.selectList.length;i++)if($scope.selectList[i].userId===memberId)return $scope.selectList[i].name}function getInviteUsersId(){for(var i=0;i<$scope.selectList.length;i++)$scope.userIdList.push($scope.selectList[i].userId);return $scope.userIdList.join()}function getInviteMember(memberId){for(var i=0;i<$scope.selectList.length;i++)if($scope.selectList[i].userId==memberId)return $scope.selectList[i]}var $dialog=$scope.$dialog;$dialog.width=540,$dialog.height=330,$scope.$watch("selectNum",function(selectNum){$dialog.buttons[0].disabled=selectNum>0?!1:!0,$rootScope.$on("socket.notification",function(evt,content){content.type===NOTIFICATION_TYPE.KICKED_OUT_FROM_ORG&&$dialog.dismiss()})}),$scope.uid=$scope.uid(),$scope.orgId=$scope.orgId();var firstIndex,lastIndex,memberList=[],failUsersId1=[],failUsersId2=[];$scope.quickList=[],$scope.alreadyList=members.getMembers(),$scope.selectList=[],$scope.userIdList=[],$scope.selectNum=0,getMembers(),$scope.selectMember=function(member,e){if(0==$scope.selectNum&&e.shiftKey){lastIndex=getIndex(member.userId);for(var i=0;lastIndex>=i;i++)memberList[i].selected=!0,$scope.selectList.push(memberList[i]);$scope.selectNum=lastIndex+1}if(firstIndex>=0&&e.shiftKey&&(lastIndex=getIndex(member.userId),lastIndex>firstIndex))for(var j=firstIndex+1;lastIndex>=j;j++)memberList[j].selected||(memberList[j].selected=!0,$scope.selectList.push(memberList[j]),$scope.selectNum++);member.selected||(member.selected=!0,$scope.selectNum++,$scope.selectList.push(member),firstIndex=getIndex(member.userId))},$scope.deleteMember=function(member){member.selected=!1;for(var i=0;i<$scope.selectList.length;i++)if($scope.selectList[i].userId===member.userId){$scope.selectList.splice(i,1),$scope.selectNum--;break}},$scope.filterByNameOrId=function(member){if(_.isUndefined($scope.prefix))return!0;var prefix=$scope.prefix.toLowerCase();return member.userId.toLowerCase().indexOf(prefix)>-1||member.name.toLowerCase().indexOf(prefix)>-1};var cancel=function(){$dialog.dismiss()},confirm=function(){return $scope.selectNum<0?void window.alert("请选择组织成员"):($dialog.buttons[0].disabled=!0,void applicants.inviteOrgMembers($scope.gid(),getInviteUsersId(),null).then(function(json){_.each(json,function(key,value){0==key?$rootScope.$broadcast("userInfo.visit.success",getInviteMember(value)):51002==key?failUsersId1.push(getName(value)):failUsersId2.push(getName(value))}),$dialog.dismiss(),failUsersId1.length>0&&dialogService.alert("提示","以下用户已不在该组织中："+failUsersId1.join(",")),failUsersId2.length>0&&dialogService.alert("提示","抱歉，以下用户暂时无法完成邀请操作，请稍后再试："+failUsersId2.join(","))}).catch(function(e){$dialog.dismiss(),260==e.error?dialogService.alert("提示","抱歉，你已经没有邀请人的权限了"):dialogService.alert("提示","抱歉，暂时无法完成邀请操作，请稍后再试")}))};$dialog.title="选择组织中的成员",$dialog.buttons=[{text:"邀请",cls:"btn btn-confirm",handler:confirm},{text:"取消",cls:"btn btn-cancel cancel",handler:cancel}]}}),define("pagelet/setting/members/membersCtrl",["underscore"],function(_){"use strict";return function($rootScope,$scope,groupService,dialogService,members,launcher,ROLES){var getGroupRole=function(roleArray){var res=_.filter(roleArray,function(role){return role.indexOf("GROUP")>-1});return 1===res.length?res[0]:ROLES.GROUP_VIEWER};$scope.ROLES=ROLES,$scope.ownerId=$scope.uid(),$scope.removeMember=members.removeMember,$scope.changeRole=members.changeRole,$scope.changeOwner=members.changeOwner,$scope.removeInvitee=members.removeInvitee,$scope.myRole=getGroupRole(launcher.getCurrentRole()),$scope.myRoleSortKey=members.getMemberKey($scope.myRole),$scope.members=members.getMembers(),$scope.invitees=members.getInvitees(),$scope.memberLimit=members.getLimitNum(),$scope.group=launcher.getGroup(),launcher.getOrg()?($scope.isOrgGroup=!0,$scope.orgName=launcher.getOrg().name):$scope.isOrgGroup=!1,$scope.$watchCollection(function(){return launcher.getCurrentRole()},function(newRoleArray){$scope.myRole=getGroupRole(newRoleArray),$scope.myRoleSortKey=members.getMemberKey($scope.myRole)}),$scope.$watch(function(){return members.getMembers()},function(memberList){$scope.members=memberList}),$scope.$watch(function(){return members.getInvitees()},function(invitees){$scope.invitees=invitees}),$scope.$on("userInfo.visit.success",function(evt,confirmer){members.addInvitee(confirmer)}),$scope.newP2PDialog=function(user){$rootScope.$broadcast("p2p.chat",user)}}}),define("pagelet/setting/options/optionsCtrl",[],function(){"use strict";return function($scope,$location,$timeout,launcher,masker,groupService,dialogs,clientProxy,settings,permission,ROLES,titleService){var ready=function(){$scope.ready=!0},getMySetting=function(){$scope.group.description=$scope.group.description||"无",groupService.getMyRole($scope.group.id).then(function(me){$scope.settings=me.settings,ready()}).catch(function(){ready()})},init=function(gid){$scope.ready=!1,void 0!==gid&&($scope.group=groupService.getGroup($scope.gid(),getMySetting))},onSave=function(){$scope.saved=!0,clientProxy.updateSetting(),$timeout(function(){$scope.saved=!1},5e3)},onFaield=function(e){e&&"10008"===e.error?dialogs.alert("保存失败","群名或群简介包含特殊字符，请修改后重新保存"):dialogs.alert("保存失败","服务器错误，请稍后重试")},save=function(){var hasPermission=!1;if((-1!==launcher.getCurrentRole().indexOf(ROLES.GROUP_MANAGER)||-1!==launcher.getCurrentRole().indexOf(ROLES.GROUP_FOUNDER))&&(hasPermission=!0),hasPermission){if(!$scope.group.name)return void dialogs.alert("保存失败","群名不能为空");groupService.update($scope.group,function(){titleService.set(titleService.Priority.GROUPNAME,$scope.group.name),settings.update($scope.group.id,$scope.settings.msg).then(onSave).catch(onFaield)},onFaield)}else settings.update($scope.group.id,$scope.settings.msg).then(onSave).catch(onFaield)},dismiss=function(){dialogs.confirmBySrc("解散群","pagelet/setting/options/dismiss-group.html",{}).then(function(){masker.push(),groupService.dismiss($scope.group,masker.pop,masker.pop)})},quit=function(){dialogs.confirm("退出群","您确定要退出该群吗？").then(function(){groupService.quit($scope.group.id)})};$scope.save=save,$scope.quit=quit,$scope.dismiss=dismiss,init($scope.gid())}}),define("pagelet/setting/members/selectUserDirective",["underscore","jquery","util/keycode"],function(_,$,KEYCODE){"use strict";return function(){return{restrict:"A",link:function(scope,element){function findList(evt){input=element.find(".input-name"),items=element.find(".invitation-item"),select=element.find(".select"),evt.keyCode===KEYCODE.UP?(evt.preventDefault(),items&&select.prev().length?(select.removeClass("select"),select=select.prev(),select.addClass("select")):input.focus()):evt.keyCode===KEYCODE.DOWN?(evt.preventDefault(),0===select.length&&items.length>0?(select=items.first(),select.addClass("select")):items&&select.next().length&&(select.removeClass("select"),select=select.next(),select.addClass("select"))):evt.keyCode===KEYCODE.ENTER&&(input.blur(),$(element.find(".select")[0]).click())}var items,input,select;element.on("keydown",findList)}}}}),define("pagelet/setting/members/invitation/emailInvitation",["util/tracker","underscore"],function(tracker,_){"use strict";return function($scope,$q,$filter,launcher,applicants,dialogs){var $dialog=$scope.$dialog;$dialog.width=390,$scope.$watch("inviteeEmail",function(emails){_.isUndefined(emails)&&(emails="");var emailArray=emails.split(","),EMAIL_REGEXP=/([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+>?$/,EMAIL_REGEXP2=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,valid=!0;return _.each(emailArray,function(email){valid=valid&&EMAIL_REGEXP.test(email)&&EMAIL_REGEXP2.test(email)}),emails?void($dialog.buttons[0].disabled=valid?!1:!0):void($dialog.buttons[0].disabled=!0)});var cancel=function(){$dialog.dismiss()},confirm=function(){if(!$scope.inviteeEmail)return void dialogs.alert("请输入收件人");$dialog.buttons[0].disabled=!0;var emails=$scope.inviteeEmail.split(","),promises=[];_.each(emails,function(email){promises.push(applicants.inviteApplicantByEmail($scope.gid(),email,null))}),$q.all(promises).then(function(){$dialog.dismiss(),dialogs.alert("发送成功","邮件发送成功")})};$dialog.title="发送邮件",$dialog.buttons=[{text:"确定",cls:"btn btn-confirm",handler:confirm},{text:"取消",cls:"btn btn-cancel cancel",handler:cancel}]}}),define("settingModule",["angular","commonModule","pagelet/orgSetting/members/orgMemberService","pagelet/setting/settingCtrl","pagelet/setting/members/invitationCtrl","pagelet/setting/members/quickAdd/quickAddCtrl","pagelet/setting/members/membersCtrl","pagelet/setting/options/optionsCtrl","pagelet/setting/members/selectUserDirective","pagelet/setting/members/invitation/emailInvitation"],function(angular,commonModule,orgMemberService,settingCtrl,invitationCtrl,quickAddCtrl,membersCtrl,optionsCtrl,selectUserDirective,emailInvitationCtrl){"use strict";function initialize(launcher,chatTemplate,viewport,permission,ROLES,MESSAGE_TYPE){launcher.wait().then(function(){launcher.getGroupRouter().bind("/setting/{tab}",function(params){viewport.open("setting",params)})}),chatTemplate.extendTemplate(function(data){return data.type===MESSAGE_TYPE.MEMBER?(data.templateUrl="pagelet/setting/members/chat-template.html",!1):void 0}),viewport.extendView(function(register){register("setting","pagelet/setting/setting.html")}),permission.register(ROLES.GROUP_FOUNDER,["setting.invite","setting.changeName","setting.changeDescription","setting.joinValidate","setting.listenMessage","setting.removeGroup","setting.changeRole","setting.removeMember","setting.editNotice"]),permission.register(ROLES.GROUP_MANAGER,["setting.invite","setting.changeName","setting.changeDescription","setting.joinValidate","setting.listenMessage","setting.quitGroup","setting.changeRole","setting.removeMember","setting.editNotice"]),permission.register(ROLES.GROUP_EDITOR,["setting.invite","setting.listenMessage","setting.quitGroup"]),permission.register(ROLES.GROUP_READER,["setting.listenMessage","setting.quitGroup"]),permission.register(ROLES.GROUP_RESTORER,[]),permission.register(ROLES.GROUP_VIEWER,[]),permission.deregister(ROLES.ORG_EXPIRED,["setting.invite","setting.changeName","setting.changeDescription","setting.joinValidate","setting.listenMessage","setting.removeGroup","setting.changeRole","setting.removeMember"])}return angular.module("setting",[commonModule.name]).service("orgMemberService",["organizationService","dialogService","applicantService","$q","$rootScope","aliasService","ROLES",orgMemberService]).controller("settingCtrl",["$scope","$q",settingCtrl]).controller("invitationCtrl",["$scope","launcher","dialogService","userService","groupService","dialogService","$timeout","$q","$filter","members","clientProxy",invitationCtrl]).controller("quickAddCtrl",["$scope","$rootScope","organizationService","dialogService","members","orgMemberService","userService","launcher","applicantService","NOTIFICATION_TYPE",quickAddCtrl]).controller("membersCtrl",["$rootScope","$scope","groupService","dialogService","members","launcher","ROLES",membersCtrl]).controller("optionsCtrl",["$scope","$location","$timeout","launcher","widgetMasker","groupService","dialogService","clientProxy","settings","permissionService","ROLES","titleService",optionsCtrl]).controller("emailInvitationCtrl",["$scope","$q","$filter","launcher","applicantService","dialogService",emailInvitationCtrl]).directive("selectUser",["$parse",selectUserDirective]).run(["launcher","chatTemplate","viewport","permissionService","ROLES","MESSAGE_TYPE",initialize])}),define("pagelet/note/editor/editorCtrl",["jquery","util/fileValidator","util/tracker","util/trackTiming"],function($,validator,tracker,trackTiming){"use strict";return function($scope,$location,$q,$interval,$timeout,viewport,launcher,explorer,router,dialogs,noteMgr,fileMgr,storageMgr,titleService,$element,filePermission,demoService,$rootScope,LOCAL_STORAGE_KEY){function setSearchKey(search){void 0!==search&&($scope.hasSearch=!0,$scope.search.key=String(search))}function CheckAndSave(){($scope.isChanged&&$scope.getContent()!=$scope.content||$scope.temp.title!=$scope.title)&&saveToLocal()}function onOpen(opt){var fileId=opt.fileId,mode=opt.mode||"view",cid=opt.commentId,folderId=opt.folderId;return xmlContentReady=$q.defer(),fileId?openNote(fileId,mode).then(function(file){return $scope.commentId=cid,cid&&($scope.max=!1),bindAll(),$scope.$broadcast("note.search.init"),setSearchKey(opt.search),$timeout(function(){trackTiming.openNote.end().send().clear()}),file.name}):(xmlContentReady.resolve(),newNote(folderId).then(function(){return $scope.commentId=cid,cid&&($scope.max=!1),bindAll(),"新建笔记"}))}function onInvoke(opt){var fileId=opt.fileId,mode=opt.mode||"view";return stopEdit().then(function(){return fileId?opt.reload?(delete opt.reload,openNote(fileId,mode)):xmlContentReady.promise.then(function(file){return $scope.state.nomore=!1,$scope.state.more=!1,$scope.loading=!0,$scope.meta=!!storage.get(LOCAL_STORAGE_KEY.FILE_META_EXPANDED),switchMode(mode),editing(),file}):newNote()}).then(function(file){return opt.hasOwnProperty("commentId")?($scope.commentId=opt.commentId,$scope.max=!1):delete $scope.commentId,$scope.$broadcast("note.search.init"),setSearchKey(opt.search),file?file.name:"新建笔记"})}function onClose(){return stopEdit().then(function(){$scope.hasSearch=!1,$scope.$broadcast("note.search.destroy"),$scope.searchResult.list=[],$scope.search.key=void 0,clear(),$scope.clearEditor(),unbindAll()})}function bindAll(){watchers=[router.before(interceptRouter),$scope.$on("comment.nomore",noMoreComment),$scope.$on("group.dismiss.this",purge),$scope.$on("group.quit.this",purge),$scope.$on("file.remove",onFileRemove),$scope.$watchCollection("note",onFileChanged),$scope.$on("note.import",reloadNote),$scope.$on("note.diff.revert",reloadNote),$scope.$on("file.update",onNoteUpdate),$scope.$on("note.search.open",openSearchBox),$scope.$on("note.search.close",closeSearchBox)],$(window).on("beforeunload",interceptUnload),editingInterval=$interval(_.throttle(editing,15e3),15e3,0,!1)}function unbindAll(){$(window).unbind("beforeunload",interceptUnload),_.each(watchers,function(unwatch){unwatch()}),watchers=[],$interval.cancel(editingInterval)}function purge(){unbindAll(),clear()}function interceptRouter(){return"edit"!==$scope.mode?void(preventCheck=!0):(CheckAndSave(),isDirty()?stopEdit():void(preventCheck=!0))}function interceptUnload(){return"edit"===$scope.mode&&(CheckAndSave(),isDirty())?"关闭浏览器已编辑的内容将会丢失":void 0}function newNote(folderId){return $scope.note=null,$scope.modifiers=[],$scope.meta=!1,$scope.focusTitle=!0,$scope.folderId=folderId,$scope.title=$scope.content="",switchMode("edit"),$q.when(null)}function openNote(fileId,mode){return $scope.state.more=!1,$scope.state.nomore=!1,$scope.loading=!0,$scope.meta=!!storage.get(LOCAL_STORAGE_KEY.FILE_META_EXPANDED),loadNoteAndContent(fileId).then(function(file){return switchMode(mode),$scope.state.more=!1,editing(),file}).catch(function(e){var reason="";return"20101"==e.error?reason="笔记不存在或已经被删除":"260"===e.error&&(reason="无法查看该笔记，仅群管理员或群主可见"),$scope.loading=!1,dialogs.alert("打开笔记","打开笔记失败"+(reason?"，"+reason:"")),$q.reject()})}function switchMode(mode){var localCopy;return $scope.mode=mode,$scope.isChanged=!1,"edit"!==mode?void(autoSaved=!1):(localCopy=storage.get(getLocalKey()),$scope.temp.title=localCopy?localCopy.title:$scope.title,xmlContentReady.promise.then(function(){localCopy?($scope.isChanged=!0,$scope.temp.content=localCopy.content):$scope.temp.content=$scope.content}),localCopy&&$scope.note&&$scope.note.version!=localCopy.ver?dialogs.open({title:"提示",src:"pagelet/note/editor/local-conflict.html",width:320,modifier:$scope.note.modifier,buttons:[{text:"是",handler:function($dialog){$dialog.dismiss()},cls:"primary"},{text:"否",cls:"cancel",handler:function($dialog){$dialog.cancel(!1)}}]}).then(function(){clearLocal(),$scope.temp.content=$scope.content,$scope.temp.title=$scope.title}):void 0)}function saveToLocal(force){var localCopy,key=getLocalKey();return $scope.temp.content=$scope.getContent(),$scope.scrollPosition=$scope.getScrollTop(),$scope.temp.title||$scope.temp.content?(localCopy=storage.get(key),!force&&_.isEqual(_.pick($scope,"title","content"),$scope.temp)?void clearLocal():void(!force&&localCopy&&_.isEqual(_.pick(localCopy,"title","content"),$scope.temp)||storage.put(key,_.extend({ver:$scope.note?$scope.note.version:-1},$scope.temp),!0)&&hintSave(force))):void 0}function hintSave(force){force?explorer.hint("笔记已保存","success"):autoSaved||(explorer.hint("笔记已自动保存","success"),autoSaved=!0)}function clearLocal(){storage.remove(getLocalKey())}function loadNoteAndContent(fileId){return $scope.loading=!0,$scope.commentLoading=!0,$q.all([fileMgr.getFile($scope.gid(),fileId),noteMgr.getContent($scope.gid(),fileId,void 0,!0)]).then(function(res){return setNote(res[0]),$scope.htmlContent=filterContent(res[1]),$scope.content=null,demoService.setNote($scope.title,$scope.htmlContent),res[0]}).then(function(file){return noteMgr.getContent($scope.gid(),fileId).then(function(data){$scope.content=filterContent(data),xmlContentReady.resolve(file)}),file}).finally(function(){$scope.commentLoading=!1,$scope.loading=!1,$scope.isChanged=!1})}function editing(){return $scope.note?"edit"===$scope.mode?fileMgr.startEdit($scope.gid(),$scope.note.id).then(function(modifiers){var uid=launcher.getUser().userId;$scope.modifiers=_.filter(modifiers,function(modifier){return modifier.userId!=uid})}):fileMgr.getModifiers($scope.gid(),$scope.note.id).then(function(modifiers){var uid=launcher.getUser().userId;$scope.modifiers=_.filter(modifiers,function(modifier){return modifier.userId!=uid})}).catch(function(e){e&&e.data&&"260"===e.data.error&&$interval.cancel(editingInterval)}):$q.when()}function setNote(file){$scope.note=file,$scope.title=file.name.substring(0,file.name.lastIndexOf(".note")),fileMgr.getFilePath($scope.note.gid,$scope.note.parentId).then(function(path){$scope.filePath=path}).catch(function(){$scope.filePath="读取路径失败"})}function edit(){launcher.getGroupRouter().forward("/note/"+$scope.note.id,{mode:"edit",uncollab:!0})}function saveAndQuit(){var noteId;return $scope.fullScreen?(noteId=$scope.note.id,save().then(function(){$scope.mode="view",reloadNote(null,$scope.note)})):save().then(stopEdit).then(clear).then(function(){return $scope.clearEditor(),quit()})}function quit(){return trackTiming.closeNote.clear().start(),explorer.restore()}function stopEdit(){return preventCheck?(preventCheck=!1,$q.when(!1)):"edit"!=$scope.mode?$q.when(!1):isDirty()?dialogs.open({title:"退出编辑",src:"pagelet/note/editor/quit.html",width:370,height:30,buttons:[{text:"保存",handler:function($dialog){$dialog.dismiss(!0)},cls:"primary"},{text:"不保存",cls:"cancel",handler:function($dialog){$dialog.dismiss(!1)}},{text:"取消",cls:"cancel",handler:function($dialog){$dialog.cancel()}}]}).then(function(toSave){return toSave?save():($scope.temp.content=$scope.content,$scope.temp.title=$scope.title,!1)}).then(function(saved){return $scope.note&&fileMgr.stopEdit($scope.gid(),$scope.note.id),saved}):$scope.note?(fileMgr.stopEdit($scope.gid(),$scope.note.id),$q.when(!1)):$q.when(!1)}function save(){function doCreate(){function createError(e){return e&&"20101"==e.error?(createToAnotherFolder(),$q.reject("noParentFolder")):e?error(e).then(doCreate).then(function(){$scope.temp.title=$scope.title}):$q.reject(e)}function createToAnotherFolder(){return dialogs.open({src:"pagelet/file/selector/selector-dialog.html",title:"保存到",width:360,height:360,gid:$scope.gid(),except:[{name:title+".note"}],selectType:"folder"}).then(function(toFolder){return $scope.folderId=toFolder.id,saveAndQuit()})}return $scope.saving=!0,function(){return $scope.folderId?noteMgr.createNote($scope.gid(),$scope.folderId,title||"无标题笔记",content).then(success).catch(createError):(createToAnotherFolder(),$q.reject("noParentFolder"))}().finally(function(){$scope.saving=!1})}function doUpdate(){function checkVersion(){return fileMgr.getFile($scope.gid(),$scope.note.id).then(function(file){return file.version!==$scope.note.version?dialogs.open({title:"提示",src:"pagelet/note/editor/save.html",width:320,height:100,modifier:file.modifier,buttons:[{text:"是",handler:function($dialog){$dialog.dismiss()},cls:"primary"},{text:"否",cls:"cancel",handler:function($dialog){$dialog.cancel(!1)}}]}):void 0}).catch(updateError)}function postUpdate(){return $scope.content===content?fileMgr.rename($scope.gid(),$scope.note,(title||"无标题笔记")+".note").then(success).catch(updateError):noteMgr.updateNote($scope.gid(),$scope.note.id,title||"无标题笔记",content).then(success).catch(updateError)}function updateError(e){if(e&&"20101"==e.error)saveOnFileRemove("保存","取消");else if(e)return error(e).then(doUpdate);return $q.reject(e)}return $scope.saving=!0,checkVersion().then(postUpdate).finally(function(){$scope.saving=!1})}function success(file){return clearLocal(),setNote(file),$scope.temp.title=$scope.title,$scope.content=$scope.temp.content=content,file}function error(e){if(e&&"20108"==e.error){if(e.adviceName)return dialogs.confirm("发布笔记","目录中有重名笔记，是否重命名为："+e.adviceName,{ok:"是",cancel:"否"}).then(function(){title=e.adviceName.replace(/.note$/,"")});dialogs.alert("发布笔记","目录中有重名笔记，请输入其他标题")}else e&&(e.error&&"20114"===e.error?dialogs.alert("发布笔记","当前群中的文件数已经到达上限，请删除不必要的文件后重新发布"):e.error&&"10024"===e.error?launcher.getGroup().isVip?dialogs.alert("发布笔记","群存储容量已满，无法增加新笔记。请删除不必要的文件后重新发布"):launcher.getGroup().owner===launcher.uid()?(tracker.event("exceed","exceed-space-show","exceed-space-noteimoprt"),dialogs.alertBySrc("发布笔记","pagelet/file/upload/exceed-spaceQuota.html",{height:"auto"})):dialogs.alert("发布笔记","群存储容量已满，无法增加新笔记。如需添加更多笔记，请联系群主升级到企业版。"):e.error&&"260"===e.error?dialogs.alert("发布笔记","无法保存该笔记，仅该群管理员或群主可保存"):dialogs.alert("发布笔记","保存失败"));return $q.reject(e)}var errMsg,content=$scope.getContent(),title=$scope.temp.title;return $scope.content!==content&&$scope.isChanged!==!1||$scope.title!==title?(errMsg=validator(title,!0),errMsg?dialogs.alert("发布笔记",'标题含有不合法字符，请修改后再试。不合法字符包括 \\ / : * ? " < > | ').then(function(){return $scope.saving=!1,$q.reject()}):null==$scope.note?doCreate():doUpdate()):$q.when($scope.note)}function onFileRemove($evt,file){$scope.note&&$scope.note.id===file.id&&("view"===$scope.mode?dialogs.alert("提示","该笔记已被群内其他成员删除了").then(quit):saveOnFileRemove("保存","退出").catch(function(){clear(),quit()}))}function saveOnFileRemove(ok,cancel){return dialogs.confirm("发布笔记","该笔记已被群内其他成员删除了，是否保存为新的笔记？",{ok:ok,cancel:cancel}).then(function(){return $scope.folderId=$scope.note.parentId,$scope.note=$scope.title=$scope.content=null,saveAndQuit()})}function isDirty(){var localCopy=storage.get(getLocalKey());return localCopy?!1:$scope.temp.title!=$scope.title||$scope.isChanged&&$scope.getContent()!=$scope.content}function hasLocalModification(){if(!filePermission.check("note.edit",$scope.note))return!1;var localCopy=storage.get(getLocalKey());return localCopy?localCopy.title!=$scope.title||localCopy.content!=$scope.content:!1}function clear(){hasLocalModification()||clearLocal(),$scope.note=$scope.title=$scope.content=$scope.temp.title=$scope.temp.content=null,switchMode(null)}function onFileChanged(note){note&&setNote(note)}function getLocalKey(){return $scope.note?"note_"+$scope.note.id:"note_new_"+$scope.gid()}function reloadNote(evt,note){var mode=$scope.mode;if(!$scope.note||$scope.note.id===note.id)return $scope.fullScreen&&titleService.set(titleService.Priority.FILENAME,note.name),clearLocal(),clear(),xmlContentReady=$q.defer(),viewport.open("note",{fileId:note.id,mode:mode,reload:!0})}function onNoteUpdate(evt,note){$scope.note&&$scope.note.id==note.id&&$scope.fullScreen&&titleService.set(titleService.Priority.FILENAME,note.name)}function onScroll(bottom){$scope.state.nomore||10>bottom&&$scope.$apply(function(){$scope.state.more=!0})}function noMoreComment(){$scope.state.nomore=!0}function filterContent(content){return content}function openSearchBox(){$scope.$apply(function(){$scope.hasSearch=!0}),$element.find("#search-key").focus()}function closeSearchBox(){$scope.hasSearch=!1,$scope.search.key=""}function onOpenFolder(fileId){explorer.locateFile(fileId)}function toggleMeta(){$scope.meta=!$scope.meta,storage.put(LOCAL_STORAGE_KEY.FILE_META_EXPANDED,$scope.meta)}var watchers,editingInterval,xmlContentReady,autoSaved=!1,preventCheck=!1,storage=storageMgr.forUser(launcher.uid());$scope.state={},$scope.content=null,$scope.temp={},$scope.loading=!1,$scope.mode=null,$scope.modifiers=[],$scope.more=!1,$scope.explorer=explorer,$scope.hasLocalModification=hasLocalModification,$scope.clearLocal=clearLocal,$scope.saveToLocal=saveToLocal,$scope.quit=quit,$scope.edit=edit,$scope.saveAndQuit=saveAndQuit,$scope.onScroll=onScroll,$scope.commentLoading=!1,$scope.filePath="",$scope.onOpenFolder=onOpenFolder,$scope.toggleMeta=toggleMeta,$scope.$open(onOpen),$scope.$invoke(onInvoke),$scope.$close(onClose),$scope.searchResult={list:[]},$scope.search={},$scope.$watch("temp.content",function(newVal){newVal&&$scope.$broadcast("note.contentChange",newVal)}),$scope.getPosition=function(index){return $scope.searchResult.list[index].highlightPos},$rootScope.$on("group.dismiss.copy",function(){"edit"===$scope.mode&&(preventCheck=!0)})}}),define("pagelet/note/editor/adapter/bbeditorAdapter",["jquery","underscore"],function($,_){"use strict";return function(el,$injector){function isBulbNote(data){return data?0===data.indexOf("<?xml"):!0}function getBody(){return ctEl.find(".note-view-wrapper")}function getWindow(){return $(ctEl.ownerDocument.defaultView)}function setHtml(html,force){html=html||"",(cachedHtml!==html||force)&&editor.getContent()!==html&&(editor.setContent(html,!isBulbNote(html)),cachedHtml=html)}function getHtml(){return editor.getContent()}function setMenuProvider(provider){menuProvider=provider}function setAttachmentProvider(provider){attachmentProvider=provider}function setDownloadProvider(provider){downloadProvider=provider}function setLinkProvider(provider){linkProvider=provider}function setListener(provider){contentListener=provider}function setImageProvider(provider){imageProvider=provider}function insertImage(){}function setPasteProvider(provider){pasteProvider=provider}function destroy(){}function setSaveProvider(provider){saveProvider=provider}function onContentChanged(){contentListener()}function onRequestLink(url,callback){_.isFunction(url)&&(callback=url,url=""),linkProvider(url||"",callback)}function onRequestPhoto(callback,url){imageProvider(url||"",callback)}function onRequestAttachment(callback,isRepalce){attachmentProvider(function(data){callback(data.icon?{fileName:data.name,resource:data.url,src:data.icon,fileLength:data.size}:{src:data.url})},isRepalce)}function onLinkClick(href){window.open(href)}function onRequestDownload(url,name){downloadProvider(name,url)}function onRequestContextMenu(position,items,callback){function onItemClick(item){setTimeout(function(){callback(item.index)})}var rect=$frame.get(0).getBoundingClientRect(),frameLeft=rect.left,frameTop=rect.top;contextMenu=menuProvider(_.chain(items).filter(function(item){return!(0!==item.type&&2!==item.type||item.isDisabled||item.isHidden)}).map(function(item){var resultItem;return resultItem=2===item.type?{type:3}:{index:item.index,label:item.label,name:"editor-"+item.index,handler:onItemClick}}).value(),position.left+frameLeft,position.top+frameTop)}function onEditorReady(initDefer){initDefer.resolve({setHtml:setHtml,getHtml:getHtml,getBody:getBody,getWindow:getWindow,destroy:destroy,setAttachmentProvider:setAttachmentProvider,setDownloadProvider:setDownloadProvider,setLinkProvider:setLinkProvider,setListener:setListener,setMenuProvider:setMenuProvider,insertImage:insertImage,setImageProvider:setImageProvider,setSaveProvider:setSaveProvider,setPasteProvider:setPasteProvider})
}function onShowWords(ws){$injector.get("dialogService").alert("字数统计","总计字数："+ws,{width:200})}function onSaveContent(){saveProvider()}function onPaste(event,callback){pasteProvider(event,callback)}function loadEditor(){var deferred=$q.defer();return $frame=$('<iframe src="/editor/web/bulb.html"></iframe>').appendTo(el),$frame.load(function(){editor=$frame.contents().get(0).defaultView.editor,ctEl=$frame.contents().find("#wrapper"),onEditorReady(deferred),editor.on("content-change",onContentChanged).on("insert-link",onRequestLink).on("insert-photo",onRequestPhoto).on("insert-attachment",onRequestAttachment).on("replace-image",onRequestPhoto).on("replace-attachment",function(callback){onRequestAttachment(callback,!0)}).on("open-link",onLinkClick).on("download-attachment",onRequestDownload).on("context-menu",onRequestContextMenu).on("show-words",onShowWords).on("save-content",onSaveContent).on("blob-paste",onPaste)}),deferred.promise}var ctEl,editor,contextMenu,contentListener,menuProvider,linkProvider,imageProvider,attachmentProvider,downloadProvider,saveProvider,pasteProvider,$frame,cachedHtml,$q=$injector.get("$q");return loadEditor()}}),define("pagelet/note/editor/adapter/collabeditorAdapter",["jquery","underscore"],function($,_){"use strict";function getParameter(paramName){var i,val,searchString=window.location.search.substring(1),params=searchString.split("&");for(i=0;i<params.length;i++)if(val=params[i].split("="),val[0]===paramName)return val[1];return null}return function(el,$injector){function isBulbNote(data){return data?0===data.indexOf("<?xml"):!0}function getBody(){return ctEl.find(".note-view-wrapper")}function getWindow(){return $(ctEl.ownerDocument.defaultView)}function setHtml(html){html=html||"",editor.setContent(html,!isBulbNote(html))}function getHtml(needHtml){return editor.getContent(needHtml)}function setMenuProvider(provider){menuProvider=provider}function setAttachmentProvider(provider){attachmentProvider=provider}function setDownloadProvider(provider){downloadProvider=provider}function setLinkProvider(provider){linkProvider=provider}function setListener(provider){contentListener=provider}function setImageProvider(provider){imageProvider=provider}function insertImage(){}function setPasteProvider(provider){pasteProvider=provider}function setSessionChangeListener(listener){sessionChangeListener=listener}function setHintProvider(provider){hintProvider=provider}function destroy(){}function setSaveProvider(provider){saveProvider=provider}function onContentChanged(){contentListener()}function onRequestLink(url,callback){_.isFunction(url)&&(callback=url,url=""),linkProvider(url||"",callback)}function onRequestPhoto(callback,url){imageProvider(url||"",callback)}function onRequestAttachment(callback){attachmentProvider(function(data){callback(data.icon?{fileName:data.name,resource:data.url,src:data.icon,fileLength:data.size}:{src:data.url})})}function onLinkClick(href){window.open(href)}function onRequestDownload(url,name){downloadProvider(name,url)}function resetEditor(){editor.reset()}function buildCollabSession(){editor.closedSeseion=void 0,console.log("build collab session"),editor.buildCollabSession()}function convert(data,toXML){return toXML?BulbEditor.html2xml(data):BulbEditor.xml2html(data)}function onRequestContextMenu(position,items,callback){function onItemClick(item){setTimeout(function(){callback(item.index)})}var rect=$frame.get(0).getBoundingClientRect(),frameLeft=rect.left,frameTop=rect.top;contextMenu=menuProvider(_.chain(items).filter(function(item){return!(0!==item.type&&2!==item.type||item.isDisabled||item.isHidden)}).map(function(item){var resultItem;return resultItem=2===item.type?{type:3}:{index:item.index,label:item.label,name:"editor-"+item.index,handler:onItemClick}}).value(),position.left+frameLeft,position.top+frameTop)}function setSessionBuiltProvider(handler){sessionBuiltHandler=handler}function setSessionErrorHandler(handler){sessionErrorHandler=handler}function setDatacommandSuccessHandler(handler){datacommandSuccessHandler=handler}function onEditorReady(initDefer){initDefer.resolve({setHtml:setHtml,getHtml:getHtml,getBody:getBody,getWindow:getWindow,destroy:destroy,setAttachmentProvider:setAttachmentProvider,setDownloadProvider:setDownloadProvider,setLinkProvider:setLinkProvider,setListener:setListener,setMenuProvider:setMenuProvider,insertImage:insertImage,setImageProvider:setImageProvider,setSaveProvider:setSaveProvider,setPasteProvider:setPasteProvider,setSessionChangeListener:setSessionChangeListener,setHintProvider:setHintProvider,setSessionInitializedProvider:setSessionInitializedProvider,setSessionBuiltProvider:setSessionBuiltProvider,closeCollabSession:closeCollabSession,resetEditorOptions:resetEditorOptions,saveNotification:saveNotification,getNoteVersion:getNoteVersion,setSessionErrorHandler:setSessionErrorHandler,setDatacommandSuccessHandler:setDatacommandSuccessHandler,reset:resetEditor,buildSession:buildCollabSession,convert:convert})}function onShowWords(ws){$injector.get("dialogService").alert("字数统计","总计字数："+ws,{width:200})}function onSaveContent(){saveProvider()}function onPaste(event,callback){pasteProvider(event,callback)}function onSessionChange(memberMap){sessionChangeListener(memberMap)}function setSessionInitializedProvider(provider){sessionInitializedProvider=provider}function closeCollabSession(){var collabEditor=editor._editor;return editor.closedSeseion=!0,collabEditor.closeCollabSession()}function datacommandSuccess(cmd){datacommandSuccessHandler(cmd)}function onSessionClose(reason){editor.closedSeseion===!0?editor.closedSeseion=void 0:sessionErrorHandler(reason)}function sessionInitialized(success,reason){sessionInitializedProvider(success,reason)}function useractionFailed(errorMessage){hintProvider(errorMessage,"error"),console.warn(errorMessage)}function resetEditorOptions(options){var collabEditor=editor._editor;return collabEditor.resetEditorOptions(options)}function saveNotification(version){return editor.saveNotification(version)}function getNoteVersion(){return editor.getNoteVersion()}function onSessionBuilt(isCollabStarted){sessionBuiltHandler(isCollabStarted)}function loadEditor(){var deferred=$q.defer();return window.logLevel=getParameter("logLevel"),$frame=$('<iframe id="collab-editor" src="/editor/collab/bulb.html"></iframe>').appendTo(el),$frame.load(function(){var iframWindow=$frame.contents().get(0).defaultView;editor=iframWindow.editor,BulbEditor=iframWindow.BulbEditor,ctEl=$frame.contents().find("#wrapper"),onEditorReady(deferred),editor.on("content-change",onContentChanged).on("insert-link",onRequestLink).on("insert-photo",onRequestPhoto).on("insert-attachment",onRequestAttachment).on("replace-image",onRequestPhoto).on("replace-attachment",onRequestAttachment).on("open-link",onLinkClick).on("download-attachment",onRequestDownload).on("context-menu",onRequestContextMenu).on("show-words",onShowWords).on("save-content",onSaveContent).on("blob-paste",onPaste).on("collabsession-change",onSessionChange).on("datacommand-success",datacommandSuccess).on("session-built",onSessionBuilt).on("session-closed",onSessionClose).on("session-initialized",sessionInitialized).on("useraction-failed",useractionFailed)}),deferred.promise}var ctEl,editor,contextMenu,contentListener,menuProvider,linkProvider,imageProvider,attachmentProvider,downloadProvider,saveProvider,pasteProvider,$frame,sessionChangeListener,hintProvider,sessionInitializedProvider,sessionErrorHandler,sessionBuiltHandler,datacommandSuccessHandler,BulbEditor,$q=$injector.get("$q");return loadEditor()}}),define("pagelet/note/editor/adapterFactory",["pagelet/note/editor/adapter/bbeditorAdapter","pagelet/note/editor/adapter/collabeditorAdapter"],function(bbeditorAdapter,ceditorAdapter){"use strict";return function(){return{bulb:function(el,$injector,dialogs){return bbeditorAdapter(el,$injector,dialogs)},collab:function(el,$injector,dialogs){return ceditorAdapter(el,$injector,dialogs)}}}}),define("pagelet/note/editor/editorDirective",["underscore","pagelet/note/editor/adapterFactory","util/keycode"],function(_){"use strict";return function($parse,$injector,factory,dialogs,downloadService,menuService,uploader,client,selectFiles,$timeout){function link(scope,el){function onEditorChanged(){scope.isChanged=!0}function createLink(url,callback){scope.$apply(function promptInput(){dialogs.prompt(url?"编辑超链接":"插入超链接",url||"http://",{maxlength:500}).then(function(value){return/^(\w+):\/\/.+$/.test(value)?void callback(value):void dialogs.alert("插入超链接","请输入正确的超链接").then(promptInput)})})}function createImage(url,callback){scope.$apply(function(){selectFiles.open(null,"resource","image/*").then(function(tasks){dialogs.open({gid:scope.gid(),title:url?"重新上传图片":"上传图片",src:"pagelet/note/editor/attachment.html",tasks:tasks}).then(function(data){setTimeout(function(){callback(data.url)},0)})})})}function createContextMenu(items,x,y){menu=menuService.open({items:items,x:x,y:y})}function closeContextMenu(){menuService.close()}function getUploadUrl(gid){return["/yws/api/group/"+gid+"/noteresource?method=startUpload","/yws/api/group/"+gid+"/noteresource?method=uploadProgress","/yws/api/group/"+gid+"/noteresource?method=completeUpload"]}function onPaste(e,callback){var task,items=e.originalEvent.clipboardData.items;items&&1===items.length&&0==items[0].type.indexOf("image")&&(task=uploader.createTask("resource",items[0].getAsFile(),"截图.png"),task.append("method","put-resource"),task.append("resourceType",1),task.resumeUpload(getUploadUrl(scope.gid())).then(function(res){res=_.isObject(res.text)?res.text:JSON.parse(res.text),callback(res.resourceUrl)}))}function onSave(){scope.$apply(function(){scope.saveToLocal(!0)})}function uploadAttachment(callback,isReplace){scope.$apply(function(){selectFiles.open(null,"resource").then(function(tasks){var fileName=tasks[0].name().toLowerCase(),imageRegex=/.*\.png|jpeg|jpg|gif|bmp$/;return isReplace&&imageRegex.test(fileName)?void dialogs.alert("上传附件","您选择的是图片格式，请使用“图片”按钮来上传!"):void dialogs.open({gid:scope.gid(),title:"上传附件",src:"pagelet/note/editor/attachment.html",tasks:tasks}).then(function(data){setTimeout(function(){callback(data)},0)})})})}function downloadAttachment(name,url){setTimeout(function(){downloadService.download(name,url.replace(/^http:\/\/note\.youdao\.com/i,""))},0)}function syncScroll(){editor&&editor.getBody().scrollTop(scope.scrollPosition||0)}function onDestroy(){editor.destroy()}var editor,cachedHtml,menu,editorReady,setContent;setContent=function(){var setterTimeout,setter=function(){editorReady?editor.setHtml(cachedHtml):(setterTimeout&&$timeout.cancel(setterTimeout),setterTimeout=$timeout(setter,10,!1))};return function(event,content){null!==content&&(cachedHtml=content,setter(),syncScroll())}}(),scope.$on("note.contentChange",setContent),scope.$on("$destroy",onDestroy),factory.bulb(el,$injector).then(function(adapter){editor=adapter,editor.setAttachmentProvider(uploadAttachment),editor.setDownloadProvider(downloadAttachment),editor.setLinkProvider(createLink),editor.setListener(onEditorChanged),editor.setMenuProvider(createContextMenu),editor.setImageProvider(createImage),editor.setHtml(cachedHtml),editor.setSaveProvider(onSave),editor.setPasteProvider(onPaste),editor.getBody().on("mousedown",closeContextMenu),syncScroll(),editorReady=!0}),scope.getContent=function(){return editorReady?editor.getHtml():void 0},scope.clearEditor=function(){editorReady&&editor.setHtml("",!0)},scope.getScrollTop=function(){return editor?editor.getBody().scrollTop():void 0}}return{restrict:"A",link:link}}}),define("pagelet/note/editor/contentDirective",["jquery","underscore","util/keycode","util/mime"],function($,_,KEYCODE,mime){"use strict";return function(dialogs,downloadService,menuService,previewSlide,clientProxy,fileManager){function link(scope,iframe){function onContextMenu(e){var selection,$el=$(e.target);if("img"==$el.prop("tagName").toLowerCase()&&void 0!==$el.attr("filename")&&e.preventDefault(),clientProxy.isPC()){if(e.preventDefault(),$el.is("img")&&$el.attr("src"))return void menuService.open($el.attr("filename")?{x:e.pageX,y:e.pageY,items:[{label:"另存为",handler:downloadService.download.bind(downloadService,$el.attr("filename"),$el.attr("path").replace(/^http:\/\/note\.youdao\.com/i,""))}]}:{x:e.pageX,y:e.pageY,items:[{label:"另存为",handler:downloadImage.bind(this,$el.attr("src"))}]});selection=iframe[0].contentWindow.getSelection(),"Range"===selection.type&&menuService.open({x:e.pageX,y:e.pageY,items:[{label:"复制",handler:copyText}]})}}function downloadImage(src){downloadService.download("",src.replace(/^http:\/\/note\.youdao\.com/i,""))}function copyText(){doc[0].execCommand("copy")}function onImgClick(e){var $el=$(e.currentTarget);return $el.attr("path")?void downloadService.download($el.attr("title")||$el.attr("filename"),$el.attr("path").replace(/^http:\/\/note\.youdao\.com/i,"")):($(document.activeElement).blur(),void previewImage($el))}function previewImage(imgEl){imageItems||(imageItems=[],doc.find("img").each(function(index,el){var item;el=$(el),el.attr("path")||(item={index:index,preSrc:el.attr("src").replace(location.protocol+"//"+location.hostname,""),src:el.attr("src").replace(location.protocol+"//"+location.hostname,""),name:""},el.data("previewItem",item),imageItems.push(item))})),previewSlide.open(imgEl.data("previewItem"),imageItems)}function onLinkClick(e){var $el=$(e.currentTarget);$el.attr("target","_blank")}function highlightInnerlink(node){function setFileClass(href,$el){$el.css("textDecoration","none"),idLink=href.split("group")[1],gid=idLink.split("/")[1],fileId=idLink.split("/")[3],fileManager.getFile(gid,fileId).then(function(file){setFileName($el.get(0),file.name),file.isFolder?className="type_folder_small":(ext=file.name?file.name.toLowerCase().substring(file.name.lastIndexOf(".")+1):"",cls=mime[ext],className=void 0===cls?"type_other_small":"type_"+cls+"_small"),clientProxy.isSafari()||$el.prepend('<svg class="innerlink-icon"><use xlink:href="http://note.youdao.com/group/7d2951b9.icons.svg#'+className+'"></use></svg>')})}function setFileName(aNode,name){for(i=0;i<aNode.childNodes.length;i++)childNode=aNode.childNodes[i],1===childNode.nodeType?setFileName(childNode,name):3===childNode.nodeType&&$(childNode.parentNode).text(name)}if(0!==node.childNodes.length){var i,href,idLink,gid,fileId,className,ext,cls,childNode,re=/group\/[0-9]+\/(folder|note|table|image|office|detail|pdf|text|md)\/[0-9]+/i,$note=$(node),$aObj=$note.children().find("a");for(i=0;i<$aObj.length;i++)href=$aObj.eq(i).attr("href"),re.test(href)&&setFileClass(href,$aObj.eq(i))}}function onFrameScroll(){scope.$parent.scrollPosition=body[0].scrollTop}function popSearch(event){return clientProxy.isNative()&&event.keyCode===KEYCODE.F&&(event.ctrlKey||event.metaKey)?(scope.$emit("note.search.open"),event.preventDefault(),!1):void 0}function highlight(node,keyword){var i,re,newNode,childNode=null,keywords=keyword.split(/[\s\'\"\‘\“\”\’\’\,\，\。\*\、\~\!\@\#\$\%\&\<\>\《\》\?\|\(\)\（\）\[\]\【\】\.\^\/\+\_\-\=\{\}\;\`\·\！\￥\……\——\-\：\；\？]+/);for(keywords=_.without(keywords,""),re=new RegExp("("+keywords.join("|").replace("\\","\\\\")+")","ig"),i=0;i<node.childNodes.length;i++)childNode=node.childNodes[i],1===childNode.nodeType?highlight(childNode,keyword):3===childNode.nodeType&&-1!==childNode.data.search(re)&&(newNode=document.createElement("span"),newNode.innerHTML=childNode.data.replace(new RegExp("&","g"),"&amp;amp;").replace(new RegExp('"',"g"),"&quot;").replace(new RegExp("<","g"),"&lt;").replace(new RegExp(">","g"),"&gt;").replace(new RegExp(" ","g"),"&nbsp;").replace(re,'<em class="search-hit-node">$1</em>'),node.replaceChild(newNode,childNode),unHighlightNodes.push(childNode),highlightNodes.push(newNode),newNode.highlightPos=parseInt(100*$(newNode).position().top/article.height())+"%")}function unHighlight(){for(var node=null,hlNode=null;highlightNodes.length===unHighlightNodes.length&&highlightNodes.length>0;)hlNode=highlightNodes.shift(),node=unHighlightNodes.shift(),hlNode.parentNode.replaceChild(node,hlNode)}function noDrag(){doc.on("dragover",function(e){e=e.originalEvent,e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="none"})}var article,doc=$(iframe[0].contentWindow.document),body=doc.find("body"),head=doc.find("head"),imageItems=null,unHighlightNodes=[],highlightNodes=[],currentHLIndex=0;head.append('<link rel="stylesheet" href="./style/note.css">'),scope.$watch("html",function(html){body.empty(),scope.$parent.scrollPosition=0,article=$('<article class="editor-area"></article>').css({padding:"10px 0px 10px 0"}).html(html),article.find("img").removeAttr("onerror"),article.appendTo(body),highlightInnerlink(article[0]),imageItems=null}),scope.$watch("searchKey",function(keyword){if(!_.isUndefined(keyword)){if(""===keyword)return unHighlight(),void(scope.$parent.searchResult.list=[]);unHighlight(),highlight(article[0],keyword),scope.$parent.searchResult.list=_.clone(highlightNodes),currentHLIndex=0}}),body.delegate("a","click",onLinkClick).delegate("img","click",onImgClick).bind("contextmenu",onContextMenu),$(iframe[0].contentWindow).scroll(onFrameScroll),scope.$on("note.search.init",function(){doc.on("keydown",popSearch),$(document).off("keydown",popSearch).on("keydown",popSearch)}),scope.$on("note.search.destroy",function(){doc.off("keydown",popSearch),$(document).off("keydown",popSearch)}),noDrag()}return{link:link,scope:{html:"=noteContent",searchKey:"=searchKey"}}}}),define("pagelet/note/editor/attachment",["underscore"],function(_){"use strict";var MAX_SIZE=26214400,REJECT_TYPES=/^.+\.(exe|com|sys|cmd|bat)$/i,IMAGE_TYPES=/^.+\.(png|jpeg|jpg|gif|bmp)$/i;return function($scope,dialogs,launcher){function getUploadUrl(gid){return["/yws/api/group/"+gid+"/noteresource?method=startUpload","/yws/api/group/"+gid+"/noteresource?method=uploadProgress","/yws/api/group/"+gid+"/noteresource?method=completeUpload"]}function onFileSelected(tasks){var task=tasks[0],errMessage="";return $dialog.errMsg=null,task.size()>MAX_SIZE?void(launcher.getGroup().isVip||0!==launcher.getGroup().orgId?($dialog.show(),$dialog.errMsg="抱歉，暂不支持添加1GB以上的附件"):(errMessage="抱歉，暂不支持添加200MB以上的附件",dialogs.alertBySrc("上传附件","pagelet/file/upload/exceed-uploadLimitQuota.html",{height:"auto",message:errMessage}))):(size=task.size(),fileName=task.name(),REJECT_TYPES.test(fileName)?($dialog.show(),void($dialog.errMsg="抱歉，我们还不支持您添加的文件类型")):(task.append("method","put-resource"),task.append("resourceType",getResourceType(fileName)),$dialog.hide(),void dialogs.open({src:"pagelet/file/upload/progress-dialog.html",text:fileName,progress:task.resumeUpload(getUploadUrl(gid))}).then(function(res){res=_.isObject(res.text)?res.text:JSON.parse(res.text),$dialog.dismiss({url:res.resourceUrl,icon:res.iconUrl,size:size,name:fileName})}).catch(function(e){task.cancel(),e&&"205"===e.error&&($dialog.errMsg="抱歉，附件上传错误，请重试"),$dialog.show()})))}function getResourceType(name){var type=2;return IMAGE_TYPES.test(name)&&(type=1),type}var size,fileName,$dialog=$scope.$dialog,gid=$scope.gid,tasks=$scope.tasks;$dialog.title="添加附件",$dialog.width=360,$dialog.height=100,$scope.onFileSelected=onFileSelected,launcher.getGroup().orgId&&0!==launcher.getGroup().orgId?(MAX_SIZE=1073741824,$scope.vipOrOrg=!0):launcher.getGroup().isVip?(MAX_SIZE=1073741824,$scope.vipOrOrg=!0):(MAX_SIZE=209715200,$scope.vipOrOrg=!1),tasks&&($dialog.hide(),onFileSelected(tasks))}}),define("pagelet/note/editor/draftHint",[],function(){"use strict";return function(launcher,storageMgr,permission,LOCAL_STORAGE_KEY){function link(scope,el){var interval=setInterval(function(){var draft=storage.get(LOCAL_STORAGE_KEY.NOTE_NEW_PREFIX+scope.$parent.gid()),parent=el.parent();permission.check("note.draftHint")&&draft?parent.addClass("note-draft"):parent.removeClass("note-draft")},200);scope.clear=function(){storage.remove(LOCAL_STORAGE_KEY.NOTE_NEW_PREFIX+scope.$parent.gid())},scope.edit=function(){launcher.getGroupRouter().forward("/note",{mode:"edit",folderId:scope.folderId})},scope.$on("$destroy",function(){clearInterval(interval)})}var storage=storageMgr.forUser(launcher.uid());return{link:link,replace:!0,scope:{folderId:"=noteDraftHint"},templateUrl:"pagelet/note/editor/draft-hint.html"}}}),function(){var root=self;onmessage=function(evt){var data=evt.data,cmd=evt.data.cmd;switch(cmd){case"start":if(data.oldVersion&&data.newVersion){var diff=root.getHTMLDiff(data.oldVersion,data.newVersion);postMessage(diff)}break;case"stop":root.close()}};var Match=function(startInOld,startInNew,size){this.size=size,this.startInOld=startInOld,this.startInNew=startInNew,this.endInOld=this.startInOld+this.size,this.endInNew=this.startInNew+this.size},Operation=function(action,startInOld,endInOld,startInNew,endInNew){this.action=action,this.endInOld=endInOld,this.endInNew=endInNew,this.startInOld=startInOld,this.startInNew=startInNew},convertHtml2Words=function(html){return html=html.replace(/\s+/g," ").replace(/\s+>/g,">").replace(/\s+\/>/g,"/>").replace(/>\s+</g,"><"),html=html.replace(/<td[^>]*>/g,"<td>").replace(/<table[^>]*>/g,'<table border="1" cellpadding="2" cellspacing="0">'),html.match(/<td[^>]*>(.*?)<\/td>|<[^>]+>|(&nbsp;)|[^<|>|\w]|\w+\b|\s+/gm)},extractImgWords=function(words){for(var Imgs={},i=0,len=words.length;len>i;i++)-1!=words[i].indexOf("<img")&&(Imgs[words[i]]=i);return Imgs},extractSrcWords=function(img){for(var src,imgAttrs=img.split(" "),i=0,len=imgAttrs.length;len>i;i++)if(0==imgAttrs[i].indexOf("src")){src=imgAttrs[i].split("://")[1],src||(src=imgAttrs[i].split("=")[1]);break}return src},compareImgSrc=function(oldImg,newImg){var oldSrc=extractSrcWords(oldImg),newSrc=extractSrcWords(newImg);return oldSrc===newSrc?!0:!1},processOldImgWords=function(oldWords,newWords){var oldKey,newKey,oldImgs=extractImgWords(oldWords),newImgs=extractImgWords(newWords);for(oldKey in oldImgs)for(newKey in newImgs)compareImgSrc(oldKey,newKey)&&(oldWords[oldImgs[oldKey]]=newWords[newImgs[newKey]]);return oldWords},DiffBuilder=function(oldVersion,newVersion){this.oldVersion=oldVersion,this.newVersion=newVersion,this.tables=null,this.operation=null,this.wordIndices={},this.oldWords=[],this.newWords=[],this.content=[],this.tableContent=[]};DiffBuilder.prototype={build:function(){return this.splitInputs2Words(),this.processImgTag(),this.indexNewWords(),this.operations=this.getOperations(),this.performOperation(),this.content.join("")},performOperation:function(){for(var opt,i=0,len=this.operations.length;len>i;i++)opt=this.operations[i],this.operation=opt,opt.action.call(this,opt)},splitInputs2Words:function(){this.oldWords=convertHtml2Words(this.oldVersion),this.newWords=convertHtml2Words(this.newVersion)},processImgTag:function(){this.oldWords=processOldImgWords(this.oldWords,this.newWords)},indexNewWords:function(){for(var key,newWords=this.newWords,wordIndices=this.wordIndices,len=newWords.length,toString=Object.prototype.toString,i=0;len>i;i++)key=newWords[i],"[object Array]"!==toString.call(wordIndices[key])&&(wordIndices[key]=[]),wordIndices[key].push(i)},getOperations:function(){var match,action,matchStartsInOld,matchStartsInNew,optInOld=0,optInNew=0,operations=[],matchs=this.matchingBlocks();matchs.push(new Match(this.oldWords.length,this.newWords.length,0));for(var i=0,len=matchs.length;len>i;i++)action=null,match=matchs[i],matchStartsInOld=optInOld===match.startInOld,matchStartsInNew=optInNew===match.startInNew,matchStartsInOld||matchStartsInNew?matchStartsInOld&&!matchStartsInNew?action=this.insert:!matchStartsInOld&&matchStartsInNew&&(action=this.del):action=this.replace,action&&operations.push(new Operation(action,optInOld,match.startInOld,optInNew,match.startInNew)),match.size&&operations.push(new Operation(this.equal,match.startInOld,match.endInOld,match.startInNew,match.endInNew)),optInOld=match.endInOld,optInNew=match.endInNew;return operations},matchingBlocks:function(){var matchingBlocks=[];return this.findMatchingBlocks(0,this.oldWords.length,0,this.newWords.length,matchingBlocks),matchingBlocks},findMatchingBlocks:function(startInOld,endInOld,startInNew,endInNew,matchingBlocks){var match=this.findMatch(startInOld,endInOld,startInNew,endInNew);match&&(startInOld<match.startInOld&&startInNew<match.startInNew&&this.findMatchingBlocks(startInOld,match.startInOld,startInNew,match.startInNew,matchingBlocks),matchingBlocks.push(match),match.endInOld<endInOld&&match.endInNew<endInNew&&this.findMatchingBlocks(match.endInOld,endInOld,match.endInNew,endInNew,matchingBlocks))},findMatch:function(startInOld,endInOld,startInNew,endInNew){for(var newMatchLengthAt,newMatchLength,wordIndexList,matchIndex,len,bestMatchInOld=startInOld,bestMatchInNew=startInNew,bestMatchSize=0,matchLengthAt={},idxOld=startInOld;endInOld>idxOld;idxOld++){newMatchLengthAt={},wordIndexList=this.wordIndices[this.oldWords[idxOld]],len=wordIndexList?wordIndexList.length:0;for(var i=0;len>i;i++)if(matchIndex=wordIndexList[i],!(startInNew>matchIndex)){if(matchIndex>=endInNew)break;newMatchLength=(matchLengthAt[matchIndex-1]||0)+1,newMatchLengthAt[matchIndex]=newMatchLength,newMatchLength>bestMatchSize&&(bestMatchInOld=idxOld-newMatchLength+1,bestMatchInNew=matchIndex-newMatchLength+1,bestMatchSize=newMatchLength)}matchLengthAt=newMatchLengthAt}return bestMatchSize?new Match(bestMatchInOld,bestMatchInNew,bestMatchSize):null},insert:function(opt,tagCls){this.insertTag("ins",tagCls||"diffins",this.newWords.slice(opt.startInNew,opt.endInNew))},del:function(opt,tagCls){this.insertTag("del",tagCls||"diffdel",this.oldWords.slice(opt.startInOld,opt.endInOld))},equal:function(opt){this.content=this.content.concat(this.newWords.slice(opt.startInNew,opt.endInNew))},replace:function(opt){this.del(opt,"diffmod"),this.insert(opt,"diffmod")},insertTag:function(tagName,cssCls,words){for(var nonTags;words.length;){if(nonTags=this.extractConsecutiveWords(words,!0),nonTags.length)for(var tmpTableContent,matchResult,blankFlag=!0,i=0,len=nonTags.length;len>i;i++)-1!=nonTags[i].indexOf("<td")?("diffins"==cssCls||"diffdel"==cssCls?(matchResult=nonTags[i].match(/<td>(.+)<\/td>/),nonTags[i]=nonTags[i].replace(matchResult?matchResult[1]:" ",this.warpText(matchResult?matchResult[1]:" ",tagName,cssCls))):"diffmod"==cssCls&&("del"==tagName?(matchResult=nonTags[i].match(/<td>(.+)<\/td>/),tmpTableContent=this.warpText(matchResult?matchResult[1]:" ",tagName,cssCls),this.tableContent.push(tmpTableContent),nonTags[i]=""):"ins"==tagName&&(tmpTableContent=this.tableContent.shift(),tmpTableContent||(tmpTableContent=""),matchResult=nonTags[i].match(/<td>(.+)<\/td>/),nonTags[i]=nonTags[i].replace(matchResult?matchResult[1]:" ",tmpTableContent+this.warpText(matchResult?matchResult[1]:" ",tagName,cssCls)))),this.content=this.content.concat(nonTags[i]),blankFlag=!1):!blankFlag||"&nbsp;"!=nonTags[i]&&" "!=nonTags[i]?(this.content.push(this.warpText(nonTags[i],tagName,cssCls)),blankFlag=!1):"ins"==tagName&&(this.content=this.content.concat(nonTags[i]));if(words.length)for(var consecutiveTagChars=this.extractConsecutiveWords(words,!1),i=0,len=consecutiveTagChars.length;len>i;i++)-1!=consecutiveTagChars[i].indexOf("<img")?this.content.push(this.warpImg(consecutiveTagChars[i],tagName)):this.content=this.content.concat(consecutiveTagChars[i])}},extractConsecutiveWords:function(words,isTag){for(var idxOfFirstTag=null,i=0,len=words.length;len>i;i++)if(this.isTag(words[i])==isTag){idxOfFirstTag=i;break}return words.splice(0,null!==idxOfFirstTag?idxOfFirstTag:words.length)},warpText:function(text,tagName,cssCls){return"<"+tagName+' class="'+cssCls+'">'+text+"</"+tagName+">"},warpImg:function(img,tagName){var borderColor;if("ins"==tagName?borderColor="#e8ffb3":"del"==tagName&&(borderColor="#ffdbc8"),-1!=img.indexOf(" style")){var styleEndQuoteIndex,sIndex=img.indexOf(" style"),styleStartQuoteIndex=(img.lastIndexOf(">"),img.indexOf('"',sIndex));-1!=styleStartQuoteIndex?styleEndQuoteIndex=img.indexOf('"',styleStartQuoteIndex+1):-1!=img.indexOf("=",sIndex)&&(styleEndQuoteIndex=img.indexOf("=",sIndex)+1);var sStr=img.slice(0,sIndex),styleStr=img.slice(sIndex,styleEndQuoteIndex)+"border:"+borderColor+" solid 2px;",eStr=img.slice(styleEndQuoteIndex);return sStr+styleStr+eStr}return img=-1!=img.indexOf("/>")?img.slice(0,-2):img.slice(0,-1),img+' style = "border:'+borderColor+' solid 2px"/>'},isOpeningTag:function(item){return/^\s*<[^>]+>\s*$/gi.test(item)},isClosingTag:function(item){return/^\s*<\/[^>]+>\s*$/gi.test(item)},isTag:function(item){return this.isOpeningTag(item)?1:this.isClosingTag(item)?2:0}},root.getHTMLDiff=function(oldVersion,newVersion){return new DiffBuilder(oldVersion,newVersion).build()}}(),define("htmldiff",function(){}),define("pagelet/note/diffview/noteDiffCtrl",["underscore","htmldiff"],function(_){"use strict";String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};var cacheDiff={},cacheIsDifferent={},versionHasBeenDiffed=[];return function($scope,$rootScope,$timeout,$location,$filter,explorer,viewport,dialogService,fileManager,noteManager,launcher){function isDifferent(t1,t2,v1,v2){$scope.isDifferent=t1===t2?!1:!0,cacheIsDifferent[$scope.gid+":"+$scope.note.fileId+":"+v1+":"+v2]=$scope.isDifferent}function getDiff(v1,v2){function doCompareIfAlready(){_.isUndefined(newC)||_.isUndefined(oldC)||(newC=newC.trim()||"<div></div>",oldC=oldC.trim()||"<div></div>",computeDiff(v1,v2))}function computeDiff(v1,v2){isDifferent(newC,oldC,v1,v2),null===worker?($scope.diffC=getHTMLDiff(oldC,newC),cacheDiff[$scope.gid+":"+$scope.note.fileId+":"+v1+":"+v2]=$scope.diffC,oldC=void 0,newC=void 0):(worker.postMessage({cmd:"start",newVersion:newC,oldVersion:oldC}),worker.onmessage=function(evt){$scope.$apply(function(){$scope.diffC=evt.data}),cacheDiff[$scope.gid+":"+$scope.note.fileId+":"+v1+":"+v2]=$scope.diffC,oldC=void 0,newC=void 0}.bind(this))}var newC,oldC;return $scope.version1=v1,$scope.version2=v2,cacheDiff[$scope.gid+":"+$scope.note.fileId+":"+v1+":"+v2]?($scope.diffC=cacheDiff[$scope.gid+":"+$scope.note.fileId+":"+v1+":"+v2],$scope.isDifferent=cacheIsDifferent[$scope.gid+":"+$scope.note.fileId+":"+v1+":"+v2],oldC=void 0,void(newC=void 0)):void(_.contains(versionHasBeenDiffed,v1)||(versionHasBeenDiffed.push(v1),$scope.diffC="正在比较，请稍等...",$scope.isDifferent=!0,noteManager.getContent($scope.gid,$scope.note.fileId,v1,!0).then(function(html){var title=$scope.noteHistoryList[noteHistoryListLength-v1].name;title=$filter("htmlFilter")(title.substr(0,title.length-5)),newC='<div class="note-title">'+title+'</div><div class="note-content">'+html+"</div>",doCompareIfAlready()},function(){versionHasBeenDiffed=_.without(versionHasBeenDiffed,v1)}),0===v2?oldC="<div></div>":noteManager.getContent($scope.gid,$scope.note.fileId,v2,!0).then(function(html){var title=$scope.noteHistoryList[noteHistoryListLength-v2].name;title=$filter("htmlFilter")(title.substr(0,title.length-5)),oldC='<div class="note-title">'+title+'</div><div class="note-content">'+html+"</div>",doCompareIfAlready()},function(){versionHasBeenDiffed=_.without(versionHasBeenDiffed,v1)})))}function getHistoryList(){var gid,fileId;gid=$scope.gid,fileId=$scope.note.fileId,fileManager.listRevision(gid,fileId).then(function(list){$scope.noteHistoryList=list,noteHistoryListLength=list.length,$timeout(function(){$scope.activeVersion=curVersion,getDiff(curVersion,curVersion-1)},100)})}function updateNote(content){var note=$scope.note,title=$scope.note.name;-1!==title.lastIndexOf(".note")&&(title=title.substr(0,title.lastIndexOf(".note"))),noteManager.updateNote($scope.gid,note.fileId,title,content).then(function(newNote){$rootScope.$broadcast("note.diff.revert",newNote),$scope.$dialog.dismiss(newNote)})}function revertToVersion(version){var userInfo=launcher.getUser();fileManager.getModifiers($scope.gid,$scope.note.fileId).then(function(data){data&&data.length>1?dialogService.alert("恢复到历史版本",data[0].name+" 等人正在编辑，请稍后操作。"):data&&1===data.length&&data[0].userId!==userInfo.userId?dialogService.alert("恢复到历史版本",data[0].name+" 正在编辑，请稍后操作。"):dialogService.confirm("恢复到历史版本","确定要恢复到此版本吗？恢复之后当前版本将被替换为历史版本。").then(function(){noteManager.getContent($scope.gid,$scope.note.fileId,version).then(updateNote)
})}).catch(function(e){e&&e.data&&e.data.error&&dialogService.alert("恢复到历史版本","出现问题，请稍后重试。")})}function editNote(){explorer.openFile($scope.note.fileId,{mode:"edit"}),$scope.$dialog.cancel()}function changeVersion(version){$scope.activeVersion=version,getDiff(version,version-1)}var noteHistoryListLength,curVersion=$scope.version?$scope.version:$scope.note.version,worker=window.Worker?new window.Worker("./util/htmldiff.js"):null;getHistoryList(),$scope.isDifferent=!0,$scope.$on("$destroy",function(){worker.postMessage({cmd:"stop"}),versionHasBeenDiffed=[]}),$scope.diffC="",$scope.editNote=editNote,$scope.revertToVersion=revertToVersion,$scope.changeVersion=changeVersion}}),define("pagelet/note/diffview/noteView",["jquery"],function($){"use strict";return function(){function link(scope,el,attr){var expr=attr.noteView;scope.$watch(expr,function(newC){var $newC=$("<div>"+newC+"</div>");$newC.find("a").attr("target","_blank"),$newC.addClass("note-content"),el.contents().find("head").html($("<link/>",{rel:"stylesheet",href:"./style/diff.css",type:"text/css"})),el.contents().find("body").html($newC.html()),$newC.remove()})}return{restrict:"A",link:link}}}),define("pagelet/note/import/importer",["underscore","util/tracker"],function(_,tracker){"use strict";return function($rootScope,$scope,noteManager,dialogs,launcher,userService,explorer){function onProgress(status){status.isYDocImport?(status.num=100,status.countprogress=status.sizeprogress,$scope.status=status,status.percent=Math.floor(100*status.sizeprogress)):($scope.status=status,status.percent=Math.floor(100*status.sizeprogress))}function onFinish(status){var prop,alertMsg,res=status.result,success=!0;$dialog.dismiss(status);for(prop in res)if(res.hasOwnProperty(prop)){if("10024"===res[prop]){launcher.getGroup().isVip?dialogs.alert("导入笔记","群存储容量已满，无法增加新笔记。请删除不必要的文件后重新发布"):launcher.getGroup().owner===launcher.uid()?(tracker.event("exceed","exceed-space-show","exceed-space-noteimoprt"),dialogs.alertBySrc("导入笔记","pagelet/file/upload/exceed-spaceQuota.html",{height:"auto"})):dialogs.alert("导入笔记","群存储容量已满，无法增加新笔记。如需添加更多笔记，请联系群主升级到企业版。"),success=!1;break}if("401"===res[prop]){alertMsg="抱歉，无法导入附件大小超过25MB的笔记",(launcher.getGroup().isVip||0!==launcher.getGroup().orgId)&&(alertMsg="抱歉，无法导入附件大小超过1GB的笔记"),dialogs.alert("导入笔记",alertMsg),success=!1;break}}}function onError(e){explorer.hint("导入失败","error"),$dialog.cancel(e)}function startUpload(result){$scope.show(),result.isYDocUser?noteManager.multiImportFromYDoc($scope.gid,result.selection,$scope.folder.id).then(onFinish,onError,onProgress):noteManager.importFromMyNotes($scope.gid,$scope.folder.id,_.map(result.selection,function(ynote){return ynote.path})).then(onFinish,onError,onProgress)}function showYNoteImportDialog(){dialogs.open({title:"导入笔记",src:"pagelet/note/import/ynoteSelector/dialog.html",multiple:!0,width:400,height:500}).then(startUpload).catch(function(){$dialog.cancel()})}function showYDocImportDialog(){dialogs.open({title:"导入笔记",src:"pagelet/note/import/ydocSelector/importNote.html",multiple:!0,cls:"ydoc-import",width:700,height:475}).then(startUpload).catch(function(){$dialog.cancel()})}var $dialog=$scope.$dialog;_.extend($dialog,{width:400,height:120}),_.extend($scope,{status:{countprogress:0,num:100,percent:0}}),launcher.getUser().isYDocUser===!0?showYDocImportDialog():launcher.getUser().isYDocUser===!1?showYNoteImportDialog():userService.isYDocUser().then(function(isYDocUser){isYDocUser?showYDocImportDialog():showYNoteImportDialog()}),$dialog.hide()}}),define("vendor/gbk",[],function(){return{33088:19970,33089:19972,33090:19973,33091:19974,33092:19983,33093:19986,33094:19991,33095:19999,33096:2e4,33097:20001,33098:20003,33099:20006,33100:20009,33101:20014,33102:20015,33103:20017,33104:20019,33105:20021,33106:20023,33107:20028,33108:20032,33109:20033,33110:20034,33111:20036,33112:20038,33113:20042,33114:20049,33115:20053,33116:20055,33117:20058,33118:20059,33119:20066,33120:20067,33121:20068,33122:20069,33123:20071,33124:20072,33125:20074,33126:20075,33127:20076,33128:20077,33129:20078,33130:20079,33131:20082,33132:20084,33133:20085,33134:20086,33135:20087,33136:20088,33137:20089,33138:20090,33139:20091,33140:20092,33141:20093,33142:20095,33143:20096,33144:20097,33145:20098,33146:20099,33147:20100,33148:20101,33149:20103,33150:20106,33152:20112,33153:20118,33154:20119,33155:20121,33156:20124,33157:20125,33158:20126,33159:20131,33160:20138,33161:20143,33162:20144,33163:20145,33164:20148,33165:20150,33166:20151,33167:20152,33168:20153,33169:20156,33170:20157,33171:20158,33172:20168,33173:20172,33174:20175,33175:20176,33176:20178,33177:20186,33178:20187,33179:20188,33180:20192,33181:20194,33182:20198,33183:20199,33184:20201,33185:20205,33186:20206,33187:20207,33188:20209,33189:20212,33190:20216,33191:20217,33192:20218,33193:20220,33194:20222,33195:20224,33196:20226,33197:20227,33198:20228,33199:20229,33200:20230,33201:20231,33202:20232,33203:20235,33204:20236,33205:20242,33206:20243,33207:20244,33208:20245,33209:20246,33210:20252,33211:20253,33212:20257,33213:20259,33214:20264,33215:20265,33216:20268,33217:20269,33218:20270,33219:20273,33220:20275,33221:20277,33222:20279,33223:20281,33224:20283,33225:20286,33226:20287,33227:20288,33228:20289,33229:20290,33230:20292,33231:20293,33232:20295,33233:20296,33234:20297,33235:20298,33236:20299,33237:20300,33238:20306,33239:20308,33240:20310,33241:20321,33242:20322,33243:20326,33244:20328,33245:20330,33246:20331,33247:20333,33248:20334,33249:20337,33250:20338,33251:20341,33252:20343,33253:20344,33254:20345,33255:20346,33256:20349,33257:20352,33258:20353,33259:20354,33260:20357,33261:20358,33262:20359,33263:20362,33264:20364,33265:20366,33266:20368,33267:20370,33268:20371,33269:20373,33270:20374,33271:20376,33272:20377,33273:20378,33274:20380,33275:20382,33276:20383,33277:20385,33278:20386,33344:20388,33345:20395,33346:20397,33347:20400,33348:20401,33349:20402,33350:20403,33351:20404,33352:20406,33353:20407,33354:20408,33355:20409,33356:20410,33357:20411,33358:20412,33359:20413,33360:20414,33361:20416,33362:20417,33363:20418,33364:20422,33365:20423,33366:20424,33367:20425,33368:20427,33369:20428,33370:20429,33371:20434,33372:20435,33373:20436,33374:20437,33375:20438,33376:20441,33377:20443,33378:20448,33379:20450,33380:20452,33381:20453,33382:20455,33383:20459,33384:20460,33385:20464,33386:20466,33387:20468,33388:20469,33389:20470,33390:20471,33391:20473,33392:20475,33393:20476,33394:20477,33395:20479,33396:20480,33397:20481,33398:20482,33399:20483,33400:20484,33401:20485,33402:20486,33403:20487,33404:20488,33405:20489,33406:20490,33408:20491,33409:20494,33410:20496,33411:20497,33412:20499,33413:20501,33414:20502,33415:20503,33416:20507,33417:20509,33418:20510,33419:20512,33420:20514,33421:20515,33422:20516,33423:20519,33424:20523,33425:20527,33426:20528,33427:20529,33428:20530,33429:20531,33430:20532,33431:20533,33432:20534,33433:20535,33434:20536,33435:20537,33436:20539,33437:20541,33438:20543,33439:20544,33440:20545,33441:20546,33442:20548,33443:20549,33444:20550,33445:20553,33446:20554,33447:20555,33448:20557,33449:20560,33450:20561,33451:20562,33452:20563,33453:20564,33454:20566,33455:20567,33456:20568,33457:20569,33458:20571,33459:20573,33460:20574,33461:20575,33462:20576,33463:20577,33464:20578,33465:20579,33466:20580,33467:20582,33468:20583,33469:20584,33470:20585,33471:20586,33472:20587,33473:20589,33474:20590,33475:20591,33476:20592,33477:20593,33478:20594,33479:20595,33480:20596,33481:20597,33482:20600,33483:20601,33484:20602,33485:20604,33486:20605,33487:20609,33488:20610,33489:20611,33490:20612,33491:20614,33492:20615,33493:20617,33494:20618,33495:20619,33496:20620,33497:20622,33498:20623,33499:20624,33500:20625,33501:20626,33502:20627,33503:20628,33504:20629,33505:20630,33506:20631,33507:20632,33508:20633,33509:20634,33510:20635,33511:20636,33512:20637,33513:20638,33514:20639,33515:20640,33516:20641,33517:20642,33518:20644,33519:20646,33520:20650,33521:20651,33522:20653,33523:20654,33524:20655,33525:20656,33526:20657,33527:20659,33528:20660,33529:20661,33530:20662,33531:20663,33532:20664,33533:20665,33534:20668,33600:20669,33601:20670,33602:20671,33603:20672,33604:20673,33605:20674,33606:20675,33607:20676,33608:20677,33609:20678,33610:20679,33611:20680,33612:20681,33613:20682,33614:20683,33615:20684,33616:20685,33617:20686,33618:20688,33619:20689,33620:20690,33621:20691,33622:20692,33623:20693,33624:20695,33625:20696,33626:20697,33627:20699,33628:20700,33629:20701,33630:20702,33631:20703,33632:20704,33633:20705,33634:20706,33635:20707,33636:20708,33637:20709,33638:20712,33639:20713,33640:20714,33641:20715,33642:20719,33643:20720,33644:20721,33645:20722,33646:20724,33647:20726,33648:20727,33649:20728,33650:20729,33651:20730,33652:20732,33653:20733,33654:20734,33655:20735,33656:20736,33657:20737,33658:20738,33659:20739,33660:20740,33661:20741,33662:20744,33664:20745,33665:20746,33666:20748,33667:20749,33668:20750,33669:20751,33670:20752,33671:20753,33672:20755,33673:20756,33674:20757,33675:20758,33676:20759,33677:20760,33678:20761,33679:20762,33680:20763,33681:20764,33682:20765,33683:20766,33684:20767,33685:20768,33686:20770,33687:20771,33688:20772,33689:20773,33690:20774,33691:20775,33692:20776,33693:20777,33694:20778,33695:20779,33696:20780,33697:20781,33698:20782,33699:20783,33700:20784,33701:20785,33702:20786,33703:20787,33704:20788,33705:20789,33706:20790,33707:20791,33708:20792,33709:20793,33710:20794,33711:20795,33712:20796,33713:20797,33714:20798,33715:20802,33716:20807,33717:20810,33718:20812,33719:20814,33720:20815,33721:20816,33722:20818,33723:20819,33724:20823,33725:20824,33726:20825,33727:20827,33728:20829,33729:20830,33730:20831,33731:20832,33732:20833,33733:20835,33734:20836,33735:20838,33736:20839,33737:20841,33738:20842,33739:20847,33740:20850,33741:20858,33742:20862,33743:20863,33744:20867,33745:20868,33746:20870,33747:20871,33748:20874,33749:20875,33750:20878,33751:20879,33752:20880,33753:20881,33754:20883,33755:20884,33756:20888,33757:20890,33758:20893,33759:20894,33760:20895,33761:20897,33762:20899,33763:20902,33764:20903,33765:20904,33766:20905,33767:20906,33768:20909,33769:20910,33770:20916,33771:20920,33772:20921,33773:20922,33774:20926,33775:20927,33776:20929,33777:20930,33778:20931,33779:20933,33780:20936,33781:20938,33782:20941,33783:20942,33784:20944,33785:20946,33786:20947,33787:20948,33788:20949,33789:20950,33790:20951,33856:20952,33857:20953,33858:20954,33859:20956,33860:20958,33861:20959,33862:20962,33863:20963,33864:20965,33865:20966,33866:20967,33867:20968,33868:20969,33869:20970,33870:20972,33871:20974,33872:20977,33873:20978,33874:20980,33875:20983,33876:20990,33877:20996,33878:20997,33879:21001,33880:21003,33881:21004,33882:21007,33883:21008,33884:21011,33885:21012,33886:21013,33887:21020,33888:21022,33889:21023,33890:21025,33891:21026,33892:21027,33893:21029,33894:21030,33895:21031,33896:21034,33897:21036,33898:21039,33899:21041,33900:21042,33901:21044,33902:21045,33903:21052,33904:21054,33905:21060,33906:21061,33907:21062,33908:21063,33909:21064,33910:21065,33911:21067,33912:21070,33913:21071,33914:21074,33915:21075,33916:21077,33917:21079,33918:21080,33920:21081,33921:21082,33922:21083,33923:21085,33924:21087,33925:21088,33926:21090,33927:21091,33928:21092,33929:21094,33930:21096,33931:21099,33932:21100,33933:21101,33934:21102,33935:21104,33936:21105,33937:21107,33938:21108,33939:21109,33940:21110,33941:21111,33942:21112,33943:21113,33944:21114,33945:21115,33946:21116,33947:21118,33948:21120,33949:21123,33950:21124,33951:21125,33952:21126,33953:21127,33954:21129,33955:21130,33956:21131,33957:21132,33958:21133,33959:21134,33960:21135,33961:21137,33962:21138,33963:21140,33964:21141,33965:21142,33966:21143,33967:21144,33968:21145,33969:21146,33970:21148,33971:21156,33972:21157,33973:21158,33974:21159,33975:21166,33976:21167,33977:21168,33978:21172,33979:21173,33980:21174,33981:21175,33982:21176,33983:21177,33984:21178,33985:21179,33986:21180,33987:21181,33988:21184,33989:21185,33990:21186,33991:21188,33992:21189,33993:21190,33994:21192,33995:21194,33996:21196,33997:21197,33998:21198,33999:21199,34e3:21201,34001:21203,34002:21204,34003:21205,34004:21207,34005:21209,34006:21210,34007:21211,34008:21212,34009:21213,34010:21214,34011:21216,34012:21217,34013:21218,34014:21219,34015:21221,34016:21222,34017:21223,34018:21224,34019:21225,34020:21226,34021:21227,34022:21228,34023:21229,34024:21230,34025:21231,34026:21233,34027:21234,34028:21235,34029:21236,34030:21237,34031:21238,34032:21239,34033:21240,34034:21243,34035:21244,34036:21245,34037:21249,34038:21250,34039:21251,34040:21252,34041:21255,34042:21257,34043:21258,34044:21259,34045:21260,34046:21262,34112:21265,34113:21266,34114:21267,34115:21268,34116:21272,34117:21275,34118:21276,34119:21278,34120:21279,34121:21282,34122:21284,34123:21285,34124:21287,34125:21288,34126:21289,34127:21291,34128:21292,34129:21293,34130:21295,34131:21296,34132:21297,34133:21298,34134:21299,34135:21300,34136:21301,34137:21302,34138:21303,34139:21304,34140:21308,34141:21309,34142:21312,34143:21314,34144:21316,34145:21318,34146:21323,34147:21324,34148:21325,34149:21328,34150:21332,34151:21336,34152:21337,34153:21339,34154:21341,34155:21349,34156:21352,34157:21354,34158:21356,34159:21357,34160:21362,34161:21366,34162:21369,34163:21371,34164:21372,34165:21373,34166:21374,34167:21376,34168:21377,34169:21379,34170:21383,34171:21384,34172:21386,34173:21390,34174:21391,34176:21392,34177:21393,34178:21394,34179:21395,34180:21396,34181:21398,34182:21399,34183:21401,34184:21403,34185:21404,34186:21406,34187:21408,34188:21409,34189:21412,34190:21415,34191:21418,34192:21419,34193:21420,34194:21421,34195:21423,34196:21424,34197:21425,34198:21426,34199:21427,34200:21428,34201:21429,34202:21431,34203:21432,34204:21433,34205:21434,34206:21436,34207:21437,34208:21438,34209:21440,34210:21443,34211:21444,34212:21445,34213:21446,34214:21447,34215:21454,34216:21455,34217:21456,34218:21458,34219:21459,34220:21461,34221:21466,34222:21468,34223:21469,34224:21470,34225:21473,34226:21474,34227:21479,34228:21492,34229:21498,34230:21502,34231:21503,34232:21504,34233:21506,34234:21509,34235:21511,34236:21515,34237:21524,34238:21528,34239:21529,34240:21530,34241:21532,34242:21538,34243:21540,34244:21541,34245:21546,34246:21552,34247:21555,34248:21558,34249:21559,34250:21562,34251:21565,34252:21567,34253:21569,34254:21570,34255:21572,34256:21573,34257:21575,34258:21577,34259:21580,34260:21581,34261:21582,34262:21583,34263:21585,34264:21594,34265:21597,34266:21598,34267:21599,34268:21600,34269:21601,34270:21603,34271:21605,34272:21607,34273:21609,34274:21610,34275:21611,34276:21612,34277:21613,34278:21614,34279:21615,34280:21616,34281:21620,34282:21625,34283:21626,34284:21630,34285:21631,34286:21633,34287:21635,34288:21637,34289:21639,34290:21640,34291:21641,34292:21642,34293:21645,34294:21649,34295:21651,34296:21655,34297:21656,34298:21660,34299:21662,34300:21663,34301:21664,34302:21665,34368:21666,34369:21669,34370:21678,34371:21680,34372:21682,34373:21685,34374:21686,34375:21687,34376:21689,34377:21690,34378:21692,34379:21694,34380:21699,34381:21701,34382:21706,34383:21707,34384:21718,34385:21720,34386:21723,34387:21728,34388:21729,34389:21730,34390:21731,34391:21732,34392:21739,34393:21740,34394:21743,34395:21744,34396:21745,34397:21748,34398:21749,34399:21750,34400:21751,34401:21752,34402:21753,34403:21755,34404:21758,34405:21760,34406:21762,34407:21763,34408:21764,34409:21765,34410:21768,34411:21770,34412:21771,34413:21772,34414:21773,34415:21774,34416:21778,34417:21779,34418:21781,34419:21782,34420:21783,34421:21784,34422:21785,34423:21786,34424:21788,34425:21789,34426:21790,34427:21791,34428:21793,34429:21797,34430:21798,34432:21800,34433:21801,34434:21803,34435:21805,34436:21810,34437:21812,34438:21813,34439:21814,34440:21816,34441:21817,34442:21818,34443:21819,34444:21821,34445:21824,34446:21826,34447:21829,34448:21831,34449:21832,34450:21835,34451:21836,34452:21837,34453:21838,34454:21839,34455:21841,34456:21842,34457:21843,34458:21844,34459:21847,34460:21848,34461:21849,34462:21850,34463:21851,34464:21853,34465:21854,34466:21855,34467:21856,34468:21858,34469:21859,34470:21864,34471:21865,34472:21867,34473:21871,34474:21872,34475:21873,34476:21874,34477:21875,34478:21876,34479:21881,34480:21882,34481:21885,34482:21887,34483:21893,34484:21894,34485:21900,34486:21901,34487:21902,34488:21904,34489:21906,34490:21907,34491:21909,34492:21910,34493:21911,34494:21914,34495:21915,34496:21918,34497:21920,34498:21921,34499:21922,34500:21923,34501:21924,34502:21925,34503:21926,34504:21928,34505:21929,34506:21930,34507:21931,34508:21932,34509:21933,34510:21934,34511:21935,34512:21936,34513:21938,34514:21940,34515:21942,34516:21944,34517:21946,34518:21948,34519:21951,34520:21952,34521:21953,34522:21954,34523:21955,34524:21958,34525:21959,34526:21960,34527:21962,34528:21963,34529:21966,34530:21967,34531:21968,34532:21973,34533:21975,34534:21976,34535:21977,34536:21978,34537:21979,34538:21982,34539:21984,34540:21986,34541:21991,34542:21993,34543:21997,34544:21998,34545:22e3,34546:22001,34547:22004,34548:22006,34549:22008,34550:22009,34551:22010,34552:22011,34553:22012,34554:22015,34555:22018,34556:22019,34557:22020,34558:22021,34624:22022,34625:22023,34626:22026,34627:22027,34628:22029,34629:22032,34630:22033,34631:22034,34632:22035,34633:22036,34634:22037,34635:22038,34636:22039,34637:22041,34638:22042,34639:22044,34640:22045,34641:22048,34642:22049,34643:22050,34644:22053,34645:22054,34646:22056,34647:22057,34648:22058,34649:22059,34650:22062,34651:22063,34652:22064,34653:22067,34654:22069,34655:22071,34656:22072,34657:22074,34658:22076,34659:22077,34660:22078,34661:22080,34662:22081,34663:22082,34664:22083,34665:22084,34666:22085,34667:22086,34668:22087,34669:22088,34670:22089,34671:22090,34672:22091,34673:22095,34674:22096,34675:22097,34676:22098,34677:22099,34678:22101,34679:22102,34680:22106,34681:22107,34682:22109,34683:22110,34684:22111,34685:22112,34686:22113,34688:22115,34689:22117,34690:22118,34691:22119,34692:22125,34693:22126,34694:22127,34695:22128,34696:22130,34697:22131,34698:22132,34699:22133,34700:22135,34701:22136,34702:22137,34703:22138,34704:22141,34705:22142,34706:22143,34707:22144,34708:22145,34709:22146,34710:22147,34711:22148,34712:22151,34713:22152,34714:22153,34715:22154,34716:22155,34717:22156,34718:22157,34719:22160,34720:22161,34721:22162,34722:22164,34723:22165,34724:22166,34725:22167,34726:22168,34727:22169,34728:22170,34729:22171,34730:22172,34731:22173,34732:22174,34733:22175,34734:22176,34735:22177,34736:22178,34737:22180,34738:22181,34739:22182,34740:22183,34741:22184,34742:22185,34743:22186,34744:22187,34745:22188,34746:22189,34747:22190,34748:22192,34749:22193,34750:22194,34751:22195,34752:22196,34753:22197,34754:22198,34755:22200,34756:22201,34757:22202,34758:22203,34759:22205,34760:22206,34761:22207,34762:22208,34763:22209,34764:22210,34765:22211,34766:22212,34767:22213,34768:22214,34769:22215,34770:22216,34771:22217,34772:22219,34773:22220,34774:22221,34775:22222,34776:22223,34777:22224,34778:22225,34779:22226,34780:22227,34781:22229,34782:22230,34783:22232,34784:22233,34785:22236,34786:22243,34787:22245,34788:22246,34789:22247,34790:22248,34791:22249,34792:22250,34793:22252,34794:22254,34795:22255,34796:22258,34797:22259,34798:22262,34799:22263,34800:22264,34801:22267,34802:22268,34803:22272,34804:22273,34805:22274,34806:22277,34807:22279,34808:22283,34809:22284,34810:22285,34811:22286,34812:22287,34813:22288,34814:22289,34880:22290,34881:22291,34882:22292,34883:22293,34884:22294,34885:22295,34886:22296,34887:22297,34888:22298,34889:22299,34890:22301,34891:22302,34892:22304,34893:22305,34894:22306,34895:22308,34896:22309,34897:22310,34898:22311,34899:22315,34900:22321,34901:22322,34902:22324,34903:22325,34904:22326,34905:22327,34906:22328,34907:22332,34908:22333,34909:22335,34910:22337,34911:22339,34912:22340,34913:22341,34914:22342,34915:22344,34916:22345,34917:22347,34918:22354,34919:22355,34920:22356,34921:22357,34922:22358,34923:22360,34924:22361,34925:22370,34926:22371,34927:22373,34928:22375,34929:22380,34930:22382,34931:22384,34932:22385,34933:22386,34934:22388,34935:22389,34936:22392,34937:22393,34938:22394,34939:22397,34940:22398,34941:22399,34942:22400,34944:22401,34945:22407,34946:22408,34947:22409,34948:22410,34949:22413,34950:22414,34951:22415,34952:22416,34953:22417,34954:22420,34955:22421,34956:22422,34957:22423,34958:22424,34959:22425,34960:22426,34961:22428,34962:22429,34963:22430,34964:22431,34965:22437,34966:22440,34967:22442,34968:22444,34969:22447,34970:22448,34971:22449,34972:22451,34973:22453,34974:22454,34975:22455,34976:22457,34977:22458,34978:22459,34979:22460,34980:22461,34981:22462,34982:22463,34983:22464,34984:22465,34985:22468,34986:22469,34987:22470,34988:22471,34989:22472,34990:22473,34991:22474,34992:22476,34993:22477,34994:22480,34995:22481,34996:22483,34997:22486,34998:22487,34999:22491,35e3:22492,35001:22494,35002:22497,35003:22498,35004:22499,35005:22501,35006:22502,35007:22503,35008:22504,35009:22505,35010:22506,35011:22507,35012:22508,35013:22510,35014:22512,35015:22513,35016:22514,35017:22515,35018:22517,35019:22518,35020:22519,35021:22523,35022:22524,35023:22526,35024:22527,35025:22529,35026:22531,35027:22532,35028:22533,35029:22536,35030:22537,35031:22538,35032:22540,35033:22542,35034:22543,35035:22544,35036:22546,35037:22547,35038:22548,35039:22550,35040:22551,35041:22552,35042:22554,35043:22555,35044:22556,35045:22557,35046:22559,35047:22562,35048:22563,35049:22565,35050:22566,35051:22567,35052:22568,35053:22569,35054:22571,35055:22572,35056:22573,35057:22574,35058:22575,35059:22577,35060:22578,35061:22579,35062:22580,35063:22582,35064:22583,35065:22584,35066:22585,35067:22586,35068:22587,35069:22588,35070:22589,35136:22590,35137:22591,35138:22592,35139:22593,35140:22594,35141:22595,35142:22597,35143:22598,35144:22599,35145:22600,35146:22601,35147:22602,35148:22603,35149:22606,35150:22607,35151:22608,35152:22610,35153:22611,35154:22613,35155:22614,35156:22615,35157:22617,35158:22618,35159:22619,35160:22620,35161:22621,35162:22623,35163:22624,35164:22625,35165:22626,35166:22627,35167:22628,35168:22630,35169:22631,35170:22632,35171:22633,35172:22634,35173:22637,35174:22638,35175:22639,35176:22640,35177:22641,35178:22642,35179:22643,35180:22644,35181:22645,35182:22646,35183:22647,35184:22648,35185:22649,35186:22650,35187:22651,35188:22652,35189:22653,35190:22655,35191:22658,35192:22660,35193:22662,35194:22663,35195:22664,35196:22666,35197:22667,35198:22668,35200:22669,35201:22670,35202:22671,35203:22672,35204:22673,35205:22676,35206:22677,35207:22678,35208:22679,35209:22680,35210:22683,35211:22684,35212:22685,35213:22688,35214:22689,35215:22690,35216:22691,35217:22692,35218:22693,35219:22694,35220:22695,35221:22698,35222:22699,35223:22700,35224:22701,35225:22702,35226:22703,35227:22704,35228:22705,35229:22706,35230:22707,35231:22708,35232:22709,35233:22710,35234:22711,35235:22712,35236:22713,35237:22714,35238:22715,35239:22717,35240:22718,35241:22719,35242:22720,35243:22722,35244:22723,35245:22724,35246:22726,35247:22727,35248:22728,35249:22729,35250:22730,35251:22731,35252:22732,35253:22733,35254:22734,35255:22735,35256:22736,35257:22738,35258:22739,35259:22740,35260:22742,35261:22743,35262:22744,35263:22745,35264:22746,35265:22747,35266:22748,35267:22749,35268:22750,35269:22751,35270:22752,35271:22753,35272:22754,35273:22755,35274:22757,35275:22758,35276:22759,35277:22760,35278:22761,35279:22762,35280:22765,35281:22767,35282:22769,35283:22770,35284:22772,35285:22773,35286:22775,35287:22776,35288:22778,35289:22779,35290:22780,35291:22781,35292:22782,35293:22783,35294:22784,35295:22785,35296:22787,35297:22789,35298:22790,35299:22792,35300:22793,35301:22794,35302:22795,35303:22796,35304:22798,35305:22800,35306:22801,35307:22802,35308:22803,35309:22807,35310:22808,35311:22811,35312:22813,35313:22814,35314:22816,35315:22817,35316:22818,35317:22819,35318:22822,35319:22824,35320:22828,35321:22832,35322:22834,35323:22835,35324:22837,35325:22838,35326:22843,35392:22845,35393:22846,35394:22847,35395:22848,35396:22851,35397:22853,35398:22854,35399:22858,35400:22860,35401:22861,35402:22864,35403:22866,35404:22867,35405:22873,35406:22875,35407:22876,35408:22877,35409:22878,35410:22879,35411:22881,35412:22883,35413:22884,35414:22886,35415:22887,35416:22888,35417:22889,35418:22890,35419:22891,35420:22892,35421:22893,35422:22894,35423:22895,35424:22896,35425:22897,35426:22898,35427:22901,35428:22903,35429:22906,35430:22907,35431:22908,35432:22910,35433:22911,35434:22912,35435:22917,35436:22921,35437:22923,35438:22924,35439:22926,35440:22927,35441:22928,35442:22929,35443:22932,35444:22933,35445:22936,35446:22938,35447:22939,35448:22940,35449:22941,35450:22943,35451:22944,35452:22945,35453:22946,35454:22950,35456:22951,35457:22956,35458:22957,35459:22960,35460:22961,35461:22963,35462:22964,35463:22965,35464:22966,35465:22967,35466:22968,35467:22970,35468:22972,35469:22973,35470:22975,35471:22976,35472:22977,35473:22978,35474:22979,35475:22980,35476:22981,35477:22983,35478:22984,35479:22985,35480:22988,35481:22989,35482:22990,35483:22991,35484:22997,35485:22998,35486:23001,35487:23003,35488:23006,35489:23007,35490:23008,35491:23009,35492:23010,35493:23012,35494:23014,35495:23015,35496:23017,35497:23018,35498:23019,35499:23021,35500:23022,35501:23023,35502:23024,35503:23025,35504:23026,35505:23027,35506:23028,35507:23029,35508:23030,35509:23031,35510:23032,35511:23034,35512:23036,35513:23037,35514:23038,35515:23040,35516:23042,35517:23050,35518:23051,35519:23053,35520:23054,35521:23055,35522:23056,35523:23058,35524:23060,35525:23061,35526:23062,35527:23063,35528:23065,35529:23066,35530:23067,35531:23069,35532:23070,35533:23073,35534:23074,35535:23076,35536:23078,35537:23079,35538:23080,35539:23082,35540:23083,35541:23084,35542:23085,35543:23086,35544:23087,35545:23088,35546:23091,35547:23093,35548:23095,35549:23096,35550:23097,35551:23098,35552:23099,35553:23101,35554:23102,35555:23103,35556:23105,35557:23106,35558:23107,35559:23108,35560:23109,35561:23111,35562:23112,35563:23115,35564:23116,35565:23117,35566:23118,35567:23119,35568:23120,35569:23121,35570:23122,35571:23123,35572:23124,35573:23126,35574:23127,35575:23128,35576:23129,35577:23131,35578:23132,35579:23133,35580:23134,35581:23135,35582:23136,35648:23137,35649:23139,35650:23140,35651:23141,35652:23142,35653:23144,35654:23145,35655:23147,35656:23148,35657:23149,35658:23150,35659:23151,35660:23152,35661:23153,35662:23154,35663:23155,35664:23160,35665:23161,35666:23163,35667:23164,35668:23165,35669:23166,35670:23168,35671:23169,35672:23170,35673:23171,35674:23172,35675:23173,35676:23174,35677:23175,35678:23176,35679:23177,35680:23178,35681:23179,35682:23180,35683:23181,35684:23182,35685:23183,35686:23184,35687:23185,35688:23187,35689:23188,35690:23189,35691:23190,35692:23191,35693:23192,35694:23193,35695:23196,35696:23197,35697:23198,35698:23199,35699:23200,35700:23201,35701:23202,35702:23203,35703:23204,35704:23205,35705:23206,35706:23207,35707:23208,35708:23209,35709:23211,35710:23212,35712:23213,35713:23214,35714:23215,35715:23216,35716:23217,35717:23220,35718:23222,35719:23223,35720:23225,35721:23226,35722:23227,35723:23228,35724:23229,35725:23231,35726:23232,35727:23235,35728:23236,35729:23237,35730:23238,35731:23239,35732:23240,35733:23242,35734:23243,35735:23245,35736:23246,35737:23247,35738:23248,35739:23249,35740:23251,35741:23253,35742:23255,35743:23257,35744:23258,35745:23259,35746:23261,35747:23262,35748:23263,35749:23266,35750:23268,35751:23269,35752:23271,35753:23272,35754:23274,35755:23276,35756:23277,35757:23278,35758:23279,35759:23280,35760:23282,35761:23283,35762:23284,35763:23285,35764:23286,35765:23287,35766:23288,35767:23289,35768:23290,35769:23291,35770:23292,35771:23293,35772:23294,35773:23295,35774:23296,35775:23297,35776:23298,35777:23299,35778:23300,35779:23301,35780:23302,35781:23303,35782:23304,35783:23306,35784:23307,35785:23308,35786:23309,35787:23310,35788:23311,35789:23312,35790:23313,35791:23314,35792:23315,35793:23316,35794:23317,35795:23320,35796:23321,35797:23322,35798:23323,35799:23324,35800:23325,35801:23326,35802:23327,35803:23328,35804:23329,35805:23330,35806:23331,35807:23332,35808:23333,35809:23334,35810:23335,35811:23336,35812:23337,35813:23338,35814:23339,35815:23340,35816:23341,35817:23342,35818:23343,35819:23344,35820:23345,35821:23347,35822:23349,35823:23350,35824:23352,35825:23353,35826:23354,35827:23355,35828:23356,35829:23357,35830:23358,35831:23359,35832:23361,35833:23362,35834:23363,35835:23364,35836:23365,35837:23366,35838:23367,35904:23368,35905:23369,35906:23370,35907:23371,35908:23372,35909:23373,35910:23374,35911:23375,35912:23378,35913:23382,35914:23390,35915:23392,35916:23393,35917:23399,35918:23400,35919:23403,35920:23405,35921:23406,35922:23407,35923:23410,35924:23412,35925:23414,35926:23415,35927:23416,35928:23417,35929:23419,35930:23420,35931:23422,35932:23423,35933:23426,35934:23430,35935:23434,35936:23437,35937:23438,35938:23440,35939:23441,35940:23442,35941:23444,35942:23446,35943:23455,35944:23463,35945:23464,35946:23465,35947:23468,35948:23469,35949:23470,35950:23471,35951:23473,35952:23474,35953:23479,35954:23482,35955:23483,35956:23484,35957:23488,35958:23489,35959:23491,35960:23496,35961:23497,35962:23498,35963:23499,35964:23501,35965:23502,35966:23503,35968:23505,35969:23508,35970:23509,35971:23510,35972:23511,35973:23512,35974:23513,35975:23514,35976:23515,35977:23516,35978:23520,35979:23522,35980:23523,35981:23526,35982:23527,35983:23529,35984:23530,35985:23531,35986:23532,35987:23533,35988:23535,35989:23537,35990:23538,35991:23539,35992:23540,35993:23541,35994:23542,35995:23543,35996:23549,35997:23550,35998:23552,35999:23554,36e3:23555,36001:23557,36002:23559,36003:23560,36004:23563,36005:23564,36006:23565,36007:23566,36008:23568,36009:23570,36010:23571,36011:23575,36012:23577,36013:23579,36014:23582,36015:23583,36016:23584,36017:23585,36018:23587,36019:23590,36020:23592,36021:23593,36022:23594,36023:23595,36024:23597,36025:23598,36026:23599,36027:23600,36028:23602,36029:23603,36030:23605,36031:23606,36032:23607,36033:23619,36034:23620,36035:23622,36036:23623,36037:23628,36038:23629,36039:23634,36040:23635,36041:23636,36042:23638,36043:23639,36044:23640,36045:23642,36046:23643,36047:23644,36048:23645,36049:23647,36050:23650,36051:23652,36052:23655,36053:23656,36054:23657,36055:23658,36056:23659,36057:23660,36058:23661,36059:23664,36060:23666,36061:23667,36062:23668,36063:23669,36064:23670,36065:23671,36066:23672,36067:23675,36068:23676,36069:23677,36070:23678,36071:23680,36072:23683,36073:23684,36074:23685,36075:23686,36076:23687,36077:23689,36078:23690,36079:23691,36080:23694,36081:23695,36082:23698,36083:23699,36084:23701,36085:23709,36086:23710,36087:23711,36088:23712,36089:23713,36090:23716,36091:23717,36092:23718,36093:23719,36094:23720,36160:23722,36161:23726,36162:23727,36163:23728,36164:23730,36165:23732,36166:23734,36167:23737,36168:23738,36169:23739,36170:23740,36171:23742,36172:23744,36173:23746,36174:23747,36175:23749,36176:23750,36177:23751,36178:23752,36179:23753,36180:23754,36181:23756,36182:23757,36183:23758,36184:23759,36185:23760,36186:23761,36187:23763,36188:23764,36189:23765,36190:23766,36191:23767,36192:23768,36193:23770,36194:23771,36195:23772,36196:23773,36197:23774,36198:23775,36199:23776,36200:23778,36201:23779,36202:23783,36203:23785,36204:23787,36205:23788,36206:23790,36207:23791,36208:23793,36209:23794,36210:23795,36211:23796,36212:23797,36213:23798,36214:23799,36215:23800,36216:23801,36217:23802,36218:23804,36219:23805,36220:23806,36221:23807,36222:23808,36224:23809,36225:23812,36226:23813,36227:23816,36228:23817,36229:23818,36230:23819,36231:23820,36232:23821,36233:23823,36234:23824,36235:23825,36236:23826,36237:23827,36238:23829,36239:23831,36240:23832,36241:23833,36242:23834,36243:23836,36244:23837,36245:23839,36246:23840,36247:23841,36248:23842,36249:23843,36250:23845,36251:23848,36252:23850,36253:23851,36254:23852,36255:23855,36256:23856,36257:23857,36258:23858,36259:23859,36260:23861,36261:23862,36262:23863,36263:23864,36264:23865,36265:23866,36266:23867,36267:23868,36268:23871,36269:23872,36270:23873,36271:23874,36272:23875,36273:23876,36274:23877,36275:23878,36276:23880,36277:23881,36278:23885,36279:23886,36280:23887,36281:23888,36282:23889,36283:23890,36284:23891,36285:23892,36286:23893,36287:23894,36288:23895,36289:23897,36290:23898,36291:23900,36292:23902,36293:23903,36294:23904,36295:23905,36296:23906,36297:23907,36298:23908,36299:23909,36300:23910,36301:23911,36302:23912,36303:23914,36304:23917,36305:23918,36306:23920,36307:23921,36308:23922,36309:23923,36310:23925,36311:23926,36312:23927,36313:23928,36314:23929,36315:23930,36316:23931,36317:23932,36318:23933,36319:23934,36320:23935,36321:23936,36322:23937,36323:23939,36324:23940,36325:23941,36326:23942,36327:23943,36328:23944,36329:23945,36330:23946,36331:23947,36332:23948,36333:23949,36334:23950,36335:23951,36336:23952,36337:23953,36338:23954,36339:23955,36340:23956,36341:23957,36342:23958,36343:23959,36344:23960,36345:23962,36346:23963,36347:23964,36348:23966,36349:23967,36350:23968,36416:23969,36417:23970,36418:23971,36419:23972,36420:23973,36421:23974,36422:23975,36423:23976,36424:23977,36425:23978,36426:23979,36427:23980,36428:23981,36429:23982,36430:23983,36431:23984,36432:23985,36433:23986,36434:23987,36435:23988,36436:23989,36437:23990,36438:23992,36439:23993,36440:23994,36441:23995,36442:23996,36443:23997,36444:23998,36445:23999,36446:24e3,36447:24001,36448:24002,36449:24003,36450:24004,36451:24006,36452:24007,36453:24008,36454:24009,36455:24010,36456:24011,36457:24012,36458:24014,36459:24015,36460:24016,36461:24017,36462:24018,36463:24019,36464:24020,36465:24021,36466:24022,36467:24023,36468:24024,36469:24025,36470:24026,36471:24028,36472:24031,36473:24032,36474:24035,36475:24036,36476:24042,36477:24044,36478:24045,36480:24048,36481:24053,36482:24054,36483:24056,36484:24057,36485:24058,36486:24059,36487:24060,36488:24063,36489:24064,36490:24068,36491:24071,36492:24073,36493:24074,36494:24075,36495:24077,36496:24078,36497:24082,36498:24083,36499:24087,36500:24094,36501:24095,36502:24096,36503:24097,36504:24098,36505:24099,36506:24100,36507:24101,36508:24104,36509:24105,36510:24106,36511:24107,36512:24108,36513:24111,36514:24112,36515:24114,36516:24115,36517:24116,36518:24117,36519:24118,36520:24121,36521:24122,36522:24126,36523:24127,36524:24128,36525:24129,36526:24131,36527:24134,36528:24135,36529:24136,36530:24137,36531:24138,36532:24139,36533:24141,36534:24142,36535:24143,36536:24144,36537:24145,36538:24146,36539:24147,36540:24150,36541:24151,36542:24152,36543:24153,36544:24154,36545:24156,36546:24157,36547:24159,36548:24160,36549:24163,36550:24164,36551:24165,36552:24166,36553:24167,36554:24168,36555:24169,36556:24170,36557:24171,36558:24172,36559:24173,36560:24174,36561:24175,36562:24176,36563:24177,36564:24181,36565:24183,36566:24185,36567:24190,36568:24193,36569:24194,36570:24195,36571:24197,36572:24200,36573:24201,36574:24204,36575:24205,36576:24206,36577:24210,36578:24216,36579:24219,36580:24221,36581:24225,36582:24226,36583:24227,36584:24228,36585:24232,36586:24233,36587:24234,36588:24235,36589:24236,36590:24238,36591:24239,36592:24240,36593:24241,36594:24242,36595:24244,36596:24250,36597:24251,36598:24252,36599:24253,36600:24255,36601:24256,36602:24257,36603:24258,36604:24259,36605:24260,36606:24261,36672:24262,36673:24263,36674:24264,36675:24267,36676:24268,36677:24269,36678:24270,36679:24271,36680:24272,36681:24276,36682:24277,36683:24279,36684:24280,36685:24281,36686:24282,36687:24284,36688:24285,36689:24286,36690:24287,36691:24288,36692:24289,36693:24290,36694:24291,36695:24292,36696:24293,36697:24294,36698:24295,36699:24297,36700:24299,36701:24300,36702:24301,36703:24302,36704:24303,36705:24304,36706:24305,36707:24306,36708:24307,36709:24309,36710:24312,36711:24313,36712:24315,36713:24316,36714:24317,36715:24325,36716:24326,36717:24327,36718:24329,36719:24332,36720:24333,36721:24334,36722:24336,36723:24338,36724:24340,36725:24342,36726:24345,36727:24346,36728:24348,36729:24349,36730:24350,36731:24353,36732:24354,36733:24355,36734:24356,36736:24360,36737:24363,36738:24364,36739:24366,36740:24368,36741:24370,36742:24371,36743:24372,36744:24373,36745:24374,36746:24375,36747:24376,36748:24379,36749:24381,36750:24382,36751:24383,36752:24385,36753:24386,36754:24387,36755:24388,36756:24389,36757:24390,36758:24391,36759:24392,36760:24393,36761:24394,36762:24395,36763:24396,36764:24397,36765:24398,36766:24399,36767:24401,36768:24404,36769:24409,36770:24410,36771:24411,36772:24412,36773:24414,36774:24415,36775:24416,36776:24419,36777:24421,36778:24423,36779:24424,36780:24427,36781:24430,36782:24431,36783:24434,36784:24436,36785:24437,36786:24438,36787:24440,36788:24442,36789:24445,36790:24446,36791:24447,36792:24451,36793:24454,36794:24461,36795:24462,36796:24463,36797:24465,36798:24467,36799:24468,36800:24470,36801:24474,36802:24475,36803:24477,36804:24478,36805:24479,36806:24480,36807:24482,36808:24483,36809:24484,36810:24485,36811:24486,36812:24487,36813:24489,36814:24491,36815:24492,36816:24495,36817:24496,36818:24497,36819:24498,36820:24499,36821:24500,36822:24502,36823:24504,36824:24505,36825:24506,36826:24507,36827:24510,36828:24511,36829:24512,36830:24513,36831:24514,36832:24519,36833:24520,36834:24522,36835:24523,36836:24526,36837:24531,36838:24532,36839:24533,36840:24538,36841:24539,36842:24540,36843:24542,36844:24543,36845:24546,36846:24547,36847:24549,36848:24550,36849:24552,36850:24553,36851:24556,36852:24559,36853:24560,36854:24562,36855:24563,36856:24564,36857:24566,36858:24567,36859:24569,36860:24570,36861:24572,36862:24583,36928:24584,36929:24585,36930:24587,36931:24588,36932:24592,36933:24593,36934:24595,36935:24599,36936:24600,36937:24602,36938:24606,36939:24607,36940:24610,36941:24611,36942:24612,36943:24620,36944:24621,36945:24622,36946:24624,36947:24625,36948:24626,36949:24627,36950:24628,36951:24630,36952:24631,36953:24632,36954:24633,36955:24634,36956:24637,36957:24638,36958:24640,36959:24644,36960:24645,36961:24646,36962:24647,36963:24648,36964:24649,36965:24650,36966:24652,36967:24654,36968:24655,36969:24657,36970:24659,36971:24660,36972:24662,36973:24663,36974:24664,36975:24667,36976:24668,36977:24670,36978:24671,36979:24672,36980:24673,36981:24677,36982:24678,36983:24686,36984:24689,36985:24690,36986:24692,36987:24693,36988:24695,36989:24702,36990:24704,36992:24705,36993:24706,36994:24709,36995:24710,36996:24711,36997:24712,36998:24714,36999:24715,37e3:24718,37001:24719,37002:24720,37003:24721,37004:24723,37005:24725,37006:24727,37007:24728,37008:24729,37009:24732,37010:24734,37011:24737,37012:24738,37013:24740,37014:24741,37015:24743,37016:24745,37017:24746,37018:24750,37019:24752,37020:24755,37021:24757,37022:24758,37023:24759,37024:24761,37025:24762,37026:24765,37027:24766,37028:24767,37029:24768,37030:24769,37031:24770,37032:24771,37033:24772,37034:24775,37035:24776,37036:24777,37037:24780,37038:24781,37039:24782,37040:24783,37041:24784,37042:24786,37043:24787,37044:24788,37045:24790,37046:24791,37047:24793,37048:24795,37049:24798,37050:24801,37051:24802,37052:24803,37053:24804,37054:24805,37055:24810,37056:24817,37057:24818,37058:24821,37059:24823,37060:24824,37061:24827,37062:24828,37063:24829,37064:24830,37065:24831,37066:24834,37067:24835,37068:24836,37069:24837,37070:24839,37071:24842,37072:24843,37073:24844,37074:24848,37075:24849,37076:24850,37077:24851,37078:24852,37079:24854,37080:24855,37081:24856,37082:24857,37083:24859,37084:24860,37085:24861,37086:24862,37087:24865,37088:24866,37089:24869,37090:24872,37091:24873,37092:24874,37093:24876,37094:24877,37095:24878,37096:24879,37097:24880,37098:24881,37099:24882,37100:24883,37101:24884,37102:24885,37103:24886,37104:24887,37105:24888,37106:24889,37107:24890,37108:24891,37109:24892,37110:24893,37111:24894,37112:24896,37113:24897,37114:24898,37115:24899,37116:24900,37117:24901,37118:24902,37184:24903,37185:24905,37186:24907,37187:24909,37188:24911,37189:24912,37190:24914,37191:24915,37192:24916,37193:24918,37194:24919,37195:24920,37196:24921,37197:24922,37198:24923,37199:24924,37200:24926,37201:24927,37202:24928,37203:24929,37204:24931,37205:24932,37206:24933,37207:24934,37208:24937,37209:24938,37210:24939,37211:24940,37212:24941,37213:24942,37214:24943,37215:24945,37216:24946,37217:24947,37218:24948,37219:24950,37220:24952,37221:24953,37222:24954,37223:24955,37224:24956,37225:24957,37226:24958,37227:24959,37228:24960,37229:24961,37230:24962,37231:24963,37232:24964,37233:24965,37234:24966,37235:24967,37236:24968,37237:24969,37238:24970,37239:24972,37240:24973,37241:24975,37242:24976,37243:24977,37244:24978,37245:24979,37246:24981,37248:24982,37249:24983,37250:24984,37251:24985,37252:24986,37253:24987,37254:24988,37255:24990,37256:24991,37257:24992,37258:24993,37259:24994,37260:24995,37261:24996,37262:24997,37263:24998,37264:25002,37265:25003,37266:25005,37267:25006,37268:25007,37269:25008,37270:25009,37271:25010,37272:25011,37273:25012,37274:25013,37275:25014,37276:25016,37277:25017,37278:25018,37279:25019,37280:25020,37281:25021,37282:25023,37283:25024,37284:25025,37285:25027,37286:25028,37287:25029,37288:25030,37289:25031,37290:25033,37291:25036,37292:25037,37293:25038,37294:25039,37295:25040,37296:25043,37297:25045,37298:25046,37299:25047,37300:25048,37301:25049,37302:25050,37303:25051,37304:25052,37305:25053,37306:25054,37307:25055,37308:25056,37309:25057,37310:25058,37311:25059,37312:25060,37313:25061,37314:25063,37315:25064,37316:25065,37317:25066,37318:25067,37319:25068,37320:25069,37321:25070,37322:25071,37323:25072,37324:25073,37325:25074,37326:25075,37327:25076,37328:25078,37329:25079,37330:25080,37331:25081,37332:25082,37333:25083,37334:25084,37335:25085,37336:25086,37337:25088,37338:25089,37339:25090,37340:25091,37341:25092,37342:25093,37343:25095,37344:25097,37345:25107,37346:25108,37347:25113,37348:25116,37349:25117,37350:25118,37351:25120,37352:25123,37353:25126,37354:25127,37355:25128,37356:25129,37357:25131,37358:25133,37359:25135,37360:25136,37361:25137,37362:25138,37363:25141,37364:25142,37365:25144,37366:25145,37367:25146,37368:25147,37369:25148,37370:25154,37371:25156,37372:25157,37373:25158,37374:25162,37440:25167,37441:25168,37442:25173,37443:25174,37444:25175,37445:25177,37446:25178,37447:25180,37448:25181,37449:25182,37450:25183,37451:25184,37452:25185,37453:25186,37454:25188,37455:25189,37456:25192,37457:25201,37458:25202,37459:25204,37460:25205,37461:25207,37462:25208,37463:25210,37464:25211,37465:25213,37466:25217,37467:25218,37468:25219,37469:25221,37470:25222,37471:25223,37472:25224,37473:25227,37474:25228,37475:25229,37476:25230,37477:25231,37478:25232,37479:25236,37480:25241,37481:25244,37482:25245,37483:25246,37484:25251,37485:25254,37486:25255,37487:25257,37488:25258,37489:25261,37490:25262,37491:25263,37492:25264,37493:25266,37494:25267,37495:25268,37496:25270,37497:25271,37498:25272,37499:25274,37500:25278,37501:25280,37502:25281,37504:25283,37505:25291,37506:25295,37507:25297,37508:25301,37509:25309,37510:25310,37511:25312,37512:25313,37513:25316,37514:25322,37515:25323,37516:25328,37517:25330,37518:25333,37519:25336,37520:25337,37521:25338,37522:25339,37523:25344,37524:25347,37525:25348,37526:25349,37527:25350,37528:25354,37529:25355,37530:25356,37531:25357,37532:25359,37533:25360,37534:25362,37535:25363,37536:25364,37537:25365,37538:25367,37539:25368,37540:25369,37541:25372,37542:25382,37543:25383,37544:25385,37545:25388,37546:25389,37547:25390,37548:25392,37549:25393,37550:25395,37551:25396,37552:25397,37553:25398,37554:25399,37555:25400,37556:25403,37557:25404,37558:25406,37559:25407,37560:25408,37561:25409,37562:25412,37563:25415,37564:25416,37565:25418,37566:25425,37567:25426,37568:25427,37569:25428,37570:25430,37571:25431,37572:25432,37573:25433,37574:25434,37575:25435,37576:25436,37577:25437,37578:25440,37579:25444,37580:25445,37581:25446,37582:25448,37583:25450,37584:25451,37585:25452,37586:25455,37587:25456,37588:25458,37589:25459,37590:25460,37591:25461,37592:25464,37593:25465,37594:25468,37595:25469,37596:25470,37597:25471,37598:25473,37599:25475,37600:25476,37601:25477,37602:25478,37603:25483,37604:25485,37605:25489,37606:25491,37607:25492,37608:25493,37609:25495,37610:25497,37611:25498,37612:25499,37613:25500,37614:25501,37615:25502,37616:25503,37617:25505,37618:25508,37619:25510,37620:25515,37621:25519,37622:25521,37623:25522,37624:25525,37625:25526,37626:25529,37627:25531,37628:25533,37629:25535,37630:25536,37696:25537,37697:25538,37698:25539,37699:25541,37700:25543,37701:25544,37702:25546,37703:25547,37704:25548,37705:25553,37706:25555,37707:25556,37708:25557,37709:25559,37710:25560,37711:25561,37712:25562,37713:25563,37714:25564,37715:25565,37716:25567,37717:25570,37718:25572,37719:25573,37720:25574,37721:25575,37722:25576,37723:25579,37724:25580,37725:25582,37726:25583,37727:25584,37728:25585,37729:25587,37730:25589,37731:25591,37732:25593,37733:25594,37734:25595,37735:25596,37736:25598,37737:25603,37738:25604,37739:25606,37740:25607,37741:25608,37742:25609,37743:25610,37744:25613,37745:25614,37746:25617,37747:25618,37748:25621,37749:25622,37750:25623,37751:25624,37752:25625,37753:25626,37754:25629,37755:25631,37756:25634,37757:25635,37758:25636,37760:25637,37761:25639,37762:25640,37763:25641,37764:25643,37765:25646,37766:25647,37767:25648,37768:25649,37769:25650,37770:25651,37771:25653,37772:25654,37773:25655,37774:25656,37775:25657,37776:25659,37777:25660,37778:25662,37779:25664,37780:25666,37781:25667,37782:25673,37783:25675,37784:25676,37785:25677,37786:25678,37787:25679,37788:25680,37789:25681,37790:25683,37791:25685,37792:25686,37793:25687,37794:25689,37795:25690,37796:25691,37797:25692,37798:25693,37799:25695,37800:25696,37801:25697,37802:25698,37803:25699,37804:25700,37805:25701,37806:25702,37807:25704,37808:25706,37809:25707,37810:25708,37811:25710,37812:25711,37813:25712,37814:25713,37815:25714,37816:25715,37817:25716,37818:25717,37819:25718,37820:25719,37821:25723,37822:25724,37823:25725,37824:25726,37825:25727,37826:25728,37827:25729,37828:25731,37829:25734,37830:25736,37831:25737,37832:25738,37833:25739,37834:25740,37835:25741,37836:25742,37837:25743,37838:25744,37839:25747,37840:25748,37841:25751,37842:25752,37843:25754,37844:25755,37845:25756,37846:25757,37847:25759,37848:25760,37849:25761,37850:25762,37851:25763,37852:25765,37853:25766,37854:25767,37855:25768,37856:25770,37857:25771,37858:25775,37859:25777,37860:25778,37861:25779,37862:25780,37863:25782,37864:25785,37865:25787,37866:25789,37867:25790,37868:25791,37869:25793,37870:25795,37871:25796,37872:25798,37873:25799,37874:25800,37875:25801,37876:25802,37877:25803,37878:25804,37879:25807,37880:25809,37881:25811,37882:25812,37883:25813,37884:25814,37885:25817,37886:25818,37952:25819,37953:25820,37954:25821,37955:25823,37956:25824,37957:25825,37958:25827,37959:25829,37960:25831,37961:25832,37962:25833,37963:25834,37964:25835,37965:25836,37966:25837,37967:25838,37968:25839,37969:25840,37970:25841,37971:25842,37972:25843,37973:25844,37974:25845,37975:25846,37976:25847,37977:25848,37978:25849,37979:25850,37980:25851,37981:25852,37982:25853,37983:25854,37984:25855,37985:25857,37986:25858,37987:25859,37988:25860,37989:25861,37990:25862,37991:25863,37992:25864,37993:25866,37994:25867,37995:25868,37996:25869,37997:25870,37998:25871,37999:25872,38e3:25873,38001:25875,38002:25876,38003:25877,38004:25878,38005:25879,38006:25881,38007:25882,38008:25883,38009:25884,38010:25885,38011:25886,38012:25887,38013:25888,38014:25889,38016:25890,38017:25891,38018:25892,38019:25894,38020:25895,38021:25896,38022:25897,38023:25898,38024:25900,38025:25901,38026:25904,38027:25905,38028:25906,38029:25907,38030:25911,38031:25914,38032:25916,38033:25917,38034:25920,38035:25921,38036:25922,38037:25923,38038:25924,38039:25926,38040:25927,38041:25930,38042:25931,38043:25933,38044:25934,38045:25936,38046:25938,38047:25939,38048:25940,38049:25943,38050:25944,38051:25946,38052:25948,38053:25951,38054:25952,38055:25953,38056:25956,38057:25957,38058:25959,38059:25960,38060:25961,38061:25962,38062:25965,38063:25966,38064:25967,38065:25969,38066:25971,38067:25973,38068:25974,38069:25976,38070:25977,38071:25978,38072:25979,38073:25980,38074:25981,38075:25982,38076:25983,38077:25984,38078:25985,38079:25986,38080:25987,38081:25988,38082:25989,38083:25990,38084:25992,38085:25993,38086:25994,38087:25997,38088:25998,38089:25999,38090:26002,38091:26004,38092:26005,38093:26006,38094:26008,38095:26010,38096:26013,38097:26014,38098:26016,38099:26018,38100:26019,38101:26022,38102:26024,38103:26026,38104:26028,38105:26030,38106:26033,38107:26034,38108:26035,38109:26036,38110:26037,38111:26038,38112:26039,38113:26040,38114:26042,38115:26043,38116:26046,38117:26047,38118:26048,38119:26050,38120:26055,38121:26056,38122:26057,38123:26058,38124:26061,38125:26064,38126:26065,38127:26067,38128:26068,38129:26069,38130:26072,38131:26073,38132:26074,38133:26075,38134:26076,38135:26077,38136:26078,38137:26079,38138:26081,38139:26083,38140:26084,38141:26090,38142:26091,38208:26098,38209:26099,38210:26100,38211:26101,38212:26104,38213:26105,38214:26107,38215:26108,38216:26109,38217:26110,38218:26111,38219:26113,38220:26116,38221:26117,38222:26119,38223:26120,38224:26121,38225:26123,38226:26125,38227:26128,38228:26129,38229:26130,38230:26134,38231:26135,38232:26136,38233:26138,38234:26139,38235:26140,38236:26142,38237:26145,38238:26146,38239:26147,38240:26148,38241:26150,38242:26153,38243:26154,38244:26155,38245:26156,38246:26158,38247:26160,38248:26162,38249:26163,38250:26167,38251:26168,38252:26169,38253:26170,38254:26171,38255:26173,38256:26175,38257:26176,38258:26178,38259:26180,38260:26181,38261:26182,38262:26183,38263:26184,38264:26185,38265:26186,38266:26189,38267:26190,38268:26192,38269:26193,38270:26200,38272:26201,38273:26203,38274:26204,38275:26205,38276:26206,38277:26208,38278:26210,38279:26211,38280:26213,38281:26215,38282:26217,38283:26218,38284:26219,38285:26220,38286:26221,38287:26225,38288:26226,38289:26227,38290:26229,38291:26232,38292:26233,38293:26235,38294:26236,38295:26237,38296:26239,38297:26240,38298:26241,38299:26243,38300:26245,38301:26246,38302:26248,38303:26249,38304:26250,38305:26251,38306:26253,38307:26254,38308:26255,38309:26256,38310:26258,38311:26259,38312:26260,38313:26261,38314:26264,38315:26265,38316:26266,38317:26267,38318:26268,38319:26270,38320:26271,38321:26272,38322:26273,38323:26274,38324:26275,38325:26276,38326:26277,38327:26278,38328:26281,38329:26282,38330:26283,38331:26284,38332:26285,38333:26287,38334:26288,38335:26289,38336:26290,38337:26291,38338:26293,38339:26294,38340:26295,38341:26296,38342:26298,38343:26299,38344:26300,38345:26301,38346:26303,38347:26304,38348:26305,38349:26306,38350:26307,38351:26308,38352:26309,38353:26310,38354:26311,38355:26312,38356:26313,38357:26314,38358:26315,38359:26316,38360:26317,38361:26318,38362:26319,38363:26320,38364:26321,38365:26322,38366:26323,38367:26324,38368:26325,38369:26326,38370:26327,38371:26328,38372:26330,38373:26334,38374:26335,38375:26336,38376:26337,38377:26338,38378:26339,38379:26340,38380:26341,38381:26343,38382:26344,38383:26346,38384:26347,38385:26348,38386:26349,38387:26350,38388:26351,38389:26353,38390:26357,38391:26358,38392:26360,38393:26362,38394:26363,38395:26365,38396:26369,38397:26370,38398:26371,38464:26372,38465:26373,38466:26374,38467:26375,38468:26380,38469:26382,38470:26383,38471:26385,38472:26386,38473:26387,38474:26390,38475:26392,38476:26393,38477:26394,38478:26396,38479:26398,38480:26400,38481:26401,38482:26402,38483:26403,38484:26404,38485:26405,38486:26407,38487:26409,38488:26414,38489:26416,38490:26418,38491:26419,38492:26422,38493:26423,38494:26424,38495:26425,38496:26427,38497:26428,38498:26430,38499:26431,38500:26433,38501:26436,38502:26437,38503:26439,38504:26442,38505:26443,38506:26445,38507:26450,38508:26452,38509:26453,38510:26455,38511:26456,38512:26457,38513:26458,38514:26459,38515:26461,38516:26466,38517:26467,38518:26468,38519:26470,38520:26471,38521:26475,38522:26476,38523:26478,38524:26481,38525:26484,38526:26486,38528:26488,38529:26489,38530:26490,38531:26491,38532:26493,38533:26496,38534:26498,38535:26499,38536:26501,38537:26502,38538:26504,38539:26506,38540:26508,38541:26509,38542:26510,38543:26511,38544:26513,38545:26514,38546:26515,38547:26516,38548:26518,38549:26521,38550:26523,38551:26527,38552:26528,38553:26529,38554:26532,38555:26534,38556:26537,38557:26540,38558:26542,38559:26545,38560:26546,38561:26548,38562:26553,38563:26554,38564:26555,38565:26556,38566:26557,38567:26558,38568:26559,38569:26560,38570:26562,38571:26565,38572:26566,38573:26567,38574:26568,38575:26569,38576:26570,38577:26571,38578:26572,38579:26573,38580:26574,38581:26581,38582:26582,38583:26583,38584:26587,38585:26591,38586:26593,38587:26595,38588:26596,38589:26598,38590:26599,38591:26600,38592:26602,38593:26603,38594:26605,38595:26606,38596:26610,38597:26613,38598:26614,38599:26615,38600:26616,38601:26617,38602:26618,38603:26619,38604:26620,38605:26622,38606:26625,38607:26626,38608:26627,38609:26628,38610:26630,38611:26637,38612:26640,38613:26642,38614:26644,38615:26645,38616:26648,38617:26649,38618:26650,38619:26651,38620:26652,38621:26654,38622:26655,38623:26656,38624:26658,38625:26659,38626:26660,38627:26661,38628:26662,38629:26663,38630:26664,38631:26667,38632:26668,38633:26669,38634:26670,38635:26671,38636:26672,38637:26673,38638:26676,38639:26677,38640:26678,38641:26682,38642:26683,38643:26687,38644:26695,38645:26699,38646:26701,38647:26703,38648:26706,38649:26710,38650:26711,38651:26712,38652:26713,38653:26714,38654:26715,38720:26716,38721:26717,38722:26718,38723:26719,38724:26730,38725:26732,38726:26733,38727:26734,38728:26735,38729:26736,38730:26737,38731:26738,38732:26739,38733:26741,38734:26744,38735:26745,38736:26746,38737:26747,38738:26748,38739:26749,38740:26750,38741:26751,38742:26752,38743:26754,38744:26756,38745:26759,38746:26760,38747:26761,38748:26762,38749:26763,38750:26764,38751:26765,38752:26766,38753:26768,38754:26769,38755:26770,38756:26772,38757:26773,38758:26774,38759:26776,38760:26777,38761:26778,38762:26779,38763:26780,38764:26781,38765:26782,38766:26783,38767:26784,38768:26785,38769:26787,38770:26788,38771:26789,38772:26793,38773:26794,38774:26795,38775:26796,38776:26798,38777:26801,38778:26802,38779:26804,38780:26806,38781:26807,38782:26808,38784:26809,38785:26810,38786:26811,38787:26812,38788:26813,38789:26814,38790:26815,38791:26817,38792:26819,38793:26820,38794:26821,38795:26822,38796:26823,38797:26824,38798:26826,38799:26828,38800:26830,38801:26831,38802:26832,38803:26833,38804:26835,38805:26836,38806:26838,38807:26839,38808:26841,38809:26843,38810:26844,38811:26845,38812:26846,38813:26847,38814:26849,38815:26850,38816:26852,38817:26853,38818:26854,38819:26855,38820:26856,38821:26857,38822:26858,38823:26859,38824:26860,38825:26861,38826:26863,38827:26866,38828:26867,38829:26868,38830:26870,38831:26871,38832:26872,38833:26875,38834:26877,38835:26878,38836:26879,38837:26880,38838:26882,38839:26883,38840:26884,38841:26886,38842:26887,38843:26888,38844:26889,38845:26890,38846:26892,38847:26895,38848:26897,38849:26899,38850:26900,38851:26901,38852:26902,38853:26903,38854:26904,38855:26905,38856:26906,38857:26907,38858:26908,38859:26909,38860:26910,38861:26913,38862:26914,38863:26915,38864:26917,38865:26918,38866:26919,38867:26920,38868:26921,38869:26922,38870:26923,38871:26924,38872:26926,38873:26927,38874:26929,38875:26930,38876:26931,38877:26933,38878:26934,38879:26935,38880:26936,38881:26938,38882:26939,38883:26940,38884:26942,38885:26944,38886:26945,38887:26947,38888:26948,38889:26949,38890:26950,38891:26951,38892:26952,38893:26953,38894:26954,38895:26955,38896:26956,38897:26957,38898:26958,38899:26959,38900:26960,38901:26961,38902:26962,38903:26963,38904:26965,38905:26966,38906:26968,38907:26969,38908:26971,38909:26972,38910:26975,38976:26977,38977:26978,38978:26980,38979:26981,38980:26983,38981:26984,38982:26985,38983:26986,38984:26988,38985:26989,38986:26991,38987:26992,38988:26994,38989:26995,38990:26996,38991:26997,38992:26998,38993:27002,38994:27003,38995:27005,38996:27006,38997:27007,38998:27009,38999:27011,39e3:27013,39001:27018,39002:27019,39003:27020,39004:27022,39005:27023,39006:27024,39007:27025,39008:27026,39009:27027,39010:27030,39011:27031,39012:27033,39013:27034,39014:27037,39015:27038,39016:27039,39017:27040,39018:27041,39019:27042,39020:27043,39021:27044,39022:27045,39023:27046,39024:27049,39025:27050,39026:27052,39027:27054,39028:27055,39029:27056,39030:27058,39031:27059,39032:27061,39033:27062,39034:27064,39035:27065,39036:27066,39037:27068,39038:27069,39040:27070,39041:27071,39042:27072,39043:27074,39044:27075,39045:27076,39046:27077,39047:27078,39048:27079,39049:27080,39050:27081,39051:27083,39052:27085,39053:27087,39054:27089,39055:27090,39056:27091,39057:27093,39058:27094,39059:27095,39060:27096,39061:27097,39062:27098,39063:27100,39064:27101,39065:27102,39066:27105,39067:27106,39068:27107,39069:27108,39070:27109,39071:27110,39072:27111,39073:27112,39074:27113,39075:27114,39076:27115,39077:27116,39078:27118,39079:27119,39080:27120,39081:27121,39082:27123,39083:27124,39084:27125,39085:27126,39086:27127,39087:27128,39088:27129,39089:27130,39090:27131,39091:27132,39092:27134,39093:27136,39094:27137,39095:27138,39096:27139,39097:27140,39098:27141,39099:27142,39100:27143,39101:27144,39102:27145,39103:27147,39104:27148,39105:27149,39106:27150,39107:27151,39108:27152,39109:27153,39110:27154,39111:27155,39112:27156,39113:27157,39114:27158,39115:27161,39116:27162,39117:27163,39118:27164,39119:27165,39120:27166,39121:27168,39122:27170,39123:27171,39124:27172,39125:27173,39126:27174,39127:27175,39128:27177,39129:27179,39130:27180,39131:27181,39132:27182,39133:27184,39134:27186,39135:27187,39136:27188,39137:27190,39138:27191,39139:27192,39140:27193,39141:27194,39142:27195,39143:27196,39144:27199,39145:27200,39146:27201,39147:27202,39148:27203,39149:27205,39150:27206,39151:27208,39152:27209,39153:27210,39154:27211,39155:27212,39156:27213,39157:27214,39158:27215,39159:27217,39160:27218,39161:27219,39162:27220,39163:27221,39164:27222,39165:27223,39166:27226,39232:27228,39233:27229,39234:27230,39235:27231,39236:27232,39237:27234,39238:27235,39239:27236,39240:27238,39241:27239,39242:27240,39243:27241,39244:27242,39245:27243,39246:27244,39247:27245,39248:27246,39249:27247,39250:27248,39251:27250,39252:27251,39253:27252,39254:27253,39255:27254,39256:27255,39257:27256,39258:27258,39259:27259,39260:27261,39261:27262,39262:27263,39263:27265,39264:27266,39265:27267,39266:27269,39267:27270,39268:27271,39269:27272,39270:27273,39271:27274,39272:27275,39273:27276,39274:27277,39275:27279,39276:27282,39277:27283,39278:27284,39279:27285,39280:27286,39281:27288,39282:27289,39283:27290,39284:27291,39285:27292,39286:27293,39287:27294,39288:27295,39289:27297,39290:27298,39291:27299,39292:27300,39293:27301,39294:27302,39296:27303,39297:27304,39298:27306,39299:27309,39300:27310,39301:27311,39302:27312,39303:27313,39304:27314,39305:27315,39306:27316,39307:27317,39308:27318,39309:27319,39310:27320,39311:27321,39312:27322,39313:27323,39314:27324,39315:27325,39316:27326,39317:27327,39318:27328,39319:27329,39320:27330,39321:27331,39322:27332,39323:27333,39324:27334,39325:27335,39326:27336,39327:27337,39328:27338,39329:27339,39330:27340,39331:27341,39332:27342,39333:27343,39334:27344,39335:27345,39336:27346,39337:27347,39338:27348,39339:27349,39340:27350,39341:27351,39342:27352,39343:27353,39344:27354,39345:27355,39346:27356,39347:27357,39348:27358,39349:27359,39350:27360,39351:27361,39352:27362,39353:27363,39354:27364,39355:27365,39356:27366,39357:27367,39358:27368,39359:27369,39360:27370,39361:27371,39362:27372,39363:27373,39364:27374,39365:27375,39366:27376,39367:27377,39368:27378,39369:27379,39370:27380,39371:27381,39372:27382,39373:27383,39374:27384,39375:27385,39376:27386,39377:27387,39378:27388,39379:27389,39380:27390,39381:27391,39382:27392,39383:27393,39384:27394,39385:27395,39386:27396,39387:27397,39388:27398,39389:27399,39390:27400,39391:27401,39392:27402,39393:27403,39394:27404,39395:27405,39396:27406,39397:27407,39398:27408,39399:27409,39400:27410,39401:27411,39402:27412,39403:27413,39404:27414,39405:27415,39406:27416,39407:27417,39408:27418,39409:27419,39410:27420,39411:27421,39412:27422,39413:27423,39414:27429,39415:27430,39416:27432,39417:27433,39418:27434,39419:27435,39420:27436,39421:27437,39422:27438,39488:27439,39489:27440,39490:27441,39491:27443,39492:27444,39493:27445,39494:27446,39495:27448,39496:27451,39497:27452,39498:27453,39499:27455,39500:27456,39501:27457,39502:27458,39503:27460,39504:27461,39505:27464,39506:27466,39507:27467,39508:27469,39509:27470,39510:27471,39511:27472,39512:27473,39513:27474,39514:27475,39515:27476,39516:27477,39517:27478,39518:27479,39519:27480,39520:27482,39521:27483,39522:27484,39523:27485,39524:27486,39525:27487,39526:27488,39527:27489,39528:27496,39529:27497,39530:27499,39531:27500,39532:27501,39533:27502,39534:27503,39535:27504,39536:27505,39537:27506,39538:27507,39539:27508,39540:27509,39541:27510,39542:27511,39543:27512,39544:27514,39545:27517,39546:27518,39547:27519,39548:27520,39549:27525,39550:27528,39552:27532,39553:27534,39554:27535,39555:27536,39556:27537,39557:27540,39558:27541,39559:27543,39560:27544,39561:27545,39562:27548,39563:27549,39564:27550,39565:27551,39566:27552,39567:27554,39568:27555,39569:27556,39570:27557,39571:27558,39572:27559,39573:27560,39574:27561,39575:27563,39576:27564,39577:27565,39578:27566,39579:27567,39580:27568,39581:27569,39582:27570,39583:27574,39584:27576,39585:27577,39586:27578,39587:27579,39588:27580,39589:27581,39590:27582,39591:27584,39592:27587,39593:27588,39594:27590,39595:27591,39596:27592,39597:27593,39598:27594,39599:27596,39600:27598,39601:27600,39602:27601,39603:27608,39604:27610,39605:27612,39606:27613,39607:27614,39608:27615,39609:27616,39610:27618,39611:27619,39612:27620,39613:27621,39614:27622,39615:27623,39616:27624,39617:27625,39618:27628,39619:27629,39620:27630,39621:27632,39622:27633,39623:27634,39624:27636,39625:27638,39626:27639,39627:27640,39628:27642,39629:27643,39630:27644,39631:27646,39632:27647,39633:27648,39634:27649,39635:27650,39636:27651,39637:27652,39638:27656,39639:27657,39640:27658,39641:27659,39642:27660,39643:27662,39644:27666,39645:27671,39646:27676,39647:27677,39648:27678,39649:27680,39650:27683,39651:27685,39652:27691,39653:27692,39654:27693,39655:27697,39656:27699,39657:27702,39658:27703,39659:27705,39660:27706,39661:27707,39662:27708,39663:27710,39664:27711,39665:27715,39666:27716,39667:27717,39668:27720,39669:27723,39670:27724,39671:27725,39672:27726,39673:27727,39674:27729,39675:27730,39676:27731,39677:27734,39678:27736,39744:27737,39745:27738,39746:27746,39747:27747,39748:27749,39749:27750,39750:27751,39751:27755,39752:27756,39753:27757,39754:27758,39755:27759,39756:27761,39757:27763,39758:27765,39759:27767,39760:27768,39761:27770,39762:27771,39763:27772,39764:27775,39765:27776,39766:27780,39767:27783,39768:27786,39769:27787,39770:27789,39771:27790,39772:27793,39773:27794,39774:27797,39775:27798,39776:27799,39777:27800,39778:27802,39779:27804,39780:27805,39781:27806,39782:27808,39783:27810,39784:27816,39785:27820,39786:27823,39787:27824,39788:27828,39789:27829,39790:27830,39791:27831,39792:27834,39793:27840,39794:27841,39795:27842,39796:27843,39797:27846,39798:27847,39799:27848,39800:27851,39801:27853,39802:27854,39803:27855,39804:27857,39805:27858,39806:27864,39808:27865,39809:27866,39810:27868,39811:27869,39812:27871,39813:27876,39814:27878,39815:27879,39816:27881,39817:27884,39818:27885,39819:27890,39820:27892,39821:27897,39822:27903,39823:27904,39824:27906,39825:27907,39826:27909,39827:27910,39828:27912,39829:27913,39830:27914,39831:27917,39832:27919,39833:27920,39834:27921,39835:27923,39836:27924,39837:27925,39838:27926,39839:27928,39840:27932,39841:27933,39842:27935,39843:27936,39844:27937,39845:27938,39846:27939,39847:27940,39848:27942,39849:27944,39850:27945,39851:27948,39852:27949,39853:27951,39854:27952,39855:27956,39856:27958,39857:27959,39858:27960,39859:27962,39860:27967,39861:27968,39862:27970,39863:27972,39864:27977,39865:27980,39866:27984,39867:27989,39868:27990,39869:27991,39870:27992,39871:27995,39872:27997,39873:27999,39874:28001,39875:28002,39876:28004,39877:28005,39878:28007,39879:28008,39880:28011,39881:28012,39882:28013,39883:28016,39884:28017,39885:28018,39886:28019,39887:28021,39888:28022,39889:28025,39890:28026,39891:28027,39892:28029,39893:28030,39894:28031,39895:28032,39896:28033,39897:28035,39898:28036,39899:28038,39900:28039,39901:28042,39902:28043,39903:28045,39904:28047,39905:28048,39906:28050,39907:28054,39908:28055,39909:28056,39910:28057,39911:28058,39912:28060,39913:28066,39914:28069,39915:28076,39916:28077,39917:28080,39918:28081,39919:28083,39920:28084,39921:28086,39922:28087,39923:28089,39924:28090,39925:28091,39926:28092,39927:28093,39928:28094,39929:28097,39930:28098,39931:28099,39932:28104,39933:28105,39934:28106,4e4:28109,40001:28110,40002:28111,40003:28112,40004:28114,40005:28115,40006:28116,40007:28117,40008:28119,40009:28122,40010:28123,40011:28124,40012:28127,40013:28130,40014:28131,40015:28133,40016:28135,40017:28136,40018:28137,40019:28138,40020:28141,40021:28143,40022:28144,40023:28146,40024:28148,40025:28149,40026:28150,40027:28152,40028:28154,40029:28157,40030:28158,40031:28159,40032:28160,40033:28161,40034:28162,40035:28163,40036:28164,40037:28166,40038:28167,40039:28168,40040:28169,40041:28171,40042:28175,40043:28178,40044:28179,40045:28181,40046:28184,40047:28185,40048:28187,40049:28188,40050:28190,40051:28191,40052:28194,40053:28198,40054:28199,40055:28200,40056:28202,40057:28204,40058:28206,40059:28208,40060:28209,40061:28211,40062:28213,40064:28214,40065:28215,40066:28217,40067:28219,40068:28220,40069:28221,40070:28222,40071:28223,40072:28224,40073:28225,40074:28226,40075:28229,40076:28230,40077:28231,40078:28232,40079:28233,40080:28234,40081:28235,40082:28236,40083:28239,40084:28240,40085:28241,40086:28242,40087:28245,40088:28247,40089:28249,40090:28250,40091:28252,40092:28253,40093:28254,40094:28256,40095:28257,40096:28258,40097:28259,40098:28260,40099:28261,40100:28262,40101:28263,40102:28264,40103:28265,40104:28266,40105:28268,40106:28269,40107:28271,40108:28272,40109:28273,40110:28274,40111:28275,40112:28276,40113:28277,40114:28278,40115:28279,40116:28280,40117:28281,40118:28282,40119:28283,40120:28284,40121:28285,40122:28288,40123:28289,40124:28290,40125:28292,40126:28295,40127:28296,40128:28298,40129:28299,40130:28300,40131:28301,40132:28302,40133:28305,40134:28306,40135:28307,40136:28308,40137:28309,40138:28310,40139:28311,40140:28313,40141:28314,40142:28315,40143:28317,40144:28318,40145:28320,40146:28321,40147:28323,40148:28324,40149:28326,40150:28328,40151:28329,40152:28331,40153:28332,40154:28333,40155:28334,40156:28336,40157:28339,40158:28341,40159:28344,40160:28345,40161:28348,40162:28350,40163:28351,40164:28352,40165:28355,40166:28356,40167:28357,40168:28358,40169:28360,40170:28361,40171:28362,40172:28364,40173:28365,40174:28366,40175:28368,40176:28370,40177:28374,40178:28376,40179:28377,40180:28379,40181:28380,40182:28381,40183:28387,40184:28391,40185:28394,40186:28395,40187:28396,40188:28397,40189:28398,40190:28399,40256:28400,40257:28401,40258:28402,40259:28403,40260:28405,40261:28406,40262:28407,40263:28408,40264:28410,40265:28411,40266:28412,40267:28413,40268:28414,40269:28415,40270:28416,40271:28417,40272:28419,40273:28420,40274:28421,40275:28423,40276:28424,40277:28426,40278:28427,40279:28428,40280:28429,40281:28430,40282:28432,40283:28433,40284:28434,40285:28438,40286:28439,40287:28440,40288:28441,40289:28442,40290:28443,40291:28444,40292:28445,40293:28446,40294:28447,40295:28449,40296:28450,40297:28451,40298:28453,40299:28454,40300:28455,40301:28456,40302:28460,40303:28462,40304:28464,40305:28466,40306:28468,40307:28469,40308:28471,40309:28472,40310:28473,40311:28474,40312:28475,40313:28476,40314:28477,40315:28479,40316:28480,40317:28481,40318:28482,40320:28483,40321:28484,40322:28485,40323:28488,40324:28489,40325:28490,40326:28492,40327:28494,40328:28495,40329:28496,40330:28497,40331:28498,40332:28499,40333:28500,40334:28501,40335:28502,40336:28503,40337:28505,40338:28506,40339:28507,40340:28509,40341:28511,40342:28512,40343:28513,40344:28515,40345:28516,40346:28517,40347:28519,40348:28520,40349:28521,40350:28522,40351:28523,40352:28524,40353:28527,40354:28528,40355:28529,40356:28531,40357:28533,40358:28534,40359:28535,40360:28537,40361:28539,40362:28541,40363:28542,40364:28543,40365:28544,40366:28545,40367:28546,40368:28547,40369:28549,40370:28550,40371:28551,40372:28554,40373:28555,40374:28559,40375:28560,40376:28561,40377:28562,40378:28563,40379:28564,40380:28565,40381:28566,40382:28567,40383:28568,40384:28569,40385:28570,40386:28571,40387:28573,40388:28574,40389:28575,40390:28576,40391:28578,40392:28579,40393:28580,40394:28581,40395:28582,40396:28584,40397:28585,40398:28586,40399:28587,40400:28588,40401:28589,40402:28590,40403:28591,40404:28592,40405:28593,40406:28594,40407:28596,40408:28597,40409:28599,40410:28600,40411:28602,40412:28603,40413:28604,40414:28605,40415:28606,40416:28607,40417:28609,40418:28611,40419:28612,40420:28613,40421:28614,40422:28615,40423:28616,40424:28618,40425:28619,40426:28620,40427:28621,40428:28622,40429:28623,40430:28624,40431:28627,40432:28628,40433:28629,40434:28630,40435:28631,40436:28632,40437:28633,40438:28634,40439:28635,40440:28636,40441:28637,40442:28639,40443:28642,40444:28643,40445:28644,40446:28645,40512:28646,40513:28647,40514:28648,40515:28649,40516:28650,40517:28651,40518:28652,40519:28653,40520:28656,40521:28657,40522:28658,40523:28659,40524:28660,40525:28661,40526:28662,40527:28663,40528:28664,40529:28665,40530:28666,40531:28667,40532:28668,40533:28669,40534:28670,40535:28671,40536:28672,40537:28673,40538:28674,40539:28675,40540:28676,40541:28677,40542:28678,40543:28679,40544:28680,40545:28681,40546:28682,40547:28683,40548:28684,40549:28685,40550:28686,40551:28687,40552:28688,40553:28690,40554:28691,40555:28692,40556:28693,40557:28694,40558:28695,40559:28696,40560:28697,40561:28700,40562:28701,40563:28702,40564:28703,40565:28704,40566:28705,40567:28706,40568:28708,40569:28709,40570:28710,40571:28711,40572:28712,40573:28713,40574:28714,40576:28715,40577:28716,40578:28717,40579:28718,40580:28719,40581:28720,40582:28721,40583:28722,40584:28723,40585:28724,40586:28726,40587:28727,40588:28728,40589:28730,40590:28731,40591:28732,40592:28733,40593:28734,40594:28735,40595:28736,40596:28737,40597:28738,40598:28739,40599:28740,40600:28741,40601:28742,40602:28743,40603:28744,40604:28745,40605:28746,40606:28747,40607:28749,40608:28750,40609:28752,40610:28753,40611:28754,40612:28755,40613:28756,40614:28757,40615:28758,40616:28759,40617:28760,40618:28761,40619:28762,40620:28763,40621:28764,40622:28765,40623:28767,40624:28768,40625:28769,40626:28770,40627:28771,40628:28772,40629:28773,40630:28774,40631:28775,40632:28776,40633:28777,40634:28778,40635:28782,40636:28785,40637:28786,40638:28787,40639:28788,40640:28791,40641:28793,40642:28794,40643:28795,40644:28797,40645:28801,40646:28802,40647:28803,40648:28804,40649:28806,40650:28807,40651:28808,40652:28811,40653:28812,40654:28813,40655:28815,40656:28816,40657:28817,40658:28819,40659:28823,40660:28824,40661:28826,40662:28827,40663:28830,40664:28831,40665:28832,40666:28833,40667:28834,40668:28835,40669:28836,40670:28837,40671:28838,40672:28839,40673:28840,40674:28841,40675:28842,40676:28848,40677:28850,40678:28852,40679:28853,40680:28854,40681:28858,40682:28862,40683:28863,40684:28868,40685:28869,40686:28870,40687:28871,40688:28873,40689:28875,40690:28876,40691:28877,40692:28878,40693:28879,40694:28880,40695:28881,40696:28882,40697:28883,40698:28884,40699:28885,40700:28886,40701:28887,40702:28890,40768:28892,40769:28893,40770:28894,40771:28896,40772:28897,40773:28898,40774:28899,40775:28901,40776:28906,40777:28910,40778:28912,40779:28913,40780:28914,40781:28915,40782:28916,40783:28917,40784:28918,40785:28920,40786:28922,40787:28923,40788:28924,40789:28926,40790:28927,40791:28928,40792:28929,40793:28930,40794:28931,40795:28932,40796:28933,40797:28934,40798:28935,40799:28936,40800:28939,40801:28940,40802:28941,40803:28942,40804:28943,40805:28945,40806:28946,40807:28948,40808:28951,40809:28955,40810:28956,40811:28957,40812:28958,40813:28959,40814:28960,40815:28961,40816:28962,40817:28963,40818:28964,40819:28965,40820:28967,40821:28968,40822:28969,40823:28970,40824:28971,40825:28972,40826:28973,40827:28974,40828:28978,40829:28979,40830:28980,40832:28981,40833:28983,40834:28984,40835:28985,40836:28986,40837:28987,40838:28988,40839:28989,40840:28990,40841:28991,40842:28992,40843:28993,40844:28994,40845:28995,40846:28996,40847:28998,40848:28999,40849:29e3,40850:29001,40851:29003,40852:29005,40853:29007,40854:29008,40855:29009,40856:29010,40857:29011,40858:29012,40859:29013,40860:29014,40861:29015,40862:29016,40863:29017,40864:29018,40865:29019,40866:29021,40867:29023,40868:29024,40869:29025,40870:29026,40871:29027,40872:29029,40873:29033,40874:29034,40875:29035,40876:29036,40877:29037,40878:29039,40879:29040,40880:29041,40881:29044,40882:29045,40883:29046,40884:29047,40885:29049,40886:29051,40887:29052,40888:29054,40889:29055,40890:29056,40891:29057,40892:29058,40893:29059,40894:29061,40895:29062,40896:29063,40897:29064,40898:29065,40899:29067,40900:29068,40901:29069,40902:29070,40903:29072,40904:29073,40905:29074,40906:29075,40907:29077,40908:29078,40909:29079,40910:29082,40911:29083,40912:29084,40913:29085,40914:29086,40915:29089,40916:29090,40917:29091,40918:29092,40919:29093,40920:29094,40921:29095,40922:29097,40923:29098,40924:29099,40925:29101,40926:29102,40927:29103,40928:29104,40929:29105,40930:29106,40931:29108,40932:29110,40933:29111,40934:29112,40935:29114,40936:29115,40937:29116,40938:29117,40939:29118,40940:29119,40941:29120,40942:29121,40943:29122,40944:29124,40945:29125,40946:29126,40947:29127,40948:29128,40949:29129,40950:29130,40951:29131,40952:29132,40953:29133,40954:29135,40955:29136,40956:29137,40957:29138,40958:29139,41024:29142,41025:29143,41026:29144,41027:29145,41028:29146,41029:29147,41030:29148,41031:29149,41032:29150,41033:29151,41034:29153,41035:29154,41036:29155,41037:29156,41038:29158,41039:29160,41040:29161,41041:29162,41042:29163,41043:29164,41044:29165,41045:29167,41046:29168,41047:29169,41048:29170,41049:29171,41050:29172,41051:29173,41052:29174,41053:29175,41054:29176,41055:29178,41056:29179,41057:29180,41058:29181,41059:29182,41060:29183,41061:29184,41062:29185,41063:29186,41064:29187,41065:29188,41066:29189,41067:29191,41068:29192,41069:29193,41070:29194,41071:29195,41072:29196,41073:29197,41074:29198,41075:29199,41076:29200,41077:29201,41078:29202,41079:29203,41080:29204,41081:29205,41082:29206,41083:29207,41084:29208,41085:29209,41086:29210,41088:29211,41089:29212,41090:29214,41091:29215,41092:29216,41093:29217,41094:29218,41095:29219,41096:29220,41097:29221,41098:29222,41099:29223,41100:29225,41101:29227,41102:29229,41103:29230,41104:29231,41105:29234,41106:29235,41107:29236,41108:29242,41109:29244,41110:29246,41111:29248,41112:29249,41113:29250,41114:29251,41115:29252,41116:29253,41117:29254,41118:29257,41119:29258,41120:29259,41121:29262,41122:29263,41123:29264,41124:29265,41125:29267,41126:29268,41127:29269,41128:29271,41129:29272,41130:29274,41131:29276,41132:29278,41133:29280,41134:29283,41135:29284,41136:29285,41137:29288,41138:29290,41139:29291,41140:29292,41141:29293,41142:29296,41143:29297,41144:29299,41145:29300,41146:29302,41147:29303,41148:29304,41149:29307,41150:29308,41151:29309,41152:29314,41153:29315,41154:29317,41155:29318,41156:29319,41157:29320,41158:29321,41159:29324,41160:29326,41161:29328,41162:29329,41163:29331,41164:29332,41165:29333,41166:29334,41167:29335,41168:29336,41169:29337,41170:29338,41171:29339,41172:29340,41173:29341,41174:29342,41175:29344,41176:29345,41177:29346,41178:29347,41179:29348,41180:29349,41181:29350,41182:29351,41183:29352,41184:29353,41185:29354,41186:29355,41187:29358,41188:29361,41189:29362,41190:29363,41191:29365,41192:29370,41193:29371,41194:29372,41195:29373,41196:29374,41197:29375,41198:29376,41199:29381,41200:29382,41201:29383,41202:29385,41203:29386,41204:29387,41205:29388,41206:29391,41207:29393,41208:29395,41209:29396,41210:29397,41211:29398,41212:29400,41213:29402,41214:29403,41280:58566,41281:58567,41282:58568,41283:58569,41284:58570,41285:58571,41286:58572,41287:58573,41288:58574,41289:58575,41290:58576,41291:58577,41292:58578,41293:58579,41294:58580,41295:58581,41296:58582,41297:58583,41298:58584,41299:58585,41300:58586,41301:58587,41302:58588,41303:58589,41304:58590,41305:58591,41306:58592,41307:58593,41308:58594,41309:58595,41310:58596,41311:58597,41312:58598,41313:58599,41314:58600,41315:58601,41316:58602,41317:58603,41318:58604,41319:58605,41320:58606,41321:58607,41322:58608,41323:58609,41324:58610,41325:58611,41326:58612,41327:58613,41328:58614,41329:58615,41330:58616,41331:58617,41332:58618,41333:58619,41334:58620,41335:58621,41336:58622,41337:58623,41338:58624,41339:58625,41340:58626,41341:58627,41342:58628,41344:58629,41345:58630,41346:58631,41347:58632,41348:58633,41349:58634,41350:58635,41351:58636,41352:58637,41353:58638,41354:58639,41355:58640,41356:58641,41357:58642,41358:58643,41359:58644,41360:58645,41361:58646,41362:58647,41363:58648,41364:58649,41365:58650,41366:58651,41367:58652,41368:58653,41369:58654,41370:58655,41371:58656,41372:58657,41373:58658,41374:58659,41375:58660,41376:58661,41377:12288,41378:12289,41379:12290,41380:183,41381:713,41382:711,41383:168,41384:12291,41385:12293,41386:8212,41387:65374,41388:8214,41389:8230,41390:8216,41391:8217,41392:8220,41393:8221,41394:12308,41395:12309,41396:12296,41397:12297,41398:12298,41399:12299,41400:12300,41401:12301,41402:12302,41403:12303,41404:12310,41405:12311,41406:12304,41407:12305,41408:177,41409:215,41410:247,41411:8758,41412:8743,41413:8744,41414:8721,41415:8719,41416:8746,41417:8745,41418:8712,41419:8759,41420:8730,41421:8869,41422:8741,41423:8736,41424:8978,41425:8857,41426:8747,41427:8750,41428:8801,41429:8780,41430:8776,41431:8765,41432:8733,41433:8800,41434:8814,41435:8815,41436:8804,41437:8805,41438:8734,41439:8757,41440:8756,41441:9794,41442:9792,41443:176,41444:8242,41445:8243,41446:8451,41447:65284,41448:164,41449:65504,41450:65505,41451:8240,41452:167,41453:8470,41454:9734,41455:9733,41456:9675,41457:9679,41458:9678,41459:9671,41460:9670,41461:9633,41462:9632,41463:9651,41464:9650,41465:8251,41466:8594,41467:8592,41468:8593,41469:8595,41470:12307,41536:58662,41537:58663,41538:58664,41539:58665,41540:58666,41541:58667,41542:58668,41543:58669,41544:58670,41545:58671,41546:58672,41547:58673,41548:58674,41549:58675,41550:58676,41551:58677,41552:58678,41553:58679,41554:58680,41555:58681,41556:58682,41557:58683,41558:58684,41559:58685,41560:58686,41561:58687,41562:58688,41563:58689,41564:58690,41565:58691,41566:58692,41567:58693,41568:58694,41569:58695,41570:58696,41571:58697,41572:58698,41573:58699,41574:58700,41575:58701,41576:58702,41577:58703,41578:58704,41579:58705,41580:58706,41581:58707,41582:58708,41583:58709,41584:58710,41585:58711,41586:58712,41587:58713,41588:58714,41589:58715,41590:58716,41591:58717,41592:58718,41593:58719,41594:58720,41595:58721,41596:58722,41597:58723,41598:58724,41600:58725,41601:58726,41602:58727,41603:58728,41604:58729,41605:58730,41606:58731,41607:58732,41608:58733,41609:58734,41610:58735,41611:58736,41612:58737,41613:58738,41614:58739,41615:58740,41616:58741,41617:58742,41618:58743,41619:58744,41620:58745,41621:58746,41622:58747,41623:58748,41624:58749,41625:58750,41626:58751,41627:58752,41628:58753,41629:58754,41630:58755,41631:58756,41632:58757,41633:8560,41634:8561,41635:8562,41636:8563,41637:8564,41638:8565,41639:8566,41640:8567,41641:8568,41642:8569,41643:59238,41644:59239,41645:59240,41646:59241,41647:59242,41648:59243,41649:9352,41650:9353,41651:9354,41652:9355,41653:9356,41654:9357,41655:9358,41656:9359,41657:9360,41658:9361,41659:9362,41660:9363,41661:9364,41662:9365,41663:9366,41664:9367,41665:9368,41666:9369,41667:9370,41668:9371,41669:9332,41670:9333,41671:9334,41672:9335,41673:9336,41674:9337,41675:9338,41676:9339,41677:9340,41678:9341,41679:9342,41680:9343,41681:9344,41682:9345,41683:9346,41684:9347,41685:9348,41686:9349,41687:9350,41688:9351,41689:9312,41690:9313,41691:9314,41692:9315,41693:9316,41694:9317,41695:9318,41696:9319,41697:9320,41698:9321,41699:8364,41700:59245,41701:12832,41702:12833,41703:12834,41704:12835,41705:12836,41706:12837,41707:12838,41708:12839,41709:12840,41710:12841,41711:59246,41712:59247,41713:8544,41714:8545,41715:8546,41716:8547,41717:8548,41718:8549,41719:8550,41720:8551,41721:8552,41722:8553,41723:8554,41724:8555,41725:59248,41726:59249,41792:58758,41793:58759,41794:58760,41795:58761,41796:58762,41797:58763,41798:58764,41799:58765,41800:58766,41801:58767,41802:58768,41803:58769,41804:58770,41805:58771,41806:58772,41807:58773,41808:58774,41809:58775,41810:58776,41811:58777,41812:58778,41813:58779,41814:58780,41815:58781,41816:58782,41817:58783,41818:58784,41819:58785,41820:58786,41821:58787,41822:58788,41823:58789,41824:58790,41825:58791,41826:58792,41827:58793,41828:58794,41829:58795,41830:58796,41831:58797,41832:58798,41833:58799,41834:58800,41835:58801,41836:58802,41837:58803,41838:58804,41839:58805,41840:58806,41841:58807,41842:58808,41843:58809,41844:58810,41845:58811,41846:58812,41847:58813,41848:58814,41849:58815,41850:58816,41851:58817,41852:58818,41853:58819,41854:58820,41856:58821,41857:58822,41858:58823,41859:58824,41860:58825,41861:58826,41862:58827,41863:58828,41864:58829,41865:58830,41866:58831,41867:58832,41868:58833,41869:58834,41870:58835,41871:58836,41872:58837,41873:58838,41874:58839,41875:58840,41876:58841,41877:58842,41878:58843,41879:58844,41880:58845,41881:58846,41882:58847,41883:58848,41884:58849,41885:58850,41886:58851,41887:58852,41888:58853,41889:65281,41890:65282,41891:65283,41892:65509,41893:65285,41894:65286,41895:65287,41896:65288,41897:65289,41898:65290,41899:65291,41900:65292,41901:65293,41902:65294,41903:65295,41904:65296,41905:65297,41906:65298,41907:65299,41908:65300,41909:65301,41910:65302,41911:65303,41912:65304,41913:65305,41914:65306,41915:65307,41916:65308,41917:65309,41918:65310,41919:65311,41920:65312,41921:65313,41922:65314,41923:65315,41924:65316,41925:65317,41926:65318,41927:65319,41928:65320,41929:65321,41930:65322,41931:65323,41932:65324,41933:65325,41934:65326,41935:65327,41936:65328,41937:65329,41938:65330,41939:65331,41940:65332,41941:65333,41942:65334,41943:65335,41944:65336,41945:65337,41946:65338,41947:65339,41948:65340,41949:65341,41950:65342,41951:65343,41952:65344,41953:65345,41954:65346,41955:65347,41956:65348,41957:65349,41958:65350,41959:65351,41960:65352,41961:65353,41962:65354,41963:65355,41964:65356,41965:65357,41966:65358,41967:65359,41968:65360,41969:65361,41970:65362,41971:65363,41972:65364,41973:65365,41974:65366,41975:65367,41976:65368,41977:65369,41978:65370,41979:65371,41980:65372,41981:65373,41982:65507,42048:58854,42049:58855,42050:58856,42051:58857,42052:58858,42053:58859,42054:58860,42055:58861,42056:58862,42057:58863,42058:58864,42059:58865,42060:58866,42061:58867,42062:58868,42063:58869,42064:58870,42065:58871,42066:58872,42067:58873,42068:58874,42069:58875,42070:58876,42071:58877,42072:58878,42073:58879,42074:58880,42075:58881,42076:58882,42077:58883,42078:58884,42079:58885,42080:58886,42081:58887,42082:58888,42083:58889,42084:58890,42085:58891,42086:58892,42087:58893,42088:58894,42089:58895,42090:58896,42091:58897,42092:58898,42093:58899,42094:58900,42095:58901,42096:58902,42097:58903,42098:58904,42099:58905,42100:58906,42101:58907,42102:58908,42103:58909,42104:58910,42105:58911,42106:58912,42107:58913,42108:58914,42109:58915,42110:58916,42112:58917,42113:58918,42114:58919,42115:58920,42116:58921,42117:58922,42118:58923,42119:58924,42120:58925,42121:58926,42122:58927,42123:58928,42124:58929,42125:58930,42126:58931,42127:58932,42128:58933,42129:58934,42130:58935,42131:58936,42132:58937,42133:58938,42134:58939,42135:58940,42136:58941,42137:58942,42138:58943,42139:58944,42140:58945,42141:58946,42142:58947,42143:58948,42144:58949,42145:12353,42146:12354,42147:12355,42148:12356,42149:12357,42150:12358,42151:12359,42152:12360,42153:12361,42154:12362,42155:12363,42156:12364,42157:12365,42158:12366,42159:12367,42160:12368,42161:12369,42162:12370,42163:12371,42164:12372,42165:12373,42166:12374,42167:12375,42168:12376,42169:12377,42170:12378,42171:12379,42172:12380,42173:12381,42174:12382,42175:12383,42176:12384,42177:12385,42178:12386,42179:12387,42180:12388,42181:12389,42182:12390,42183:12391,42184:12392,42185:12393,42186:12394,42187:12395,42188:12396,42189:12397,42190:12398,42191:12399,42192:12400,42193:12401,42194:12402,42195:12403,42196:12404,42197:12405,42198:12406,42199:12407,42200:12408,42201:12409,42202:12410,42203:12411,42204:12412,42205:12413,42206:12414,42207:12415,42208:12416,42209:12417,42210:12418,42211:12419,42212:12420,42213:12421,42214:12422,42215:12423,42216:12424,42217:12425,42218:12426,42219:12427,42220:12428,42221:12429,42222:12430,42223:12431,42224:12432,42225:12433,42226:12434,42227:12435,42228:59250,42229:59251,42230:59252,42231:59253,42232:59254,42233:59255,42234:59256,42235:59257,42236:59258,42237:59259,42238:59260,42304:58950,42305:58951,42306:58952,42307:58953,42308:58954,42309:58955,42310:58956,42311:58957,42312:58958,42313:58959,42314:58960,42315:58961,42316:58962,42317:58963,42318:58964,42319:58965,42320:58966,42321:58967,42322:58968,42323:58969,42324:58970,42325:58971,42326:58972,42327:58973,42328:58974,42329:58975,42330:58976,42331:58977,42332:58978,42333:58979,42334:58980,42335:58981,42336:58982,42337:58983,42338:58984,42339:58985,42340:58986,42341:58987,42342:58988,42343:58989,42344:58990,42345:58991,42346:58992,42347:58993,42348:58994,42349:58995,42350:58996,42351:58997,42352:58998,42353:58999,42354:59e3,42355:59001,42356:59002,42357:59003,42358:59004,42359:59005,42360:59006,42361:59007,42362:59008,42363:59009,42364:59010,42365:59011,42366:59012,42368:59013,42369:59014,42370:59015,42371:59016,42372:59017,42373:59018,42374:59019,42375:59020,42376:59021,42377:59022,42378:59023,42379:59024,42380:59025,42381:59026,42382:59027,42383:59028,42384:59029,42385:59030,42386:59031,42387:59032,42388:59033,42389:59034,42390:59035,42391:59036,42392:59037,42393:59038,42394:59039,42395:59040,42396:59041,42397:59042,42398:59043,42399:59044,42400:59045,42401:12449,42402:12450,42403:12451,42404:12452,42405:12453,42406:12454,42407:12455,42408:12456,42409:12457,42410:12458,42411:12459,42412:12460,42413:12461,42414:12462,42415:12463,42416:12464,42417:12465,42418:12466,42419:12467,42420:12468,42421:12469,42422:12470,42423:12471,42424:12472,42425:12473,42426:12474,42427:12475,42428:12476,42429:12477,42430:12478,42431:12479,42432:12480,42433:12481,42434:12482,42435:12483,42436:12484,42437:12485,42438:12486,42439:12487,42440:12488,42441:12489,42442:12490,42443:12491,42444:12492,42445:12493,42446:12494,42447:12495,42448:12496,42449:12497,42450:12498,42451:12499,42452:12500,42453:12501,42454:12502,42455:12503,42456:12504,42457:12505,42458:12506,42459:12507,42460:12508,42461:12509,42462:12510,42463:12511,42464:12512,42465:12513,42466:12514,42467:12515,42468:12516,42469:12517,42470:12518,42471:12519,42472:12520,42473:12521,42474:12522,42475:12523,42476:12524,42477:12525,42478:12526,42479:12527,42480:12528,42481:12529,42482:12530,42483:12531,42484:12532,42485:12533,42486:12534,42487:59261,42488:59262,42489:59263,42490:59264,42491:59265,42492:59266,42493:59267,42494:59268,42560:59046,42561:59047,42562:59048,42563:59049,42564:59050,42565:59051,42566:59052,42567:59053,42568:59054,42569:59055,42570:59056,42571:59057,42572:59058,42573:59059,42574:59060,42575:59061,42576:59062,42577:59063,42578:59064,42579:59065,42580:59066,42581:59067,42582:59068,42583:59069,42584:59070,42585:59071,42586:59072,42587:59073,42588:59074,42589:59075,42590:59076,42591:59077,42592:59078,42593:59079,42594:59080,42595:59081,42596:59082,42597:59083,42598:59084,42599:59085,42600:59086,42601:59087,42602:59088,42603:59089,42604:59090,42605:59091,42606:59092,42607:59093,42608:59094,42609:59095,42610:59096,42611:59097,42612:59098,42613:59099,42614:59100,42615:59101,42616:59102,42617:59103,42618:59104,42619:59105,42620:59106,42621:59107,42622:59108,42624:59109,42625:59110,42626:59111,42627:59112,42628:59113,42629:59114,42630:59115,42631:59116,42632:59117,42633:59118,42634:59119,42635:59120,42636:59121,42637:59122,42638:59123,42639:59124,42640:59125,42641:59126,42642:59127,42643:59128,42644:59129,42645:59130,42646:59131,42647:59132,42648:59133,42649:59134,42650:59135,42651:59136,42652:59137,42653:59138,42654:59139,42655:59140,42656:59141,42657:913,42658:914,42659:915,42660:916,42661:917,42662:918,42663:919,42664:920,42665:921,42666:922,42667:923,42668:924,42669:925,42670:926,42671:927,42672:928,42673:929,42674:931,42675:932,42676:933,42677:934,42678:935,42679:936,42680:937,42681:59269,42682:59270,42683:59271,42684:59272,42685:59273,42686:59274,42687:59275,42688:59276,42689:945,42690:946,42691:947,42692:948,42693:949,42694:950,42695:951,42696:952,42697:953,42698:954,42699:955,42700:956,42701:957,42702:958,42703:959,42704:960,42705:961,42706:963,42707:964,42708:965,42709:966,42710:967,42711:968,42712:969,42713:59277,42714:59278,42715:59279,42716:59280,42717:59281,42718:59282,42719:59283,42720:65077,42721:65078,42722:65081,42723:65082,42724:65087,42725:65088,42726:65085,42727:65086,42728:65089,42729:65090,42730:65091,42731:65092,42732:59284,42733:59285,42734:65083,42735:65084,42736:65079,42737:65080,42738:65073,42739:59286,42740:65075,42741:65076,42742:59287,42743:59288,42744:59289,42745:59290,42746:59291,42747:59292,42748:59293,42749:59294,42750:59295,42816:59142,42817:59143,42818:59144,42819:59145,42820:59146,42821:59147,42822:59148,42823:59149,42824:59150,42825:59151,42826:59152,42827:59153,42828:59154,42829:59155,42830:59156,42831:59157,42832:59158,42833:59159,42834:59160,42835:59161,42836:59162,42837:59163,42838:59164,42839:59165,42840:59166,42841:59167,42842:59168,42843:59169,42844:59170,42845:59171,42846:59172,42847:59173,42848:59174,42849:59175,42850:59176,42851:59177,42852:59178,42853:59179,42854:59180,42855:59181,42856:59182,42857:59183,42858:59184,42859:59185,42860:59186,42861:59187,42862:59188,42863:59189,42864:59190,42865:59191,42866:59192,42867:59193,42868:59194,42869:59195,42870:59196,42871:59197,42872:59198,42873:59199,42874:59200,42875:59201,42876:59202,42877:59203,42878:59204,42880:59205,42881:59206,42882:59207,42883:59208,42884:59209,42885:59210,42886:59211,42887:59212,42888:59213,42889:59214,42890:59215,42891:59216,42892:59217,42893:59218,42894:59219,42895:59220,42896:59221,42897:59222,42898:59223,42899:59224,42900:59225,42901:59226,42902:59227,42903:59228,42904:59229,42905:59230,42906:59231,42907:59232,42908:59233,42909:59234,42910:59235,42911:59236,42912:59237,42913:1040,42914:1041,42915:1042,42916:1043,42917:1044,42918:1045,42919:1025,42920:1046,42921:1047,42922:1048,42923:1049,42924:1050,42925:1051,42926:1052,42927:1053,42928:1054,42929:1055,42930:1056,42931:1057,42932:1058,42933:1059,42934:1060,42935:1061,42936:1062,42937:1063,42938:1064,42939:1065,42940:1066,42941:1067,42942:1068,42943:1069,42944:1070,42945:1071,42946:59296,42947:59297,42948:59298,42949:59299,42950:59300,42951:59301,42952:59302,42953:59303,42954:59304,42955:59305,42956:59306,42957:59307,42958:59308,42959:59309,42960:59310,42961:1072,42962:1073,42963:1074,42964:1075,42965:1076,42966:1077,42967:1105,42968:1078,42969:1079,42970:1080,42971:1081,42972:1082,42973:1083,42974:1084,42975:1085,42976:1086,42977:1087,42978:1088,42979:1089,42980:1090,42981:1091,42982:1092,42983:1093,42984:1094,42985:1095,42986:1096,42987:1097,42988:1098,42989:1099,42990:1100,42991:1101,42992:1102,42993:1103,42994:59311,42995:59312,42996:59313,42997:59314,42998:59315,42999:59316,43e3:59317,43001:59318,43002:59319,43003:59320,43004:59321,43005:59322,43006:59323,43072:714,43073:715,43074:729,43075:8211,43076:8213,43077:8229,43078:8245,43079:8453,43080:8457,43081:8598,43082:8599,43083:8600,43084:8601,43085:8725,43086:8735,43087:8739,43088:8786,43089:8806,43090:8807,43091:8895,43092:9552,43093:9553,43094:9554,43095:9555,43096:9556,43097:9557,43098:9558,43099:9559,43100:9560,43101:9561,43102:9562,43103:9563,43104:9564,43105:9565,43106:9566,43107:9567,43108:9568,43109:9569,43110:9570,43111:9571,43112:9572,43113:9573,43114:9574,43115:9575,43116:9576,43117:9577,43118:9578,43119:9579,43120:9580,43121:9581,43122:9582,43123:9583,43124:9584,43125:9585,43126:9586,43127:9587,43128:9601,43129:9602,43130:9603,43131:9604,43132:9605,43133:9606,43134:9607,43136:9608,43137:9609,43138:9610,43139:9611,43140:9612,43141:9613,43142:9614,43143:9615,43144:9619,43145:9620,43146:9621,43147:9660,43148:9661,43149:9698,43150:9699,43151:9700,43152:9701,43153:9737,43154:8853,43155:12306,43156:12317,43157:12318,43158:59324,43159:59325,43160:59326,43161:59327,43162:59328,43163:59329,43164:59330,43165:59331,43166:59332,43167:59333,43168:59334,43169:257,43170:225,43171:462,43172:224,43173:275,43174:233,43175:283,43176:232,43177:299,43178:237,43179:464,43180:236,43181:333,43182:243,43183:466,43184:242,43185:363,43186:250,43187:468,43188:249,43189:470,43190:472,43191:474,43192:476,43193:252,43194:234,43195:593,43196:59335,43197:324,43198:328,43199:505,43200:609,43201:59337,43202:59338,43203:59339,43204:59340,43205:12549,43206:12550,43207:12551,43208:12552,43209:12553,43210:12554,43211:12555,43212:12556,43213:12557,43214:12558,43215:12559,43216:12560,43217:12561,43218:12562,43219:12563,43220:12564,43221:12565,43222:12566,43223:12567,43224:12568,43225:12569,43226:12570,43227:12571,43228:12572,43229:12573,43230:12574,43231:12575,43232:12576,43233:12577,43234:12578,43235:12579,43236:12580,43237:12581,43238:12582,43239:12583,43240:12584,43241:12585,43242:59341,43243:59342,43244:59343,43245:59344,43246:59345,43247:59346,43248:59347,43249:59348,43250:59349,43251:59350,43252:59351,43253:59352,43254:59353,43255:59354,43256:59355,43257:59356,43258:59357,43259:59358,43260:59359,43261:59360,43262:59361,43328:12321,43329:12322,43330:12323,43331:12324,43332:12325,43333:12326,43334:12327,43335:12328,43336:12329,43337:12963,43338:13198,43339:13199,43340:13212,43341:13213,43342:13214,43343:13217,43344:13252,43345:13262,43346:13265,43347:13266,43348:13269,43349:65072,43350:65506,43351:65508,43352:59362,43353:8481,43354:12849,43355:59363,43356:8208,43357:59364,43358:59365,43359:59366,43360:12540,43361:12443,43362:12444,43363:12541,43364:12542,43365:12294,43366:12445,43367:12446,43368:65097,43369:65098,43370:65099,43371:65100,43372:65101,43373:65102,43374:65103,43375:65104,43376:65105,43377:65106,43378:65108,43379:65109,43380:65110,43381:65111,43382:65113,43383:65114,43384:65115,43385:65116,43386:65117,43387:65118,43388:65119,43389:65120,43390:65121,43392:65122,43393:65123,43394:65124,43395:65125,43396:65126,43397:65128,43398:65129,43399:65130,43400:65131,43401:12350,43402:12272,43403:12273,43404:12274,43405:12275,43406:12276,43407:12277,43408:12278,43409:12279,43410:12280,43411:12281,43412:12282,43413:12283,43414:12295,43415:59380,43416:59381,43417:59382,43418:59383,43419:59384,43420:59385,43421:59386,43422:59387,43423:59388,43424:59389,43425:59390,43426:59391,43427:59392,43428:9472,43429:9473,43430:9474,43431:9475,43432:9476,43433:9477,43434:9478,43435:9479,43436:9480,43437:9481,43438:9482,43439:9483,43440:9484,43441:9485,43442:9486,43443:9487,43444:9488,43445:9489,43446:9490,43447:9491,43448:9492,43449:9493,43450:9494,43451:9495,43452:9496,43453:9497,43454:9498,43455:9499,43456:9500,43457:9501,43458:9502,43459:9503,43460:9504,43461:9505,43462:9506,43463:9507,43464:9508,43465:9509,43466:9510,43467:9511,43468:9512,43469:9513,43470:9514,43471:9515,43472:9516,43473:9517,43474:9518,43475:9519,43476:9520,43477:9521,43478:9522,43479:9523,43480:9524,43481:9525,43482:9526,43483:9527,43484:9528,43485:9529,43486:9530,43487:9531,43488:9532,43489:9533,43490:9534,43491:9535,43492:9536,43493:9537,43494:9538,43495:9539,43496:9540,43497:9541,43498:9542,43499:9543,43500:9544,43501:9545,43502:9546,43503:9547,43504:59393,43505:59394,43506:59395,43507:59396,43508:59397,43509:59398,43510:59399,43511:59400,43512:59401,43513:59402,43514:59403,43515:59404,43516:59405,43517:59406,43518:59407,43584:29404,43585:29405,43586:29407,43587:29410,43588:29411,43589:29412,43590:29413,43591:29414,43592:29415,43593:29418,43594:29419,43595:29429,43596:29430,43597:29433,43598:29437,43599:29438,43600:29439,43601:29440,43602:29442,43603:29444,43604:29445,43605:29446,43606:29447,43607:29448,43608:29449,43609:29451,43610:29452,43611:29453,43612:29455,43613:29456,43614:29457,43615:29458,43616:29460,43617:29464,43618:29465,43619:29466,43620:29471,43621:29472,43622:29475,43623:29476,43624:29478,43625:29479,43626:29480,43627:29485,43628:29487,43629:29488,43630:29490,43631:29491,43632:29493,43633:29494,43634:29498,43635:29499,43636:29500,43637:29501,43638:29504,43639:29505,43640:29506,43641:29507,43642:29508,43643:29509,43644:29510,43645:29511,43646:29512,43648:29513,43649:29514,43650:29515,43651:29516,43652:29518,43653:29519,43654:29521,43655:29523,43656:29524,43657:29525,43658:29526,43659:29528,43660:29529,43661:29530,43662:29531,43663:29532,43664:29533,43665:29534,43666:29535,43667:29537,43668:29538,43669:29539,43670:29540,43671:29541,43672:29542,43673:29543,43674:29544,43675:29545,43676:29546,43677:29547,43678:29550,43679:29552,43680:29553,43681:57344,43682:57345,43683:57346,43684:57347,43685:57348,43686:57349,43687:57350,43688:57351,43689:57352,43690:57353,43691:57354,43692:57355,43693:57356,43694:57357,43695:57358,43696:57359,43697:57360,43698:57361,43699:57362,43700:57363,43701:57364,43702:57365,43703:57366,43704:57367,43705:57368,43706:57369,43707:57370,43708:57371,43709:57372,43710:57373,43711:57374,43712:57375,43713:57376,43714:57377,43715:57378,43716:57379,43717:57380,43718:57381,43719:57382,43720:57383,43721:57384,43722:57385,43723:57386,43724:57387,43725:57388,43726:57389,43727:57390,43728:57391,43729:57392,43730:57393,43731:57394,43732:57395,43733:57396,43734:57397,43735:57398,43736:57399,43737:57400,43738:57401,43739:57402,43740:57403,43741:57404,43742:57405,43743:57406,43744:57407,43745:57408,43746:57409,43747:57410,43748:57411,43749:57412,43750:57413,43751:57414,43752:57415,43753:57416,43754:57417,43755:57418,43756:57419,43757:57420,43758:57421,43759:57422,43760:57423,43761:57424,43762:57425,43763:57426,43764:57427,43765:57428,43766:57429,43767:57430,43768:57431,43769:57432,43770:57433,43771:57434,43772:57435,43773:57436,43774:57437,43840:29554,43841:29555,43842:29556,43843:29557,43844:29558,43845:29559,43846:29560,43847:29561,43848:29562,43849:29563,43850:29564,43851:29565,43852:29567,43853:29568,43854:29569,43855:29570,43856:29571,43857:29573,43858:29574,43859:29576,43860:29578,43861:29580,43862:29581,43863:29583,43864:29584,43865:29586,43866:29587,43867:29588,43868:29589,43869:29591,43870:29592,43871:29593,43872:29594,43873:29596,43874:29597,43875:29598,43876:29600,43877:29601,43878:29603,43879:29604,43880:29605,43881:29606,43882:29607,43883:29608,43884:29610,43885:29612,43886:29613,43887:29617,43888:29620,43889:29621,43890:29622,43891:29624,43892:29625,43893:29628,43894:29629,43895:29630,43896:29631,43897:29633,43898:29635,43899:29636,43900:29637,43901:29638,43902:29639,43904:29643,43905:29644,43906:29646,43907:29650,43908:29651,43909:29652,43910:29653,43911:29654,43912:29655,43913:29656,43914:29658,43915:29659,43916:29660,43917:29661,43918:29663,43919:29665,43920:29666,43921:29667,43922:29668,43923:29670,43924:29672,43925:29674,43926:29675,43927:29676,43928:29678,43929:29679,43930:29680,43931:29681,43932:29683,43933:29684,43934:29685,43935:29686,43936:29687,43937:57438,43938:57439,43939:57440,43940:57441,43941:57442,43942:57443,43943:57444,43944:57445,43945:57446,43946:57447,43947:57448,43948:57449,43949:57450,43950:57451,43951:57452,43952:57453,43953:57454,43954:57455,43955:57456,43956:57457,43957:57458,43958:57459,43959:57460,43960:57461,43961:57462,43962:57463,43963:57464,43964:57465,43965:57466,43966:57467,43967:57468,43968:57469,43969:57470,43970:57471,43971:57472,43972:57473,43973:57474,43974:57475,43975:57476,43976:57477,43977:57478,43978:57479,43979:57480,43980:57481,43981:57482,43982:57483,43983:57484,43984:57485,43985:57486,43986:57487,43987:57488,43988:57489,43989:57490,43990:57491,43991:57492,43992:57493,43993:57494,43994:57495,43995:57496,43996:57497,43997:57498,43998:57499,43999:57500,44e3:57501,44001:57502,44002:57503,44003:57504,44004:57505,44005:57506,44006:57507,44007:57508,44008:57509,44009:57510,44010:57511,44011:57512,44012:57513,44013:57514,44014:57515,44015:57516,44016:57517,44017:57518,44018:57519,44019:57520,44020:57521,44021:57522,44022:57523,44023:57524,44024:57525,44025:57526,44026:57527,44027:57528,44028:57529,44029:57530,44030:57531,44096:29688,44097:29689,44098:29690,44099:29691,44100:29692,44101:29693,44102:29694,44103:29695,44104:29696,44105:29697,44106:29698,44107:29700,44108:29703,44109:29704,44110:29707,44111:29708,44112:29709,44113:29710,44114:29713,44115:29714,44116:29715,44117:29716,44118:29717,44119:29718,44120:29719,44121:29720,44122:29721,44123:29724,44124:29725,44125:29726,44126:29727,44127:29728,44128:29729,44129:29731,44130:29732,44131:29735,44132:29737,44133:29739,44134:29741,44135:29743,44136:29745,44137:29746,44138:29751,44139:29752,44140:29753,44141:29754,44142:29755,44143:29757,44144:29758,44145:29759,44146:29760,44147:29762,44148:29763,44149:29764,44150:29765,44151:29766,44152:29767,44153:29768,44154:29769,44155:29770,44156:29771,44157:29772,44158:29773,44160:29774,44161:29775,44162:29776,44163:29777,44164:29778,44165:29779,44166:29780,44167:29782,44168:29784,44169:29789,44170:29792,44171:29793,44172:29794,44173:29795,44174:29796,44175:29797,44176:29798,44177:29799,44178:29800,44179:29801,44180:29802,44181:29803,44182:29804,44183:29806,44184:29807,44185:29809,44186:29810,44187:29811,44188:29812,44189:29813,44190:29816,44191:29817,44192:29818,44193:57532,44194:57533,44195:57534,44196:57535,44197:57536,44198:57537,44199:57538,44200:57539,44201:57540,44202:57541,44203:57542,44204:57543,44205:57544,44206:57545,44207:57546,44208:57547,44209:57548,44210:57549,44211:57550,44212:57551,44213:57552,44214:57553,44215:57554,44216:57555,44217:57556,44218:57557,44219:57558,44220:57559,44221:57560,44222:57561,44223:57562,44224:57563,44225:57564,44226:57565,44227:57566,44228:57567,44229:57568,44230:57569,44231:57570,44232:57571,44233:57572,44234:57573,44235:57574,44236:57575,44237:57576,44238:57577,44239:57578,44240:57579,44241:57580,44242:57581,44243:57582,44244:57583,44245:57584,44246:57585,44247:57586,44248:57587,44249:57588,44250:57589,44251:57590,44252:57591,44253:57592,44254:57593,44255:57594,44256:57595,44257:57596,44258:57597,44259:57598,44260:57599,44261:57600,44262:57601,44263:57602,44264:57603,44265:57604,44266:57605,44267:57606,44268:57607,44269:57608,44270:57609,44271:57610,44272:57611,44273:57612,44274:57613,44275:57614,44276:57615,44277:57616,44278:57617,44279:57618,44280:57619,44281:57620,44282:57621,44283:57622,44284:57623,44285:57624,44286:57625,44352:29819,44353:29820,44354:29821,44355:29823,44356:29826,44357:29828,44358:29829,44359:29830,44360:29832,44361:29833,44362:29834,44363:29836,44364:29837,44365:29839,44366:29841,44367:29842,44368:29843,44369:29844,44370:29845,44371:29846,44372:29847,44373:29848,44374:29849,44375:29850,44376:29851,44377:29853,44378:29855,44379:29856,44380:29857,44381:29858,44382:29859,44383:29860,44384:29861,44385:29862,44386:29866,44387:29867,44388:29868,44389:29869,44390:29870,44391:29871,44392:29872,44393:29873,44394:29874,44395:29875,44396:29876,44397:29877,44398:29878,44399:29879,44400:29880,44401:29881,44402:29883,44403:29884,44404:29885,44405:29886,44406:29887,44407:29888,44408:29889,44409:29890,44410:29891,44411:29892,44412:29893,44413:29894,44414:29895,44416:29896,44417:29897,44418:29898,44419:29899,44420:29900,44421:29901,44422:29902,44423:29903,44424:29904,44425:29905,44426:29907,44427:29908,44428:29909,44429:29910,44430:29911,44431:29912,44432:29913,44433:29914,44434:29915,44435:29917,44436:29919,44437:29921,44438:29925,44439:29927,44440:29928,44441:29929,44442:29930,44443:29931,44444:29932,44445:29933,44446:29936,44447:29937,44448:29938,44449:57626,44450:57627,44451:57628,44452:57629,44453:57630,44454:57631,44455:57632,44456:57633,44457:57634,44458:57635,44459:57636,44460:57637,44461:57638,44462:57639,44463:57640,44464:57641,44465:57642,44466:57643,44467:57644,44468:57645,44469:57646,44470:57647,44471:57648,44472:57649,44473:57650,44474:57651,44475:57652,44476:57653,44477:57654,44478:57655,44479:57656,44480:57657,44481:57658,44482:57659,44483:57660,44484:57661,44485:57662,44486:57663,44487:57664,44488:57665,44489:57666,44490:57667,44491:57668,44492:57669,44493:57670,44494:57671,44495:57672,44496:57673,44497:57674,44498:57675,44499:57676,44500:57677,44501:57678,44502:57679,44503:57680,44504:57681,44505:57682,44506:57683,44507:57684,44508:57685,44509:57686,44510:57687,44511:57688,44512:57689,44513:57690,44514:57691,44515:57692,44516:57693,44517:57694,44518:57695,44519:57696,44520:57697,44521:57698,44522:57699,44523:57700,44524:57701,44525:57702,44526:57703,44527:57704,44528:57705,44529:57706,44530:57707,44531:57708,44532:57709,44533:57710,44534:57711,44535:57712,44536:57713,44537:57714,44538:57715,44539:57716,44540:57717,44541:57718,44542:57719,44608:29939,44609:29941,44610:29944,44611:29945,44612:29946,44613:29947,44614:29948,44615:29949,44616:29950,44617:29952,44618:29953,44619:29954,44620:29955,44621:29957,44622:29958,44623:29959,44624:29960,44625:29961,44626:29962,44627:29963,44628:29964,44629:29966,44630:29968,44631:29970,44632:29972,44633:29973,44634:29974,44635:29975,44636:29979,44637:29981,44638:29982,44639:29984,44640:29985,44641:29986,44642:29987,44643:29988,44644:29990,44645:29991,44646:29994,44647:29998,44648:30004,44649:30006,44650:30009,44651:30012,44652:30013,44653:30015,44654:30017,44655:30018,44656:30019,44657:30020,44658:30022,44659:30023,44660:30025,44661:30026,44662:30029,44663:30032,44664:30033,44665:30034,44666:30035,44667:30037,44668:30038,44669:30039,44670:30040,44672:30045,44673:30046,44674:30047,44675:30048,44676:30049,44677:30050,44678:30051,44679:30052,44680:30055,44681:30056,44682:30057,44683:30059,44684:30060,44685:30061,44686:30062,44687:30063,44688:30064,44689:30065,44690:30067,44691:30069,44692:30070,44693:30071,44694:30074,44695:30075,44696:30076,44697:30077,44698:30078,44699:30080,44700:30081,44701:30082,44702:30084,44703:30085,44704:30087,44705:57720,44706:57721,44707:57722,44708:57723,44709:57724,44710:57725,44711:57726,44712:57727,44713:57728,44714:57729,44715:57730,44716:57731,44717:57732,44718:57733,44719:57734,44720:57735,44721:57736,44722:57737,44723:57738,44724:57739,44725:57740,44726:57741,44727:57742,44728:57743,44729:57744,44730:57745,44731:57746,44732:57747,44733:57748,44734:57749,44735:57750,44736:57751,44737:57752,44738:57753,44739:57754,44740:57755,44741:57756,44742:57757,44743:57758,44744:57759,44745:57760,44746:57761,44747:57762,44748:57763,44749:57764,44750:57765,44751:57766,44752:57767,44753:57768,44754:57769,44755:57770,44756:57771,44757:57772,44758:57773,44759:57774,44760:57775,44761:57776,44762:57777,44763:57778,44764:57779,44765:57780,44766:57781,44767:57782,44768:57783,44769:57784,44770:57785,44771:57786,44772:57787,44773:57788,44774:57789,44775:57790,44776:57791,44777:57792,44778:57793,44779:57794,44780:57795,44781:57796,44782:57797,44783:57798,44784:57799,44785:57800,44786:57801,44787:57802,44788:57803,44789:57804,44790:57805,44791:57806,44792:57807,44793:57808,44794:57809,44795:57810,44796:57811,44797:57812,44798:57813,44864:30088,44865:30089,44866:30090,44867:30092,44868:30093,44869:30094,44870:30096,44871:30099,44872:30101,44873:30104,44874:30107,44875:30108,44876:30110,44877:30114,44878:30118,44879:30119,44880:30120,44881:30121,44882:30122,44883:30125,44884:30134,44885:30135,44886:30138,44887:30139,44888:30143,44889:30144,44890:30145,44891:30150,44892:30155,44893:30156,44894:30158,44895:30159,44896:30160,44897:30161,44898:30163,44899:30167,44900:30169,44901:30170,44902:30172,44903:30173,44904:30175,44905:30176,44906:30177,44907:30181,44908:30185,44909:30188,44910:30189,44911:30190,44912:30191,44913:30194,44914:30195,44915:30197,44916:30198,44917:30199,44918:30200,44919:30202,44920:30203,44921:30205,44922:30206,44923:30210,44924:30212,44925:30214,44926:30215,44928:30216,44929:30217,44930:30219,44931:30221,44932:30222,44933:30223,44934:30225,44935:30226,44936:30227,44937:30228,44938:30230,44939:30234,44940:30236,44941:30237,44942:30238,44943:30241,44944:30243,44945:30247,44946:30248,44947:30252,44948:30254,44949:30255,44950:30257,44951:30258,44952:30262,44953:30263,44954:30265,44955:30266,44956:30267,44957:30269,44958:30273,44959:30274,44960:30276,44961:57814,44962:57815,44963:57816,44964:57817,44965:57818,44966:57819,44967:57820,44968:57821,44969:57822,44970:57823,44971:57824,44972:57825,44973:57826,44974:57827,44975:57828,44976:57829,44977:57830,44978:57831,44979:57832,44980:57833,44981:57834,44982:57835,44983:57836,44984:57837,44985:57838,44986:57839,44987:57840,44988:57841,44989:57842,44990:57843,44991:57844,44992:57845,44993:57846,44994:57847,44995:57848,44996:57849,44997:57850,44998:57851,44999:57852,45e3:57853,45001:57854,45002:57855,45003:57856,45004:57857,45005:57858,45006:57859,45007:57860,45008:57861,45009:57862,45010:57863,45011:57864,45012:57865,45013:57866,45014:57867,45015:57868,45016:57869,45017:57870,45018:57871,45019:57872,45020:57873,45021:57874,45022:57875,45023:57876,45024:57877,45025:57878,45026:57879,45027:57880,45028:57881,45029:57882,45030:57883,45031:57884,45032:57885,45033:57886,45034:57887,45035:57888,45036:57889,45037:57890,45038:57891,45039:57892,45040:57893,45041:57894,45042:57895,45043:57896,45044:57897,45045:57898,45046:57899,45047:57900,45048:57901,45049:57902,45050:57903,45051:57904,45052:57905,45053:57906,45054:57907,45120:30277,45121:30278,45122:30279,45123:30280,45124:30281,45125:30282,45126:30283,45127:30286,45128:30287,45129:30288,45130:30289,45131:30290,45132:30291,45133:30293,45134:30295,45135:30296,45136:30297,45137:30298,45138:30299,45139:30301,45140:30303,45141:30304,45142:30305,45143:30306,45144:30308,45145:30309,45146:30310,45147:30311,45148:30312,45149:30313,45150:30314,45151:30316,45152:30317,45153:30318,45154:30320,45155:30321,45156:30322,45157:30323,45158:30324,45159:30325,45160:30326,45161:30327,45162:30329,45163:30330,45164:30332,45165:30335,45166:30336,45167:30337,45168:30339,45169:30341,45170:30345,45171:30346,45172:30348,45173:30349,45174:30351,45175:30352,45176:30354,45177:30356,45178:30357,45179:30359,45180:30360,45181:30362,45182:30363,45184:30364,45185:30365,45186:30366,45187:30367,45188:30368,45189:30369,45190:30370,45191:30371,45192:30373,45193:30374,45194:30375,45195:30376,45196:30377,45197:30378,45198:30379,45199:30380,45200:30381,45201:30383,45202:30384,45203:30387,45204:30389,45205:30390,45206:30391,45207:30392,45208:30393,45209:30394,45210:30395,45211:30396,45212:30397,45213:30398,45214:30400,45215:30401,45216:30403,45217:21834,45218:38463,45219:22467,45220:25384,45221:21710,45222:21769,45223:21696,45224:30353,45225:30284,45226:34108,45227:30702,45228:33406,45229:30861,45230:29233,45231:38552,45232:38797,45233:27688,45234:23433,45235:20474,45236:25353,45237:26263,45238:23736,45239:33018,45240:26696,45241:32942,45242:26114,45243:30414,45244:20985,45245:25942,45246:29100,45247:32753,45248:34948,45249:20658,45250:22885,45251:25034,45252:28595,45253:33453,45254:25420,45255:25170,45256:21485,45257:21543,45258:31494,45259:20843,45260:30116,45261:24052,45262:25300,45263:36299,45264:38774,45265:25226,45266:32793,45267:22365,45268:38712,45269:32610,45270:29240,45271:30333,45272:26575,45273:30334,45274:25670,45275:20336,45276:36133,45277:25308,45278:31255,45279:26001,45280:29677,45281:25644,45282:25203,45283:33324,45284:39041,45285:26495,45286:29256,45287:25198,45288:25292,45289:20276,45290:29923,45291:21322,45292:21150,45293:32458,45294:37030,45295:24110,45296:26758,45297:27036,45298:33152,45299:32465,45300:26834,45301:30917,45302:34444,45303:38225,45304:20621,45305:35876,45306:33502,45307:32990,45308:21253,45309:35090,45310:21093,45376:30404,45377:30407,45378:30409,45379:30411,45380:30412,45381:30419,45382:30421,45383:30425,45384:30426,45385:30428,45386:30429,45387:30430,45388:30432,45389:30433,45390:30434,45391:30435,45392:30436,45393:30438,45394:30439,45395:30440,45396:30441,45397:30442,45398:30443,45399:30444,45400:30445,45401:30448,45402:30451,45403:30453,45404:30454,45405:30455,45406:30458,45407:30459,45408:30461,45409:30463,45410:30464,45411:30466,45412:30467,45413:30469,45414:30470,45415:30474,45416:30476,45417:30478,45418:30479,45419:30480,45420:30481,45421:30482,45422:30483,45423:30484,45424:30485,45425:30486,45426:30487,45427:30488,45428:30491,45429:30492,45430:30493,45431:30494,45432:30497,45433:30499,45434:30500,45435:30501,45436:30503,45437:30506,45438:30507,45440:30508,45441:30510,45442:30512,45443:30513,45444:30514,45445:30515,45446:30516,45447:30521,45448:30523,45449:30525,45450:30526,45451:30527,45452:30530,45453:30532,45454:30533,45455:30534,45456:30536,45457:30537,45458:30538,45459:30539,45460:30540,45461:30541,45462:30542,45463:30543,45464:30546,45465:30547,45466:30548,45467:30549,45468:30550,45469:30551,45470:30552,45471:30553,45472:30556,45473:34180,45474:38649,45475:20445,45476:22561,45477:39281,45478:23453,45479:25265,45480:25253,45481:26292,45482:35961,45483:40077,45484:29190,45485:26479,45486:30865,45487:24754,45488:21329,45489:21271,45490:36744,45491:32972,45492:36125,45493:38049,45494:20493,45495:29384,45496:22791,45497:24811,45498:28953,45499:34987,45500:22868,45501:33519,45502:26412,45503:31528,45504:23849,45505:32503,45506:29997,45507:27893,45508:36454,45509:36856,45510:36924,45511:40763,45512:27604,45513:37145,45514:31508,45515:24444,45516:30887,45517:34006,45518:34109,45519:27605,45520:27609,45521:27606,45522:24065,45523:24199,45524:30201,45525:38381,45526:25949,45527:24330,45528:24517,45529:36767,45530:22721,45531:33218,45532:36991,45533:38491,45534:38829,45535:36793,45536:32534,45537:36140,45538:25153,45539:20415,45540:21464,45541:21342,45542:36776,45543:36777,45544:36779,45545:36941,45546:26631,45547:24426,45548:33176,45549:34920,45550:40150,45551:24971,45552:21035,45553:30250,45554:24428,45555:25996,45556:28626,45557:28392,45558:23486,45559:25672,45560:20853,45561:20912,45562:26564,45563:19993,45564:31177,45565:39292,45566:28851,45632:30557,45633:30558,45634:30559,45635:30560,45636:30564,45637:30567,45638:30569,45639:30570,45640:30573,45641:30574,45642:30575,45643:30576,45644:30577,45645:30578,45646:30579,45647:30580,45648:30581,45649:30582,45650:30583,45651:30584,45652:30586,45653:30587,45654:30588,45655:30593,45656:30594,45657:30595,45658:30598,45659:30599,45660:30600,45661:30601,45662:30602,45663:30603,45664:30607,45665:30608,45666:30611,45667:30612,45668:30613,45669:30614,45670:30615,45671:30616,45672:30617,45673:30618,45674:30619,45675:30620,45676:30621,45677:30622,45678:30625,45679:30627,45680:30628,45681:30630,45682:30632,45683:30635,45684:30637,45685:30638,45686:30639,45687:30641,45688:30642,45689:30644,45690:30646,45691:30647,45692:30648,45693:30649,45694:30650,45696:30652,45697:30654,45698:30656,45699:30657,45700:30658,45701:30659,45702:30660,45703:30661,45704:30662,45705:30663,45706:30664,45707:30665,45708:30666,45709:30667,45710:30668,45711:30670,45712:30671,45713:30672,45714:30673,45715:30674,45716:30675,45717:30676,45718:30677,45719:30678,45720:30680,45721:30681,45722:30682,45723:30685,45724:30686,45725:30687,45726:30688,45727:30689,45728:30692,45729:30149,45730:24182,45731:29627,45732:33760,45733:25773,45734:25320,45735:38069,45736:27874,45737:21338,45738:21187,45739:25615,45740:38082,45741:31636,45742:20271,45743:24091,45744:33334,45745:33046,45746:33162,45747:28196,45748:27850,45749:39539,45750:25429,45751:21340,45752:21754,45753:34917,45754:22496,45755:19981,45756:24067,45757:27493,45758:31807,45759:37096,45760:24598,45761:25830,45762:29468,45763:35009,45764:26448,45765:25165,45766:36130,45767:30572,45768:36393,45769:37319,45770:24425,45771:33756,45772:34081,45773:39184,45774:21442,45775:34453,45776:27531,45777:24813,45778:24808,45779:28799,45780:33485,45781:33329,45782:20179,45783:27815,45784:34255,45785:25805,45786:31961,45787:27133,45788:26361,45789:33609,45790:21397,45791:31574,45792:20391,45793:20876,45794:27979,45795:23618,45796:36461,45797:25554,45798:21449,45799:33580,45800:33590,45801:26597,45802:30900,45803:25661,45804:23519,45805:23700,45806:24046,45807:35815,45808:25286,45809:26612,45810:35962,45811:25600,45812:25530,45813:34633,45814:39307,45815:35863,45816:32544,45817:38130,45818:20135,45819:38416,45820:39076,45821:26124,45822:29462,45888:30694,45889:30696,45890:30698,45891:30703,45892:30704,45893:30705,45894:30706,45895:30708,45896:30709,45897:30711,45898:30713,45899:30714,45900:30715,45901:30716,45902:30723,45903:30724,45904:30725,45905:30726,45906:30727,45907:30728,45908:30730,45909:30731,45910:30734,45911:30735,45912:30736,45913:30739,45914:30741,45915:30745,45916:30747,45917:30750,45918:30752,45919:30753,45920:30754,45921:30756,45922:30760,45923:30762,45924:30763,45925:30766,45926:30767,45927:30769,45928:30770,45929:30771,45930:30773,45931:30774,45932:30781,45933:30783,45934:30785,45935:30786,45936:30787,45937:30788,45938:30790,45939:30792,45940:30793,45941:30794,45942:30795,45943:30797,45944:30799,45945:30801,45946:30803,45947:30804,45948:30808,45949:30809,45950:30810,45952:30811,45953:30812,45954:30814,45955:30815,45956:30816,45957:30817,45958:30818,45959:30819,45960:30820,45961:30821,45962:30822,45963:30823,45964:30824,45965:30825,45966:30831,45967:30832,45968:30833,45969:30834,45970:30835,45971:30836,45972:30837,45973:30838,45974:30840,45975:30841,45976:30842,45977:30843,45978:30845,45979:30846,45980:30847,45981:30848,45982:30849,45983:30850,45984:30851,45985:22330,45986:23581,45987:24120,45988:38271,45989:20607,45990:32928,45991:21378,45992:25950,45993:30021,45994:21809,45995:20513,45996:36229,45997:25220,45998:38046,45999:26397,46e3:22066,46001:28526,46002:24034,46003:21557,46004:28818,46005:36710,46006:25199,46007:25764,46008:25507,46009:24443,46010:28552,46011:37108,46012:33251,46013:36784,46014:23576,46015:26216,46016:24561,46017:27785,46018:38472,46019:36225,46020:34924,46021:25745,46022:31216,46023:22478,46024:27225,46025:25104,46026:21576,46027:20056,46028:31243,46029:24809,46030:28548,46031:35802,46032:25215,46033:36894,46034:39563,46035:31204,46036:21507,46037:30196,46038:25345,46039:21273,46040:27744,46041:36831,46042:24347,46043:39536,46044:32827,46045:40831,46046:20360,46047:23610,46048:36196,46049:32709,46050:26021,46051:28861,46052:20805,46053:20914,46054:34411,46055:23815,46056:23456,46057:25277,46058:37228,46059:30068,46060:36364,46061:31264,46062:24833,46063:31609,46064:20167,46065:32504,46066:30597,46067:19985,46068:33261,46069:21021,46070:20986,46071:27249,46072:21416,46073:36487,46074:38148,46075:38607,46076:28353,46077:38500,46078:26970,46144:30852,46145:30853,46146:30854,46147:30856,46148:30858,46149:30859,46150:30863,46151:30864,46152:30866,46153:30868,46154:30869,46155:30870,46156:30873,46157:30877,46158:30878,46159:30880,46160:30882,46161:30884,46162:30886,46163:30888,46164:30889,46165:30890,46166:30891,46167:30892,46168:30893,46169:30894,46170:30895,46171:30901,46172:30902,46173:30903,46174:30904,46175:30906,46176:30907,46177:30908,46178:30909,46179:30911,46180:30912,46181:30914,46182:30915,46183:30916,46184:30918,46185:30919,46186:30920,46187:30924,46188:30925,46189:30926,46190:30927,46191:30929,46192:30930,46193:30931,46194:30934,46195:30935,46196:30936,46197:30938,46198:30939,46199:30940,46200:30941,46201:30942,46202:30943,46203:30944,46204:30945,46205:30946,46206:30947,46208:30948,46209:30949,46210:30950,46211:30951,46212:30953,46213:30954,46214:30955,46215:30957,46216:30958,46217:30959,46218:30960,46219:30961,46220:30963,46221:30965,46222:30966,46223:30968,46224:30969,46225:30971,46226:30972,46227:30973,46228:30974,46229:30975,46230:30976,46231:30978,46232:30979,46233:30980,46234:30982,46235:30983,46236:30984,46237:30985,46238:30986,46239:30987,46240:30988,46241:30784,46242:20648,46243:30679,46244:25616,46245:35302,46246:22788,46247:25571,46248:24029,46249:31359,46250:26941,46251:20256,46252:33337,46253:21912,46254:20018,46255:30126,46256:31383,46257:24162,46258:24202,46259:38383,46260:21019,46261:21561,46262:28810,46263:25462,46264:38180,46265:22402,46266:26149,46267:26943,46268:37255,46269:21767,46270:28147,46271:32431,46272:34850,46273:25139,46274:32496,46275:30133,46276:33576,46277:30913,46278:38604,46279:36766,46280:24904,46281:29943,46282:35789,46283:27492,46284:21050,46285:36176,46286:27425,46287:32874,46288:33905,46289:22257,46290:21254,46291:20174,46292:19995,46293:20945,46294:31895,46295:37259,46296:31751,46297:20419,46298:36479,46299:31713,46300:31388,46301:25703,46302:23828,46303:20652,46304:33030,46305:30209,46306:31929,46307:28140,46308:32736,46309:26449,46310:23384,46311:23544,46312:30923,46313:25774,46314:25619,46315:25514,46316:25387,46317:38169,46318:25645,46319:36798,46320:31572,46321:30249,46322:25171,46323:22823,46324:21574,46325:27513,46326:20643,46327:25140,46328:24102,46329:27526,46330:20195,46331:36151,46332:34955,46333:24453,46334:36910,46400:30989,46401:30990,46402:30991,46403:30992,46404:30993,46405:30994,46406:30996,46407:30997,46408:30998,46409:30999,46410:31e3,46411:31001,46412:31002,46413:31003,46414:31004,46415:31005,46416:31007,46417:31008,46418:31009,46419:31010,46420:31011,46421:31013,46422:31014,46423:31015,46424:31016,46425:31017,46426:31018,46427:31019,46428:31020,46429:31021,46430:31022,46431:31023,46432:31024,46433:31025,46434:31026,46435:31027,46436:31029,46437:31030,46438:31031,46439:31032,46440:31033,46441:31037,46442:31039,46443:31042,46444:31043,46445:31044,46446:31045,46447:31047,46448:31050,46449:31051,46450:31052,46451:31053,46452:31054,46453:31055,46454:31056,46455:31057,46456:31058,46457:31060,46458:31061,46459:31064,46460:31065,46461:31073,46462:31075,46464:31076,46465:31078,46466:31081,46467:31082,46468:31083,46469:31084,46470:31086,46471:31088,46472:31089,46473:31090,46474:31091,46475:31092,46476:31093,46477:31094,46478:31097,46479:31099,46480:31100,46481:31101,46482:31102,46483:31103,46484:31106,46485:31107,46486:31110,46487:31111,46488:31112,46489:31113,46490:31115,46491:31116,46492:31117,46493:31118,46494:31120,46495:31121,46496:31122,46497:24608,46498:32829,46499:25285,46500:20025,46501:21333,46502:37112,46503:25528,46504:32966,46505:26086,46506:27694,46507:20294,46508:24814,46509:28129,46510:35806,46511:24377,46512:34507,46513:24403,46514:25377,46515:20826,46516:33633,46517:26723,46518:20992,46519:25443,46520:36424,46521:20498,46522:23707,46523:31095,46524:23548,46525:21040,46526:31291,46527:24764,46528:36947,46529:30423,46530:24503,46531:24471,46532:30340,46533:36460,46534:28783,46535:30331,46536:31561,46537:30634,46538:20979,46539:37011,46540:22564,46541:20302,46542:28404,46543:36842,46544:25932,46545:31515,46546:29380,46547:28068,46548:32735,46549:23265,46550:25269,46551:24213,46552:22320,46553:33922,46554:31532,46555:24093,46556:24351,46557:36882,46558:32532,46559:39072,46560:25474,46561:28359,46562:30872,46563:28857,46564:20856,46565:38747,46566:22443,46567:30005,46568:20291,46569:30008,46570:24215,46571:24806,46572:22880,46573:28096,46574:27583,46575:30857,46576:21500,46577:38613,46578:20939,46579:20993,46580:25481,46581:21514,46582:38035,46583:35843,46584:36300,46585:29241,46586:30879,46587:34678,46588:36845,46589:35853,46590:21472,46656:31123,46657:31124,46658:31125,46659:31126,46660:31127,46661:31128,46662:31129,46663:31131,46664:31132,46665:31133,46666:31134,46667:31135,46668:31136,46669:31137,46670:31138,46671:31139,46672:31140,46673:31141,46674:31142,46675:31144,46676:31145,46677:31146,46678:31147,46679:31148,46680:31149,46681:31150,46682:31151,46683:31152,46684:31153,46685:31154,46686:31156,46687:31157,46688:31158,46689:31159,46690:31160,46691:31164,46692:31167,46693:31170,46694:31172,46695:31173,46696:31175,46697:31176,46698:31178,46699:31180,46700:31182,46701:31183,46702:31184,46703:31187,46704:31188,46705:31190,46706:31191,46707:31193,46708:31194,46709:31195,46710:31196,46711:31197,46712:31198,46713:31200,46714:31201,46715:31202,46716:31205,46717:31208,46718:31210,46720:31212,46721:31214,46722:31217,46723:31218,46724:31219,46725:31220,46726:31221,46727:31222,46728:31223,46729:31225,46730:31226,46731:31228,46732:31230,46733:31231,46734:31233,46735:31236,46736:31237,46737:31239,46738:31240,46739:31241,46740:31242,46741:31244,46742:31247,46743:31248,46744:31249,46745:31250,46746:31251,46747:31253,46748:31254,46749:31256,46750:31257,46751:31259,46752:31260,46753:19969,46754:30447,46755:21486,46756:38025,46757:39030,46758:40718,46759:38189,46760:23450,46761:35746,46762:20002,46763:19996,46764:20908,46765:33891,46766:25026,46767:21160,46768:26635,46769:20375,46770:24683,46771:20923,46772:27934,46773:20828,46774:25238,46775:26007,46776:38497,46777:35910,46778:36887,46779:30168,46780:37117,46781:30563,46782:27602,46783:29322,46784:29420,46785:35835,46786:22581,46787:30585,46788:36172,46789:26460,46790:38208,46791:32922,46792:24230,46793:28193,46794:22930,46795:31471,46796:30701,46797:38203,46798:27573,46799:26029,46800:32526,46801:22534,46802:20817,46803:38431,46804:23545,46805:22697,46806:21544,46807:36466,46808:25958,46809:39039,46810:22244,46811:38045,46812:30462,46813:36929,46814:25479,46815:21702,46816:22810,46817:22842,46818:22427,46819:36530,46820:26421,46821:36346,46822:33333,46823:21057,46824:24816,46825:22549,46826:34558,46827:23784,46828:40517,46829:20420,46830:39069,46831:35769,46832:23077,46833:24694,46834:21380,46835:25212,46836:36943,46837:37122,46838:39295,46839:24681,46840:32780,46841:20799,46842:32819,46843:23572,46844:39285,46845:27953,46846:20108,46912:31261,46913:31263,46914:31265,46915:31266,46916:31268,46917:31269,46918:31270,46919:31271,46920:31272,46921:31273,46922:31274,46923:31275,46924:31276,46925:31277,46926:31278,46927:31279,46928:31280,46929:31281,46930:31282,46931:31284,46932:31285,46933:31286,46934:31288,46935:31290,46936:31294,46937:31296,46938:31297,46939:31298,46940:31299,46941:31300,46942:31301,46943:31303,46944:31304,46945:31305,46946:31306,46947:31307,46948:31308,46949:31309,46950:31310,46951:31311,46952:31312,46953:31314,46954:31315,46955:31316,46956:31317,46957:31318,46958:31320,46959:31321,46960:31322,46961:31323,46962:31324,46963:31325,46964:31326,46965:31327,46966:31328,46967:31329,46968:31330,46969:31331,46970:31332,46971:31333,46972:31334,46973:31335,46974:31336,46976:31337,46977:31338,46978:31339,46979:31340,46980:31341,46981:31342,46982:31343,46983:31345,46984:31346,46985:31347,46986:31349,46987:31355,46988:31356,46989:31357,46990:31358,46991:31362,46992:31365,46993:31367,46994:31369,46995:31370,46996:31371,46997:31372,46998:31374,46999:31375,47e3:31376,47001:31379,47002:31380,47003:31385,47004:31386,47005:31387,47006:31390,47007:31393,47008:31394,47009:36144,47010:21457,47011:32602,47012:31567,47013:20240,47014:20047,47015:38400,47016:27861,47017:29648,47018:34281,47019:24070,47020:30058,47021:32763,47022:27146,47023:30718,47024:38034,47025:32321,47026:20961,47027:28902,47028:21453,47029:36820,47030:33539,47031:36137,47032:29359,47033:39277,47034:27867,47035:22346,47036:33459,47037:26041,47038:32938,47039:25151,47040:38450,47041:22952,47042:20223,47043:35775,47044:32442,47045:25918,47046:33778,47047:38750,47048:21857,47049:39134,47050:32933,47051:21290,47052:35837,47053:21536,47054:32954,47055:24223,47056:27832,47057:36153,47058:33452,47059:37210,47060:21545,47061:27675,47062:20998,47063:32439,47064:22367,47065:28954,47066:27774,47067:31881,47068:22859,47069:20221,47070:24575,47071:24868,47072:31914,47073:20016,47074:23553,47075:26539,47076:34562,47077:23792,47078:38155,47079:39118,47080:30127,47081:28925,47082:36898,47083:20911,47084:32541,47085:35773,47086:22857,47087:20964,47088:20315,47089:21542,47090:22827,47091:25975,47092:32932,47093:23413,47094:25206,47095:25282,47096:36752,47097:24133,47098:27679,47099:31526,47100:20239,47101:20440,47102:26381,47168:31395,47169:31396,47170:31399,47171:31401,47172:31402,47173:31403,47174:31406,47175:31407,47176:31408,47177:31409,47178:31410,47179:31412,47180:31413,47181:31414,47182:31415,47183:31416,47184:31417,47185:31418,47186:31419,47187:31420,47188:31421,47189:31422,47190:31424,47191:31425,47192:31426,47193:31427,47194:31428,47195:31429,47196:31430,47197:31431,47198:31432,47199:31433,47200:31434,47201:31436,47202:31437,47203:31438,47204:31439,47205:31440,47206:31441,47207:31442,47208:31443,47209:31444,47210:31445,47211:31447,47212:31448,47213:31450,47214:31451,47215:31452,47216:31453,47217:31457,47218:31458,47219:31460,47220:31463,47221:31464,47222:31465,47223:31466,47224:31467,47225:31468,47226:31470,47227:31472,47228:31473,47229:31474,47230:31475,47232:31476,47233:31477,47234:31478,47235:31479,47236:31480,47237:31483,47238:31484,47239:31486,47240:31488,47241:31489,47242:31490,47243:31493,47244:31495,47245:31497,47246:31500,47247:31501,47248:31502,47249:31504,47250:31506,47251:31507,47252:31510,47253:31511,47254:31512,47255:31514,47256:31516,47257:31517,47258:31519,47259:31521,47260:31522,47261:31523,47262:31527,47263:31529,47264:31533,47265:28014,47266:28074,47267:31119,47268:34993,47269:24343,47270:29995,47271:25242,47272:36741,47273:20463,47274:37340,47275:26023,47276:33071,47277:33105,47278:24220,47279:33104,47280:36212,47281:21103,47282:35206,47283:36171,47284:22797,47285:20613,47286:20184,47287:38428,47288:29238,47289:33145,47290:36127,47291:23500,47292:35747,47293:38468,47294:22919,47295:32538,47296:21648,47297:22134,47298:22030,47299:35813,47300:25913,47301:27010,47302:38041,47303:30422,47304:28297,47305:24178,47306:29976,47307:26438,47308:26577,47309:31487,47310:32925,47311:36214,47312:24863,47313:31174,47314:25954,47315:36195,47316:20872,47317:21018,47318:38050,47319:32568,47320:32923,47321:32434,47322:23703,47323:28207,47324:26464,47325:31705,47326:30347,47327:39640,47328:33167,47329:32660,47330:31957,47331:25630,47332:38224,47333:31295,47334:21578,47335:21733,47336:27468,47337:25601,47338:25096,47339:40509,47340:33011,47341:30105,47342:21106,47343:38761,47344:33883,47345:26684,47346:34532,47347:38401,47348:38548,47349:38124,47350:20010,47351:21508,47352:32473,47353:26681,47354:36319,47355:32789,47356:26356,47357:24218,47358:32697,47424:31535,47425:31536,47426:31538,47427:31540,47428:31541,47429:31542,47430:31543,47431:31545,47432:31547,47433:31549,47434:31551,47435:31552,47436:31553,47437:31554,47438:31555,47439:31556,47440:31558,47441:31560,47442:31562,47443:31565,47444:31566,47445:31571,47446:31573,47447:31575,47448:31577,47449:31580,47450:31582,47451:31583,47452:31585,47453:31587,47454:31588,47455:31589,47456:31590,47457:31591,47458:31592,47459:31593,47460:31594,47461:31595,47462:31596,47463:31597,47464:31599,47465:31600,47466:31603,47467:31604,47468:31606,47469:31608,47470:31610,47471:31612,47472:31613,47473:31615,47474:31617,47475:31618,47476:31619,47477:31620,47478:31622,47479:31623,47480:31624,47481:31625,47482:31626,47483:31627,47484:31628,47485:31630,47486:31631,47488:31633,47489:31634,47490:31635,47491:31638,47492:31640,47493:31641,47494:31642,47495:31643,47496:31646,47497:31647,47498:31648,47499:31651,47500:31652,47501:31653,47502:31662,47503:31663,47504:31664,47505:31666,47506:31667,47507:31669,47508:31670,47509:31671,47510:31673,47511:31674,47512:31675,47513:31676,47514:31677,47515:31678,47516:31679,47517:31680,47518:31682,47519:31683,47520:31684,47521:22466,47522:32831,47523:26775,47524:24037,47525:25915,47526:21151,47527:24685,47528:40858,47529:20379,47530:36524,47531:20844,47532:23467,47533:24339,47534:24041,47535:27742,47536:25329,47537:36129,47538:20849,47539:38057,47540:21246,47541:27807,47542:33503,47543:29399,47544:22434,47545:26500,47546:36141,47547:22815,47548:36764,47549:33735,47550:21653,47551:31629,47552:20272,47553:27837,47554:23396,47555:22993,47556:40723,47557:21476,47558:34506,47559:39592,47560:35895,47561:32929,47562:25925,47563:39038,47564:22266,47565:38599,47566:21038,47567:29916,47568:21072,47569:23521,47570:25346,47571:35074,47572:20054,47573:25296,47574:24618,47575:26874,47576:20851,47577:23448,47578:20896,47579:35266,47580:31649,47581:39302,47582:32592,47583:24815,47584:28748,47585:36143,47586:20809,47587:24191,47588:36891,47589:29808,47590:35268,47591:22317,47592:30789,47593:24402,47594:40863,47595:38394,47596:36712,47597:39740,47598:35809,47599:30328,47600:26690,47601:26588,47602:36330,47603:36149,47604:21053,47605:36746,47606:28378,47607:26829,47608:38149,47609:37101,47610:22269,47611:26524,47612:35065,47613:36807,47614:21704,47680:31685,47681:31688,47682:31689,47683:31690,47684:31691,47685:31693,47686:31694,47687:31695,47688:31696,47689:31698,47690:31700,47691:31701,47692:31702,47693:31703,47694:31704,47695:31707,47696:31708,47697:31710,47698:31711,47699:31712,47700:31714,47701:31715,47702:31716,47703:31719,47704:31720,47705:31721,47706:31723,47707:31724,47708:31725,47709:31727,47710:31728,47711:31730,47712:31731,47713:31732,47714:31733,47715:31734,47716:31736,47717:31737,47718:31738,47719:31739,47720:31741,47721:31743,47722:31744,47723:31745,47724:31746,47725:31747,47726:31748,47727:31749,47728:31750,47729:31752,47730:31753,47731:31754,47732:31757,47733:31758,47734:31760,47735:31761,47736:31762,47737:31763,47738:31764,47739:31765,47740:31767,47741:31768,47742:31769,47744:31770,47745:31771,47746:31772,47747:31773,47748:31774,47749:31776,47750:31777,47751:31778,47752:31779,47753:31780,47754:31781,47755:31784,47756:31785,47757:31787,47758:31788,47759:31789,47760:31790,47761:31791,47762:31792,47763:31793,47764:31794,47765:31795,47766:31796,47767:31797,47768:31798,47769:31799,47770:31801,47771:31802,47772:31803,47773:31804,47774:31805,47775:31806,47776:31810,47777:39608,47778:23401,47779:28023,47780:27686,47781:20133,47782:23475,47783:39559,47784:37219,47785:25e3,47786:37039,47787:38889,47788:21547,47789:28085,47790:23506,47791:20989,47792:21898,47793:32597,47794:32752,47795:25788,47796:25421,47797:26097,47798:25022,47799:24717,47800:28938,47801:27735,47802:27721,47803:22831,47804:26477,47805:33322,47806:22741,47807:22158,47808:35946,47809:27627,47810:37085,47811:22909,47812:32791,47813:21495,47814:28009,47815:21621,47816:21917,47817:33655,47818:33743,47819:26680,47820:31166,47821:21644,47822:20309,47823:21512,47824:30418,47825:35977,47826:38402,47827:27827,47828:28088,47829:36203,47830:35088,47831:40548,47832:36154,47833:22079,47834:40657,47835:30165,47836:24456,47837:29408,47838:24680,47839:21756,47840:20136,47841:27178,47842:34913,47843:24658,47844:36720,47845:21700,47846:28888,47847:34425,47848:40511,47849:27946,47850:23439,47851:24344,47852:32418,47853:21897,47854:20399,47855:29492,47856:21564,47857:21402,47858:20505,47859:21518,47860:21628,47861:20046,47862:24573,47863:29786,47864:22774,47865:33899,47866:32993,47867:34676,47868:29392,47869:31946,47870:28246,47936:31811,47937:31812,47938:31813,47939:31814,47940:31815,47941:31816,47942:31817,47943:31818,47944:31819,47945:31820,47946:31822,47947:31823,47948:31824,47949:31825,47950:31826,47951:31827,47952:31828,47953:31829,47954:31830,47955:31831,47956:31832,47957:31833,47958:31834,47959:31835,47960:31836,47961:31837,47962:31838,47963:31839,47964:31840,47965:31841,47966:31842,47967:31843,47968:31844,47969:31845,47970:31846,47971:31847,47972:31848,47973:31849,47974:31850,47975:31851,47976:31852,47977:31853,47978:31854,47979:31855,47980:31856,47981:31857,47982:31858,47983:31861,47984:31862,47985:31863,47986:31864,47987:31865,47988:31866,47989:31870,47990:31871,47991:31872,47992:31873,47993:31874,47994:31875,47995:31876,47996:31877,47997:31878,47998:31879,48e3:31880,48001:31882,48002:31883,48003:31884,48004:31885,48005:31886,48006:31887,48007:31888,48008:31891,48009:31892,48010:31894,48011:31897,48012:31898,48013:31899,48014:31904,48015:31905,48016:31907,48017:31910,48018:31911,48019:31912,48020:31913,48021:31915,48022:31916,48023:31917,48024:31919,48025:31920,48026:31924,48027:31925,48028:31926,48029:31927,48030:31928,48031:31930,48032:31931,48033:24359,48034:34382,48035:21804,48036:25252,48037:20114,48038:27818,48039:25143,48040:33457,48041:21719,48042:21326,48043:29502,48044:28369,48045:30011,48046:21010,48047:21270,48048:35805,48049:27088,48050:24458,48051:24576,48052:28142,48053:22351,48054:27426,48055:29615,48056:26707,48057:36824,48058:32531,48059:25442,48060:24739,48061:21796,48062:30186,48063:35938,48064:28949,48065:28067,48066:23462,48067:24187,48068:33618,48069:24908,48070:40644,48071:30970,48072:34647,48073:31783,48074:30343,48075:20976,48076:24822,48077:29004,48078:26179,48079:24140,48080:24653,48081:35854,48082:28784,48083:25381,48084:36745,48085:24509,48086:24674,48087:34516,48088:22238,48089:27585,48090:24724,48091:24935,48092:21321,48093:24800,48094:26214,48095:36159,48096:31229,48097:20250,48098:28905,48099:27719,48100:35763,48101:35826,48102:32472,48103:33636,48104:26127,48105:23130,48106:39746,48107:27985,48108:28151,48109:35905,48110:27963,48111:20249,48112:28779,48113:33719,48114:25110,48115:24785,48116:38669,48117:36135,48118:31096,48119:20987,48120:22334,48121:22522,48122:26426,48123:30072,48124:31293,48125:31215,48126:31637,48192:31935,48193:31936,48194:31938,48195:31939,48196:31940,48197:31942,48198:31945,48199:31947,48200:31950,48201:31951,48202:31952,48203:31953,48204:31954,48205:31955,48206:31956,48207:31960,48208:31962,48209:31963,48210:31965,48211:31966,48212:31969,48213:31970,48214:31971,48215:31972,48216:31973,48217:31974,48218:31975,48219:31977,48220:31978,48221:31979,48222:31980,48223:31981,48224:31982,48225:31984,48226:31985,48227:31986,48228:31987,48229:31988,48230:31989,48231:31990,48232:31991,48233:31993,48234:31994,48235:31996,48236:31997,48237:31998,48238:31999,48239:32e3,48240:32001,48241:32002,48242:32003,48243:32004,48244:32005,48245:32006,48246:32007,48247:32008,48248:32009,48249:32011,48250:32012,48251:32013,48252:32014,48253:32015,48254:32016,48256:32017,48257:32018,48258:32019,48259:32020,48260:32021,48261:32022,48262:32023,48263:32024,48264:32025,48265:32026,48266:32027,48267:32028,48268:32029,48269:32030,48270:32031,48271:32033,48272:32035,48273:32036,48274:32037,48275:32038,48276:32040,48277:32041,48278:32042,48279:32044,48280:32045,48281:32046,48282:32048,48283:32049,48284:32050,48285:32051,48286:32052,48287:32053,48288:32054,48289:32908,48290:39269,48291:36857,48292:28608,48293:35749,48294:40481,48295:23020,48296:32489,48297:32521,48298:21513,48299:26497,48300:26840,48301:36753,48302:31821,48303:38598,48304:21450,48305:24613,48306:30142,48307:27762,48308:21363,48309:23241,48310:32423,48311:25380,48312:20960,48313:33034,48314:24049,48315:34015,48316:25216,48317:20864,48318:23395,48319:20238,48320:31085,48321:21058,48322:24760,48323:27982,48324:23492,48325:23490,48326:35745,48327:35760,48328:26082,48329:24524,48330:38469,48331:22931,48332:32487,48333:32426,48334:22025,48335:26551,48336:22841,48337:20339,48338:23478,48339:21152,48340:33626,48341:39050,48342:36158,48343:30002,48344:38078,48345:20551,48346:31292,48347:20215,48348:26550,48349:39550,48350:23233,48351:27516,48352:30417,48353:22362,48354:23574,48355:31546,48356:38388,48357:29006,48358:20860,48359:32937,48360:33392,48361:22904,48362:32516,48363:33575,48364:26816,48365:26604,48366:30897,48367:30839,48368:25315,48369:25441,48370:31616,48371:20461,48372:21098,48373:20943,48374:33616,48375:27099,48376:37492,48377:36341,48378:36145,48379:35265,48380:38190,48381:31661,48382:20214,48448:32055,48449:32056,48450:32057,48451:32058,48452:32059,48453:32060,48454:32061,48455:32062,48456:32063,48457:32064,48458:32065,48459:32066,48460:32067,48461:32068,48462:32069,48463:32070,48464:32071,48465:32072,48466:32073,48467:32074,48468:32075,48469:32076,48470:32077,48471:32078,48472:32079,48473:32080,48474:32081,48475:32082,48476:32083,48477:32084,48478:32085,48479:32086,48480:32087,48481:32088,48482:32089,48483:32090,48484:32091,48485:32092,48486:32093,48487:32094,48488:32095,48489:32096,48490:32097,48491:32098,48492:32099,48493:32100,48494:32101,48495:32102,48496:32103,48497:32104,48498:32105,48499:32106,48500:32107,48501:32108,48502:32109,48503:32111,48504:32112,48505:32113,48506:32114,48507:32115,48508:32116,48509:32117,48510:32118,48512:32120,48513:32121,48514:32122,48515:32123,48516:32124,48517:32125,48518:32126,48519:32127,48520:32128,48521:32129,48522:32130,48523:32131,48524:32132,48525:32133,48526:32134,48527:32135,48528:32136,48529:32137,48530:32138,48531:32139,48532:32140,48533:32141,48534:32142,48535:32143,48536:32144,48537:32145,48538:32146,48539:32147,48540:32148,48541:32149,48542:32150,48543:32151,48544:32152,48545:20581,48546:33328,48547:21073,48548:39279,48549:28176,48550:28293,48551:28071,48552:24314,48553:20725,48554:23004,48555:23558,48556:27974,48557:27743,48558:30086,48559:33931,48560:26728,48561:22870,48562:35762,48563:21280,48564:37233,48565:38477,48566:34121,48567:26898,48568:30977,48569:28966,48570:33014,48571:20132,48572:37066,48573:27975,48574:39556,48575:23047,48576:22204,48577:25605,48578:38128,48579:30699,48580:20389,48581:33050,48582:29409,48583:35282,48584:39290,48585:32564,48586:32478,48587:21119,48588:25945,48589:37237,48590:36735,48591:36739,48592:21483,48593:31382,48594:25581,48595:25509,48596:30342,48597:31224,48598:34903,48599:38454,48600:25130,48601:21163,48602:33410,48603:26708,48604:26480,48605:25463,48606:30571,48607:31469,48608:27905,48609:32467,48610:35299,48611:22992,48612:25106,48613:34249,48614:33445,48615:30028,48616:20511,48617:20171,48618:30117,48619:35819,48620:23626,48621:24062,48622:31563,48623:26020,48624:37329,48625:20170,48626:27941,48627:35167,48628:32039,48629:38182,48630:20165,48631:35880,48632:36827,48633:38771,48634:26187,48635:31105,48636:36817,48637:28908,48638:28024,48704:32153,48705:32154,48706:32155,48707:32156,48708:32157,48709:32158,48710:32159,48711:32160,48712:32161,48713:32162,48714:32163,48715:32164,48716:32165,48717:32167,48718:32168,48719:32169,48720:32170,48721:32171,48722:32172,48723:32173,48724:32175,48725:32176,48726:32177,48727:32178,48728:32179,48729:32180,48730:32181,48731:32182,48732:32183,48733:32184,48734:32185,48735:32186,48736:32187,48737:32188,48738:32189,48739:32190,48740:32191,48741:32192,48742:32193,48743:32194,48744:32195,48745:32196,48746:32197,48747:32198,48748:32199,48749:32200,48750:32201,48751:32202,48752:32203,48753:32204,48754:32205,48755:32206,48756:32207,48757:32208,48758:32209,48759:32210,48760:32211,48761:32212,48762:32213,48763:32214,48764:32215,48765:32216,48766:32217,48768:32218,48769:32219,48770:32220,48771:32221,48772:32222,48773:32223,48774:32224,48775:32225,48776:32226,48777:32227,48778:32228,48779:32229,48780:32230,48781:32231,48782:32232,48783:32233,48784:32234,48785:32235,48786:32236,48787:32237,48788:32238,48789:32239,48790:32240,48791:32241,48792:32242,48793:32243,48794:32244,48795:32245,48796:32246,48797:32247,48798:32248,48799:32249,48800:32250,48801:23613,48802:21170,48803:33606,48804:20834,48805:33550,48806:30555,48807:26230,48808:40120,48809:20140,48810:24778,48811:31934,48812:31923,48813:32463,48814:20117,48815:35686,48816:26223,48817:39048,48818:38745,48819:22659,48820:25964,48821:38236,48822:24452,48823:30153,48824:38742,48825:31455,48826:31454,48827:20928,48828:28847,48829:31384,48830:25578,48831:31350,48832:32416,48833:29590,48834:38893,48835:20037,48836:28792,48837:20061,48838:37202,48839:21417,48840:25937,48841:26087,48842:33276,48843:33285,48844:21646,48845:23601,48846:30106,48847:38816,48848:25304,48849:29401,48850:30141,48851:23621,48852:39545,48853:33738,48854:23616,48855:21632,48856:30697,48857:20030,48858:27822,48859:32858,48860:25298,48861:25454,48862:24040,48863:20855,48864:36317,48865:36382,48866:38191,48867:20465,48868:21477,48869:24807,48870:28844,48871:21095,48872:25424,48873:40515,48874:23071,48875:20518,48876:30519,48877:21367,48878:32482,48879:25733,48880:25899,48881:25225,48882:25496,48883:20500,48884:29237,48885:35273,48886:20915,48887:35776,48888:32477,48889:22343,48890:33740,48891:38055,48892:20891,48893:21531,48894:23803,48960:32251,48961:32252,48962:32253,48963:32254,48964:32255,48965:32256,48966:32257,48967:32258,48968:32259,48969:32260,48970:32261,48971:32262,48972:32263,48973:32264,48974:32265,48975:32266,48976:32267,48977:32268,48978:32269,48979:32270,48980:32271,48981:32272,48982:32273,48983:32274,48984:32275,48985:32276,48986:32277,48987:32278,48988:32279,48989:32280,48990:32281,48991:32282,48992:32283,48993:32284,48994:32285,48995:32286,48996:32287,48997:32288,48998:32289,48999:32290,49e3:32291,49001:32292,49002:32293,49003:32294,49004:32295,49005:32296,49006:32297,49007:32298,49008:32299,49009:32300,49010:32301,49011:32302,49012:32303,49013:32304,49014:32305,49015:32306,49016:32307,49017:32308,49018:32309,49019:32310,49020:32311,49021:32312,49022:32313,49024:32314,49025:32316,49026:32317,49027:32318,49028:32319,49029:32320,49030:32322,49031:32323,49032:32324,49033:32325,49034:32326,49035:32328,49036:32329,49037:32330,49038:32331,49039:32332,49040:32333,49041:32334,49042:32335,49043:32336,49044:32337,49045:32338,49046:32339,49047:32340,49048:32341,49049:32342,49050:32343,49051:32344,49052:32345,49053:32346,49054:32347,49055:32348,49056:32349,49057:20426,49058:31459,49059:27994,49060:37089,49061:39567,49062:21888,49063:21654,49064:21345,49065:21679,49066:24320,49067:25577,49068:26999,49069:20975,49070:24936,49071:21002,49072:22570,49073:21208,49074:22350,49075:30733,49076:30475,49077:24247,49078:24951,49079:31968,49080:25179,49081:25239,49082:20130,49083:28821,49084:32771,49085:25335,49086:28900,49087:38752,49088:22391,49089:33499,49090:26607,49091:26869,49092:30933,49093:39063,49094:31185,49095:22771,49096:21683,49097:21487,49098:28212,49099:20811,49100:21051,49101:23458,49102:35838,49103:32943,49104:21827,49105:22438,49106:24691,49107:22353,49108:21549,49109:31354,49110:24656,49111:23380,49112:25511,49113:25248,49114:21475,49115:25187,49116:23495,49117:26543,49118:21741,49119:31391,49120:33510,49121:37239,49122:24211,49123:35044,49124:22840,49125:22446,49126:25358,49127:36328,49128:33007,49129:22359,49130:31607,49131:20393,49132:24555,49133:23485,49134:27454,49135:21281,49136:31568,49137:29378,49138:26694,49139:30719,49140:30518,49141:26103,49142:20917,49143:20111,49144:30420,49145:23743,49146:31397,49147:33909,49148:22862,49149:39745,49150:20608,49216:32350,49217:32351,49218:32352,49219:32353,49220:32354,49221:32355,49222:32356,49223:32357,49224:32358,49225:32359,49226:32360,49227:32361,49228:32362,49229:32363,49230:32364,49231:32365,49232:32366,49233:32367,49234:32368,49235:32369,49236:32370,49237:32371,49238:32372,49239:32373,49240:32374,49241:32375,49242:32376,49243:32377,49244:32378,49245:32379,49246:32380,49247:32381,49248:32382,49249:32383,49250:32384,49251:32385,49252:32387,49253:32388,49254:32389,49255:32390,49256:32391,49257:32392,49258:32393,49259:32394,49260:32395,49261:32396,49262:32397,49263:32398,49264:32399,49265:32400,49266:32401,49267:32402,49268:32403,49269:32404,49270:32405,49271:32406,49272:32407,49273:32408,49274:32409,49275:32410,49276:32412,49277:32413,49278:32414,49280:32430,49281:32436,49282:32443,49283:32444,49284:32470,49285:32484,49286:32492,49287:32505,49288:32522,49289:32528,49290:32542,49291:32567,49292:32569,49293:32571,49294:32572,49295:32573,49296:32574,49297:32575,49298:32576,49299:32577,49300:32579,49301:32582,49302:32583,49303:32584,49304:32585,49305:32586,49306:32587,49307:32588,49308:32589,49309:32590,49310:32591,49311:32594,49312:32595,49313:39304,49314:24871,49315:28291,49316:22372,49317:26118,49318:25414,49319:22256,49320:25324,49321:25193,49322:24275,49323:38420,49324:22403,49325:25289,49326:21895,49327:34593,49328:33098,49329:36771,49330:21862,49331:33713,49332:26469,49333:36182,49334:34013,49335:23146,49336:26639,49337:25318,49338:31726,49339:38417,49340:20848,49341:28572,49342:35888,49343:25597,49344:35272,49345:25042,49346:32518,49347:28866,49348:28389,49349:29701,49350:27028,49351:29436,49352:24266,49353:37070,49354:26391,49355:28010,49356:25438,49357:21171,49358:29282,49359:32769,49360:20332,49361:23013,49362:37226,49363:28889,49364:28061,49365:21202,49366:20048,49367:38647,49368:38253,49369:34174,49370:30922,49371:32047,49372:20769,49373:22418,49374:25794,49375:32907,49376:31867,49377:27882,49378:26865,49379:26974,49380:20919,49381:21400,49382:26792,49383:29313,49384:40654,49385:31729,49386:29432,49387:31163,49388:28435,49389:29702,49390:26446,49391:37324,49392:40100,49393:31036,49394:33673,49395:33620,49396:21519,49397:26647,49398:20029,49399:21385,49400:21169,49401:30782,49402:21382,49403:21033,49404:20616,49405:20363,49406:20432,49472:32598,49473:32601,49474:32603,49475:32604,49476:32605,49477:32606,49478:32608,49479:32611,49480:32612,49481:32613,49482:32614,49483:32615,49484:32619,49485:32620,49486:32621,49487:32623,49488:32624,49489:32627,49490:32629,49491:32630,49492:32631,49493:32632,49494:32634,49495:32635,49496:32636,49497:32637,49498:32639,49499:32640,49500:32642,49501:32643,49502:32644,49503:32645,49504:32646,49505:32647,49506:32648,49507:32649,49508:32651,49509:32653,49510:32655,49511:32656,49512:32657,49513:32658,49514:32659,49515:32661,49516:32662,49517:32663,49518:32664,49519:32665,49520:32667,49521:32668,49522:32672,49523:32674,49524:32675,49525:32677,49526:32678,49527:32680,49528:32681,49529:32682,49530:32683,49531:32684,49532:32685,49533:32686,49534:32689,49536:32691,49537:32692,49538:32693,49539:32694,49540:32695,49541:32698,49542:32699,49543:32702,49544:32704,49545:32706,49546:32707,49547:32708,49548:32710,49549:32711,49550:32712,49551:32713,49552:32715,49553:32717,49554:32719,49555:32720,49556:32721,49557:32722,49558:32723,49559:32726,49560:32727,49561:32729,49562:32730,49563:32731,49564:32732,49565:32733,49566:32734,49567:32738,49568:32739,49569:30178,49570:31435,49571:31890,49572:27813,49573:38582,49574:21147,49575:29827,49576:21737,49577:20457,49578:32852,49579:33714,49580:36830,49581:38256,49582:24265,49583:24604,49584:28063,49585:24088,49586:25947,49587:33080,49588:38142,49589:24651,49590:28860,49591:32451,49592:31918,49593:20937,49594:26753,49595:31921,49596:33391,49597:20004,49598:36742,49599:37327,49600:26238,49601:20142,49602:35845,49603:25769,49604:32842,49605:20698,49606:30103,49607:29134,49608:23525,49609:36797,49610:28518,49611:20102,49612:25730,49613:38243,49614:24278,49615:26009,49616:21015,49617:35010,49618:28872,49619:21155,49620:29454,49621:29747,49622:26519,49623:30967,49624:38678,49625:20020,49626:37051,49627:40158,49628:28107,49629:20955,49630:36161,49631:21533,49632:25294,49633:29618,49634:33777,49635:38646,49636:40836,49637:38083,49638:20278,49639:32666,49640:20940,49641:28789,49642:38517,49643:23725,49644:39046,49645:21478,49646:20196,49647:28316,49648:29705,49649:27060,49650:30827,49651:39311,49652:30041,49653:21016,49654:30244,49655:27969,49656:26611,49657:20845,49658:40857,49659:32843,49660:21657,49661:31548,49662:31423,49728:32740,49729:32743,49730:32744,49731:32746,49732:32747,49733:32748,49734:32749,49735:32751,49736:32754,49737:32756,49738:32757,49739:32758,49740:32759,49741:32760,49742:32761,49743:32762,49744:32765,49745:32766,49746:32767,49747:32770,49748:32775,49749:32776,49750:32777,49751:32778,49752:32782,49753:32783,49754:32785,49755:32787,49756:32794,49757:32795,49758:32797,49759:32798,49760:32799,49761:32801,49762:32803,49763:32804,49764:32811,49765:32812,49766:32813,49767:32814,49768:32815,49769:32816,49770:32818,49771:32820,49772:32825,49773:32826,49774:32828,49775:32830,49776:32832,49777:32833,49778:32836,49779:32837,49780:32839,49781:32840,49782:32841,49783:32846,49784:32847,49785:32848,49786:32849,49787:32851,49788:32853,49789:32854,49790:32855,49792:32857,49793:32859,49794:32860,49795:32861,49796:32862,49797:32863,49798:32864,49799:32865,49800:32866,49801:32867,49802:32868,49803:32869,49804:32870,49805:32871,49806:32872,49807:32875,49808:32876,49809:32877,49810:32878,49811:32879,49812:32880,49813:32882,49814:32883,49815:32884,49816:32885,49817:32886,49818:32887,49819:32888,49820:32889,49821:32890,49822:32891,49823:32892,49824:32893,49825:38534,49826:22404,49827:25314,49828:38471,49829:27004,49830:23044,49831:25602,49832:31699,49833:28431,49834:38475,49835:33446,49836:21346,49837:39045,49838:24208,49839:28809,49840:25523,49841:21348,49842:34383,49843:40065,49844:40595,49845:30860,49846:38706,49847:36335,49848:36162,49849:40575,49850:28510,49851:31108,49852:24405,49853:38470,49854:25134,49855:39540,49856:21525,49857:38109,49858:20387,49859:26053,49860:23653,49861:23649,49862:32533,49863:34385,49864:27695,49865:24459,49866:29575,49867:28388,49868:32511,49869:23782,49870:25371,49871:23402,49872:28390,49873:21365,49874:20081,49875:25504,49876:30053,49877:25249,49878:36718,49879:20262,49880:20177,49881:27814,49882:32438,49883:35770,49884:33821,49885:34746,49886:32599,49887:36923,49888:38179,49889:31657,49890:39585,49891:35064,49892:33853,49893:27931,49894:39558,49895:32476,49896:22920,49897:40635,49898:29595,49899:30721,49900:34434,49901:39532,49902:39554,49903:22043,49904:21527,49905:22475,49906:20080,49907:40614,49908:21334,49909:36808,49910:33033,49911:30610,49912:39314,49913:34542,49914:28385,49915:34067,49916:26364,49917:24930,49918:28459,49984:32894,49985:32897,49986:32898,49987:32901,49988:32904,49989:32906,49990:32909,49991:32910,49992:32911,49993:32912,49994:32913,49995:32914,49996:32916,49997:32917,49998:32919,49999:32921,5e4:32926,50001:32931,50002:32934,50003:32935,50004:32936,50005:32940,50006:32944,50007:32947,50008:32949,50009:32950,50010:32952,50011:32953,50012:32955,50013:32965,50014:32967,50015:32968,50016:32969,50017:32970,50018:32971,50019:32975,50020:32976,50021:32977,50022:32978,50023:32979,50024:32980,50025:32981,50026:32984,50027:32991,50028:32992,50029:32994,50030:32995,50031:32998,50032:33006,50033:33013,50034:33015,50035:33017,50036:33019,50037:33022,50038:33023,50039:33024,50040:33025,50041:33027,50042:33028,50043:33029,50044:33031,50045:33032,50046:33035,50048:33036,50049:33045,50050:33047,50051:33049,50052:33051,50053:33052,50054:33053,50055:33055,50056:33056,50057:33057,50058:33058,50059:33059,50060:33060,50061:33061,50062:33062,50063:33063,50064:33064,50065:33065,50066:33066,50067:33067,50068:33069,50069:33070,50070:33072,50071:33075,50072:33076,50073:33077,50074:33079,50075:33081,50076:33082,50077:33083,50078:33084,50079:33085,50080:33087,50081:35881,50082:33426,50083:33579,50084:30450,50085:27667,50086:24537,50087:33725,50088:29483,50089:33541,50090:38170,50091:27611,50092:30683,50093:38086,50094:21359,50095:33538,50096:20882,50097:24125,50098:35980,50099:36152,50100:20040,50101:29611,50102:26522,50103:26757,50104:37238,50105:38665,50106:29028,50107:27809,50108:30473,50109:23186,50110:38209,50111:27599,50112:32654,50113:26151,50114:23504,50115:22969,50116:23194,50117:38376,50118:38391,50119:20204,50120:33804,50121:33945,50122:27308,50123:30431,50124:38192,50125:29467,50126:26790,50127:23391,50128:30511,50129:37274,50130:38753,50131:31964,50132:36855,50133:35868,50134:24357,50135:31859,50136:31192,50137:35269,50138:27852,50139:34588,50140:23494,50141:24130,50142:26825,50143:30496,50144:32501,50145:20885,50146:20813,50147:21193,50148:23081,50149:32517,50150:38754,50151:33495,50152:25551,50153:30596,50154:34256,50155:31186,50156:28218,50157:24217,50158:22937,50159:34065,50160:28781,50161:27665,50162:25279,50163:30399,50164:25935,50165:24751,50166:38397,50167:26126,50168:34719,50169:40483,50170:38125,50171:21517,50172:21629,50173:35884,50174:25720,50240:33088,50241:33089,50242:33090,50243:33091,50244:33092,50245:33093,50246:33095,50247:33097,50248:33101,50249:33102,50250:33103,50251:33106,50252:33110,50253:33111,50254:33112,50255:33115,50256:33116,50257:33117,50258:33118,50259:33119,50260:33121,50261:33122,50262:33123,50263:33124,50264:33126,50265:33128,50266:33130,50267:33131,50268:33132,50269:33135,50270:33138,50271:33139,50272:33141,50273:33142,50274:33143,50275:33144,50276:33153,50277:33155,50278:33156,50279:33157,50280:33158,50281:33159,50282:33161,50283:33163,50284:33164,50285:33165,50286:33166,50287:33168,50288:33170,50289:33171,50290:33172,50291:33173,50292:33174,50293:33175,50294:33177,50295:33178,50296:33182,50297:33183,50298:33184,50299:33185,50300:33186,50301:33188,50302:33189,50304:33191,50305:33193,50306:33195,50307:33196,50308:33197,50309:33198,50310:33199,50311:33200,50312:33201,50313:33202,50314:33204,50315:33205,50316:33206,50317:33207,50318:33208,50319:33209,50320:33212,50321:33213,50322:33214,50323:33215,50324:33220,50325:33221,50326:33223,50327:33224,50328:33225,50329:33227,50330:33229,50331:33230,50332:33231,50333:33232,50334:33233,50335:33234,50336:33235,50337:25721,50338:34321,50339:27169,50340:33180,50341:30952,50342:25705,50343:39764,50344:25273,50345:26411,50346:33707,50347:22696,50348:40664,50349:27819,50350:28448,50351:23518,50352:38476,50353:35851,50354:29279,50355:26576,50356:25287,50357:29281,50358:20137,50359:22982,50360:27597,50361:22675,50362:26286,50363:24149,50364:21215,50365:24917,50366:26408,50367:30446,50368:30566,50369:29287,50370:31302,50371:25343,50372:21738,50373:21584,50374:38048,50375:37027,50376:23068,50377:32435,50378:27670,50379:20035,50380:22902,50381:32784,50382:22856,50383:21335,50384:30007,50385:38590,50386:22218,50387:25376,50388:33041,50389:24700,50390:38393,50391:28118,50392:21602,50393:39297,50394:20869,50395:23273,50396:33021,50397:22958,50398:38675,50399:20522,50400:27877,50401:23612,50402:25311,50403:20320,50404:21311,50405:33147,50406:36870,50407:28346,50408:34091,50409:25288,50410:24180,50411:30910,50412:25781,50413:25467,50414:24565,50415:23064,50416:37247,50417:40479,50418:23615,50419:25423,50420:32834,50421:23421,50422:21870,50423:38218,50424:38221,50425:28037,50426:24744,50427:26592,50428:29406,50429:20957,50430:23425,50496:33236,50497:33237,50498:33238,50499:33239,50500:33240,50501:33241,50502:33242,50503:33243,50504:33244,50505:33245,50506:33246,50507:33247,50508:33248,50509:33249,50510:33250,50511:33252,50512:33253,50513:33254,50514:33256,50515:33257,50516:33259,50517:33262,50518:33263,50519:33264,50520:33265,50521:33266,50522:33269,50523:33270,50524:33271,50525:33272,50526:33273,50527:33274,50528:33277,50529:33279,50530:33283,50531:33287,50532:33288,50533:33289,50534:33290,50535:33291,50536:33294,50537:33295,50538:33297,50539:33299,50540:33301,50541:33302,50542:33303,50543:33304,50544:33305,50545:33306,50546:33309,50547:33312,50548:33316,50549:33317,50550:33318,50551:33319,50552:33321,50553:33326,50554:33330,50555:33338,50556:33340,50557:33341,50558:33343,50560:33344,50561:33345,50562:33346,50563:33347,50564:33349,50565:33350,50566:33352,50567:33354,50568:33356,50569:33357,50570:33358,50571:33360,50572:33361,50573:33362,50574:33363,50575:33364,50576:33365,50577:33366,50578:33367,50579:33369,50580:33371,50581:33372,50582:33373,50583:33374,50584:33376,50585:33377,50586:33378,50587:33379,50588:33380,50589:33381,50590:33382,50591:33383,50592:33385,50593:25319,50594:27870,50595:29275,50596:25197,50597:38062,50598:32445,50599:33043,50600:27987,50601:20892,50602:24324,50603:22900,50604:21162,50605:24594,50606:22899,50607:26262,50608:34384,50609:30111,50610:25386,50611:25062,50612:31983,50613:35834,50614:21734,50615:27431,50616:40485,50617:27572,50618:34261,50619:21589,50620:20598,50621:27812,50622:21866,50623:36276,50624:29228,50625:24085,50626:24597,50627:29750,50628:25293,50629:25490,50630:29260,50631:24472,50632:28227,50633:27966,50634:25856,50635:28504,50636:30424,50637:30928,50638:30460,50639:30036,50640:21028,50641:21467,50642:20051,50643:24222,50644:26049,50645:32810,50646:32982,50647:25243,50648:21638,50649:21032,50650:28846,50651:34957,50652:36305,50653:27873,50654:21624,50655:32986,50656:22521,50657:35060,50658:36180,50659:38506,50660:37197,50661:20329,50662:27803,50663:21943,50664:30406,50665:30768,50666:25256,50667:28921,50668:28558,50669:24429,50670:34028,50671:26842,50672:30844,50673:31735,50674:33192,50675:26379,50676:40527,50677:25447,50678:30896,50679:22383,50680:30738,50681:38713,50682:25209,50683:25259,50684:21128,50685:29749,50686:27607,50752:33386,50753:33387,50754:33388,50755:33389,50756:33393,50757:33397,50758:33398,50759:33399,50760:33400,50761:33403,50762:33404,50763:33408,50764:33409,50765:33411,50766:33413,50767:33414,50768:33415,50769:33417,50770:33420,50771:33424,50772:33427,50773:33428,50774:33429,50775:33430,50776:33434,50777:33435,50778:33438,50779:33440,50780:33442,50781:33443,50782:33447,50783:33458,50784:33461,50785:33462,50786:33466,50787:33467,50788:33468,50789:33471,50790:33472,50791:33474,50792:33475,50793:33477,50794:33478,50795:33481,50796:33488,50797:33494,50798:33497,50799:33498,50800:33501,50801:33506,50802:33511,50803:33512,50804:33513,50805:33514,50806:33516,50807:33517,50808:33518,50809:33520,50810:33522,50811:33523,50812:33525,50813:33526,50814:33528,50816:33530,50817:33532,50818:33533,50819:33534,50820:33535,50821:33536,50822:33546,50823:33547,50824:33549,50825:33552,50826:33554,50827:33555,50828:33558,50829:33560,50830:33561,50831:33565,50832:33566,50833:33567,50834:33568,50835:33569,50836:33570,50837:33571,50838:33572,50839:33573,50840:33574,50841:33577,50842:33578,50843:33582,50844:33584,50845:33586,50846:33591,50847:33595,50848:33597,50849:21860,50850:33086,50851:30130,50852:30382,50853:21305,50854:30174,50855:20731,50856:23617,50857:35692,50858:31687,50859:20559,50860:29255,50861:39575,50862:39128,50863:28418,50864:29922,50865:31080,50866:25735,50867:30629,50868:25340,50869:39057,50870:36139,50871:21697,50872:32856,50873:20050,50874:22378,50875:33529,50876:33805,50877:24179,50878:20973,50879:29942,50880:35780,50881:23631,50882:22369,50883:27900,50884:39047,50885:23110,50886:30772,50887:39748,50888:36843,50889:31893,50890:21078,50891:25169,50892:38138,50893:20166,50894:33670,50895:33889,50896:33769,50897:33970,50898:22484,50899:26420,50900:22275,50901:26222,50902:28006,50903:35889,50904:26333,50905:28689,50906:26399,50907:27450,50908:26646,50909:25114,50910:22971,50911:19971,50912:20932,50913:28422,50914:26578,50915:27791,50916:20854,50917:26827,50918:22855,50919:27495,50920:30054,50921:23822,50922:33040,50923:40784,50924:26071,50925:31048,50926:31041,50927:39569,50928:36215,50929:23682,50930:20062,50931:20225,50932:21551,50933:22865,50934:30732,50935:22120,50936:27668,50937:36804,50938:24323,50939:27773,50940:27875,50941:35755,50942:25488,51008:33598,51009:33599,51010:33601,51011:33602,51012:33604,51013:33605,51014:33608,51015:33610,51016:33611,51017:33612,51018:33613,51019:33614,51020:33619,51021:33621,51022:33622,51023:33623,51024:33624,51025:33625,51026:33629,51027:33634,51028:33648,51029:33649,51030:33650,51031:33651,51032:33652,51033:33653,51034:33654,51035:33657,51036:33658,51037:33662,51038:33663,51039:33664,51040:33665,51041:33666,51042:33667,51043:33668,51044:33671,51045:33672,51046:33674,51047:33675,51048:33676,51049:33677,51050:33679,51051:33680,51052:33681,51053:33684,51054:33685,51055:33686,51056:33687,51057:33689,51058:33690,51059:33693,51060:33695,51061:33697,51062:33698,51063:33699,51064:33700,51065:33701,51066:33702,51067:33703,51068:33708,51069:33709,51070:33710,51072:33711,51073:33717,51074:33723,51075:33726,51076:33727,51077:33730,51078:33731,51079:33732,51080:33734,51081:33736,51082:33737,51083:33739,51084:33741,51085:33742,51086:33744,51087:33745,51088:33746,51089:33747,51090:33749,51091:33751,51092:33753,51093:33754,51094:33755,51095:33758,51096:33762,51097:33763,51098:33764,51099:33766,51100:33767,51101:33768,51102:33771,51103:33772,51104:33773,51105:24688,51106:27965,51107:29301,51108:25190,51109:38030,51110:38085,51111:21315,51112:36801,51113:31614,51114:20191,51115:35878,51116:20094,51117:40660,51118:38065,51119:38067,51120:21069,51121:28508,51122:36963,51123:27973,51124:35892,51125:22545,51126:23884,51127:27424,51128:27465,51129:26538,51130:21595,51131:33108,51132:32652,51133:22681,51134:34103,51135:24378,51136:25250,51137:27207,51138:38201,51139:25970,51140:24708,51141:26725,51142:30631,51143:20052,51144:20392,51145:24039,51146:38808,51147:25772,51148:32728,51149:23789,51150:20431,51151:31373,51152:20999,51153:33540,51154:19988,51155:24623,51156:31363,51157:38054,51158:20405,51159:20146,51160:31206,51161:29748,51162:21220,51163:33465,51164:25810,51165:31165,51166:23517,51167:27777,51168:38738,51169:36731,51170:27682,51171:20542,51172:21375,51173:28165,51174:25806,51175:26228,51176:27696,51177:24773,51178:39031,51179:35831,51180:24198,51181:29756,51182:31351,51183:31179,51184:19992,51185:37041,51186:29699,51187:27714,51188:22234,51189:37195,51190:27845,51191:36235,51192:21306,51193:34502,51194:26354,51195:36527,51196:23624,51197:39537,51198:28192,51264:33774,51265:33775,51266:33779,51267:33780,51268:33781,51269:33782,51270:33783,51271:33786,51272:33787,51273:33788,51274:33790,51275:33791,51276:33792,51277:33794,51278:33797,51279:33799,51280:33800,51281:33801,51282:33802,51283:33808,51284:33810,51285:33811,51286:33812,51287:33813,51288:33814,51289:33815,51290:33817,51291:33818,51292:33819,51293:33822,51294:33823,51295:33824,51296:33825,51297:33826,51298:33827,51299:33833,51300:33834,51301:33835,51302:33836,51303:33837,51304:33838,51305:33839,51306:33840,51307:33842,51308:33843,51309:33844,51310:33845,51311:33846,51312:33847,51313:33849,51314:33850,51315:33851,51316:33854,51317:33855,51318:33856,51319:33857,51320:33858,51321:33859,51322:33860,51323:33861,51324:33863,51325:33864,51326:33865,51328:33866,51329:33867,51330:33868,51331:33869,51332:33870,51333:33871,51334:33872,51335:33874,51336:33875,51337:33876,51338:33877,51339:33878,51340:33880,51341:33885,51342:33886,51343:33887,51344:33888,51345:33890,51346:33892,51347:33893,51348:33894,51349:33895,51350:33896,51351:33898,51352:33902,51353:33903,51354:33904,51355:33906,51356:33908,51357:33911,51358:33913,51359:33915,51360:33916,51361:21462,51362:23094,51363:40843,51364:36259,51365:21435,51366:22280,51367:39079,51368:26435,51369:37275,51370:27849,51371:20840,51372:30154,51373:25331,51374:29356,51375:21048,51376:21149,51377:32570,51378:28820,51379:30264,51380:21364,51381:40522,51382:27063,51383:30830,51384:38592,51385:35033,51386:32676,51387:28982,51388:29123,51389:20873,51390:26579,51391:29924,51392:22756,51393:25880,51394:22199,51395:35753,51396:39286,51397:25200,51398:32469,51399:24825,51400:28909,51401:22764,51402:20161,51403:20154,51404:24525,51405:38887,51406:20219,51407:35748,51408:20995,51409:22922,51410:32427,51411:25172,51412:20173,51413:26085,51414:25102,51415:33592,51416:33993,51417:33635,51418:34701,51419:29076,51420:28342,51421:23481,51422:32466,51423:20887,51424:25545,51425:26580,51426:32905,51427:33593,51428:34837,51429:20754,51430:23418,51431:22914,51432:36785,51433:20083,51434:27741,51435:20837,51436:35109,51437:36719,51438:38446,51439:34122,51440:29790,51441:38160,51442:38384,51443:28070,51444:33509,51445:24369,51446:25746,51447:27922,51448:33832,51449:33134,51450:40131,51451:22622,51452:36187,51453:19977,51454:21441,51520:33917,51521:33918,51522:33919,51523:33920,51524:33921,51525:33923,51526:33924,51527:33925,51528:33926,51529:33930,51530:33933,51531:33935,51532:33936,51533:33937,51534:33938,51535:33939,51536:33940,51537:33941,51538:33942,51539:33944,51540:33946,51541:33947,51542:33949,51543:33950,51544:33951,51545:33952,51546:33954,51547:33955,51548:33956,51549:33957,51550:33958,51551:33959,51552:33960,51553:33961,51554:33962,51555:33963,51556:33964,51557:33965,51558:33966,51559:33968,51560:33969,51561:33971,51562:33973,51563:33974,51564:33975,51565:33979,51566:33980,51567:33982,51568:33984,51569:33986,51570:33987,51571:33989,51572:33990,51573:33991,51574:33992,51575:33995,51576:33996,51577:33998,51578:33999,51579:34002,51580:34004,51581:34005,51582:34007,51584:34008,51585:34009,51586:34010,51587:34011,51588:34012,51589:34014,51590:34017,51591:34018,51592:34020,51593:34023,51594:34024,51595:34025,51596:34026,51597:34027,51598:34029,51599:34030,51600:34031,51601:34033,51602:34034,51603:34035,51604:34036,51605:34037,51606:34038,51607:34039,51608:34040,51609:34041,51610:34042,51611:34043,51612:34045,51613:34046,51614:34048,51615:34049,51616:34050,51617:20254,51618:25955,51619:26705,51620:21971,51621:20007,51622:25620,51623:39578,51624:25195,51625:23234,51626:29791,51627:33394,51628:28073,51629:26862,51630:20711,51631:33678,51632:30722,51633:26432,51634:21049,51635:27801,51636:32433,51637:20667,51638:21861,51639:29022,51640:31579,51641:26194,51642:29642,51643:33515,51644:26441,51645:23665,51646:21024,51647:29053,51648:34923,51649:38378,51650:38485,51651:25797,51652:36193,51653:33203,51654:21892,51655:27733,51656:25159,51657:32558,51658:22674,51659:20260,51660:21830,51661:36175,51662:26188,51663:19978,51664:23578,51665:35059,51666:26786,51667:25422,51668:31245,51669:28903,51670:33421,51671:21242,51672:38902,51673:23569,51674:21736,51675:37045,51676:32461,51677:22882,51678:36170,51679:34503,51680:33292,51681:33293,51682:36198,51683:25668,51684:23556,51685:24913,51686:28041,51687:31038,51688:35774,51689:30775,51690:30003,51691:21627,51692:20280,51693:36523,51694:28145,51695:23072,51696:32453,51697:31070,51698:27784,51699:23457,51700:23158,51701:29978,51702:32958,51703:24910,51704:28183,51705:22768,51706:29983,51707:29989,51708:29298,51709:21319,51710:32499,51776:34051,51777:34052,51778:34053,51779:34054,51780:34055,51781:34056,51782:34057,51783:34058,51784:34059,51785:34061,51786:34062,51787:34063,51788:34064,51789:34066,51790:34068,51791:34069,51792:34070,51793:34072,51794:34073,51795:34075,51796:34076,51797:34077,51798:34078,51799:34080,51800:34082,51801:34083,51802:34084,51803:34085,51804:34086,51805:34087,51806:34088,51807:34089,51808:34090,51809:34093,51810:34094,51811:34095,51812:34096,51813:34097,51814:34098,51815:34099,51816:34100,51817:34101,51818:34102,51819:34110,51820:34111,51821:34112,51822:34113,51823:34114,51824:34116,51825:34117,51826:34118,51827:34119,51828:34123,51829:34124,51830:34125,51831:34126,51832:34127,51833:34128,51834:34129,51835:34130,51836:34131,51837:34132,51838:34133,51840:34135,51841:34136,51842:34138,51843:34139,51844:34140,51845:34141,51846:34143,51847:34144,51848:34145,51849:34146,51850:34147,51851:34149,51852:34150,51853:34151,51854:34153,51855:34154,51856:34155,51857:34156,51858:34157,51859:34158,51860:34159,51861:34160,51862:34161,51863:34163,51864:34165,51865:34166,51866:34167,51867:34168,51868:34172,51869:34173,51870:34175,51871:34176,51872:34177,51873:30465,51874:30427,51875:21097,51876:32988,51877:22307,51878:24072,51879:22833,51880:29422,51881:26045,51882:28287,51883:35799,51884:23608,51885:34417,51886:21313,51887:30707,51888:25342,51889:26102,51890:20160,51891:39135,51892:34432,51893:23454,51894:35782,51895:21490,51896:30690,51897:20351,51898:23630,51899:39542,51900:22987,51901:24335,51902:31034,51903:22763,51904:19990,51905:26623,51906:20107,51907:25325,51908:35475,51909:36893,51910:21183,51911:26159,51912:21980,51913:22124,51914:36866,51915:20181,51916:20365,51917:37322,51918:39280,51919:27663,51920:24066,51921:24643,51922:23460,51923:35270,51924:35797,51925:25910,51926:25163,51927:39318,51928:23432,51929:23551,51930:25480,51931:21806,51932:21463,51933:30246,51934:20861,51935:34092,51936:26530,51937:26803,51938:27530,51939:25234,51940:36755,51941:21460,51942:33298,51943:28113,51944:30095,51945:20070,51946:36174,51947:23408,51948:29087,51949:34223,51950:26257,51951:26329,51952:32626,51953:34560,51954:40653,51955:40736,51956:23646,51957:26415,51958:36848,51959:26641,51960:26463,51961:25101,51962:31446,51963:22661,51964:24246,51965:25968,51966:28465,52032:34178,52033:34179,52034:34182,52035:34184,52036:34185,52037:34186,52038:34187,52039:34188,52040:34189,52041:34190,52042:34192,52043:34193,52044:34194,52045:34195,52046:34196,52047:34197,52048:34198,52049:34199,52050:34200,52051:34201,52052:34202,52053:34205,52054:34206,52055:34207,52056:34208,52057:34209,52058:34210,52059:34211,52060:34213,52061:34214,52062:34215,52063:34217,52064:34219,52065:34220,52066:34221,52067:34225,52068:34226,52069:34227,52070:34228,52071:34229,52072:34230,52073:34232,52074:34234,52075:34235,52076:34236,52077:34237,52078:34238,52079:34239,52080:34240,52081:34242,52082:34243,52083:34244,52084:34245,52085:34246,52086:34247,52087:34248,52088:34250,52089:34251,52090:34252,52091:34253,52092:34254,52093:34257,52094:34258,52096:34260,52097:34262,52098:34263,52099:34264,52100:34265,52101:34266,52102:34267,52103:34269,52104:34270,52105:34271,52106:34272,52107:34273,52108:34274,52109:34275,52110:34277,52111:34278,52112:34279,52113:34280,52114:34282,52115:34283,52116:34284,52117:34285,52118:34286,52119:34287,52120:34288,52121:34289,52122:34290,52123:34291,52124:34292,52125:34293,52126:34294,52127:34295,52128:34296,52129:24661,52130:21047,52131:32781,52132:25684,52133:34928,52134:29993,52135:24069,52136:26643,52137:25332,52138:38684,52139:21452,52140:29245,52141:35841,52142:27700,52143:30561,52144:31246,52145:21550,52146:30636,52147:39034,52148:33308,52149:35828,52150:30805,52151:26388,52152:28865,52153:26031,52154:25749,52155:22070,52156:24605,52157:31169,52158:21496,52159:19997,52160:27515,52161:32902,52162:23546,52163:21987,52164:22235,52165:20282,52166:20284,52167:39282,52168:24051,52169:26494,52170:32824,52171:24578,52172:39042,52173:36865,52174:23435,52175:35772,52176:35829,52177:25628,52178:33368,52179:25822,52180:22013,52181:33487,52182:37221,52183:20439,52184:32032,52185:36895,52186:31903,52187:20723,52188:22609,52189:28335,52190:23487,52191:35785,52192:32899,52193:37240,52194:33948,52195:31639,52196:34429,52197:38539,52198:38543,52199:32485,52200:39635,52201:30862,52202:23681,52203:31319,52204:36930,52205:38567,52206:31071,52207:23385,52208:25439,52209:31499,52210:34001,52211:26797,52212:21766,52213:32553,52214:29712,52215:32034,52216:38145,52217:25152,52218:22604,52219:20182,52220:23427,52221:22905,52222:22612,52288:34297,52289:34298,52290:34300,52291:34301,52292:34302,52293:34304,52294:34305,52295:34306,52296:34307,52297:34308,52298:34310,52299:34311,52300:34312,52301:34313,52302:34314,52303:34315,52304:34316,52305:34317,52306:34318,52307:34319,52308:34320,52309:34322,52310:34323,52311:34324,52312:34325,52313:34327,52314:34328,52315:34329,52316:34330,52317:34331,52318:34332,52319:34333,52320:34334,52321:34335,52322:34336,52323:34337,52324:34338,52325:34339,52326:34340,52327:34341,52328:34342,52329:34344,52330:34346,52331:34347,52332:34348,52333:34349,52334:34350,52335:34351,52336:34352,52337:34353,52338:34354,52339:34355,52340:34356,52341:34357,52342:34358,52343:34359,52344:34361,52345:34362,52346:34363,52347:34365,52348:34366,52349:34367,52350:34368,52352:34369,52353:34370,52354:34371,52355:34372,52356:34373,52357:34374,52358:34375,52359:34376,52360:34377,52361:34378,52362:34379,52363:34380,52364:34386,52365:34387,52366:34389,52367:34390,52368:34391,52369:34392,52370:34393,52371:34395,52372:34396,52373:34397,52374:34399,52375:34400,52376:34401,52377:34403,52378:34404,52379:34405,52380:34406,52381:34407,52382:34408,52383:34409,52384:34410,52385:29549,52386:25374,52387:36427,52388:36367,52389:32974,52390:33492,52391:25260,52392:21488,52393:27888,52394:37214,52395:22826,52396:24577,52397:27760,52398:22349,52399:25674,52400:36138,52401:30251,52402:28393,52403:22363,52404:27264,52405:30192,52406:28525,52407:35885,52408:35848,52409:22374,52410:27631,52411:34962,52412:30899,52413:25506,52414:21497,52415:28845,52416:27748,52417:22616,52418:25642,52419:22530,52420:26848,52421:33179,52422:21776,52423:31958,52424:20504,52425:36538,52426:28108,52427:36255,52428:28907,52429:25487,52430:28059,52431:28372,52432:32486,52433:33796,52434:26691,52435:36867,52436:28120,52437:38518,52438:35752,52439:22871,52440:29305,52441:34276,52442:33150,52443:30140,52444:35466,52445:26799,52446:21076,52447:36386,52448:38161,52449:25552,52450:39064,52451:36420,52452:21884,52453:20307,52454:26367,52455:22159,52456:24789,52457:28053,52458:21059,52459:23625,52460:22825,52461:28155,52462:22635,52463:3e4,52464:29980,52465:24684,52466:33300,52467:33094,52468:25361,52469:26465,52470:36834,52471:30522,52472:36339,52473:36148,52474:38081,52475:24086,52476:21381,52477:21548,52478:28867,52544:34413,52545:34415,52546:34416,52547:34418,52548:34419,52549:34420,52550:34421,52551:34422,52552:34423,52553:34424,52554:34435,52555:34436,52556:34437,52557:34438,52558:34439,52559:34440,52560:34441,52561:34446,52562:34447,52563:34448,52564:34449,52565:34450,52566:34452,52567:34454,52568:34455,52569:34456,52570:34457,52571:34458,52572:34459,52573:34462,52574:34463,52575:34464,52576:34465,52577:34466,52578:34469,52579:34470,52580:34475,52581:34477,52582:34478,52583:34482,52584:34483,52585:34487,52586:34488,52587:34489,52588:34491,52589:34492,52590:34493,52591:34494,52592:34495,52593:34497,52594:34498,52595:34499,52596:34501,52597:34504,52598:34508,52599:34509,52600:34514,52601:34515,52602:34517,52603:34518,52604:34519,52605:34522,52606:34524,52608:34525,52609:34528,52610:34529,52611:34530,52612:34531,52613:34533,52614:34534,52615:34535,52616:34536,52617:34538,52618:34539,52619:34540,52620:34543,52621:34549,52622:34550,52623:34551,52624:34554,52625:34555,52626:34556,52627:34557,52628:34559,52629:34561,52630:34564,52631:34565,52632:34566,52633:34571,52634:34572,52635:34574,52636:34575,52637:34576,52638:34577,52639:34580,52640:34582,52641:27712,52642:24311,52643:20572,52644:20141,52645:24237,52646:25402,52647:33351,52648:36890,52649:26704,52650:37230,52651:30643,52652:21516,52653:38108,52654:24420,52655:31461,52656:26742,52657:25413,52658:31570,52659:32479,52660:30171,52661:20599,52662:25237,52663:22836,52664:36879,52665:20984,52666:31171,52667:31361,52668:22270,52669:24466,52670:36884,52671:28034,52672:23648,52673:22303,52674:21520,52675:20820,52676:28237,52677:22242,52678:25512,52679:39059,52680:33151,52681:34581,52682:35114,52683:36864,52684:21534,52685:23663,52686:33216,52687:25302,52688:25176,52689:33073,52690:40501,52691:38464,52692:39534,52693:39548,52694:26925,52695:22949,52696:25299,52697:21822,52698:25366,52699:21703,52700:34521,52701:27964,52702:23043,52703:29926,52704:34972,52705:27498,52706:22806,52707:35916,52708:24367,52709:28286,52710:29609,52711:39037,52712:20024,52713:28919,52714:23436,52715:30871,52716:25405,52717:26202,52718:30358,52719:24779,52720:23451,52721:23113,52722:19975,52723:33109,52724:27754,52725:29579,52726:20129,52727:26505,52728:32593,52729:24448,52730:26106,52731:26395,52732:24536,52733:22916,52734:23041,52800:34585,52801:34587,52802:34589,52803:34591,52804:34592,52805:34596,52806:34598,52807:34599,52808:34600,52809:34602,52810:34603,52811:34604,52812:34605,52813:34607,52814:34608,52815:34610,52816:34611,52817:34613,52818:34614,52819:34616,52820:34617,52821:34618,52822:34620,52823:34621,52824:34624,52825:34625,52826:34626,52827:34627,52828:34628,52829:34629,52830:34630,52831:34634,52832:34635,52833:34637,52834:34639,52835:34640,52836:34641,52837:34642,52838:34644,52839:34645,52840:34646,52841:34648,52842:34650,52843:34651,52844:34652,52845:34653,52846:34654,52847:34655,52848:34657,52849:34658,52850:34662,52851:34663,52852:34664,52853:34665,52854:34666,52855:34667,52856:34668,52857:34669,52858:34671,52859:34673,52860:34674,52861:34675,52862:34677,52864:34679,52865:34680,52866:34681,52867:34682,52868:34687,52869:34688,52870:34689,52871:34692,52872:34694,52873:34695,52874:34697,52875:34698,52876:34700,52877:34702,52878:34703,52879:34704,52880:34705,52881:34706,52882:34708,52883:34709,52884:34710,52885:34712,52886:34713,52887:34714,52888:34715,52889:34716,52890:34717,52891:34718,52892:34720,52893:34721,52894:34722,52895:34723,52896:34724,52897:24013,52898:24494,52899:21361,52900:38886,52901:36829,52902:26693,52903:22260,52904:21807,52905:24799,52906:20026,52907:28493,52908:32500,52909:33479,52910:33806,52911:22996,52912:20255,52913:20266,52914:23614,52915:32428,52916:26410,52917:34074,52918:21619,52919:30031,52920:32963,52921:21890,52922:39759,52923:20301,52924:28205,52925:35859,52926:23561,52927:24944,52928:21355,52929:30239,52930:28201,52931:34442,52932:25991,52933:38395,52934:32441,52935:21563,52936:31283,52937:32010,52938:38382,52939:21985,52940:32705,52941:29934,52942:25373,52943:34583,52944:28065,52945:31389,52946:25105,52947:26017,52948:21351,52949:25569,52950:27779,52951:24043,52952:21596,52953:38056,52954:20044,52955:27745,52956:35820,52957:23627,52958:26080,52959:33436,52960:26791,52961:21566,52962:21556,52963:27595,52964:27494,52965:20116,52966:25410,52967:21320,52968:33310,52969:20237,52970:20398,52971:22366,52972:25098,52973:38654,52974:26212,52975:29289,52976:21247,52977:21153,52978:24735,52979:35823,52980:26132,52981:29081,52982:26512,52983:35199,52984:30802,52985:30717,52986:26224,52987:22075,52988:21560,52989:38177,52990:29306,53056:34725,53057:34726,53058:34727,53059:34729,53060:34730,53061:34734,53062:34736,53063:34737,53064:34738,53065:34740,53066:34742,53067:34743,53068:34744,53069:34745,53070:34747,53071:34748,53072:34750,53073:34751,53074:34753,53075:34754,53076:34755,53077:34756,53078:34757,53079:34759,53080:34760,53081:34761,53082:34764,53083:34765,53084:34766,53085:34767,53086:34768,53087:34772,53088:34773,53089:34774,53090:34775,53091:34776,53092:34777,53093:34778,53094:34780,53095:34781,53096:34782,53097:34783,53098:34785,53099:34786,53100:34787,53101:34788,53102:34790,53103:34791,53104:34792,53105:34793,53106:34795,53107:34796,53108:34797,53109:34799,53110:34800,53111:34801,53112:34802,53113:34803,53114:34804,53115:34805,53116:34806,53117:34807,53118:34808,53120:34810,53121:34811,53122:34812,53123:34813,53124:34815,53125:34816,53126:34817,53127:34818,53128:34820,53129:34821,53130:34822,53131:34823,53132:34824,53133:34825,53134:34827,53135:34828,53136:34829,53137:34830,53138:34831,53139:34832,53140:34833,53141:34834,53142:34836,53143:34839,53144:34840,53145:34841,53146:34842,53147:34844,53148:34845,53149:34846,53150:34847,53151:34848,53152:34851,53153:31232,53154:24687,53155:24076,53156:24713,53157:33181,53158:22805,53159:24796,53160:29060,53161:28911,53162:28330,53163:27728,53164:29312,53165:27268,53166:34989,53167:24109,53168:20064,53169:23219,53170:21916,53171:38115,53172:27927,53173:31995,53174:38553,53175:25103,53176:32454,53177:30606,53178:34430,53179:21283,53180:38686,53181:36758,53182:26247,53183:23777,53184:20384,53185:29421,53186:19979,53187:21414,53188:22799,53189:21523,53190:25472,53191:38184,53192:20808,53193:20185,53194:40092,53195:32420,53196:21688,53197:36132,53198:34900,53199:33335,53200:38386,53201:28046,53202:24358,53203:23244,53204:26174,53205:38505,53206:29616,53207:29486,53208:21439,53209:33146,53210:39301,53211:32673,53212:23466,53213:38519,53214:38480,53215:32447,53216:30456,53217:21410,53218:38262,53219:39321,53220:31665,53221:35140,53222:28248,53223:20065,53224:32724,53225:31077,53226:35814,53227:24819,53228:21709,53229:20139,53230:39033,53231:24055,53232:27233,53233:20687,53234:21521,53235:35937,53236:33831,53237:30813,53238:38660,53239:21066,53240:21742,53241:22179,53242:38144,53243:28040,53244:23477,53245:28102,53246:26195,53312:34852,53313:34853,53314:34854,53315:34855,53316:34856,53317:34857,53318:34858,53319:34859,53320:34860,53321:34861,53322:34862,53323:34863,53324:34864,53325:34865,53326:34867,53327:34868,53328:34869,53329:34870,53330:34871,53331:34872,53332:34874,53333:34875,53334:34877,53335:34878,53336:34879,53337:34881,53338:34882,53339:34883,53340:34886,53341:34887,53342:34888,53343:34889,53344:34890,53345:34891,53346:34894,53347:34895,53348:34896,53349:34897,53350:34898,53351:34899,53352:34901,53353:34902,53354:34904,53355:34906,53356:34907,53357:34908,53358:34909,53359:34910,53360:34911,53361:34912,53362:34918,53363:34919,53364:34922,53365:34925,53366:34927,53367:34929,53368:34931,53369:34932,53370:34933,53371:34934,53372:34936,53373:34937,53374:34938,53376:34939,53377:34940,53378:34944,53379:34947,53380:34950,53381:34951,53382:34953,53383:34954,53384:34956,53385:34958,53386:34959,53387:34960,53388:34961,53389:34963,53390:34964,53391:34965,53392:34967,53393:34968,53394:34969,53395:34970,53396:34971,53397:34973,53398:34974,53399:34975,53400:34976,53401:34977,53402:34979,53403:34981,53404:34982,53405:34983,53406:34984,53407:34985,53408:34986,53409:23567,53410:23389,53411:26657,53412:32918,53413:21880,53414:31505,53415:25928,53416:26964,53417:20123,53418:27463,53419:34638,53420:38795,53421:21327,53422:25375,53423:25658,53424:37034,53425:26012,53426:32961,53427:35856,53428:20889,53429:26800,53430:21368,53431:34809,53432:25032,53433:27844,53434:27899,53435:35874,53436:23633,53437:34218,53438:33455,53439:38156,53440:27427,53441:36763,53442:26032,53443:24571,53444:24515,53445:20449,53446:34885,53447:26143,53448:33125,53449:29481,53450:24826,53451:20852,53452:21009,53453:22411,53454:24418,53455:37026,53456:34892,53457:37266,53458:24184,53459:26447,53460:24615,53461:22995,53462:20804,53463:20982,53464:33016,53465:21256,53466:27769,53467:38596,53468:29066,53469:20241,53470:20462,53471:32670,53472:26429,53473:21957,53474:38152,53475:31168,53476:34966,53477:32483,53478:22687,53479:25100,53480:38656,53481:34394,53482:22040,53483:39035,53484:24464,53485:35768,53486:33988,53487:37207,53488:21465,53489:26093,53490:24207,53491:30044,53492:24676,53493:32110,53494:23167,53495:32490,53496:32493,53497:36713,53498:21927,53499:23459,53500:24748,53501:26059,53502:29572,53568:34988,53569:34990,53570:34991,53571:34992,53572:34994,53573:34995,53574:34996,53575:34997,53576:34998,53577:35e3,53578:35001,53579:35002,53580:35003,53581:35005,53582:35006,53583:35007,53584:35008,53585:35011,53586:35012,53587:35015,53588:35016,53589:35018,53590:35019,53591:35020,53592:35021,53593:35023,53594:35024,53595:35025,53596:35027,53597:35030,53598:35031,53599:35034,53600:35035,53601:35036,53602:35037,53603:35038,53604:35040,53605:35041,53606:35046,53607:35047,53608:35049,53609:35050,53610:35051,53611:35052,53612:35053,53613:35054,53614:35055,53615:35058,53616:35061,53617:35062,53618:35063,53619:35066,53620:35067,53621:35069,53622:35071,53623:35072,53624:35073,53625:35075,53626:35076,53627:35077,53628:35078,53629:35079,53630:35080,53632:35081,53633:35083,53634:35084,53635:35085,53636:35086,53637:35087,53638:35089,53639:35092,53640:35093,53641:35094,53642:35095,53643:35096,53644:35100,53645:35101,53646:35102,53647:35103,53648:35104,53649:35106,53650:35107,53651:35108,53652:35110,53653:35111,53654:35112,53655:35113,53656:35116,53657:35117,53658:35118,53659:35119,53660:35121,53661:35122,53662:35123,53663:35125,53664:35127,53665:36873,53666:30307,53667:30505,53668:32474,53669:38772,53670:34203,53671:23398,53672:31348,53673:38634,53674:34880,53675:21195,53676:29071,53677:24490,53678:26092,53679:35810,53680:23547,53681:39535,53682:24033,53683:27529,53684:27739,53685:35757,53686:35759,53687:36874,53688:36805,53689:21387,53690:25276,53691:40486,53692:40493,53693:21568,53694:20011,53695:33469,53696:29273,53697:34460,53698:23830,53699:34905,53700:28079,53701:38597,53702:21713,53703:20122,53704:35766,53705:28937,53706:21693,53707:38409,53708:28895,53709:28153,53710:30416,53711:20005,53712:30740,53713:34578,53714:23721,53715:24310,53716:35328,53717:39068,53718:38414,53719:28814,53720:27839,53721:22852,53722:25513,53723:30524,53724:34893,53725:28436,53726:33395,53727:22576,53728:29141,53729:21388,53730:30746,53731:38593,53732:21761,53733:24422,53734:28976,53735:23476,53736:35866,53737:39564,53738:27523,53739:22830,53740:40495,53741:31207,53742:26472,53743:25196,53744:20335,53745:30113,53746:32650,53747:27915,53748:38451,53749:27687,53750:20208,53751:30162,53752:20859,53753:26679,53754:28478,53755:36992,53756:33136,53757:22934,53758:29814,53824:35128,53825:35129,53826:35130,53827:35131,53828:35132,53829:35133,53830:35134,53831:35135,53832:35136,53833:35138,53834:35139,53835:35141,53836:35142,53837:35143,53838:35144,53839:35145,53840:35146,53841:35147,53842:35148,53843:35149,53844:35150,53845:35151,53846:35152,53847:35153,53848:35154,53849:35155,53850:35156,53851:35157,53852:35158,53853:35159,53854:35160,53855:35161,53856:35162,53857:35163,53858:35164,53859:35165,53860:35168,53861:35169,53862:35170,53863:35171,53864:35172,53865:35173,53866:35175,53867:35176,53868:35177,53869:35178,53870:35179,53871:35180,53872:35181,53873:35182,53874:35183,53875:35184,53876:35185,53877:35186,53878:35187,53879:35188,53880:35189,53881:35190,53882:35191,53883:35192,53884:35193,53885:35194,53886:35196,53888:35197,53889:35198,53890:35200,53891:35202,53892:35204,53893:35205,53894:35207,53895:35208,53896:35209,53897:35210,53898:35211,53899:35212,53900:35213,53901:35214,53902:35215,53903:35216,53904:35217,53905:35218,53906:35219,53907:35220,53908:35221,53909:35222,53910:35223,53911:35224,53912:35225,53913:35226,53914:35227,53915:35228,53916:35229,53917:35230,53918:35231,53919:35232,53920:35233,53921:25671,53922:23591,53923:36965,53924:31377,53925:35875,53926:23002,53927:21676,53928:33280,53929:33647,53930:35201,53931:32768,53932:26928,53933:22094,53934:32822,53935:29239,53936:37326,53937:20918,53938:20063,53939:39029,53940:25494,53941:19994,53942:21494,53943:26355,53944:33099,53945:22812,53946:28082,53947:19968,53948:22777,53949:21307,53950:25558,53951:38129,53952:20381,53953:20234,53954:34915,53955:39056,53956:22839,53957:36951,53958:31227,53959:20202,53960:33008,53961:30097,53962:27778,53963:23452,53964:23016,53965:24413,53966:26885,53967:34433,53968:20506,53969:24050,53970:20057,53971:30691,53972:20197,53973:33402,53974:25233,53975:26131,53976:37009,53977:23673,53978:20159,53979:24441,53980:33222,53981:36920,53982:32900,53983:30123,53984:20134,53985:35028,53986:24847,53987:27589,53988:24518,53989:20041,53990:30410,53991:28322,53992:35811,53993:35758,53994:35850,53995:35793,53996:24322,53997:32764,53998:32716,53999:32462,54e3:33589,54001:33643,54002:22240,54003:27575,54004:38899,54005:38452,54006:23035,54007:21535,54008:38134,54009:28139,54010:23493,54011:39278,54012:23609,54013:24341,54014:38544,54080:35234,54081:35235,54082:35236,54083:35237,54084:35238,54085:35239,54086:35240,54087:35241,54088:35242,54089:35243,54090:35244,54091:35245,54092:35246,54093:35247,54094:35248,54095:35249,54096:35250,54097:35251,54098:35252,54099:35253,54100:35254,54101:35255,54102:35256,54103:35257,54104:35258,54105:35259,54106:35260,54107:35261,54108:35262,54109:35263,54110:35264,54111:35267,54112:35277,54113:35283,54114:35284,54115:35285,54116:35287,54117:35288,54118:35289,54119:35291,54120:35293,54121:35295,54122:35296,54123:35297,54124:35298,54125:35300,54126:35303,54127:35304,54128:35305,54129:35306,54130:35308,54131:35309,54132:35310,54133:35312,54134:35313,54135:35314,54136:35316,54137:35317,54138:35318,54139:35319,54140:35320,54141:35321,54142:35322,54144:35323,54145:35324,54146:35325,54147:35326,54148:35327,54149:35329,54150:35330,54151:35331,54152:35332,54153:35333,54154:35334,54155:35336,54156:35337,54157:35338,54158:35339,54159:35340,54160:35341,54161:35342,54162:35343,54163:35344,54164:35345,54165:35346,54166:35347,54167:35348,54168:35349,54169:35350,54170:35351,54171:35352,54172:35353,54173:35354,54174:35355,54175:35356,54176:35357,54177:21360,54178:33521,54179:27185,54180:23156,54181:40560,54182:24212,54183:32552,54184:33721,54185:33828,54186:33829,54187:33639,54188:34631,54189:36814,54190:36194,54191:30408,54192:24433,54193:39062,54194:30828,54195:26144,54196:21727,54197:25317,54198:20323,54199:33219,54200:30152,54201:24248,54202:38605,54203:36362,54204:34553,54205:21647,54206:27891,54207:28044,54208:27704,54209:24703,54210:21191,54211:29992,54212:24189,54213:20248,54214:24736,54215:24551,54216:23588,54217:30001,54218:37038,54219:38080,54220:29369,54221:27833,54222:28216,54223:37193,54224:26377,54225:21451,54226:21491,54227:20305,54228:37321,54229:35825,54230:21448,54231:24188,54232:36802,54233:28132,54234:20110,54235:30402,54236:27014,54237:34398,54238:24858,54239:33286,54240:20313,54241:20446,54242:36926,54243:40060,54244:24841,54245:28189,54246:28180,54247:38533,54248:20104,54249:23089,54250:38632,54251:19982,54252:23679,54253:31161,54254:23431,54255:35821,54256:32701,54257:29577,54258:22495,54259:33419,54260:37057,54261:21505,54262:36935,54263:21947,54264:23786,54265:24481,54266:24840,54267:27442,54268:29425,54269:32946,54270:35465,54336:35358,54337:35359,54338:35360,54339:35361,54340:35362,54341:35363,54342:35364,54343:35365,54344:35366,54345:35367,54346:35368,54347:35369,54348:35370,54349:35371,54350:35372,54351:35373,54352:35374,54353:35375,54354:35376,54355:35377,54356:35378,54357:35379,54358:35380,54359:35381,54360:35382,54361:35383,54362:35384,54363:35385,54364:35386,54365:35387,54366:35388,54367:35389,54368:35391,54369:35392,54370:35393,54371:35394,54372:35395,54373:35396,54374:35397,54375:35398,54376:35399,54377:35401,54378:35402,54379:35403,54380:35404,54381:35405,54382:35406,54383:35407,54384:35408,54385:35409,54386:35410,54387:35411,54388:35412,54389:35413,54390:35414,54391:35415,54392:35416,54393:35417,54394:35418,54395:35419,54396:35420,54397:35421,54398:35422,54400:35423,54401:35424,54402:35425,54403:35426,54404:35427,54405:35428,54406:35429,54407:35430,54408:35431,54409:35432,54410:35433,54411:35434,54412:35435,54413:35436,54414:35437,54415:35438,54416:35439,54417:35440,54418:35441,54419:35442,54420:35443,54421:35444,54422:35445,54423:35446,54424:35447,54425:35448,54426:35450,54427:35451,54428:35452,54429:35453,54430:35454,54431:35455,54432:35456,54433:28020,54434:23507,54435:35029,54436:39044,54437:35947,54438:39533,54439:40499,54440:28170,54441:20900,54442:20803,54443:22435,54444:34945,54445:21407,54446:25588,54447:36757,54448:22253,54449:21592,54450:22278,54451:29503,54452:28304,54453:32536,54454:36828,54455:33489,54456:24895,54457:24616,54458:38498,54459:26352,54460:32422,54461:36234,54462:36291,54463:38053,54464:23731,54465:31908,54466:26376,54467:24742,54468:38405,54469:32792,54470:20113,54471:37095,54472:21248,54473:38504,54474:20801,54475:36816,54476:34164,54477:37213,54478:26197,54479:38901,54480:23381,54481:21277,54482:30776,54483:26434,54484:26685,54485:21705,54486:28798,54487:23472,54488:36733,54489:20877,54490:22312,54491:21681,54492:25874,54493:26242,54494:36190,54495:36163,54496:33039,54497:33900,54498:36973,54499:31967,54500:20991,54501:34299,54502:26531,54503:26089,54504:28577,54505:34468,54506:36481,54507:22122,54508:36896,54509:30338,54510:28790,54511:29157,54512:36131,54513:25321,54514:21017,54515:27901,54516:36156,54517:24590,54518:22686,54519:24974,54520:26366,54521:36192,54522:25166,54523:21939,54524:28195,54525:26413,54526:36711,54592:35457,54593:35458,54594:35459,54595:35460,54596:35461,54597:35462,54598:35463,54599:35464,54600:35467,54601:35468,54602:35469,54603:35470,54604:35471,54605:35472,54606:35473,54607:35474,54608:35476,54609:35477,54610:35478,54611:35479,54612:35480,54613:35481,54614:35482,54615:35483,54616:35484,54617:35485,54618:35486,54619:35487,54620:35488,54621:35489,54622:35490,54623:35491,54624:35492,54625:35493,54626:35494,54627:35495,54628:35496,54629:35497,54630:35498,54631:35499,54632:35500,54633:35501,54634:35502,54635:35503,54636:35504,54637:35505,54638:35506,54639:35507,54640:35508,54641:35509,54642:35510,54643:35511,54644:35512,54645:35513,54646:35514,54647:35515,54648:35516,54649:35517,54650:35518,54651:35519,54652:35520,54653:35521,54654:35522,54656:35523,54657:35524,54658:35525,54659:35526,54660:35527,54661:35528,54662:35529,54663:35530,54664:35531,54665:35532,54666:35533,54667:35534,54668:35535,54669:35536,54670:35537,54671:35538,54672:35539,54673:35540,54674:35541,54675:35542,54676:35543,54677:35544,54678:35545,54679:35546,54680:35547,54681:35548,54682:35549,54683:35550,54684:35551,54685:35552,54686:35553,54687:35554,54688:35555,54689:38113,54690:38392,54691:30504,54692:26629,54693:27048,54694:21643,54695:20045,54696:28856,54697:35784,54698:25688,54699:25995,54700:23429,54701:31364,54702:20538,54703:23528,54704:30651,54705:27617,54706:35449,54707:31896,54708:27838,54709:30415,54710:26025,54711:36759,54712:23853,54713:23637,54714:34360,54715:26632,54716:21344,54717:25112,54718:31449,54719:28251,54720:32509,54721:27167,54722:31456,54723:24432,54724:28467,54725:24352,54726:25484,54727:28072,54728:26454,54729:19976,54730:24080,54731:36134,54732:20183,54733:32960,54734:30260,54735:38556,54736:25307,54737:26157,54738:25214,54739:27836,54740:36213,54741:29031,54742:32617,54743:20806,54744:32903,54745:21484,54746:36974,54747:25240,54748:21746,54749:34544,54750:36761,54751:32773,54752:38167,54753:34071,54754:36825,54755:27993,54756:29645,54757:26015,54758:30495,54759:29956,54760:30759,54761:33275,54762:36126,54763:38024,54764:20390,54765:26517,54766:30137,54767:35786,54768:38663,54769:25391,54770:38215,54771:38453,54772:33976,54773:25379,54774:30529,54775:24449,54776:29424,54777:20105,54778:24596,54779:25972,54780:25327,54781:27491,54782:25919,54848:35556,54849:35557,54850:35558,54851:35559,54852:35560,54853:35561,54854:35562,54855:35563,54856:35564,54857:35565,54858:35566,54859:35567,54860:35568,54861:35569,54862:35570,54863:35571,54864:35572,54865:35573,54866:35574,54867:35575,54868:35576,54869:35577,54870:35578,54871:35579,54872:35580,54873:35581,54874:35582,54875:35583,54876:35584,54877:35585,54878:35586,54879:35587,54880:35588,54881:35589,54882:35590,54883:35592,54884:35593,54885:35594,54886:35595,54887:35596,54888:35597,54889:35598,54890:35599,54891:35600,54892:35601,54893:35602,54894:35603,54895:35604,54896:35605,54897:35606,54898:35607,54899:35608,54900:35609,54901:35610,54902:35611,54903:35612,54904:35613,54905:35614,54906:35615,54907:35616,54908:35617,54909:35618,54910:35619,54912:35620,54913:35621,54914:35623,54915:35624,54916:35625,54917:35626,54918:35627,54919:35628,54920:35629,54921:35630,54922:35631,54923:35632,54924:35633,54925:35634,54926:35635,54927:35636,54928:35637,54929:35638,54930:35639,54931:35640,54932:35641,54933:35642,54934:35643,54935:35644,54936:35645,54937:35646,54938:35647,54939:35648,54940:35649,54941:35650,54942:35651,54943:35652,54944:35653,54945:24103,54946:30151,54947:37073,54948:35777,54949:33437,54950:26525,54951:25903,54952:21553,54953:34584,54954:30693,54955:32930,54956:33026,54957:27713,54958:20043,54959:32455,54960:32844,54961:30452,54962:26893,54963:27542,54964:25191,54965:20540,54966:20356,54967:22336,54968:25351,54969:27490,54970:36286,54971:21482,54972:26088,54973:32440,54974:24535,54975:25370,54976:25527,54977:33267,54978:33268,54979:32622,54980:24092,54981:23769,54982:21046,54983:26234,54984:31209,54985:31258,54986:36136,54987:28825,54988:30164,54989:28382,54990:27835,54991:31378,54992:20013,54993:30405,54994:24544,54995:38047,54996:34935,54997:32456,54998:31181,54999:32959,55e3:37325,55001:20210,55002:20247,55003:33311,55004:21608,55005:24030,55006:27954,55007:35788,55008:31909,55009:36724,55010:32920,55011:24090,55012:21650,55013:30385,55014:23449,55015:26172,55016:39588,55017:29664,55018:26666,55019:34523,55020:26417,55021:29482,55022:35832,55023:35803,55024:36880,55025:31481,55026:28891,55027:29038,55028:25284,55029:30633,55030:22065,55031:20027,55032:33879,55033:26609,55034:21161,55035:34496,55036:36142,55037:38136,55038:31569,55104:35654,55105:35655,55106:35656,55107:35657,55108:35658,55109:35659,55110:35660,55111:35661,55112:35662,55113:35663,55114:35664,55115:35665,55116:35666,55117:35667,55118:35668,55119:35669,55120:35670,55121:35671,55122:35672,55123:35673,55124:35674,55125:35675,55126:35676,55127:35677,55128:35678,55129:35679,55130:35680,55131:35681,55132:35682,55133:35683,55134:35684,55135:35685,55136:35687,55137:35688,55138:35689,55139:35690,55140:35691,55141:35693,55142:35694,55143:35695,55144:35696,55145:35697,55146:35698,55147:35699,55148:35700,55149:35701,55150:35702,55151:35703,55152:35704,55153:35705,55154:35706,55155:35707,55156:35708,55157:35709,55158:35710,55159:35711,55160:35712,55161:35713,55162:35714,55163:35715,55164:35716,55165:35717,55166:35718,55168:35719,55169:35720,55170:35721,55171:35722,55172:35723,55173:35724,55174:35725,55175:35726,55176:35727,55177:35728,55178:35729,55179:35730,55180:35731,55181:35732,55182:35733,55183:35734,55184:35735,55185:35736,55186:35737,55187:35738,55188:35739,55189:35740,55190:35741,55191:35742,55192:35743,55193:35756,55194:35761,55195:35771,55196:35783,55197:35792,55198:35818,55199:35849,55200:35870,55201:20303,55202:27880,55203:31069,55204:39547,55205:25235,55206:29226,55207:25341,55208:19987,55209:30742,55210:36716,55211:25776,55212:36186,55213:31686,55214:26729,55215:24196,55216:35013,55217:22918,55218:25758,55219:22766,55220:29366,55221:26894,55222:38181,55223:36861,55224:36184,55225:22368,55226:32512,55227:35846,55228:20934,55229:25417,55230:25305,55231:21331,55232:26700,55233:29730,55234:33537,55235:37196,55236:21828,55237:30528,55238:28796,55239:27978,55240:20857,55241:21672,55242:36164,55243:23039,55244:28363,55245:28100,55246:23388,55247:32043,55248:20180,55249:31869,55250:28371,55251:23376,55252:33258,55253:28173,55254:23383,55255:39683,55256:26837,55257:36394,55258:23447,55259:32508,55260:24635,55261:32437,55262:37049,55263:36208,55264:22863,55265:25549,55266:31199,55267:36275,55268:21330,55269:26063,55270:31062,55271:35781,55272:38459,55273:32452,55274:38075,55275:32386,55276:22068,55277:37257,55278:26368,55279:32618,55280:23562,55281:36981,55282:26152,55283:24038,55284:20304,55285:26590,55286:20570,55287:20316,55288:22352,55289:24231,55290:59408,55291:59409,55292:59410,55293:59411,55294:59412,55360:35896,55361:35897,55362:35898,55363:35899,55364:35900,55365:35901,55366:35902,55367:35903,55368:35904,55369:35906,55370:35907,55371:35908,55372:35909,55373:35912,55374:35914,55375:35915,55376:35917,55377:35918,55378:35919,55379:35920,55380:35921,55381:35922,55382:35923,55383:35924,55384:35926,55385:35927,55386:35928,55387:35929,55388:35931,55389:35932,55390:35933,55391:35934,55392:35935,55393:35936,55394:35939,55395:35940,55396:35941,55397:35942,55398:35943,55399:35944,55400:35945,55401:35948,55402:35949,55403:35950,55404:35951,55405:35952,55406:35953,55407:35954,55408:35956,55409:35957,55410:35958,55411:35959,55412:35963,55413:35964,55414:35965,55415:35966,55416:35967,55417:35968,55418:35969,55419:35971,55420:35972,55421:35974,55422:35975,55424:35976,55425:35979,55426:35981,55427:35982,55428:35983,55429:35984,55430:35985,55431:35986,55432:35987,55433:35989,55434:35990,55435:35991,55436:35993,55437:35994,55438:35995,55439:35996,55440:35997,55441:35998,55442:35999,55443:36e3,55444:36001,55445:36002,55446:36003,55447:36004,55448:36005,55449:36006,55450:36007,55451:36008,55452:36009,55453:36010,55454:36011,55455:36012,55456:36013,55457:20109,55458:19980,55459:20800,55460:19984,55461:24319,55462:21317,55463:19989,55464:20120,55465:19998,55466:39730,55467:23404,55468:22121,55469:20008,55470:31162,55471:20031,55472:21269,55473:20039,55474:22829,55475:29243,55476:21358,55477:27664,55478:22239,55479:32996,55480:39319,55481:27603,55482:30590,55483:40727,55484:20022,55485:20127,55486:40720,55487:20060,55488:20073,55489:20115,55490:33416,55491:23387,55492:21868,55493:22031,55494:20164,55495:21389,55496:21405,55497:21411,55498:21413,55499:21422,55500:38757,55501:36189,55502:21274,55503:21493,55504:21286,55505:21294,55506:21310,55507:36188,55508:21350,55509:21347,55510:20994,55511:21e3,55512:21006,55513:21037,55514:21043,55515:21055,55516:21056,55517:21068,55518:21086,55519:21089,55520:21084,55521:33967,55522:21117,55523:21122,55524:21121,55525:21136,55526:21139,55527:20866,55528:32596,55529:20155,55530:20163,55531:20169,55532:20162,55533:20200,55534:20193,55535:20203,55536:20190,55537:20251,55538:20211,55539:20258,55540:20324,55541:20213,55542:20261,55543:20263,55544:20233,55545:20267,55546:20318,55547:20327,55548:25912,55549:20314,55550:20317,55616:36014,55617:36015,55618:36016,55619:36017,55620:36018,55621:36019,55622:36020,55623:36021,55624:36022,55625:36023,55626:36024,55627:36025,55628:36026,55629:36027,55630:36028,55631:36029,55632:36030,55633:36031,55634:36032,55635:36033,55636:36034,55637:36035,55638:36036,55639:36037,55640:36038,55641:36039,55642:36040,55643:36041,55644:36042,55645:36043,55646:36044,55647:36045,55648:36046,55649:36047,55650:36048,55651:36049,55652:36050,55653:36051,55654:36052,55655:36053,55656:36054,55657:36055,55658:36056,55659:36057,55660:36058,55661:36059,55662:36060,55663:36061,55664:36062,55665:36063,55666:36064,55667:36065,55668:36066,55669:36067,55670:36068,55671:36069,55672:36070,55673:36071,55674:36072,55675:36073,55676:36074,55677:36075,55678:36076,55680:36077,55681:36078,55682:36079,55683:36080,55684:36081,55685:36082,55686:36083,55687:36084,55688:36085,55689:36086,55690:36087,55691:36088,55692:36089,55693:36090,55694:36091,55695:36092,55696:36093,55697:36094,55698:36095,55699:36096,55700:36097,55701:36098,55702:36099,55703:36100,55704:36101,55705:36102,55706:36103,55707:36104,55708:36105,55709:36106,55710:36107,55711:36108,55712:36109,55713:20319,55714:20311,55715:20274,55716:20285,55717:20342,55718:20340,55719:20369,55720:20361,55721:20355,55722:20367,55723:20350,55724:20347,55725:20394,55726:20348,55727:20396,55728:20372,55729:20454,55730:20456,55731:20458,55732:20421,55733:20442,55734:20451,55735:20444,55736:20433,55737:20447,55738:20472,55739:20521,55740:20556,55741:20467,55742:20524,55743:20495,55744:20526,55745:20525,55746:20478,55747:20508,55748:20492,55749:20517,55750:20520,55751:20606,55752:20547,55753:20565,55754:20552,55755:20558,55756:20588,55757:20603,55758:20645,55759:20647,55760:20649,55761:20666,55762:20694,55763:20742,55764:20717,55765:20716,55766:20710,55767:20718,55768:20743,55769:20747,55770:20189,55771:27709,55772:20312,55773:20325,55774:20430,55775:40864,55776:27718,55777:31860,55778:20846,55779:24061,55780:40649,55781:39320,55782:20865,55783:22804,55784:21241,55785:21261,55786:35335,55787:21264,55788:20971,55789:22809,55790:20821,55791:20128,55792:20822,55793:20147,55794:34926,55795:34980,55796:20149,55797:33044,55798:35026,55799:31104,55800:23348,55801:34819,55802:32696,55803:20907,55804:20913,55805:20925,55806:20924,55872:36110,55873:36111,55874:36112,55875:36113,55876:36114,55877:36115,55878:36116,55879:36117,55880:36118,55881:36119,55882:36120,55883:36121,55884:36122,55885:36123,55886:36124,55887:36128,55888:36177,55889:36178,55890:36183,55891:36191,55892:36197,55893:36200,55894:36201,55895:36202,55896:36204,55897:36206,55898:36207,55899:36209,55900:36210,55901:36216,55902:36217,55903:36218,55904:36219,55905:36220,55906:36221,55907:36222,55908:36223,55909:36224,55910:36226,55911:36227,55912:36230,55913:36231,55914:36232,55915:36233,55916:36236,55917:36237,55918:36238,55919:36239,55920:36240,55921:36242,55922:36243,55923:36245,55924:36246,55925:36247,55926:36248,55927:36249,55928:36250,55929:36251,55930:36252,55931:36253,55932:36254,55933:36256,55934:36257,55936:36258,55937:36260,55938:36261,55939:36262,55940:36263,55941:36264,55942:36265,55943:36266,55944:36267,55945:36268,55946:36269,55947:36270,55948:36271,55949:36272,55950:36274,55951:36278,55952:36279,55953:36281,55954:36283,55955:36285,55956:36288,55957:36289,55958:36290,55959:36293,55960:36295,55961:36296,55962:36297,55963:36298,55964:36301,55965:36304,55966:36306,55967:36307,55968:36308,55969:20935,55970:20886,55971:20898,55972:20901,55973:35744,55974:35750,55975:35751,55976:35754,55977:35764,55978:35765,55979:35767,55980:35778,55981:35779,55982:35787,55983:35791,55984:35790,55985:35794,55986:35795,55987:35796,55988:35798,55989:35800,55990:35801,55991:35804,55992:35807,55993:35808,55994:35812,55995:35816,55996:35817,55997:35822,55998:35824,55999:35827,56e3:35830,56001:35833,56002:35836,56003:35839,56004:35840,56005:35842,56006:35844,56007:35847,56008:35852,56009:35855,56010:35857,56011:35858,56012:35860,56013:35861,56014:35862,56015:35865,56016:35867,56017:35864,56018:35869,56019:35871,56020:35872,56021:35873,56022:35877,56023:35879,56024:35882,56025:35883,56026:35886,56027:35887,56028:35890,56029:35891,56030:35893,56031:35894,56032:21353,56033:21370,56034:38429,56035:38434,56036:38433,56037:38449,56038:38442,56039:38461,56040:38460,56041:38466,56042:38473,56043:38484,56044:38495,56045:38503,56046:38508,56047:38514,56048:38516,56049:38536,56050:38541,56051:38551,56052:38576,56053:37015,56054:37019,56055:37021,56056:37017,56057:37036,56058:37025,56059:37044,56060:37043,56061:37046,56062:37050,56128:36309,56129:36312,56130:36313,56131:36316,56132:36320,56133:36321,56134:36322,56135:36325,56136:36326,56137:36327,56138:36329,56139:36333,56140:36334,56141:36336,56142:36337,56143:36338,56144:36340,56145:36342,56146:36348,56147:36350,56148:36351,56149:36352,56150:36353,56151:36354,56152:36355,56153:36356,56154:36358,56155:36359,56156:36360,56157:36363,56158:36365,56159:36366,56160:36368,56161:36369,56162:36370,56163:36371,56164:36373,56165:36374,56166:36375,56167:36376,56168:36377,56169:36378,56170:36379,56171:36380,56172:36384,56173:36385,56174:36388,56175:36389,56176:36390,56177:36391,56178:36392,56179:36395,56180:36397,56181:36400,56182:36402,56183:36403,56184:36404,56185:36406,56186:36407,56187:36408,56188:36411,56189:36412,56190:36414,56192:36415,56193:36419,56194:36421,56195:36422,56196:36428,56197:36429,56198:36430,56199:36431,56200:36432,56201:36435,56202:36436,56203:36437,56204:36438,56205:36439,56206:36440,56207:36442,56208:36443,56209:36444,56210:36445,56211:36446,56212:36447,56213:36448,56214:36449,56215:36450,56216:36451,56217:36452,56218:36453,56219:36455,56220:36456,56221:36458,56222:36459,56223:36462,56224:36465,56225:37048,56226:37040,56227:37071,56228:37061,56229:37054,56230:37072,56231:37060,56232:37063,56233:37075,56234:37094,56235:37090,56236:37084,56237:37079,56238:37083,56239:37099,56240:37103,56241:37118,56242:37124,56243:37154,56244:37150,56245:37155,56246:37169,56247:37167,56248:37177,56249:37187,56250:37190,56251:21005,56252:22850,56253:21154,56254:21164,56255:21165,56256:21182,56257:21759,56258:21200,56259:21206,56260:21232,56261:21471,56262:29166,56263:30669,56264:24308,56265:20981,56266:20988,56267:39727,56268:21430,56269:24321,56270:30042,56271:24047,56272:22348,56273:22441,56274:22433,56275:22654,56276:22716,56277:22725,56278:22737,56279:22313,56280:22316,56281:22314,56282:22323,56283:22329,56284:22318,56285:22319,56286:22364,56287:22331,56288:22338,56289:22377,56290:22405,56291:22379,56292:22406,56293:22396,56294:22395,56295:22376,56296:22381,56297:22390,56298:22387,56299:22445,56300:22436,56301:22412,56302:22450,56303:22479,56304:22439,56305:22452,56306:22419,56307:22432,56308:22485,56309:22488,56310:22490,56311:22489,56312:22482,56313:22456,56314:22516,56315:22511,56316:22520,56317:22500,56318:22493,56384:36467,56385:36469,56386:36471,56387:36472,56388:36473,56389:36474,56390:36475,56391:36477,56392:36478,56393:36480,56394:36482,56395:36483,56396:36484,56397:36486,56398:36488,56399:36489,56400:36490,56401:36491,56402:36492,56403:36493,56404:36494,56405:36497,56406:36498,56407:36499,56408:36501,56409:36502,56410:36503,56411:36504,56412:36505,56413:36506,56414:36507,56415:36509,56416:36511,56417:36512,56418:36513,56419:36514,56420:36515,56421:36516,56422:36517,56423:36518,56424:36519,56425:36520,56426:36521,56427:36522,56428:36525,56429:36526,56430:36528,56431:36529,56432:36531,56433:36532,56434:36533,56435:36534,56436:36535,56437:36536,56438:36537,56439:36539,56440:36540,56441:36541,56442:36542,56443:36543,56444:36544,56445:36545,56446:36546,56448:36547,56449:36548,56450:36549,56451:36550,56452:36551,56453:36552,56454:36553,56455:36554,56456:36555,56457:36556,56458:36557,56459:36559,56460:36560,56461:36561,56462:36562,56463:36563,56464:36564,56465:36565,56466:36566,56467:36567,56468:36568,56469:36569,56470:36570,56471:36571,56472:36572,56473:36573,56474:36574,56475:36575,56476:36576,56477:36577,56478:36578,56479:36579,56480:36580,56481:22539,56482:22541,56483:22525,56484:22509,56485:22528,56486:22558,56487:22553,56488:22596,56489:22560,56490:22629,56491:22636,56492:22657,56493:22665,56494:22682,56495:22656,56496:39336,56497:40729,56498:25087,56499:33401,56500:33405,56501:33407,56502:33423,56503:33418,56504:33448,56505:33412,56506:33422,56507:33425,56508:33431,56509:33433,56510:33451,56511:33464,56512:33470,56513:33456,56514:33480,56515:33482,56516:33507,56517:33432,56518:33463,56519:33454,56520:33483,56521:33484,56522:33473,56523:33449,56524:33460,56525:33441,56526:33450,56527:33439,56528:33476,56529:33486,56530:33444,56531:33505,56532:33545,56533:33527,56534:33508,56535:33551,56536:33543,56537:33500,56538:33524,56539:33490,56540:33496,56541:33548,56542:33531,56543:33491,56544:33553,56545:33562,56546:33542,56547:33556,56548:33557,56549:33504,56550:33493,56551:33564,56552:33617,56553:33627,56554:33628,56555:33544,56556:33682,56557:33596,56558:33588,56559:33585,56560:33691,56561:33630,56562:33583,56563:33615,56564:33607,56565:33603,56566:33631,56567:33600,56568:33559,56569:33632,56570:33581,56571:33594,56572:33587,56573:33638,56574:33637,56640:36581,56641:36582,56642:36583,56643:36584,56644:36585,56645:36586,56646:36587,56647:36588,56648:36589,56649:36590,56650:36591,56651:36592,56652:36593,56653:36594,56654:36595,56655:36596,56656:36597,56657:36598,56658:36599,56659:36600,56660:36601,56661:36602,56662:36603,56663:36604,56664:36605,56665:36606,56666:36607,56667:36608,56668:36609,56669:36610,56670:36611,56671:36612,56672:36613,56673:36614,56674:36615,56675:36616,56676:36617,56677:36618,56678:36619,56679:36620,56680:36621,56681:36622,56682:36623,56683:36624,56684:36625,56685:36626,56686:36627,56687:36628,56688:36629,56689:36630,56690:36631,56691:36632,56692:36633,56693:36634,56694:36635,56695:36636,56696:36637,56697:36638,56698:36639,56699:36640,56700:36641,56701:36642,56702:36643,56704:36644,56705:36645,56706:36646,56707:36647,56708:36648,56709:36649,56710:36650,56711:36651,56712:36652,56713:36653,56714:36654,56715:36655,56716:36656,56717:36657,56718:36658,56719:36659,56720:36660,56721:36661,56722:36662,56723:36663,56724:36664,56725:36665,56726:36666,56727:36667,56728:36668,56729:36669,56730:36670,56731:36671,56732:36672,56733:36673,56734:36674,56735:36675,56736:36676,56737:33640,56738:33563,56739:33641,56740:33644,56741:33642,56742:33645,56743:33646,56744:33712,56745:33656,56746:33715,56747:33716,56748:33696,56749:33706,56750:33683,56751:33692,56752:33669,56753:33660,56754:33718,56755:33705,56756:33661,56757:33720,56758:33659,56759:33688,56760:33694,56761:33704,56762:33722,56763:33724,56764:33729,56765:33793,56766:33765,56767:33752,56768:22535,56769:33816,56770:33803,56771:33757,56772:33789,56773:33750,56774:33820,56775:33848,56776:33809,56777:33798,56778:33748,56779:33759,56780:33807,56781:33795,56782:33784,56783:33785,56784:33770,56785:33733,56786:33728,56787:33830,56788:33776,56789:33761,56790:33884,56791:33873,56792:33882,56793:33881,56794:33907,56795:33927,56796:33928,56797:33914,56798:33929,56799:33912,56800:33852,56801:33862,56802:33897,56803:33910,56804:33932,56805:33934,56806:33841,56807:33901,56808:33985,56809:33997,56810:34e3,56811:34022,56812:33981,56813:34003,56814:33994,56815:33983,56816:33978,56817:34016,56818:33953,56819:33977,56820:33972,56821:33943,56822:34021,56823:34019,56824:34060,56825:29965,56826:34104,56827:34032,56828:34105,56829:34079,56830:34106,56896:36677,56897:36678,56898:36679,56899:36680,56900:36681,56901:36682,56902:36683,56903:36684,56904:36685,56905:36686,56906:36687,56907:36688,56908:36689,56909:36690,56910:36691,56911:36692,56912:36693,56913:36694,56914:36695,56915:36696,56916:36697,56917:36698,56918:36699,56919:36700,56920:36701,56921:36702,56922:36703,56923:36704,56924:36705,56925:36706,56926:36707,56927:36708,56928:36709,56929:36714,56930:36736,56931:36748,56932:36754,56933:36765,56934:36768,56935:36769,56936:36770,56937:36772,56938:36773,56939:36774,56940:36775,56941:36778,56942:36780,56943:36781,56944:36782,56945:36783,56946:36786,56947:36787,56948:36788,56949:36789,56950:36791,56951:36792,56952:36794,56953:36795,56954:36796,56955:36799,56956:36800,56957:36803,56958:36806,56960:36809,56961:36810,56962:36811,56963:36812,56964:36813,56965:36815,56966:36818,56967:36822,56968:36823,56969:36826,56970:36832,56971:36833,56972:36835,56973:36839,56974:36844,56975:36847,56976:36849,56977:36850,56978:36852,56979:36853,56980:36854,56981:36858,56982:36859,56983:36860,56984:36862,56985:36863,56986:36871,56987:36872,56988:36876,56989:36878,56990:36883,56991:36885,56992:36888,56993:34134,56994:34107,56995:34047,56996:34044,56997:34137,56998:34120,56999:34152,57e3:34148,57001:34142,57002:34170,57003:30626,57004:34115,57005:34162,57006:34171,57007:34212,57008:34216,57009:34183,57010:34191,57011:34169,57012:34222,57013:34204,57014:34181,57015:34233,57016:34231,57017:34224,57018:34259,57019:34241,57020:34268,57021:34303,57022:34343,57023:34309,57024:34345,57025:34326,57026:34364,57027:24318,57028:24328,57029:22844,57030:22849,57031:32823,57032:22869,57033:22874,57034:22872,57035:21263,57036:23586,57037:23589,57038:23596,57039:23604,57040:25164,57041:25194,57042:25247,57043:25275,57044:25290,57045:25306,57046:25303,57047:25326,57048:25378,57049:25334,57050:25401,57051:25419,57052:25411,57053:25517,57054:25590,57055:25457,57056:25466,57057:25486,57058:25524,57059:25453,57060:25516,57061:25482,57062:25449,57063:25518,57064:25532,57065:25586,57066:25592,57067:25568,57068:25599,57069:25540,57070:25566,57071:25550,57072:25682,57073:25542,57074:25534,57075:25669,57076:25665,57077:25611,57078:25627,57079:25632,57080:25612,57081:25638,57082:25633,57083:25694,57084:25732,57085:25709,57086:25750,57152:36889,57153:36892,57154:36899,57155:36900,57156:36901,57157:36903,57158:36904,57159:36905,57160:36906,57161:36907,57162:36908,57163:36912,57164:36913,57165:36914,57166:36915,57167:36916,57168:36919,57169:36921,57170:36922,57171:36925,57172:36927,57173:36928,57174:36931,57175:36933,57176:36934,57177:36936,57178:36937,57179:36938,57180:36939,57181:36940,57182:36942,57183:36948,57184:36949,57185:36950,57186:36953,57187:36954,57188:36956,57189:36957,57190:36958,57191:36959,57192:36960,57193:36961,57194:36964,57195:36966,57196:36967,57197:36969,57198:36970,57199:36971,57200:36972,57201:36975,57202:36976,57203:36977,57204:36978,57205:36979,57206:36982,57207:36983,57208:36984,57209:36985,57210:36986,57211:36987,57212:36988,57213:36990,57214:36993,57216:36996,57217:36997,57218:36998,57219:36999,57220:37001,57221:37002,57222:37004,57223:37005,57224:37006,57225:37007,57226:37008,57227:37010,57228:37012,57229:37014,57230:37016,57231:37018,57232:37020,57233:37022,57234:37023,57235:37024,57236:37028,57237:37029,57238:37031,57239:37032,57240:37033,57241:37035,57242:37037,57243:37042,57244:37047,57245:37052,57246:37053,57247:37055,57248:37056,57249:25722,57250:25783,57251:25784,57252:25753,57253:25786,57254:25792,57255:25808,57256:25815,57257:25828,57258:25826,57259:25865,57260:25893,57261:25902,57262:24331,57263:24530,57264:29977,57265:24337,57266:21343,57267:21489,57268:21501,57269:21481,57270:21480,57271:21499,57272:21522,57273:21526,57274:21510,57275:21579,57276:21586,57277:21587,57278:21588,57279:21590,57280:21571,57281:21537,57282:21591,57283:21593,57284:21539,57285:21554,57286:21634,57287:21652,57288:21623,57289:21617,57290:21604,57291:21658,57292:21659,57293:21636,57294:21622,57295:21606,57296:21661,57297:21712,57298:21677,57299:21698,57300:21684,57301:21714,57302:21671,57303:21670,57304:21715,57305:21716,57306:21618,57307:21667,57308:21717,57309:21691,57310:21695,57311:21708,57312:21721,57313:21722,57314:21724,57315:21673,57316:21674,57317:21668,57318:21725,57319:21711,57320:21726,57321:21787,57322:21735,57323:21792,57324:21757,57325:21780,57326:21747,57327:21794,57328:21795,57329:21775,57330:21777,57331:21799,57332:21802,57333:21863,57334:21903,57335:21941,57336:21833,57337:21869,57338:21825,57339:21845,57340:21823,57341:21840,57342:21820,57408:37058,57409:37059,57410:37062,57411:37064,57412:37065,57413:37067,57414:37068,57415:37069,57416:37074,57417:37076,57418:37077,57419:37078,57420:37080,57421:37081,57422:37082,57423:37086,57424:37087,57425:37088,57426:37091,57427:37092,57428:37093,57429:37097,57430:37098,57431:37100,57432:37102,57433:37104,57434:37105,57435:37106,57436:37107,57437:37109,57438:37110,57439:37111,57440:37113,57441:37114,57442:37115,57443:37116,57444:37119,57445:37120,57446:37121,57447:37123,57448:37125,57449:37126,57450:37127,57451:37128,57452:37129,57453:37130,57454:37131,57455:37132,57456:37133,57457:37134,57458:37135,57459:37136,57460:37137,57461:37138,57462:37139,57463:37140,57464:37141,57465:37142,57466:37143,57467:37144,57468:37146,57469:37147,57470:37148,57472:37149,57473:37151,57474:37152,57475:37153,57476:37156,57477:37157,57478:37158,57479:37159,57480:37160,57481:37161,57482:37162,57483:37163,57484:37164,57485:37165,57486:37166,57487:37168,57488:37170,57489:37171,57490:37172,57491:37173,57492:37174,57493:37175,57494:37176,57495:37178,57496:37179,57497:37180,57498:37181,57499:37182,57500:37183,57501:37184,57502:37185,57503:37186,57504:37188,57505:21815,57506:21846,57507:21877,57508:21878,57509:21879,57510:21811,57511:21808,57512:21852,57513:21899,57514:21970,57515:21891,57516:21937,57517:21945,57518:21896,57519:21889,57520:21919,57521:21886,57522:21974,57523:21905,57524:21883,57525:21983,57526:21949,57527:21950,57528:21908,57529:21913,57530:21994,57531:22007,57532:21961,57533:22047,57534:21969,57535:21995,57536:21996,57537:21972,57538:21990,57539:21981,57540:21956,57541:21999,57542:21989,57543:22002,57544:22003,57545:21964,57546:21965,57547:21992,57548:22005,57549:21988,57550:36756,57551:22046,57552:22024,57553:22028,57554:22017,57555:22052,57556:22051,57557:22014,57558:22016,57559:22055,57560:22061,57561:22104,57562:22073,57563:22103,57564:22060,57565:22093,57566:22114,57567:22105,57568:22108,57569:22092,57570:22100,57571:22150,57572:22116,57573:22129,57574:22123,57575:22139,57576:22140,57577:22149,57578:22163,57579:22191,57580:22228,57581:22231,57582:22237,57583:22241,57584:22261,57585:22251,57586:22265,57587:22271,57588:22276,57589:22282,57590:22281,57591:22300,57592:24079,57593:24089,57594:24084,57595:24081,57596:24113,57597:24123,57598:24124,57664:37189,57665:37191,57666:37192,57667:37201,57668:37203,57669:37204,57670:37205,57671:37206,57672:37208,57673:37209,57674:37211,57675:37212,57676:37215,57677:37216,57678:37222,57679:37223,57680:37224,57681:37227,57682:37229,57683:37235,57684:37242,57685:37243,57686:37244,57687:37248,57688:37249,57689:37250,57690:37251,57691:37252,57692:37254,57693:37256,57694:37258,57695:37262,57696:37263,57697:37267,57698:37268,57699:37269,57700:37270,57701:37271,57702:37272,57703:37273,57704:37276,57705:37277,57706:37278,57707:37279,57708:37280,57709:37281,57710:37284,57711:37285,57712:37286,57713:37287,57714:37288,57715:37289,57716:37291,57717:37292,57718:37296,57719:37297,57720:37298,57721:37299,57722:37302,57723:37303,57724:37304,57725:37305,57726:37307,57728:37308,57729:37309,57730:37310,57731:37311,57732:37312,57733:37313,57734:37314,57735:37315,57736:37316,57737:37317,57738:37318,57739:37320,57740:37323,57741:37328,57742:37330,57743:37331,57744:37332,57745:37333,57746:37334,57747:37335,57748:37336,57749:37337,57750:37338,57751:37339,57752:37341,57753:37342,57754:37343,57755:37344,57756:37345,57757:37346,57758:37347,57759:37348,57760:37349,57761:24119,57762:24132,57763:24148,57764:24155,57765:24158,57766:24161,57767:23692,57768:23674,57769:23693,57770:23696,57771:23702,57772:23688,57773:23704,57774:23705,57775:23697,57776:23706,57777:23708,57778:23733,57779:23714,57780:23741,57781:23724,57782:23723,57783:23729,57784:23715,57785:23745,57786:23735,57787:23748,57788:23762,57789:23780,57790:23755,57791:23781,57792:23810,57793:23811,57794:23847,57795:23846,57796:23854,57797:23844,57798:23838,57799:23814,57800:23835,57801:23896,57802:23870,57803:23860,57804:23869,57805:23916,57806:23899,57807:23919,57808:23901,57809:23915,57810:23883,57811:23882,57812:23913,57813:23924,57814:23938,57815:23961,57816:23965,57817:35955,57818:23991,57819:24005,57820:24435,57821:24439,57822:24450,57823:24455,57824:24457,57825:24460,57826:24469,57827:24473,57828:24476,57829:24488,57830:24493,57831:24501,57832:24508,57833:34914,57834:24417,57835:29357,57836:29360,57837:29364,57838:29367,57839:29368,57840:29379,57841:29377,57842:29390,57843:29389,57844:29394,57845:29416,57846:29423,57847:29417,57848:29426,57849:29428,57850:29431,57851:29441,57852:29427,57853:29443,57854:29434,57920:37350,57921:37351,57922:37352,57923:37353,57924:37354,57925:37355,57926:37356,57927:37357,57928:37358,57929:37359,57930:37360,57931:37361,57932:37362,57933:37363,57934:37364,57935:37365,57936:37366,57937:37367,57938:37368,57939:37369,57940:37370,57941:37371,57942:37372,57943:37373,57944:37374,57945:37375,57946:37376,57947:37377,57948:37378,57949:37379,57950:37380,57951:37381,57952:37382,57953:37383,57954:37384,57955:37385,57956:37386,57957:37387,57958:37388,57959:37389,57960:37390,57961:37391,57962:37392,57963:37393,57964:37394,57965:37395,57966:37396,57967:37397,57968:37398,57969:37399,57970:37400,57971:37401,57972:37402,57973:37403,57974:37404,57975:37405,57976:37406,57977:37407,57978:37408,57979:37409,57980:37410,57981:37411,57982:37412,57984:37413,57985:37414,57986:37415,57987:37416,57988:37417,57989:37418,57990:37419,57991:37420,57992:37421,57993:37422,57994:37423,57995:37424,57996:37425,57997:37426,57998:37427,57999:37428,58e3:37429,58001:37430,58002:37431,58003:37432,58004:37433,58005:37434,58006:37435,58007:37436,58008:37437,58009:37438,58010:37439,58011:37440,58012:37441,58013:37442,58014:37443,58015:37444,58016:37445,58017:29435,58018:29463,58019:29459,58020:29473,58021:29450,58022:29470,58023:29469,58024:29461,58025:29474,58026:29497,58027:29477,58028:29484,58029:29496,58030:29489,58031:29520,58032:29517,58033:29527,58034:29536,58035:29548,58036:29551,58037:29566,58038:33307,58039:22821,58040:39143,58041:22820,58042:22786,58043:39267,58044:39271,58045:39272,58046:39273,58047:39274,58048:39275,58049:39276,58050:39284,58051:39287,58052:39293,58053:39296,58054:39300,58055:39303,58056:39306,58057:39309,58058:39312,58059:39313,58060:39315,58061:39316,58062:39317,58063:24192,58064:24209,58065:24203,58066:24214,58067:24229,58068:24224,58069:24249,58070:24245,58071:24254,58072:24243,58073:36179,58074:24274,58075:24273,58076:24283,58077:24296,58078:24298,58079:33210,58080:24516,58081:24521,58082:24534,58083:24527,58084:24579,58085:24558,58086:24580,58087:24545,58088:24548,58089:24574,58090:24581,58091:24582,58092:24554,58093:24557,58094:24568,58095:24601,58096:24629,58097:24614,58098:24603,58099:24591,58100:24589,58101:24617,58102:24619,58103:24586,58104:24639,58105:24609,58106:24696,58107:24697,58108:24699,58109:24698,58110:24642,58176:37446,58177:37447,58178:37448,58179:37449,58180:37450,58181:37451,58182:37452,58183:37453,58184:37454,58185:37455,58186:37456,58187:37457,58188:37458,58189:37459,58190:37460,58191:37461,58192:37462,58193:37463,58194:37464,58195:37465,58196:37466,58197:37467,58198:37468,58199:37469,58200:37470,58201:37471,58202:37472,58203:37473,58204:37474,58205:37475,58206:37476,58207:37477,58208:37478,58209:37479,58210:37480,58211:37481,58212:37482,58213:37483,58214:37484,58215:37485,58216:37486,58217:37487,58218:37488,58219:37489,58220:37490,58221:37491,58222:37493,58223:37494,58224:37495,58225:37496,58226:37497,58227:37498,58228:37499,58229:37500,58230:37501,58231:37502,58232:37503,58233:37504,58234:37505,58235:37506,58236:37507,58237:37508,58238:37509,58240:37510,58241:37511,58242:37512,58243:37513,58244:37514,58245:37515,58246:37516,58247:37517,58248:37519,58249:37520,58250:37521,58251:37522,58252:37523,58253:37524,58254:37525,58255:37526,58256:37527,58257:37528,58258:37529,58259:37530,58260:37531,58261:37532,58262:37533,58263:37534,58264:37535,58265:37536,58266:37537,58267:37538,58268:37539,58269:37540,58270:37541,58271:37542,58272:37543,58273:24682,58274:24701,58275:24726,58276:24730,58277:24749,58278:24733,58279:24707,58280:24722,58281:24716,58282:24731,58283:24812,58284:24763,58285:24753,58286:24797,58287:24792,58288:24774,58289:24794,58290:24756,58291:24864,58292:24870,58293:24853,58294:24867,58295:24820,58296:24832,58297:24846,58298:24875,58299:24906,58300:24949,58301:25004,58302:24980,58303:24999,58304:25015,58305:25044,58306:25077,58307:24541,58308:38579,58309:38377,58310:38379,58311:38385,58312:38387,58313:38389,58314:38390,58315:38396,58316:38398,58317:38403,58318:38404,58319:38406,58320:38408,58321:38410,58322:38411,58323:38412,58324:38413,58325:38415,58326:38418,58327:38421,58328:38422,58329:38423,58330:38425,58331:38426,58332:20012,58333:29247,58334:25109,58335:27701,58336:27732,58337:27740,58338:27722,58339:27811,58340:27781,58341:27792,58342:27796,58343:27788,58344:27752,58345:27753,58346:27764,58347:27766,58348:27782,58349:27817,58350:27856,58351:27860,58352:27821,58353:27895,58354:27896,58355:27889,58356:27863,58357:27826,58358:27872,58359:27862,58360:27898,58361:27883,58362:27886,58363:27825,58364:27859,58365:27887,58366:27902,58432:37544,58433:37545,58434:37546,58435:37547,58436:37548,58437:37549,58438:37551,58439:37552,58440:37553,58441:37554,58442:37555,58443:37556,58444:37557,58445:37558,58446:37559,58447:37560,58448:37561,58449:37562,58450:37563,58451:37564,58452:37565,58453:37566,58454:37567,58455:37568,58456:37569,58457:37570,58458:37571,58459:37572,58460:37573,58461:37574,58462:37575,58463:37577,58464:37578,58465:37579,58466:37580,58467:37581,58468:37582,58469:37583,58470:37584,58471:37585,58472:37586,58473:37587,58474:37588,58475:37589,58476:37590,58477:37591,58478:37592,58479:37593,58480:37594,58481:37595,58482:37596,58483:37597,58484:37598,58485:37599,58486:37600,58487:37601,58488:37602,58489:37603,58490:37604,58491:37605,58492:37606,58493:37607,58494:37608,58496:37609,58497:37610,58498:37611,58499:37612,58500:37613,58501:37614,58502:37615,58503:37616,58504:37617,58505:37618,58506:37619,58507:37620,58508:37621,58509:37622,58510:37623,58511:37624,58512:37625,58513:37626,58514:37627,58515:37628,58516:37629,58517:37630,58518:37631,58519:37632,58520:37633,58521:37634,58522:37635,58523:37636,58524:37637,58525:37638,58526:37639,58527:37640,58528:37641,58529:27961,58530:27943,58531:27916,58532:27971,58533:27976,58534:27911,58535:27908,58536:27929,58537:27918,58538:27947,58539:27981,58540:27950,58541:27957,58542:27930,58543:27983,58544:27986,58545:27988,58546:27955,58547:28049,58548:28015,58549:28062,58550:28064,58551:27998,58552:28051,58553:28052,58554:27996,58555:28e3,58556:28028,58557:28003,58558:28186,58559:28103,58560:28101,58561:28126,58562:28174,58563:28095,58564:28128,58565:28177,58566:28134,58567:28125,58568:28121,58569:28182,58570:28075,58571:28172,58572:28078,58573:28203,58574:28270,58575:28238,58576:28267,58577:28338,58578:28255,58579:28294,58580:28243,58581:28244,58582:28210,58583:28197,58584:28228,58585:28383,58586:28337,58587:28312,58588:28384,58589:28461,58590:28386,58591:28325,58592:28327,58593:28349,58594:28347,58595:28343,58596:28375,58597:28340,58598:28367,58599:28303,58600:28354,58601:28319,58602:28514,58603:28486,58604:28487,58605:28452,58606:28437,58607:28409,58608:28463,58609:28470,58610:28491,58611:28532,58612:28458,58613:28425,58614:28457,58615:28553,58616:28557,58617:28556,58618:28536,58619:28530,58620:28540,58621:28538,58622:28625,58688:37642,58689:37643,58690:37644,58691:37645,58692:37646,58693:37647,58694:37648,58695:37649,58696:37650,58697:37651,58698:37652,58699:37653,58700:37654,58701:37655,58702:37656,58703:37657,58704:37658,58705:37659,58706:37660,58707:37661,58708:37662,58709:37663,58710:37664,58711:37665,58712:37666,58713:37667,58714:37668,58715:37669,58716:37670,58717:37671,58718:37672,58719:37673,58720:37674,58721:37675,58722:37676,58723:37677,58724:37678,58725:37679,58726:37680,58727:37681,58728:37682,58729:37683,58730:37684,58731:37685,58732:37686,58733:37687,58734:37688,58735:37689,58736:37690,58737:37691,58738:37692,58739:37693,58740:37695,58741:37696,58742:37697,58743:37698,58744:37699,58745:37700,58746:37701,58747:37702,58748:37703,58749:37704,58750:37705,58752:37706,58753:37707,58754:37708,58755:37709,58756:37710,58757:37711,58758:37712,58759:37713,58760:37714,58761:37715,58762:37716,58763:37717,58764:37718,58765:37719,58766:37720,58767:37721,58768:37722,58769:37723,58770:37724,58771:37725,58772:37726,58773:37727,58774:37728,58775:37729,58776:37730,58777:37731,58778:37732,58779:37733,58780:37734,58781:37735,58782:37736,58783:37737,58784:37739,58785:28617,58786:28583,58787:28601,58788:28598,58789:28610,58790:28641,58791:28654,58792:28638,58793:28640,58794:28655,58795:28698,58796:28707,58797:28699,58798:28729,58799:28725,58800:28751,58801:28766,58802:23424,58803:23428,58804:23445,58805:23443,58806:23461,58807:23480,58808:29999,58809:39582,58810:25652,58811:23524,58812:23534,58813:35120,58814:23536,58815:36423,58816:35591,58817:36790,58818:36819,58819:36821,58820:36837,58821:36846,58822:36836,58823:36841,58824:36838,58825:36851,58826:36840,58827:36869,58828:36868,58829:36875,58830:36902,58831:36881,58832:36877,58833:36886,58834:36897,58835:36917,58836:36918,58837:36909,58838:36911,58839:36932,58840:36945,58841:36946,58842:36944,58843:36968,58844:36952,58845:36962,58846:36955,58847:26297,58848:36980,58849:36989,58850:36994,58851:37e3,58852:36995,58853:37003,58854:24400,58855:24407,58856:24406,58857:24408,58858:23611,58859:21675,58860:23632,58861:23641,58862:23409,58863:23651,58864:23654,58865:32700,58866:24362,58867:24361,58868:24365,58869:33396,58870:24380,58871:39739,58872:23662,58873:22913,58874:22915,58875:22925,58876:22953,58877:22954,58878:22947,58944:37740,58945:37741,58946:37742,58947:37743,58948:37744,58949:37745,58950:37746,58951:37747,58952:37748,58953:37749,58954:37750,58955:37751,58956:37752,58957:37753,58958:37754,58959:37755,58960:37756,58961:37757,58962:37758,58963:37759,58964:37760,58965:37761,58966:37762,58967:37763,58968:37764,58969:37765,58970:37766,58971:37767,58972:37768,58973:37769,58974:37770,58975:37771,58976:37772,58977:37773,58978:37774,58979:37776,58980:37777,58981:37778,58982:37779,58983:37780,58984:37781,58985:37782,58986:37783,58987:37784,58988:37785,58989:37786,58990:37787,58991:37788,58992:37789,58993:37790,58994:37791,58995:37792,58996:37793,58997:37794,58998:37795,58999:37796,59e3:37797,59001:37798,59002:37799,59003:37800,59004:37801,59005:37802,59006:37803,59008:37804,59009:37805,59010:37806,59011:37807,59012:37808,59013:37809,59014:37810,59015:37811,59016:37812,59017:37813,59018:37814,59019:37815,59020:37816,59021:37817,59022:37818,59023:37819,59024:37820,59025:37821,59026:37822,59027:37823,59028:37824,59029:37825,59030:37826,59031:37827,59032:37828,59033:37829,59034:37830,59035:37831,59036:37832,59037:37833,59038:37835,59039:37836,59040:37837,59041:22935,59042:22986,59043:22955,59044:22942,59045:22948,59046:22994,59047:22962,59048:22959,59049:22999,59050:22974,59051:23045,59052:23046,59053:23005,59054:23048,59055:23011,59056:23e3,59057:23033,59058:23052,59059:23049,59060:23090,59061:23092,59062:23057,59063:23075,59064:23059,59065:23104,59066:23143,59067:23114,59068:23125,59069:23100,59070:23138,59071:23157,59072:33004,59073:23210,59074:23195,59075:23159,59076:23162,59077:23230,59078:23275,59079:23218,59080:23250,59081:23252,59082:23224,59083:23264,59084:23267,59085:23281,59086:23254,59087:23270,59088:23256,59089:23260,59090:23305,59091:23319,59092:23318,59093:23346,59094:23351,59095:23360,59096:23573,59097:23580,59098:23386,59099:23397,59100:23411,59101:23377,59102:23379,59103:23394,59104:39541,59105:39543,59106:39544,59107:39546,59108:39551,59109:39549,59110:39552,59111:39553,59112:39557,59113:39560,59114:39562,59115:39568,59116:39570,59117:39571,59118:39574,59119:39576,59120:39579,59121:39580,59122:39581,59123:39583,59124:39584,59125:39586,59126:39587,59127:39589,59128:39591,59129:32415,59130:32417,59131:32419,59132:32421,59133:32424,59134:32425,59200:37838,59201:37839,59202:37840,59203:37841,59204:37842,59205:37843,59206:37844,59207:37845,59208:37847,59209:37848,59210:37849,59211:37850,59212:37851,59213:37852,59214:37853,59215:37854,59216:37855,59217:37856,59218:37857,59219:37858,59220:37859,59221:37860,59222:37861,59223:37862,59224:37863,59225:37864,59226:37865,59227:37866,59228:37867,59229:37868,59230:37869,59231:37870,59232:37871,59233:37872,59234:37873,59235:37874,59236:37875,59237:37876,59238:37877,59239:37878,59240:37879,59241:37880,59242:37881,59243:37882,59244:37883,59245:37884,59246:37885,59247:37886,59248:37887,59249:37888,59250:37889,59251:37890,59252:37891,59253:37892,59254:37893,59255:37894,59256:37895,59257:37896,59258:37897,59259:37898,59260:37899,59261:37900,59262:37901,59264:37902,59265:37903,59266:37904,59267:37905,59268:37906,59269:37907,59270:37908,59271:37909,59272:37910,59273:37911,59274:37912,59275:37913,59276:37914,59277:37915,59278:37916,59279:37917,59280:37918,59281:37919,59282:37920,59283:37921,59284:37922,59285:37923,59286:37924,59287:37925,59288:37926,59289:37927,59290:37928,59291:37929,59292:37930,59293:37931,59294:37932,59295:37933,59296:37934,59297:32429,59298:32432,59299:32446,59300:32448,59301:32449,59302:32450,59303:32457,59304:32459,59305:32460,59306:32464,59307:32468,59308:32471,59309:32475,59310:32480,59311:32481,59312:32488,59313:32491,59314:32494,59315:32495,59316:32497,59317:32498,59318:32525,59319:32502,59320:32506,59321:32507,59322:32510,59323:32513,59324:32514,59325:32515,59326:32519,59327:32520,59328:32523,59329:32524,59330:32527,59331:32529,59332:32530,59333:32535,59334:32537,59335:32540,59336:32539,59337:32543,59338:32545,59339:32546,59340:32547,59341:32548,59342:32549,59343:32550,59344:32551,59345:32554,59346:32555,59347:32556,59348:32557,59349:32559,59350:32560,59351:32561,59352:32562,59353:32563,59354:32565,59355:24186,59356:30079,59357:24027,59358:30014,59359:37013,59360:29582,59361:29585,59362:29614,59363:29602,59364:29599,59365:29647,59366:29634,59367:29649,59368:29623,59369:29619,59370:29632,59371:29641,59372:29640,59373:29669,59374:29657,59375:39036,59376:29706,59377:29673,59378:29671,59379:29662,59380:29626,59381:29682,59382:29711,59383:29738,59384:29787,59385:29734,59386:29733,59387:29736,59388:29744,59389:29742,59390:29740,59456:37935,59457:37936,59458:37937,59459:37938,59460:37939,59461:37940,59462:37941,59463:37942,59464:37943,59465:37944,59466:37945,59467:37946,59468:37947,59469:37948,59470:37949,59471:37951,59472:37952,59473:37953,59474:37954,59475:37955,59476:37956,59477:37957,59478:37958,59479:37959,59480:37960,59481:37961,59482:37962,59483:37963,59484:37964,59485:37965,59486:37966,59487:37967,59488:37968,59489:37969,59490:37970,59491:37971,59492:37972,59493:37973,59494:37974,59495:37975,59496:37976,59497:37977,59498:37978,59499:37979,59500:37980,59501:37981,59502:37982,59503:37983,59504:37984,59505:37985,59506:37986,59507:37987,59508:37988,59509:37989,59510:37990,59511:37991,59512:37992,59513:37993,59514:37994,59515:37996,59516:37997,59517:37998,59518:37999,59520:38e3,59521:38001,59522:38002,59523:38003,59524:38004,59525:38005,59526:38006,59527:38007,59528:38008,59529:38009,59530:38010,59531:38011,59532:38012,59533:38013,59534:38014,59535:38015,59536:38016,59537:38017,59538:38018,59539:38019,59540:38020,59541:38033,59542:38038,59543:38040,59544:38087,59545:38095,59546:38099,59547:38100,59548:38106,59549:38118,59550:38139,59551:38172,59552:38176,59553:29723,59554:29722,59555:29761,59556:29788,59557:29783,59558:29781,59559:29785,59560:29815,59561:29805,59562:29822,59563:29852,59564:29838,59565:29824,59566:29825,59567:29831,59568:29835,59569:29854,59570:29864,59571:29865,59572:29840,59573:29863,59574:29906,59575:29882,59576:38890,59577:38891,59578:38892,59579:26444,59580:26451,59581:26462,59582:26440,59583:26473,59584:26533,59585:26503,59586:26474,59587:26483,59588:26520,59589:26535,59590:26485,59591:26536,59592:26526,59593:26541,59594:26507,59595:26487,59596:26492,59597:26608,59598:26633,59599:26584,59600:26634,59601:26601,59602:26544,59603:26636,59604:26585,59605:26549,59606:26586,59607:26547,59608:26589,59609:26624,59610:26563,59611:26552,59612:26594,59613:26638,59614:26561,59615:26621,59616:26674,59617:26675,59618:26720,59619:26721,59620:26702,59621:26722,59622:26692,59623:26724,59624:26755,59625:26653,59626:26709,59627:26726,59628:26689,59629:26727,59630:26688,59631:26686,59632:26698,59633:26697,59634:26665,59635:26805,59636:26767,59637:26740,59638:26743,59639:26771,59640:26731,59641:26818,59642:26990,59643:26876,59644:26911,59645:26912,59646:26873,59712:38183,59713:38195,59714:38205,59715:38211,59716:38216,59717:38219,59718:38229,59719:38234,59720:38240,59721:38254,59722:38260,59723:38261,59724:38263,59725:38264,59726:38265,59727:38266,59728:38267,59729:38268,59730:38269,59731:38270,59732:38272,59733:38273,59734:38274,59735:38275,59736:38276,59737:38277,59738:38278,59739:38279,59740:38280,59741:38281,59742:38282,59743:38283,59744:38284,59745:38285,59746:38286,59747:38287,59748:38288,59749:38289,59750:38290,59751:38291,59752:38292,59753:38293,59754:38294,59755:38295,59756:38296,59757:38297,59758:38298,59759:38299,59760:38300,59761:38301,59762:38302,59763:38303,59764:38304,59765:38305,59766:38306,59767:38307,59768:38308,59769:38309,59770:38310,59771:38311,59772:38312,59773:38313,59774:38314,59776:38315,59777:38316,59778:38317,59779:38318,59780:38319,59781:38320,59782:38321,59783:38322,59784:38323,59785:38324,59786:38325,59787:38326,59788:38327,59789:38328,59790:38329,59791:38330,59792:38331,59793:38332,59794:38333,59795:38334,59796:38335,59797:38336,59798:38337,59799:38338,59800:38339,59801:38340,59802:38341,59803:38342,59804:38343,59805:38344,59806:38345,59807:38346,59808:38347,59809:26916,59810:26864,59811:26891,59812:26881,59813:26967,59814:26851,59815:26896,59816:26993,59817:26937,59818:26976,59819:26946,59820:26973,59821:27012,59822:26987,59823:27008,59824:27032,59825:27e3,59826:26932,59827:27084,59828:27015,59829:27016,59830:27086,59831:27017,59832:26982,59833:26979,59834:27001,59835:27035,59836:27047,59837:27067,59838:27051,59839:27053,59840:27092,59841:27057,59842:27073,59843:27082,59844:27103,59845:27029,59846:27104,59847:27021,59848:27135,59849:27183,59850:27117,59851:27159,59852:27160,59853:27237,59854:27122,59855:27204,59856:27198,59857:27296,59858:27216,59859:27227,59860:27189,59861:27278,59862:27257,59863:27197,59864:27176,59865:27224,59866:27260,59867:27281,59868:27280,59869:27305,59870:27287,59871:27307,59872:29495,59873:29522,59874:27521,59875:27522,59876:27527,59877:27524,59878:27538,59879:27539,59880:27533,59881:27546,59882:27547,59883:27553,59884:27562,59885:36715,59886:36717,59887:36721,59888:36722,59889:36723,59890:36725,59891:36726,59892:36728,59893:36727,59894:36729,59895:36730,59896:36732,59897:36734,59898:36737,59899:36738,59900:36740,59901:36743,59902:36747,59968:38348,59969:38349,59970:38350,59971:38351,59972:38352,59973:38353,59974:38354,59975:38355,59976:38356,59977:38357,59978:38358,59979:38359,59980:38360,59981:38361,59982:38362,59983:38363,59984:38364,59985:38365,59986:38366,59987:38367,59988:38368,59989:38369,59990:38370,59991:38371,59992:38372,59993:38373,59994:38374,59995:38375,59996:38380,59997:38399,59998:38407,59999:38419,6e4:38424,60001:38427,60002:38430,60003:38432,60004:38435,60005:38436,60006:38437,60007:38438,60008:38439,60009:38440,60010:38441,60011:38443,60012:38444,60013:38445,60014:38447,60015:38448,60016:38455,60017:38456,60018:38457,60019:38458,60020:38462,60021:38465,60022:38467,60023:38474,60024:38478,60025:38479,60026:38481,60027:38482,60028:38483,60029:38486,60030:38487,60032:38488,60033:38489,60034:38490,60035:38492,60036:38493,60037:38494,60038:38496,60039:38499,60040:38501,60041:38502,60042:38507,60043:38509,60044:38510,60045:38511,60046:38512,60047:38513,60048:38515,60049:38520,60050:38521,60051:38522,60052:38523,60053:38524,60054:38525,60055:38526,60056:38527,60057:38528,60058:38529,60059:38530,60060:38531,60061:38532,60062:38535,60063:38537,60064:38538,60065:36749,60066:36750,60067:36751,60068:36760,60069:36762,60070:36558,60071:25099,60072:25111,60073:25115,60074:25119,60075:25122,60076:25121,60077:25125,60078:25124,60079:25132,60080:33255,60081:29935,60082:29940,60083:29951,60084:29967,60085:29969,60086:29971,60087:25908,60088:26094,60089:26095,60090:26096,60091:26122,60092:26137,60093:26482,60094:26115,60095:26133,60096:26112,60097:28805,60098:26359,60099:26141,60100:26164,60101:26161,60102:26166,60103:26165,60104:32774,60105:26207,60106:26196,60107:26177,60108:26191,60109:26198,60110:26209,60111:26199,60112:26231,60113:26244,60114:26252,60115:26279,60116:26269,60117:26302,60118:26331,60119:26332,60120:26342,60121:26345,60122:36146,60123:36147,60124:36150,60125:36155,60126:36157,60127:36160,60128:36165,60129:36166,60130:36168,60131:36169,60132:36167,60133:36173,60134:36181,60135:36185,60136:35271,60137:35274,60138:35275,60139:35276,60140:35278,60141:35279,60142:35280,60143:35281,60144:29294,60145:29343,60146:29277,60147:29286,60148:29295,60149:29310,60150:29311,60151:29316,60152:29323,60153:29325,60154:29327,60155:29330,60156:25352,60157:25394,60158:25520,60224:38540,60225:38542,60226:38545,60227:38546,60228:38547,60229:38549,60230:38550,60231:38554,60232:38555,60233:38557,60234:38558,60235:38559,60236:38560,60237:38561,60238:38562,60239:38563,60240:38564,60241:38565,60242:38566,60243:38568,60244:38569,60245:38570,60246:38571,60247:38572,60248:38573,60249:38574,60250:38575,60251:38577,60252:38578,60253:38580,60254:38581,60255:38583,60256:38584,60257:38586,60258:38587,60259:38591,60260:38594,60261:38595,60262:38600,60263:38602,60264:38603,60265:38608,60266:38609,60267:38611,60268:38612,60269:38614,60270:38615,60271:38616,60272:38617,60273:38618,60274:38619,60275:38620,60276:38621,60277:38622,60278:38623,60279:38625,60280:38626,60281:38627,60282:38628,60283:38629,60284:38630,60285:38631,60286:38635,60288:38636,60289:38637,60290:38638,60291:38640,60292:38641,60293:38642,60294:38644,60295:38645,60296:38648,60297:38650,60298:38651,60299:38652,60300:38653,60301:38655,60302:38658,60303:38659,60304:38661,60305:38666,60306:38667,60307:38668,60308:38672,60309:38673,60310:38674,60311:38676,60312:38677,60313:38679,60314:38680,60315:38681,60316:38682,60317:38683,60318:38685,60319:38687,60320:38688,60321:25663,60322:25816,60323:32772,60324:27626,60325:27635,60326:27645,60327:27637,60328:27641,60329:27653,60330:27655,60331:27654,60332:27661,60333:27669,60334:27672,60335:27673,60336:27674,60337:27681,60338:27689,60339:27684,60340:27690,60341:27698,60342:25909,60343:25941,60344:25963,60345:29261,60346:29266,60347:29270,60348:29232,60349:34402,60350:21014,60351:32927,60352:32924,60353:32915,60354:32956,60355:26378,60356:32957,60357:32945,60358:32939,60359:32941,60360:32948,60361:32951,60362:32999,60363:33e3,60364:33001,60365:33002,60366:32987,60367:32962,60368:32964,60369:32985,60370:32973,60371:32983,60372:26384,60373:32989,60374:33003,60375:33009,60376:33012,60377:33005,60378:33037,60379:33038,60380:33010,60381:33020,60382:26389,60383:33042,60384:35930,60385:33078,60386:33054,60387:33068,60388:33048,60389:33074,60390:33096,60391:33100,60392:33107,60393:33140,60394:33113,60395:33114,60396:33137,60397:33120,60398:33129,60399:33148,60400:33149,60401:33133,60402:33127,60403:22605,60404:23221,60405:33160,60406:33154,60407:33169,60408:28373,60409:33187,60410:33194,60411:33228,60412:26406,60413:33226,60414:33211,60480:38689,60481:38690,60482:38691,60483:38692,60484:38693,60485:38694,60486:38695,60487:38696,60488:38697,60489:38699,60490:38700,60491:38702,60492:38703,60493:38705,60494:38707,60495:38708,60496:38709,60497:38710,60498:38711,60499:38714,60500:38715,60501:38716,60502:38717,60503:38719,60504:38720,60505:38721,60506:38722,60507:38723,60508:38724,60509:38725,60510:38726,60511:38727,60512:38728,60513:38729,60514:38730,60515:38731,60516:38732,60517:38733,60518:38734,60519:38735,60520:38736,60521:38737,60522:38740,60523:38741,60524:38743,60525:38744,60526:38746,60527:38748,60528:38749,60529:38751,60530:38755,60531:38756,60532:38758,60533:38759,60534:38760,60535:38762,60536:38763,60537:38764,60538:38765,60539:38766,60540:38767,60541:38768,60542:38769,60544:38770,60545:38773,60546:38775,60547:38776,60548:38777,60549:38778,60550:38779,60551:38781,60552:38782,60553:38783,60554:38784,60555:38785,60556:38786,60557:38787,60558:38788,60559:38790,60560:38791,60561:38792,60562:38793,60563:38794,60564:38796,60565:38798,60566:38799,60567:38800,60568:38803,60569:38805,60570:38806,60571:38807,60572:38809,60573:38810,60574:38811,60575:38812,60576:38813,60577:33217,60578:33190,60579:27428,60580:27447,60581:27449,60582:27459,60583:27462,60584:27481,60585:39121,60586:39122,60587:39123,60588:39125,60589:39129,60590:39130,60591:27571,60592:24384,60593:27586,60594:35315,60595:26e3,60596:40785,60597:26003,60598:26044,60599:26054,60600:26052,60601:26051,60602:26060,60603:26062,60604:26066,60605:26070,60606:28800,60607:28828,60608:28822,60609:28829,60610:28859,60611:28864,60612:28855,60613:28843,60614:28849,60615:28904,60616:28874,60617:28944,60618:28947,60619:28950,60620:28975,60621:28977,60622:29043,60623:29020,60624:29032,60625:28997,60626:29042,60627:29002,60628:29048,60629:29050,60630:29080,60631:29107,60632:29109,60633:29096,60634:29088,60635:29152,60636:29140,60637:29159,60638:29177,60639:29213,60640:29224,60641:28780,60642:28952,60643:29030,60644:29113,60645:25150,60646:25149,60647:25155,60648:25160,60649:25161,60650:31035,60651:31040,60652:31046,60653:31049,60654:31067,60655:31068,60656:31059,60657:31066,60658:31074,60659:31063,60660:31072,60661:31087,60662:31079,60663:31098,60664:31109,60665:31114,60666:31130,60667:31143,60668:31155,60669:24529,60670:24528,60736:38814,60737:38815,60738:38817,60739:38818,60740:38820,60741:38821,60742:38822,60743:38823,60744:38824,60745:38825,60746:38826,60747:38828,60748:38830,60749:38832,60750:38833,60751:38835,60752:38837,60753:38838,60754:38839,60755:38840,60756:38841,60757:38842,60758:38843,60759:38844,60760:38845,60761:38846,60762:38847,60763:38848,60764:38849,60765:38850,60766:38851,60767:38852,60768:38853,60769:38854,60770:38855,60771:38856,60772:38857,60773:38858,60774:38859,60775:38860,60776:38861,60777:38862,60778:38863,60779:38864,60780:38865,60781:38866,60782:38867,60783:38868,60784:38869,60785:38870,60786:38871,60787:38872,60788:38873,60789:38874,60790:38875,60791:38876,60792:38877,60793:38878,60794:38879,60795:38880,60796:38881,60797:38882,60798:38883,60800:38884,60801:38885,60802:38888,60803:38894,60804:38895,60805:38896,60806:38897,60807:38898,60808:38900,60809:38903,60810:38904,60811:38905,60812:38906,60813:38907,60814:38908,60815:38909,60816:38910,60817:38911,60818:38912,60819:38913,60820:38914,60821:38915,60822:38916,60823:38917,60824:38918,60825:38919,60826:38920,60827:38921,60828:38922,60829:38923,60830:38924,60831:38925,60832:38926,60833:24636,60834:24669,60835:24666,60836:24679,60837:24641,60838:24665,60839:24675,60840:24747,60841:24838,60842:24845,60843:24925,60844:25001,60845:24989,60846:25035,60847:25041,60848:25094,60849:32896,60850:32895,60851:27795,60852:27894,60853:28156,60854:30710,60855:30712,60856:30720,60857:30729,60858:30743,60859:30744,60860:30737,60861:26027,60862:30765,60863:30748,60864:30749,60865:30777,60866:30778,60867:30779,60868:30751,60869:30780,60870:30757,60871:30764,60872:30755,60873:30761,60874:30798,60875:30829,60876:30806,60877:30807,60878:30758,60879:30800,60880:30791,60881:30796,60882:30826,60883:30875,60884:30867,60885:30874,60886:30855,60887:30876,60888:30881,60889:30883,60890:30898,60891:30905,60892:30885,60893:30932,60894:30937,60895:30921,60896:30956,60897:30962,60898:30981,60899:30964,60900:30995,60901:31012,60902:31006,60903:31028,60904:40859,60905:40697,60906:40699,60907:40700,60908:30449,60909:30468,60910:30477,60911:30457,60912:30471,60913:30472,60914:30490,60915:30498,60916:30489,60917:30509,60918:30502,60919:30517,60920:30520,60921:30544,60922:30545,60923:30535,60924:30531,60925:30554,60926:30568,60992:38927,60993:38928,60994:38929,60995:38930,60996:38931,60997:38932,60998:38933,60999:38934,61e3:38935,61001:38936,61002:38937,61003:38938,61004:38939,61005:38940,61006:38941,61007:38942,61008:38943,61009:38944,61010:38945,61011:38946,61012:38947,61013:38948,61014:38949,61015:38950,61016:38951,61017:38952,61018:38953,61019:38954,61020:38955,61021:38956,61022:38957,61023:38958,61024:38959,61025:38960,61026:38961,61027:38962,61028:38963,61029:38964,61030:38965,61031:38966,61032:38967,61033:38968,61034:38969,61035:38970,61036:38971,61037:38972,61038:38973,61039:38974,61040:38975,61041:38976,61042:38977,61043:38978,61044:38979,61045:38980,61046:38981,61047:38982,61048:38983,61049:38984,61050:38985,61051:38986,61052:38987,61053:38988,61054:38989,61056:38990,61057:38991,61058:38992,61059:38993,61060:38994,61061:38995,61062:38996,61063:38997,61064:38998,61065:38999,61066:39e3,61067:39001,61068:39002,61069:39003,61070:39004,61071:39005,61072:39006,61073:39007,61074:39008,61075:39009,61076:39010,61077:39011,61078:39012,61079:39013,61080:39014,61081:39015,61082:39016,61083:39017,61084:39018,61085:39019,61086:39020,61087:39021,61088:39022,61089:30562,61090:30565,61091:30591,61092:30605,61093:30589,61094:30592,61095:30604,61096:30609,61097:30623,61098:30624,61099:30640,61100:30645,61101:30653,61102:30010,61103:30016,61104:30030,61105:30027,61106:30024,61107:30043,61108:30066,61109:30073,61110:30083,61111:32600,61112:32609,61113:32607,61114:35400,61115:32616,61116:32628,61117:32625,61118:32633,61119:32641,61120:32638,61121:30413,61122:30437,61123:34866,61124:38021,61125:38022,61126:38023,61127:38027,61128:38026,61129:38028,61130:38029,61131:38031,61132:38032,61133:38036,61134:38039,61135:38037,61136:38042,61137:38043,61138:38044,61139:38051,61140:38052,61141:38059,61142:38058,61143:38061,61144:38060,61145:38063,61146:38064,61147:38066,61148:38068,61149:38070,61150:38071,61151:38072,61152:38073,61153:38074,61154:38076,61155:38077,61156:38079,61157:38084,61158:38088,61159:38089,61160:38090,61161:38091,61162:38092,61163:38093,61164:38094,61165:38096,61166:38097,61167:38098,61168:38101,61169:38102,61170:38103,61171:38105,61172:38104,61173:38107,61174:38110,61175:38111,61176:38112,61177:38114,61178:38116,61179:38117,61180:38119,61181:38120,61182:38122,61248:39023,61249:39024,61250:39025,61251:39026,61252:39027,61253:39028,61254:39051,61255:39054,61256:39058,61257:39061,61258:39065,61259:39075,61260:39080,61261:39081,61262:39082,61263:39083,61264:39084,61265:39085,61266:39086,61267:39087,61268:39088,61269:39089,61270:39090,61271:39091,61272:39092,61273:39093,61274:39094,61275:39095,61276:39096,61277:39097,61278:39098,61279:39099,61280:39100,61281:39101,61282:39102,61283:39103,61284:39104,61285:39105,61286:39106,61287:39107,61288:39108,61289:39109,61290:39110,61291:39111,61292:39112,61293:39113,61294:39114,61295:39115,61296:39116,61297:39117,61298:39119,61299:39120,61300:39124,61301:39126,61302:39127,61303:39131,61304:39132,61305:39133,61306:39136,61307:39137,61308:39138,61309:39139,61310:39140,61312:39141,61313:39142,61314:39145,61315:39146,61316:39147,61317:39148,61318:39149,61319:39150,61320:39151,61321:39152,61322:39153,61323:39154,61324:39155,61325:39156,61326:39157,61327:39158,61328:39159,61329:39160,61330:39161,61331:39162,61332:39163,61333:39164,61334:39165,61335:39166,61336:39167,61337:39168,61338:39169,61339:39170,61340:39171,61341:39172,61342:39173,61343:39174,61344:39175,61345:38121,61346:38123,61347:38126,61348:38127,61349:38131,61350:38132,61351:38133,61352:38135,61353:38137,61354:38140,61355:38141,61356:38143,61357:38147,61358:38146,61359:38150,61360:38151,61361:38153,61362:38154,61363:38157,61364:38158,61365:38159,61366:38162,61367:38163,61368:38164,61369:38165,61370:38166,61371:38168,61372:38171,61373:38173,61374:38174,61375:38175,61376:38178,61377:38186,61378:38187,61379:38185,61380:38188,61381:38193,61382:38194,61383:38196,61384:38198,61385:38199,61386:38200,61387:38204,61388:38206,61389:38207,61390:38210,61391:38197,61392:38212,61393:38213,61394:38214,61395:38217,61396:38220,61397:38222,61398:38223,61399:38226,61400:38227,61401:38228,61402:38230,61403:38231,61404:38232,61405:38233,61406:38235,61407:38238,61408:38239,61409:38237,61410:38241,61411:38242,61412:38244,61413:38245,61414:38246,61415:38247,61416:38248,61417:38249,61418:38250,61419:38251,61420:38252,61421:38255,61422:38257,61423:38258,61424:38259,61425:38202,61426:30695,61427:30700,61428:38601,61429:31189,61430:31213,61431:31203,61432:31211,61433:31238,61434:23879,61435:31235,61436:31234,61437:31262,61438:31252,61504:39176,61505:39177,61506:39178,61507:39179,61508:39180,61509:39182,61510:39183,61511:39185,61512:39186,61513:39187,61514:39188,61515:39189,61516:39190,61517:39191,61518:39192,61519:39193,61520:39194,61521:39195,61522:39196,61523:39197,61524:39198,61525:39199,61526:39200,61527:39201,61528:39202,61529:39203,61530:39204,61531:39205,61532:39206,61533:39207,61534:39208,61535:39209,61536:39210,61537:39211,61538:39212,61539:39213,61540:39215,61541:39216,61542:39217,61543:39218,61544:39219,61545:39220,61546:39221,61547:39222,61548:39223,61549:39224,61550:39225,61551:39226,61552:39227,61553:39228,61554:39229,61555:39230,61556:39231,61557:39232,61558:39233,61559:39234,61560:39235,61561:39236,61562:39237,61563:39238,61564:39239,61565:39240,61566:39241,61568:39242,61569:39243,61570:39244,61571:39245,61572:39246,61573:39247,61574:39248,61575:39249,61576:39250,61577:39251,61578:39254,61579:39255,61580:39256,61581:39257,61582:39258,61583:39259,61584:39260,61585:39261,61586:39262,61587:39263,61588:39264,61589:39265,61590:39266,61591:39268,61592:39270,61593:39283,61594:39288,61595:39289,61596:39291,61597:39294,61598:39298,61599:39299,61600:39305,61601:31289,61602:31287,61603:31313,61604:40655,61605:39333,61606:31344,61607:30344,61608:30350,61609:30355,61610:30361,61611:30372,61612:29918,61613:29920,61614:29996,61615:40480,61616:40482,61617:40488,61618:40489,61619:40490,61620:40491,61621:40492,61622:40498,61623:40497,61624:40502,61625:40504,61626:40503,61627:40505,61628:40506,61629:40510,61630:40513,61631:40514,61632:40516,61633:40518,61634:40519,61635:40520,61636:40521,61637:40523,61638:40524,61639:40526,61640:40529,61641:40533,61642:40535,61643:40538,61644:40539,61645:40540,61646:40542,61647:40547,61648:40550,61649:40551,61650:40552,61651:40553,61652:40554,61653:40555,61654:40556,61655:40561,61656:40557,61657:40563,61658:30098,61659:30100,61660:30102,61661:30112,61662:30109,61663:30124,61664:30115,61665:30131,61666:30132,61667:30136,61668:30148,61669:30129,61670:30128,61671:30147,61672:30146,61673:30166,61674:30157,61675:30179,61676:30184,61677:30182,61678:30180,61679:30187,61680:30183,61681:30211,61682:30193,61683:30204,61684:30207,61685:30224,61686:30208,61687:30213,61688:30220,61689:30231,61690:30218,61691:30245,61692:30232,61693:30229,61694:30233,61760:39308,61761:39310,61762:39322,61763:39323,61764:39324,61765:39325,61766:39326,61767:39327,61768:39328,61769:39329,61770:39330,61771:39331,61772:39332,61773:39334,61774:39335,61775:39337,61776:39338,61777:39339,61778:39340,61779:39341,61780:39342,61781:39343,61782:39344,61783:39345,61784:39346,61785:39347,61786:39348,61787:39349,61788:39350,61789:39351,61790:39352,61791:39353,61792:39354,61793:39355,61794:39356,61795:39357,61796:39358,61797:39359,61798:39360,61799:39361,61800:39362,61801:39363,61802:39364,61803:39365,61804:39366,61805:39367,61806:39368,61807:39369,61808:39370,61809:39371,61810:39372,61811:39373,61812:39374,61813:39375,61814:39376,61815:39377,61816:39378,61817:39379,61818:39380,61819:39381,61820:39382,61821:39383,61822:39384,61824:39385,61825:39386,61826:39387,61827:39388,61828:39389,61829:39390,61830:39391,61831:39392,61832:39393,61833:39394,61834:39395,61835:39396,61836:39397,61837:39398,61838:39399,61839:39400,61840:39401,61841:39402,61842:39403,61843:39404,61844:39405,61845:39406,61846:39407,61847:39408,61848:39409,61849:39410,61850:39411,61851:39412,61852:39413,61853:39414,61854:39415,61855:39416,61856:39417,61857:30235,61858:30268,61859:30242,61860:30240,61861:30272,61862:30253,61863:30256,61864:30271,61865:30261,61866:30275,61867:30270,61868:30259,61869:30285,61870:30302,61871:30292,61872:30300,61873:30294,61874:30315,61875:30319,61876:32714,61877:31462,61878:31352,61879:31353,61880:31360,61881:31366,61882:31368,61883:31381,61884:31398,61885:31392,61886:31404,61887:31400,61888:31405,61889:31411,61890:34916,61891:34921,61892:34930,61893:34941,61894:34943,61895:34946,61896:34978,61897:35014,61898:34999,61899:35004,61900:35017,61901:35042,61902:35022,61903:35043,61904:35045,61905:35057,61906:35098,61907:35068,61908:35048,61909:35070,61910:35056,61911:35105,61912:35097,61913:35091,61914:35099,61915:35082,61916:35124,61917:35115,61918:35126,61919:35137,61920:35174,61921:35195,61922:30091,61923:32997,61924:30386,61925:30388,61926:30684,61927:32786,61928:32788,61929:32790,61930:32796,61931:32800,61932:32802,61933:32805,61934:32806,61935:32807,61936:32809,61937:32808,61938:32817,61939:32779,61940:32821,61941:32835,61942:32838,61943:32845,61944:32850,61945:32873,61946:32881,61947:35203,61948:39032,61949:39040,61950:39043,62016:39418,62017:39419,62018:39420,62019:39421,62020:39422,62021:39423,62022:39424,62023:39425,62024:39426,62025:39427,62026:39428,62027:39429,62028:39430,62029:39431,62030:39432,62031:39433,62032:39434,62033:39435,62034:39436,62035:39437,62036:39438,62037:39439,62038:39440,62039:39441,62040:39442,62041:39443,62042:39444,62043:39445,62044:39446,62045:39447,62046:39448,62047:39449,62048:39450,62049:39451,62050:39452,62051:39453,62052:39454,62053:39455,62054:39456,62055:39457,62056:39458,62057:39459,62058:39460,62059:39461,62060:39462,62061:39463,62062:39464,62063:39465,62064:39466,62065:39467,62066:39468,62067:39469,62068:39470,62069:39471,62070:39472,62071:39473,62072:39474,62073:39475,62074:39476,62075:39477,62076:39478,62077:39479,62078:39480,62080:39481,62081:39482,62082:39483,62083:39484,62084:39485,62085:39486,62086:39487,62087:39488,62088:39489,62089:39490,62090:39491,62091:39492,62092:39493,62093:39494,62094:39495,62095:39496,62096:39497,62097:39498,62098:39499,62099:39500,62100:39501,62101:39502,62102:39503,62103:39504,62104:39505,62105:39506,62106:39507,62107:39508,62108:39509,62109:39510,62110:39511,62111:39512,62112:39513,62113:39049,62114:39052,62115:39053,62116:39055,62117:39060,62118:39066,62119:39067,62120:39070,62121:39071,62122:39073,62123:39074,62124:39077,62125:39078,62126:34381,62127:34388,62128:34412,62129:34414,62130:34431,62131:34426,62132:34428,62133:34427,62134:34472,62135:34445,62136:34443,62137:34476,62138:34461,62139:34471,62140:34467,62141:34474,62142:34451,62143:34473,62144:34486,62145:34500,62146:34485,62147:34510,62148:34480,62149:34490,62150:34481,62151:34479,62152:34505,62153:34511,62154:34484,62155:34537,62156:34545,62157:34546,62158:34541,62159:34547,62160:34512,62161:34579,62162:34526,62163:34548,62164:34527,62165:34520,62166:34513,62167:34563,62168:34567,62169:34552,62170:34568,62171:34570,62172:34573,62173:34569,62174:34595,62175:34619,62176:34590,62177:34597,62178:34606,62179:34586,62180:34622,62181:34632,62182:34612,62183:34609,62184:34601,62185:34615,62186:34623,62187:34690,62188:34594,62189:34685,62190:34686,62191:34683,62192:34656,62193:34672,62194:34636,62195:34670,62196:34699,62197:34643,62198:34659,62199:34684,62200:34660,62201:34649,62202:34661,62203:34707,62204:34735,62205:34728,62206:34770,62272:39514,62273:39515,62274:39516,62275:39517,62276:39518,62277:39519,62278:39520,62279:39521,62280:39522,62281:39523,62282:39524,62283:39525,62284:39526,62285:39527,62286:39528,62287:39529,62288:39530,62289:39531,62290:39538,62291:39555,62292:39561,62293:39565,62294:39566,62295:39572,62296:39573,62297:39577,62298:39590,62299:39593,62300:39594,62301:39595,62302:39596,62303:39597,62304:39598,62305:39599,62306:39602,62307:39603,62308:39604,62309:39605,62310:39609,62311:39611,62312:39613,62313:39614,62314:39615,62315:39619,62316:39620,62317:39622,62318:39623,62319:39624,62320:39625,62321:39626,62322:39629,62323:39630,62324:39631,62325:39632,62326:39634,62327:39636,62328:39637,62329:39638,62330:39639,62331:39641,62332:39642,62333:39643,62334:39644,62336:39645,62337:39646,62338:39648,62339:39650,62340:39651,62341:39652,62342:39653,62343:39655,62344:39656,62345:39657,62346:39658,62347:39660,62348:39662,62349:39664,62350:39665,62351:39666,62352:39667,62353:39668,62354:39669,62355:39670,62356:39671,62357:39672,62358:39674,62359:39676,62360:39677,62361:39678,62362:39679,62363:39680,62364:39681,62365:39682,62366:39684,62367:39685,62368:39686,62369:34758,62370:34696,62371:34693,62372:34733,62373:34711,62374:34691,62375:34731,62376:34789,62377:34732,62378:34741,62379:34739,62380:34763,62381:34771,62382:34749,62383:34769,62384:34752,62385:34762,62386:34779,62387:34794,62388:34784,62389:34798,62390:34838,62391:34835,62392:34814,62393:34826,62394:34843,62395:34849,62396:34873,62397:34876,62398:32566,62399:32578,62400:32580,62401:32581,62402:33296,62403:31482,62404:31485,62405:31496,62406:31491,62407:31492,62408:31509,62409:31498,62410:31531,62411:31503,62412:31559,62413:31544,62414:31530,62415:31513,62416:31534,62417:31537,62418:31520,62419:31525,62420:31524,62421:31539,62422:31550,62423:31518,62424:31576,62425:31578,62426:31557,62427:31605,62428:31564,62429:31581,62430:31584,62431:31598,62432:31611,62433:31586,62434:31602,62435:31601,62436:31632,62437:31654,62438:31655,62439:31672,62440:31660,62441:31645,62442:31656,62443:31621,62444:31658,62445:31644,62446:31650,62447:31659,62448:31668,62449:31697,62450:31681,62451:31692,62452:31709,62453:31706,62454:31717,62455:31718,62456:31722,62457:31756,62458:31742,62459:31740,62460:31759,62461:31766,62462:31755,62528:39687,62529:39689,62530:39690,62531:39691,62532:39692,62533:39693,62534:39694,62535:39696,62536:39697,62537:39698,62538:39700,62539:39701,62540:39702,62541:39703,62542:39704,62543:39705,62544:39706,62545:39707,62546:39708,62547:39709,62548:39710,62549:39712,62550:39713,62551:39714,62552:39716,62553:39717,62554:39718,62555:39719,62556:39720,62557:39721,62558:39722,62559:39723,62560:39724,62561:39725,62562:39726,62563:39728,62564:39729,62565:39731,62566:39732,62567:39733,62568:39734,62569:39735,62570:39736,62571:39737,62572:39738,62573:39741,62574:39742,62575:39743,62576:39744,62577:39750,62578:39754,62579:39755,62580:39756,62581:39758,62582:39760,62583:39762,62584:39763,62585:39765,62586:39766,62587:39767,62588:39768,62589:39769,62590:39770,62592:39771,62593:39772,62594:39773,62595:39774,62596:39775,62597:39776,62598:39777,62599:39778,62600:39779,62601:39780,62602:39781,62603:39782,62604:39783,62605:39784,62606:39785,62607:39786,62608:39787,62609:39788,62610:39789,62611:39790,62612:39791,62613:39792,62614:39793,62615:39794,62616:39795,62617:39796,62618:39797,62619:39798,62620:39799,62621:39800,62622:39801,62623:39802,62624:39803,62625:31775,62626:31786,62627:31782,62628:31800,62629:31809,62630:31808,62631:33278,62632:33281,62633:33282,62634:33284,62635:33260,62636:34884,62637:33313,62638:33314,62639:33315,62640:33325,62641:33327,62642:33320,62643:33323,62644:33336,62645:33339,62646:33331,62647:33332,62648:33342,62649:33348,62650:33353,62651:33355,62652:33359,62653:33370,62654:33375,62655:33384,62656:34942,62657:34949,62658:34952,62659:35032,62660:35039,62661:35166,62662:32669,62663:32671,62664:32679,62665:32687,62666:32688,62667:32690,62668:31868,62669:25929,62670:31889,62671:31901,62672:31900,62673:31902,62674:31906,62675:31922,62676:31932,62677:31933,62678:31937,62679:31943,62680:31948,62681:31949,62682:31944,62683:31941,62684:31959,62685:31976,62686:33390,62687:26280,62688:32703,62689:32718,62690:32725,62691:32741,62692:32737,62693:32742,62694:32745,62695:32750,62696:32755,62697:31992,62698:32119,62699:32166,62700:32174,62701:32327,62702:32411,62703:40632,62704:40628,62705:36211,62706:36228,62707:36244,62708:36241,62709:36273,62710:36199,62711:36205,62712:35911,62713:35913,62714:37194,62715:37200,62716:37198,62717:37199,62718:37220,62784:39804,62785:39805,62786:39806,62787:39807,62788:39808,62789:39809,62790:39810,62791:39811,62792:39812,62793:39813,62794:39814,62795:39815,62796:39816,62797:39817,62798:39818,62799:39819,62800:39820,62801:39821,62802:39822,62803:39823,62804:39824,62805:39825,62806:39826,62807:39827,62808:39828,62809:39829,62810:39830,62811:39831,62812:39832,62813:39833,62814:39834,62815:39835,62816:39836,62817:39837,62818:39838,62819:39839,62820:39840,62821:39841,62822:39842,62823:39843,62824:39844,62825:39845,62826:39846,62827:39847,62828:39848,62829:39849,62830:39850,62831:39851,62832:39852,62833:39853,62834:39854,62835:39855,62836:39856,62837:39857,62838:39858,62839:39859,62840:39860,62841:39861,62842:39862,62843:39863,62844:39864,62845:39865,62846:39866,62848:39867,62849:39868,62850:39869,62851:39870,62852:39871,62853:39872,62854:39873,62855:39874,62856:39875,62857:39876,62858:39877,62859:39878,62860:39879,62861:39880,62862:39881,62863:39882,62864:39883,62865:39884,62866:39885,62867:39886,62868:39887,62869:39888,62870:39889,62871:39890,62872:39891,62873:39892,62874:39893,62875:39894,62876:39895,62877:39896,62878:39897,62879:39898,62880:39899,62881:37218,62882:37217,62883:37232,62884:37225,62885:37231,62886:37245,62887:37246,62888:37234,62889:37236,62890:37241,62891:37260,62892:37253,62893:37264,62894:37261,62895:37265,62896:37282,62897:37283,62898:37290,62899:37293,62900:37294,62901:37295,62902:37301,62903:37300,62904:37306,62905:35925,62906:40574,62907:36280,62908:36331,62909:36357,62910:36441,62911:36457,62912:36277,62913:36287,62914:36284,62915:36282,62916:36292,62917:36310,62918:36311,62919:36314,62920:36318,62921:36302,62922:36303,62923:36315,62924:36294,62925:36332,62926:36343,62927:36344,62928:36323,62929:36345,62930:36347,62931:36324,62932:36361,62933:36349,62934:36372,62935:36381,62936:36383,62937:36396,62938:36398,62939:36387,62940:36399,62941:36410,62942:36416,62943:36409,62944:36405,62945:36413,62946:36401,62947:36425,62948:36417,62949:36418,62950:36433,62951:36434,62952:36426,62953:36464,62954:36470,62955:36476,62956:36463,62957:36468,62958:36485,62959:36495,62960:36500,62961:36496,62962:36508,62963:36510,62964:35960,62965:35970,62966:35978,62967:35973,62968:35992,62969:35988,62970:26011,62971:35286,62972:35294,62973:35290,62974:35292,63040:39900,63041:39901,63042:39902,63043:39903,63044:39904,63045:39905,63046:39906,63047:39907,63048:39908,63049:39909,63050:39910,63051:39911,63052:39912,63053:39913,63054:39914,63055:39915,63056:39916,63057:39917,63058:39918,63059:39919,63060:39920,63061:39921,63062:39922,63063:39923,63064:39924,63065:39925,63066:39926,63067:39927,63068:39928,63069:39929,63070:39930,63071:39931,63072:39932,63073:39933,63074:39934,63075:39935,63076:39936,63077:39937,63078:39938,63079:39939,63080:39940,63081:39941,63082:39942,63083:39943,63084:39944,63085:39945,63086:39946,63087:39947,63088:39948,63089:39949,63090:39950,63091:39951,63092:39952,63093:39953,63094:39954,63095:39955,63096:39956,63097:39957,63098:39958,63099:39959,63100:39960,63101:39961,63102:39962,63104:39963,63105:39964,63106:39965,63107:39966,63108:39967,63109:39968,63110:39969,63111:39970,63112:39971,63113:39972,63114:39973,63115:39974,63116:39975,63117:39976,63118:39977,63119:39978,63120:39979,63121:39980,63122:39981,63123:39982,63124:39983,63125:39984,63126:39985,63127:39986,63128:39987,63129:39988,63130:39989,63131:39990,63132:39991,63133:39992,63134:39993,63135:39994,63136:39995,63137:35301,63138:35307,63139:35311,63140:35390,63141:35622,63142:38739,63143:38633,63144:38643,63145:38639,63146:38662,63147:38657,63148:38664,63149:38671,63150:38670,63151:38698,63152:38701,63153:38704,63154:38718,63155:40832,63156:40835,63157:40837,63158:40838,63159:40839,63160:40840,63161:40841,63162:40842,63163:40844,63164:40702,63165:40715,63166:40717,63167:38585,63168:38588,63169:38589,63170:38606,63171:38610,63172:30655,63173:38624,63174:37518,63175:37550,63176:37576,63177:37694,63178:37738,63179:37834,63180:37775,63181:37950,63182:37995,63183:40063,63184:40066,63185:40069,63186:40070,63187:40071,63188:40072,63189:31267,63190:40075,63191:40078,63192:40080,63193:40081,63194:40082,63195:40084,63196:40085,63197:40090,63198:40091,63199:40094,63200:40095,63201:40096,63202:40097,63203:40098,63204:40099,63205:40101,63206:40102,63207:40103,63208:40104,63209:40105,63210:40107,63211:40109,63212:40110,63213:40112,63214:40113,63215:40114,63216:40115,63217:40116,63218:40117,63219:40118,63220:40119,63221:40122,63222:40123,63223:40124,63224:40125,63225:40132,63226:40133,63227:40134,63228:40135,63229:40138,63230:40139,63296:39996,63297:39997,63298:39998,63299:39999,63300:4e4,63301:40001,63302:40002,63303:40003,63304:40004,63305:40005,63306:40006,63307:40007,63308:40008,63309:40009,63310:40010,63311:40011,63312:40012,63313:40013,63314:40014,63315:40015,63316:40016,63317:40017,63318:40018,63319:40019,63320:40020,63321:40021,63322:40022,63323:40023,63324:40024,63325:40025,63326:40026,63327:40027,63328:40028,63329:40029,63330:40030,63331:40031,63332:40032,63333:40033,63334:40034,63335:40035,63336:40036,63337:40037,63338:40038,63339:40039,63340:40040,63341:40041,63342:40042,63343:40043,63344:40044,63345:40045,63346:40046,63347:40047,63348:40048,63349:40049,63350:40050,63351:40051,63352:40052,63353:40053,63354:40054,63355:40055,63356:40056,63357:40057,63358:40058,63360:40059,63361:40061,63362:40062,63363:40064,63364:40067,63365:40068,63366:40073,63367:40074,63368:40076,63369:40079,63370:40083,63371:40086,63372:40087,63373:40088,63374:40089,63375:40093,63376:40106,63377:40108,63378:40111,63379:40121,63380:40126,63381:40127,63382:40128,63383:40129,63384:40130,63385:40136,63386:40137,63387:40145,63388:40146,63389:40154,63390:40155,63391:40160,63392:40161,63393:40140,63394:40141,63395:40142,63396:40143,63397:40144,63398:40147,63399:40148,63400:40149,63401:40151,63402:40152,63403:40153,63404:40156,63405:40157,63406:40159,63407:40162,63408:38780,63409:38789,63410:38801,63411:38802,63412:38804,63413:38831,63414:38827,63415:38819,63416:38834,63417:38836,63418:39601,63419:39600,63420:39607,63421:40536,63422:39606,63423:39610,63424:39612,63425:39617,63426:39616,63427:39621,63428:39618,63429:39627,63430:39628,63431:39633,63432:39749,63433:39747,63434:39751,63435:39753,63436:39752,63437:39757,63438:39761,63439:39144,63440:39181,63441:39214,63442:39253,63443:39252,63444:39647,63445:39649,63446:39654,63447:39663,63448:39659,63449:39675,63450:39661,63451:39673,63452:39688,63453:39695,63454:39699,63455:39711,63456:39715,63457:40637,63458:40638,63459:32315,63460:40578,63461:40583,63462:40584,63463:40587,63464:40594,63465:37846,63466:40605,63467:40607,63468:40667,63469:40668,63470:40669,63471:40672,63472:40671,63473:40674,63474:40681,63475:40679,63476:40677,63477:40682,63478:40687,63479:40738,63480:40748,63481:40751,63482:40761,63483:40759,63484:40765,63485:40766,63486:40772,63552:40163,63553:40164,63554:40165,63555:40166,63556:40167,63557:40168,63558:40169,63559:40170,63560:40171,63561:40172,63562:40173,63563:40174,63564:40175,63565:40176,63566:40177,63567:40178,63568:40179,63569:40180,63570:40181,63571:40182,63572:40183,63573:40184,63574:40185,63575:40186,63576:40187,63577:40188,63578:40189,63579:40190,63580:40191,63581:40192,63582:40193,63583:40194,63584:40195,63585:40196,63586:40197,63587:40198,63588:40199,63589:40200,63590:40201,63591:40202,63592:40203,63593:40204,63594:40205,63595:40206,63596:40207,63597:40208,63598:40209,63599:40210,63600:40211,63601:40212,63602:40213,63603:40214,63604:40215,63605:40216,63606:40217,63607:40218,63608:40219,63609:40220,63610:40221,63611:40222,63612:40223,63613:40224,63614:40225,63616:40226,63617:40227,63618:40228,63619:40229,63620:40230,63621:40231,63622:40232,63623:40233,63624:40234,63625:40235,63626:40236,63627:40237,63628:40238,63629:40239,63630:40240,63631:40241,63632:40242,63633:40243,63634:40244,63635:40245,63636:40246,63637:40247,63638:40248,63639:40249,63640:40250,63641:40251,63642:40252,63643:40253,63644:40254,63645:40255,63646:40256,63647:40257,63648:40258,63649:57908,63650:57909,63651:57910,63652:57911,63653:57912,63654:57913,63655:57914,63656:57915,63657:57916,63658:57917,63659:57918,63660:57919,63661:57920,63662:57921,63663:57922,63664:57923,63665:57924,63666:57925,63667:57926,63668:57927,63669:57928,63670:57929,63671:57930,63672:57931,63673:57932,63674:57933,63675:57934,63676:57935,63677:57936,63678:57937,63679:57938,63680:57939,63681:57940,63682:57941,63683:57942,63684:57943,63685:57944,63686:57945,63687:57946,63688:57947,63689:57948,63690:57949,63691:57950,63692:57951,63693:57952,63694:57953,63695:57954,63696:57955,63697:57956,63698:57957,63699:57958,63700:57959,63701:57960,63702:57961,63703:57962,63704:57963,63705:57964,63706:57965,63707:57966,63708:57967,63709:57968,63710:57969,63711:57970,63712:57971,63713:57972,63714:57973,63715:57974,63716:57975,63717:57976,63718:57977,63719:57978,63720:57979,63721:57980,63722:57981,63723:57982,63724:57983,63725:57984,63726:57985,63727:57986,63728:57987,63729:57988,63730:57989,63731:57990,63732:57991,63733:57992,63734:57993,63735:57994,63736:57995,63737:57996,63738:57997,63739:57998,63740:57999,63741:58e3,63742:58001,63808:40259,63809:40260,63810:40261,63811:40262,63812:40263,63813:40264,63814:40265,63815:40266,63816:40267,63817:40268,63818:40269,63819:40270,63820:40271,63821:40272,63822:40273,63823:40274,63824:40275,63825:40276,63826:40277,63827:40278,63828:40279,63829:40280,63830:40281,63831:40282,63832:40283,63833:40284,63834:40285,63835:40286,63836:40287,63837:40288,63838:40289,63839:40290,63840:40291,63841:40292,63842:40293,63843:40294,63844:40295,63845:40296,63846:40297,63847:40298,63848:40299,63849:40300,63850:40301,63851:40302,63852:40303,63853:40304,63854:40305,63855:40306,63856:40307,63857:40308,63858:40309,63859:40310,63860:40311,63861:40312,63862:40313,63863:40314,63864:40315,63865:40316,63866:40317,63867:40318,63868:40319,63869:40320,63870:40321,63872:40322,63873:40323,63874:40324,63875:40325,63876:40326,63877:40327,63878:40328,63879:40329,63880:40330,63881:40331,63882:40332,63883:40333,63884:40334,63885:40335,63886:40336,63887:40337,63888:40338,63889:40339,63890:40340,63891:40341,63892:40342,63893:40343,63894:40344,63895:40345,63896:40346,63897:40347,63898:40348,63899:40349,63900:40350,63901:40351,63902:40352,63903:40353,63904:40354,63905:58002,63906:58003,63907:58004,63908:58005,63909:58006,63910:58007,63911:58008,63912:58009,63913:58010,63914:58011,63915:58012,63916:58013,63917:58014,63918:58015,63919:58016,63920:58017,63921:58018,63922:58019,63923:58020,63924:58021,63925:58022,63926:58023,63927:58024,63928:58025,63929:58026,63930:58027,63931:58028,63932:58029,63933:58030,63934:58031,63935:58032,63936:58033,63937:58034,63938:58035,63939:58036,63940:58037,63941:58038,63942:58039,63943:58040,63944:58041,63945:58042,63946:58043,63947:58044,63948:58045,63949:58046,63950:58047,63951:58048,63952:58049,63953:58050,63954:58051,63955:58052,63956:58053,63957:58054,63958:58055,63959:58056,63960:58057,63961:58058,63962:58059,63963:58060,63964:58061,63965:58062,63966:58063,63967:58064,63968:58065,63969:58066,63970:58067,63971:58068,63972:58069,63973:58070,63974:58071,63975:58072,63976:58073,63977:58074,63978:58075,63979:58076,63980:58077,63981:58078,63982:58079,63983:58080,63984:58081,63985:58082,63986:58083,63987:58084,63988:58085,63989:58086,63990:58087,63991:58088,63992:58089,63993:58090,63994:58091,63995:58092,63996:58093,63997:58094,63998:58095,64064:40355,64065:40356,64066:40357,64067:40358,64068:40359,64069:40360,64070:40361,64071:40362,64072:40363,64073:40364,64074:40365,64075:40366,64076:40367,64077:40368,64078:40369,64079:40370,64080:40371,64081:40372,64082:40373,64083:40374,64084:40375,64085:40376,64086:40377,64087:40378,64088:40379,64089:40380,64090:40381,64091:40382,64092:40383,64093:40384,64094:40385,64095:40386,64096:40387,64097:40388,64098:40389,64099:40390,64100:40391,64101:40392,64102:40393,64103:40394,64104:40395,64105:40396,64106:40397,64107:40398,64108:40399,64109:40400,64110:40401,64111:40402,64112:40403,64113:40404,64114:40405,64115:40406,64116:40407,64117:40408,64118:40409,64119:40410,64120:40411,64121:40412,64122:40413,64123:40414,64124:40415,64125:40416,64126:40417,64128:40418,64129:40419,64130:40420,64131:40421,64132:40422,64133:40423,64134:40424,64135:40425,64136:40426,64137:40427,64138:40428,64139:40429,64140:40430,64141:40431,64142:40432,64143:40433,64144:40434,64145:40435,64146:40436,64147:40437,64148:40438,64149:40439,64150:40440,64151:40441,64152:40442,64153:40443,64154:40444,64155:40445,64156:40446,64157:40447,64158:40448,64159:40449,64160:40450,64161:58096,64162:58097,64163:58098,64164:58099,64165:58100,64166:58101,64167:58102,64168:58103,64169:58104,64170:58105,64171:58106,64172:58107,64173:58108,64174:58109,64175:58110,64176:58111,64177:58112,64178:58113,64179:58114,64180:58115,64181:58116,64182:58117,64183:58118,64184:58119,64185:58120,64186:58121,64187:58122,64188:58123,64189:58124,64190:58125,64191:58126,64192:58127,64193:58128,64194:58129,64195:58130,64196:58131,64197:58132,64198:58133,64199:58134,64200:58135,64201:58136,64202:58137,64203:58138,64204:58139,64205:58140,64206:58141,64207:58142,64208:58143,64209:58144,64210:58145,64211:58146,64212:58147,64213:58148,64214:58149,64215:58150,64216:58151,64217:58152,64218:58153,64219:58154,64220:58155,64221:58156,64222:58157,64223:58158,64224:58159,64225:58160,64226:58161,64227:58162,64228:58163,64229:58164,64230:58165,64231:58166,64232:58167,64233:58168,64234:58169,64235:58170,64236:58171,64237:58172,64238:58173,64239:58174,64240:58175,64241:58176,64242:58177,64243:58178,64244:58179,64245:58180,64246:58181,64247:58182,64248:58183,64249:58184,64250:58185,64251:58186,64252:58187,64253:58188,64254:58189,64320:40451,64321:40452,64322:40453,64323:40454,64324:40455,64325:40456,64326:40457,64327:40458,64328:40459,64329:40460,64330:40461,64331:40462,64332:40463,64333:40464,64334:40465,64335:40466,64336:40467,64337:40468,64338:40469,64339:40470,64340:40471,64341:40472,64342:40473,64343:40474,64344:40475,64345:40476,64346:40477,64347:40478,64348:40484,64349:40487,64350:40494,64351:40496,64352:40500,64353:40507,64354:40508,64355:40512,64356:40525,64357:40528,64358:40530,64359:40531,64360:40532,64361:40534,64362:40537,64363:40541,64364:40543,64365:40544,64366:40545,64367:40546,64368:40549,64369:40558,64370:40559,64371:40562,64372:40564,64373:40565,64374:40566,64375:40567,64376:40568,64377:40569,64378:40570,64379:40571,64380:40572,64381:40573,64382:40576,64384:40577,64385:40579,64386:40580,64387:40581,64388:40582,64389:40585,64390:40586,64391:40588,64392:40589,64393:40590,64394:40591,64395:40592,64396:40593,64397:40596,64398:40597,64399:40598,64400:40599,64401:40600,64402:40601,64403:40602,64404:40603,64405:40604,64406:40606,64407:40608,64408:40609,64409:40610,64410:40611,64411:40612,64412:40613,64413:40615,64414:40616,64415:40617,64416:40618,64417:58190,64418:58191,64419:58192,64420:58193,64421:58194,64422:58195,64423:58196,64424:58197,64425:58198,64426:58199,64427:58200,64428:58201,64429:58202,64430:58203,64431:58204,64432:58205,64433:58206,64434:58207,64435:58208,64436:58209,64437:58210,64438:58211,64439:58212,64440:58213,64441:58214,64442:58215,64443:58216,64444:58217,64445:58218,64446:58219,64447:58220,64448:58221,64449:58222,64450:58223,64451:58224,64452:58225,64453:58226,64454:58227,64455:58228,64456:58229,64457:58230,64458:58231,64459:58232,64460:58233,64461:58234,64462:58235,64463:58236,64464:58237,64465:58238,64466:58239,64467:58240,64468:58241,64469:58242,64470:58243,64471:58244,64472:58245,64473:58246,64474:58247,64475:58248,64476:58249,64477:58250,64478:58251,64479:58252,64480:58253,64481:58254,64482:58255,64483:58256,64484:58257,64485:58258,64486:58259,64487:58260,64488:58261,64489:58262,64490:58263,64491:58264,64492:58265,64493:58266,64494:58267,64495:58268,64496:58269,64497:58270,64498:58271,64499:58272,64500:58273,64501:58274,64502:58275,64503:58276,64504:58277,64505:58278,64506:58279,64507:58280,64508:58281,64509:58282,64510:58283,64576:40619,64577:40620,64578:40621,64579:40622,64580:40623,64581:40624,64582:40625,64583:40626,64584:40627,64585:40629,64586:40630,64587:40631,64588:40633,64589:40634,64590:40636,64591:40639,64592:40640,64593:40641,64594:40642,64595:40643,64596:40645,64597:40646,64598:40647,64599:40648,64600:40650,64601:40651,64602:40652,64603:40656,64604:40658,64605:40659,64606:40661,64607:40662,64608:40663,64609:40665,64610:40666,64611:40670,64612:40673,64613:40675,64614:40676,64615:40678,64616:40680,64617:40683,64618:40684,64619:40685,64620:40686,64621:40688,64622:40689,64623:40690,64624:40691,64625:40692,64626:40693,64627:40694,64628:40695,64629:40696,64630:40698,64631:40701,64632:40703,64633:40704,64634:40705,64635:40706,64636:40707,64637:40708,64638:40709,64640:40710,64641:40711,64642:40712,64643:40713,64644:40714,64645:40716,64646:40719,64647:40721,64648:40722,64649:40724,64650:40725,64651:40726,64652:40728,64653:40730,64654:40731,64655:40732,64656:40733,64657:40734,64658:40735,64659:40737,64660:40739,64661:40740,64662:40741,64663:40742,64664:40743,64665:40744,64666:40745,64667:40746,64668:40747,64669:40749,64670:40750,64671:40752,64672:40753,64673:58284,64674:58285,64675:58286,64676:58287,64677:58288,64678:58289,64679:58290,64680:58291,64681:58292,64682:58293,64683:58294,64684:58295,64685:58296,64686:58297,64687:58298,64688:58299,64689:58300,64690:58301,64691:58302,64692:58303,64693:58304,64694:58305,64695:58306,64696:58307,64697:58308,64698:58309,64699:58310,64700:58311,64701:58312,64702:58313,64703:58314,64704:58315,64705:58316,64706:58317,64707:58318,64708:58319,64709:58320,64710:58321,64711:58322,64712:58323,64713:58324,64714:58325,64715:58326,64716:58327,64717:58328,64718:58329,64719:58330,64720:58331,64721:58332,64722:58333,64723:58334,64724:58335,64725:58336,64726:58337,64727:58338,64728:58339,64729:58340,64730:58341,64731:58342,64732:58343,64733:58344,64734:58345,64735:58346,64736:58347,64737:58348,64738:58349,64739:58350,64740:58351,64741:58352,64742:58353,64743:58354,64744:58355,64745:58356,64746:58357,64747:58358,64748:58359,64749:58360,64750:58361,64751:58362,64752:58363,64753:58364,64754:58365,64755:58366,64756:58367,64757:58368,64758:58369,64759:58370,64760:58371,64761:58372,64762:58373,64763:58374,64764:58375,64765:58376,64766:58377,64832:40754,64833:40755,64834:40756,64835:40757,64836:40758,64837:40760,64838:40762,64839:40764,64840:40767,64841:40768,64842:40769,64843:40770,64844:40771,64845:40773,64846:40774,64847:40775,64848:40776,64849:40777,64850:40778,64851:40779,64852:40780,64853:40781,64854:40782,64855:40783,64856:40786,64857:40787,64858:40788,64859:40789,64860:40790,64861:40791,64862:40792,64863:40793,64864:40794,64865:40795,64866:40796,64867:40797,64868:40798,64869:40799,64870:40800,64871:40801,64872:40802,64873:40803,64874:40804,64875:40805,64876:40806,64877:40807,64878:40808,64879:40809,64880:40810,64881:40811,64882:40812,64883:40813,64884:40814,64885:40815,64886:40816,64887:40817,64888:40818,64889:40819,64890:40820,64891:40821,64892:40822,64893:40823,64894:40824,64896:40825,64897:40826,64898:40827,64899:40828,64900:40829,64901:40830,64902:40833,64903:40834,64904:40845,64905:40846,64906:40847,64907:40848,64908:40849,64909:40850,64910:40851,64911:40852,64912:40853,64913:40854,64914:40855,64915:40856,64916:40860,64917:40861,64918:40862,64919:40865,64920:40866,64921:40867,64922:40868,64923:40869,64924:63788,64925:63865,64926:63893,64927:63975,64928:63985,64929:58378,64930:58379,64931:58380,64932:58381,64933:58382,64934:58383,64935:58384,64936:58385,64937:58386,64938:58387,64939:58388,64940:58389,64941:58390,64942:58391,64943:58392,64944:58393,64945:58394,64946:58395,64947:58396,64948:58397,64949:58398,64950:58399,64951:58400,64952:58401,64953:58402,64954:58403,64955:58404,64956:58405,64957:58406,64958:58407,64959:58408,64960:58409,64961:58410,64962:58411,64963:58412,64964:58413,64965:58414,64966:58415,64967:58416,64968:58417,64969:58418,64970:58419,64971:58420,64972:58421,64973:58422,64974:58423,64975:58424,64976:58425,64977:58426,64978:58427,64979:58428,64980:58429,64981:58430,64982:58431,64983:58432,64984:58433,64985:58434,64986:58435,64987:58436,64988:58437,64989:58438,64990:58439,64991:58440,64992:58441,64993:58442,64994:58443,64995:58444,64996:58445,64997:58446,64998:58447,64999:58448,65e3:58449,65001:58450,65002:58451,65003:58452,65004:58453,65005:58454,65006:58455,65007:58456,65008:58457,65009:58458,65010:58459,65011:58460,65012:58461,65013:58462,65014:58463,65015:58464,65016:58465,65017:58466,65018:58467,65019:58468,65020:58469,65021:58470,65022:58471,65088:64012,65089:64013,65090:64014,65091:64015,65092:64017,65093:64019,65094:64020,65095:64024,65096:64031,65097:64032,65098:64033,65099:64035,65100:64036,65101:64039,65102:64040,65103:64041,65104:11905,65105:59414,65106:59415,65107:59416,65108:11908,65109:13427,65110:13383,65111:11912,65112:11915,65113:59422,65114:13726,65115:13850,65116:13838,65117:11916,65118:11927,65119:14702,65120:14616,65121:59430,65122:14799,65123:14815,65124:14963,65125:14800,65126:59435,65127:59436,65128:15182,65129:15470,65130:15584,65131:11943,65132:59441,65133:59442,65134:11946,65135:16470,65136:16735,65137:11950,65138:17207,65139:11955,65140:11958,65141:11959,65142:59451,65143:17329,65144:17324,65145:11963,65146:17373,65147:17622,65148:18017,65149:17996,65150:59459,65152:18211,65153:18217,65154:18300,65155:18317,65156:11978,65157:18759,65158:18810,65159:18813,65160:18818,65161:18819,65162:18821,65163:18822,65164:18847,65165:18843,65166:18871,65167:18870,65168:59476,65169:59477,65170:19619,65171:19615,65172:19616,65173:19617,65174:19575,65175:19618,65176:19731,65177:19732,65178:19733,65179:19734,65180:19735,65181:19736,65182:19737,65183:19886,65184:59492,65185:58472,65186:58473,65187:58474,65188:58475,65189:58476,65190:58477,65191:58478,65192:58479,65193:58480,65194:58481,65195:58482,65196:58483,65197:58484,65198:58485,65199:58486,65200:58487,65201:58488,65202:58489,65203:58490,65204:58491,65205:58492,65206:58493,65207:58494,65208:58495,65209:58496,65210:58497,65211:58498,65212:58499,65213:58500,65214:58501,65215:58502,65216:58503,65217:58504,65218:58505,65219:58506,65220:58507,65221:58508,65222:58509,65223:58510,65224:58511,65225:58512,65226:58513,65227:58514,65228:58515,65229:58516,65230:58517,65231:58518,65232:58519,65233:58520,65234:58521,65235:58522,65236:58523,65237:58524,65238:58525,65239:58526,65240:58527,65241:58528,65242:58529,65243:58530,65244:58531,65245:58532,65246:58533,65247:58534,65248:58535,65249:58536,65250:58537,65251:58538,65252:58539,65253:58540,65254:58541,65255:58542,65256:58543,65257:58544,65258:58545,65259:58546,65260:58547,65261:58548,65262:58549,65263:58550,65264:58551,65265:58552,65266:58553,65267:58554,65268:58555,65269:58556,65270:58557,65271:58558,65272:58559,65273:58560,65274:58561,65275:58562,65276:58563,65277:58564,65278:58565}
}),define("util/comparator",["underscore","vendor/gbk"],function(_,gbk){"use strict";function toGbk(str){var buf=[];return _.each(str,function(substr){var code=substr.charCodeAt(0);buf.push(code>=19968&&40895>=code?map[code]:code)}),String.fromCharCode.apply(String,buf)}var map=_.invert(gbk);return function(t1,t2){return t1=toGbk(t1),t2=toGbk(t2),t1>t2?1:t1===t2?0:-1}}),define("pagelet/note/import/ynoteSelector/dialog",["underscore","util/comparator"],function(_,comparator){"use strict";return function($scope,noteManager){var $dialog=$scope.$dialog,ynoteManager=noteManager.ynote,notebookCompr=function(i1,i2){return comparator(i1.title,i2.title)},ynoteCompr=function(n1,n2){return n2.modifyTime-n1.modifyTime};$scope.selection=[],$scope.multiple=$scope.multiple||!1,ynoteManager.listNotebook(!1).then(function(notebooks){var groups=_.groupBy(_.filter(notebooks,function(notebook){return""!=notebook.group}),"group"),roots=_.map(groups,function(notebooks,group){return{title:group}}).concat(_.where(notebooks,{group:""}));roots.sort(notebookCompr),$scope.getNotebook=function(root){var notebooks=groups[root.title];return notebooks.sort(notebookCompr),notebooks},$scope.fetch=function(notebook){_.isArray(notebook.ynotes)||ynoteManager.listNotes(notebook.path).then(function(ynotes){ynotes.sort(ynoteCompr),notebook.ynotes=ynotes})},$scope.toggleSelect=function(ynote){var index=$scope.selection.indexOf(ynote);$scope.multiple?-1==index?$scope.selection.push(ynote):$scope.selection.splice(index,1):$scope.selection=[ynote]},$scope.finish=function(){return $dialog.dismiss({selection:$scope.selection,isYDocUser:!1})},$scope.roots=roots})}}),define("pagelet/note/import/ydocSelector/importNote",["underscore","util/comparator","util/keycode"],function(_,comparator,KEYCODE){"use strict";function comparator(f1,f2){function type(f1,f2){return f1.isFolder&&!f2.isFolder?-1:!f1.isFolder&&f2.isFolder?1:0}var t=type(f1,f2);if(0!==t)return t;var t1=f1.modifyTime,t2=f2.modifyTime;return t1!==t2?t2-t1:f1.name.toLowerCase().localeCompare(f2.name.toLowerCase())}return function($scope,noteManager){function filter(file){if("undefined"!=typeof $scope.isNote){var isNote=0===file.domain;return $scope.isNote===isNote}return!0}function doOpen(notebooks){$scope.expanded=!0,$scope.selected=!0,$scope.treeFiles=notebooks,_.each(notebooks,function(notebook){stackCache[notebook.id]=[new noteManager.StackFile({id:notebook.id,name:notebook.name})],stackCache[notebook.id][stackCache[notebook.id].length-1].isLast=!0}),showDetailByPath("/")}function showDetailByPath(path){ynoteManager.listNotebook(!0,path,1,!1).then(function(result){$scope.visibleFiles=result.sort(comparator).filter(filter)})}function pushStackCache(folderId,files){stackCache[folderId]&&_.each(_.filter(files,function(v){return v.isFolder}),function(file){stackCache[file.id]=stackCache[folderId].concat(new noteManager.StackFile({id:file.id,name:file.name})),stackCache[file.id][stackCache[file.id].length-2].isLast=!1,stackCache[file.id][stackCache[file.id].length-1].isLast=!0})}function showDetailById(selectedFolder){$scope.pathList=stackCache[selectedFolder.id],$scope.selection=[],$scope.visibleFiles=[],ynoteManager.listNotebook(!0,void 0,void 0,!1,selectedFolder.id).then(function(result){$scope.visibleFiles=result.sort(comparator).filter(filter),pushStackCache(selectedFolder.id,$scope.visibleFiles)})}var lastSelected,$dialog=$scope.$dialog,ynoteManager=noteManager.ynote,stackCache={};$scope.selection=[],$scope.pathList=[],$scope.multiple=$scope.multiple||!1,$scope.toggleRoot=function(){$scope.expanded=!$scope.expanded},$scope.selectRoot=function(){$scope.pathList=[],showDetailByPath("/"),$scope.selected=!0,$scope.$broadcast("import.filetree.change")},$scope.open=function(selectedFolder){selectedFolder.isFolder&&(showDetailById(selectedFolder),$scope.selected=!1,$scope.$broadcast("import.filetree.change",selectedFolder))},$scope.toggleFile=function(e,file){if(e.shiftKey&&$scope.multiple){var fromIndex=$scope.visibleFiles.indexOf(lastSelected),toIndex=$scope.visibleFiles.indexOf(file);-1===fromIndex&&(fromIndex=0),-1!==toIndex&&($scope.selection=_.map($scope.visibleFiles.slice(Math.min(fromIndex,toIndex),Math.max(fromIndex,toIndex)+1),function(file){return $scope.firstSelectionName=file.name,file.id}))}else($scope.multiple||!file.isFolder)&&(lastSelected=file,$scope.isSelected(file)?($scope.firstSelectionName=file.name,$scope.selection=_.without($scope.selection,file.id)):($scope.multiple||$scope.selection.pop(),$scope.firstSelectionName=file.name,$scope.selection.push(file.id)));e.stopPropagation()},$scope.isSelected=function(file){return-1!==$scope.selection.indexOf(file.id)},ynoteManager.listNotebook(!0,"/",void 0,!0).then(function(notebooks){doOpen(notebooks)}),$(window).on("keydown",function(evt){-1===["TEXTAREA","INPUT"].indexOf(evt.target.tagName)&&(evt.ctrlKey||evt.metaKey)&&evt.keyCode===KEYCODE.A&&($scope.selection=_.map($scope.visibleFiles,function(v){return $scope.firstSelectionName=file.name,v.id}),$scope.$digest(),evt.preventDefault())}),$scope.$on("import.select",function($evt,selectedFolder){$scope.open(selectedFolder)}),$scope.$on("import.expand",function($evt,expandedFolder,children){pushStackCache(expandedFolder.id,children)}),$scope.finish=function(){return $dialog.dismiss({selection:$scope.selection,firstSelectionName:$scope.firstSelectionName,isYDocUser:!0})}}}),define("pagelet/note/import/ydocSelector/importFileTreeSelectNodeCtrl",["underscore","jquery"],function(){"use strict";function comparator(f1,f2){return f1.name.toLowerCase().localeCompare(f2.name.toLowerCase())}return function($scope,noteMgr,viewport,explorer,launcher){function init(treeFile){void 0!==treeFile&&($scope.name=$scope.treeFile.name,$scope.expanded=!1,$scope.selected="",$scope.toggle=toggle,$scope.select=select,$scope.expandable=$scope.treeFile.expandable)}function toggle(){$scope.expanded?collapse():expand()}function expand(){ynoteManager.listNotebook(!0,void 0,void 0,!0,$scope.treeFile.id).then(function(treeFiles){$scope.treeFiles=treeFiles.sort(comparator),$scope.expandable=$scope.treeFiles.length>0,$scope.expanded=!0,$scope.$emit("import.expand",$scope.treeFile,treeFiles)})}function collapse(){$scope.expanded=!1}function select(treeFile){$scope.$emit("import.select",treeFile)}function onFileSelect(evt,selectedFolder){selectedFolder&&$scope.treeFile&&selectedFolder.id===$scope.treeFile.id?(evt.preventDefault(),$scope.selected=!0):$scope.selected=!1}var ynoteManager=(launcher.gid(),noteMgr.ynote);$scope.treeFiles=[],$scope.$watch("treeFiles",function(treeFiles){treeFiles.sort(comparator),$scope.treeFiles=treeFiles,$scope.expandable=$scope.treeFiles.length>0,$scope.expanded=!0},!0),$scope.expand=expand,$scope.$watch("treeFile",init),$scope.$on("import.filetree.change",onFileSelect)}}),define("pagelet/note/msg/message",[],function(){"use strict";return function($scope){function ChatUser(json){this.userId=json.userId,this.name=json.name?String(json.name):void 0,this.photo=json.photo?String(json.photo):void 0}function NoteMessage(json){this.type=5,this.id=json.id?Number(json.id):void 0,this.groupId=json.groupId?Number(json.groupId):void 0,this.longInterval=Boolean(json.longInterval),this.time=json.time?Number(json.time):void 0,this.user=new ChatUser(json.user),this.operation=Number(json.operation),this.noteId=json.noteId?String(json.noteId):void 0,this.parentId=Number(json.parentId),this.title=json.title?String(json.title):"无标题笔记",this.summary=json.summary?String(json.summary):void 0,this.thumbnailId=json.thumbnailId?String(json.thumbnailId):void 0,this.version=Number(json.version)}var noteMsg=$scope.message.data;$scope.noteMsg=new NoteMessage(noteMsg),$scope.file={name:noteMsg.title+".note",isFolder:!1}}}),define("pagelet/note/plugin/plugin",["underscore","util/tracker","jquery"],function(_,tracker,$){"use strict";return function($rootScope,$q,$location,explorer,viewport,launcher,dialogs,noteMgr,storageMgr,permission,filePermission,LOCAL_STORAGE_KEY,fileManager){function openNoteViewport(params){console.log("Do Change page."),inCollabMode=USECOLLAB&&!params.uncollab,inCollabMode?viewport.open("collab",params):viewport.open("note",params)}function importNote(folder){return $rootScope.$broadcast("note.importDialog.open"),dialogs.open({src:"pagelet/note/import/importer.html",title:"我的笔记",gid:launcher.gid(),folder:folder}).then(function(status){return"成功导入"+status.finishedCount+"篇笔记"}).finally(function(){$rootScope.$broadcast("note.importDialog.close")})}function createNote(folder){return baseRouter.forward("/note",{folderId:folder.id})}function openNote(fileId,version,opt){return baseRouter.forward("/note/"+fileId,opt)}function contextMenuFilter(files,menuOption,folder,fromTools){function checkPermission(afterPos,action,title,cb,parent,otherOpt){filePermission.check("note."+action,files)&&(parent?menuOption.appendChildren(parent,action,title,cb,otherOpt):afterPos?menuOption.insertAfter(afterPos,action,title,cb,otherOpt):menuOption.append(action,title,cb,otherOpt))}function extName(name){if(name){var dotIndex=name.lastIndexOf(".");return name.slice(dotIndex+1)}}function importNewVersion(){var note=files[0],storage=storageMgr.forUser(launcher.uid()),tempFavorite=note.favorite,userInfo=launcher.getUser();fileManager.getModifiers(launcher.gid(),note.id).then(function(data){if(data&&data.length>1)dialogs.alert("导入新版本",data[0].name+" 等人正在编辑，请稍后操作。");else{if(!data||1!==data.length||data[0].userId===userInfo.userId)return dialogs.open({title:"导入新版本",src:launcher.getUser().isYDocUser?"pagelet/note/import/ydocSelector/importNote.html":"pagelet/note/import/ynoteSelector/dialog.html",width:launcher.getUser().isYDocUser?700:400,height:500,isNote:0===note.domain}).then(function(result){var resultName=result.firstSelectionName,resultType=extName(resultName);return 0===note.domain||extName(note.name)===resultType?result:dialogs.confirm("导入新版本","您上传的文件类型与当前版本不一致，确定要继续上传？",{width:340}).then(function(){return result})}).then(function(result){return console.log(note),launcher.getUser().isYDocUser?noteMgr.importFromYDoc(launcher.gid(),note,result.selection[0]):noteMgr.importFromMyNote(launcher.gid(),note.id,result.selection[0])}).then(function(newNote){return storage.remove(LOCAL_STORAGE_KEY.NOTE_PREFIX+newNote.id),newNote.favorite=tempFavorite,_.extend(note,newNote),$rootScope.$broadcast("note.import",newNote),"成功导入笔记"}).catch(function(e){return e&&"20108"===e.error?dialogs.alert("导入新版本","目录中有重名笔记，导入失败"):e&&dialogs.alert("导入新版本","导入失败"),$q.reject()});dialogs.alert("恢复到历史版本",data[0].name+" 正在编辑，请稍后操作。")}}).catch(function(e){e&&e.data&&e.data.error&&dialogs.alert("恢复到历史版本","出现问题，请稍后重试。")})}if(folder)return void(filePermission.check("note.import",folder)&&menuOption.append("note.import","导入笔记",function(folder){importNote(folder)}));if(1===files.length){var file=files[0],isNote=/\.note$/.test(file.name)&&0===file.domain,isFolder=file.isFolder,isTable=2===file.domain,isYDocUser=launcher.getUser().isYDocUser,ableToUpload=!file.isFolder&&explorer.ableToUpload(file),ableToImport=isNote||isYDocUser&&!isTable&&!isFolder;fromTools?ableToImport&&checkPermission("trace","importNewVersion","导入新版本",importNewVersion):ableToUpload&&ableToImport?checkPermission(void 0,"importNewVersion","导入新版本",importNewVersion,"update"):ableToImport&&checkPermission("trace","importNewVersion","导入新版本",importNewVersion)}}function traceNote(file,version){dialogs.open({src:"pagelet/note/diffview/noteDiff.html",title:"历史版本比较",note:file.data||file,width:823,height:500,cls:"diff",version:version,gid:launcher.gid(),canFullScreen:!0}).then(function(){})}function print(){return inCollabMode?$("#collab-editor").get(0).contentWindow.print():$("iframe[note-content]")[0].contentWindow.print(),null}var baseRouter,inCollabMode,TOOL_SRC="pagelet/note/plugin/tool-create.html",MAIN_VIEW_SRC="pagelet/note/editor/editor.html",COLLAB_VIEW_SRC="pagelet/note/editor/collab/collab.html",USECOLLAB=!0;launcher.wait().then(function(){baseRouter=launcher.getGroupRouter(),baseRouter.bind("/note/{fileId}",openNoteViewport),baseRouter.bind("/note",openNoteViewport)}),explorer.extendType(function(register){register("笔记",/.+\.note$/,0,{routerPrefix:"note",open:openNote,create:createNote,trace:traceNote,upload:!1,download:!1,print:print})}),explorer.extendTools(function(register){register({src:TOOL_SRC,text:"从我的笔记导入",handler:importNote,perKey:"note.import"})}),explorer.extendContextMenu(function(register){register(contextMenuFilter)}),viewport.extendView(function(register){register("note",MAIN_VIEW_SRC)}),viewport.extendView(function(register){register("collab",COLLAB_VIEW_SRC)})}}),define("pagelet/note/noteInit",["underscore"],function(){"use strict";return function(notePlugin,chatTemplate,permission,ROLES,MESSAGE_TYPE){chatTemplate.extendTemplate(function(data){return data.type===MESSAGE_TYPE.GROUPNOTE?(data.templateUrl="pagelet/note/msg/message.html",data.tipUrl="pagelet/note/msg/message-tip.html",!1):void 0}),permission.register(ROLES.GROUP_FOUNDER,["note.*"]),permission.register(ROLES.GROUP_MANAGER,["note.*"]),permission.register(ROLES.GROUP_EDITOR,["note.*"]),permission.deregister(ROLES.ORG_EXPIRED,["note.edit","note.import","note.revert","note.importNewVersion","note.draftHint"])}}),define("pagelet/note/search/contentSearchDirective",["jquery","underscore","util/keycode"],function($,_,KEYCODE){return function(){function link(scope,element){function isHidden(){return null===element.get(0).offsetParent}function goto(targetPos){scope.currentHit>-1&&$(scope.hitList[scope.currentHit]).removeClass("current"),scope.currentHit=(targetPos+scope.hitList.length)%scope.hitList.length;var targetNode=scope.hitList[scope.currentHit];$(targetNode).addClass("current"),targetNode.scrollIntoView()}function gotoNext(){goto(scope.currentHit+1)}function gotoPre(){goto(scope.currentHit-1)}function cancel(){scope.$emit("note.search.close")}function listenEnter(evt){evt.keyCode===KEYCODE.ENTER&&(scope.$apply("gotoNext()"),evt.target.focus())}scope.hitList=[],scope.currentHit=0,scope.gotoNext=gotoNext,scope.gotoPre=gotoPre,scope.cancel=cancel,$(element.find("input")[0]).focus().off("keydown",listenEnter).on("keydown",listenEnter),scope.$watch("searchResult.list",function(resultList){scope.hitList=_.reduce(resultList,function(memo,currentNode){return _.forEach(currentNode.childNodes,function(childNode){"EM"===childNode.tagName&&memo.push(childNode)}),memo},[]),resultList.length>0?(scope.currentHit=-1,gotoNext()):scope.currentHit=0}),scope.$watch(isHidden,function(hidden){if(!hidden){var targetNode=scope.hitList[scope.currentHit];targetNode&&targetNode.scrollIntoView()}})}return{restrict:"A",link:link,templateUrl:"pagelet/note/search/search-panel.html"}}}),define("pagelet/note/demo/demoService",["jquery","underscore"],function($,_){"use strict";return function($compile,$http,$templateCache,$q,$rootScope,$timeout,downloadService){function setNote(title,content){getNoteContent=_.isFunction(content)?function(){return'<header><h1 style="text-align: center; font-size: 48px; margin-top: 100px; margin-bottom: 100px;">'+title+"</h1></header>"+content()}:function(){return'<header><h1 style="text-align: center; font-size: 48px; margin-top: 100px; margin-bottom: 100px;">'+title+"</h1></header>"+content}}function init(){$timeout(function(){_.isUndefined(article)||article.css("zoom",1.5)},0)}function create(){function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen()}function zoomIn(){_.isUndefined(article)||0===article.length||(tempZoom=Number(article.css("zoom")),tempZoom>=3||(tempZoom+=.25,article.css("zoom",tempZoom)))}function zoomOut(){_.isUndefined(article)||0===article.length||(tempZoom=Number(article.css("zoom")),1>=tempZoom||(tempZoom-=.25,article.css("zoom",tempZoom)))}function exitDemoMode(){exitFullscreen(),close(!0)}var deferred=$q.defer();return scope=$rootScope.$new(),scope.zoomIn=zoomIn,scope.zoomOut=zoomOut,scope.exitDemoMode=exitDemoMode,scope.$on("lab.enterDemo",init),$http.get(DEMO_PAGE_TPL,{cache:$templateCache}).success(function(data){el=$(data),el.appendTo($(document.body)),$compile(el)(scope),deferred.resolve()}),deferred.promise}function open(){var opener=function(){iframeElement=$(el[0]).find("iframe")[0],doc=$(iframeElement.contentWindow.document),body=doc.find("body"),head=doc.find("head"),head.append('<link rel="stylesheet" href="./style/note.css">').append('<link rel="stylesheet" href="./style/demoMode.css">'),body.empty(),article=$('<article class="editor-area" ng-mouseover="over()" ng-mouseleave="leave()"></article>').css({padding:"10px 0px 10px 0"}).html(getNoteContent()).appendTo(body);var articleScope=$rootScope.$new();articleScope.over=function(){scope.inDemoArea=!0},articleScope.leave=function(){scope.inDemoArea=!1},$compile(article)(articleScope),body.delegate("a","click",function(e){var $el=$(e.currentTarget);$el.attr("target","_blank")}),body.delegate("img","click",function(e){var $el=$(e.currentTarget);return $el.attr("path")?void downloadService.download($el.attr("title")||$el.attr("filename"),$el.attr("path").replace(/^http:\/\/note\.youdao\.com/i,"")):void $(document.activeElement).blur()}),article.css("zoom",1.5),el.show()};el?opener():create().then(opener)}function close(isFullScreen){isFullScreen&&el.hide()}var el,scope,iframeElement,doc,body,head,article,tempZoom,DEMO_PAGE_TPL="pagelet/note/demo/tpl.html",getNoteContent=function(){return""};return document.addEventListener&&(document.addEventListener("webkitfullscreenchange",function(){close(!document.webkitIsFullScreen)},!1),document.addEventListener("fullscreenchange",function(){close(!document.isFullScreen)},!1)),{invoke:open,dismiss:close,setNote:setNote}}}),define("pagelet/note/editor/collab/collabCtrl",["jquery","util/fileValidator","util/tracker","util/trackTiming","underscore"],function($,validator,tracker,trackTiming,_){"use strict";return function($scope,$location,$q,$interval,$timeout,viewport,launcher,explorer,router,dialogs,noteMgr,fileMgr,storageMgr,titleService,$element,filePermission,demoService,$rootScope,LOCAL_STORAGE_KEY,collabService){function CheckAndSave(){isDirty()&&saveToLocal()}function showEditorLoading(){$scope.loading=!0}function showParentLoading(){$scope.$parent.$parent.loading=!0}function hideAllLoading(){$scope.commentLoading=!1,$scope.$parent.$parent.loading=!1,$scope.loading=!1}function isChanged(){return $scope.localCommand.length>0}function rebuitToNoCollab(){$scope.reBuildTimes=0,hint("多次重连失败，返回普通模式","warning"),$scope.goToNoCollab()}function onOpen(opt){function loadSuccess(res){var file=res[0];prepareEditing(),$scope.state.more=!1,editing(),hideAllLoading(),$scope.commentId=cid,cid&&($scope.max=!1),bindAll(),$timeout(function(){trackTiming.openNote.end().send().clear()}),$scope.openDeferred.resolve(file.name)}var fileId=opt.fileId,cid=opt.commentId,folderId=opt.folderId,gid=opt.gid,userInfo=launcher.getUser(),shareKey=String(gid)+"_"+String(fileId),onceCheck=_.once(checkStorage);return $scope.openDeferred=$q.defer(),showParentLoading(),xmlContentReady=$q.defer(),fileMetaReady=$q.defer(),htmlContentReady=$q.defer(),$scope.isNew=!fileId,$scope.fileId=fileId,$scope.hideFlag=!0,$scope.openDeferred.promise.then(function(){$scope.hideFlag=!1}),fileId?($scope.resetEditorOptions?$scope.resetEditorOptions({userInfo:{userId:userInfo.userId,nickname:userInfo.name,portraitUrl:userInfo.photo},shareKey:shareKey}):(window.loadFile=shareKey,window.userInfo={userId:userInfo.userId,nickname:userInfo.name,portraitUrl:userInfo.photo}),$q.all([fileMetaReady.promise,xmlContentReady.promise,htmlContentReady.promise]).catch(function(e){var reason="";hideAllLoading(),"20101"===e.error?reason="笔记不存在或已经被删除":"260"===e.error&&(reason="无法查看该笔记，仅群管理员或群主可见"),dialogs.alert("打开笔记","打开笔记失败"+(reason?"，"+reason:"")),$scope.openDeferred.reject(),onClose()}),htmlContentReady.promise.then(function(data){$scope.htmlContent=filterContent(data),demoService.setNote($scope.title,$scope.htmlContent)}),xmlContentReady.promise.then(function(data){$scope.content=filterContent(data)}),fileMgr.getFile($scope.gid(),fileId).then(function(file){var success=_.once(function(){$q.all([fileMetaReady.promise,xmlContentReady.promise]).then(loadSuccess)});$scope.mode=filePermission.check("note.edit",file)?"edit":"view",setNote(file),$scope.state.more=!1,$scope.state.nomore=!1,$scope.meta=!!storage.get(LOCAL_STORAGE_KEY.FILE_META_EXPANDED),$scope.commentLoading=!0,$scope.buildSession(),preventCheck=!0,"view"===$scope.mode?(noteMgr.getContent($scope.gid(),fileId,void 0,!0).then(function(htmlData){htmlContentReady.resolve(htmlData)},function(e){htmlContentReady.reject(e)}),$q.all([fileMetaReady.promise,htmlContentReady.promise]).then(loadSuccess),fileMetaReady.resolve(file)):$scope.registerBuiltListener(function(isCollabStarted){console.log(isCollabStarted);var check=!0;isCollabStarted||(check=onceCheck(file)),$q.when(check).then(function(){return collabService.doGet($scope.gid(),fileId,isCollabStarted)}).then(function(xmlData){isCollabStarted||fileMgr.getFile($scope.gid(),fileId).then(function(file){setNote(file),fileMetaReady.resolve(file)});var parser=new DOMParser,xmlDoc=$(parser.parseFromString(xmlData,"text/xml"));xmlDoc.find("note").attr("schema-version")>="1.0.1"?xmlContentReady.resolve(xmlData):(hint("正在对旧版笔记数据做格式转换","warning"),$scope.convert(xmlData,!0).then(function(data){collabService.doUpdate($scope.title,data,file,$scope.gid(),!0,!1,!1,void 0,!0).then(reloadNote)}))}).catch(function(e){xmlContentReady.reject(e)}),demoService.setNote($scope.title,function(){return $scope.getContent(!0)}),success(),isCollabStarted&&fileMetaReady.resolve(file)})},function(e){fileMetaReady.reject(e)}),$scope.openDeferred.promise):($scope.mode="edit",$scope.resetEditorOptions?($scope.resetEditorOptions({isCollabEnabled:!1}),$scope.clearEditor()):window.isCollabEnabled=!1,newNote(folderId).then(function(){$scope.commentId=cid,cid&&($scope.max=!1),bindAll(),hideAllLoading(),$scope.openDeferred.resolve("新建笔记")}))}function clear(){return hasLocalModification()||clearLocal(),$scope.note=$scope.title=$scope.content=$scope.temp.title=$scope.hint=null,$scope.localCommand=[],autoSaved=!1,autoSave={},!0}function onClose(){$scope.note&&$scope.note.id&&fileMgr.stopEdit($scope.gid(),$scope.note.id),$scope.closeCollabSession(),$scope.saving=!1,unbindAll(),clear()}function bindAll(){watchers=[router.before(interceptRouter),$scope.$on("comment.nomore",noMoreComment),$scope.$on("group.dismiss.this",purge),$scope.$on("group.quit.this",purge),$scope.$on("file.remove",onFileRemove),$scope.$watchCollection("note",onFileChanged),$scope.$on("note.import",reloadNote),$scope.$on("note.diff.revert",reloadNote),$scope.$on("file.update",onNoteUpdate)],$(window).on("beforeunload",interceptUnload),editingInterval=$interval(_.throttle(editing,15e3),15e3,0,!1)}function unbindAll(){$(window).unbind("beforeunload",interceptUnload),_.each(watchers,function(unwatch){unwatch()}),watchers=[],$interval.cancel(editingInterval),clearInterval(autoSave.interval),$scope.clearBuiltListener()}function purge(){unbindAll(),clear()}function interceptRouter(){if(hideAllLoading(),"view"!==$scope.mode&&!preventCheck)if($scope.isNew)CheckAndSave();else if(isDirty())return stopEdit()}function interceptUnload(){return"view"!==$scope.mode?$scope.isNew?CheckAndSave():isDirty()?preventCheck?void(preventCheck=!1):(hint("正在保存","warning"),save(),"您并未保存笔记数据，正在帮您存储,请留在此页面等待存储完成!"):void 0:void 0}function newNote(folderId){return $scope.note=null,$scope.modifiers=[],$scope.meta=!1,$scope.focusTitle=!0,$scope.folderId=folderId,$scope.title=$scope.content="",prepareEditing(),$q.when(null)}function setEditorContent(data){$scope.editorDeferred.promise.then(function(){$scope.setEditorContent(data)})}function checkStorage(file){var localCopy=storage.get(getLocalKey());return localCopy?dialogs.open({title:"提示",src:"pagelet/note/editor/save-local-copy.html",width:320,buttons:[{text:"是",handler:function($dialog){$dialog.dismiss()},cls:"primary"},{text:"删除草稿",cls:"cancel",handler:function($dialog){$dialog.cancel(!1)}}]}).then(function(){return collabService.doRewrite($scope.title,localCopy.content,file,launcher.getGroup().id,!0)}).finally(function(){clearLocal(),reloadNote()}).catch(function(){return $q.when(!0)}):$q.when(!0)}function prepareEditing(){var localCopy,content;$scope.isNew?(localCopy=storage.get(getLocalKey()),content=localCopy?localCopy.content:$scope.content):content=$scope.content,setEditorContent(content),$scope.temp.title=localCopy?localCopy.title:$scope.title,$scope.isChanged=!1,preventCheck=!1}function saveToLocal(force){var isNew=$scope.isNew,key=getLocalKey(),newContent=$scope.getContent(),newTitle=$scope.temp.title;isNew&&(newContent||newTitle)&&(console.log("save to local: "+newContent),storage.put(key,{ver:-1,content:newContent,title:newTitle},!0)&&hintSave(force))}function hintSave(force){force?explorer.hint("笔记已保存","success"):autoSaved||(explorer.hint("笔记已自动保存","success"),autoSaved=!0)}function clearLocal(){storage.remove(getLocalKey())}function editing(){return $scope.note?fileMgr.startEdit($scope.gid(),$scope.note.id).then(function(){}):$q.when()}function setNote(file){$scope.note=file,$scope.title=file.name.substring(0,file.name.lastIndexOf(".note")),fileMgr.getFilePath($scope.note.gid,$scope.note.parentId).then(function(path){$scope.filePath=path}).catch(function(){$scope.filePath="读取路径失败"})}function edit(){launcher.getGroupRouter().forward("/note/"+$scope.note.id)}function saveAndQuit(){return stopEdit().then(clear).then(function(saved){return saved?(preventCheck=!0,$scope.fullScreen?void window.close():quit()):void($scope.saving=!1)})}function quit(){return trackTiming.closeNote.clear().start(),explorer.restore()}function stopEdit(){return preventCheck?(preventCheck=!1,$q.when(!1)):save().then(function(saved){return $scope.note&&(fileMgr.stopEdit($scope.gid(),$scope.note.id),$scope.closeCollabSession()),saved}).finally(hideAllLoading)}function save(){function success(file){return $scope.localCommand=[],isNew?clearLocal():$scope.saveNotification(version),$scope.saving=!1,hideAllLoading(),setNote(file),file}function error(){hideAllLoading()}var errMsg,content=$scope.getContent(),title=$scope.temp.title,groupId=launcher.getGroup().id,folderId=$scope.folderId,isNew=$scope.isNew,version=$scope.getNoteVersion();return $scope.saving=!0,showEditorLoading(),$scope.isNew&&content?collabService.doCreate(title,content,groupId,folderId).then(success,error):isDirty()?(errMsg=validator(title,!0),errMsg?dialogs.alert("发布笔记",'标题含有不合法字符，请修改后再试。不合法字符包括 \\ / : * ? " < > | ').then(function(){return $scope.saving=!1,$q.reject()}):collabService.doUpdate(title,content,$scope.note,groupId,isChanged(),!1,!1,$scope.localCommand).then(success,error)):(hideAllLoading(),$q.when($scope.note))}function onlySaveContent(){var content=$scope.getContent(),title=$scope.title,groupId=launcher.getGroup().id,note=$scope.note;return collabService.doAutoSave(title,content,note,groupId)}function checkAutoSave(callback){var version=$scope.getNoteVersion();!$scope.saving&&version>autoSave.version?onlySaveContent().then(function(){autoSave.version=version,$scope.saveNotification(version),callback&&callback(),console.log("定时/快捷键保存成功")}):callback&&callback()}function intervarSaveContent(){autoSave.version=$scope.getNoteVersion(),autoSave.interval=setInterval(function(){checkAutoSave()},2e4)}function onFileRemove($evt,file){$scope.note&&$scope.note.id===file.id&&!$scope.saving&&saveOnFileRemove("保存","退出").catch(function(){preventCheck=!0,clear(),quit()})}function saveOnFileRemove(ok,cancel){return dialogs.confirm("发布笔记","该笔记已被群内其他成员删除了，是否保存为新的笔记？",{ok:ok,cancel:cancel}).then(function(){var content=$scope.getContent(),title=$scope.title,groupId=launcher.getGroup().id,note=$scope.note;collabService.doCreate(title,content,groupId,note.parentId).then(function(){return preventCheck=!0,quit()})})}function isDirty(){var titleChanged=$scope.temp.title!=$scope.title,contentChanged=$scope.getContent()!=$scope.content,versionChanged=isChanged();return $scope.isNew?titleChanged||contentChanged:titleChanged||versionChanged}function hasLocalModification(){if(!filePermission.check("note.edit",$scope.note))return!1;var localCopy=storage.get(getLocalKey());return localCopy?localCopy.title!=$scope.title||localCopy.content!=$scope.content:!1}function onFileChanged(note){note&&setNote(note)}function getLocalKey(){return $scope.note?"note_"+$scope.note.id:"note_new_"+$scope.gid()}function reloadNote(){var noteId=$scope.note.id;onClose(),$scope.openDeferred.resolve(),launcher.getGroupRouter().forward("/note/"+noteId)}function onNoteUpdate(evt,note){$scope.note&&$scope.note.id==note.id&&($scope.temp.title=$scope.title=note.data.name.substring(0,note.data.name.lastIndexOf(".note")),$scope.fullScreen&&titleService.set(titleService.Priority.FILENAME,note.name))}function onScroll(bottom){$scope.state.nomore||10>bottom&&$scope.$apply(function(){$scope.state.more=!0})}function hint(msg,theme){return explorer.hint(msg,theme)}function noMoreComment(){$scope.state.nomore=!0}function filterContent(content){return content}function onOpenFolder(fileId){explorer.locateFile(fileId)}var watchers,editingInterval,xmlContentReady,htmlContentReady,fileMetaReady,autoSaved=!1,preventCheck=!1,storage=storageMgr.forUser(launcher.uid()),autoSave={};$scope.state={},$scope.content=null,$scope.isNew=!1,$scope.temp={},$scope.loading=!1,$scope.$parent.$parent.loading=!1,$scope.commentLoading=!1,$scope.modifiers=[],$scope.more=!1,$scope.explorer=explorer,$scope.hasLocalModification=hasLocalModification,$scope.clearLocal=clearLocal,$scope.saveToLocal=saveToLocal,$scope.quit=quit,$scope.edit=edit,$scope.saveAndQuit=saveAndQuit,$scope.onScroll=onScroll,$scope.reBuildTimes=0,$scope.localCommand=[],$scope.editorDeferred=$q.defer(),$scope.openDeferred,$scope.filePath="",$scope.onOpenFolder=onOpenFolder,$scope.$invoke(onOpen),$scope.$open(onOpen),$scope.$close(onClose),$scope.rebuildSession=function(){var groupId=launcher.getGroup().id,note=$scope.note;return $scope.clearBuiltListener(),$scope.registerBuiltListener(function(isCollabStarted){collabService.doGet(groupId,note.id,isCollabStarted).then(function(data){$scope.content=data,prepareEditing(),$scope.openDeferred.resolve(),$scope.reBuildTimes=0,hint("协同服务已成功重连","success")})}),$scope.buildSession()},$scope.rebuiltAlert=function(){var content=$scope.getContent(),title=$scope.temp.title,groupId=launcher.getGroup().id,note=$scope.note;isChanged()?dialogs.alert("提示","协同服务断开，请将内容保存").then(function(){showEditorLoading(),collabService.doUpdate(title,content,note,groupId,isChanged(),!1,!1,$scope.localCommand).then(function(){$scope.localCommand=[],rebuitToNoCollab()})}):rebuitToNoCollab()},$scope.goToNoCollab=function(){hideAllLoading(),$scope.openDeferred.resolve(),launcher.getGroupRouter().forward("/note/"+$scope.note.id,{uncollab:!0})},$scope.sessionInitialized=function(result){"done"===result?(hideAllLoading(),intervarSaveContent()):"collabStarted"===result?(console.log("init failed: refetch note content..."),showEditorLoading(),collabService.doGet($scope.gid(),$scope.fileId,!0).then(function(noteData){setEditorContent(noteData)})):(console.warn("init fail: "+reason),preventCheck=!0,$scope.goToNoCollab())},$rootScope.$on("group.dismiss.copy",function(){"edit"===$scope.mode&&(preventCheck=!0)}),$scope.useKeySave=function(){return $scope.isNew?saveToLocal(!0):(clearInterval(autoSave.interval),checkAutoSave(function(){hintSave(!0)}),void intervarSaveContent())},$scope.setHint=hint}}),define("pagelet/note/editor/collab/collabDirective",["underscore","pagelet/note/editor/adapterFactory","util/keycode"],function(_){"use strict";function User(name,color,id,portrait){this.name=name,this.color=color,this.id=id,this.portrait=portrait}return function($parse,$injector,factory,dialogs,downloadService,menuService,uploader,client,selectFiles,launcher,$timeout){function link(scope,el){function onEditorChanged(){}function createLink(url,callback){scope.$apply(function promptInput(){dialogs.prompt(url?"编辑超链接":"插入超链接",url||"http://",{maxlength:500}).then(function(value){return/^(\w+):\/\/.+$/.test(value)?void callback(value):void dialogs.alert("插入超链接","请输入正确的超链接").then(promptInput)
})})}function createImage(url,callback){scope.$apply(function(){selectFiles.open(null,"resource","image/*").then(function(tasks){dialogs.open({gid:scope.gid(),title:url?"重新上传图片":"上传图片",src:"pagelet/note/editor/attachment.html",tasks:tasks}).then(function(data){setTimeout(function(){callback(data.url)},0)})})})}function createContextMenu(items,x,y){menu=menuService.open({items:items,x:x,y:y})}function closeContextMenu(){menuService.close(),scope.$apply(function(){scope.showMember=!1})}function getUploadUrl(gid){return["/yws/api/group/"+gid+"/noteresource?method=startUpload","/yws/api/group/"+gid+"/noteresource?method=uploadProgress","/yws/api/group/"+gid+"/noteresource?method=completeUpload"]}function onPaste(e,callback){var task,items=e.originalEvent.clipboardData.items;items&&1===items.length&&0==items[0].type.indexOf("image")&&(task=uploader.createTask("resource",items[0].getAsFile(),"截图.png"),task.append("method","put-resource"),task.append("resourceType",1),task.resumeUpload(getUploadUrl(scope.gid())).then(function(res){res=_.isObject(res.text)?res.text:JSON.parse(res.text),callback(res.resourceUrl)}))}function onSave(){scope.$apply(function(){scope.useKeySave()})}function uploadAttachment(callback){scope.$apply(function(){selectFiles.open(null,"resource").then(function(tasks){dialogs.open({gid:scope.gid(),title:"上传附件",src:"pagelet/note/editor/attachment.html",tasks:tasks}).then(function(data){setTimeout(function(){callback(data)},0)})})})}function downloadAttachment(name,url){setTimeout(function(){downloadService.download(name,url.replace(/^http:\/\/note\.youdao\.com/i,""))},0)}function onDestroy(){editor.destroy()}function onMemberChange(memberMap){$timeout(function(){scope.modifiers=_.chain(memberMap).toArray().reduce(function(pre,user){return pre.push(new User(user.nickname,user.lockColor,user.sessionId,user.portraitUrl)),pre},[]).value()},0)}function hint(content,theme){scope.$apply(function(){scope.setHint(content,theme)})}function sessionInitialized(result,returnedValue){scope.$apply(function(){scope.sessionInitialized(result,returnedValue)})}function sessionBuilt(isCollabStarted){_.map(builtListeners,function(listener){listener(isCollabStarted)})}function errorHandler(error){return console.log("sockit error:"+error.code),console.log(error),2e3===error.customCode?(hint("目前协同服务连接已达上限，请稍后重试","warning"),scope.goToNoCollab()):2001===error.customCode?dialogs.alert("提示","目前支持20人同时查看编辑，已到上限，请稍后重试").then(function(){scope.goToNoCollab()}):scope.reBuildTimes>2?scope.rebuiltAlert():(hint("协同服务不稳定，正在重连","warning"),void setTimeout(function(){scope.$apply(function(){scope.reBuildTimes++,scope.rebuildSession()})},1e3*scope.reBuildTimes*2))}function datacommandSuccess(cmd){scope.localCommand.push(cmd)}var editor,cachedHtml,menu,editorReady,editorDeferred=scope.editorDeferred,editorPromise=editorDeferred.promise,builtListeners=[];scope.setEditorContent=function(xmlData){null===xmlData||(cachedHtml=xmlData,editorPromise=editorPromise.then(function(){editor.setHtml(xmlData)}))},scope.convert=function(data,toXML){return editorPromise.then(function(){return editor.convert(data,toXML)})},scope.showMembers=function($event){scope.showMember=!scope.showMember,$event.stopPropagation()},scope.$on("$destroy",onDestroy),factory.collab(el,$injector,dialogs).then(function(adapter){editor=adapter,editor.setAttachmentProvider(uploadAttachment),editor.setDownloadProvider(downloadAttachment),editor.setLinkProvider(createLink),editor.setListener(onEditorChanged),editor.setMenuProvider(createContextMenu),editor.setImageProvider(createImage),editor.setSaveProvider(onSave),editor.setPasteProvider(onPaste),editor.setSessionChangeListener(onMemberChange),editor.getBody().on("mousedown",closeContextMenu),editor.setHintProvider(hint),editor.setSessionInitializedProvider(sessionInitialized),editor.setSessionBuiltProvider(sessionBuilt),editor.setSessionErrorHandler(errorHandler),editor.setDatacommandSuccessHandler(datacommandSuccess),editorReady=!0,editorDeferred.resolve()}),scope.getContent=function(needHtml){return editorReady?editor.getHtml(needHtml):void 0},scope.clearEditor=function(){editorReady&&editor.reset()},scope.closeCollabSession=function(){editorReady&&(builtListeners=[],editor.closeCollabSession())},scope.resetEditorOptions=function(options){editorReady&&editor.resetEditorOptions(options)},scope.saveNotification=function(version){editorReady&&editor.saveNotification(version)},scope.getNoteVersion=function(){return editor.getNoteVersion()},scope.buildSession=function(){return editorPromise.then(function(){return editor.buildSession()})},scope.registerBuiltListener=function(listener){builtListeners.push(listener)},scope.clearBuiltListener=function(){builtListeners=[]}}return{restrict:"A",link:link}}}),define("pagelet/note/editor/collab/collabService",["util/tracker"],function(tracker){"use strict";return function(dialogs,launcher,$q,noteMgr,fileMgr,$http){function getContent(groupId,noteId,isCollabStarted){var deferred=$q.defer();return $http.get("/yws/api/group/"+groupId+"/note/"+noteId,{params:{method:"get-collabnote",isCollabStarted:isCollabStarted}}).success(function(data){deferred.resolve(data)}).error(function(e){deferred.reject(e)}),deferred.promise}function saveContent(option){var deferred=$q.defer(),content=option.content,parser=new DOMParser,xmlDoc=$(parser.parseFromString(content,"text/xml")),version=xmlDoc.find("note").attr("file-version"),commandStr=option.commandStr,noPush=option.noPush;return commandStr=commandStr&&commandStr.length>1?"["+commandStr.join(",")+"]":"",$http.post("/yws/api/group/"+option.groupId+"/note/"+option.noteId,{title:option.title,content:option.content,commandStr:commandStr,noNeedToPush:noPush},{params:{method:"save-collabnote",isHistoryVersion:option.isHistory,collabVersion:version}}).success(function(json){deferred.resolve(new fileMgr.File(option.groupId,json))}).error(function(e){deferred.reject(e)}),deferred.promise}function error(e){if(!e)return $q.reject(e);switch(e.error){case"20108":if(e.adviceName)return dialogs.confirm("发布笔记","目录中有重名笔记，是否重命名为："+e.adviceName,{ok:"是",cancel:"否"}).then(function(){return e.adviceName.replace(/.note$/,"")});dialogs.alert("发布笔记","目录中有重名笔记，请输入其他标题");break;case"20114":dialogs.alert("发布笔记","当前群中的文件数已经到达上限，请删除不必要的文件后重新发布");break;case"10024":launcher.getGroup().isVip?dialogs.alert("发布笔记","群存储容量已满，无法增加新笔记。请删除不必要的文件后重新发布"):launcher.getGroup().owner===launcher.uid()?(tracker.event("exceed","exceed-space-show","exceed-space-noteimoprt"),dialogs.alertBySrc("发布笔记","pagelet/file/upload/exceed-spaceQuota.html",{height:"auto"})):dialogs.alert("发布笔记","群存储容量已满，无法增加新笔记。如需添加更多笔记，请联系群主升级到企业版。");break;case"260":dialogs.alert("发布笔记","无法保存该笔记，仅该群管理员或群主可保存");break;default:dialogs.alert("发布笔记","保存失败")}return $q.reject(e)}function createNote(title,content,groupId,folderId){function createToAnotherFolder(){return dialogs.open({src:"pagelet/file/selector/selector-dialog.html",title:"保存到",width:360,height:360,gid:groupId,except:[{name:title+".note"}],selectType:"folder"}).then(function(toFolder){return noteMgr.createNote(groupId,toFolder.id,title||"无标题笔记",content).catch(createError)},function(){return $q.when(null)})}function createError(e){return e&&"20101"===e.error?(createToAnotherFolder(),$q.reject("noParentFolder")):e?error(e).then(function(newTitle){return createNote(newTitle,content,groupId,folderId)}):$q.reject(e)}return folderId?noteMgr.createNote(groupId,folderId,title||"无标题笔记",content).catch(createError):(createToAnotherFolder(),$q.reject("noParentFolder"))}function updateNote(title,content,note,groupId,isContentChanged,notShowError,isRewrite,commandStr,noPush){function updateError(e){return e&&"20101"===e.error?dialogs.confirm("发布笔记","该笔记已被群内其他成员删除了，是否保存为新的笔记？",{ok:"保存",cancel:"退出"}).then(function(){return createNote(title,content,groupId,note.parentId)}):e&&!notShowError?error(e).then(function(suggestTitle){return title=suggestTitle,postUpdate()}):$q.reject(e)}function postUpdate(){return isContentChanged?isRewrite?noteMgr.updateNote(groupId,note.id,title||"无标题笔记",content).catch(updateError):saveContent({groupId:groupId,noteId:note.id,title:title||"无标题笔记",content:content,isHistory:!0,isCollab:!0,commandStr:commandStr,noPush:noPush}).catch(updateError):fileMgr.rename(groupId,note,(title||"无标题笔记")+".note").catch(updateError)}return postUpdate()}function rewriteNote(title,content,note,groupId,isContentChanged,notShowError){return updateNote(title,content,note,groupId,isContentChanged,notShowError,!0)}function convertNote(gid,fileId){return noteMgr.convertNote(gid,fileId)}function saveTempData(title,content,note,groupId){return saveContent({groupId:groupId,noteId:note.id,title:title,content:content,isHistory:!1})}return{doCreate:createNote,doUpdate:updateNote,convert:convertNote,doRewrite:rewriteNote,doGet:getContent,doAutoSave:saveTempData}}}),define("noteModule",["angular","pagelet/note/editor/editorCtrl","pagelet/note/editor/editorDirective","pagelet/note/editor/contentDirective","pagelet/note/editor/attachment","pagelet/note/editor/adapterFactory","pagelet/note/editor/draftHint","pagelet/note/diffview/noteDiffCtrl","pagelet/note/diffview/noteView","pagelet/note/import/importer","pagelet/note/import/ynoteSelector/dialog","pagelet/note/import/ydocSelector/importNote","pagelet/note/import/ydocSelector/importFileTreeSelectNodeCtrl","pagelet/note/msg/message","pagelet/note/plugin/plugin","pagelet/note/noteInit","pagelet/note/search/contentSearchDirective","pagelet/note/demo/demoService","pagelet/note/editor/collab/collabCtrl","pagelet/note/editor/collab/collabDirective","pagelet/note/editor/collab/collabService"],function(angular,editorCtrl,editorDirective,contentDirective,attachmentCtrl,adapterFactory,draftHint,noteDiffCtrl,noteView,noteImportCtrl,noteSelectorCtrl,importNoteCtrl,importFileTreeSelectorNodeCtrl,noteMessageCtrl,notePlugin,noteInit,contentSearchDirevtive,demoService,collabCtrl,collabDirective,collabService){"use strict";return angular.module("noteModule",[]).service("notePlugin",["$rootScope","$q","$location","explorer","viewport","launcher","dialogService","noteManager","storageManager","permissionService","filePermissionService","LOCAL_STORAGE_KEY","fileManager",notePlugin]).controller("noteEditorCtrl",["$scope","$location","$q","$interval","$timeout","viewport","launcher","explorer","router","dialogService","noteManager","fileManager","storageManager","titleService","$element","filePermissionService","demoService","$rootScope","LOCAL_STORAGE_KEY",editorCtrl]).controller("noteAttachmentCtrl",["$scope","dialogService","launcher",attachmentCtrl]).controller("noteDiffCtrl",["$scope","$rootScope","$timeout","$location","$filter","explorer","viewport","dialogService","fileManager","noteManager","launcher",noteDiffCtrl]).controller("noteImportCtrl",["$rootScope","$scope","noteManager","dialogService","launcher","userService","explorer",noteImportCtrl]).controller("importFileTreeSelectNodeCtrl",["$scope","noteManager","viewport","explorer","launcher",importFileTreeSelectorNodeCtrl]).controller("noteSelectorCtrl",["$scope","noteManager",noteSelectorCtrl]).controller("importNoteCtrl",["$scope","noteManager",importNoteCtrl]).directive("noteView",[noteView]).directive("noteEditor",["$parse","$injector","adapterFactory","dialogService","downloadService","menuService","uploader","clientProxy","selectFileService","$timeout",editorDirective]).directive("noteContent",["dialogService","downloadService","menuService","previewSlide","clientProxy","fileManager","labService",contentDirective]).directive("noteDraftHint",["launcher","storageManager","permissionService","LOCAL_STORAGE_KEY",draftHint]).controller("noteMessageCtrl",["$scope",noteMessageCtrl]).service("adapterFactory",["$injector",adapterFactory]).run(["notePlugin","chatTemplate","permissionService","ROLES","MESSAGE_TYPE",noteInit]).directive("contentSearch",[contentSearchDirevtive]).service("demoService",["$compile","$http","$templateCache","$q","$rootScope","$timeout","downloadService",demoService]).controller("collabNoteEditorCtrl",["$scope","$location","$q","$interval","$timeout","viewport","launcher","explorer","router","dialogService","noteManager","fileManager","storageManager","titleService","$element","filePermissionService","demoService","$rootScope","LOCAL_STORAGE_KEY","collabService",collabCtrl]).service("collabService",["dialogService","launcher","$q","noteManager","fileManager","$http",collabService]).directive("collabEditor",["$parse","$injector","adapterFactory","dialogService","downloadService","menuService","uploader","clientProxy","selectFileService","launcher","$timeout",collabDirective])}),define("pagelet/image/imageDetailCtrl",["underscore","bower_components/util/src/cookies","util/keycode"],function(_,cookies,KEYCODE){"use strict";return function($scope,$location,explorer,comparator,launcher,fileMgr,$timeout){function getImageUrl(gid,fileId,fileVersion,minSize){gid=gid||$scope.gid(),fileId=fileId||file.id,fileVersion=fileVersion||file.version;var method=minSize?"?method=getImage&width=640&height=640":"?method=download";return"/yws/api/group/"+gid+"/file/"+fileId+method+"&version="+fileVersion+"&cstk="+cookies.get("YNOTE_CSTK")}function filterImages(files){imageFiles=_.filter(files,function(file){return regexp.test(file.name)}).sort(comparator),updatePreAndNext()}function updatePreAndNext(){$timeout(function(){var targetFile,targetFileIndex;targetFile=_.findWhere(imageFiles,{id:fileId}),targetFile?(targetFileIndex=imageFiles.indexOf(targetFile),$scope.nav.pre=imageFiles[targetFileIndex-1],$scope.nav.next=imageFiles[targetFileIndex+1]):$scope.nav.pre=$scope.nav.next=void 0,$scope.imageList=_.map(imageFiles,function(file){return{name:file.name,src:getImageUrl(file.gid,file.id,file.version),preSrc:getImageUrl(file.gid,file.id,file.version,!0)}})})}function loadFiles(folderId){function loadFilesByPath(path){fileMgr.listFiles($scope.gid(),path).then(filterImages)}fileMgr.getFilePath($scope.gid(),folderId).then(loadFilesByPath)}function hasPrev(){return!!$scope.nav.pre}function hasNext(){return!!$scope.nav.next}function prev(){explorer.openFile($scope.nav.pre)}function next(){explorer.openFile($scope.nav.next)}function getPageHeight(){$(".detail-image-bd .pager").height($(".image-detail").height())}function imageListUpdate(evt,file){if(regexp.test(file.name))switch(evt.name){case"file.update":case"file.remove":case"file.move":case"file.create":file.parentId===folderId&&loadFiles(file.parentId,file.id)}}function bindAll(){$(window).on("keydown",onKeyDown)}function unBindAll(){$(window).off("keydown",onKeyDown)}function onKeyDown(evt){-1===["TEXTAREA","INPUT"].indexOf(evt.target.tagName)&&(evt.keyCode===KEYCODE.LEFT&&$scope.nav.pre?explorer.openFile($scope.nav.pre):evt.keyCode===KEYCODE.RIGHT&&$scope.nav.next&&explorer.openFile($scope.nav.next))}function onOpenFolder(fileId){explorer.locateFile(fileId)}var file,fileId,folderId,regexp=/^.*(\.png|\.jpg|\.jpeg|\.gif|\.bmp)$/i,imageFiles=[],watchers=[];$scope.$watchFile(function(newFile,oldFile){return null===newFile?($scope.imageFile=null,void unBindAll()):(null===oldFile&&newFile&&bindAll(),$scope.nav={pre:void 0,next:void 0},fileId=newFile.id,folderId=newFile.parentId,!file||file&&newFile.parentId!==file.parentId?loadFiles(newFile.parentId,newFile.id):filterImages(imageFiles),$scope.imageFile=file=newFile,void($scope.image={preSrc:getImageUrl(file.gid,file.id,file.version,!0),src:getImageUrl(),name:newFile.name}))}),watchers=_.map(["file.create","file.update","file.remove","file.move","file.import","file.upload"],function(evtName){return $scope.$on(evtName,imageListUpdate)}),$scope.$on("$destroy",function(){_.each(watchers,function(unwatch){unwatch()}),unBindAll()}),$scope.$on("image.preview.hide",function(){$scope.imageFile&&$(window).on("keydown",onKeyDown)}),$scope.openPreivew=function(){$(window).off("keydown",onKeyDown)},$scope.download=fileMgr.download,$scope.getImageUrl=getImageUrl,$scope.hasPrev=hasPrev,$scope.hasNext=hasNext,$scope.prev=prev,$scope.next=next,$scope.getPageHeight=getPageHeight,$scope.onOpenFolder=onOpenFolder}}),define("pagelet/image/imageView",[],function(){"use strict";return function(){function link(scope,el){function onImageLoad(){var imgWidth=imgEl.outerWidth(),imgHeight=imgEl.outerHeight();maxWidth=el.width(),maxHeight=el.height(),imgWidth>maxWidth&&(imgHeight=imgHeight*maxWidth/imgWidth,imgWidth=maxWidth),imgHeight>maxHeight&&(imgWidth=imgWidth*maxHeight/imgHeight,imgHeight=maxHeight),imgEl.width(imgWidth).height(imgHeight).css("visibility","visible")}function onImageChanged(){imgEl.css({width:"auto",height:"auto",visibility:"hidden"})}function watchSize(){(maxWidth!=el.width()||maxHeight!=el.height())&&onImageLoad()}function onDestroy(){}var imgEl,monitor,maxWidth,maxHeight;scope.$watch("image.src",onImageChanged),imgEl=el.find("img").on("load",onImageLoad),monitor=setInterval(watchSize,50),scope.$on("$destroy",onDestroy)}var TPL='<img class="detail-image" ng-src="{{image.src}}" widget-preview="image" />';return{scope:{image:"=imageDetailPreview"},link:link,template:TPL}}}),define("pagelet/image/imageResize",["jquery"],function($){"use strict";return function(){function link(scope,element){var imageFile=element[0],imageContainer=$(".detail-bd")[0];imageFile.onload=function(){scope.imageSize={width:imageFile.width,height:imageFile.height},scope.$apply(resizeImage),$(window).resize(function(){scope.$apply(resizeImage)}),scope.$watch("max",resizeImage)};var resizeImage=function(){var spaceWidth=imageContainer.clientWidth-156,spaceHeight=imageContainer.clientHeight-200,srcHeight=scope.imageSize.height,srcWidth=scope.imageSize.width,s=spaceWidth/srcWidth;s>1&&(s=1),scope.imageWidth=s*srcWidth,scope.imageHeight=s*srcHeight,scope.imageHeight<spaceHeight?scope.imageMarginTop=scope.imageMarginBottom=(spaceHeight-scope.imageHeight)/2:(scope.imageMarginTop=0,scope.imageMarginBottom=30),scope.imageReady=!0}}return{restrict:"A",link:link}}}),define("pagelet/image/imageOnload",["jquery"],function(){"use strict";return function(){function link(scope,element,attrs){element.bind("load",function(){scope.$apply(attrs.imageOnload)})}return{restrict:"A",link:link}}}),define("imageModule",["angular","pagelet/image/imageDetailCtrl","pagelet/image/imageView","pagelet/image/imageResize","pagelet/image/imageOnload"],function(angular,imageDetailCtrl,imageView,imageResize,imageOnload){"use strict";function initialize(viewport,explorer,launcher){var baseRouter,VIEW_SRC="pagelet/image/detail.html",VIEW_NAME="image",regexp=/^.*(\.png|\.jpg|\.jpeg|\.gif|\.bmp)$/i;launcher.wait().then(function(){baseRouter=launcher.getGroupRouter(),baseRouter.bind("/image/{fileId}",function(params){return viewport.open(VIEW_NAME,params)})}),viewport.extendView(function(register){register(VIEW_NAME,VIEW_SRC)}),explorer.extendType(function(register){register("图片",regexp,1,{routerPrefix:"image",open:function(fileId,version,opt){baseRouter.forward("/image/"+fileId,opt)},print:function(){return{divToPrint:"img.detail-image",css:{display:"flex","justify-content":"center","align-items":"center"}}}})})}return angular.module("imageModule",[]).directive("imageResize",[imageResize]).directive("imageOnload",[imageOnload]).controller("imageDetailCtrl",["$scope","$location","explorer","fileComparator","launcher","fileManager","$timeout",imageDetailCtrl]).run(["viewport","explorer","launcher",initialize])}),define("previewModule",["jquery","underscore","angular","fileModule","util/trackTiming"],function($,_,angular,fileModule,trackTiming){"use strict";function officePreviewCtrl($scope,$timeout,launcher,explorer,fileMgr){function clear(){$scope.previewSrc=null}function onOpenFolder(fileId){explorer.locateFile(fileId)}$scope.$watchFile(function(file){return file?($scope.file=file,fileMgr.getFilePath(file.gid,file.parentId).then(function(path){$scope.filePath=path}).catch(function(){$scope.filePath="读取路径失败"}),$scope.previewSrc="/yws/api/group/"+launcher.gid()+"/preview/"+file.id+"?method=convert&rev="+file.version,void $timeout(function(){$(".office-preview-iframe").load(function(){trackTiming.openOffice.end().send().clear()})})):void clear()}),$scope.$quit(clear),$scope.onOpenFolder=onOpenFolder}function initialize(explorer,launcher,clientProxy,viewport){function viewFile(fileId,version,opt){launcher.getGroupRouter().forward("/office/"+fileId,opt)}function editFile(file){var group=launcher.getGroup();group&&clientProxy.edit(file.name,"/yws/api/group/"+group.id+"/file/"+file.id+"?method=download&version="+(file.version||""))}launcher.wait().then(function(){launcher.getGroupRouter().bind("/office/{fileId}",function(params){viewport.open("office-preview",params)})}),viewport.extendView(function(register){register("office-preview","pagelet/office/preview.html")}),clientProxy.registerUrlPattern("officeapps.live.com"),explorer.extendType(function(register){clientProxy.isPC()||register("中间页查看",/\.(doc|docx|ppt|pptx|xls|xlsx)$/i,1,{routerPrefix:"office",open:viewFile}),clientProxy.isSupport("edit")&&register("本地打开",/\.(doc|docx|ppt|pptx|xls|xlsx|pdf)$/i,1,{edit:editFile})})}return angular.module("previewModule",[fileModule.name]).controller("officePreviewCtrl",["$scope","$timeout","launcher","explorer","fileManager",officePreviewCtrl]).run(["explorer","launcher","clientProxy","viewport",initialize])}),function(){"use strict";var isCommonjs="undefined"!=typeof module&&module.exports,keyboardAllowed="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,fn=function(){for(var val,valLength,fnMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,l=fnMap.length,ret={};l>i;i++)if(val=fnMap[i],val&&val[1]in document){for(i=0,valLength=val.length;valLength>i;i++)ret[fnMap[0][i]]=val[i];return ret}return!1}(),screenfull={request:function(elem){var request=fn.requestFullscreen;elem=elem||document.documentElement,/5\.1[\.\d]* Safari/.test(navigator.userAgent)?elem[request]():elem[request](keyboardAllowed&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[fn.exitFullscreen]()},toggle:function(elem){this.isFullscreen?this.exit():this.request(elem)},raw:fn};return fn?(Object.defineProperties(screenfull,{isFullscreen:{get:function(){return!!document[fn.fullscreenElement]}},element:{enumerable:!0,get:function(){return document[fn.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!document[fn.fullscreenEnabled]}}}),void(isCommonjs?module.exports=screenfull:window.screenfull=screenfull)):void(isCommonjs?module.exports=!1:window.screenfull=!1)}(),define("screenfull",function(){}),define("pagelet/pdf/pdfViewer",["screenfull"],function(){return function(module){module.directive("pdfViewer",["$timeout","clientProxy",function($timeout,client){function link(scope,element){scope.url="/pdf-viewer/?file="+encodeURIComponent(scope.src);var target=element.find("iframe").get(0).contentWindow,$win=$(window);$win.on("message.pdfViewer.ready",function(evt){evt=evt.originalEvent;var msg=evt.data;evt.source===target&&"pdf.ready"===msg&&($win.off("message.pdfViewer.ready"),init(target,evt.origin,scope,element),target.postMessage("parent.ready",evt.origin))}),scope.$on("$destroy",function(){$win.off(".pdfViewer")})}function init(target,origin,scope,element){var $win=$(window);$win.on("message.pdfViewer.msg",function(evt){if(evt=evt.originalEvent,evt.origin===origin){var msg=evt.data,data=msg.data||{};switch(msg.type){case"pdf.info":ready(scope,element),scope.pdfInfo=data,target.postMessage({type:"pdf.subscribeMousemoveEvent"},origin);break;case"pdf.page":scope.pdfInfo.page=data.page;break;case"pdf.mousemove":element.trigger("pdf.mousemove")}scope.$apply()}}),scope.pagePrev=function(){target.postMessage({type:"pdf.pagePrev"},origin)},scope.pageNext=function(){target.postMessage({type:"pdf.pageNext"},origin)},scope.zoomIn=function(){target.postMessage({type:"pdf.zoomIn"},origin)},scope.zoomOut=function(){target.postMessage({type:"pdf.zoomOut"},origin)},scope.presentationMode=function(){screenfull.enabled&&(screenfull.request(element[0]),$win.on(screenfull.raw.fullscreenchange,function fn(){target.postMessage({type:screenfull.isFullscreen?"pdf.presentationModeEnter":"pdf.presentationModeExit"},origin),screenfull.isFullscreen?target.focus():$win.off(screenfull.raw.fullscreenchange,fn)}))}}function ready(scope,element){function hideToolbar(){scope.showToolbar=!1,scope.$apply()}function showToolbar(){scope.showFullscreen=screenfull.enabled&&!client.isPC(),scope.showToolbar=!0,scope.$apply()}var timer;element.on("mousemove pdf.mousemove",function(){scope.showToolbar||showToolbar(),clearTimeout(timer),timer=setTimeout(hideToolbar,2e3)}),element.on("mouseleave",hideToolbar)}return{restrict:"A",templateUrl:"pagelet/pdf/pdfViewer.html",link:link,scope:{src:"=pdfViewer"}}}])}}),define("pdfModule",["jquery","underscore","angular","fileModule","util/trackTiming","pagelet/pdf/pdfViewer"],function($,_,angular,fileModule,trackTiming,pdfViewer){var module=angular.module("pdfPreviewModule",[fileModule.name]);return pdfViewer(module),module.run(["explorer","launcher","clientProxy","viewport","dialogService",function(explorer,launcher,clientProxy,viewport,dialogs){launcher.wait().then(function(){launcher.getGroupRouter().bind("/pdf/{fileId}",function(params){viewport.open("pdf-preview",params)})}),viewport.extendView(function(register){register("pdf-preview","pagelet/pdf/preview.html")}),explorer.extendType(function(register){register("中间页查看",/\.pdf$/i,1,{routerPrefix:"pdf",open:function(fileId,version,opt){launcher.getGroupRouter().forward("/pdf/"+fileId,opt)},print:function(){var divToPrint=$('iframe[src^="/pdf-viewer/"]'),pdfView=divToPrint[0].contentWindow.PDFView;return!pdfView.loading&&pdfView.pdfDocument.pdfInfo.numPages>100?(dialogs.alert("提示","文件过大，无法直接打印，您可下载文件后打印"),null):(divToPrint[0].contentWindow.print(),null)}})})}]),module.controller("pdfPreviewCtrl",["$scope","$timeout","launcher","explorer","fileManager",function($scope,$timeout,launcher,explorer,fileMgr){function clear(){$scope.previewSrc=null}$scope.$watchFile(function(file){return file?($scope.file=file,fileMgr.getFilePath(file.gid,file.parentId).then(function(path){$scope.filePath=path}).catch(function(){$scope.filePath="读取路径失败"}),void($scope.src="/yws/api/group/"+launcher.gid()+"/file/"+file.id+"?method=download&version="+file.version)):void clear()}),$scope.$close(function(){$scope.src=!1}),$scope.onOpenFolder=explorer.openFolder.bind(explorer)}]),module}),!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define("moment",b):a.moment=b()}(this,function(){"use strict";function a(){return Hc.apply(null,arguments)}function b(a){Hc=a}function c(a){return"[object Array]"===Object.prototype.toString.call(a)}function d(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function e(a,b){var c,d=[];for(c=0;c<a.length;++c)d.push(b(a[c],c));return d}function f(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function g(a,b){for(var c in b)f(b,c)&&(a[c]=b[c]);return f(b,"toString")&&(a.toString=b.toString),f(b,"valueOf")&&(a.valueOf=b.valueOf),a}function h(a,b,c,d){return Ca(a,b,c,d,!0).utc()}function i(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function j(a){return null==a._pf&&(a._pf=i()),a._pf}function k(a){if(null==a._isValid){var b=j(a);a._isValid=!(isNaN(a._d.getTime())||!(b.overflow<0)||b.empty||b.invalidMonth||b.invalidWeekday||b.nullInput||b.invalidFormat||b.userInvalidated),a._strict&&(a._isValid=a._isValid&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour)}return a._isValid}function l(a){var b=h(0/0);return null!=a?g(j(b),a):j(b).userInvalidated=!0,b}function m(a,b){var c,d,e;if("undefined"!=typeof b._isAMomentObject&&(a._isAMomentObject=b._isAMomentObject),"undefined"!=typeof b._i&&(a._i=b._i),"undefined"!=typeof b._f&&(a._f=b._f),"undefined"!=typeof b._l&&(a._l=b._l),"undefined"!=typeof b._strict&&(a._strict=b._strict),"undefined"!=typeof b._tzm&&(a._tzm=b._tzm),"undefined"!=typeof b._isUTC&&(a._isUTC=b._isUTC),"undefined"!=typeof b._offset&&(a._offset=b._offset),"undefined"!=typeof b._pf&&(a._pf=j(b)),"undefined"!=typeof b._locale&&(a._locale=b._locale),Jc.length>0)for(c in Jc)d=Jc[c],e=b[d],"undefined"!=typeof e&&(a[d]=e);return a}function n(b){m(this,b),this._d=new Date(null!=b._d?b._d.getTime():0/0),Kc===!1&&(Kc=!0,a.updateOffset(this),Kc=!1)}function o(a){return a instanceof n||null!=a&&null!=a._isAMomentObject}function p(a){return 0>a?Math.ceil(a):Math.floor(a)}function q(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=p(b)),c}function r(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&q(a[d])!==q(b[d]))&&g++;return g+f}function s(){}function t(a){return a?a.toLowerCase().replace("_","-"):a}function u(a){for(var b,c,d,e,f=0;f<a.length;){for(e=t(a[f]).split("-"),b=e.length,c=t(a[f+1]),c=c?c.split("-"):null;b>0;){if(d=v(e.slice(0,b).join("-")))return d;if(c&&c.length>=b&&r(e,c,!0)>=b-1)break;b--}f++}return null}function v(a){var b=null;if(!Lc[a]&&"undefined"!=typeof module&&module&&module.exports)try{b=Ic._abbr,require("./locale/"+a),w(b)}catch(c){}return Lc[a]}function w(a,b){var c;return a&&(c="undefined"==typeof b?y(a):x(a,b),c&&(Ic=c)),Ic._abbr}function x(a,b){return null!==b?(b.abbr=a,Lc[a]=Lc[a]||new s,Lc[a].set(b),w(a),Lc[a]):(delete Lc[a],null)}function y(a){var b;if(a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr),!a)return Ic;if(!c(a)){if(b=v(a))return b;a=[a]}return u(a)}function z(a,b){var c=a.toLowerCase();Mc[c]=Mc[c+"s"]=Mc[b]=a}function A(a){return"string"==typeof a?Mc[a]||Mc[a.toLowerCase()]:void 0}function B(a){var b,c,d={};for(c in a)f(a,c)&&(b=A(c),b&&(d[b]=a[c]));return d}function C(b,c){return function(d){return null!=d?(E(this,b,d),a.updateOffset(this,c),this):D(this,b)}}function D(a,b){return a._d["get"+(a._isUTC?"UTC":"")+b]()}function E(a,b,c){return a._d["set"+(a._isUTC?"UTC":"")+b](c)}function F(a,b){var c;if("object"==typeof a)for(c in a)this.set(c,a[c]);else if(a=A(a),"function"==typeof this[a])return this[a](b);return this}function G(a,b,c){var d=""+Math.abs(a),e=b-d.length,f=a>=0;return(f?c?"+":"":"-")+Math.pow(10,Math.max(0,e)).toString().substr(1)+d}function H(a,b,c,d){var e=d;"string"==typeof d&&(e=function(){return this[d]()}),a&&(Qc[a]=e),b&&(Qc[b[0]]=function(){return G(e.apply(this,arguments),b[1],b[2])}),c&&(Qc[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function I(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function J(a){var b,c,d=a.match(Nc);for(b=0,c=d.length;c>b;b++)d[b]=Qc[d[b]]?Qc[d[b]]:I(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function K(a,b){return a.isValid()?(b=L(b,a.localeData()),Pc[b]=Pc[b]||J(b),Pc[b](a)):a.localeData().invalidDate()}function L(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Oc.lastIndex=0;d>=0&&Oc.test(a);)a=a.replace(Oc,c),Oc.lastIndex=0,d-=1;return a}function M(a){return"function"==typeof a&&"[object Function]"===Object.prototype.toString.call(a)}function N(a,b,c){dd[a]=M(b)?b:function(a){return a&&c?c:b}}function O(a,b){return f(dd,a)?dd[a](b._strict,b._locale):new RegExp(P(a))
}function P(a){return a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Q(a,b){var c,d=b;for("string"==typeof a&&(a=[a]),"number"==typeof b&&(d=function(a,c){c[b]=q(a)}),c=0;c<a.length;c++)ed[a[c]]=d}function R(a,b){Q(a,function(a,c,d,e){d._w=d._w||{},b(a,d._w,d,e)})}function S(a,b,c){null!=b&&f(ed,a)&&ed[a](b,c._a,c,a)}function T(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function U(a){return this._months[a.month()]}function V(a){return this._monthsShort[a.month()]}function W(a,b,c){var d,e,f;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),d=0;12>d;d++){if(e=h([2e3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(f="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(f.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a))return d;if(c&&"MMM"===b&&this._shortMonthsParse[d].test(a))return d;if(!c&&this._monthsParse[d].test(a))return d}}function X(a,b){var c;return"string"==typeof b&&(b=a.localeData().monthsParse(b),"number"!=typeof b)?a:(c=Math.min(a.date(),T(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a)}function Y(b){return null!=b?(X(this,b),a.updateOffset(this,!0),this):D(this,"Month")}function Z(){return T(this.year(),this.month())}function $(a){var b,c=a._a;return c&&-2===j(a).overflow&&(b=c[gd]<0||c[gd]>11?gd:c[hd]<1||c[hd]>T(c[fd],c[gd])?hd:c[id]<0||c[id]>24||24===c[id]&&(0!==c[jd]||0!==c[kd]||0!==c[ld])?id:c[jd]<0||c[jd]>59?jd:c[kd]<0||c[kd]>59?kd:c[ld]<0||c[ld]>999?ld:-1,j(a)._overflowDayOfYear&&(fd>b||b>hd)&&(b=hd),j(a).overflow=b),a}function _(b){a.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+b)}function aa(a,b){var c=!0;return g(function(){return c&&(_(a+"\n"+(new Error).stack),c=!1),b.apply(this,arguments)},b)}function ba(a,b){od[a]||(_(b),od[a]=!0)}function ca(a){var b,c,d=a._i,e=pd.exec(d);if(e){for(j(a).iso=!0,b=0,c=qd.length;c>b;b++)if(qd[b][1].exec(d)){a._f=qd[b][0];break}for(b=0,c=rd.length;c>b;b++)if(rd[b][1].exec(d)){a._f+=(e[6]||" ")+rd[b][0];break}d.match(ad)&&(a._f+="Z"),va(a)}else a._isValid=!1}function da(b){var c=sd.exec(b._i);return null!==c?void(b._d=new Date(+c[1])):(ca(b),void(b._isValid===!1&&(delete b._isValid,a.createFromInputFallback(b))))}function ea(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function fa(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function ga(a){return ha(a)?366:365}function ha(a){return a%4===0&&a%100!==0||a%400===0}function ia(){return ha(this.year())}function ja(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=Da(a).add(f,"d"),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function ka(a){return ja(a,this._week.dow,this._week.doy).week}function la(){return this._week.dow}function ma(){return this._week.doy}function na(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")}function oa(a){var b=ja(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")}function pa(a,b,c,d,e){var f,g=6+e-d,h=fa(a,0,1+g),i=h.getUTCDay();return e>i&&(i+=7),c=null!=c?1*c:e,f=1+g+7*(b-1)-i+c,{year:f>0?a:a-1,dayOfYear:f>0?f:ga(a-1)+f}}function qa(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==a?b:this.add(a-b,"d")}function ra(a,b,c){return null!=a?a:null!=b?b:c}function sa(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function ta(a){var b,c,d,e,f=[];if(!a._d){for(d=sa(a),a._w&&null==a._a[hd]&&null==a._a[gd]&&ua(a),a._dayOfYear&&(e=ra(a._a[fd],d[fd]),a._dayOfYear>ga(e)&&(j(a)._overflowDayOfYear=!0),c=fa(e,0,a._dayOfYear),a._a[gd]=c.getUTCMonth(),a._a[hd]=c.getUTCDate()),b=0;3>b&&null==a._a[b];++b)a._a[b]=f[b]=d[b];for(;7>b;b++)a._a[b]=f[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[id]&&0===a._a[jd]&&0===a._a[kd]&&0===a._a[ld]&&(a._nextDay=!0,a._a[id]=0),a._d=(a._useUTC?fa:ea).apply(null,f),null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),a._nextDay&&(a._a[id]=24)}}function ua(a){var b,c,d,e,f,g,h;b=a._w,null!=b.GG||null!=b.W||null!=b.E?(f=1,g=4,c=ra(b.GG,a._a[fd],ja(Da(),1,4).year),d=ra(b.W,1),e=ra(b.E,1)):(f=a._locale._week.dow,g=a._locale._week.doy,c=ra(b.gg,a._a[fd],ja(Da(),f,g).year),d=ra(b.w,1),null!=b.d?(e=b.d,f>e&&++d):e=null!=b.e?b.e+f:f),h=pa(c,d,e,g,f),a._a[fd]=h.year,a._dayOfYear=h.dayOfYear}function va(b){if(b._f===a.ISO_8601)return void ca(b);b._a=[],j(b).empty=!0;var c,d,e,f,g,h=""+b._i,i=h.length,k=0;for(e=L(b._f,b._locale).match(Nc)||[],c=0;c<e.length;c++)f=e[c],d=(h.match(O(f,b))||[])[0],d&&(g=h.substr(0,h.indexOf(d)),g.length>0&&j(b).unusedInput.push(g),h=h.slice(h.indexOf(d)+d.length),k+=d.length),Qc[f]?(d?j(b).empty=!1:j(b).unusedTokens.push(f),S(f,d,b)):b._strict&&!d&&j(b).unusedTokens.push(f);j(b).charsLeftOver=i-k,h.length>0&&j(b).unusedInput.push(h),j(b).bigHour===!0&&b._a[id]<=12&&b._a[id]>0&&(j(b).bigHour=void 0),b._a[id]=wa(b._locale,b._a[id],b._meridiem),ta(b),$(b)}function wa(a,b,c){var d;return null==c?b:null!=a.meridiemHour?a.meridiemHour(b,c):null!=a.isPM?(d=a.isPM(c),d&&12>b&&(b+=12),d||12!==b||(b=0),b):b}function xa(a){var b,c,d,e,f;if(0===a._f.length)return j(a).invalidFormat=!0,void(a._d=new Date(0/0));for(e=0;e<a._f.length;e++)f=0,b=m({},a),null!=a._useUTC&&(b._useUTC=a._useUTC),b._f=a._f[e],va(b),k(b)&&(f+=j(b).charsLeftOver,f+=10*j(b).unusedTokens.length,j(b).score=f,(null==d||d>f)&&(d=f,c=b));g(a,c||b)}function ya(a){if(!a._d){var b=B(a._i);a._a=[b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],ta(a)}}function za(a){var b=new n($(Aa(a)));return b._nextDay&&(b.add(1,"d"),b._nextDay=void 0),b}function Aa(a){var b=a._i,e=a._f;return a._locale=a._locale||y(a._l),null===b||void 0===e&&""===b?l({nullInput:!0}):("string"==typeof b&&(a._i=b=a._locale.preparse(b)),o(b)?new n($(b)):(c(e)?xa(a):e?va(a):d(b)?a._d=b:Ba(a),a))}function Ba(b){var f=b._i;void 0===f?b._d=new Date:d(f)?b._d=new Date(+f):"string"==typeof f?da(b):c(f)?(b._a=e(f.slice(0),function(a){return parseInt(a,10)}),ta(b)):"object"==typeof f?ya(b):"number"==typeof f?b._d=new Date(f):a.createFromInputFallback(b)}function Ca(a,b,c,d,e){var f={};return"boolean"==typeof c&&(d=c,c=void 0),f._isAMomentObject=!0,f._useUTC=f._isUTC=e,f._l=c,f._i=a,f._f=b,f._strict=d,za(f)}function Da(a,b,c,d){return Ca(a,b,c,d,!1)}function Ea(a,b){var d,e;if(1===b.length&&c(b[0])&&(b=b[0]),!b.length)return Da();for(d=b[0],e=1;e<b.length;++e)(!b[e].isValid()||b[e][a](d))&&(d=b[e]);return d}function Fa(){var a=[].slice.call(arguments,0);return Ea("isBefore",a)}function Ga(){var a=[].slice.call(arguments,0);return Ea("isAfter",a)}function Ha(a){var b=B(a),c=b.year||0,d=b.quarter||0,e=b.month||0,f=b.week||0,g=b.day||0,h=b.hour||0,i=b.minute||0,j=b.second||0,k=b.millisecond||0;this._milliseconds=+k+1e3*j+6e4*i+36e5*h,this._days=+g+7*f,this._months=+e+3*d+12*c,this._data={},this._locale=y(),this._bubble()}function Ia(a){return a instanceof Ha}function Ja(a,b){H(a,0,0,function(){var a=this.utcOffset(),c="+";return 0>a&&(a=-a,c="-"),c+G(~~(a/60),2)+b+G(~~a%60,2)})}function Ka(a){var b=(a||"").match(ad)||[],c=b[b.length-1]||[],d=(c+"").match(xd)||["-",0,0],e=+(60*d[1])+q(d[2]);return"+"===d[0]?e:-e}function La(b,c){var e,f;return c._isUTC?(e=c.clone(),f=(o(b)||d(b)?+b:+Da(b))-+e,e._d.setTime(+e._d+f),a.updateOffset(e,!1),e):Da(b).local()}function Ma(a){return 15*-Math.round(a._d.getTimezoneOffset()/15)}function Na(b,c){var d,e=this._offset||0;return null!=b?("string"==typeof b&&(b=Ka(b)),Math.abs(b)<16&&(b=60*b),!this._isUTC&&c&&(d=Ma(this)),this._offset=b,this._isUTC=!0,null!=d&&this.add(d,"m"),e!==b&&(!c||this._changeInProgress?bb(this,Ya(b-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?e:Ma(this)}function Oa(a,b){return null!=a?("string"!=typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()}function Pa(a){return this.utcOffset(0,a)}function Qa(a){return this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(Ma(this),"m")),this}function Ra(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Ka(this._i)),this}function Sa(a){return a=a?Da(a).utcOffset():0,(this.utcOffset()-a)%60===0}function Ta(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ua(){if("undefined"!=typeof this._isDSTShifted)return this._isDSTShifted;var a={};if(m(a,this),a=Aa(a),a._a){var b=a._isUTC?h(a._a):Da(a._a);this._isDSTShifted=this.isValid()&&r(a._a,b.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Va(){return!this._isUTC}function Wa(){return this._isUTC}function Xa(){return this._isUTC&&0===this._offset}function Ya(a,b){var c,d,e,g=a,h=null;return Ia(a)?g={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(g={},b?g[b]=a:g.milliseconds=a):(h=yd.exec(a))?(c="-"===h[1]?-1:1,g={y:0,d:q(h[hd])*c,h:q(h[id])*c,m:q(h[jd])*c,s:q(h[kd])*c,ms:q(h[ld])*c}):(h=zd.exec(a))?(c="-"===h[1]?-1:1,g={y:Za(h[2],c),M:Za(h[3],c),d:Za(h[4],c),h:Za(h[5],c),m:Za(h[6],c),s:Za(h[7],c),w:Za(h[8],c)}):null==g?g={}:"object"==typeof g&&("from"in g||"to"in g)&&(e=_a(Da(g.from),Da(g.to)),g={},g.ms=e.milliseconds,g.M=e.months),d=new Ha(g),Ia(a)&&f(a,"_locale")&&(d._locale=a._locale),d}function Za(a,b){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*b}function $a(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b)&&--c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function _a(a,b){var c;return b=La(b,a),a.isBefore(b)?c=$a(a,b):(c=$a(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c}function ab(a,b){return function(c,d){var e,f;return null===d||isNaN(+d)||(ba(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period)."),f=c,c=d,d=f),c="string"==typeof c?+c:c,e=Ya(c,d),bb(this,e,a),this}}function bb(b,c,d,e){var f=c._milliseconds,g=c._days,h=c._months;e=null==e?!0:e,f&&b._d.setTime(+b._d+f*d),g&&E(b,"Date",D(b,"Date")+g*d),h&&X(b,D(b,"Month")+h*d),e&&a.updateOffset(b,g||h)}function cb(a,b){var c=a||Da(),d=La(c,this).startOf("day"),e=this.diff(d,"days",!0),f=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(b&&b[f]||this.localeData().calendar(f,this,Da(c)))}function db(){return new n(this)}function eb(a,b){var c;return b=A("undefined"!=typeof b?b:"millisecond"),"millisecond"===b?(a=o(a)?a:Da(a),+this>+a):(c=o(a)?+a:+Da(a),c<+this.clone().startOf(b))}function fb(a,b){var c;return b=A("undefined"!=typeof b?b:"millisecond"),"millisecond"===b?(a=o(a)?a:Da(a),+a>+this):(c=o(a)?+a:+Da(a),+this.clone().endOf(b)<c)}function gb(a,b,c){return this.isAfter(a,c)&&this.isBefore(b,c)}function hb(a,b){var c;return b=A(b||"millisecond"),"millisecond"===b?(a=o(a)?a:Da(a),+this===+a):(c=+Da(a),+this.clone().startOf(b)<=c&&c<=+this.clone().endOf(b))}function ib(a,b,c){var d,e,f=La(a,this),g=6e4*(f.utcOffset()-this.utcOffset());return b=A(b),"year"===b||"month"===b||"quarter"===b?(e=jb(this,f),"quarter"===b?e/=3:"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:p(e)}function jb(a,b){var c,d,e=12*(b.year()-a.year())+(b.month()-a.month()),f=a.clone().add(e,"months");return 0>b-f?(c=a.clone().add(e-1,"months"),d=(b-f)/(f-c)):(c=a.clone().add(e+1,"months"),d=(b-f)/(c-f)),-(e+d)}function kb(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function lb(){var a=this.clone().utc();return 0<a.year()&&a.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():K(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):K(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function mb(b){var c=K(this,b||a.defaultFormat);return this.localeData().postformat(c)}function nb(a,b){return this.isValid()?Ya({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function ob(a){return this.from(Da(),a)}function pb(a,b){return this.isValid()?Ya({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function qb(a){return this.to(Da(),a)}function rb(a){var b;return void 0===a?this._locale._abbr:(b=y(a),null!=b&&(this._locale=b),this)}function sb(){return this._locale}function tb(a){switch(a=A(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a&&this.weekday(0),"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this}function ub(a){return a=A(a),void 0===a||"millisecond"===a?this:this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")}function vb(){return+this._d-6e4*(this._offset||0)}function wb(){return Math.floor(+this/1e3)}function xb(){return this._offset?new Date(+this):this._d}function yb(){var a=this;return[a.year(),a.month(),a.date(),a.hour(),a.minute(),a.second(),a.millisecond()]}function zb(){var a=this;return{years:a.year(),months:a.month(),date:a.date(),hours:a.hours(),minutes:a.minutes(),seconds:a.seconds(),milliseconds:a.milliseconds()}}function Ab(){return k(this)}function Bb(){return g({},j(this))}function Cb(){return j(this).overflow}function Db(a,b){H(0,[a,a.length],0,b)}function Eb(a,b,c){return ja(Da([a,11,31+b-c]),b,c).week}function Fb(a){var b=ja(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==a?b:this.add(a-b,"y")}function Gb(a){var b=ja(this,1,4).year;return null==a?b:this.add(a-b,"y")}function Hb(){return Eb(this.year(),1,4)}function Ib(){var a=this.localeData()._week;return Eb(this.year(),a.dow,a.doy)}function Jb(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)}function Kb(a,b){return"string"!=typeof a?a:isNaN(a)?(a=b.weekdaysParse(a),"number"==typeof a?a:null):parseInt(a,10)}function Lb(a){return this._weekdays[a.day()]}function Mb(a){return this._weekdaysShort[a.day()]}function Nb(a){return this._weekdaysMin[a.day()]}function Ob(a){var b,c,d;for(this._weekdaysParse=this._weekdaysParse||[],b=0;7>b;b++)if(this._weekdaysParse[b]||(c=Da([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b}function Pb(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=Kb(a,this.localeData()),this.add(a-b,"d")):b}function Qb(a){var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")}function Rb(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)}function Sb(a,b){H(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Tb(a,b){return b._meridiemParse}function Ub(a){return"p"===(a+"").toLowerCase().charAt(0)}function Vb(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"}function Wb(a,b){b[ld]=q(1e3*("0."+a))}function Xb(){return this._isUTC?"UTC":""}function Yb(){return this._isUTC?"Coordinated Universal Time":""}function Zb(a){return Da(1e3*a)}function $b(){return Da.apply(null,arguments).parseZone()}function _b(a,b,c){var d=this._calendar[a];return"function"==typeof d?d.call(b,c):d}function ac(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];return b||!c?b:(this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a])}function bc(){return this._invalidDate}function cc(a){return this._ordinal.replace("%d",a)}function dc(a){return a}function ec(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)}function fc(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)}function gc(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function hc(a,b,c,d){var e=y(),f=h().set(d,b);return e[c](f,a)}function ic(a,b,c,d,e){if("number"==typeof a&&(b=a,a=void 0),a=a||"",null!=b)return hc(a,b,c,e);var f,g=[];for(f=0;d>f;f++)g[f]=hc(a,f,c,e);return g}function jc(a,b){return ic(a,b,"months",12,"month")}function kc(a,b){return ic(a,b,"monthsShort",12,"month")}function lc(a,b){return ic(a,b,"weekdays",7,"day")}function mc(a,b){return ic(a,b,"weekdaysShort",7,"day")}function nc(a,b){return ic(a,b,"weekdaysMin",7,"day")}function oc(){var a=this._data;return this._milliseconds=Wd(this._milliseconds),this._days=Wd(this._days),this._months=Wd(this._months),a.milliseconds=Wd(a.milliseconds),a.seconds=Wd(a.seconds),a.minutes=Wd(a.minutes),a.hours=Wd(a.hours),a.months=Wd(a.months),a.years=Wd(a.years),this}function pc(a,b,c,d){var e=Ya(b,c);return a._milliseconds+=d*e._milliseconds,a._days+=d*e._days,a._months+=d*e._months,a._bubble()}function qc(a,b){return pc(this,a,b,1)}function rc(a,b){return pc(this,a,b,-1)}function sc(a){return 0>a?Math.floor(a):Math.ceil(a)}function tc(){var a,b,c,d,e,f=this._milliseconds,g=this._days,h=this._months,i=this._data;return f>=0&&g>=0&&h>=0||0>=f&&0>=g&&0>=h||(f+=864e5*sc(vc(h)+g),g=0,h=0),i.milliseconds=f%1e3,a=p(f/1e3),i.seconds=a%60,b=p(a/60),i.minutes=b%60,c=p(b/60),i.hours=c%24,g+=p(c/24),e=p(uc(g)),h+=e,g-=sc(vc(e)),d=p(h/12),h%=12,i.days=g,i.months=h,i.years=d,this}function uc(a){return 4800*a/146097}function vc(a){return 146097*a/4800}function wc(a){var b,c,d=this._milliseconds;if(a=A(a),"month"===a||"year"===a)return b=this._days+d/864e5,c=this._months+uc(b),"month"===a?c:c/12;switch(b=this._days+Math.round(vc(this._months)),a){case"week":return b/7+d/6048e5;case"day":return b+d/864e5;case"hour":return 24*b+d/36e5;case"minute":return 1440*b+d/6e4;case"second":return 86400*b+d/1e3;case"millisecond":return Math.floor(864e5*b)+d;default:throw new Error("Unknown unit "+a)}}function xc(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*q(this._months/12)}function yc(a){return function(){return this.as(a)}}function zc(a){return a=A(a),this[a+"s"]()}function Ac(a){return function(){return this._data[a]}}function Bc(){return p(this.days()/7)}function Cc(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function Dc(a,b,c){var d=Ya(a).abs(),e=ke(d.as("s")),f=ke(d.as("m")),g=ke(d.as("h")),h=ke(d.as("d")),i=ke(d.as("M")),j=ke(d.as("y")),k=e<le.s&&["s",e]||1===f&&["m"]||f<le.m&&["mm",f]||1===g&&["h"]||g<le.h&&["hh",g]||1===h&&["d"]||h<le.d&&["dd",h]||1===i&&["M"]||i<le.M&&["MM",i]||1===j&&["y"]||["yy",j];return k[2]=b,k[3]=+a>0,k[4]=c,Cc.apply(null,k)}function Ec(a,b){return void 0===le[a]?!1:void 0===b?le[a]:(le[a]=b,!0)}function Fc(a){var b=this.localeData(),c=Dc(this,!a,b);return a&&(c=b.pastFuture(+this,c)),b.postformat(c)}function Gc(){var a,b,c,d=me(this._milliseconds)/1e3,e=me(this._days),f=me(this._months);a=p(d/60),b=p(a/60),d%=60,a%=60,c=p(f/12),f%=12;var g=c,h=f,i=e,j=b,k=a,l=d,m=this.asSeconds();return m?(0>m?"-":"")+"P"+(g?g+"Y":"")+(h?h+"M":"")+(i?i+"D":"")+(j||k||l?"T":"")+(j?j+"H":"")+(k?k+"M":"")+(l?l+"S":""):"P0D"}var Hc,Ic,Jc=a.momentProperties=[],Kc=!1,Lc={},Mc={},Nc=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Oc=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Pc={},Qc={},Rc=/\d/,Sc=/\d\d/,Tc=/\d{3}/,Uc=/\d{4}/,Vc=/[+-]?\d{6}/,Wc=/\d\d?/,Xc=/\d{1,3}/,Yc=/\d{1,4}/,Zc=/[+-]?\d{1,6}/,$c=/\d+/,_c=/[+-]?\d+/,ad=/Z|[+-]\d\d:?\d\d/gi,bd=/[+-]?\d+(\.\d{1,3})?/,cd=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,dd={},ed={},fd=0,gd=1,hd=2,id=3,jd=4,kd=5,ld=6;H("M",["MM",2],"Mo",function(){return this.month()+1}),H("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)}),H("MMMM",0,0,function(a){return this.localeData().months(this,a)}),z("month","M"),N("M",Wc),N("MM",Wc,Sc),N("MMM",cd),N("MMMM",cd),Q(["M","MM"],function(a,b){b[gd]=q(a)-1}),Q(["MMM","MMMM"],function(a,b,c,d){var e=c._locale.monthsParse(a,d,c._strict);null!=e?b[gd]=e:j(c).invalidMonth=a});var md="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),nd="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),od={};a.suppressDeprecationWarnings=!1;var pd=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,qd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],rd=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],sd=/^\/?Date\((\-?\d+)/i;a.createFromInputFallback=aa("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))}),H(0,["YY",2],0,function(){return this.year()%100}),H(0,["YYYY",4],0,"year"),H(0,["YYYYY",5],0,"year"),H(0,["YYYYYY",6,!0],0,"year"),z("year","y"),N("Y",_c),N("YY",Wc,Sc),N("YYYY",Yc,Uc),N("YYYYY",Zc,Vc),N("YYYYYY",Zc,Vc),Q(["YYYYY","YYYYYY"],fd),Q("YYYY",function(b,c){c[fd]=2===b.length?a.parseTwoDigitYear(b):q(b)}),Q("YY",function(b,c){c[fd]=a.parseTwoDigitYear(b)}),a.parseTwoDigitYear=function(a){return q(a)+(q(a)>68?1900:2e3)};var td=C("FullYear",!1);H("w",["ww",2],"wo","week"),H("W",["WW",2],"Wo","isoWeek"),z("week","w"),z("isoWeek","W"),N("w",Wc),N("ww",Wc,Sc),N("W",Wc),N("WW",Wc,Sc),R(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=q(a)});var ud={dow:0,doy:6};H("DDD",["DDDD",3],"DDDo","dayOfYear"),z("dayOfYear","DDD"),N("DDD",Xc),N("DDDD",Tc),Q(["DDD","DDDD"],function(a,b,c){c._dayOfYear=q(a)}),a.ISO_8601=function(){};var vd=aa("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var a=Da.apply(null,arguments);return this>a?this:a}),wd=aa("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var a=Da.apply(null,arguments);return a>this?this:a});Ja("Z",":"),Ja("ZZ",""),N("Z",ad),N("ZZ",ad),Q(["Z","ZZ"],function(a,b,c){c._useUTC=!0,c._tzm=Ka(a)});var xd=/([\+\-]|\d\d)/gi;a.updateOffset=function(){};var yd=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,zd=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Ya.fn=Ha.prototype;var Ad=ab(1,"add"),Bd=ab(-1,"subtract");a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Cd=aa("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});H(0,["gg",2],0,function(){return this.weekYear()%100}),H(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Db("gggg","weekYear"),Db("ggggg","weekYear"),Db("GGGG","isoWeekYear"),Db("GGGGG","isoWeekYear"),z("weekYear","gg"),z("isoWeekYear","GG"),N("G",_c),N("g",_c),N("GG",Wc,Sc),N("gg",Wc,Sc),N("GGGG",Yc,Uc),N("gggg",Yc,Uc),N("GGGGG",Zc,Vc),N("ggggg",Zc,Vc),R(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=q(a)}),R(["gg","GG"],function(b,c,d,e){c[e]=a.parseTwoDigitYear(b)}),H("Q",0,0,"quarter"),z("quarter","Q"),N("Q",Rc),Q("Q",function(a,b){b[gd]=3*(q(a)-1)}),H("D",["DD",2],"Do","date"),z("date","D"),N("D",Wc),N("DD",Wc,Sc),N("Do",function(a,b){return a?b._ordinalParse:b._ordinalParseLenient}),Q(["D","DD"],hd),Q("Do",function(a,b){b[hd]=q(a.match(Wc)[0],10)});var Dd=C("Date",!0);H("d",0,"do","day"),H("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)}),H("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)}),H("dddd",0,0,function(a){return this.localeData().weekdays(this,a)}),H("e",0,0,"weekday"),H("E",0,0,"isoWeekday"),z("day","d"),z("weekday","e"),z("isoWeekday","E"),N("d",Wc),N("e",Wc),N("E",Wc),N("dd",cd),N("ddd",cd),N("dddd",cd),R(["dd","ddd","dddd"],function(a,b,c){var d=c._locale.weekdaysParse(a);null!=d?b.d=d:j(c).invalidWeekday=a}),R(["d","e","E"],function(a,b,c,d){b[d]=q(a)});var Ed="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Fd="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Gd="Su_Mo_Tu_We_Th_Fr_Sa".split("_");H("H",["HH",2],0,"hour"),H("h",["hh",2],0,function(){return this.hours()%12||12}),Sb("a",!0),Sb("A",!1),z("hour","h"),N("a",Tb),N("A",Tb),N("H",Wc),N("h",Wc),N("HH",Wc,Sc),N("hh",Wc,Sc),Q(["H","HH"],id),Q(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a),c._meridiem=a}),Q(["h","hh"],function(a,b,c){b[id]=q(a),j(c).bigHour=!0});var Hd=/[ap]\.?m?\.?/i,Id=C("Hours",!0);H("m",["mm",2],0,"minute"),z("minute","m"),N("m",Wc),N("mm",Wc,Sc),Q(["m","mm"],jd);var Jd=C("Minutes",!1);H("s",["ss",2],0,"second"),z("second","s"),N("s",Wc),N("ss",Wc,Sc),Q(["s","ss"],kd);var Kd=C("Seconds",!1);H("S",0,0,function(){return~~(this.millisecond()/100)}),H(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),H(0,["SSS",3],0,"millisecond"),H(0,["SSSS",4],0,function(){return 10*this.millisecond()}),H(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),H(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),H(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),H(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),H(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),z("millisecond","ms"),N("S",Xc,Rc),N("SS",Xc,Sc),N("SSS",Xc,Tc);var Ld;for(Ld="SSSS";Ld.length<=9;Ld+="S")N(Ld,$c);for(Ld="S";Ld.length<=9;Ld+="S")Q(Ld,Wb);var Md=C("Milliseconds",!1);H("z",0,0,"zoneAbbr"),H("zz",0,0,"zoneName");var Nd=n.prototype;Nd.add=Ad,Nd.calendar=cb,Nd.clone=db,Nd.diff=ib,Nd.endOf=ub,Nd.format=mb,Nd.from=nb,Nd.fromNow=ob,Nd.to=pb,Nd.toNow=qb,Nd.get=F,Nd.invalidAt=Cb,Nd.isAfter=eb,Nd.isBefore=fb,Nd.isBetween=gb,Nd.isSame=hb,Nd.isValid=Ab,Nd.lang=Cd,Nd.locale=rb,Nd.localeData=sb,Nd.max=wd,Nd.min=vd,Nd.parsingFlags=Bb,Nd.set=F,Nd.startOf=tb,Nd.subtract=Bd,Nd.toArray=yb,Nd.toObject=zb,Nd.toDate=xb,Nd.toISOString=lb,Nd.toJSON=lb,Nd.toString=kb,Nd.unix=wb,Nd.valueOf=vb,Nd.year=td,Nd.isLeapYear=ia,Nd.weekYear=Fb,Nd.isoWeekYear=Gb,Nd.quarter=Nd.quarters=Jb,Nd.month=Y,Nd.daysInMonth=Z,Nd.week=Nd.weeks=na,Nd.isoWeek=Nd.isoWeeks=oa,Nd.weeksInYear=Ib,Nd.isoWeeksInYear=Hb,Nd.date=Dd,Nd.day=Nd.days=Pb,Nd.weekday=Qb,Nd.isoWeekday=Rb,Nd.dayOfYear=qa,Nd.hour=Nd.hours=Id,Nd.minute=Nd.minutes=Jd,Nd.second=Nd.seconds=Kd,Nd.millisecond=Nd.milliseconds=Md,Nd.utcOffset=Na,Nd.utc=Pa,Nd.local=Qa,Nd.parseZone=Ra,Nd.hasAlignedHourOffset=Sa,Nd.isDST=Ta,Nd.isDSTShifted=Ua,Nd.isLocal=Va,Nd.isUtcOffset=Wa,Nd.isUtc=Xa,Nd.isUTC=Xa,Nd.zoneAbbr=Xb,Nd.zoneName=Yb,Nd.dates=aa("dates accessor is deprecated. Use date instead.",Dd),Nd.months=aa("months accessor is deprecated. Use month instead",Y),Nd.years=aa("years accessor is deprecated. Use year instead",td),Nd.zone=aa("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Oa);var Od=Nd,Pd={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Qd={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Rd="Invalid date",Sd="%d",Td=/\d{1,2}/,Ud={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Vd=s.prototype;Vd._calendar=Pd,Vd.calendar=_b,Vd._longDateFormat=Qd,Vd.longDateFormat=ac,Vd._invalidDate=Rd,Vd.invalidDate=bc,Vd._ordinal=Sd,Vd.ordinal=cc,Vd._ordinalParse=Td,Vd.preparse=dc,Vd.postformat=dc,Vd._relativeTime=Ud,Vd.relativeTime=ec,Vd.pastFuture=fc,Vd.set=gc,Vd.months=U,Vd._months=md,Vd.monthsShort=V,Vd._monthsShort=nd,Vd.monthsParse=W,Vd.week=ka,Vd._week=ud,Vd.firstDayOfYear=ma,Vd.firstDayOfWeek=la,Vd.weekdays=Lb,Vd._weekdays=Ed,Vd.weekdaysMin=Nb,Vd._weekdaysMin=Gd,Vd.weekdaysShort=Mb,Vd._weekdaysShort=Fd,Vd.weekdaysParse=Ob,Vd.isPM=Ub,Vd._meridiemParse=Hd,Vd.meridiem=Vb,w("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10,c=1===q(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),a.lang=aa("moment.lang is deprecated. Use moment.locale instead.",w),a.langData=aa("moment.langData is deprecated. Use moment.localeData instead.",y);var Wd=Math.abs,Xd=yc("ms"),Yd=yc("s"),Zd=yc("m"),$d=yc("h"),_d=yc("d"),ae=yc("w"),be=yc("M"),ce=yc("y"),de=Ac("milliseconds"),ee=Ac("seconds"),fe=Ac("minutes"),ge=Ac("hours"),he=Ac("days"),ie=Ac("months"),je=Ac("years"),ke=Math.round,le={s:45,m:45,h:22,d:26,M:11},me=Math.abs,ne=Ha.prototype;ne.abs=oc,ne.add=qc,ne.subtract=rc,ne.as=wc,ne.asMilliseconds=Xd,ne.asSeconds=Yd,ne.asMinutes=Zd,ne.asHours=$d,ne.asDays=_d,ne.asWeeks=ae,ne.asMonths=be,ne.asYears=ce,ne.valueOf=xc,ne._bubble=tc,ne.get=zc,ne.milliseconds=de,ne.seconds=ee,ne.minutes=fe,ne.hours=ge,ne.days=he,ne.weeks=Bc,ne.months=ie,ne.years=je,ne.humanize=Fc,ne.toISOString=Gc,ne.toString=Gc,ne.toJSON=Gc,ne.locale=rb,ne.localeData=sb,ne.toIsoString=aa("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Gc),ne.lang=Cd,H("X",0,0,"unix"),H("x",0,0,"valueOf"),N("x",_c),N("X",bd),Q("X",function(a,b,c){c._d=new Date(1e3*parseFloat(a,10))}),Q("x",function(a,b,c){c._d=new Date(q(a))}),a.version="2.10.6",b(Da),a.fn=Od,a.min=Fa,a.max=Ga,a.utc=h,a.unix=Zb,a.months=jc,a.isDate=d,a.locale=w,a.invalid=l,a.duration=Ya,a.isMoment=o,a.weekdays=lc,a.parseZone=$b,a.localeData=y,a.isDuration=Ia,a.monthsShort=kc,a.weekdaysMin=nc,a.defineLocale=x,a.weekdaysShort=mc,a.normalizeUnits=A,a.relativeTimeThreshold=Ec;var oe=a;return oe}),function(factory){"function"==typeof define&&define.amd?define("fullcalendar",["jquery","moment"],factory):"object"==typeof exports?module.exports=factory(require("jquery"),require("moment")):factory(jQuery,moment)}(function($,moment){function mergeOptions(optionObjs){return mergeProps(optionObjs,complexOptions)}function massageOverrides(input){var subObj,overrides={views:input.views||{}};return $.each(input,function(name,val){"views"!=name&&($.isPlainObject(val)&&!/(time|duration|interval)$/i.test(name)&&-1==$.inArray(name,complexOptions)?(subObj=null,$.each(val,function(subName,subVal){/^(month|week|day|default|basic(Week|Day)?|agenda(Week|Day)?)$/.test(subName)?(overrides.views[subName]||(overrides.views[subName]={}),overrides.views[subName][name]=subVal):(subObj||(subObj={}),subObj[subName]=subVal)}),subObj&&(overrides[name]=subObj)):overrides[name]=val)}),overrides}function compensateScroll(rowEls,scrollbarWidths){scrollbarWidths.left&&rowEls.css({"border-left-width":1,"margin-left":scrollbarWidths.left-1}),scrollbarWidths.right&&rowEls.css({"border-right-width":1,"margin-right":scrollbarWidths.right-1})}function uncompensateScroll(rowEls){rowEls.css({"margin-left":"","margin-right":"","border-left-width":"","border-right-width":""})}function disableCursor(){$("body").addClass("fc-not-allowed")}function enableCursor(){$("body").removeClass("fc-not-allowed")}function distributeHeight(els,availableHeight,shouldRedistribute){var minOffset1=Math.floor(availableHeight/els.length),minOffset2=Math.floor(availableHeight-minOffset1*(els.length-1)),flexEls=[],flexOffsets=[],flexHeights=[],usedHeight=0;undistributeHeight(els),els.each(function(i,el){var minOffset=i===els.length-1?minOffset2:minOffset1,naturalOffset=$(el).outerHeight(!0);
minOffset>naturalOffset?(flexEls.push(el),flexOffsets.push(naturalOffset),flexHeights.push($(el).height())):usedHeight+=naturalOffset}),shouldRedistribute&&(availableHeight-=usedHeight,minOffset1=Math.floor(availableHeight/flexEls.length),minOffset2=Math.floor(availableHeight-minOffset1*(flexEls.length-1))),$(flexEls).each(function(i,el){var minOffset=i===flexEls.length-1?minOffset2:minOffset1,naturalOffset=flexOffsets[i],naturalHeight=flexHeights[i],newHeight=minOffset-(naturalOffset-naturalHeight);minOffset>naturalOffset&&$(el).height(newHeight)})}function undistributeHeight(els){els.height("")}function matchCellWidths(els){var maxInnerWidth=0;return els.find("> *").each(function(i,innerEl){var innerWidth=$(innerEl).outerWidth();innerWidth>maxInnerWidth&&(maxInnerWidth=innerWidth)}),maxInnerWidth++,els.width(maxInnerWidth),maxInnerWidth}function setPotentialScroller(containerEl,height){return containerEl.height(height).addClass("fc-scroller"),containerEl[0].scrollHeight-1>containerEl[0].clientHeight?!0:(unsetScroller(containerEl),!1)}function unsetScroller(containerEl){containerEl.height("").removeClass("fc-scroller")}function getScrollParent(el){var position=el.css("position"),scrollParent=el.parents().filter(function(){var parent=$(this);return/(auto|scroll)/.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return"fixed"!==position&&scrollParent.length?scrollParent:$(el[0].ownerDocument||document)}function getOuterRect(el){var offset=el.offset();return{left:offset.left,right:offset.left+el.outerWidth(),top:offset.top,bottom:offset.top+el.outerHeight()}}function getClientRect(el){var offset=el.offset(),scrollbarWidths=getScrollbarWidths(el),left=offset.left+getCssFloat(el,"border-left-width")+scrollbarWidths.left,top=offset.top+getCssFloat(el,"border-top-width")+scrollbarWidths.top;return{left:left,right:left+el[0].clientWidth,top:top,bottom:top+el[0].clientHeight}}function getContentRect(el){var offset=el.offset(),left=offset.left+getCssFloat(el,"border-left-width")+getCssFloat(el,"padding-left"),top=offset.top+getCssFloat(el,"border-top-width")+getCssFloat(el,"padding-top");return{left:left,right:left+el.width(),top:top,bottom:top+el.height()}}function getScrollbarWidths(el){var leftRightWidth=el.innerWidth()-el[0].clientWidth,widths={left:0,right:0,top:0,bottom:el.innerHeight()-el[0].clientHeight};return getIsLeftRtlScrollbars()&&"rtl"==el.css("direction")?widths.left=leftRightWidth:widths.right=leftRightWidth,widths}function getIsLeftRtlScrollbars(){return null===_isLeftRtlScrollbars&&(_isLeftRtlScrollbars=computeIsLeftRtlScrollbars()),_isLeftRtlScrollbars}function computeIsLeftRtlScrollbars(){var el=$("<div><div/></div>").css({position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}).appendTo("body"),innerEl=el.children(),res=innerEl.offset().left>el.offset().left;return el.remove(),res}function getCssFloat(el,prop){return parseFloat(el.css(prop))||0}function isPrimaryMouseButton(ev){return 1==ev.which&&!ev.ctrlKey}function intersectRects(rect1,rect2){var res={left:Math.max(rect1.left,rect2.left),right:Math.min(rect1.right,rect2.right),top:Math.max(rect1.top,rect2.top),bottom:Math.min(rect1.bottom,rect2.bottom)};return res.left<res.right&&res.top<res.bottom?res:!1}function constrainPoint(point,rect){return{left:Math.min(Math.max(point.left,rect.left),rect.right),top:Math.min(Math.max(point.top,rect.top),rect.bottom)}}function getRectCenter(rect){return{left:(rect.left+rect.right)/2,top:(rect.top+rect.bottom)/2}}function diffPoints(point1,point2){return{left:point1.left-point2.left,top:point1.top-point2.top}}function parseFieldSpecs(input){var i,token,specs=[],tokens=[];for("string"==typeof input?tokens=input.split(/\s*,\s*/):"function"==typeof input?tokens=[input]:$.isArray(input)&&(tokens=input),i=0;i<tokens.length;i++)token=tokens[i],"string"==typeof token?specs.push("-"==token.charAt(0)?{field:token.substring(1),order:-1}:{field:token,order:1}):"function"==typeof token&&specs.push({func:token});return specs}function compareByFieldSpecs(obj1,obj2,fieldSpecs){var i,cmp;for(i=0;i<fieldSpecs.length;i++)if(cmp=compareByFieldSpec(obj1,obj2,fieldSpecs[i]))return cmp;return 0}function compareByFieldSpec(obj1,obj2,fieldSpec){return fieldSpec.func?fieldSpec.func(obj1,obj2):flexibleCompare(obj1[fieldSpec.field],obj2[fieldSpec.field])*(fieldSpec.order||1)}function flexibleCompare(a,b){return a||b?null==b?-1:null==a?1:"string"===$.type(a)||"string"===$.type(b)?String(a).localeCompare(String(b)):a-b:0}function intersectionToSeg(subjectRange,constraintRange){var segStart,segEnd,isStart,isEnd,subjectStart=subjectRange.start,subjectEnd=subjectRange.end,constraintStart=constraintRange.start,constraintEnd=constraintRange.end;return subjectEnd>constraintStart&&constraintEnd>subjectStart?(subjectStart>=constraintStart?(segStart=subjectStart.clone(),isStart=!0):(segStart=constraintStart.clone(),isStart=!1),constraintEnd>=subjectEnd?(segEnd=subjectEnd.clone(),isEnd=!0):(segEnd=constraintEnd.clone(),isEnd=!1),{start:segStart,end:segEnd,isStart:isStart,isEnd:isEnd}):void 0}function diffDayTime(a,b){return moment.duration({days:a.clone().stripTime().diff(b.clone().stripTime(),"days"),ms:a.time()-b.time()})}function diffDay(a,b){return moment.duration({days:a.clone().stripTime().diff(b.clone().stripTime(),"days")})}function diffByUnit(a,b,unit){return moment.duration(Math.round(a.diff(b,unit,!0)),unit)}function computeIntervalUnit(start,end){var i,unit,val;for(i=0;i<intervalUnits.length&&(unit=intervalUnits[i],val=computeRangeAs(unit,start,end),!(val>=1&&isInt(val)));i++);return unit}function computeRangeAs(unit,start,end){return null!=end?end.diff(start,unit,!0):moment.isDuration(start)?start.as(unit):start.end.diff(start.start,unit,!0)}function divideRangeByDuration(start,end,dur){var months;return durationHasTime(dur)?(end-start)/dur:(months=dur.asMonths(),Math.abs(months)>=1&&isInt(months)?end.diff(start,"months",!0)/months:end.diff(start,"days",!0)/dur.asDays())}function divideDurationByDuration(dur1,dur2){var months1,months2;return durationHasTime(dur1)||durationHasTime(dur2)?dur1/dur2:(months1=dur1.asMonths(),months2=dur2.asMonths(),Math.abs(months1)>=1&&isInt(months1)&&Math.abs(months2)>=1&&isInt(months2)?months1/months2:dur1.asDays()/dur2.asDays())}function multiplyDuration(dur,n){var months;return durationHasTime(dur)?moment.duration(dur*n):(months=dur.asMonths(),moment.duration(Math.abs(months)>=1&&isInt(months)?{months:months*n}:{days:dur.asDays()*n}))}function durationHasTime(dur){return Boolean(dur.hours()||dur.minutes()||dur.seconds()||dur.milliseconds())}function isNativeDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function isTimeString(str){return/^\d+\:\d+(?:\:\d+\.?(?:\d{3})?)?$/.test(str)}function mergeProps(propObjs,complexProps){var i,name,complexObjs,j,val,props,dest={};if(complexProps)for(i=0;i<complexProps.length;i++){for(name=complexProps[i],complexObjs=[],j=propObjs.length-1;j>=0;j--)if(val=propObjs[j][name],"object"==typeof val)complexObjs.unshift(val);else if(void 0!==val){dest[name]=val;break}complexObjs.length&&(dest[name]=mergeProps(complexObjs))}for(i=propObjs.length-1;i>=0;i--){props=propObjs[i];for(name in props)name in dest||(dest[name]=props[name])}return dest}function createObject(proto){var f=function(){};return f.prototype=proto,new f}function copyOwnProps(src,dest){for(var name in src)hasOwnProp(src,name)&&(dest[name]=src[name])}function copyNativeMethods(src,dest){var i,name,names=["constructor","toString","valueOf"];for(i=0;i<names.length;i++)name=names[i],src[name]!==Object.prototype[name]&&(dest[name]=src[name])}function hasOwnProp(obj,name){return hasOwnPropMethod.call(obj,name)}function isAtomic(val){return/undefined|null|boolean|number|string/.test($.type(val))}function applyAll(functions,thisObj,args){if($.isFunction(functions)&&(functions=[functions]),functions){var i,ret;for(i=0;i<functions.length;i++)ret=functions[i].apply(thisObj,args)||ret;return ret}}function firstDefined(){for(var i=0;i<arguments.length;i++)if(void 0!==arguments[i])return arguments[i]}function htmlEscape(s){return(s+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function stripHtmlEntities(text){return text.replace(/&.*?;/g,"")}function cssToStr(cssProps){var statements=[];return $.each(cssProps,function(name,val){null!=val&&statements.push(name+":"+val)}),statements.join(";")}function capitaliseFirstLetter(str){return str.charAt(0).toUpperCase()+str.slice(1)}function compareNumbers(a,b){return a-b}function isInt(n){return n%1===0}function proxy(obj,methodName){var method=obj[methodName];return function(){return method.apply(obj,arguments)}}function debounce(func,wait){var timeoutId,args,context,timestamp,later=function(){var last=+new Date-timestamp;wait>last&&last>0?timeoutId=setTimeout(later,wait-last):(timeoutId=null,func.apply(context,args),timeoutId||(context=args=null))};return function(){context=this,args=arguments,timestamp=+new Date,timeoutId||(timeoutId=setTimeout(later,wait))}}function makeMoment(args,parseAsUTC,parseZone){var isAmbigTime,isAmbigZone,ambigMatch,mom,input=args[0],isSingleString=1==args.length&&"string"==typeof input;return moment.isMoment(input)?(mom=moment.apply(null,args),transferAmbigs(input,mom)):isNativeDate(input)||void 0===input?mom=moment.apply(null,args):(isAmbigTime=!1,isAmbigZone=!1,isSingleString?ambigDateOfMonthRegex.test(input)?(input+="-01",args=[input],isAmbigTime=!0,isAmbigZone=!0):(ambigMatch=ambigTimeOrZoneRegex.exec(input))&&(isAmbigTime=!ambigMatch[5],isAmbigZone=!0):$.isArray(input)&&(isAmbigZone=!0),mom=parseAsUTC||isAmbigTime?moment.utc.apply(moment,args):moment.apply(null,args),isAmbigTime?(mom._ambigTime=!0,mom._ambigZone=!0):parseZone&&(isAmbigZone?mom._ambigZone=!0:isSingleString&&(mom.utcOffset?mom.utcOffset(input):mom.zone(input)))),mom._fullCalendar=!0,mom}function commonlyAmbiguate(inputs,preserveTime){var i,mom,anyAmbigTime=!1,anyAmbigZone=!1,len=inputs.length,moms=[];for(i=0;len>i;i++)mom=inputs[i],moment.isMoment(mom)||(mom=fc.moment.parseZone(mom)),anyAmbigTime=anyAmbigTime||mom._ambigTime,anyAmbigZone=anyAmbigZone||mom._ambigZone,moms.push(mom);for(i=0;len>i;i++)mom=moms[i],preserveTime||!anyAmbigTime||mom._ambigTime?anyAmbigZone&&!mom._ambigZone&&(moms[i]=mom.clone().stripZone()):moms[i]=mom.clone().stripTime();return moms}function transferAmbigs(src,dest){src._ambigTime?dest._ambigTime=!0:dest._ambigTime&&(dest._ambigTime=!1),src._ambigZone?dest._ambigZone=!0:dest._ambigZone&&(dest._ambigZone=!1)}function setMomentValues(mom,a){mom.year(a[0]||0).month(a[1]||0).date(a[2]||0).hours(a[3]||0).minutes(a[4]||0).seconds(a[5]||0).milliseconds(a[6]||0)}function oldMomentFormat(mom,formatStr){return oldMomentProto.format.call(mom,formatStr)}function formatDate(date,formatStr){return formatDateWithChunks(date,getFormatStringChunks(formatStr))}function formatDateWithChunks(date,chunks){var i,s="";for(i=0;i<chunks.length;i++)s+=formatDateWithChunk(date,chunks[i]);return s}function formatDateWithChunk(date,chunk){var token,maybeStr;return"string"==typeof chunk?chunk:(token=chunk.token)?tokenOverrides[token]?tokenOverrides[token](date):oldMomentFormat(date,token):chunk.maybe&&(maybeStr=formatDateWithChunks(date,chunk.maybe),maybeStr.match(/[1-9]/))?maybeStr:""}function formatRange(date1,date2,formatStr,separator,isRTL){var localeData;return date1=fc.moment.parseZone(date1),date2=fc.moment.parseZone(date2),localeData=(date1.localeData||date1.lang).call(date1),formatStr=localeData.longDateFormat(formatStr)||formatStr,separator=separator||" - ",formatRangeWithChunks(date1,date2,getFormatStringChunks(formatStr),separator,isRTL)}function formatRangeWithChunks(date1,date2,chunks,separator,isRTL){var chunkStr,leftI,rightI,middleI,leftStr="",rightStr="",middleStr1="",middleStr2="",middleStr="";for(leftI=0;leftI<chunks.length&&(chunkStr=formatSimilarChunk(date1,date2,chunks[leftI]),chunkStr!==!1);leftI++)leftStr+=chunkStr;for(rightI=chunks.length-1;rightI>leftI&&(chunkStr=formatSimilarChunk(date1,date2,chunks[rightI]),chunkStr!==!1);rightI--)rightStr=chunkStr+rightStr;for(middleI=leftI;rightI>=middleI;middleI++)middleStr1+=formatDateWithChunk(date1,chunks[middleI]),middleStr2+=formatDateWithChunk(date2,chunks[middleI]);return(middleStr1||middleStr2)&&(middleStr=isRTL?middleStr2+separator+middleStr1:middleStr1+separator+middleStr2),leftStr+middleStr+rightStr}function formatSimilarChunk(date1,date2,chunk){var token,unit;return"string"==typeof chunk?chunk:(token=chunk.token)&&(unit=similarUnitMap[token.charAt(0)],unit&&date1.isSame(date2,unit))?oldMomentFormat(date1,token):!1}function getFormatStringChunks(formatStr){return formatStr in formatStringChunkCache?formatStringChunkCache[formatStr]:formatStringChunkCache[formatStr]=chunkFormatString(formatStr)}function chunkFormatString(formatStr){for(var match,chunks=[],chunker=/\[([^\]]*)\]|\(([^\)]*)\)|(LTS|LT|(\w)\4*o?)|([^\w\[\(]+)/g;match=chunker.exec(formatStr);)match[1]?chunks.push(match[1]):match[2]?chunks.push({maybe:chunkFormatString(match[2])}):match[3]?chunks.push({token:match[3]}):match[5]&&chunks.push(match[5]);return chunks}function Class(){}function isCellsEqual(cell1,cell2){return cell1||cell2?cell1&&cell2?cell1.grid===cell2.grid&&cell1.row===cell2.row&&cell1.col===cell2.col:!1:!0}function isBgEvent(event){var rendering=getEventRendering(event);return"background"===rendering||"inverse-background"===rendering}function isInverseBgEvent(event){return"inverse-background"===getEventRendering(event)}function getEventRendering(event){return firstDefined((event.source||{}).rendering,event.rendering)}function groupEventsById(events){var i,event,eventsById={};for(i=0;i<events.length;i++)event=events[i],(eventsById[event._id]||(eventsById[event._id]=[])).push(event);return eventsById}function compareNormalRanges(range1,range2){return range1.eventStartMS-range2.eventStartMS}function getDraggedElMeta(el){var eventProps,startTime,duration,stick,prefix=fc.dataAttrPrefix;return prefix&&(prefix+="-"),eventProps=el.data(prefix+"event")||null,eventProps&&(eventProps="object"==typeof eventProps?$.extend({},eventProps):{},startTime=eventProps.start,null==startTime&&(startTime=eventProps.time),duration=eventProps.duration,stick=eventProps.stick,delete eventProps.start,delete eventProps.time,delete eventProps.duration,delete eventProps.stick),null==startTime&&(startTime=el.data(prefix+"start")),null==startTime&&(startTime=el.data(prefix+"time")),null==duration&&(duration=el.data(prefix+"duration")),null==stick&&(stick=el.data(prefix+"stick")),startTime=null!=startTime?moment.duration(startTime):null,duration=null!=duration?moment.duration(duration):null,stick=Boolean(stick),{eventProps:eventProps,startTime:startTime,duration:duration,stick:stick}}function isDaySegCollision(seg,otherSegs){var i,otherSeg;for(i=0;i<otherSegs.length;i++)if(otherSeg=otherSegs[i],otherSeg.leftCol<=seg.rightCol&&otherSeg.rightCol>=seg.leftCol)return!0;return!1}function compareDaySegCols(a,b){return a.leftCol-b.leftCol}function buildSlotSegLevels(segs){var i,seg,j,levels=[];for(i=0;i<segs.length;i++){for(seg=segs[i],j=0;j<levels.length&&computeSlotSegCollisions(seg,levels[j]).length;j++);seg.level=j,(levels[j]||(levels[j]=[])).push(seg)}return levels}function computeForwardSlotSegs(levels){var i,level,j,seg,k;for(i=0;i<levels.length;i++)for(level=levels[i],j=0;j<level.length;j++)for(seg=level[j],seg.forwardSegs=[],k=i+1;k<levels.length;k++)computeSlotSegCollisions(seg,levels[k],seg.forwardSegs)}function computeSlotSegPressures(seg){var i,forwardSeg,forwardSegs=seg.forwardSegs,forwardPressure=0;if(void 0===seg.forwardPressure){for(i=0;i<forwardSegs.length;i++)forwardSeg=forwardSegs[i],computeSlotSegPressures(forwardSeg),forwardPressure=Math.max(forwardPressure,1+forwardSeg.forwardPressure);seg.forwardPressure=forwardPressure}}function computeSlotSegCollisions(seg,otherSegs,results){results=results||[];for(var i=0;i<otherSegs.length;i++)isSlotSegCollision(seg,otherSegs[i])&&results.push(otherSegs[i]);return results}function isSlotSegCollision(seg1,seg2){return seg1.bottom>seg2.top&&seg1.top<seg2.bottom}function Calendar_constructor(element,overrides){function render(){content?elementVisible()&&(calcSize(),renderView()):initialRender()}function initialRender(){tm=options.theme?"ui":"fc",element.addClass("fc"),element.addClass(options.isRTL?"fc-rtl":"fc-ltr"),element.addClass(options.theme?"ui-widget":"fc-unthemed"),content=$("<div class='fc-view-container'/>").prependTo(element),header=t.header=new Header(t,options),headerElement=header.render(),headerElement&&element.prepend(headerElement),renderView(options.defaultView),options.handleWindowResize&&(windowResizeProxy=debounce(windowResize,options.windowResizeDelay),$(window).resize(windowResizeProxy))}function destroy(){currentView&&currentView.removeElement(),header.removeElement(),content.remove(),element.removeClass("fc fc-ltr fc-rtl fc-unthemed ui-widget"),windowResizeProxy&&$(window).unbind("resize",windowResizeProxy)}function elementVisible(){return element.is(":visible")}function renderView(viewType){ignoreWindowResize++,currentView&&viewType&&currentView.type!==viewType&&(header.deactivateButton(currentView.type),freezeContentHeight(),currentView.removeElement(),currentView=t.view=null),!currentView&&viewType&&(currentView=t.view=viewsByType[viewType]||(viewsByType[viewType]=t.instantiateView(viewType)),currentView.setElement($("<div class='fc-view fc-"+viewType+"-view' />").appendTo(content)),header.activateButton(viewType)),currentView&&(date=currentView.massageCurrentDate(date),currentView.displaying&&date.isWithin(currentView.intervalStart,currentView.intervalEnd)||elementVisible()&&(freezeContentHeight(),currentView.display(date),unfreezeContentHeight(),updateHeaderTitle(),updateTodayButton(),getAndRenderEvents())),unfreezeContentHeight(),ignoreWindowResize--}function updateSize(shouldRecalc){return elementVisible()?(shouldRecalc&&_calcSize(),ignoreWindowResize++,currentView.updateSize(!0),ignoreWindowResize--,!0):void 0}function calcSize(){elementVisible()&&_calcSize()}function _calcSize(){suggestedViewHeight="number"==typeof options.contentHeight?options.contentHeight:"number"==typeof options.height?options.height-(headerElement?headerElement.outerHeight(!0):0):Math.round(content.width()/Math.max(options.aspectRatio,.5))}function windowResize(ev){!ignoreWindowResize&&ev.target===window&&currentView.start&&updateSize(!0)&&currentView.trigger("windowResize",_element)}function refetchEvents(){destroyEvents(),fetchAndRenderEvents()}function renderEvents(){elementVisible()&&(freezeContentHeight(),currentView.displayEvents(events),unfreezeContentHeight())}function destroyEvents(){freezeContentHeight(),currentView.clearEvents(),unfreezeContentHeight()}function getAndRenderEvents(){!options.lazyFetching||isFetchNeeded(currentView.start,currentView.end)?fetchAndRenderEvents():renderEvents()}function fetchAndRenderEvents(){fetchEvents(currentView.start,currentView.end)}function reportEvents(_events){events=_events,renderEvents()}function reportEventChange(){renderEvents()}function updateHeaderTitle(){header.updateTitle(currentView.title)}function updateTodayButton(){var now=t.getNow();now.isWithin(currentView.intervalStart,currentView.intervalEnd)?header.disableButton("today"):header.enableButton("today")}function select(){currentView.select(t.buildSelectRange.apply(t,arguments))}function unselect(){currentView&&currentView.unselect()}function prev(){date=currentView.computePrevDate(date),renderView()}function next(){date=currentView.computeNextDate(date),renderView()}function prevYear(){date.add(-1,"years"),renderView()}function nextYear(){date.add(1,"years"),renderView()}function today(){date=t.getNow(),renderView()}function gotoDate(dateInput){date=t.moment(dateInput),renderView()}function incrementDate(delta){date.add(moment.duration(delta)),renderView()}function zoomTo(newDate,viewType){var spec;viewType=viewType||"day",spec=t.getViewSpec(viewType)||t.getUnitViewSpec(viewType),date=newDate,renderView(spec?spec.type:null)}function getDate(){return date.clone()}function freezeContentHeight(){content.css({width:"100%",height:content.height(),overflow:"hidden"})}function unfreezeContentHeight(){content.css({width:"",height:"",overflow:""})}function getCalendar(){return t}function getView(){return currentView}function option(name,value){return void 0===value?options[name]:void(("height"==name||"contentHeight"==name||"aspectRatio"==name)&&(options[name]=value,updateSize(!0)))}function trigger(name,thisObj){var args=Array.prototype.slice.call(arguments,2);return thisObj=thisObj||_element,this.triggerWith(name,thisObj,args),options[name]?options[name].apply(thisObj,args):void 0}var t=this;t.initOptions(overrides||{});var options=this.options;t.render=render,t.destroy=destroy,t.refetchEvents=refetchEvents,t.reportEvents=reportEvents,t.reportEventChange=reportEventChange,t.rerenderEvents=renderEvents,t.changeView=renderView,t.select=select,t.unselect=unselect,t.prev=prev,t.next=next,t.prevYear=prevYear,t.nextYear=nextYear,t.today=today,t.gotoDate=gotoDate,t.incrementDate=incrementDate,t.zoomTo=zoomTo,t.getDate=getDate,t.getCalendar=getCalendar,t.getView=getView,t.option=option,t.trigger=trigger;var localeData=createObject(getMomentLocaleData(options.lang));if(options.monthNames&&(localeData._months=options.monthNames),options.monthNamesShort&&(localeData._monthsShort=options.monthNamesShort),options.dayNames&&(localeData._weekdays=options.dayNames),options.dayNamesShort&&(localeData._weekdaysShort=options.dayNamesShort),null!=options.firstDay){var _week=createObject(localeData._week);_week.dow=options.firstDay,localeData._week=_week}localeData._fullCalendar_weekCalc=function(weekCalc){return"function"==typeof weekCalc?weekCalc:"local"===weekCalc?weekCalc:"iso"===weekCalc||"ISO"===weekCalc?"ISO":void 0}(options.weekNumberCalculation),t.defaultAllDayEventDuration=moment.duration(options.defaultAllDayEventDuration),t.defaultTimedEventDuration=moment.duration(options.defaultTimedEventDuration),t.moment=function(){var mom;return"local"===options.timezone?(mom=fc.moment.apply(null,arguments),mom.hasTime()&&mom.local()):mom="UTC"===options.timezone?fc.moment.utc.apply(null,arguments):fc.moment.parseZone.apply(null,arguments),"_locale"in mom?mom._locale=localeData:mom._lang=localeData,mom},t.getIsAmbigTimezone=function(){return"local"!==options.timezone&&"UTC"!==options.timezone},t.rezoneDate=function(date){return t.moment(date.toArray())},t.getNow=function(){var now=options.now;return"function"==typeof now&&(now=now()),t.moment(now)},t.getEventEnd=function(event){return event.end?event.end.clone():t.getDefaultEventEnd(event.allDay,event.start)},t.getDefaultEventEnd=function(allDay,start){var end=start.clone();return allDay?end.stripTime().add(t.defaultAllDayEventDuration):end.add(t.defaultTimedEventDuration),t.getIsAmbigTimezone()&&end.stripZone(),end},t.humanizeDuration=function(duration){return(duration.locale||duration.lang).call(duration,options.lang).humanize()},EventManager.call(t,options);var header,headerElement,content,tm,currentView,suggestedViewHeight,windowResizeProxy,date,isFetchNeeded=t.isFetchNeeded,fetchEvents=t.fetchEvents,_element=element[0],viewsByType={},ignoreWindowResize=0,events=[];date=null!=options.defaultDate?t.moment(options.defaultDate):t.getNow(),t.getSuggestedViewHeight=function(){return void 0===suggestedViewHeight&&calcSize(),suggestedViewHeight},t.isHeightAuto=function(){return"auto"===options.contentHeight||"auto"===options.height},t.initialize()}function populateInstanceComputableOptions(options){$.each(instanceComputableOptions,function(name,func){null==options[name]&&(options[name]=func(options))})}function getMomentLocaleData(langCode){var func=moment.localeData||moment.langData;return func.call(moment,langCode)||func.call(moment,"en")}function Header(calendar,options){function render(){var sections=options.header;return tm=options.theme?"ui":"fc",sections?el=$("<div class='fc-toolbar'/>").append(renderSection("left")).append(renderSection("right")).append(renderSection("center")).append('<div class="fc-clear"/>'):void 0}function removeElement(){el.remove(),el=$()}function renderSection(position){var sectionEl=$('<div class="fc-'+position+'"/>'),buttonStr=options.header[position];return buttonStr&&$.each(buttonStr.split(" "),function(){var groupEl,groupChildren=$(),isOnlyButtons=!0;$.each(this.split(","),function(j,buttonName){var customButtonProps,viewSpec,buttonClick,overrideText,defaultText,themeIcon,normalIcon,innerHtml,classes,button;"title"==buttonName?(groupChildren=groupChildren.add($("<h2>&nbsp;</h2>")),isOnlyButtons=!1):((customButtonProps=(calendar.options.customButtons||{})[buttonName])?(buttonClick=function(ev){customButtonProps.click&&customButtonProps.click.call(button[0],ev)},overrideText="",defaultText=customButtonProps.text):(viewSpec=calendar.getViewSpec(buttonName))?(buttonClick=function(){calendar.changeView(buttonName)},viewsWithButtons.push(buttonName),overrideText=viewSpec.buttonTextOverride,defaultText=viewSpec.buttonTextDefault):calendar[buttonName]&&(buttonClick=function(){calendar[buttonName]()},overrideText=(calendar.overrides.buttonText||{})[buttonName],defaultText=options.buttonText[buttonName]),buttonClick&&(themeIcon=customButtonProps?customButtonProps.themeIcon:options.themeButtonIcons[buttonName],normalIcon=customButtonProps?customButtonProps.icon:options.buttonIcons[buttonName],innerHtml=overrideText?htmlEscape(overrideText):themeIcon&&options.theme?"<span class='ui-icon ui-icon-"+themeIcon+"'></span>":normalIcon&&!options.theme?"<span class='fc-icon fc-icon-"+normalIcon+"'></span>":htmlEscape(defaultText),classes=["fc-"+buttonName+"-button",tm+"-button",tm+"-state-default"],button=$('<button type="button" class="'+classes.join(" ")+'">'+innerHtml+"</button>").click(function(ev){button.hasClass(tm+"-state-disabled")||(buttonClick(ev),(button.hasClass(tm+"-state-active")||button.hasClass(tm+"-state-disabled"))&&button.removeClass(tm+"-state-hover"))}).mousedown(function(){button.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-down")}).mouseup(function(){button.removeClass(tm+"-state-down")}).hover(function(){button.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-hover")},function(){button.removeClass(tm+"-state-hover").removeClass(tm+"-state-down")}),groupChildren=groupChildren.add(button)))}),isOnlyButtons&&groupChildren.first().addClass(tm+"-corner-left").end().last().addClass(tm+"-corner-right").end(),groupChildren.length>1?(groupEl=$("<div/>"),isOnlyButtons&&groupEl.addClass("fc-button-group"),groupEl.append(groupChildren),sectionEl.append(groupEl)):sectionEl.append(groupChildren)}),sectionEl}function updateTitle(text){el.find("h2").text(text)}function activateButton(buttonName){el.find(".fc-"+buttonName+"-button").addClass(tm+"-state-active")}function deactivateButton(buttonName){el.find(".fc-"+buttonName+"-button").removeClass(tm+"-state-active")}function disableButton(buttonName){el.find(".fc-"+buttonName+"-button").attr("disabled","disabled").addClass(tm+"-state-disabled")}function enableButton(buttonName){el.find(".fc-"+buttonName+"-button").removeAttr("disabled").removeClass(tm+"-state-disabled")}function getViewsWithButtons(){return viewsWithButtons}var t=this;t.render=render,t.removeElement=removeElement,t.updateTitle=updateTitle,t.activateButton=activateButton,t.deactivateButton=deactivateButton,t.disableButton=disableButton,t.enableButton=enableButton,t.getViewsWithButtons=getViewsWithButtons;var tm,el=$(),viewsWithButtons=[]}function EventManager(options){function isFetchNeeded(start,end){return!rangeStart||start.clone().stripZone()<rangeStart.clone().stripZone()||end.clone().stripZone()>rangeEnd.clone().stripZone()}function fetchEvents(start,end){rangeStart=start,rangeEnd=end,cache=[];var fetchID=++currentFetchID,len=sources.length;pendingSourceCnt=len;for(var i=0;len>i;i++)fetchEventSource(sources[i],fetchID)}function fetchEventSource(source,fetchID){_fetchEventSource(source,function(eventInputs){var i,eventInput,abstractEvent,isArraySource=$.isArray(source.events);if(fetchID==currentFetchID){if(eventInputs)for(i=0;i<eventInputs.length;i++)eventInput=eventInputs[i],abstractEvent=isArraySource?eventInput:buildEventFromInput(eventInput,source),abstractEvent&&cache.push.apply(cache,expandEvent(abstractEvent));pendingSourceCnt--,pendingSourceCnt||reportEvents(cache)}})}function _fetchEventSource(source,callback){var i,res,fetchers=fc.sourceFetchers;for(i=0;i<fetchers.length;i++){if(res=fetchers[i].call(t,source,rangeStart.clone(),rangeEnd.clone(),options.timezone,callback),res===!0)return;if("object"==typeof res)return void _fetchEventSource(res,callback)}var events=source.events;if(events)$.isFunction(events)?(t.pushLoading(),events.call(t,rangeStart.clone(),rangeEnd.clone(),options.timezone,function(events){callback(events),t.popLoading()})):$.isArray(events)?callback(events):callback();else{var url=source.url;if(url){var customData,success=source.success,error=source.error,complete=source.complete;customData=$.isFunction(source.data)?source.data():source.data;var data=$.extend({},customData||{}),startParam=firstDefined(source.startParam,options.startParam),endParam=firstDefined(source.endParam,options.endParam),timezoneParam=firstDefined(source.timezoneParam,options.timezoneParam);startParam&&(data[startParam]=rangeStart.format()),endParam&&(data[endParam]=rangeEnd.format()),options.timezone&&"local"!=options.timezone&&(data[timezoneParam]=options.timezone),t.pushLoading(),$.ajax($.extend({},ajaxDefaults,source,{data:data,success:function(events){events=events||[];var res=applyAll(success,this,arguments);$.isArray(res)&&(events=res),callback(events)},error:function(){applyAll(error,this,arguments),callback()},complete:function(){applyAll(complete,this,arguments),t.popLoading()}}))}else callback()}}function addEventSource(sourceInput){var source=buildEventSource(sourceInput);source&&(sources.push(source),pendingSourceCnt++,fetchEventSource(source,currentFetchID))}function buildEventSource(sourceInput){var source,i,normalizers=fc.sourceNormalizers;if($.isFunction(sourceInput)||$.isArray(sourceInput)?source={events:sourceInput}:"string"==typeof sourceInput?source={url:sourceInput}:"object"==typeof sourceInput&&(source=$.extend({},sourceInput)),source){for(source.className?"string"==typeof source.className&&(source.className=source.className.split(/\s+/)):source.className=[],$.isArray(source.events)&&(source.origArray=source.events,source.events=$.map(source.events,function(eventInput){return buildEventFromInput(eventInput,source)})),i=0;i<normalizers.length;i++)normalizers[i].call(t,source);return source}}function removeEventSource(source){sources=$.grep(sources,function(src){return!isSourcesEqual(src,source)}),cache=$.grep(cache,function(e){return!isSourcesEqual(e.source,source)}),reportEvents(cache)}function isSourcesEqual(source1,source2){return source1&&source2&&getSourcePrimitive(source1)==getSourcePrimitive(source2)}function getSourcePrimitive(source){return("object"==typeof source?source.origArray||source.googleCalendarId||source.url||source.events:null)||source}function updateEvent(event){event.start=t.moment(event.start),event.end=event.end?t.moment(event.end):null,mutateEvent(event,getMiscEventProps(event)),reportEvents(cache)}function getMiscEventProps(event){var props={};return $.each(event,function(name,val){isMiscEventPropName(name)&&void 0!==val&&isAtomic(val)&&(props[name]=val)}),props}function isMiscEventPropName(name){return!/^_|^(id|allDay|start|end)$/.test(name)}function renderEvent(eventInput,stick){var events,i,event,abstractEvent=buildEventFromInput(eventInput);if(abstractEvent){for(events=expandEvent(abstractEvent),i=0;i<events.length;i++)event=events[i],event.source||(stick&&(stickySource.events.push(event),event.source=stickySource),cache.push(event));
return reportEvents(cache),events}return[]}function removeEvents(filter){var eventID,i;for(null==filter?filter=function(){return!0}:$.isFunction(filter)||(eventID=filter+"",filter=function(event){return event._id==eventID}),cache=$.grep(cache,filter,!0),i=0;i<sources.length;i++)$.isArray(sources[i].events)&&(sources[i].events=$.grep(sources[i].events,filter,!0));reportEvents(cache)}function clientEvents(filter){return $.isFunction(filter)?$.grep(cache,filter):null!=filter?(filter+="",$.grep(cache,function(e){return e._id==filter})):cache}function buildEventFromInput(input,source){var start,end,allDay,out={};if(options.eventDataTransform&&(input=options.eventDataTransform(input)),source&&source.eventDataTransform&&(input=source.eventDataTransform(input)),$.extend(out,input),source&&(out.source=source),out._id=input._id||(void 0===input.id?"_fc"+eventGUID++:input.id+""),out.className=input.className?"string"==typeof input.className?input.className.split(/\s+/):input.className:[],start=input.start||input.date,end=input.end,isTimeString(start)&&(start=moment.duration(start)),isTimeString(end)&&(end=moment.duration(end)),input.dow||moment.isDuration(start)||moment.isDuration(end))out.start=start?moment.duration(start):null,out.end=end?moment.duration(end):null,out._recurring=!0;else{if(start&&(start=t.moment(start),!start.isValid()))return!1;end&&(end=t.moment(end),end.isValid()||(end=null)),allDay=input.allDay,void 0===allDay&&(allDay=firstDefined(source?source.allDayDefault:void 0,options.allDayDefault)),assignDatesToEvent(start,end,allDay,out)}return out}function assignDatesToEvent(start,end,allDay,event){event.start=start,event.end=end,event.allDay=allDay,normalizeEventRange(event),backupEventDates(event)}function normalizeEventRange(props){normalizeEventRangeTimes(props),props.end&&!props.end.isAfter(props.start)&&(props.end=null),props.end||(props.end=options.forceEventDuration?t.getDefaultEventEnd(props.allDay,props.start):null)}function normalizeEventRangeTimes(range){null==range.allDay&&(range.allDay=!(range.start.hasTime()||range.end&&range.end.hasTime())),range.allDay?(range.start.stripTime(),range.end&&range.end.stripTime()):(range.start.hasTime()||(range.start=t.rezoneDate(range.start)),range.end&&!range.end.hasTime()&&(range.end=t.rezoneDate(range.end)))}function ensureVisibleEventRange(range){var allDay;return range.end||(allDay=range.allDay,null==allDay&&(allDay=!range.start.hasTime()),range=$.extend({},range),range.end=t.getDefaultEventEnd(allDay,range.start)),range}function expandEvent(abstractEvent,_rangeStart,_rangeEnd){var dowHash,dow,i,date,startTime,endTime,start,end,event,events=[];if(_rangeStart=_rangeStart||rangeStart,_rangeEnd=_rangeEnd||rangeEnd,abstractEvent)if(abstractEvent._recurring){if(dow=abstractEvent.dow)for(dowHash={},i=0;i<dow.length;i++)dowHash[dow[i]]=!0;for(date=_rangeStart.clone().stripTime();date.isBefore(_rangeEnd);)(!dowHash||dowHash[date.day()])&&(startTime=abstractEvent.start,endTime=abstractEvent.end,start=date.clone(),end=null,startTime&&(start=start.time(startTime)),endTime&&(end=date.clone().time(endTime)),event=$.extend({},abstractEvent),assignDatesToEvent(start,end,!startTime&&!endTime,event),events.push(event)),date.add(1,"days")}else events.push(abstractEvent);return events}function mutateEvent(event,newProps,largeUnit){function diffDates(date1,date0){return largeUnit?diffByUnit(date1,date0,largeUnit):newProps.allDay?diffDay(date1,date0):diffDayTime(date1,date0)}var oldProps,clearEnd,startDelta,endDelta,durationDelta,undoFunc,miscProps={};return newProps=newProps||{},newProps.start||(newProps.start=event.start.clone()),void 0===newProps.end&&(newProps.end=event.end?event.end.clone():null),null==newProps.allDay&&(newProps.allDay=event.allDay),normalizeEventRange(newProps),oldProps={start:event._start.clone(),end:event._end?event._end.clone():t.getDefaultEventEnd(event._allDay,event._start),allDay:newProps.allDay},normalizeEventRange(oldProps),clearEnd=null!==event._end&&null===newProps.end,startDelta=diffDates(newProps.start,oldProps.start),newProps.end?(endDelta=diffDates(newProps.end,oldProps.end),durationDelta=endDelta.subtract(startDelta)):durationDelta=null,$.each(newProps,function(name,val){isMiscEventPropName(name)&&void 0!==val&&(miscProps[name]=val)}),undoFunc=mutateEvents(clientEvents(event._id),clearEnd,newProps.allDay,startDelta,durationDelta,miscProps),{dateDelta:startDelta,durationDelta:durationDelta,undo:undoFunc}}function mutateEvents(events,clearEnd,allDay,dateDelta,durationDelta,miscProps){var isAmbigTimezone=t.getIsAmbigTimezone(),undoFunctions=[];return dateDelta&&!dateDelta.valueOf()&&(dateDelta=null),durationDelta&&!durationDelta.valueOf()&&(durationDelta=null),$.each(events,function(i,event){var oldProps,newProps;oldProps={start:event.start.clone(),end:event.end?event.end.clone():null,allDay:event.allDay},$.each(miscProps,function(name){oldProps[name]=event[name]}),newProps={start:event._start,end:event._end,allDay:allDay},normalizeEventRange(newProps),clearEnd?newProps.end=null:durationDelta&&!newProps.end&&(newProps.end=t.getDefaultEventEnd(newProps.allDay,newProps.start)),dateDelta&&(newProps.start.add(dateDelta),newProps.end&&newProps.end.add(dateDelta)),durationDelta&&newProps.end.add(durationDelta),isAmbigTimezone&&!newProps.allDay&&(dateDelta||durationDelta)&&(newProps.start.stripZone(),newProps.end&&newProps.end.stripZone()),$.extend(event,miscProps,newProps),backupEventDates(event),undoFunctions.push(function(){$.extend(event,oldProps),backupEventDates(event)})}),function(){for(var i=0;i<undoFunctions.length;i++)undoFunctions[i]()}}function getBusinessHoursEvents(wholeDay){var eventInput,optionVal=options.businessHours,defaultVal={className:"fc-nonbusiness",start:"09:00",end:"17:00",dow:[1,2,3,4,5],rendering:"inverse-background"},view=t.getView();return optionVal&&(eventInput=$.extend({},defaultVal,"object"==typeof optionVal?optionVal:{})),eventInput?(wholeDay&&(eventInput.start=null,eventInput.end=null),expandEvent(buildEventFromInput(eventInput),view.start,view.end)):[]}function isEventRangeAllowed(range,event){var source=event.source||{},constraint=firstDefined(event.constraint,source.constraint,options.eventConstraint),overlap=firstDefined(event.overlap,source.overlap,options.eventOverlap);return range=ensureVisibleEventRange(range),isRangeAllowed(range,constraint,overlap,event)}function isSelectionRangeAllowed(range){return isRangeAllowed(range,options.selectConstraint,options.selectOverlap)}function isExternalDropRangeAllowed(range,eventProps){var eventInput,event;return eventProps&&(eventInput=$.extend({},eventProps,range),event=expandEvent(buildEventFromInput(eventInput))[0]),event?isEventRangeAllowed(range,event):(range=ensureVisibleEventRange(range),isSelectionRangeAllowed(range))}function isRangeAllowed(range,constraint,overlap,event){var constraintEvents,anyContainment,peerEvents,i,peerEvent,peerOverlap;if(range=$.extend({},range),range.start=range.start.clone().stripZone(),range.end=range.end.clone().stripZone(),null!=constraint){for(constraintEvents=constraintToEvents(constraint),anyContainment=!1,i=0;i<constraintEvents.length;i++)if(eventContainsRange(constraintEvents[i],range)){anyContainment=!0;break}if(!anyContainment)return!1}for(peerEvents=t.getPeerEvents(event,range),i=0;i<peerEvents.length;i++)if(peerEvent=peerEvents[i],eventIntersectsRange(peerEvent,range)){if(overlap===!1)return!1;if("function"==typeof overlap&&!overlap(peerEvent,event))return!1;if(event){if(peerOverlap=firstDefined(peerEvent.overlap,(peerEvent.source||{}).overlap),peerOverlap===!1)return!1;if("function"==typeof peerOverlap&&!peerOverlap(event,peerEvent))return!1}}return!0}function constraintToEvents(constraintInput){return"businessHours"===constraintInput?getBusinessHoursEvents():"object"==typeof constraintInput?expandEvent(buildEventFromInput(constraintInput)):clientEvents(constraintInput)}function eventContainsRange(event,range){var eventStart=event.start.clone().stripZone(),eventEnd=t.getEventEnd(event).stripZone();return range.start>=eventStart&&range.end<=eventEnd}function eventIntersectsRange(event,range){var eventStart=event.start.clone().stripZone(),eventEnd=t.getEventEnd(event).stripZone();return range.start<eventEnd&&range.end>eventStart}var t=this;t.isFetchNeeded=isFetchNeeded,t.fetchEvents=fetchEvents,t.addEventSource=addEventSource,t.removeEventSource=removeEventSource,t.updateEvent=updateEvent,t.renderEvent=renderEvent,t.removeEvents=removeEvents,t.clientEvents=clientEvents,t.mutateEvent=mutateEvent,t.normalizeEventRange=normalizeEventRange,t.normalizeEventRangeTimes=normalizeEventRangeTimes,t.ensureVisibleEventRange=ensureVisibleEventRange;var rangeStart,rangeEnd,reportEvents=t.reportEvents,stickySource={events:[]},sources=[stickySource],currentFetchID=0,pendingSourceCnt=0,cache=[];$.each((options.events?[options.events]:[]).concat(options.eventSources||[]),function(i,sourceInput){var source=buildEventSource(sourceInput);source&&sources.push(source)}),t.getBusinessHoursEvents=getBusinessHoursEvents,t.isEventRangeAllowed=isEventRangeAllowed,t.isSelectionRangeAllowed=isSelectionRangeAllowed,t.isExternalDropRangeAllowed=isExternalDropRangeAllowed,t.getEventCache=function(){return cache}}function backupEventDates(event){event._allDay=event.allDay,event._start=event.start.clone(),event._end=event.end?event.end.clone():null}var fc=$.fullCalendar={version:"2.4.0"},fcViews=fc.views={};$.fn.fullCalendar=function(options){var args=Array.prototype.slice.call(arguments,1),res=this;return this.each(function(i,_element){var singleRes,element=$(_element),calendar=element.data("fullCalendar");"string"==typeof options?calendar&&$.isFunction(calendar[options])&&(singleRes=calendar[options].apply(calendar,args),i||(res=singleRes),"destroy"===options&&element.removeData("fullCalendar")):calendar||(calendar=new Calendar(element,options),element.data("fullCalendar",calendar),calendar.render())}),res};var complexOptions=["header","buttonText","buttonIcons","themeButtonIcons"];fc.intersectionToSeg=intersectionToSeg,fc.applyAll=applyAll,fc.debounce=debounce,fc.isInt=isInt,fc.htmlEscape=htmlEscape,fc.cssToStr=cssToStr,fc.proxy=proxy,fc.capitaliseFirstLetter=capitaliseFirstLetter,fc.getClientRect=getClientRect,fc.getContentRect=getContentRect,fc.getScrollbarWidths=getScrollbarWidths;var _isLeftRtlScrollbars=null;fc.intersectRects=intersectRects,fc.parseFieldSpecs=parseFieldSpecs,fc.compareByFieldSpecs=compareByFieldSpecs,fc.compareByFieldSpec=compareByFieldSpec,fc.flexibleCompare=flexibleCompare,fc.computeIntervalUnit=computeIntervalUnit,fc.divideRangeByDuration=divideRangeByDuration,fc.divideDurationByDuration=divideDurationByDuration,fc.multiplyDuration=multiplyDuration,fc.durationHasTime=durationHasTime;var dayIDs=["sun","mon","tue","wed","thu","fri","sat"],intervalUnits=["year","month","week","day","hour","minute","second","millisecond"];fc.log=function(){var console=window.console;return console&&console.log?console.log.apply(console,arguments):void 0},fc.warn=function(){var console=window.console;return console&&console.warn?console.warn.apply(console,arguments):fc.log.apply(fc,arguments)};var allowValueOptimization,setUTCValues,setLocalValues,hasOwnPropMethod={}.hasOwnProperty,ambigDateOfMonthRegex=/^\s*\d{4}-\d\d$/,ambigTimeOrZoneRegex=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?)?$/,newMomentProto=moment.fn,oldMomentProto=$.extend({},newMomentProto);fc.moment=function(){return makeMoment(arguments)},fc.moment.utc=function(){var mom=makeMoment(arguments,!0);return mom.hasTime()&&mom.utc(),mom},fc.moment.parseZone=function(){return makeMoment(arguments,!0,!0)},newMomentProto.clone=function(){var mom=oldMomentProto.clone.apply(this,arguments);return transferAmbigs(this,mom),this._fullCalendar&&(mom._fullCalendar=!0),mom},newMomentProto.week=newMomentProto.weeks=function(input){var weekCalc=(this._locale||this._lang)._fullCalendar_weekCalc;return null==input&&"function"==typeof weekCalc?weekCalc(this):"ISO"===weekCalc?oldMomentProto.isoWeek.apply(this,arguments):oldMomentProto.week.apply(this,arguments)},newMomentProto.time=function(time){if(!this._fullCalendar)return oldMomentProto.time.apply(this,arguments);if(null==time)return moment.duration({hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()});this._ambigTime=!1,moment.isDuration(time)||moment.isMoment(time)||(time=moment.duration(time));var dayHours=0;return moment.isDuration(time)&&(dayHours=24*Math.floor(time.asDays())),this.hours(dayHours+time.hours()).minutes(time.minutes()).seconds(time.seconds()).milliseconds(time.milliseconds())},newMomentProto.stripTime=function(){var a;return this._ambigTime||(a=this.toArray(),this.utc(),setUTCValues(this,a.slice(0,3)),this._ambigTime=!0,this._ambigZone=!0),this},newMomentProto.hasTime=function(){return!this._ambigTime},newMomentProto.stripZone=function(){var a,wasAmbigTime;return this._ambigZone||(a=this.toArray(),wasAmbigTime=this._ambigTime,this.utc(),setUTCValues(this,a),this._ambigTime=wasAmbigTime||!1,this._ambigZone=!0),this},newMomentProto.hasZone=function(){return!this._ambigZone},newMomentProto.local=function(){var a=this.toArray(),wasAmbigZone=this._ambigZone;return oldMomentProto.local.apply(this,arguments),this._ambigTime=!1,this._ambigZone=!1,wasAmbigZone&&setLocalValues(this,a),this},newMomentProto.utc=function(){return oldMomentProto.utc.apply(this,arguments),this._ambigTime=!1,this._ambigZone=!1,this},$.each(["zone","utcOffset"],function(i,name){oldMomentProto[name]&&(newMomentProto[name]=function(tzo){return null!=tzo&&(this._ambigTime=!1,this._ambigZone=!1),oldMomentProto[name].apply(this,arguments)})}),newMomentProto.format=function(){return this._fullCalendar&&arguments[0]?formatDate(this,arguments[0]):this._ambigTime?oldMomentFormat(this,"YYYY-MM-DD"):this._ambigZone?oldMomentFormat(this,"YYYY-MM-DD[T]HH:mm:ss"):oldMomentProto.format.apply(this,arguments)},newMomentProto.toISOString=function(){return this._ambigTime?oldMomentFormat(this,"YYYY-MM-DD"):this._ambigZone?oldMomentFormat(this,"YYYY-MM-DD[T]HH:mm:ss"):oldMomentProto.toISOString.apply(this,arguments)},newMomentProto.isWithin=function(start,end){var a=commonlyAmbiguate([this,start,end]);return a[0]>=a[1]&&a[0]<a[2]},newMomentProto.isSame=function(input,units){var a;return this._fullCalendar?units?(a=commonlyAmbiguate([this,input],!0),oldMomentProto.isSame.call(a[0],a[1],units)):(input=fc.moment.parseZone(input),oldMomentProto.isSame.call(this,input)&&Boolean(this._ambigTime)===Boolean(input._ambigTime)&&Boolean(this._ambigZone)===Boolean(input._ambigZone)):oldMomentProto.isSame.apply(this,arguments)},$.each(["isBefore","isAfter"],function(i,methodName){newMomentProto[methodName]=function(input,units){var a;return this._fullCalendar?(a=commonlyAmbiguate([this,input]),oldMomentProto[methodName].call(a[0],a[1],units)):oldMomentProto[methodName].apply(this,arguments)}}),allowValueOptimization="_d"in moment()&&"updateOffset"in moment,setUTCValues=allowValueOptimization?function(mom,a){mom._d.setTime(Date.UTC.apply(Date,a)),moment.updateOffset(mom,!1)}:setMomentValues,setLocalValues=allowValueOptimization?function(mom,a){mom._d.setTime(+new Date(a[0]||0,a[1]||0,a[2]||0,a[3]||0,a[4]||0,a[5]||0,a[6]||0)),moment.updateOffset(mom,!1)}:setMomentValues;var tokenOverrides={t:function(date){return oldMomentFormat(date,"a").charAt(0)},T:function(date){return oldMomentFormat(date,"A").charAt(0)}};fc.formatRange=formatRange;var similarUnitMap={Y:"year",M:"month",D:"day",d:"day",A:"second",a:"second",T:"second",t:"second",H:"second",h:"second",m:"second",s:"second"},formatStringChunkCache={};fc.Class=Class,Class.extend=function(members){var subClass,superClass=this;return members=members||{},hasOwnProp(members,"constructor")&&(subClass=members.constructor),"function"!=typeof subClass&&(subClass=members.constructor=function(){superClass.apply(this,arguments)}),subClass.prototype=createObject(superClass.prototype),copyOwnProps(members,subClass.prototype),copyNativeMethods(members,subClass.prototype),copyOwnProps(superClass,subClass),subClass},Class.mixin=function(members){copyOwnProps(members.prototype||members,this.prototype)};var Emitter=fc.Emitter=Class.extend({callbackHash:null,on:function(name,callback){return this.getCallbacks(name).add(callback),this},off:function(name,callback){return this.getCallbacks(name).remove(callback),this},trigger:function(name){var args=Array.prototype.slice.call(arguments,1);return this.triggerWith(name,this,args),this},triggerWith:function(name,context,args){var callbacks=this.getCallbacks(name);return callbacks.fireWith(context,args),this},getCallbacks:function(name){var callbacks;return this.callbackHash||(this.callbackHash={}),callbacks=this.callbackHash[name],callbacks||(callbacks=this.callbackHash[name]=$.Callbacks()),callbacks}}),Popover=Class.extend({isHidden:!0,options:null,el:null,documentMousedownProxy:null,margin:10,constructor:function(options){this.options=options||{}},show:function(){this.isHidden&&(this.el||this.render(),this.el.show(),this.position(),this.isHidden=!1,this.trigger("show"))},hide:function(){this.isHidden||(this.el.hide(),this.isHidden=!0,this.trigger("hide"))},render:function(){var _this=this,options=this.options;this.el=$('<div class="fc-popover"/>').addClass(options.className||"").css({top:0,left:0}).append(options.content).appendTo(options.parentEl),this.el.on("click",".fc-close",function(){_this.hide()}),options.autoHide&&$(document).on("mousedown",this.documentMousedownProxy=proxy(this,"documentMousedown"))},documentMousedown:function(ev){this.el&&!$(ev.target).closest(this.el).length&&this.hide()},removeElement:function(){this.hide(),this.el&&(this.el.remove(),this.el=null),$(document).off("mousedown",this.documentMousedownProxy)},position:function(){var viewportTop,viewportLeft,viewportOffset,top,left,options=this.options,origin=this.el.offsetParent().offset(),width=this.el.outerWidth(),height=this.el.outerHeight(),windowEl=$(window),viewportEl=getScrollParent(this.el);top=options.top||0,left=void 0!==options.left?options.left:void 0!==options.right?options.right-width:0,viewportEl.is(window)||viewportEl.is(document)?(viewportEl=windowEl,viewportTop=0,viewportLeft=0):(viewportOffset=viewportEl.offset(),viewportTop=viewportOffset.top,viewportLeft=viewportOffset.left),viewportTop+=windowEl.scrollTop(),viewportLeft+=windowEl.scrollLeft(),options.viewportConstrain!==!1&&(top=Math.min(top,viewportTop+viewportEl.outerHeight()-height-this.margin),top=Math.max(top,viewportTop+this.margin),left=Math.min(left,viewportLeft+viewportEl.outerWidth()-width-this.margin),left=Math.max(left,viewportLeft+this.margin)),this.el.css({top:top-origin.top,left:left-origin.left})},trigger:function(name){this.options[name]&&this.options[name].apply(this,Array.prototype.slice.call(arguments,1))}}),GridCoordMap=Class.extend({grid:null,rowCoords:null,colCoords:null,containerEl:null,bounds:null,constructor:function(grid){this.grid=grid},build:function(){this.grid.build(),this.rowCoords=this.grid.computeRowCoords(),this.colCoords=this.grid.computeColCoords(),this.computeBounds()},clear:function(){this.grid.clear(),this.rowCoords=null,this.colCoords=null},getCell:function(x,y){var i,coords,cell,rowCoords=this.rowCoords,rowCnt=rowCoords.length,colCoords=this.colCoords,colCnt=colCoords.length,hitRow=null,hitCol=null;if(this.inBounds(x,y)){for(i=0;rowCnt>i;i++)if(coords=rowCoords[i],y>=coords.top&&y<coords.bottom){hitRow=i;break}for(i=0;colCnt>i;i++)if(coords=colCoords[i],x>=coords.left&&x<coords.right){hitCol=i;break}if(null!==hitRow&&null!==hitCol)return cell=this.grid.getCell(hitRow,hitCol),cell.grid=this.grid,$.extend(cell,rowCoords[hitRow],colCoords[hitCol]),cell}return null},computeBounds:function(){this.bounds=this.containerEl?getClientRect(this.containerEl):null},inBounds:function(x,y){var bounds=this.bounds;return bounds?x>=bounds.left&&x<bounds.right&&y>=bounds.top&&y<bounds.bottom:!0}}),ComboCoordMap=Class.extend({coordMaps:null,constructor:function(coordMaps){this.coordMaps=coordMaps},build:function(){var i,coordMaps=this.coordMaps;for(i=0;i<coordMaps.length;i++)coordMaps[i].build()},getCell:function(x,y){var i,coordMaps=this.coordMaps,cell=null;for(i=0;i<coordMaps.length&&!cell;i++)cell=coordMaps[i].getCell(x,y);return cell},clear:function(){var i,coordMaps=this.coordMaps;for(i=0;i<coordMaps.length;i++)coordMaps[i].clear()}}),DragListener=fc.DragListener=Class.extend({options:null,isListening:!1,isDragging:!1,originX:null,originY:null,mousemoveProxy:null,mouseupProxy:null,subjectEl:null,subjectHref:null,scrollEl:null,scrollBounds:null,scrollTopVel:null,scrollLeftVel:null,scrollIntervalId:null,scrollHandlerProxy:null,scrollSensitivity:30,scrollSpeed:200,scrollIntervalMs:50,constructor:function(options){options=options||{},this.options=options,this.subjectEl=options.subjectEl},mousedown:function(ev){isPrimaryMouseButton(ev)&&(ev.preventDefault(),this.startListening(ev),this.options.distance||this.startDrag(ev))},startListening:function(ev){var scrollParent;this.isListening||(ev&&this.options.scroll&&(scrollParent=getScrollParent($(ev.target)),scrollParent.is(window)||scrollParent.is(document)||(this.scrollEl=scrollParent,this.scrollHandlerProxy=debounce(proxy(this,"scrollHandler"),100),this.scrollEl.on("scroll",this.scrollHandlerProxy))),$(document).on("mousemove",this.mousemoveProxy=proxy(this,"mousemove")).on("mouseup",this.mouseupProxy=proxy(this,"mouseup")).on("selectstart",this.preventDefault),ev?(this.originX=ev.pageX,this.originY=ev.pageY):(this.originX=0,this.originY=0),this.isListening=!0,this.listenStart(ev))},listenStart:function(ev){this.trigger("listenStart",ev)},mousemove:function(ev){var minDistance,distanceSq,dx=ev.pageX-this.originX,dy=ev.pageY-this.originY;this.isDragging||(minDistance=this.options.distance||1,distanceSq=dx*dx+dy*dy,distanceSq>=minDistance*minDistance&&this.startDrag(ev)),this.isDragging&&this.drag(dx,dy,ev)},startDrag:function(ev){this.isListening||this.startListening(),this.isDragging||(this.isDragging=!0,this.dragStart(ev))},dragStart:function(ev){var subjectEl=this.subjectEl;this.trigger("dragStart",ev),(this.subjectHref=subjectEl?subjectEl.attr("href"):null)&&subjectEl.removeAttr("href")},drag:function(dx,dy,ev){this.trigger("drag",dx,dy,ev),this.updateScroll(ev)},mouseup:function(ev){this.stopListening(ev)},stopDrag:function(ev){this.isDragging&&(this.stopScrolling(),this.dragStop(ev),this.isDragging=!1)},dragStop:function(ev){var _this=this;this.trigger("dragStop",ev),setTimeout(function(){_this.subjectHref&&_this.subjectEl.attr("href",_this.subjectHref)},0)},stopListening:function(ev){this.stopDrag(ev),this.isListening&&(this.scrollEl&&(this.scrollEl.off("scroll",this.scrollHandlerProxy),this.scrollHandlerProxy=null),$(document).off("mousemove",this.mousemoveProxy).off("mouseup",this.mouseupProxy).off("selectstart",this.preventDefault),this.mousemoveProxy=null,this.mouseupProxy=null,this.isListening=!1,this.listenStop(ev))},listenStop:function(ev){this.trigger("listenStop",ev)},trigger:function(name){this.options[name]&&this.options[name].apply(this,Array.prototype.slice.call(arguments,1))},preventDefault:function(ev){ev.preventDefault()},computeScrollBounds:function(){var el=this.scrollEl;this.scrollBounds=el?getOuterRect(el):null},updateScroll:function(ev){var topCloseness,bottomCloseness,leftCloseness,rightCloseness,sensitivity=this.scrollSensitivity,bounds=this.scrollBounds,topVel=0,leftVel=0;bounds&&(topCloseness=(sensitivity-(ev.pageY-bounds.top))/sensitivity,bottomCloseness=(sensitivity-(bounds.bottom-ev.pageY))/sensitivity,leftCloseness=(sensitivity-(ev.pageX-bounds.left))/sensitivity,rightCloseness=(sensitivity-(bounds.right-ev.pageX))/sensitivity,topCloseness>=0&&1>=topCloseness?topVel=topCloseness*this.scrollSpeed*-1:bottomCloseness>=0&&1>=bottomCloseness&&(topVel=bottomCloseness*this.scrollSpeed),leftCloseness>=0&&1>=leftCloseness?leftVel=leftCloseness*this.scrollSpeed*-1:rightCloseness>=0&&1>=rightCloseness&&(leftVel=rightCloseness*this.scrollSpeed)),this.setScrollVel(topVel,leftVel)},setScrollVel:function(topVel,leftVel){this.scrollTopVel=topVel,this.scrollLeftVel=leftVel,this.constrainScrollVel(),!this.scrollTopVel&&!this.scrollLeftVel||this.scrollIntervalId||(this.scrollIntervalId=setInterval(proxy(this,"scrollIntervalFunc"),this.scrollIntervalMs))},constrainScrollVel:function(){var el=this.scrollEl;this.scrollTopVel<0?el.scrollTop()<=0&&(this.scrollTopVel=0):this.scrollTopVel>0&&el.scrollTop()+el[0].clientHeight>=el[0].scrollHeight&&(this.scrollTopVel=0),this.scrollLeftVel<0?el.scrollLeft()<=0&&(this.scrollLeftVel=0):this.scrollLeftVel>0&&el.scrollLeft()+el[0].clientWidth>=el[0].scrollWidth&&(this.scrollLeftVel=0)},scrollIntervalFunc:function(){var el=this.scrollEl,frac=this.scrollIntervalMs/1e3;this.scrollTopVel&&el.scrollTop(el.scrollTop()+this.scrollTopVel*frac),this.scrollLeftVel&&el.scrollLeft(el.scrollLeft()+this.scrollLeftVel*frac),this.constrainScrollVel(),this.scrollTopVel||this.scrollLeftVel||this.stopScrolling()},stopScrolling:function(){this.scrollIntervalId&&(clearInterval(this.scrollIntervalId),this.scrollIntervalId=null,this.scrollStop())},scrollHandler:function(){this.scrollIntervalId||this.scrollStop()},scrollStop:function(){}}),CellDragListener=DragListener.extend({coordMap:null,origCell:null,cell:null,coordAdjust:null,constructor:function(coordMap,options){DragListener.prototype.constructor.call(this,options),this.coordMap=coordMap},listenStart:function(ev){var subjectRect,origPoint,point,subjectEl=this.subjectEl;DragListener.prototype.listenStart.apply(this,arguments),this.computeCoords(),ev?(origPoint={left:ev.pageX,top:ev.pageY},point=origPoint,subjectEl&&(subjectRect=getOuterRect(subjectEl),point=constrainPoint(point,subjectRect)),this.origCell=this.getCell(point.left,point.top),subjectEl&&this.options.subjectCenter&&(this.origCell&&(subjectRect=intersectRects(this.origCell,subjectRect)||subjectRect),point=getRectCenter(subjectRect)),this.coordAdjust=diffPoints(point,origPoint)):(this.origCell=null,this.coordAdjust=null)},computeCoords:function(){this.coordMap.build(),this.computeScrollBounds()},dragStart:function(ev){var cell;DragListener.prototype.dragStart.apply(this,arguments),cell=this.getCell(ev.pageX,ev.pageY),cell&&this.cellOver(cell)},drag:function(dx,dy,ev){var cell;DragListener.prototype.drag.apply(this,arguments),cell=this.getCell(ev.pageX,ev.pageY),isCellsEqual(cell,this.cell)||(this.cell&&this.cellOut(),cell&&this.cellOver(cell))},dragStop:function(){this.cellDone(),DragListener.prototype.dragStop.apply(this,arguments)},cellOver:function(cell){this.cell=cell,this.trigger("cellOver",cell,isCellsEqual(cell,this.origCell),this.origCell)},cellOut:function(){this.cell&&(this.trigger("cellOut",this.cell),this.cellDone(),this.cell=null)},cellDone:function(){this.cell&&this.trigger("cellDone",this.cell)},listenStop:function(){DragListener.prototype.listenStop.apply(this,arguments),this.origCell=this.cell=null,this.coordMap.clear()},scrollStop:function(){DragListener.prototype.scrollStop.apply(this,arguments),this.computeCoords()},getCell:function(left,top){return this.coordAdjust&&(left+=this.coordAdjust.left,top+=this.coordAdjust.top),this.coordMap.getCell(left,top)}}),MouseFollower=Class.extend({options:null,sourceEl:null,el:null,parentEl:null,top0:null,left0:null,mouseY0:null,mouseX0:null,topDelta:null,leftDelta:null,mousemoveProxy:null,isFollowing:!1,isHidden:!1,isAnimating:!1,constructor:function(sourceEl,options){this.options=options=options||{},this.sourceEl=sourceEl,this.parentEl=options.parentEl?$(options.parentEl):sourceEl.parent()},start:function(ev){this.isFollowing||(this.isFollowing=!0,this.mouseY0=ev.pageY,this.mouseX0=ev.pageX,this.topDelta=0,this.leftDelta=0,this.isHidden||this.updatePosition(),$(document).on("mousemove",this.mousemoveProxy=proxy(this,"mousemove")))},stop:function(shouldRevert,callback){function complete(){this.isAnimating=!1,_this.removeElement(),this.top0=this.left0=null,callback&&callback()}var _this=this,revertDuration=this.options.revertDuration;this.isFollowing&&!this.isAnimating&&(this.isFollowing=!1,$(document).off("mousemove",this.mousemoveProxy),shouldRevert&&revertDuration&&!this.isHidden?(this.isAnimating=!0,this.el.animate({top:this.top0,left:this.left0},{duration:revertDuration,complete:complete})):complete())},getEl:function(){var el=this.el;return el||(this.sourceEl.width(),el=this.el=this.sourceEl.clone().css({position:"absolute",visibility:"",display:this.isHidden?"none":"",margin:0,right:"auto",bottom:"auto",width:this.sourceEl.width(),height:this.sourceEl.height(),opacity:this.options.opacity||"",zIndex:this.options.zIndex}).appendTo(this.parentEl)),el},removeElement:function(){this.el&&(this.el.remove(),this.el=null)},updatePosition:function(){var sourceOffset,origin;this.getEl(),null===this.top0&&(this.sourceEl.width(),sourceOffset=this.sourceEl.offset(),origin=this.el.offsetParent().offset(),this.top0=sourceOffset.top-origin.top,this.left0=sourceOffset.left-origin.left),this.el.css({top:this.top0+this.topDelta,left:this.left0+this.leftDelta})},mousemove:function(ev){this.topDelta=ev.pageY-this.mouseY0,this.leftDelta=ev.pageX-this.mouseX0,this.isHidden||this.updatePosition()},hide:function(){this.isHidden||(this.isHidden=!0,this.el&&this.el.hide())},show:function(){this.isHidden&&(this.isHidden=!1,this.updatePosition(),this.getEl().show())}}),RowRenderer=Class.extend({view:null,isRTL:null,cellHtml:"<td/>",constructor:function(view){this.view=view,this.isRTL=view.opt("isRTL")},rowHtml:function(rowType,row){var col,cell,renderCell=this.getHtmlRenderer("cell",rowType),rowCellHtml="";for(row=row||0,col=0;col<this.colCnt;col++)cell=this.getCell(row,col),rowCellHtml+=renderCell(cell);return rowCellHtml=this.bookendCells(rowCellHtml,rowType,row),"<tr>"+rowCellHtml+"</tr>"},bookendCells:function(cells,rowType,row){var intro=this.getHtmlRenderer("intro",rowType)(row||0),outro=this.getHtmlRenderer("outro",rowType)(row||0),prependHtml=this.isRTL?outro:intro,appendHtml=this.isRTL?intro:outro;return"string"==typeof cells?prependHtml+cells+appendHtml:cells.prepend(prependHtml).append(appendHtml)},getHtmlRenderer:function(rendererName,rowType){var generalName,specificName,provider,renderer,view=this.view;return generalName=rendererName+"Html",rowType&&(specificName=rowType+capitaliseFirstLetter(rendererName)+"Html"),specificName&&(renderer=view[specificName])?provider=view:specificName&&(renderer=this[specificName])?provider=this:(renderer=view[generalName])?provider=view:(renderer=this[generalName])&&(provider=this),"function"==typeof renderer?function(){return renderer.apply(provider,arguments)||""}:function(){return renderer||""}}}),Grid=fc.Grid=RowRenderer.extend({start:null,end:null,rowCnt:0,colCnt:0,el:null,coordMap:null,elsByFill:null,externalDragStartProxy:null,colHeadFormat:null,eventTimeFormat:null,displayEventTime:null,displayEventEnd:null,cellDuration:null,largeUnit:null,constructor:function(){RowRenderer.apply(this,arguments),this.coordMap=new GridCoordMap(this),this.elsByFill={},this.externalDragStartProxy=proxy(this,"externalDragStart")},computeColHeadFormat:function(){},computeEventTimeFormat:function(){return this.view.opt("smallTimeFormat")},computeDisplayEventTime:function(){return!0},computeDisplayEventEnd:function(){return!0},setRange:function(range){this.start=range.start.clone(),this.end=range.end.clone(),this.rangeUpdated(),this.processRangeOptions()},rangeUpdated:function(){},processRangeOptions:function(){var displayEventTime,displayEventEnd,view=this.view;this.colHeadFormat=view.opt("columnFormat")||this.computeColHeadFormat(),this.eventTimeFormat=view.opt("eventTimeFormat")||view.opt("timeFormat")||this.computeEventTimeFormat(),displayEventTime=view.opt("displayEventTime"),null==displayEventTime&&(displayEventTime=this.computeDisplayEventTime()),displayEventEnd=view.opt("displayEventEnd"),null==displayEventEnd&&(displayEventEnd=this.computeDisplayEventEnd()),this.displayEventTime=displayEventTime,this.displayEventEnd=displayEventEnd
},build:function(){},clear:function(){},rangeToSegs:function(){},diffDates:function(a,b){return this.largeUnit?diffByUnit(a,b,this.largeUnit):diffDayTime(a,b)},getCell:function(row,col){var cell;return null==col&&("number"==typeof row?(col=row%this.colCnt,row=Math.floor(row/this.colCnt)):(col=row.col,row=row.row)),cell={row:row,col:col},$.extend(cell,this.getRowData(row),this.getColData(col)),$.extend(cell,this.computeCellRange(cell)),cell},computeCellRange:function(cell){var date=this.computeCellDate(cell);return{start:date,end:date.clone().add(this.cellDuration)}},computeCellDate:function(){},getRowData:function(){return{}},getColData:function(){return{}},getRowEl:function(){},getColEl:function(){},getCellDayEl:function(cell){return this.getColEl(cell.col)||this.getRowEl(cell.row)},computeRowCoords:function(){var i,el,top,items=[];for(i=0;i<this.rowCnt;i++)el=this.getRowEl(i),top=el.offset().top,items.push({top:top,bottom:top+el.outerHeight()});return items},computeColCoords:function(){var i,el,left,items=[];for(i=0;i<this.colCnt;i++)el=this.getColEl(i),left=el.offset().left,items.push({left:left,right:left+el.outerWidth()});return items},setElement:function(el){var _this=this;this.el=el,el.on("mousedown",function(ev){$(ev.target).is(".fc-event-container *, .fc-more")||$(ev.target).closest(".fc-popover").length||_this.dayMousedown(ev)}),this.bindSegHandlers(),this.bindGlobalHandlers()},removeElement:function(){this.unbindGlobalHandlers(),this.el.remove()},renderSkeleton:function(){},renderDates:function(){},unrenderDates:function(){},bindGlobalHandlers:function(){$(document).on("dragstart sortstart",this.externalDragStartProxy)},unbindGlobalHandlers:function(){$(document).off("dragstart sortstart",this.externalDragStartProxy)},dayMousedown:function(ev){var dayClickCell,selectionRange,_this=this,view=this.view,isSelectable=view.opt("selectable"),dragListener=new CellDragListener(this.coordMap,{scroll:view.opt("dragScroll"),dragStart:function(){view.unselect()},cellOver:function(cell,isOrig,origCell){origCell&&(dayClickCell=isOrig?cell:null,isSelectable&&(selectionRange=_this.computeSelection(origCell,cell),selectionRange?_this.renderSelection(selectionRange):disableCursor()))},cellOut:function(){dayClickCell=null,selectionRange=null,_this.unrenderSelection(),enableCursor()},listenStop:function(ev){dayClickCell&&view.triggerDayClick(dayClickCell,_this.getCellDayEl(dayClickCell),ev),selectionRange&&view.reportSelection(selectionRange,ev),enableCursor()}});dragListener.mousedown(ev)},renderRangeHelper:function(range,sourceSeg){var fakeEvent=this.fabricateHelperEvent(range,sourceSeg);this.renderHelper(fakeEvent,sourceSeg)},fabricateHelperEvent:function(range,sourceSeg){var fakeEvent=sourceSeg?createObject(sourceSeg.event):{};return fakeEvent.start=range.start.clone(),fakeEvent.end=range.end?range.end.clone():null,fakeEvent.allDay=null,this.view.calendar.normalizeEventRange(fakeEvent),fakeEvent.className=(fakeEvent.className||[]).concat("fc-helper"),sourceSeg||(fakeEvent.editable=!1),fakeEvent},renderHelper:function(){},unrenderHelper:function(){},renderSelection:function(range){this.renderHighlight(this.selectionRangeToSegs(range))},unrenderSelection:function(){this.unrenderHighlight()},computeSelection:function(firstCell,lastCell){var range,dates=[firstCell.start,firstCell.end,lastCell.start,lastCell.end];return dates.sort(compareNumbers),range={start:dates[0].clone(),end:dates[3].clone()},this.view.calendar.isSelectionRangeAllowed(range)?range:null},selectionRangeToSegs:function(range){return this.rangeToSegs(range)},renderHighlight:function(segs){this.renderFill("highlight",segs)},unrenderHighlight:function(){this.unrenderFill("highlight")},highlightSegClasses:function(){return["fc-highlight"]},renderFill:function(){},unrenderFill:function(type){var el=this.elsByFill[type];el&&(el.remove(),delete this.elsByFill[type])},renderFillSegEls:function(type,segs){var i,_this=this,segElMethod=this[type+"SegEl"],html="",renderedSegs=[];if(segs.length){for(i=0;i<segs.length;i++)html+=this.fillSegHtml(type,segs[i]);$(html).each(function(i,node){var seg=segs[i],el=$(node);segElMethod&&(el=segElMethod.call(_this,seg,el)),el&&(el=$(el),el.is(_this.fillSegTag)&&(seg.el=el,renderedSegs.push(seg)))})}return renderedSegs},fillSegTag:"div",fillSegHtml:function(type,seg){var classesMethod=this[type+"SegClasses"],cssMethod=this[type+"SegCss"],classes=classesMethod?classesMethod.call(this,seg):[],css=cssToStr(cssMethod?cssMethod.call(this,seg):{});return"<"+this.fillSegTag+(classes.length?' class="'+classes.join(" ")+'"':"")+(css?' style="'+css+'"':"")+" />"},headHtml:function(){return'<div class="fc-row '+this.view.widgetHeaderClass+'"><table><thead>'+this.rowHtml("head")+"</thead></table></div>"},headCellHtml:function(cell){var view=this.view,date=cell.start;return'<th class="fc-day-header '+view.widgetHeaderClass+" fc-"+dayIDs[date.day()]+'">'+htmlEscape(date.format(this.colHeadFormat))+"</th>"},bgCellHtml:function(cell){var view=this.view,date=cell.start,classes=this.getDayClasses(date);return classes.unshift("fc-day",view.widgetContentClass),'<td class="'+classes.join(" ")+'" data-date="'+date.format("YYYY-MM-DD")+'"></td>'},getDayClasses:function(date){var view=this.view,today=view.calendar.getNow().stripTime(),classes=["fc-"+dayIDs[date.day()]];return 1==view.intervalDuration.as("months")&&date.month()!=view.intervalStart.month()&&classes.push("fc-other-month"),date.isSame(today,"day")?classes.push("fc-today",view.highlightStateClass):classes.push(today>date?"fc-past":"fc-future"),classes}});Grid.mixin({mousedOverSeg:null,isDraggingSeg:!1,isResizingSeg:!1,isDraggingExternal:!1,segs:null,renderEvents:function(events){var i,seg,segs=this.eventsToSegs(events),bgSegs=[],fgSegs=[];for(i=0;i<segs.length;i++)seg=segs[i],isBgEvent(seg.event)?bgSegs.push(seg):fgSegs.push(seg);bgSegs=this.renderBgSegs(bgSegs)||bgSegs,fgSegs=this.renderFgSegs(fgSegs)||fgSegs,this.segs=bgSegs.concat(fgSegs)},unrenderEvents:function(){this.triggerSegMouseout(),this.unrenderFgSegs(),this.unrenderBgSegs(),this.segs=null},getEventSegs:function(){return this.segs||[]},renderFgSegs:function(){},unrenderFgSegs:function(){},renderFgSegEls:function(segs,disableResizing){var i,view=this.view,html="",renderedSegs=[];if(segs.length){for(i=0;i<segs.length;i++)html+=this.fgSegHtml(segs[i],disableResizing);$(html).each(function(i,node){var seg=segs[i],el=view.resolveEventEl(seg.event,$(node));el&&(el.data("fc-seg",seg),seg.el=el,renderedSegs.push(seg))})}return renderedSegs},fgSegHtml:function(){},renderBgSegs:function(segs){return this.renderFill("bgEvent",segs)},unrenderBgSegs:function(){this.unrenderFill("bgEvent")},bgEventSegEl:function(seg,el){return this.view.resolveEventEl(seg.event,el)},bgEventSegClasses:function(seg){var event=seg.event,source=event.source||{};return["fc-bgevent"].concat(event.className,source.className||[])},bgEventSegCss:function(seg){var view=this.view,event=seg.event,source=event.source||{};return{"background-color":event.backgroundColor||event.color||source.backgroundColor||source.color||view.opt("eventBackgroundColor")||view.opt("eventColor")}},businessHoursSegClasses:function(){return["fc-nonbusiness","fc-bgevent"]},bindSegHandlers:function(){var _this=this,view=this.view;$.each({mouseenter:function(seg,ev){_this.triggerSegMouseover(seg,ev)},mouseleave:function(seg,ev){_this.triggerSegMouseout(seg,ev)},click:function(seg,ev){return view.trigger("eventClick",this,seg.event,ev)},mousedown:function(seg,ev){$(ev.target).is(".fc-resizer")&&view.isEventResizable(seg.event)?_this.segResizeMousedown(seg,ev,$(ev.target).is(".fc-start-resizer")):view.isEventDraggable(seg.event)&&_this.segDragMousedown(seg,ev)}},function(name,func){_this.el.on(name,".fc-event-container > *",function(ev){var seg=$(this).data("fc-seg");return!seg||_this.isDraggingSeg||_this.isResizingSeg?void 0:func.call(this,seg,ev)})})},triggerSegMouseover:function(seg,ev){this.mousedOverSeg||(this.mousedOverSeg=seg,this.view.trigger("eventMouseover",seg.el[0],seg.event,ev))},triggerSegMouseout:function(seg,ev){ev=ev||{},this.mousedOverSeg&&(seg=seg||this.mousedOverSeg,this.mousedOverSeg=null,this.view.trigger("eventMouseout",seg.el[0],seg.event,ev))},segDragMousedown:function(seg,ev){var dropLocation,_this=this,view=this.view,calendar=view.calendar,el=seg.el,event=seg.event,mouseFollower=new MouseFollower(seg.el,{parentEl:view.el,opacity:view.opt("dragOpacity"),revertDuration:view.opt("dragRevertDuration"),zIndex:2}),dragListener=new CellDragListener(view.coordMap,{distance:5,scroll:view.opt("dragScroll"),subjectEl:el,subjectCenter:!0,listenStart:function(ev){mouseFollower.hide(),mouseFollower.start(ev)},dragStart:function(ev){_this.triggerSegMouseout(seg,ev),_this.segDragStart(seg,ev),view.hideEvent(event)},cellOver:function(cell,isOrig,origCell){seg.cell&&(origCell=seg.cell),dropLocation=_this.computeEventDrop(origCell,cell,event),dropLocation&&!calendar.isEventRangeAllowed(dropLocation,event)&&(disableCursor(),dropLocation=null),dropLocation&&view.renderDrag(dropLocation,seg)?mouseFollower.hide():mouseFollower.show(),isOrig&&(dropLocation=null)},cellOut:function(){view.unrenderDrag(),mouseFollower.show(),dropLocation=null},cellDone:function(){enableCursor()},dragStop:function(ev){mouseFollower.stop(!dropLocation,function(){view.unrenderDrag(),view.showEvent(event),_this.segDragStop(seg,ev),dropLocation&&view.reportEventDrop(event,dropLocation,this.largeUnit,el,ev)})},listenStop:function(){mouseFollower.stop()}});dragListener.mousedown(ev)},segDragStart:function(seg,ev){this.isDraggingSeg=!0,this.view.trigger("eventDragStart",seg.el[0],seg.event,ev,{})},segDragStop:function(seg,ev){this.isDraggingSeg=!1,this.view.trigger("eventDragStop",seg.el[0],seg.event,ev,{})},computeEventDrop:function(startCell,endCell,event){var delta,dropLocation,calendar=this.view.calendar,dragStart=startCell.start,dragEnd=endCell.start;return dragStart.hasTime()===dragEnd.hasTime()?(delta=this.diffDates(dragEnd,dragStart),event.allDay&&durationHasTime(delta)?(dropLocation={start:event.start.clone(),end:calendar.getEventEnd(event),allDay:!1},calendar.normalizeEventRangeTimes(dropLocation)):dropLocation={start:event.start.clone(),end:event.end?event.end.clone():null,allDay:event.allDay},dropLocation.start.add(delta),dropLocation.end&&dropLocation.end.add(delta)):dropLocation={start:dragEnd.clone(),end:null,allDay:!dragEnd.hasTime()},dropLocation},applyDragOpacity:function(els){var opacity=this.view.opt("dragOpacity");null!=opacity&&els.each(function(i,node){node.style.opacity=opacity})},externalDragStart:function(ev,ui){var el,accept,view=this.view;view.opt("droppable")&&(el=$((ui?ui.item:null)||ev.target),accept=view.opt("dropAccept"),($.isFunction(accept)?accept.call(el[0],el):el.is(accept))&&(this.isDraggingExternal||this.listenToExternalDrag(el,ev,ui)))},listenToExternalDrag:function(el,ev,ui){var dragListener,dropLocation,_this=this,meta=getDraggedElMeta(el);dragListener=new CellDragListener(this.coordMap,{listenStart:function(){_this.isDraggingExternal=!0},cellOver:function(cell){dropLocation=_this.computeExternalDrop(cell,meta),dropLocation?_this.renderDrag(dropLocation):disableCursor()},cellOut:function(){dropLocation=null,_this.unrenderDrag(),enableCursor()},dragStop:function(){_this.unrenderDrag(),enableCursor(),dropLocation&&_this.view.reportExternalDrop(meta,dropLocation,el,ev,ui)},listenStop:function(){_this.isDraggingExternal=!1}}),dragListener.startDrag(ev)},computeExternalDrop:function(cell,meta){var dropLocation={start:cell.start.clone(),end:null};return meta.startTime&&!dropLocation.start.hasTime()&&dropLocation.start.time(meta.startTime),meta.duration&&(dropLocation.end=dropLocation.start.clone().add(meta.duration)),this.view.calendar.isExternalDropRangeAllowed(dropLocation,meta.eventProps)?dropLocation:null},renderDrag:function(){},unrenderDrag:function(){},segResizeMousedown:function(seg,ev,isStart){var dragListener,resizeLocation,_this=this,view=this.view,calendar=view.calendar,el=seg.el,event=seg.event,eventEnd=calendar.getEventEnd(event);dragListener=new CellDragListener(this.coordMap,{distance:5,scroll:view.opt("dragScroll"),subjectEl:el,dragStart:function(ev){_this.triggerSegMouseout(seg,ev),_this.segResizeStart(seg,ev)},cellOver:function(cell,isOrig,origCell){resizeLocation=isStart?_this.computeEventStartResize(origCell,cell,event):_this.computeEventEndResize(origCell,cell,event),resizeLocation&&(calendar.isEventRangeAllowed(resizeLocation,event)?resizeLocation.start.isSame(event.start)&&resizeLocation.end.isSame(eventEnd)&&(resizeLocation=null):(disableCursor(),resizeLocation=null)),resizeLocation&&(view.hideEvent(event),_this.renderEventResize(resizeLocation,seg))},cellOut:function(){resizeLocation=null},cellDone:function(){_this.unrenderEventResize(),view.showEvent(event),enableCursor()},dragStop:function(ev){_this.segResizeStop(seg,ev),resizeLocation&&view.reportEventResize(event,resizeLocation,this.largeUnit,el,ev)}}),dragListener.mousedown(ev)},segResizeStart:function(seg,ev){this.isResizingSeg=!0,this.view.trigger("eventResizeStart",seg.el[0],seg.event,ev,{})},segResizeStop:function(seg,ev){this.isResizingSeg=!1,this.view.trigger("eventResizeStop",seg.el[0],seg.event,ev,{})},computeEventStartResize:function(startCell,endCell,event){return this.computeEventResize("start",startCell,endCell,event)},computeEventEndResize:function(startCell,endCell,event){return this.computeEventResize("end",startCell,endCell,event)},computeEventResize:function(type,startCell,endCell,event){var range,defaultDuration,calendar=this.view.calendar,delta=this.diffDates(endCell[type],startCell[type]);return range={start:event.start.clone(),end:calendar.getEventEnd(event),allDay:event.allDay},range.allDay&&durationHasTime(delta)&&(range.allDay=!1,calendar.normalizeEventRangeTimes(range)),range[type].add(delta),range.start.isBefore(range.end)||(defaultDuration=event.allDay?calendar.defaultAllDayEventDuration:calendar.defaultTimedEventDuration,this.cellDuration&&this.cellDuration<defaultDuration&&(defaultDuration=this.cellDuration),"start"==type?range.start=range.end.clone().subtract(defaultDuration):range.end=range.start.clone().add(defaultDuration)),range},renderEventResize:function(){},unrenderEventResize:function(){},getEventTimeText:function(range,formatStr,displayEnd){return null==formatStr&&(formatStr=this.eventTimeFormat),null==displayEnd&&(displayEnd=this.displayEventEnd),this.displayEventTime&&range.start.hasTime()?displayEnd&&range.end?this.view.formatRange(range,formatStr):range.start.format(formatStr):""},getSegClasses:function(seg,isDraggable,isResizable){var event=seg.event,classes=["fc-event",seg.isStart?"fc-start":"fc-not-start",seg.isEnd?"fc-end":"fc-not-end"].concat(event.className,event.source?event.source.className:[]);return isDraggable&&classes.push("fc-draggable"),isResizable&&classes.push("fc-resizable"),classes},getEventSkinCss:function(event){var view=this.view,source=event.source||{},eventColor=event.color,sourceColor=source.color,optionColor=view.opt("eventColor");return{"background-color":event.backgroundColor||eventColor||source.backgroundColor||sourceColor||view.opt("eventBackgroundColor")||optionColor,"border-color":event.borderColor||eventColor||source.borderColor||sourceColor||view.opt("eventBorderColor")||optionColor,color:event.textColor||source.textColor||view.opt("eventTextColor")}},eventsToSegs:function(events,rangeToSegsFunc){var i,eventRanges=this.eventsToRanges(events),segs=[];for(i=0;i<eventRanges.length;i++)segs.push.apply(segs,this.eventRangeToSegs(eventRanges[i],rangeToSegsFunc));return segs},eventsToRanges:function(events){var _this=this,eventsById=groupEventsById(events),ranges=[];return $.each(eventsById,function(id,eventGroup){eventGroup.length&&ranges.push.apply(ranges,isInverseBgEvent(eventGroup[0])?_this.eventsToInverseRanges(eventGroup):_this.eventsToNormalRanges(eventGroup))}),ranges},eventsToNormalRanges:function(events){var i,event,eventStart,eventEnd,calendar=this.view.calendar,ranges=[];for(i=0;i<events.length;i++)event=events[i],eventStart=event.start.clone().stripZone(),eventEnd=calendar.getEventEnd(event).stripZone(),ranges.push({event:event,start:eventStart,end:eventEnd,eventStartMS:+eventStart,eventDurationMS:eventEnd-eventStart});return ranges},eventsToInverseRanges:function(events){var i,normalRange,view=this.view,viewStart=view.start.clone().stripZone(),viewEnd=view.end.clone().stripZone(),normalRanges=this.eventsToNormalRanges(events),inverseRanges=[],event0=events[0],start=viewStart;for(normalRanges.sort(compareNormalRanges),i=0;i<normalRanges.length;i++)normalRange=normalRanges[i],normalRange.start>start&&inverseRanges.push({event:event0,start:start,end:normalRange.start}),start=normalRange.end;return viewEnd>start&&inverseRanges.push({event:event0,start:start,end:viewEnd}),inverseRanges},eventRangeToSegs:function(eventRange,rangeToSegsFunc){var segs,i,seg;for(eventRange=this.view.calendar.ensureVisibleEventRange(eventRange),segs=rangeToSegsFunc?rangeToSegsFunc(eventRange):this.rangeToSegs(eventRange),i=0;i<segs.length;i++)seg=segs[i],seg.event=eventRange.event,seg.eventStartMS=eventRange.eventStartMS,seg.eventDurationMS=eventRange.eventDurationMS;return segs},sortSegs:function(segs){segs.sort(proxy(this,"compareSegs"))},compareSegs:function(seg1,seg2){return seg1.eventStartMS-seg2.eventStartMS||seg2.eventDurationMS-seg1.eventDurationMS||seg2.event.allDay-seg1.event.allDay||compareByFieldSpecs(seg1.event,seg2.event,this.view.eventOrderSpecs)}}),fc.dataAttrPrefix="";var DayGrid=Grid.extend({numbersVisible:!1,bottomCoordPadding:0,breakOnWeeks:null,cellDates:null,dayToCellOffsets:null,rowEls:null,dayEls:null,helperEls:null,constructor:function(){Grid.apply(this,arguments),this.cellDuration=moment.duration(1,"day")},renderDates:function(isRigid){var row,i,cell,view=this.view,rowCnt=this.rowCnt,colCnt=this.colCnt,cellCnt=rowCnt*colCnt,html="";for(row=0;rowCnt>row;row++)html+=this.dayRowHtml(row,isRigid);for(this.el.html(html),this.rowEls=this.el.find(".fc-row"),this.dayEls=this.el.find(".fc-day"),i=0;cellCnt>i;i++)cell=this.getCell(i),view.trigger("dayRender",null,cell.start,this.dayEls.eq(i))},unrenderDates:function(){this.removeSegPopover()},renderBusinessHours:function(){var events=this.view.calendar.getBusinessHoursEvents(!0),segs=this.eventsToSegs(events);this.renderFill("businessHours",segs,"bgevent")},dayRowHtml:function(row,isRigid){var view=this.view,classes=["fc-row","fc-week",view.widgetContentClass];return isRigid&&classes.push("fc-rigid"),'<div class="'+classes.join(" ")+'"><div class="fc-bg"><table>'+this.rowHtml("day",row)+'</table></div><div class="fc-content-skeleton"><table>'+(this.numbersVisible?"<thead>"+this.rowHtml("number",row)+"</thead>":"")+"</table></div></div>"},dayCellHtml:function(cell){return this.bgCellHtml(cell)},computeColHeadFormat:function(){return this.rowCnt>1?"ddd":this.colCnt>1?this.view.opt("dayOfMonthFormat"):"dddd"},computeEventTimeFormat:function(){return this.view.opt("extraSmallTimeFormat")},computeDisplayEventEnd:function(){return 1==this.colCnt},rangeUpdated:function(){var cellDates,firstDay,rowCnt,colCnt;if(this.updateCellDates(),cellDates=this.cellDates,this.breakOnWeeks){for(firstDay=cellDates[0].day(),colCnt=1;colCnt<cellDates.length&&cellDates[colCnt].day()!=firstDay;colCnt++);rowCnt=Math.ceil(cellDates.length/colCnt)}else rowCnt=1,colCnt=cellDates.length;this.rowCnt=rowCnt,this.colCnt=colCnt},updateCellDates:function(){for(var view=this.view,date=this.start.clone(),dates=[],offset=-1,offsets=[];date.isBefore(this.end);)view.isHiddenDay(date)?offsets.push(offset+.5):(offset++,offsets.push(offset),dates.push(date.clone())),date.add(1,"days");this.cellDates=dates,this.dayToCellOffsets=offsets},computeCellDate:function(cell){var colCnt=this.colCnt,index=cell.row*colCnt+(this.isRTL?colCnt-cell.col-1:cell.col);return this.cellDates[index].clone()},getRowEl:function(row){return this.rowEls.eq(row)},getColEl:function(col){return this.dayEls.eq(col)},getCellDayEl:function(cell){return this.dayEls.eq(cell.row*this.colCnt+cell.col)},computeRowCoords:function(){var rowCoords=Grid.prototype.computeRowCoords.call(this);return rowCoords[rowCoords.length-1].bottom+=this.bottomCoordPadding,rowCoords},rangeToSegs:function(range){var first,last,row,rowFirst,rowLast,isStart,isEnd,segFirst,segLast,seg,isRTL=this.isRTL,rowCnt=this.rowCnt,colCnt=this.colCnt,segs=[];for(range=this.view.computeDayRange(range),first=this.dateToCellOffset(range.start),last=this.dateToCellOffset(range.end.subtract(1,"days")),row=0;rowCnt>row;row++)rowFirst=row*colCnt,rowLast=rowFirst+colCnt-1,segFirst=Math.max(rowFirst,first),segLast=Math.min(rowLast,last),segFirst=Math.ceil(segFirst),segLast=Math.floor(segLast),segLast>=segFirst&&(isStart=segFirst===first,isEnd=segLast===last,segFirst-=rowFirst,segLast-=rowFirst,seg={row:row,isStart:isStart,isEnd:isEnd},isRTL?(seg.leftCol=colCnt-segLast-1,seg.rightCol=colCnt-segFirst-1):(seg.leftCol=segFirst,seg.rightCol=segLast),segs.push(seg));return segs},dateToCellOffset:function(date){var offsets=this.dayToCellOffsets,day=date.diff(this.start,"days");return 0>day?offsets[0]-1:day>=offsets.length?offsets[offsets.length-1]+1:offsets[day]},renderDrag:function(dropLocation,seg){return this.renderHighlight(this.eventRangeToSegs(dropLocation)),seg&&!seg.el.closest(this.el).length?(this.renderRangeHelper(dropLocation,seg),this.applyDragOpacity(this.helperEls),!0):void 0},unrenderDrag:function(){this.unrenderHighlight(),this.unrenderHelper()},renderEventResize:function(range,seg){this.renderHighlight(this.eventRangeToSegs(range)),this.renderRangeHelper(range,seg)},unrenderEventResize:function(){this.unrenderHighlight(),this.unrenderHelper()},renderHelper:function(event,sourceSeg){var rowStructs,helperNodes=[],segs=this.eventsToSegs([event]);segs=this.renderFgSegEls(segs),rowStructs=this.renderSegRows(segs),this.rowEls.each(function(row,rowNode){var skeletonTop,rowEl=$(rowNode),skeletonEl=$('<div class="fc-helper-skeleton"><table/></div>');skeletonTop=sourceSeg&&sourceSeg.row===row?sourceSeg.el.position().top:rowEl.find(".fc-content-skeleton tbody").position().top,skeletonEl.css("top",skeletonTop).find("table").append(rowStructs[row].tbodyEl),rowEl.append(skeletonEl),helperNodes.push(skeletonEl[0])}),this.helperEls=$(helperNodes)},unrenderHelper:function(){this.helperEls&&(this.helperEls.remove(),this.helperEls=null)},fillSegTag:"td",renderFill:function(type,segs,className){var i,seg,skeletonEl,nodes=[];for(segs=this.renderFillSegEls(type,segs),i=0;i<segs.length;i++)seg=segs[i],skeletonEl=this.renderFillRow(type,seg,className),this.rowEls.eq(seg.row).append(skeletonEl),nodes.push(skeletonEl[0]);return this.elsByFill[type]=$(nodes),segs},renderFillRow:function(type,seg,className){var skeletonEl,trEl,colCnt=this.colCnt,startCol=seg.leftCol,endCol=seg.rightCol+1;return className=className||type.toLowerCase(),skeletonEl=$('<div class="fc-'+className+'-skeleton"><table><tr/></table></div>'),trEl=skeletonEl.find("tr"),startCol>0&&trEl.append('<td colspan="'+startCol+'"/>'),trEl.append(seg.el.attr("colspan",endCol-startCol)),colCnt>endCol&&trEl.append('<td colspan="'+(colCnt-endCol)+'"/>'),this.bookendCells(trEl,type),skeletonEl}});DayGrid.mixin({rowStructs:null,unrenderEvents:function(){this.removeSegPopover(),Grid.prototype.unrenderEvents.apply(this,arguments)},getEventSegs:function(){return Grid.prototype.getEventSegs.call(this).concat(this.popoverSegs||[])},renderBgSegs:function(segs){var allDaySegs=$.grep(segs,function(seg){return seg.event.allDay});return Grid.prototype.renderBgSegs.call(this,allDaySegs)},renderFgSegs:function(segs){var rowStructs;return segs=this.renderFgSegEls(segs),rowStructs=this.rowStructs=this.renderSegRows(segs),this.rowEls.each(function(i,rowNode){$(rowNode).find(".fc-content-skeleton > table").append(rowStructs[i].tbodyEl)}),segs},unrenderFgSegs:function(){for(var rowStruct,rowStructs=this.rowStructs||[];rowStruct=rowStructs.pop();)rowStruct.tbodyEl.remove();this.rowStructs=null},renderSegRows:function(segs){var segRows,row,rowStructs=[];for(segRows=this.groupSegRows(segs),row=0;row<segRows.length;row++)rowStructs.push(this.renderSegRow(row,segRows[row]));return rowStructs},fgSegHtml:function(seg,disableResizing){var timeText,titleHtml,view=this.view,event=seg.event,isDraggable=view.isEventDraggable(event),isResizableFromStart=!disableResizing&&event.allDay&&seg.isStart&&view.isEventResizableFromStart(event),isResizableFromEnd=!disableResizing&&event.allDay&&seg.isEnd&&view.isEventResizableFromEnd(event),classes=this.getSegClasses(seg,isDraggable,isResizableFromStart||isResizableFromEnd),skinCss=cssToStr(this.getEventSkinCss(event)),timeHtml="";return classes.unshift("fc-day-grid-event","fc-h-event"),seg.isStart&&(timeText=this.getEventTimeText(event),timeText&&(timeHtml='<span class="fc-time">'+htmlEscape(timeText)+"</span>")),titleHtml='<span class="fc-title">'+(htmlEscape(event.title||"")||"&nbsp;")+"</span>",'<a class="'+classes.join(" ")+'"'+(event.url?' href="'+htmlEscape(event.url)+'"':"")+(skinCss?' style="'+skinCss+'"':"")+'><div class="fc-content">'+(this.isRTL?titleHtml+" "+timeHtml:timeHtml+" "+titleHtml)+"</div>"+(isResizableFromStart?'<div class="fc-resizer fc-start-resizer" />':"")+(isResizableFromEnd?'<div class="fc-resizer fc-end-resizer" />':"")+"</a>"},renderSegRow:function(row,rowSegs){function emptyCellsUntil(endCol){for(;endCol>col;)td=(loneCellMatrix[i-1]||[])[col],td?td.attr("rowspan",parseInt(td.attr("rowspan")||1,10)+1):(td=$("<td/>"),tr.append(td)),cellMatrix[i][col]=td,loneCellMatrix[i][col]=td,col++}var i,levelSegs,col,tr,j,seg,td,colCnt=this.colCnt,segLevels=this.buildSegLevels(rowSegs),levelCnt=Math.max(1,segLevels.length),tbody=$("<tbody/>"),segMatrix=[],cellMatrix=[],loneCellMatrix=[];for(i=0;levelCnt>i;i++){if(levelSegs=segLevels[i],col=0,tr=$("<tr/>"),segMatrix.push([]),cellMatrix.push([]),loneCellMatrix.push([]),levelSegs)for(j=0;j<levelSegs.length;j++){for(seg=levelSegs[j],emptyCellsUntil(seg.leftCol),td=$('<td class="fc-event-container"/>').append(seg.el),seg.leftCol!=seg.rightCol?td.attr("colspan",seg.rightCol-seg.leftCol+1):loneCellMatrix[i][col]=td;col<=seg.rightCol;)cellMatrix[i][col]=td,segMatrix[i][col]=seg,col++;tr.append(td)}emptyCellsUntil(colCnt),this.bookendCells(tr,"eventSkeleton"),tbody.append(tr)}return{row:row,tbodyEl:tbody,cellMatrix:cellMatrix,segMatrix:segMatrix,segLevels:segLevels,segs:rowSegs}},buildSegLevels:function(segs){var i,seg,j,levels=[];for(this.sortSegs(segs),i=0;i<segs.length;i++){for(seg=segs[i],j=0;j<levels.length&&isDaySegCollision(seg,levels[j]);j++);seg.level=j,(levels[j]||(levels[j]=[])).push(seg)}for(j=0;j<levels.length;j++)levels[j].sort(compareDaySegCols);return levels},groupSegRows:function(segs){var i,segRows=[];for(i=0;i<this.rowCnt;i++)segRows.push([]);for(i=0;i<segs.length;i++)segRows[segs[i].row].push(segs[i]);return segRows}}),DayGrid.mixin({segPopover:null,popoverSegs:null,removeSegPopover:function(){this.segPopover&&this.segPopover.hide()},limitRows:function(levelLimit){var row,rowLevelLimit,rowStructs=this.rowStructs||[];for(row=0;row<rowStructs.length;row++)this.unlimitRow(row),rowLevelLimit=levelLimit?"number"==typeof levelLimit?levelLimit:this.computeRowLevelLimit(row):!1,rowLevelLimit!==!1&&this.limitRow(row,rowLevelLimit)},computeRowLevelLimit:function(row){function iterInnerHeights(i,childNode){trHeight=Math.max(trHeight,$(childNode).outerHeight())}var i,trEl,trHeight,rowEl=this.rowEls.eq(row),rowHeight=rowEl.height(),trEls=this.rowStructs[row].tbodyEl.children();for(i=0;i<trEls.length;i++)if(trEl=trEls.eq(i).removeClass("fc-limited"),trHeight=0,trEl.find("> td > :first-child").each(iterInnerHeights),trEl.position().top+trHeight>rowHeight)return i;return!1},limitRow:function(row,levelLimit){function emptyCellsUntil(endCol){for(;endCol>col;)cell=_this.getCell(row,col),segsBelow=_this.getCellSegs(cell,levelLimit),segsBelow.length&&(td=cellMatrix[levelLimit-1][col],moreLink=_this.renderMoreLink(cell,segsBelow),moreWrap=$("<div/>").append(moreLink),td.append(moreWrap),moreNodes.push(moreWrap[0])),col++}var cell,levelSegs,cellMatrix,limitedNodes,i,seg,segsBelow,totalSegsBelow,colSegsBelow,td,rowspan,segMoreNodes,j,moreTd,moreWrap,moreLink,_this=this,rowStruct=this.rowStructs[row],moreNodes=[],col=0;if(levelLimit&&levelLimit<rowStruct.segLevels.length){for(levelSegs=rowStruct.segLevels[levelLimit-1],cellMatrix=rowStruct.cellMatrix,limitedNodes=rowStruct.tbodyEl.children().slice(levelLimit).addClass("fc-limited").get(),i=0;i<levelSegs.length;i++){for(seg=levelSegs[i],emptyCellsUntil(seg.leftCol),colSegsBelow=[],totalSegsBelow=0;col<=seg.rightCol;)cell=this.getCell(row,col),segsBelow=this.getCellSegs(cell,levelLimit),colSegsBelow.push(segsBelow),totalSegsBelow+=segsBelow.length,col++;if(totalSegsBelow){for(td=cellMatrix[levelLimit-1][seg.leftCol],rowspan=td.attr("rowspan")||1,segMoreNodes=[],j=0;j<colSegsBelow.length;j++)moreTd=$('<td class="fc-more-cell"/>').attr("rowspan",rowspan),segsBelow=colSegsBelow[j],cell=this.getCell(row,seg.leftCol+j),moreLink=this.renderMoreLink(cell,[seg].concat(segsBelow)),moreWrap=$("<div/>").append(moreLink),moreTd.append(moreWrap),segMoreNodes.push(moreTd[0]),moreNodes.push(moreTd[0]);td.addClass("fc-limited").after($(segMoreNodes)),limitedNodes.push(td[0])}}emptyCellsUntil(this.colCnt),rowStruct.moreEls=$(moreNodes),rowStruct.limitedEls=$(limitedNodes)}},unlimitRow:function(row){var rowStruct=this.rowStructs[row];rowStruct.moreEls&&(rowStruct.moreEls.remove(),rowStruct.moreEls=null),rowStruct.limitedEls&&(rowStruct.limitedEls.removeClass("fc-limited"),rowStruct.limitedEls=null)},renderMoreLink:function(cell,hiddenSegs){var _this=this,view=this.view;return $('<a class="fc-more"/>').text(this.getMoreLinkText(hiddenSegs.length)).on("click",function(ev){var clickOption=view.opt("eventLimitClick"),date=cell.start,moreEl=$(this),dayEl=_this.getCellDayEl(cell),allSegs=_this.getCellSegs(cell),reslicedAllSegs=_this.resliceDaySegs(allSegs,date),reslicedHiddenSegs=_this.resliceDaySegs(hiddenSegs,date);"function"==typeof clickOption&&(clickOption=view.trigger("eventLimitClick",null,{date:date,dayEl:dayEl,moreEl:moreEl,segs:reslicedAllSegs,hiddenSegs:reslicedHiddenSegs},ev)),"popover"===clickOption?_this.showSegPopover(cell,moreEl,reslicedAllSegs):"string"==typeof clickOption&&view.calendar.zoomTo(date,clickOption)})},showSegPopover:function(cell,moreLink,segs){var topEl,options,_this=this,view=this.view,moreWrap=moreLink.parent();topEl=1==this.rowCnt?view.el:this.rowEls.eq(cell.row),options={className:"fc-more-popover",content:this.renderSegPopoverContent(cell,segs),parentEl:this.el,top:topEl.offset().top,autoHide:!0,viewportConstrain:view.opt("popoverViewportConstrain"),hide:function(){_this.segPopover.removeElement(),_this.segPopover=null,_this.popoverSegs=null}},this.isRTL?options.right=moreWrap.offset().left+moreWrap.outerWidth()+1:options.left=moreWrap.offset().left-1,this.segPopover=new Popover(options),this.segPopover.show()},renderSegPopoverContent:function(cell,segs){var i,view=this.view,isTheme=view.opt("theme"),title=cell.start.format(view.opt("dayPopoverFormat")),content=$('<div class="fc-header '+view.widgetHeaderClass+'"><span class="fc-close '+(isTheme?"ui-icon ui-icon-closethick":"fc-icon fc-icon-x")+'"></span><span class="fc-title">'+htmlEscape(title)+'</span><div class="fc-clear"/></div><div class="fc-body '+view.widgetContentClass+'"><div class="fc-event-container"></div></div>'),segContainer=content.find(".fc-event-container");for(segs=this.renderFgSegEls(segs,!0),this.popoverSegs=segs,i=0;i<segs.length;i++)segs[i].cell=cell,segContainer.append(segs[i].el);return content},resliceDaySegs:function(segs,dayDate){var events=$.map(segs,function(seg){return seg.event}),dayStart=dayDate.clone().stripTime(),dayEnd=dayStart.clone().add(1,"days"),dayRange={start:dayStart,end:dayEnd};return segs=this.eventsToSegs(events,function(range){var seg=intersectionToSeg(range,dayRange);
return seg?[seg]:[]}),this.sortSegs(segs),segs},getMoreLinkText:function(num){var opt=this.view.opt("eventLimitText");return"function"==typeof opt?opt(num):"+"+num+" "+opt},getCellSegs:function(cell,startLevel){for(var seg,segMatrix=this.rowStructs[cell.row].segMatrix,level=startLevel||0,segs=[];level<segMatrix.length;)seg=segMatrix[level][cell.col],seg&&segs.push(seg),level++;return segs}});var TimeGrid=Grid.extend({slotDuration:null,snapDuration:null,minTime:null,maxTime:null,colDates:null,labelFormat:null,labelInterval:null,dayEls:null,slatEls:null,slatTops:null,helperEl:null,businessHourSegs:null,constructor:function(){Grid.apply(this,arguments),this.processOptions()},renderDates:function(){this.el.html(this.renderHtml()),this.dayEls=this.el.find(".fc-day"),this.slatEls=this.el.find(".fc-slats tr")},renderBusinessHours:function(){var events=this.view.calendar.getBusinessHoursEvents();this.businessHourSegs=this.renderFill("businessHours",this.eventsToSegs(events),"bgevent")},renderHtml:function(){return'<div class="fc-bg"><table>'+this.rowHtml("slotBg")+'</table></div><div class="fc-slats"><table>'+this.slatRowHtml()+"</table></div>"},slotBgCellHtml:function(cell){return this.bgCellHtml(cell)},slatRowHtml:function(){for(var slotDate,isLabeled,axisHtml,view=this.view,isRTL=this.isRTL,html="",slotTime=moment.duration(+this.minTime);slotTime<this.maxTime;)slotDate=this.start.clone().time(slotTime),isLabeled=isInt(divideDurationByDuration(slotTime,this.labelInterval)),axisHtml='<td class="fc-axis fc-time '+view.widgetContentClass+'" '+view.axisStyleAttr()+">"+(isLabeled?"<span>"+htmlEscape(slotDate.format(this.labelFormat))+"</span>":"")+"</td>",html+="<tr "+(isLabeled?"":'class="fc-minor"')+">"+(isRTL?"":axisHtml)+'<td class="'+view.widgetContentClass+'"/>'+(isRTL?axisHtml:"")+"</tr>",slotTime.add(this.slotDuration);return html},processOptions:function(){var input,view=this.view,slotDuration=view.opt("slotDuration"),snapDuration=view.opt("snapDuration");slotDuration=moment.duration(slotDuration),snapDuration=snapDuration?moment.duration(snapDuration):slotDuration,this.slotDuration=slotDuration,this.snapDuration=snapDuration,this.cellDuration=snapDuration,this.minTime=moment.duration(view.opt("minTime")),this.maxTime=moment.duration(view.opt("maxTime")),input=view.opt("slotLabelFormat"),$.isArray(input)&&(input=input[input.length-1]),this.labelFormat=input||view.opt("axisFormat")||view.opt("smallTimeFormat"),input=view.opt("slotLabelInterval"),this.labelInterval=input?moment.duration(input):this.computeLabelInterval(slotDuration)},computeLabelInterval:function(slotDuration){var i,labelInterval,slotsPerLabel;for(i=AGENDA_STOCK_SUB_DURATIONS.length-1;i>=0;i--)if(labelInterval=moment.duration(AGENDA_STOCK_SUB_DURATIONS[i]),slotsPerLabel=divideDurationByDuration(labelInterval,slotDuration),isInt(slotsPerLabel)&&slotsPerLabel>1)return labelInterval;return moment.duration(slotDuration)},computeColHeadFormat:function(){return this.colCnt>1?this.view.opt("dayOfMonthFormat"):"dddd"},computeEventTimeFormat:function(){return this.view.opt("noMeridiemTimeFormat")},computeDisplayEventEnd:function(){return!0},rangeUpdated:function(){var date,view=this.view,colDates=[];for(date=this.start.clone();date.isBefore(this.end);)colDates.push(date.clone()),date.add(1,"day"),date=view.skipHiddenDays(date);this.isRTL&&colDates.reverse(),this.colDates=colDates,this.colCnt=colDates.length,this.rowCnt=Math.ceil((this.maxTime-this.minTime)/this.snapDuration)},computeCellDate:function(cell){var date=this.colDates[cell.col],time=this.computeSnapTime(cell.row);return date=this.view.calendar.rezoneDate(date),date.time(time),date},getColEl:function(col){return this.dayEls.eq(col)},computeSnapTime:function(row){return moment.duration(this.minTime+this.snapDuration*row)},rangeToSegs:function(range){var seg,col,colDate,colRange,colCnt=this.colCnt,segs=[];for(range={start:range.start.clone().stripZone(),end:range.end.clone().stripZone()},col=0;colCnt>col;col++)colDate=this.colDates[col],colRange={start:colDate.clone().time(this.minTime),end:colDate.clone().time(this.maxTime)},seg=intersectionToSeg(range,colRange),seg&&(seg.col=col,segs.push(seg));return segs},updateSize:function(isResize){this.computeSlatTops(),isResize&&this.updateSegVerticals()},computeRowCoords:function(){var i,item,originTop=this.el.offset().top,items=[];for(i=0;i<this.rowCnt;i++)item={top:originTop+this.computeTimeTop(this.computeSnapTime(i))},i>0&&(items[i-1].bottom=item.top),items.push(item);return item.bottom=item.top+this.computeTimeTop(this.computeSnapTime(i)),items},computeDateTop:function(date,startOfDayDate){return this.computeTimeTop(moment.duration(date.clone().stripZone()-startOfDayDate.clone().stripTime()))},computeTimeTop:function(time){var slatIndex,slatRemainder,slatTop,slatBottom,slatCoverage=(time-this.minTime)/this.slotDuration;return slatCoverage=Math.max(0,slatCoverage),slatCoverage=Math.min(this.slatEls.length,slatCoverage),slatIndex=Math.floor(slatCoverage),slatRemainder=slatCoverage-slatIndex,slatTop=this.slatTops[slatIndex],slatRemainder?(slatBottom=this.slatTops[slatIndex+1],slatTop+(slatBottom-slatTop)*slatRemainder):slatTop},computeSlatTops:function(){var top,tops=[];this.slatEls.each(function(i,node){top=$(node).position().top,tops.push(top)}),tops.push(top+this.slatEls.last().outerHeight()),this.slatTops=tops},renderDrag:function(dropLocation,seg){return seg?(this.renderRangeHelper(dropLocation,seg),this.applyDragOpacity(this.helperEl),!0):void this.renderHighlight(this.eventRangeToSegs(dropLocation))},unrenderDrag:function(){this.unrenderHelper(),this.unrenderHighlight()},renderEventResize:function(range,seg){this.renderRangeHelper(range,seg)},unrenderEventResize:function(){this.unrenderHelper()},renderHelper:function(event,sourceSeg){var tableEl,i,seg,sourceEl,segs=this.eventsToSegs([event]);for(segs=this.renderFgSegEls(segs),tableEl=this.renderSegTable(segs),i=0;i<segs.length;i++)seg=segs[i],sourceSeg&&sourceSeg.col===seg.col&&(sourceEl=sourceSeg.el,seg.el.css({left:sourceEl.css("left"),right:sourceEl.css("right"),"margin-left":sourceEl.css("margin-left"),"margin-right":sourceEl.css("margin-right")}));this.helperEl=$('<div class="fc-helper-skeleton"/>').append(tableEl).appendTo(this.el)},unrenderHelper:function(){this.helperEl&&(this.helperEl.remove(),this.helperEl=null)},renderSelection:function(range){this.view.opt("selectHelper")?this.renderRangeHelper(range):this.renderHighlight(this.selectionRangeToSegs(range))},unrenderSelection:function(){this.unrenderHelper(),this.unrenderHighlight()},renderFill:function(type,segs,className){var segCols,skeletonEl,trEl,col,colSegs,tdEl,containerEl,dayDate,i,seg;if(segs.length){for(segs=this.renderFillSegEls(type,segs),segCols=this.groupSegCols(segs),className=className||type.toLowerCase(),skeletonEl=$('<div class="fc-'+className+'-skeleton"><table><tr/></table></div>'),trEl=skeletonEl.find("tr"),col=0;col<segCols.length;col++)if(colSegs=segCols[col],tdEl=$("<td/>").appendTo(trEl),colSegs.length)for(containerEl=$('<div class="fc-'+className+'-container"/>').appendTo(tdEl),dayDate=this.colDates[col],i=0;i<colSegs.length;i++)seg=colSegs[i],containerEl.append(seg.el.css({top:this.computeDateTop(seg.start,dayDate),bottom:-this.computeDateTop(seg.end,dayDate)}));this.bookendCells(trEl,type),this.el.append(skeletonEl),this.elsByFill[type]=skeletonEl}return segs}});TimeGrid.mixin({eventSkeletonEl:null,renderFgSegs:function(segs){return segs=this.renderFgSegEls(segs),this.el.append(this.eventSkeletonEl=$('<div class="fc-content-skeleton"/>').append(this.renderSegTable(segs))),segs},unrenderFgSegs:function(){this.eventSkeletonEl&&(this.eventSkeletonEl.remove(),this.eventSkeletonEl=null)},renderSegTable:function(segs){var segCols,i,seg,col,colSegs,containerEl,tableEl=$("<table><tr/></table>"),trEl=tableEl.find("tr");for(segCols=this.groupSegCols(segs),this.computeSegVerticals(segs),col=0;col<segCols.length;col++){for(colSegs=segCols[col],this.placeSlotSegs(colSegs),containerEl=$('<div class="fc-event-container"/>'),i=0;i<colSegs.length;i++)seg=colSegs[i],seg.el.css(this.generateSegPositionCss(seg)),seg.bottom-seg.top<30&&seg.el.addClass("fc-short"),containerEl.append(seg.el);trEl.append($("<td/>").append(containerEl))}return this.bookendCells(trEl,"eventSkeleton"),tableEl},placeSlotSegs:function(segs){var levels,level0,i;if(this.sortSegs(segs),levels=buildSlotSegLevels(segs),computeForwardSlotSegs(levels),level0=levels[0]){for(i=0;i<level0.length;i++)computeSlotSegPressures(level0[i]);for(i=0;i<level0.length;i++)this.computeSlotSegCoords(level0[i],0,0)}},computeSlotSegCoords:function(seg,seriesBackwardPressure,seriesBackwardCoord){var i,forwardSegs=seg.forwardSegs;if(void 0===seg.forwardCoord)for(forwardSegs.length?(this.sortForwardSlotSegs(forwardSegs),this.computeSlotSegCoords(forwardSegs[0],seriesBackwardPressure+1,seriesBackwardCoord),seg.forwardCoord=forwardSegs[0].backwardCoord):seg.forwardCoord=1,seg.backwardCoord=seg.forwardCoord-(seg.forwardCoord-seriesBackwardCoord)/(seriesBackwardPressure+1),i=0;i<forwardSegs.length;i++)this.computeSlotSegCoords(forwardSegs[i],0,seg.forwardCoord)},updateSegVerticals:function(){var i,allSegs=(this.segs||[]).concat(this.businessHourSegs||[]);for(this.computeSegVerticals(allSegs),i=0;i<allSegs.length;i++)allSegs[i].el.css(this.generateSegVerticalCss(allSegs[i]))},computeSegVerticals:function(segs){var i,seg;for(i=0;i<segs.length;i++)seg=segs[i],seg.top=this.computeDateTop(seg.start,seg.start),seg.bottom=this.computeDateTop(seg.end,seg.start)},fgSegHtml:function(seg,disableResizing){var timeText,fullTimeText,startTimeText,view=this.view,event=seg.event,isDraggable=view.isEventDraggable(event),isResizableFromStart=!disableResizing&&seg.isStart&&view.isEventResizableFromStart(event),isResizableFromEnd=!disableResizing&&seg.isEnd&&view.isEventResizableFromEnd(event),classes=this.getSegClasses(seg,isDraggable,isResizableFromStart||isResizableFromEnd),skinCss=cssToStr(this.getEventSkinCss(event));return classes.unshift("fc-time-grid-event","fc-v-event"),view.isMultiDayEvent(event)?(seg.isStart||seg.isEnd)&&(timeText=this.getEventTimeText(seg),fullTimeText=this.getEventTimeText(seg,"LT"),startTimeText=this.getEventTimeText(seg,null,!1)):(timeText=this.getEventTimeText(event),fullTimeText=this.getEventTimeText(event,"LT"),startTimeText=this.getEventTimeText(event,null,!1)),'<a class="'+classes.join(" ")+'"'+(event.url?' href="'+htmlEscape(event.url)+'"':"")+(skinCss?' style="'+skinCss+'"':"")+'><div class="fc-content">'+(timeText?'<div class="fc-time" data-start="'+htmlEscape(startTimeText)+'" data-full="'+htmlEscape(fullTimeText)+'"><span>'+htmlEscape(timeText)+"</span></div>":"")+(event.title?'<div class="fc-title">'+htmlEscape(event.title)+"</div>":"")+'</div><div class="fc-bg"/>'+(isResizableFromEnd?'<div class="fc-resizer fc-end-resizer" />':"")+"</a>"},generateSegPositionCss:function(seg){var left,right,shouldOverlap=this.view.opt("slotEventOverlap"),backwardCoord=seg.backwardCoord,forwardCoord=seg.forwardCoord,props=this.generateSegVerticalCss(seg);return shouldOverlap&&(forwardCoord=Math.min(1,backwardCoord+2*(forwardCoord-backwardCoord))),this.isRTL?(left=1-forwardCoord,right=backwardCoord):(left=backwardCoord,right=1-forwardCoord),props.zIndex=seg.level+1,props.left=100*left+"%",props.right=100*right+"%",shouldOverlap&&seg.forwardPressure&&(props[this.isRTL?"marginLeft":"marginRight"]=20),props},generateSegVerticalCss:function(seg){return{top:seg.top,bottom:-seg.bottom}},groupSegCols:function(segs){var i,segCols=[];for(i=0;i<this.colCnt;i++)segCols.push([]);for(i=0;i<segs.length;i++)segCols[segs[i].col].push(segs[i]);return segCols},sortForwardSlotSegs:function(forwardSegs){forwardSegs.sort(proxy(this,"compareForwardSlotSegs"))},compareForwardSlotSegs:function(seg1,seg2){return seg2.forwardPressure-seg1.forwardPressure||(seg1.backwardCoord||0)-(seg2.backwardCoord||0)||this.compareSegs(seg1,seg2)}});var View=fc.View=Class.extend({type:null,name:null,title:null,calendar:null,options:null,coordMap:null,el:null,displaying:null,isSkeletonRendered:!1,isEventsRendered:!1,start:null,end:null,intervalStart:null,intervalEnd:null,intervalDuration:null,intervalUnit:null,isRTL:!1,isSelected:!1,eventOrderSpecs:null,scrollerEl:null,scrollTop:null,widgetHeaderClass:null,widgetContentClass:null,highlightStateClass:null,nextDayThreshold:null,isHiddenDayHash:null,documentMousedownProxy:null,constructor:function(calendar,type,options,intervalDuration){this.calendar=calendar,this.type=this.name=type,this.options=options,this.intervalDuration=intervalDuration||moment.duration(1,"day"),this.nextDayThreshold=moment.duration(this.opt("nextDayThreshold")),this.initThemingProps(),this.initHiddenDays(),this.isRTL=this.opt("isRTL"),this.eventOrderSpecs=parseFieldSpecs(this.opt("eventOrder")),this.documentMousedownProxy=proxy(this,"documentMousedown"),this.initialize()},initialize:function(){},opt:function(name){return this.options[name]},trigger:function(name,thisObj){var calendar=this.calendar;return calendar.trigger.apply(calendar,[name,thisObj||this].concat(Array.prototype.slice.call(arguments,2),[this]))},setDate:function(date){this.setRange(this.computeRange(date))},setRange:function(range){$.extend(this,range),this.updateTitle()},computeRange:function(date){var start,end,intervalUnit=computeIntervalUnit(this.intervalDuration),intervalStart=date.clone().startOf(intervalUnit),intervalEnd=intervalStart.clone().add(this.intervalDuration);return/year|month|week|day/.test(intervalUnit)?(intervalStart.stripTime(),intervalEnd.stripTime()):(intervalStart.hasTime()||(intervalStart=this.calendar.rezoneDate(intervalStart)),intervalEnd.hasTime()||(intervalEnd=this.calendar.rezoneDate(intervalEnd))),start=intervalStart.clone(),start=this.skipHiddenDays(start),end=intervalEnd.clone(),end=this.skipHiddenDays(end,-1,!0),{intervalUnit:intervalUnit,intervalStart:intervalStart,intervalEnd:intervalEnd,start:start,end:end}},computePrevDate:function(date){return this.massageCurrentDate(date.clone().startOf(this.intervalUnit).subtract(this.intervalDuration),-1)},computeNextDate:function(date){return this.massageCurrentDate(date.clone().startOf(this.intervalUnit).add(this.intervalDuration))},massageCurrentDate:function(date,direction){return this.intervalDuration.as("days")<=1&&this.isHiddenDay(date)&&(date=this.skipHiddenDays(date,direction),date.startOf("day")),date},updateTitle:function(){this.title=this.computeTitle()},computeTitle:function(){return this.formatRange({start:this.intervalStart,end:this.intervalEnd},this.opt("titleFormat")||this.computeTitleFormat(),this.opt("titleRangeSeparator"))},computeTitleFormat:function(){return"year"==this.intervalUnit?"YYYY":"month"==this.intervalUnit?this.opt("monthYearFormat"):this.intervalDuration.as("days")>1?"ll":"LL"},formatRange:function(range,formatStr,separator){var end=range.end;return end.hasTime()||(end=end.clone().subtract(1)),formatRange(range.start,end,formatStr,separator,this.opt("isRTL"))},setElement:function(el){this.el=el,this.bindGlobalHandlers()},removeElement:function(){this.clear(),this.isSkeletonRendered&&(this.unrenderSkeleton(),this.isSkeletonRendered=!1),this.unbindGlobalHandlers(),this.el.remove()},display:function(date){var _this=this,scrollState=null;return this.displaying&&(scrollState=this.queryScroll()),this.clear().then(function(){return _this.displaying=$.when(_this.displayView(date)).then(function(){_this.forceScroll(_this.computeInitialScroll(scrollState)),_this.triggerRender()})})},clear:function(){var _this=this,displaying=this.displaying;return displaying?displaying.then(function(){return _this.displaying=null,_this.clearEvents(),_this.clearView()}):$.when()},displayView:function(date){this.isSkeletonRendered||(this.renderSkeleton(),this.isSkeletonRendered=!0),this.setDate(date),this.render&&this.render(),this.renderDates(),this.updateSize(),this.renderBusinessHours()},clearView:function(){this.unselect(),this.triggerUnrender(),this.unrenderBusinessHours(),this.unrenderDates(),this.destroy&&this.destroy()},renderSkeleton:function(){},unrenderSkeleton:function(){},renderDates:function(){},unrenderDates:function(){},renderBusinessHours:function(){},unrenderBusinessHours:function(){},triggerRender:function(){this.trigger("viewRender",this,this,this.el)},triggerUnrender:function(){this.trigger("viewDestroy",this,this,this.el)},bindGlobalHandlers:function(){$(document).on("mousedown",this.documentMousedownProxy)},unbindGlobalHandlers:function(){$(document).off("mousedown",this.documentMousedownProxy)},initThemingProps:function(){var tm=this.opt("theme")?"ui":"fc";this.widgetHeaderClass=tm+"-widget-header",this.widgetContentClass=tm+"-widget-content",this.highlightStateClass=tm+"-state-highlight"},updateSize:function(isResize){var scrollState;isResize&&(scrollState=this.queryScroll()),this.updateHeight(isResize),this.updateWidth(isResize),isResize&&this.setScroll(scrollState)},updateWidth:function(){},updateHeight:function(){var calendar=this.calendar;this.setHeight(calendar.getSuggestedViewHeight(),calendar.isHeightAuto())},setHeight:function(){},computeScrollerHeight:function(totalHeight){var both,otherHeight,scrollerEl=this.scrollerEl;return both=this.el.add(scrollerEl),both.css({position:"relative",left:-1}),otherHeight=this.el.outerHeight()-scrollerEl.height(),both.css({position:"",left:""}),totalHeight-otherHeight},computeInitialScroll:function(){return 0},queryScroll:function(){return this.scrollerEl?this.scrollerEl.scrollTop():void 0},setScroll:function(scrollState){return this.scrollerEl?this.scrollerEl.scrollTop(scrollState):void 0},forceScroll:function(scrollState){var _this=this;this.setScroll(scrollState),setTimeout(function(){_this.setScroll(scrollState)},0)},displayEvents:function(events){var scrollState=this.queryScroll();this.clearEvents(),this.renderEvents(events),this.isEventsRendered=!0,this.setScroll(scrollState),this.triggerEventRender()},clearEvents:function(){this.isEventsRendered&&(this.triggerEventUnrender(),this.destroyEvents&&this.destroyEvents(),this.unrenderEvents(),this.isEventsRendered=!1)},renderEvents:function(){},unrenderEvents:function(){},triggerEventRender:function(){this.renderedEventSegEach(function(seg){this.trigger("eventAfterRender",seg.event,seg.event,seg.el)}),this.trigger("eventAfterAllRender")},triggerEventUnrender:function(){this.renderedEventSegEach(function(seg){this.trigger("eventDestroy",seg.event,seg.event,seg.el)})},resolveEventEl:function(event,el){var custom=this.trigger("eventRender",event,event,el);return custom===!1?el=null:custom&&custom!==!0&&(el=$(custom)),el},showEvent:function(event){this.renderedEventSegEach(function(seg){seg.el.css("visibility","")},event)},hideEvent:function(event){this.renderedEventSegEach(function(seg){seg.el.css("visibility","hidden")},event)},renderedEventSegEach:function(func,event){var i,segs=this.getEventSegs();for(i=0;i<segs.length;i++)event&&segs[i].event._id!==event._id||segs[i].el&&func.call(this,segs[i])},getEventSegs:function(){return[]},isEventDraggable:function(event){var source=event.source||{};return firstDefined(event.startEditable,source.startEditable,this.opt("eventStartEditable"),event.editable,source.editable,this.opt("editable"))},reportEventDrop:function(event,dropLocation,largeUnit,el,ev){var calendar=this.calendar,mutateResult=calendar.mutateEvent(event,dropLocation,largeUnit),undoFunc=function(){mutateResult.undo(),calendar.reportEventChange()};this.triggerEventDrop(event,mutateResult.dateDelta,undoFunc,el,ev),calendar.reportEventChange()},triggerEventDrop:function(event,dateDelta,undoFunc,el,ev){this.trigger("eventDrop",el[0],event,dateDelta,undoFunc,ev,{})},reportExternalDrop:function(meta,dropLocation,el,ev,ui){var eventInput,event,eventProps=meta.eventProps;eventProps&&(eventInput=$.extend({},eventProps,dropLocation),event=this.calendar.renderEvent(eventInput,meta.stick)[0]),this.triggerExternalDrop(event,dropLocation,el,ev,ui)},triggerExternalDrop:function(event,dropLocation,el,ev,ui){this.trigger("drop",el[0],dropLocation.start,ev,ui),event&&this.trigger("eventReceive",null,event)},renderDrag:function(){},unrenderDrag:function(){},isEventResizableFromStart:function(event){return this.opt("eventResizableFromStart")&&this.isEventResizable(event)},isEventResizableFromEnd:function(event){return this.isEventResizable(event)},isEventResizable:function(event){var source=event.source||{};return firstDefined(event.durationEditable,source.durationEditable,this.opt("eventDurationEditable"),event.editable,source.editable,this.opt("editable"))},reportEventResize:function(event,resizeLocation,largeUnit,el,ev){var calendar=this.calendar,mutateResult=calendar.mutateEvent(event,resizeLocation,largeUnit),undoFunc=function(){mutateResult.undo(),calendar.reportEventChange()};this.triggerEventResize(event,mutateResult.durationDelta,undoFunc,el,ev),calendar.reportEventChange()},triggerEventResize:function(event,durationDelta,undoFunc,el,ev){this.trigger("eventResize",el[0],event,durationDelta,undoFunc,ev,{})},select:function(range,ev){this.unselect(ev),this.renderSelection(range),this.reportSelection(range,ev)},renderSelection:function(){},reportSelection:function(range,ev){this.isSelected=!0,this.triggerSelect(range,ev)},triggerSelect:function(range,ev){this.trigger("select",null,range.start,range.end,ev)},unselect:function(ev){this.isSelected&&(this.isSelected=!1,this.destroySelection&&this.destroySelection(),this.unrenderSelection(),this.trigger("unselect",null,ev))},unrenderSelection:function(){},documentMousedown:function(ev){var ignore;this.isSelected&&this.opt("unselectAuto")&&isPrimaryMouseButton(ev)&&(ignore=this.opt("unselectCancel"),ignore&&$(ev.target).closest(ignore).length||this.unselect(ev))},triggerDayClick:function(cell,dayEl,ev){this.trigger("dayClick",dayEl,cell.start,ev)},initHiddenDays:function(){var i,hiddenDays=this.opt("hiddenDays")||[],isHiddenDayHash=[],dayCnt=0;for(this.opt("weekends")===!1&&hiddenDays.push(0,6),i=0;7>i;i++)(isHiddenDayHash[i]=-1!==$.inArray(i,hiddenDays))||dayCnt++;if(!dayCnt)throw"invalid hiddenDays";this.isHiddenDayHash=isHiddenDayHash},isHiddenDay:function(day){return moment.isMoment(day)&&(day=day.day()),this.isHiddenDayHash[day]},skipHiddenDays:function(date,inc,isExclusive){var out=date.clone();for(inc=inc||1;this.isHiddenDayHash[(out.day()+(isExclusive?inc:0)+7)%7];)out.add(inc,"days");return out},computeDayRange:function(range){var endTimeMS,startDay=range.start.clone().stripTime(),end=range.end,endDay=null;return end&&(endDay=end.clone().stripTime(),endTimeMS=+end.time(),endTimeMS&&endTimeMS>=this.nextDayThreshold&&endDay.add(1,"days")),(!end||startDay>=endDay)&&(endDay=startDay.clone().add(1,"days")),{start:startDay,end:endDay}},isMultiDayEvent:function(event){var range=this.computeDayRange(event);return range.end.diff(range.start,"days")>1}}),Calendar=fc.Calendar=Class.extend({dirDefaults:null,langDefaults:null,overrides:null,options:null,viewSpecCache:null,view:null,header:null,loadingLevel:0,constructor:Calendar_constructor,initialize:function(){},initOptions:function(overrides){var lang,langDefaults,isRTL,dirDefaults;overrides=massageOverrides(overrides),lang=overrides.lang,langDefaults=langOptionHash[lang],langDefaults||(lang=Calendar.defaults.lang,langDefaults=langOptionHash[lang]||{}),isRTL=firstDefined(overrides.isRTL,langDefaults.isRTL,Calendar.defaults.isRTL),dirDefaults=isRTL?Calendar.rtlDefaults:{},this.dirDefaults=dirDefaults,this.langDefaults=langDefaults,this.overrides=overrides,this.options=mergeOptions([Calendar.defaults,dirDefaults,langDefaults,overrides]),populateInstanceComputableOptions(this.options),this.viewSpecCache={}},getViewSpec:function(viewType){var cache=this.viewSpecCache;return cache[viewType]||(cache[viewType]=this.buildViewSpec(viewType))},getUnitViewSpec:function(unit){var viewTypes,i,spec;if(-1!=$.inArray(unit,intervalUnits))for(viewTypes=this.header.getViewsWithButtons(),$.each(fc.views,function(viewType){viewTypes.push(viewType)}),i=0;i<viewTypes.length;i++)if(spec=this.getViewSpec(viewTypes[i]),spec&&spec.singleUnit==unit)return spec},buildViewSpec:function(requestedViewType){for(var spec,overrides,duration,unit,viewOverrides=this.overrides.views||{},specChain=[],defaultsChain=[],overridesChain=[],viewType=requestedViewType;viewType;)spec=fcViews[viewType],overrides=viewOverrides[viewType],viewType=null,"function"==typeof spec&&(spec={"class":spec}),spec&&(specChain.unshift(spec),defaultsChain.unshift(spec.defaults||{}),duration=duration||spec.duration,viewType=viewType||spec.type),overrides&&(overridesChain.unshift(overrides),duration=duration||overrides.duration,viewType=viewType||overrides.type);return spec=mergeProps(specChain),spec.type=requestedViewType,spec["class"]?(duration&&(duration=moment.duration(duration),duration.valueOf()&&(spec.duration=duration,unit=computeIntervalUnit(duration),1===duration.as(unit)&&(spec.singleUnit=unit,overridesChain.unshift(viewOverrides[unit]||{})))),spec.defaults=mergeOptions(defaultsChain),spec.overrides=mergeOptions(overridesChain),this.buildViewSpecOptions(spec),this.buildViewSpecButtonText(spec,requestedViewType),spec):!1},buildViewSpecOptions:function(spec){spec.options=mergeOptions([Calendar.defaults,spec.defaults,this.dirDefaults,this.langDefaults,this.overrides,spec.overrides]),populateInstanceComputableOptions(spec.options)},buildViewSpecButtonText:function(spec,requestedViewType){function queryButtonText(options){var buttonText=options.buttonText||{};return buttonText[requestedViewType]||(spec.singleUnit?buttonText[spec.singleUnit]:null)}spec.buttonTextOverride=queryButtonText(this.overrides)||spec.overrides.buttonText,spec.buttonTextDefault=queryButtonText(this.langDefaults)||queryButtonText(this.dirDefaults)||spec.defaults.buttonText||queryButtonText(Calendar.defaults)||(spec.duration?this.humanizeDuration(spec.duration):null)||requestedViewType},instantiateView:function(viewType){var spec=this.getViewSpec(viewType);return new spec["class"](this,viewType,spec.options,spec.duration)},isValidViewType:function(viewType){return Boolean(this.getViewSpec(viewType))},pushLoading:function(){this.loadingLevel++||this.trigger("loading",null,!0,this.view)},popLoading:function(){--this.loadingLevel||this.trigger("loading",null,!1,this.view)},buildSelectRange:function(start,end){return start=this.moment(start),end=end?this.moment(end):start.clone().add(start.hasTime()?this.defaultTimedEventDuration:this.defaultAllDayEventDuration),{start:start,end:end}}});Calendar.mixin(Emitter),Calendar.defaults={titleRangeSeparator:" — ",monthYearFormat:"MMMM YYYY",defaultTimedEventDuration:"02:00:00",defaultAllDayEventDuration:{days:1},forceEventDuration:!1,nextDayThreshold:"09:00:00",defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberTitle:"W",weekNumberCalculation:"local",scrollTime:"06:00:00",lazyFetching:!0,startParam:"start",endParam:"end",timezoneParam:"timezone",timezone:!1,isRTL:!1,buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day"},buttonIcons:{prev:"left-single-arrow",next:"right-single-arrow",prevYear:"left-double-arrow",nextYear:"right-double-arrow"},theme:!1,themeButtonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e",prevYear:"seek-prev",nextYear:"seek-next"},dragOpacity:.75,dragRevertDuration:500,dragScroll:!0,unselectAuto:!0,dropAccept:"*",eventOrder:"title",eventLimit:!1,eventLimitText:"more",eventLimitClick:"popover",dayPopoverFormat:"LL",handleWindowResize:!0,windowResizeDelay:200},Calendar.englishDefaults={dayPopoverFormat:"dddd, MMMM D"},Calendar.rtlDefaults={header:{left:"next,prev today",center:"",right:"title"},buttonIcons:{prev:"right-single-arrow",next:"left-single-arrow",prevYear:"right-double-arrow",nextYear:"left-double-arrow"},themeButtonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w",nextYear:"seek-prev",prevYear:"seek-next"}};var langOptionHash=fc.langs={};fc.datepickerLang=function(langCode,dpLangCode,dpOptions){var fcOptions=langOptionHash[langCode]||(langOptionHash[langCode]={});fcOptions.isRTL=dpOptions.isRTL,fcOptions.weekNumberTitle=dpOptions.weekHeader,$.each(dpComputableOptions,function(name,func){fcOptions[name]=func(dpOptions)}),$.datepicker&&($.datepicker.regional[dpLangCode]=$.datepicker.regional[langCode]=dpOptions,$.datepicker.regional.en=$.datepicker.regional[""],$.datepicker.setDefaults(dpOptions))},fc.lang=function(langCode,newFcOptions){var fcOptions,momOptions;fcOptions=langOptionHash[langCode]||(langOptionHash[langCode]={}),newFcOptions&&(fcOptions=langOptionHash[langCode]=mergeOptions([fcOptions,newFcOptions])),momOptions=getMomentLocaleData(langCode),$.each(momComputableOptions,function(name,func){null==fcOptions[name]&&(fcOptions[name]=func(momOptions,fcOptions))}),Calendar.defaults.lang=langCode};var dpComputableOptions={buttonText:function(dpOptions){return{prev:stripHtmlEntities(dpOptions.prevText),next:stripHtmlEntities(dpOptions.nextText),today:stripHtmlEntities(dpOptions.currentText)}},monthYearFormat:function(dpOptions){return dpOptions.showMonthAfterYear?"YYYY["+dpOptions.yearSuffix+"] MMMM":"MMMM YYYY["+dpOptions.yearSuffix+"]"}},momComputableOptions={dayOfMonthFormat:function(momOptions,fcOptions){var format=momOptions.longDateFormat("l");return format=format.replace(/^Y+[^\w\s]*|[^\w\s]*Y+$/g,""),fcOptions.isRTL?format+=" ddd":format="ddd "+format,format},mediumTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(/\s*a$/i,"a")},smallTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"a")},extraSmallTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"t")},hourFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(":mm","").replace(/(\Wmm)$/,"").replace(/\s*a$/i,"a")},noMeridiemTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(/\s*a$/i,"")}},instanceComputableOptions={smallDayDateFormat:function(options){return options.isRTL?"D dd":"dd D"},weekFormat:function(options){return options.isRTL?"w[ "+options.weekNumberTitle+"]":"["+options.weekNumberTitle+" ]w"},smallWeekFormat:function(options){return options.isRTL?"w["+options.weekNumberTitle+"]":"["+options.weekNumberTitle+"]w"}};fc.lang("en",Calendar.englishDefaults),fc.sourceNormalizers=[],fc.sourceFetchers=[];var ajaxDefaults={dataType:"json",cache:!1},eventGUID=1;Calendar.prototype.getPeerEvents=function(event){var i,otherEvent,cache=this.getEventCache(),peerEvents=[];for(i=0;i<cache.length;i++)otherEvent=cache[i],event&&event._id===otherEvent._id||peerEvents.push(otherEvent);return peerEvents};var BasicView=View.extend({dayGrid:null,dayNumbersVisible:!1,weekNumbersVisible:!1,weekNumberWidth:null,headRowEl:null,initialize:function(){this.dayGrid=new DayGrid(this),this.coordMap=this.dayGrid.coordMap},setRange:function(range){View.prototype.setRange.call(this,range),this.dayGrid.breakOnWeeks=/year|month|week/.test(this.intervalUnit),this.dayGrid.setRange(range)},computeRange:function(date){var range=View.prototype.computeRange.call(this,date);return/year|month/.test(range.intervalUnit)&&(range.start.startOf("week"),range.start=this.skipHiddenDays(range.start),range.end.weekday()&&(range.end.add(1,"week").startOf("week"),range.end=this.skipHiddenDays(range.end,-1,!0))),range},renderDates:function(){this.dayNumbersVisible=this.dayGrid.rowCnt>1,this.weekNumbersVisible=this.opt("weekNumbers"),this.dayGrid.numbersVisible=this.dayNumbersVisible||this.weekNumbersVisible,this.el.addClass("fc-basic-view").html(this.renderHtml()),this.headRowEl=this.el.find("thead .fc-row"),this.scrollerEl=this.el.find(".fc-day-grid-container"),this.dayGrid.coordMap.containerEl=this.scrollerEl,this.dayGrid.setElement(this.el.find(".fc-day-grid")),this.dayGrid.renderDates(this.hasRigidRows())
},unrenderDates:function(){this.dayGrid.unrenderDates(),this.dayGrid.removeElement()},renderBusinessHours:function(){this.dayGrid.renderBusinessHours()},renderHtml:function(){return'<table><thead class="fc-head"><tr><td class="'+this.widgetHeaderClass+'">'+this.dayGrid.headHtml()+'</td></tr></thead><tbody class="fc-body"><tr><td class="'+this.widgetContentClass+'"><div class="fc-day-grid-container"><div class="fc-day-grid"/></div></td></tr></tbody></table>'},headIntroHtml:function(){return this.weekNumbersVisible?'<th class="fc-week-number '+this.widgetHeaderClass+'" '+this.weekNumberStyleAttr()+"><span>"+htmlEscape(this.opt("weekNumberTitle"))+"</span></th>":void 0},numberIntroHtml:function(row){return this.weekNumbersVisible?'<td class="fc-week-number" '+this.weekNumberStyleAttr()+"><span>"+this.dayGrid.getCell(row,0).start.format("w")+"</span></td>":void 0},dayIntroHtml:function(){return this.weekNumbersVisible?'<td class="fc-week-number '+this.widgetContentClass+'" '+this.weekNumberStyleAttr()+"></td>":void 0},introHtml:function(){return this.weekNumbersVisible?'<td class="fc-week-number" '+this.weekNumberStyleAttr()+"></td>":void 0},numberCellHtml:function(cell){var classes,date=cell.start;return this.dayNumbersVisible?(classes=this.dayGrid.getDayClasses(date),classes.unshift("fc-day-number"),'<td class="'+classes.join(" ")+'" data-date="'+date.format()+'">'+date.date()+"</td>"):"<td/>"},weekNumberStyleAttr:function(){return null!==this.weekNumberWidth?'style="width:'+this.weekNumberWidth+'px"':""},hasRigidRows:function(){var eventLimit=this.opt("eventLimit");return eventLimit&&"number"!=typeof eventLimit},updateWidth:function(){this.weekNumbersVisible&&(this.weekNumberWidth=matchCellWidths(this.el.find(".fc-week-number")))},setHeight:function(totalHeight,isAuto){var scrollerHeight,eventLimit=this.opt("eventLimit");unsetScroller(this.scrollerEl),uncompensateScroll(this.headRowEl),this.dayGrid.removeSegPopover(),eventLimit&&"number"==typeof eventLimit&&this.dayGrid.limitRows(eventLimit),scrollerHeight=this.computeScrollerHeight(totalHeight),this.setGridHeight(scrollerHeight,isAuto),eventLimit&&"number"!=typeof eventLimit&&this.dayGrid.limitRows(eventLimit),!isAuto&&setPotentialScroller(this.scrollerEl,scrollerHeight)&&(compensateScroll(this.headRowEl,getScrollbarWidths(this.scrollerEl)),scrollerHeight=this.computeScrollerHeight(totalHeight),this.scrollerEl.height(scrollerHeight))},setGridHeight:function(height,isAuto){isAuto?undistributeHeight(this.dayGrid.rowEls):distributeHeight(this.dayGrid.rowEls,height,!0)},renderEvents:function(events){this.dayGrid.renderEvents(events),this.updateHeight()},getEventSegs:function(){return this.dayGrid.getEventSegs()},unrenderEvents:function(){this.dayGrid.unrenderEvents()},renderDrag:function(dropLocation,seg){return this.dayGrid.renderDrag(dropLocation,seg)},unrenderDrag:function(){this.dayGrid.unrenderDrag()},renderSelection:function(range){this.dayGrid.renderSelection(range)},unrenderSelection:function(){this.dayGrid.unrenderSelection()}}),MonthView=BasicView.extend({computeRange:function(date){var rowCnt,range=BasicView.prototype.computeRange.call(this,date);return this.isFixedWeeks()&&(rowCnt=Math.ceil(range.end.diff(range.start,"weeks",!0)),range.end.add(6-rowCnt,"weeks")),range},setGridHeight:function(height,isAuto){isAuto=isAuto||"variable"===this.opt("weekMode"),isAuto&&(height*=this.rowCnt/6),distributeHeight(this.dayGrid.rowEls,height,!isAuto)},isFixedWeeks:function(){var weekMode=this.opt("weekMode");return weekMode?"fixed"===weekMode:this.opt("fixedWeekCount")}});fcViews.basic={"class":BasicView},fcViews.basicDay={type:"basic",duration:{days:1}},fcViews.basicWeek={type:"basic",duration:{weeks:1}},fcViews.month={"class":MonthView,duration:{months:1},defaults:{fixedWeekCount:!0}};var AgendaView=View.extend({timeGrid:null,dayGrid:null,axisWidth:null,noScrollRowEls:null,bottomRuleEl:null,bottomRuleHeight:null,initialize:function(){this.timeGrid=new TimeGrid(this),this.opt("allDaySlot")?(this.dayGrid=new DayGrid(this),this.coordMap=new ComboCoordMap([this.dayGrid.coordMap,this.timeGrid.coordMap])):this.coordMap=this.timeGrid.coordMap},setRange:function(range){View.prototype.setRange.call(this,range),this.timeGrid.setRange(range),this.dayGrid&&this.dayGrid.setRange(range)},renderDates:function(){this.el.addClass("fc-agenda-view").html(this.renderHtml()),this.scrollerEl=this.el.find(".fc-time-grid-container"),this.timeGrid.coordMap.containerEl=this.scrollerEl,this.timeGrid.setElement(this.el.find(".fc-time-grid")),this.timeGrid.renderDates(),this.bottomRuleEl=$('<hr class="fc-divider '+this.widgetHeaderClass+'"/>').appendTo(this.timeGrid.el),this.dayGrid&&(this.dayGrid.setElement(this.el.find(".fc-day-grid")),this.dayGrid.renderDates(),this.dayGrid.bottomCoordPadding=this.dayGrid.el.next("hr").outerHeight()),this.noScrollRowEls=this.el.find(".fc-row:not(.fc-scroller *)")},unrenderDates:function(){this.timeGrid.unrenderDates(),this.timeGrid.removeElement(),this.dayGrid&&(this.dayGrid.unrenderDates(),this.dayGrid.removeElement())},renderBusinessHours:function(){this.timeGrid.renderBusinessHours(),this.dayGrid&&this.dayGrid.renderBusinessHours()},renderHtml:function(){return'<table><thead class="fc-head"><tr><td class="'+this.widgetHeaderClass+'">'+this.timeGrid.headHtml()+'</td></tr></thead><tbody class="fc-body"><tr><td class="'+this.widgetContentClass+'">'+(this.dayGrid?'<div class="fc-day-grid"/><hr class="fc-divider '+this.widgetHeaderClass+'"/>':"")+'<div class="fc-time-grid-container"><div class="fc-time-grid"/></div></td></tr></tbody></table>'},headIntroHtml:function(){var date,weekText;return this.opt("weekNumbers")?(date=this.timeGrid.getCell(0).start,weekText=date.format(this.opt("smallWeekFormat")),'<th class="fc-axis fc-week-number '+this.widgetHeaderClass+'" '+this.axisStyleAttr()+"><span>"+htmlEscape(weekText)+"</span></th>"):'<th class="fc-axis '+this.widgetHeaderClass+'" '+this.axisStyleAttr()+"></th>"},dayIntroHtml:function(){return'<td class="fc-axis '+this.widgetContentClass+'" '+this.axisStyleAttr()+"><span>"+(this.opt("allDayHtml")||htmlEscape(this.opt("allDayText")))+"</span></td>"},slotBgIntroHtml:function(){return'<td class="fc-axis '+this.widgetContentClass+'" '+this.axisStyleAttr()+"></td>"},introHtml:function(){return'<td class="fc-axis" '+this.axisStyleAttr()+"></td>"},axisStyleAttr:function(){return null!==this.axisWidth?'style="width:'+this.axisWidth+'px"':""},updateSize:function(isResize){this.timeGrid.updateSize(isResize),View.prototype.updateSize.call(this,isResize)},updateWidth:function(){this.axisWidth=matchCellWidths(this.el.find(".fc-axis"))},setHeight:function(totalHeight,isAuto){var eventLimit,scrollerHeight;null===this.bottomRuleHeight&&(this.bottomRuleHeight=this.bottomRuleEl.outerHeight()),this.bottomRuleEl.hide(),this.scrollerEl.css("overflow",""),unsetScroller(this.scrollerEl),uncompensateScroll(this.noScrollRowEls),this.dayGrid&&(this.dayGrid.removeSegPopover(),eventLimit=this.opt("eventLimit"),eventLimit&&"number"!=typeof eventLimit&&(eventLimit=AGENDA_ALL_DAY_EVENT_LIMIT),eventLimit&&this.dayGrid.limitRows(eventLimit)),isAuto||(scrollerHeight=this.computeScrollerHeight(totalHeight),setPotentialScroller(this.scrollerEl,scrollerHeight)?(compensateScroll(this.noScrollRowEls,getScrollbarWidths(this.scrollerEl)),scrollerHeight=this.computeScrollerHeight(totalHeight),this.scrollerEl.height(scrollerHeight)):(this.scrollerEl.height(scrollerHeight).css("overflow","hidden"),this.bottomRuleEl.show()))},computeInitialScroll:function(){var scrollTime=moment.duration(this.opt("scrollTime")),top=this.timeGrid.computeTimeTop(scrollTime);return top=Math.ceil(top),top&&top++,top},renderEvents:function(events){var timedSegs,i,dayEvents=[],timedEvents=[],daySegs=[];for(i=0;i<events.length;i++)events[i].allDay?dayEvents.push(events[i]):timedEvents.push(events[i]);timedSegs=this.timeGrid.renderEvents(timedEvents),this.dayGrid&&(daySegs=this.dayGrid.renderEvents(dayEvents)),this.updateHeight()},getEventSegs:function(){return this.timeGrid.getEventSegs().concat(this.dayGrid?this.dayGrid.getEventSegs():[])},unrenderEvents:function(){this.timeGrid.unrenderEvents(),this.dayGrid&&this.dayGrid.unrenderEvents()},renderDrag:function(dropLocation,seg){return dropLocation.start.hasTime()?this.timeGrid.renderDrag(dropLocation,seg):this.dayGrid?this.dayGrid.renderDrag(dropLocation,seg):void 0},unrenderDrag:function(){this.timeGrid.unrenderDrag(),this.dayGrid&&this.dayGrid.unrenderDrag()},renderSelection:function(range){range.start.hasTime()||range.end.hasTime()?this.timeGrid.renderSelection(range):this.dayGrid&&this.dayGrid.renderSelection(range)},unrenderSelection:function(){this.timeGrid.unrenderSelection(),this.dayGrid&&this.dayGrid.unrenderSelection()}}),AGENDA_ALL_DAY_EVENT_LIMIT=5,AGENDA_STOCK_SUB_DURATIONS=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];return fcViews.agenda={"class":AgendaView,defaults:{allDaySlot:!0,allDayText:"all-day",slotDuration:"00:30:00",minTime:"00:00:00",maxTime:"24:00:00",slotEventOverlap:!0}},fcViews.agendaDay={type:"agenda",duration:{days:1}},fcViews.agendaWeek={type:"agenda",duration:{weeks:1}},fc}),!function(a){"function"==typeof define&&define.amd?define("fullcalendarLang",["jquery","moment"],a):a(jQuery,moment)}(function(a,b){(b.defineLocale||b.lang).call(b,"zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah点mm",LTS:"Ah点m分s秒",L:"YYYY-MM-DD",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY-MM-DD",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(a,b){return 12===a&&(a=0),"凌晨"===b||"早上"===b||"上午"===b?a:"下午"===b||"晚上"===b?a+12:a>=11?a:a+12},meridiem:function(a,b){var d=100*a+b;return 600>d?"凌晨":900>d?"早上":1130>d?"上午":1230>d?"中午":1800>d?"下午":"晚上"},calendar:{sameDay:function(){return 0===this.minutes()?"[今天]Ah[点整]":"[今天]LT"},nextDay:function(){return 0===this.minutes()?"[明天]Ah[点整]":"[明天]LT"},lastDay:function(){return 0===this.minutes()?"[昨天]Ah[点整]":"[昨天]LT"},nextWeek:function(){var a,c;return a=b().startOf("week"),c=this.unix()-a.unix()>=604800?"[下]":"[本]",0===this.minutes()?c+"dddAh点整":c+"dddAh点mm"},lastWeek:function(){var a,c;return a=b().startOf("week"),c=this.unix()<a.unix()?"[上]":"[本]",0===this.minutes()?c+"dddAh点整":c+"dddAh点mm"},sameElse:"LL"},ordinalParse:/\d{1,2}(日|月|周)/,ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"日";case"M":return a+"月";case"w":case"W":return a+"周";default:return a}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1分钟",mm:"%d分钟",h:"1小时",hh:"%d小时",d:"1天",dd:"%d天",M:"1个月",MM:"%d个月",y:"1年",yy:"%d年"},week:{dow:1,doy:4}}),a.fullCalendar.datepickerLang("zh-cn","zh-CN",{closeText:"关闭",prevText:"&#x3C;上月",nextText:"下月&#x3E;",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"}),a.fullCalendar.lang("zh-cn",{buttonText:{month:"月",week:"周",day:"日",list:"日程"},allDayText:"全天",eventLimitText:function(a){return"另外 "+a+" 个"}})}),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip"),options="object"==typeof option&&option;(data||!/destroy|hide/.test(option))&&(data||$this.data("bs.tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]())})}var Tooltip=function(element,options){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",element,options)};Tooltip.VERSION="3.3.5",Tooltip.TRANSITION_DURATION=150,Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},Tooltip.prototype.init=function(type,element,options){if(this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.$viewport=this.options.viewport&&$($.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),obj instanceof $.Event&&(self.inState["focusin"==obj.type?"focus":"hover"]=!0),self.tip().hasClass("in")||"in"==self.hoverState?void(self.hoverState="in"):(clearTimeout(self.timeout),self.hoverState="in",self.options.delay&&self.options.delay.show?void(self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show)):self.show())},Tooltip.prototype.isInStateTrue=function(){for(var key in this.inState)if(this.inState[key])return!0;return!1},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),obj instanceof $.Event&&(self.inState["focusout"==obj.type?"focus":"hover"]=!1),self.isInStateTrue()?void 0:(clearTimeout(self.timeout),self.hoverState="out",self.options.delay&&self.options.delay.hide?void(self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide)):self.hide())},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var inDom=$.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!inDom)return;var that=this,$tip=this.tip(),tipId=this.getUID(this.type);this.setContent(),$tip.attr("id",tipId),this.$element.attr("aria-describedby",tipId),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement).data("bs."+this.type,this),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var orgPlacement=placement,viewportDim=this.getPosition(this.$viewport);placement="bottom"==placement&&pos.bottom+actualHeight>viewportDim.bottom?"top":"top"==placement&&pos.top-actualHeight<viewportDim.top?"bottom":"right"==placement&&pos.right+actualWidth>viewportDim.width?"left":"left"==placement&&pos.left-actualWidth<viewportDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement);var complete=function(){var prevHoverState=that.hoverState;that.$element.trigger("shown.bs."+that.type),that.hoverState=null,"out"==prevHoverState&&that.leave(that)};$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top+=marginTop,offset.left+=marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight);var delta=this.getViewportAdjustedDelta(placement,offset,actualWidth,actualHeight);delta.left?offset.left+=delta.left:offset.top+=delta.top;var isVertical=/top|bottom/.test(placement),arrowDelta=isVertical?2*delta.left-width+actualWidth:2*delta.top-height+actualHeight,arrowOffsetPosition=isVertical?"offsetWidth":"offsetHeight";$tip.offset(offset),this.replaceArrow(arrowDelta,$tip[0][arrowOffsetPosition],isVertical)},Tooltip.prototype.replaceArrow=function(delta,dimension,isVertical){this.arrow().css(isVertical?"left":"top",50*(1-delta/dimension)+"%").css(isVertical?"top":"left","")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(callback){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element.removeAttr("aria-describedby").trigger("hidden.bs."+that.type),callback&&callback()}var that=this,$tip=$(this.$tip),e=$.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:($tip.removeClass("in"),$.support.transition&&$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete(),this.hoverState=null,this)},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function($element){$element=$element||this.$element;var el=$element[0],isBody="BODY"==el.tagName,elRect=el.getBoundingClientRect();null==elRect.width&&(elRect=$.extend({},elRect,{width:elRect.right-elRect.left,height:elRect.bottom-elRect.top}));var elOffset=isBody?{top:0,left:0}:$element.offset(),scroll={scroll:isBody?document.documentElement.scrollTop||document.body.scrollTop:$element.scrollTop()},outerDims=isBody?{width:$(window).width(),height:$(window).height()}:null;return $.extend({},elRect,scroll,outerDims,elOffset)},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getViewportAdjustedDelta=function(placement,pos,actualWidth,actualHeight){var delta={top:0,left:0};if(!this.$viewport)return delta;var viewportPadding=this.options.viewport&&this.options.viewport.padding||0,viewportDimensions=this.getPosition(this.$viewport);if(/right|left/.test(placement)){var topEdgeOffset=pos.top-viewportPadding-viewportDimensions.scroll,bottomEdgeOffset=pos.top+viewportPadding-viewportDimensions.scroll+actualHeight;topEdgeOffset<viewportDimensions.top?delta.top=viewportDimensions.top-topEdgeOffset:bottomEdgeOffset>viewportDimensions.top+viewportDimensions.height&&(delta.top=viewportDimensions.top+viewportDimensions.height-bottomEdgeOffset)}else{var leftEdgeOffset=pos.left-viewportPadding,rightEdgeOffset=pos.left+viewportPadding+actualWidth;leftEdgeOffset<viewportDimensions.left?delta.left=viewportDimensions.left-leftEdgeOffset:rightEdgeOffset>viewportDimensions.right&&(delta.left=viewportDimensions.left+viewportDimensions.width-rightEdgeOffset)}return delta},Tooltip.prototype.getTitle=function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},Tooltip.prototype.getUID=function(prefix){do prefix+=~~(1e6*Math.random());while(document.getElementById(prefix));return prefix},Tooltip.prototype.tip=function(){if(!this.$tip&&(this.$tip=$(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=this;e&&(self=$(e.currentTarget).data("bs."+this.type),self||(self=new this.constructor(e.currentTarget,this.getDelegateOptions()),$(e.currentTarget).data("bs."+this.type,self))),e?(self.inState.click=!self.inState.click,self.isInStateTrue()?self.enter(self):self.leave(self)):self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){var that=this;clearTimeout(this.timeout),this.hide(function(){that.$element.off("."+that.type).removeData("bs."+that.type),that.$tip&&that.$tip.detach(),that.$tip=null,that.$arrow=null,that.$viewport=null})};var old=$.fn.tooltip;$.fn.tooltip=Plugin,$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),define("bsTooltip",function(){}),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.popover"),options="object"==typeof option&&option;(data||!/destroy|hide/.test(option))&&(data||$this.data("bs.popover",data=new Popover(this,options)),"string"==typeof option&&data[option]())})}var Popover=function(element,options){this.init("popover",element,options)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");Popover.VERSION="3.3.5",Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype),Popover.prototype.constructor=Popover,Popover.prototype.getDefaults=function(){return Popover.DEFAULTS},Popover.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof content?"html":"append":"text"](content),$tip.removeClass("fade top bottom left right in"),$tip.find(".popover-title").html()||$tip.find(".popover-title").hide()},Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()},Popover.prototype.getContent=function(){var $e=this.$element,o=this.options;return $e.attr("data-content")||("function"==typeof o.content?o.content.call($e[0]):o.content)},Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var old=$.fn.popover;$.fn.popover=Plugin,$.fn.popover.Constructor=Popover,$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(jQuery),define("bsPopover",function(){}),define("pagelet/calendar/calendar",["fullcalendar","fullcalendarLang","underscore","bsPopover"],function(fullcalendar,fullcalendarLang,_){return function(module){module.directive("calendar",["$timeout","$compile","eventService","launcher","members","dialogService",function($timeout,$compile,eventService,launcher,members,dialogs){function link(scope,element,attrs){members.wait().then(function(){linkThen(scope,element,attrs)})}function linkThen(scope,element){function eventColor(event){if(!event.editable){var color=assignedColor[event.userId];return"undefined"==typeof color&&(color=assignedColor[event.userId]=index++%COLOR_LENGTH),"color-"+color}}var gid=scope.calendar.gid,$calendar=$(element),memberNames=_.reduce(members.getMembers(),function(memo,member){return memo[member.userId]=member.name,memo},{});$calendar.popover({container:"body",placement:"auto top",selector:".fc-event",html:!0,title:!0,template:'<div class="popover popover-event" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',content:function(){var s=scope.$new();return s.event=$(this).data("event"),s.gid=gid,$compile('<div calendar-item="event" gid="gid"></div>')(s)}});var prev,$win=$(window);$calendar.on("show.bs.popover",function(evt){var $target=$(evt.target),popover=$target.data("bs.popover"),$tip=popover.tip();prev&&prev!==popover&&prev.hide(),prev=popover,$win.off("click.calendar.popover").on("click.calendar.popover",function fn(e){var clickedTarget=e.target;e.originalEvent.bsPopoverHidePrevented||$target.is(clickedTarget)||$target.has(clickedTarget).length||$tip.is(clickedTarget)||$tip.has(clickedTarget).length||(popover.hide(),$win.off("click.calendar.popover",fn))})}),$calendar.on("shown.bs.popover",function(evt){$(evt.target).data("bs.popover").$tip.hide()}),$calendar.on("hide.bs.popover",function(evt){var popover=$(evt.target).data("bs.popover");popover.inState.click=!1}),$calendar.fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},selectable:!0,selectHelper:!0,editable:!0,eventLimit:!0,defaultDate:scope.calendar.date,events:eventService.getQueryUrl(gid),timezone:"local",eventRender:function(event,$el){$el.data("event",event);var author=memberNames[event.userId]||event.userId;$el.find(".fc-title").before('<span class="fc-author">['+author+"]</span> ")},eventDataTransform:function(event){return event.editable=event.userId===launcher.uid(),event.className=eventColor(event),event},select:function(start,end){dialogs.prompt("请输入日程标题").then(function(title){if(title){var event={title:title,start:start,end:end,allDay:!start.hasTime()};eventService.create(gid,event)}}).finally(function(){$calendar.fullCalendar("unselect")})},eventDrop:function(event){eventService.update(gid,event)},eventResize:function(event){eventService.update(gid,event)},loading:function(isLoading){scope.$emit("calendar.loading",isLoading),scope.$$phase||scope.$root.$$phase||scope.$apply()}}),$timeout(function(){$calendar.fullCalendar("render")}),scope.$on("$destroy",function(){$calendar.fullCalendar("destroy"),$calendar.popover("destroy"),$(window).off(".calendar")}),scope.$on("socket.event.hack.2",function(event,data){var events=_.isArray(data.content)?data.content:[data.content],ids=_.map(events,function(event){return event.id});$calendar.fullCalendar("removeEvents",ids),("create"===data.type||"update"===data.type)&&_.each(events,function(event){$calendar.fullCalendar("renderEvent",event)})});var COLOR_LENGTH=3,index=0,assignedColor={}}return{restrict:"A",link:link,scope:{calendar:"=calendar"}}}])}}),define("pagelet/calendar/calendarItem",["fullcalendarLang","underscore"],function(){return function(module){module.directive("calendarItem",["$timeout","eventService",function($timeout,eventService){function link(scope,element){var popover=element.closest(".popover").data("bs.popover");popover.reposition=function(){$timeout(function(){popover.$tip.show(),reposition.call(popover)})},popover.reposition();var gid=scope.gid,event=scope.event;scope.edit=function(){scope.isEditing=!0},scope.cancel=function(){popover.hide()},scope.save=function(event){eventService.update(gid,event),popover.hide()},scope.remove=function(){eventService.destroy(gid,event),popover.hide()},scope.fmt=event.allDay?"MM.dd":"MM.dd HH:mm"}function reposition(){var $tip=this.tip(),placement="top",pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight,orgPlacement=placement,viewportDim=this.getPosition(this.$viewport);placement="bottom"==placement&&pos.bottom+actualHeight>viewportDim.bottom?"top":"top"==placement&&pos.top-actualHeight<viewportDim.top?"bottom":"right"==placement&&pos.right+actualWidth>viewportDim.width?"left":"left"==placement&&pos.left-actualWidth<viewportDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement);var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement)}return{restrict:"A",templateUrl:"pagelet/calendar/calendarItem.html",link:link,scope:{event:"=calendarItem",gid:"="}}}])}}),define("calendarModule",["angular","commonModule","pagelet/calendar/calendar","pagelet/calendar/calendarItem"],function(angular,commonModule,calendar,calendarItem){var module=angular.module("calendar",[commonModule.name]);return calendar(module),calendarItem(module),module.run(["launcher","viewport",function(launcher,viewport){launcher.wait().then(function(){viewport.extendView(function(register){register("calendar","pagelet/calendar/index.html",!0)});var baseRouter=launcher.getGroupRouter();baseRouter.bind("/calendar/{date}/{eventId}",function(params){viewport.open("calendar",params)}),baseRouter.bind("/calendar/{date}",function(params){viewport.open("calendar",params)}),baseRouter.bind("/calendar",function(params){viewport.open("calendar",params)})})}]),module.controller("calendarCtrl",["$scope","$timeout",function($scope,$timeout){$scope.$open(function(opt){$scope.active=!0,$scope.opt=opt}),$scope.$invoke(function(opt){$scope.opt=opt,$scope.active=!1,$timeout(function(){$scope.active=!0})}),$scope.$close(function(){$scope.active=!1}),$scope.$on("calendar.loading",function(evt,loading){$scope.loading=loading}),$scope.back=function(){history.back()}}]),module}),define("pagelet/text/textViewer",["screenfull"],function(){return function(module){module.directive("textViewer",["$timeout","$http",function($timeout,$http){function link(scope){$http.get(scope.src).then(function(res){scope.content=res.data})}return{restrict:"A",templateUrl:"pagelet/text/textViewer.html",link:link,scope:{src:"=textViewer"}}}])}}),define("textModule",["jquery","underscore","angular","fileModule","util/trackTiming","pagelet/text/textViewer"],function($,_,angular,fileModule,trackTiming,textViewer){var module=angular.module("textPreviewModule",[fileModule.name]);return textViewer(module),module.run(["explorer","launcher","clientProxy","viewport",function(explorer,launcher,clientProxy,viewport){launcher.wait().then(function(){launcher.getGroupRouter().bind("/text/{fileId}",function(params){viewport.open("text-preview",params)
})}),viewport.extendView(function(register){register("text-preview","pagelet/text/preview.html")}),explorer.extendType(function(register){register("中间页查看",/\.(txt|xml|html|htm|mht)$/i,1,{routerPrefix:"text",open:function(fileId,version,opt){launcher.getGroupRouter().forward("/text/"+fileId,opt)},print:function(){return{divToPrint:".text-viewer",css:{"white-space":"pre-wrap","word-wrap":"break-word"}}}})})}]),module.controller("textPreviewCtrl",["$scope","$timeout","launcher","explorer","fileManager",function($scope,$timeout,launcher,explorer,fileMgr){function clear(){$scope.previewSrc=null}$scope.$watchFile(function(file){return file?($scope.file=file,fileMgr.getFilePath(file.gid,file.parentId).then(function(path){$scope.filePath=path}).catch(function(){$scope.filePath="读取路径失败"}),void($scope.src="/yws/api/group/"+launcher.gid()+"/file/"+file.id+"?method=read&version="+file.version)):void clear()}),$scope.$close(function(){$scope.src=!1}),$scope.onOpenFolder=explorer.openFolder.bind(explorer)}]),module}),define("pagelet/md/mdService",["jquery"],function(){"use strict";return function($http,$q,fileMgr){this.create=function(gid,folderId,title,content){return $http.post("/yws/api/group/"+gid+"/file?method=createCustomizeFile",{title:title+".md",parentId:folderId,content:content,sendMsg:!0}).then(function(req){var data=req.data;return new fileMgr.File(gid,data)}).catch(function(e){return $q.reject(e.data)})},this.update=function(gid,fileId,title,content){return $http.post("/yws/api/group/"+gid+"/file/"+fileId+"?method=updateCustomizeFile",{title:title+".md",content:content}).then(function(req){var data=req.data;return new fileMgr.File(gid,data)}).catch(function(e){return $q.reject(e.data)})}}}),define("pagelet/md/mdCtrl",[],function(){"use strict";return function($scope,$http,$q,$timeout,launcher,explorer,router,dialogs,fileMgr,mdService){function setFrameSrc(fileId){"edit"===$scope.mode?($scope.editorSrc="/md?file="+encodeURIComponent("/yws/api/group/"+launcher.gid()+"/file/"+fileId+"?method=read"),$(".md-editor-frame").load(function(){$scope.loading=!1,$scope.$digest()})):"view"===$scope.mode&&($scope.previewSrc="/md/preview?file="+encodeURIComponent("/yws/api/group/"+launcher.gid()+"/file/"+fileId+"?method=read"),$(".md-editor-preview-frame").load(function(){$scope.loading=!1,$scope.$digest()}))}function openMd(fileId){return $scope.loading=!0,fileMgr.getFile($scope.gid(),fileId).then(function(res){var file=res;return $scope.file=file,$scope.title=file.name.slice(0,file.name.lastIndexOf(".")),$timeout(function(){setFrameSrc(fileId)}),fileMgr.getFilePath(file.gid,file.parentId).then(function(path){$scope.filePath=path}).catch(function(){$scope.filePath="读取路径失败"}),file})}function newMd(folderId){return $scope.file=null,$scope.folderId=folderId,$scope.title="",$scope.mode="edit",$scope.editorSrc="/md",$q.when(null)}function onOpen(opt){var fileId=opt.fileId,folderId=opt.folderId;return fileId?onInvoke(opt):newMd(folderId).then(function(){return"新建笔记"})}function onInvoke(opt){var fileId=opt.fileId,cid=opt.commentId,mode=opt.mode||"view";return $scope.mode=mode,$scope.max=!0,openMd(fileId,mode).then(function(file){return $scope.commentId=cid,cid&&($scope.max=!1),file.name})}function onClose(){return $q.when()}function edit(){launcher.getGroupRouter().forward("/md/"+$scope.file.id,{mode:"edit"})}function saveAndQuit(){var $frame=$(".md-editor-frame")[0];if($frame){var content=$frame.contentWindow.editor.session.getValue();$scope.saving=!0,$scope.file?mdService.update(launcher.gid(),$scope.file.id,$scope.title||"无标题Markdown",content).then(function(){$scope.saving=!1,quit()}).catch(onError):mdService.create(launcher.gid(),$scope.folderId,$scope.title||"无标题Markdown",content).then(function(){$scope.saving=!1,quit()}).catch(onError)}}function onError(e){if($scope.saving=!1,e&&"20108"==e.error){if(e.adviceName)return dialogs.confirm("发布Markdown","目录中有重名Markdown，是否重命名为："+e.adviceName,{ok:"是",cancel:"否"}).then(function(){$scope.title=e.adviceName.replace(/.md$/,""),saveAndQuit()});dialogs.alert("发布Markdown","目录中有重名Markdown，请输入其他标题")}else e.error&&"260"===e.error?dialogs.alert("发布Markdown","无法保存该Markdown，仅该群管理员或群主可保存"):dialogs.alert("发布Markdown","保存失败")}function quit(){return $scope.editorSrc="",$scope.previewSrc="",$scope.folderId?(explorer.openFolder($scope.folderId),void($scope.folderId=null)):explorer.restore()}function onOpenFolder(fileId){explorer.locateFile(fileId)}$scope.$open(onOpen),$scope.$invoke(onInvoke),$scope.$close(onClose),$scope.openRevision=explorer.openRevision,$scope.onOpenFolder=onOpenFolder,$scope.edit=edit,$scope.quit=quit,$scope.saveAndQuit=saveAndQuit,$scope.$watch("file.name",function(newName){void 0!=newName&&($scope.title=newName.slice(0,newName.lastIndexOf(".")))})}}),define("pagelet/md/diffview/mdDiffCtrl",["underscore","htmldiff"],function(){"use strict";return function($scope,$q,$timeout,launcher,fileMgr){function setDiffUrl(version){$scope.diffUrl=1===version?"/md/diff?new="+encodeURIComponent("/yws/api/group/"+launcher.gid()+"/file/"+fileId+"?method=read&version="+version):"/md/diff?old="+encodeURIComponent("/yws/api/group/"+launcher.gid()+"/file/"+fileId+"?method=read&version="+(version-1))+"&new="+encodeURIComponent("/yws/api/group/"+launcher.gid()+"/file/"+fileId+"?method=read&version="+version)}function removeSuffix(v){return v.substr(0,v.lastIndexOf("."))}function changeVersion(version){$scope.playing=!1,$scope.activeVersion=version,$scope.activePersonalId=null,$scope.changeVersionReady=!1;var oldTitle,newTitle,hisListLen=$scope.mdHistoryList.length;1===version?(oldTitle="<div></div>",newTitle=removeSuffix($scope.mdHistoryList[hisListLen-version].name)):(oldTitle=removeSuffix($scope.mdHistoryList[hisListLen-version+1].name),newTitle=removeSuffix($scope.mdHistoryList[hisListLen-version].name)),null===worker?$scope.diffTitle=getHTMLDiff(oldTitle,newTitle):(worker.postMessage({cmd:"start",newVersion:newTitle,oldVersion:oldTitle}),worker.onmessage=function(evt){$scope.$apply(function(){$scope.diffTitle=evt.data})}.bind(this)),$scope.diffUrl="",$scope.curVersion=version,setDiffUrl(version)}function getHistoryList(){fileMgr.listRevision(gid,fileId).then(function(revs){$scope.mdHistoryList=revs,changeVersion($scope.version?$scope.version:revs.length)})}function init(){$scope.changeVersion=changeVersion,getHistoryList()}var gid=$scope.gid,fileId=$scope.table.id,worker=window.Worker?new window.Worker("./util/htmldiff.js"):null;init()}}),define("markdownModule",["jquery","underscore","angular","fileModule","pagelet/md/mdService","pagelet/md/mdCtrl","pagelet/md/diffview/mdDiffCtrl"],function($,_,angular,fileModule,mdService,mdCtrl,mdDiffCtrl){"use strict";function initialize(explorer,launcher,viewport,dialogs){function viewFile(fileId,version,opt){launcher.getGroupRouter().forward("/md/"+fileId,opt)}function create(folder){launcher.getGroupRouter().forward("/md",{folderId:folder.id})}function trace(file,version){dialogs.open({src:"pagelet/md/diffview/mdDiff.html",title:"历史版本比较",table:file,width:823,height:500,cls:"diff",version:version,gid:launcher.gid(),canFullScreen:!0})}launcher.wait().then(function(){launcher.getGroupRouter().bind("/md/{fileId}",function(params){viewport.open("markdown",params)}),launcher.getGroupRouter().bind("/md",function(params){viewport.open("markdown",params)})}),viewport.extendView(function(register){register("markdown","pagelet/md/md.html")}),explorer.extendType(function(register){register("Markdown",/\.(md)$/i,1,{routerPrefix:"md",open:viewFile,create:create,trace:trace})})}return angular.module("mdModule",[fileModule.name]).service("mdService",["$http","$q","fileManager",mdService]).controller("mdCtrl",["$scope","$http","$q","$timeout","launcher","explorer","router","dialogService","fileManager","mdService",mdCtrl]).controller("mdDiffCtrl",["$scope","$q","$timeout","launcher","fileManager",mdDiffCtrl]).run(["explorer","launcher","viewport","dialogService",initialize])}),function(factory){"function"==typeof define&&define.amd?define("angularDatepicker",["angular","moment"],factory):"object"==typeof exports?module.exports=factory(require("angular"),require("moment")):factory(angular,moment)}(function(angular,moment){var Module=angular.module("datePicker",[]);Module.constant("datePickerConfig",{template:"templates/datepicker.html",view:"month",views:["year","month","date","hours","minutes"],momentNames:{year:"year",month:"month",date:"day",hours:"hours",minutes:"minutes"},viewConfig:{year:["years","isSameYear"],month:["months","isSameMonth"],hours:["hours","isSameHour"],minutes:["minutes","isSameMinutes"]},step:5,firstDay:0}),Module.filter("mFormat",function(){return function(m,format,tz){return moment.isMoment(m)?tz?moment.tz(m,tz).format(format):m.format(format):moment(m).format(format)}}),Module.filter("myDate",function(){return function(date){var dateToCn={"周一":"一","周二":"二","周三":"三","周四":"四","周五":"五","周六":"六","周日":"日"};return dateToCn[date]?dateToCn[date]:void 0}}),Module.directive("datePicker",["datePickerConfig","datePickerUtils",function(datePickerConfig,datePickerUtils){return{require:"?ngModel",template:'<div ng-include="template"></div>',scope:{model:"=datePicker",after:"=?",before:"=?"},link:function(scope,element,attrs,ngModel){function prepareViews(){scope.views=datePickerConfig.views.concat(),scope.view=attrs.view||datePickerConfig.view,scope.views=scope.views.slice(scope.views.indexOf(attrs.maxView||"year"),scope.views.indexOf(attrs.minView||"minutes")+1),(1===scope.views.length||-1===scope.views.indexOf(scope.view))&&(scope.view=scope.views[0])}function getDate(name){return datePickerUtils.getDate(scope,attrs,name)}function setDate(date){date&&(scope.model=date,ngModel&&ngModel.$setViewValue(date)),scope.$emit("setDate",scope.model,scope.view),scope.callbackOnSetDate&&scope.callbackOnSetDate(attrs.datePicker,scope.date)}function update(){var view=scope.view;datePickerUtils.setParams(tz,firstDay),scope.model&&!arrowClick&&(scope.date=createMoment(scope.model),arrowClick=!1);var date=scope.date;switch(view){case"year":scope.years=datePickerUtils.getVisibleYears(date);break;case"month":scope.months=datePickerUtils.getVisibleMonths(date);break;case"date":scope.weekdays=scope.weekdays||datePickerUtils.getDaysOfWeek(),scope.weeks=datePickerUtils.getVisibleWeeks(date);break;case"hours":scope.hours=datePickerUtils.getVisibleHours(date);break;case"minutes":scope.minutes=datePickerUtils.getVisibleMinutes(date,step)}prepareViewData()}function watch(){return"date"!==scope.view?scope.view:scope.date?scope.date.month():null}function prepareViewData(){var i,j,view=scope.view,date=scope.date,classes=[],classList="";if(datePickerUtils.setParams(tz,firstDay),"date"===view){var week,weeks=scope.weeks;for(i=0;i<weeks.length;i++)for(week=weeks[i],classes.push([]),j=0;j<week.length;j++)classList="",datePickerUtils.isSameDay(date,week[j])&&(classList+="active"),isNow(week[j],view)&&(classList+=" now"),week[j].month()===date.month()&&inValidRange(week[j])||(classList+=" disabled"),classes[i].push(classList)}else{var params=datePickerConfig.viewConfig[view],dates=scope[params[0]],compareFunc=params[1];for(i=0;i<dates.length;i++)classList="",datePickerUtils[compareFunc](date,dates[i])&&(classList+="active"),isNow(dates[i],view)&&(classList+=" now"),inValidRange(dates[i])||(classList+=" disabled"),classes.push(classList)}scope.classes=classes}function inValidRange(date){var valid=!0;return minDate&&minDate.isAfter(date)&&(valid=isSame(minDate,date)),maxDate&&maxDate.isBefore(date)&&(valid&=isSame(maxDate,date)),valid}function isSame(date1,date2){return date1.isSame(date2,datePickerConfig.momentNames[scope.view])?!0:!1}function clipDate(date){return minDate&&minDate.isAfter(date)?minDate:maxDate&&maxDate.isBefore(date)?maxDate:date}function isNow(date,view){var is=!0;switch(view){case"minutes":is&=~~(now.minutes()/step)===~~(date.minutes()/step);case"hours":is&=now.hours()===date.hours();case"date":is&=now.date()===date.date();case"month":is&=now.month()===date.month();case"year":is&=now.year()===date.year()}return is}var arrowClick=!1,tz=scope.tz=attrs.timezone,createMoment=datePickerUtils.createMoment,eventIsForPicker=datePickerUtils.eventIsForPicker,step=parseInt(attrs.step||datePickerConfig.step,10),partial=!!attrs.partial,minDate=getDate("minDate"),maxDate=getDate("maxDate"),pickerID=element[0].id,now=scope.now=createMoment(),selected=scope.date=createMoment(scope.model||now),autoclose="true"===attrs.autoClose,firstDay=attrs.firstDay&&attrs.firstDay>=0&&attrs.firstDay<=6?parseInt(attrs.firstDay,10):datePickerConfig.firstDay;datePickerUtils.setParams(tz,firstDay),scope.model||selected.minute(Math.ceil(selected.minute()/step)*step).second(0),scope.template=attrs.template||datePickerConfig.template,scope.watchDirectChanges=void 0!==attrs.watchDirectChanges,scope.callbackOnSetDate=attrs.dateChange?datePickerUtils.findFunction(scope,attrs.dateChange):void 0,prepareViews(),scope.setView=function(nextView){-1!==scope.views.indexOf(nextView)&&(scope.view=nextView)},scope.selectDate=function(date){if(attrs.disabled)return!1;if(isSame(scope.date,date)&&(date=scope.date),date=clipDate(date),!date)return!1;scope.date=date;var nextView=scope.views[scope.views.indexOf(scope.view)+1];(!nextView||partial||scope.model)&&setDate(date),nextView?scope.setView(nextView):autoclose?scope.$emit("hidePicker"):prepareViewData()},scope.$watch(watch,update),scope.watchDirectChanges&&scope.$watch("model",function(){arrowClick=!1,update()}),scope.next=function(delta){var date=moment(scope.date);switch(delta=delta||1,scope.view){case"year":case"month":date.year(date.year()+delta);break;case"date":date.month(date.month()+delta);break;case"hours":case"minutes":date.hours(date.hours()+delta)}date=clipDate(date),date&&(scope.date=date,setDate(date),arrowClick=!0,update())},scope.prev=function(delta){return scope.next(-delta||-1)},pickerID&&scope.$on("pickerUpdate",function(event,pickerIDs,data){if(eventIsForPicker(pickerIDs,pickerID)){var updateViews=!1,updateViewData=!1;angular.isDefined(data.minDate)&&(minDate=data.minDate?data.minDate:!1,updateViewData=!0),angular.isDefined(data.maxDate)&&(maxDate=data.maxDate?data.maxDate:!1,updateViewData=!0),angular.isDefined(data.minView)&&(attrs.minView=data.minView,updateViews=!0),angular.isDefined(data.maxView)&&(attrs.maxView=data.maxView,updateViews=!0),attrs.view=data.view||attrs.view,updateViews&&prepareViews(),updateViewData&&update()}})}}}]),angular.module("datePicker").factory("datePickerUtils",function(){var tz,firstDay,createNewDate=function(year,month,day,hour,minute){var utc=Date.UTC(0|year,0|month,0|day,0|hour,0|minute);return tz?moment.tz(utc,tz):moment(utc)};return{getVisibleMinutes:function(m,step){var pushedDate,minute,year=m.year(),month=m.month(),day=m.date(),hour=m.hours(),offset=m.utcOffset()/60,minutes=[];for(minute=0;60>minute;minute+=step)pushedDate=createNewDate(year,month,day,hour-offset,minute),minutes.push(pushedDate);return minutes},getVisibleWeeks:function(m){m=moment(m);var startYear=m.year(),startMonth=m.month();m.date(1);var day=m.day();m.date(firstDay-(day+(firstDay>=day?6:-1)));for(var weeks=[];weeks.length<6&&!(m.year()===startYear&&m.month()>startMonth);)weeks.push(this.getDaysOfWeek(m)),m.add(7,"d");return weeks},getVisibleYears:function(d){var m=moment(d),year=m.year();m.year(year-year%10),year=m.year();for(var pushedDate,actualOffset,offset=m.utcOffset()/60,years=[],i=0;12>i;i++)pushedDate=createNewDate(year,0,1,0-offset),actualOffset=pushedDate.utcOffset()/60,actualOffset!==offset&&(pushedDate=createNewDate(year,0,1,0-actualOffset),offset=actualOffset),years.push(pushedDate),year++;return years},getDaysOfWeek:function(m){m=m?m:tz?moment.tz(tz).day(firstDay):moment().day(firstDay);for(var pushedDate,actualOffset,year=m.year(),month=m.month(),day=m.date(),days=[],offset=m.utcOffset()/60,i=0;7>i;i++)pushedDate=createNewDate(year,month,day,0-offset,0,!1),actualOffset=pushedDate.utcOffset()/60,actualOffset!==offset&&(pushedDate=createNewDate(year,month,day,0-actualOffset,0,!1)),days.push(pushedDate),day++;return days},getVisibleMonths:function(m){for(var pushedDate,actualOffset,year=m.year(),offset=m.utcOffset()/60,months=[],month=0;12>month;month++)pushedDate=createNewDate(year,month,1,0-offset,0,!1),actualOffset=pushedDate.utcOffset()/60,actualOffset!==offset&&(pushedDate=createNewDate(year,month,1,0-actualOffset,0,!1)),months.push(pushedDate);return months},getVisibleHours:function(m){var hour,pushedDate,actualOffset,year=m.year(),month=m.month(),day=m.date(),hours=[],offset=m.utcOffset()/60;for(hour=0;24>hour;hour++)pushedDate=createNewDate(year,month,day,hour-offset,0,!1),actualOffset=pushedDate.utcOffset()/60,actualOffset!==offset&&(pushedDate=createNewDate(year,month,day,hour-actualOffset,0,!1)),hours.push(pushedDate);return hours},isAfter:function(model,date){return model&&model.unix()>=date.unix()},isBefore:function(model,date){return model.unix()<=date.unix()},isSameYear:function(model,date){return model&&model.year()===date.year()},isSameMonth:function(model,date){return this.isSameYear(model,date)&&model.month()===date.month()},isSameDay:function(model,date){return this.isSameMonth(model,date)&&model.date()===date.date()},isSameHour:function(model,date){return this.isSameDay(model,date)&&model.hours()===date.hours()},isSameMinutes:function(model,date){return this.isSameHour(model,date)&&model.minutes()===date.minutes()},setParams:function(zone,fd){tz=zone,firstDay=fd},scopeSearch:function(scope,name,comparisonFn){var target,i,parentScope=scope,nameArray=name.split("."),j=nameArray.length;do{for(target=parentScope=parentScope.$parent,i=0;j>i;i++){target=target[nameArray[i]]}if(target&&comparisonFn(target))return target}while(parentScope.$parent);return!1},findFunction:function(scope,name){return this.scopeSearch(scope,name,function(target){return angular.isFunction(target)})},findParam:function(scope,name){return this.scopeSearch(scope,name,function(){return!0})},createMoment:function(m){return"minDate"==m||"maxDate"==m?{isValid:function(){return!1}}:tz?moment.tz(m,tz):moment.isMoment(m)?moment.unix(m.unix()):moment(m)},getDate:function(scope,attrs,name){var result=!1;return attrs[name]&&(result=this.createMoment(attrs[name]),result.isValid()||(result=this.findParam(scope,attrs[name]),result&&(result=this.createMoment(result)))),result},eventIsForPicker:function(targetIDs,pickerID){return angular.isArray(targetIDs)&&targetIDs.indexOf(pickerID)>-1||targetIDs===pickerID}}});var Module=angular.module("datePicker");Module.directive("dateRange",["$compile","datePickerUtils","dateTimeConfig",function($compile,datePickerUtils,dateTimeConfig){function getTemplate(attrs,id,model,min,max){return dateTimeConfig.template(angular.extend(attrs,{ngModel:model,minDate:min&&moment.isMoment(min)?min.format():!1,maxDate:max&&moment.isMoment(max)?max.format():!1}),id)}function randomName(){return"picker"+Math.random().toString().substr(2)}return{scope:{start:"=",end:"="},link:function(scope,element,attrs){function setMax(date){scope.$broadcast("pickerUpdate",pickerIDs[0],{maxDate:date})}function setMin(date){scope.$broadcast("pickerUpdate",pickerIDs[1],{minDate:date})}var dateChange=null,pickerRangeID=element[0].id,pickerIDs=[randomName(),randomName()],createMoment=datePickerUtils.createMoment,eventIsForPicker=datePickerUtils.eventIsForPicker;scope.dateChange=function(modelName,newDate){dateChange&&dateChange(modelName,newDate)},pickerRangeID&&scope.$on("pickerUpdate",function(event,targetIDs,data){eventIsForPicker(targetIDs,pickerRangeID)&&scope.$broadcast("pickerUpdate",pickerIDs,data)}),datePickerUtils.setParams(attrs.timezone),scope.start=createMoment(scope.start),scope.end=createMoment(scope.end),scope.$watchGroup(["start","end"],function(dates){setMin(dates[0]),setMax(dates[1])}),angular.isDefined(attrs.dateChange)&&(dateChange=datePickerUtils.findFunction(scope,attrs.dateChange)),attrs.onSetDate="dateChange";var template='<div><table class="date-range"><tr><td valign="top">'+getTemplate(attrs,pickerIDs[0],"start",!1,scope.end)+'</td><td valign="top">'+getTemplate(attrs,pickerIDs[1],"end",scope.start,!1)+"</td></tr></table></div>",picker=$compile(template)(scope);element.append(picker)}}}]);var PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",Module=angular.module("datePicker");Module.constant("dateTimeConfig",{template:function(attrs,id){return"<div "+(id?'id="'+id+'" ':"")+'date-picker="'+attrs.ngModel+'" '+(attrs.view?'view="'+attrs.view+'" ':"")+(attrs.maxView?'max-view="'+attrs.maxView+'" ':"")+(attrs.maxDate?'max-date="'+attrs.maxDate+'" ':"")+(attrs.autoClose?'auto-close="'+attrs.autoClose+'" ':"")+(attrs.template?'template="'+attrs.template+'" ':"")+(attrs.minView?'min-view="'+attrs.minView+'" ':"")+(attrs.minDate?'min-date="'+attrs.minDate+'" ':"")+(attrs.partial?'partial="'+attrs.partial+'" ':"")+(attrs.step?'step="'+attrs.step+'" ':"")+(attrs.onSetDate?'date-change="'+attrs.onSetDate+'" ':"")+(attrs.ngModel?'ng-model="'+attrs.ngModel+'" ':"")+(attrs.firstDay?'first-day="'+attrs.firstDay+'" ':"")+(attrs.timezone?'timezone="'+attrs.timezone+'" ':"")+'class="date-picker-date-time"></div>'},format:"YYYY-MM-DD HH:mm",views:["date","year","month","hours","minutes"],autoClose:!1,position:"relative"}),Module.directive("dateTimeAppend",function(){return{link:function(scope,element){element.bind("click",function(){element.find("input")[0].focus()})}}}),Module.directive("dateTime",["$compile","$document","$filter","dateTimeConfig","$parse","datePickerUtils",function($compile,$document,$filter,dateTimeConfig,$parse,datePickerUtils){var body=$document.find("body"),dateFilter=$filter("mFormat");return{require:"ngModel",scope:!0,link:function(scope,element,attrs,ngModel){function formatter(value){return dateFilter(value,format,timezone)}function parser(viewValue){return viewValue.length===format.length?viewValue:void 0}function setMin(date){minDate=date,attrs.minDate=date?date.format():date,minValid=moment.isMoment(date)}function setMax(date){maxDate=date,attrs.maxDate=date?date.format():date,maxValid=moment.isMoment(date)}function getTemplate(){template=dateTimeConfig.template(attrs)}function updateInput(event){event.stopPropagation(),ngModel.$pristine&&(ngModel.$dirty=!0,ngModel.$pristine=!1,element.removeClass(PRISTINE_CLASS).addClass(DIRTY_CLASS),parentForm&&parentForm.$setDirty(),ngModel.$render())}function clear(){picker&&(picker.remove(),picker=null),container&&(container.remove(),container=null)}function showPicker(){if(!picker){if(picker=$compile(template)(scope),scope.$digest(),shownOnce||(scope.$on("setDate",function(event,date,view){updateInput(event),dateChange&&dateChange(attrs.ngModel,date),dismiss&&views[views.length-1]===view&&clear()}),scope.$on("hidePicker",function(){element.triggerHandler("blur")}),scope.$on("$destroy",clear),shownOnce=!0),"absolute"===position){var pos=element[0].getBoundingClientRect(),height=pos.height||element[0].offsetHeight;picker.css({top:pos.top+height+"px",left:pos.left+"px",display:"block",position:position}),body.append(picker)}else container=angular.element("<div date-picker-wrapper></div>"),element[0].parentElement.insertBefore(container[0],element[0]),container.append(picker),picker.css({top:element[0].offsetHeight+"px",display:"block"});picker.bind("mousedown",function(evt){evt.preventDefault()})}}var template,format=attrs.format||dateTimeConfig.format,parentForm=element.inheritedData("$formController"),views=$parse(attrs.views)(scope)||dateTimeConfig.views.concat(),view=attrs.view||views[0],index=views.indexOf(view),dismiss=attrs.autoClose?$parse(attrs.autoClose)(scope):dateTimeConfig.autoClose,picker=null,pickerID=element[0].id,position=attrs.position||dateTimeConfig.position,container=null,minDate=null,minValid=null,maxDate=null,maxValid=null,timezone=attrs.timezone||!1,eventIsForPicker=datePickerUtils.eventIsForPicker,dateChange=null,shownOnce=!1;-1===index&&views.splice(index,1),views.unshift(view),ngModel.$formatters.push(formatter),ngModel.$parsers.unshift(parser),angular.isDefined(attrs.minDate)&&(setMin(datePickerUtils.findParam(scope,attrs.minDate)),ngModel.$validators.min=function(value){return minValid?moment.isMoment(value)&&(minDate.isSame(value)||minDate.isBefore(value)):!0}),angular.isDefined(attrs.maxDate)&&(setMax(datePickerUtils.findParam(scope,attrs.maxDate)),ngModel.$validators.max=function(value){return maxValid?moment.isMoment(value)&&(maxDate.isSame(value)||maxDate.isAfter(value)):!0}),angular.isDefined(attrs.dateChange)&&(dateChange=datePickerUtils.findFunction(scope,attrs.dateChange)),pickerID&&scope.$on("pickerUpdate",function(event,pickerIDs,data){if(eventIsForPicker(pickerIDs,pickerID))if(picker);else{var validateRequired=!1;angular.isDefined(data.minDate)&&(setMin(data.minDate),validateRequired=!0),angular.isDefined(data.maxDate)&&(setMax(data.maxDate),validateRequired=!0),angular.isDefined(data.minView)&&(attrs.minView=data.minView),angular.isDefined(data.maxView)&&(attrs.maxView=data.maxView),attrs.view=data.view||attrs.view,validateRequired&&ngModel.$validate(),angular.isDefined(data.format)&&(format=attrs.format=data.format||dateTimeConfig.format,ngModel.$modelValue=-1),getTemplate()}}),element.bind("focus",showPicker),element.bind("blur",clear),getTemplate()}}}]),angular.module("datePicker").run(["$templateCache",function($templateCache){$templateCache.put("templates/datepicker.html",'<div ng-switch="view">\r\n  <div ng-switch-when="date">\r\n    <table>\r\n      <thead>\r\n      <tr>\r\n        <th class="prev" ng-click="prev()"></th>\r\n        <th colspan="5" class="switch" ng-click="setView(\'month\')" ng-bind="date|mFormat:\'YYYY MMMM\':tz"></th>\r\n        <th class="next" ng-click="next()"></i></th>\r\n      </tr>\r\n      <tr>\r\n        <th ng-repeat="day in weekdays" style="overflow: hidden" ng-bind="day|mFormat:\'ddd\':tz|myDate"></th>\r\n      </tr>\r\n      </thead>\r\n      <tbody>\r\n      <tr ng-repeat="week in weeks" ng-init="$index2 = $index">\r\n        <td ng-repeat="day in week">\r\n          <span\r\n            ng-class="classes[$index2][$index]"\r\n            ng-click="selectDate(day)" ng-bind="day|mFormat:\'DD\':tz"></span>\r\n        </td>\r\n      </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n  <div ng-switch-when="year">\r\n    <table>\r\n      <thead>\r\n      <tr>\r\n        <th ng-click="prev(10)">&lsaquo;</th>\r\n        <th colspan="5" class="switch"ng-bind="years[0].year()+\' - \'+years[years.length-1].year()"></th>\r\n        <th ng-click="next(10)">&rsaquo;</i></th>\r\n      </tr>\r\n      </thead>\r\n      <tbody>\r\n      <tr>\r\n        <td colspan="7">\r\n          <span ng-class="classes[$index]"\r\n                ng-repeat="year in years"\r\n                ng-click="selectDate(year)" ng-bind="year.year()"></span>\r\n        </td>\r\n      </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n  <div ng-switch-when="month">\r\n    <table>\r\n      <thead>\r\n      <tr>\r\n        <th ng-click="prev()">&lsaquo;</th>\r\n        <th colspan="5" class="switch" ng-click="setView(\'year\')" ng-bind="date|mFormat:\'YYYY\':tz"></th>\r\n        <th ng-click="next()">&rsaquo;</i></th>\r\n      </tr>\r\n      </thead>\r\n      <tbody>\r\n      <tr>\r\n        <td colspan="7">\r\n          <span ng-repeat="month in months"\r\n                ng-class="classes[$index]"\r\n                ng-click="selectDate(month)"\r\n                ng-bind="month|mFormat:\'MMM\':tz"></span>\r\n        </td>\r\n      </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n  <div ng-switch-when="hours">\r\n    <table>\r\n      <thead>\r\n      <tr>\r\n        <th ng-click="prev(24)">&lsaquo;</th>\r\n        <th colspan="5" class="switch" ng-click="setView(\'date\')" ng-bind="date|mFormat:\'DD MMMM YYYY\':tz"></th>\r\n        <th ng-click="next(24)">&rsaquo;</i></th>\r\n      </tr>\r\n      </thead>\r\n      <tbody>\r\n      <tr>\r\n        <td colspan="7">\r\n          <span ng-repeat="hour in hours"\r\n                ng-class="classes[$index]"\r\n                ng-click="selectDate(hour)" ng-bind="hour|mFormat:\'HH:mm\':tz"></span>\r\n        </td>\r\n      </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n  <div ng-switch-when="minutes">\r\n    <table>\r\n      <thead>\r\n      <tr>\r\n        <th ng-click="prev()">&lsaquo;</th>\r\n        <th colspan="5" class="switch" ng-click="setView(\'hours\')" ng-bind="date|mFormat:\'DD MMMM YYYY\':tz"></th>\r\n        <th ng-click="next()">&rsaquo;</i></th>\r\n      </tr>\r\n      </thead>\r\n      <tbody>\r\n      <tr>\r\n        <td colspan="7">\r\n          <span ng-repeat="minute in minutes"\r\n                ng-class="classes[$index]"\r\n                ng-click="selectDate(minute)"\r\n                ng-bind="minute|mFormat:\'HH:mm\':tz"></span>\r\n        </td>\r\n      </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</div>')}])}),define("pagelet/task/taskService",[],function(){return function(module){module.service("taskService",["$q","$http","$timeout","members","launcher",function($q,$http,$timeout,members,launcher){function TaskList(json){this.id=json.id,this.groupId=json.groupId,this.title=json.title,this.version=json.version,this.status=json.status,this.createTime=json.createTime?new Date(json.createTime):null,this.modifyTime=json.modifyTime,this.lastUpdateTime=json.lastUpdateTime,this.creator=json.creator,this.modifier=json.modifier,this.archiver=json.archiver,this.archived=!!json.archiver,this.deleted=json.deleted,this.desc=json.description,this.tasks=[],this.completedTasks=[],this.taskNum=Number(json.taskNum),this.commentsNum=Number(json.commentsNum)}function Task(json){this.id=json.id,this.listId=json.tasklistId,this.gid=json.groupId;var group=launcher.getGroups()?_.findWhere(launcher.getGroups(),{id:json.groupId}):void 0;this.groupName=json.groupName||(group?group.name:void 0),this.listName=json.tasklistTitle||"默认清单",this.title=json.title,this.executor=members.getMember(json.executor),this.executorId=json.executor,this.priority=json.priority,this.expectFinishTime=json.expectFinishTime?new Date(json.expectFinishTime):null,this.complete=!!json.finisher,this.finisher=json.finisher,this.finishTime=json.finishTime,this.creator=json.creator,this.createTime=json.createTime?new Date(json.createTime):null,this.deleted=json.deleted,this.lastUpdater=json.lastUpdater,this.lastUpdateTime=json.lastUpdateTime,this.commentsNum=json.commentsNum,this.version=json.version,this.status=json.status}function Operation(json){this.id=json.id,this.gid=json.groupId,this.taskId=json.taskId,this.taskVersion=json.taskVersion,this.type=json.type,this.operator=json.userId,this.targetUserId=json.targetUserId,this.op=json.op,this.msg=json.msg,this.opTime=json.opTime?new Date(json.opTime):new Date}this.allOfMe=function(){var defer=$q.defer();return $http.get("/yws/api/tasks/self").success(function(json){var results=_.map(json,function(v){return new Task(v)});defer.resolve(results)}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.getTaskLists=function(gid){var defer=$q.defer();return $http.get("/yws/api/group/"+gid+"/tasks/list").success(function(json){var results=_.map(json,function(v){return new TaskList(v)});defer.resolve(results)}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.getTaskList=function(gid,listId){var defer=$q.defer();return $http.get("/yws/api/group/"+gid+"/tasks/list/"+listId).success(function(json){defer.resolve(new TaskList(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.createTaskList=function(gid,title,desc){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/list",{title:title,desc:desc}).success(function(json){defer.resolve(new TaskList(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.updateTaskList=function(gid,listId,title,desc){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/list/"+listId,{title:title,desc:desc}).success(function(json){defer.resolve(new TaskList(json))
}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.renameTaskList=function(gid,listId,title){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/list/"+listId+"?method=rename",{title:title}).success(function(json){defer.resolve(new TaskList(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.updateTaskListDesc=function(gid,listId,desc){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/list/"+listId+"?method=updateDesc",{desc:desc}).success(function(json){defer.resolve(new TaskList(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.deleteTaskList=function(gid,listId){var defer=$q.defer();return $http.delete("/yws/api/group/"+gid+"/tasks/list/"+listId).success(function(){defer.resolve()}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.archiveTaskList=function(gid,listId){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/list/"+listId+"?method=archive").success(function(json){defer.resolve(new TaskList(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.reopenTaskList=function(gid,listId){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/list/"+listId+"?method=reOpen").success(function(json){defer.resolve(new TaskList(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.getArchivedTaskList=function(gid){var defer=$q.defer();return $http.get("/yws/api/group/"+gid+"/tasks/list?isArchived=true").success(function(json){var results=_.map(json,function(v){return new TaskList(v)});defer.resolve(results)}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.getTasks=function(gid,listId){var defer=$q.defer();return $http.get("/yws/api/group/"+gid+"/tasks/task/",{params:{listId:listId}}).success(function(json){var results=_.map(json,function(v){return new Task(v)});defer.resolve(results)}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.createTask=function(gid,listId,title,priority,executor,expfinishTime){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/task",{listId:listId,title:title,priority:priority,executor:executor,expfinishTime:expfinishTime}).success(function(json){defer.resolve(new Task(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.deleteTask=function(gid,taskId){var defer=$q.defer();return $http.delete("/yws/api/group/"+gid+"/tasks/task/"+taskId).success(function(){defer.resolve()}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.getTask=function(gid,taskId){var defer=$q.defer();return $http.get("/yws/api/group/"+gid+"/tasks/task/"+taskId).success(function(json){defer.resolve(new Task(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.updateTask=function(gid,taskId,title,priority,executor,expfinishTime){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/task/"+taskId,{title:title,priority:priority,executor:executor,expfinishTime:expfinishTime}).success(function(json){defer.resolve(new Task(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.renameTask=function(gid,taskId,title){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/task/"+taskId+"?method=rename",{title:title}).success(function(json){defer.resolve(new Task(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.changeTaskExecutor=function(gid,taskId,executor){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/task/"+taskId+"?method=updateExecutor",{executor:executor}).success(function(json){defer.resolve(new Task(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.changeTaskPriority=function(gid,taskId,priority){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/task/"+taskId+"?method=updatePriority",{priority:priority}).success(function(json){defer.resolve(new Task(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.changeTaskTime=function(gid,taskId,timestamp){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/task/"+taskId+"?method=updateTime",{expfinishTime:timestamp}).success(function(json){defer.resolve(new Task(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.finishTask=function(gid,taskId){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/task/"+taskId+"?method=finish").success(function(json){defer.resolve(new Task(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.unFinishTask=function(gid,taskId){var defer=$q.defer();return $http.post("/yws/api/group/"+gid+"/tasks/task/"+taskId+"?method=cancelFinish").success(function(json){defer.resolve(new Task(json))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.getTaskOp=function(gid,taskId){var defer=$q.defer();return $http.get("/yws/api/group/"+gid+"/tasks/task/"+taskId+"?method=listOp").success(function(json){defer.resolve(_.map(json,function(operationJson){return new Operation(operationJson)}))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.getTaskListOp=function(gid,listId){var defer=$q.defer();return $http.get("/yws/api/group/"+gid+"/tasks/list/"+listId+"?method=listOp").success(function(json){defer.resolve(_.map(json,function(operationJson){return new Operation(operationJson)}))}).error(function(e,status){defer.reject(e,status)}),defer.promise},this.TaskList=TaskList,this.Task=Task,this.Operation=Operation}])}}),define("pagelet/task/directive/taskList",[],function(){return function(module){module.directive("taskList",["$rootScope","$timeout","taskService","launcher","dialogService","MESSAGE_TYPE","TASK_OPERATION",function($rootScope,$timeout,taskService,launcher,dialogs,MESSAGE_TYPE,TASK_OPERATION){function link(scope){function checkAbleToArchive(){return scope.list?scope.list.completedTasks&&scope.list.completedTasks.length>0&&0==scope.list.tasks.length?(scope.list.ableToArchive=!0,!0):(scope.list.ableToArchive=!1,!1):void 0}function onRenameTaskList(list){scope.list.id==list.id&&scope.list.title!=list.title&&(scope.title=scope.list.title=list.title)}function onUpdateTaskList(list){scope.list.id==list.id&&(checkAbleToArchive(),taskService.getTaskList(launcher.gid(),list.id).then(function(taskList){scope.list.desc=taskList.desc}))}function onAddTask(task){_.isUndefined(scope.filter)||!_.isUndefined(scope.filter)&&""==scope.filter.dueDate&&""==scope.filter.assignee?scope.list.id!=task.listId||scope.list.groupId!=task.gid||_.findWhere(scope.list.tasks,{id:task.id})||(scope.list.tasks.unshift(task),checkAbleToArchive()):scope.list.id!=task.listId||scope.list.groupId!=task.gid||_.findWhere(scope.list.tasks,{id:task.id})||(scope.filter.dueDate&&scope.checkDueDate()(task.expectFinishTime,scope.filter.dueDate)||scope.filter.assignee&&scope.checkAssignee()(task.executor,scope.filter.assignee))&&(scope.list.tasks.unshift(task),checkAbleToArchive())}function onDeleteTask(deletedTask){scope.list.id==deletedTask.listId&&_.findWhere(scope.list.tasks,{id:deletedTask.id})&&(scope.list.tasks=_.reject(scope.list.tasks,function(task){return task.id==deletedTask.id}),checkAbleToArchive())}function onFinishTask(finishedTask,fromLocal){var target=_.findWhere(scope.list.tasks,{id:finishedTask.id});if(scope.list.id==finishedTask.listId&&target&&(fromLocal||!fromLocal&&!target.complete)){scope.list.ableToArchive=scope.list.tasks.length>=2?!1:!0,finishedTask.complete=!0;var tempTasks=_.reject(scope.list.tasks,function(task){return task.id==finishedTask.id});tempTasks.push(finishedTask),scope.list.tasks=tempTasks,$timeout(function(){scope.list.tasks=_.reject(scope.list.tasks,function(task){return task.id==finishedTask.id}),scope.list.completedTasks&&!_.findWhere(scope.list.completedTasks,{id:finishedTask.id})&&scope.list.completedTasks.unshift(finishedTask)},1e4)}}function onUnfinishTask(unfinishedTask){(scope.list.id==unfinishedTask.listId&&_.findWhere(scope.list.completedTasks,{id:unfinishedTask.id})&&scope.inAside||!scope.inAside&&scope.list.id==unfinishedTask.listId&&!_.findWhere(scope.list.tasks,{id:unfinishedTask.id}))&&(unfinishedTask.complete=!1,scope.list.tasks.unshift(unfinishedTask),scope.list.completedTasks&&(scope.list.completedTasks=_.reject(scope.list.completedTasks,function(task){return task.id==unfinishedTask.id})),checkAbleToArchive())}scope.launcher=launcher,scope.list||(scope.list={},scope.isNew=!0,scope.isEditing=!0),scope.$on("addTask",function(evt,list){list===scope.list&&scope.addTask()}),scope.$on("canceledAddTask",function(){scope.cancelAddTask()}),scope.$on("createdTask",function(evt,task){task.listId===scope.list.id&&(onAddTask(task),scope.cancelAddTask())}),scope.$on("removedTask",function(evt,beDeletedTask){scope.list.tasks=_.reject(scope.list.tasks,function(task){return beDeletedTask.id==task.id})}),scope.addTask=function(){scope.isAdding=!0},scope.cancelAddTask=function(){scope.isAdding=!1},scope.edit=function(){scope.isEditing=!0},scope.cancel=function(){scope.isEditing=!1,scope.isNew&&$rootScope.$broadcast("canceledAddTaskList")},scope.editTitle=function(){scope.isEditingTitle=!0},scope.editDoneTitle=function(){scope.isEditingTitle=!1},scope.saveTitle=function(){scope.list.title?taskService.renameTaskList(launcher.gid(),scope.list.id,scope.list.title).then(function(taskList){scope.list.title=taskList.title}):scope.list.title=scope.title},scope.editDesc=function(){scope.isEditingDesc=!0},scope.editDoneDesc=function(){scope.isEditingDesc=!1},scope.saveDesc=function(){taskService.updateTaskListDesc(launcher.gid(),scope.list.id,scope.list.desc).then(function(taskList){scope.list.desc=taskList.desc})},scope.save=function(list){scope.isEditing=!1,scope.isNew?taskService.createTaskList(launcher.gid(),list.title,list.desc).then(function(taskList){scope.title=list.title,$rootScope.$broadcast("createdTaskList",taskList)}):taskService.updateTaskList(launcher.gid(),list.id,list.title,list.desc).then(function(){})},scope.remove=function(){dialogs.confirm("删除任务清单","确定要删除该任务清单？").then(function(){taskService.deleteTaskList(launcher.gid(),scope.list.id).then(function(){$rootScope.taskFlag.deletedListByCurClient=scope.list.id,$rootScope.$broadcast("removedTaskList",scope.list),launcher.getGroupRouter().forward("/tasks")})}).catch(function(){})},scope.archive=function(){scope.list.archived?dialogs.alert("任务清单","此清单还有任务没有完成，无法完成归档"):dialogs.confirm("任务清单","确定要归档该任务清单？").then(function(){taskService.archiveTaskList(launcher.gid(),scope.list.id).then(function(list){$rootScope.taskFlag.archivedListByCurClient=scope.list.id,$rootScope.$broadcast("task.archivelist",list),launcher.getGroupRouter().forward("/tasks")})}).catch(function(){})},scope.reopen=function(){scope.list.archived?dialogs.confirm("任务清单","确定要重新打开该任务清单？").then(function(){taskService.reopenTaskList(launcher.gid(),scope.list.id).then(function(list){$rootScope.$broadcast("task.reopenlist",list)})}).catch(function(){}):dialogs.alert("任务清单","此清单尚未被归档，无需重新打开")},scope.$on("socket.event."+MESSAGE_TYPE.TASK,function($evt,content,value){content.operation==TASK_OPERATION.RENAME_LIST?onRenameTaskList(new taskService.TaskList(value)):content.operation==TASK_OPERATION.UPDATE_LIST?onUpdateTaskList(new taskService.TaskList(value)):content.operation==TASK_OPERATION.CREATE_TASK?onAddTask(new taskService.Task(value)):content.operation==TASK_OPERATION.DELETE_TASK?onDeleteTask(new taskService.Task(value)):content.operation==TASK_OPERATION.FINISH_TASK?onFinishTask(new taskService.Task(value)):content.operation==TASK_OPERATION.UNFINISH_TASK&&onUnfinishTask(new taskService.Task(value))}),scope.$on("task.finish",function($evt,task){onFinishTask(task,!0)}),scope.$on("task.unfinish",function($evt,task){onUnfinishTask(task)}),scope.$watch("list",function(list){scope.title=list.title},!0)}return{restrict:"A",templateUrl:"pagelet/task/directive/taskList.html",link:link,scope:{list:"=?taskList",mode:"@",filter:"=",checkDueDate:"&",checkAssignee:"&",inAside:"@",noTaskInDefaultList:"=",isFilterOpen:"="}}}])}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("bower_components/moment/moment",factory):global.moment=factory()}(this,function(){"use strict";function utils_hooks__hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return input instanceof Date||"[object Date]"===Object.prototype.toString.call(input)}function map(arr,fn){var i,res=[];for(i=0;i<arr.length;++i)res.push(fn(arr[i],i));return res}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function extend(a,b){for(var i in b)hasOwnProp(b,i)&&(a[i]=b[i]);return hasOwnProp(b,"toString")&&(a.toString=b.toString),hasOwnProp(b,"valueOf")&&(a.valueOf=b.valueOf),a}function create_utc__createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!0).utc()}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function getParsingFlags(m){return null==m._pf&&(m._pf=defaultParsingFlags()),m._pf}function valid__isValid(m){if(null==m._isValid){var flags=getParsingFlags(m);m._isValid=!(isNaN(m._d.getTime())||!(flags.overflow<0)||flags.empty||flags.invalidMonth||flags.invalidWeekday||flags.nullInput||flags.invalidFormat||flags.userInvalidated),m._strict&&(m._isValid=m._isValid&&0===flags.charsLeftOver&&0===flags.unusedTokens.length&&void 0===flags.bigHour)}return m._isValid}function valid__createInvalid(flags){var m=create_utc__createUTC(0/0);return null!=flags?extend(getParsingFlags(m),flags):getParsingFlags(m).userInvalidated=!0,m}function copyConfig(to,from){var i,prop,val;if("undefined"!=typeof from._isAMomentObject&&(to._isAMomentObject=from._isAMomentObject),"undefined"!=typeof from._i&&(to._i=from._i),"undefined"!=typeof from._f&&(to._f=from._f),"undefined"!=typeof from._l&&(to._l=from._l),"undefined"!=typeof from._strict&&(to._strict=from._strict),"undefined"!=typeof from._tzm&&(to._tzm=from._tzm),"undefined"!=typeof from._isUTC&&(to._isUTC=from._isUTC),"undefined"!=typeof from._offset&&(to._offset=from._offset),"undefined"!=typeof from._pf&&(to._pf=getParsingFlags(from)),"undefined"!=typeof from._locale&&(to._locale=from._locale),momentProperties.length>0)for(i in momentProperties)prop=momentProperties[i],val=from[prop],"undefined"!=typeof val&&(to[prop]=val);return to}function Moment(config){copyConfig(this,config),this._d=new Date(null!=config._d?config._d.getTime():0/0),updateInProgress===!1&&(updateInProgress=!0,utils_hooks__hooks.updateOffset(this),updateInProgress=!1)}function isMoment(obj){return obj instanceof Moment||null!=obj&&null!=obj._isAMomentObject}function absFloor(number){return 0>number?Math.ceil(number):Math.floor(number)}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=absFloor(coercedNumber)),value}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;len>i;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function Locale(){}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){for(var j,next,locale,split,i=0;i<names.length;){for(split=normalizeLocale(names[i]).split("-"),j=split.length,next=normalizeLocale(names[i+1]),next=next?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&"undefined"!=typeof module&&module&&module.exports)try{oldLocale=globalLocale._abbr,require("./locale/"+name),locale_locales__getSetGlobalLocale(oldLocale)}catch(e){}return locales[name]}function locale_locales__getSetGlobalLocale(key,values){var data;return key&&(data="undefined"==typeof values?locale_locales__getLocale(key):defineLocale(key,values),data&&(globalLocale=data)),globalLocale._abbr}function defineLocale(name,values){return null!==values?(values.abbr=name,locales[name]=locales[name]||new Locale,locales[name].set(values),locale_locales__getSetGlobalLocale(name),locales[name]):(delete locales[name],null)}function locale_locales__getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return globalLocale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return chooseLocale(key)}function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return"string"==typeof units?aliases[units]||aliases[units.toLowerCase()]:void 0}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)hasOwnProp(inputObject,prop)&&(normalizedProp=normalizeUnits(prop),normalizedProp&&(normalizedInput[normalizedProp]=inputObject[prop]));return normalizedInput}function makeGetSet(unit,keepTime){return function(value){return null!=value?(get_set__set(this,unit,value),utils_hooks__hooks.updateOffset(this,keepTime),this):get_set__get(this,unit)}}function get_set__get(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function get_set__set(mom,unit,value){return mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function getSet(units,value){var unit;if("object"==typeof units)for(unit in units)this.set(unit,units[unit]);else if(units=normalizeUnits(units),"function"==typeof this[units])return this[units](value);return this}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}function addFormatToken(token,padded,ordinal,callback){var func=callback;"string"==typeof callback&&(func=function(){return this[callback]()}),token&&(formatTokenFunctions[token]=func),padded&&(formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}),ordinal&&(formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)})}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;length>i;i++)array[i]=formatTokenFunctions[array[i]]?formatTokenFunctions[array[i]]:removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;length>i;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}var i=5;for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function isFunction(sth){return"function"==typeof sth&&"[object Function]"===Object.prototype.toString.call(sth)}function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){return hasOwnProp(regexes,token)?regexes[token](config._strict,config._locale):new RegExp(unescapeFormat(token))}function unescapeFormat(s){return s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function addParseToken(token,callback){var i,func=callback;for("string"==typeof token&&(token=[token]),"number"==typeof callback&&(func=function(input,array){array[callback]=toInt(input)}),i=0;i<token.length;i++)tokens[token[i]]=func}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{},callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){null!=input&&hasOwnProp(tokens,token)&&tokens[token](input,config._a,config,token)}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function localeMonths(m){return this._months[m.month()]}function localeMonthsShort(m){return this._monthsShort[m.month()]}function localeMonthsParse(monthName,format,strict){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;12>i;i++){if(mom=create_utc__createUTC([2e3,i]),strict&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")),strict||this._monthsParse[i]||(regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"MMMM"===format&&this._longMonthsParse[i].test(monthName))return i;if(strict&&"MMM"===format&&this._shortMonthsParse[i].test(monthName))return i;if(!strict&&this._monthsParse[i].test(monthName))return i}}function setMonth(mom,value){var dayOfMonth;return"string"==typeof value&&(value=mom.localeData().monthsParse(value),"number"!=typeof value)?mom:(dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom)}function getSetMonth(value){return null!=value?(setMonth(this,value),utils_hooks__hooks.updateOffset(this,!0),this):get_set__get(this,"Month")}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}function checkOverflow(m){var overflow,a=m._a;return a&&-2===getParsingFlags(m).overflow&&(overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||24===a[HOUR]&&(0!==a[MINUTE]||0!==a[SECOND]||0!==a[MILLISECOND])?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(m)._overflowDayOfYear&&(YEAR>overflow||overflow>DATE)&&(overflow=DATE),getParsingFlags(m).overflow=overflow),m}function warn(msg){utils_hooks__hooks.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend(function(){return firstTime&&(warn(msg+"\n"+(new Error).stack),firstTime=!1),fn.apply(this,arguments)},fn)}function deprecateSimple(name,msg){deprecations[name]||(warn(msg),deprecations[name]=!0)}function configFromISO(config){var i,l,string=config._i,match=from_string__isoRegex.exec(string);if(match){for(getParsingFlags(config).iso=!0,i=0,l=isoDates.length;l>i;i++)if(isoDates[i][1].exec(string)){config._f=isoDates[i][0];break}for(i=0,l=isoTimes.length;l>i;i++)if(isoTimes[i][1].exec(string)){config._f+=(match[6]||" ")+isoTimes[i][0];break}string.match(matchOffset)&&(config._f+="Z"),configFromStringAndFormat(config)}else config._isValid=!1}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);return null!==matched?void(config._d=new Date(+matched[1])):(configFromISO(config),void(config._isValid===!1&&(delete config._isValid,utils_hooks__hooks.createFromInputFallback(config))))}function createDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return 1970>y&&date.setFullYear(y),date}function createUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return 1970>y&&date.setUTCFullYear(y),date}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function getIsLeapYear(){return isLeapYear(this.year())}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),end-7>daysToDayOfWeek&&(daysToDayOfWeek+=7),adjustedMoment=local__createLocal(mom).add(daysToDayOfWeek,"d"),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var dayOfYear,week1Jan=6+firstDayOfWeek-firstDayOfWeekOfYear,janX=createUTCDate(year,0,1+week1Jan),d=janX.getUTCDay();return firstDayOfWeek>d&&(d+=7),weekday=null!=weekday?1*weekday:firstDayOfWeek,dayOfYear=1+week1Jan+7*(week-1)-d+weekday,{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")}function defaults(a,b,c){return null!=a?a:null!=b?b:c}function currentDateArray(config){var now=new Date;return config._useUTC?[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]:[now.getFullYear(),now.getMonth(),now.getDate()]}function configFromArray(config){var i,date,currentDate,yearToUse,input=[];if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),config._dayOfYear&&(yearToUse=defaults(config._a[YEAR],currentDate[YEAR]),config._dayOfYear>daysInYear(yearToUse)&&(getParsingFlags(config)._overflowDayOfYear=!0),date=createUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;3>i&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;7>i;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];24===config._a[HOUR]&&0===config._a[MINUTE]&&0===config._a[SECOND]&&0===config._a[MILLISECOND]&&(config._nextDay=!0,config._a[HOUR]=0),config._d=(config._useUTC?createUTCDate:createDate).apply(null,input),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),config._nextDay&&(config._a[HOUR]=24)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;w=config._w,null!=w.GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(local__createLocal(),1,4).year),week=defaults(w.W,1),weekday=defaults(w.E,1)):(dow=config._locale._week.dow,doy=config._locale._week.doy,weekYear=defaults(w.gg,config._a[YEAR],weekOfYear(local__createLocal(),dow,doy).year),week=defaults(w.w,1),null!=w.d?(weekday=w.d,dow>weekday&&++week):weekday=null!=w.e?w.e+dow:dow),temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear}function configFromStringAndFormat(config){if(config._f===utils_hooks__hooks.ISO_8601)return void configFromISO(config);config._a=[],getParsingFlags(config).empty=!0;var i,parsedInput,tokens,token,skipped,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0],parsedInput&&(skipped=string.substr(0,string.indexOf(parsedInput)),skipped.length>0&&getParsingFlags(config).unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?getParsingFlags(config).empty=!1:getParsingFlags(config).unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&getParsingFlags(config).unusedTokens.push(token);getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&getParsingFlags(config).unusedInput.push(string),getParsingFlags(config).bigHour===!0&&config._a[HOUR]<=12&&config._a[HOUR]>0&&(getParsingFlags(config).bigHour=void 0),config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem),configFromArray(config),checkOverflow(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;return null==meridiem?hour:null!=locale.meridiemHour?locale.meridiemHour(hour,meridiem):null!=locale.isPM?(isPm=locale.isPM(meridiem),isPm&&12>hour&&(hour+=12),isPm||12!==hour||(hour=0),hour):hour}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return getParsingFlags(config).invalidFormat=!0,void(config._d=new Date(0/0));for(i=0;i<config._f.length;i++)currentScore=0,tempConfig=copyConfig({},config),null!=config._useUTC&&(tempConfig._useUTC=config._useUTC),tempConfig._f=config._f[i],configFromStringAndFormat(tempConfig),valid__isValid(tempConfig)&&(currentScore+=getParsingFlags(tempConfig).charsLeftOver,currentScore+=10*getParsingFlags(tempConfig).unusedTokens.length,getParsingFlags(tempConfig).score=currentScore,(null==scoreToBeat||scoreToBeat>currentScore)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}function configFromObject(config){if(!config._d){var i=normalizeObjectUnits(config._i);config._a=[i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond],configFromArray(config)}}function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));return res._nextDay&&(res.add(1,"d"),res._nextDay=void 0),res}function prepareConfig(config){var input=config._i,format=config._f;return config._locale=config._locale||locale_locales__getLocale(config._l),null===input||void 0===format&&""===input?valid__createInvalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),isMoment(input)?new Moment(checkOverflow(input)):(isArray(format)?configFromStringAndArray(config):format?configFromStringAndFormat(config):isDate(input)?config._d=input:configFromInput(config),config))}function configFromInput(config){var input=config._i;void 0===input?config._d=new Date:isDate(input)?config._d=new Date(+input):"string"==typeof input?configFromString(config):isArray(input)?(config._a=map(input.slice(0),function(obj){return parseInt(obj,10)}),configFromArray(config)):"object"==typeof input?configFromObject(config):"number"==typeof input?config._d=new Date(input):utils_hooks__hooks.createFromInputFallback(config)}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};return"boolean"==typeof locale&&(strict=locale,locale=void 0),c._isAMomentObject=!0,c._useUTC=c._isUTC=isUTC,c._l=locale,c._i=input,c._f=format,c._strict=strict,createFromConfig(c)}function local__createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!1)}function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return local__createLocal();for(res=moments[0],i=1;i<moments.length;++i)(!moments[i].isValid()||moments[i][fn](res))&&(res=moments[i]);return res}function min(){var args=[].slice.call(arguments,0);
return pickBy("isBefore",args)}function max(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=locale_locales__getLocale(),this._bubble()}function isDuration(obj){return obj instanceof Duration}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset(),sign="+";return 0>offset&&(offset=-offset,sign="-"),sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}function offsetFromString(string){var matches=(string||"").match(matchOffset)||[],chunk=matches[matches.length-1]||[],parts=(chunk+"").match(chunkOffset)||["-",0,0],minutes=+(60*parts[1])+toInt(parts[2]);return"+"===parts[0]?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;return model._isUTC?(res=model.clone(),diff=(isMoment(input)||isDate(input)?+input:+local__createLocal(input))-+res,res._d.setTime(+res._d+diff),utils_hooks__hooks.updateOffset(res,!1),res):local__createLocal(input).local()}function getDateOffset(m){return 15*-Math.round(m._d.getTimezoneOffset()/15)}function getSetOffset(input,keepLocalTime){var localAdjust,offset=this._offset||0;return null!=input?("string"==typeof input&&(input=offsetFromString(input)),Math.abs(input)<16&&(input=60*input),!this._isUTC&&keepLocalTime&&(localAdjust=getDateOffset(this)),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.add(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?add_subtract__addSubtract(this,create__createDuration(input-offset,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,utils_hooks__hooks.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?offset:getDateOffset(this)}function getSetZone(input,keepLocalTime){return null!=input?("string"!=typeof input&&(input=-input),this.utcOffset(input,keepLocalTime),this):-this.utcOffset()}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){return this._isUTC&&(this.utcOffset(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.subtract(getDateOffset(this),"m")),this}function setOffsetToParsedOffset(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(offsetFromString(this._i)),this}function hasAlignedHourOffset(input){return input=input?local__createLocal(input).utcOffset():0,(this.utcOffset()-input)%60===0}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if("undefined"!=typeof this._isDSTShifted)return this._isDSTShifted;var c={};if(copyConfig(c,this),c=prepareConfig(c),c._a){var other=c._isUTC?create_utc__createUTC(c._a):local__createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function isLocal(){return!this._isUTC}function isUtcOffset(){return this._isUTC}function isUtc(){return this._isUTC&&0===this._offset}function create__createDuration(input,key){var sign,ret,diffRes,duration=input,match=null;return isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=create__isoRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),d:parseIso(match[4],sign),h:parseIso(match[5],sign),m:parseIso(match[6],sign),s:parseIso(match[7],sign),w:parseIso(match[8],sign)}):null==duration?duration={}:"object"==typeof duration&&("from"in duration||"to"in duration)&&(diffRes=momentsDifference(local__createLocal(duration.from),local__createLocal(duration.to)),duration={},duration.ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),isDuration(input)&&hasOwnProp(input,"_locale")&&(ret._locale=input._locale),ret}function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function momentsDifference(base,other){var res;return other=cloneWithOffset(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):(res=positiveMomentsDifference(other,base),res.milliseconds=-res.milliseconds,res.months=-res.months),res}function createAdder(direction,name){return function(val,period){var dur,tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period)."),tmp=val,val=period,period=tmp),val="string"==typeof val?+val:val,dur=create__createDuration(val,period),add_subtract__addSubtract(this,dur,direction),this}}function add_subtract__addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=null==updateOffset?!0:updateOffset,milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),days&&get_set__set(mom,"Date",get_set__get(mom,"Date")+days*isAdding),months&&setMonth(mom,get_set__get(mom,"Month")+months*isAdding),updateOffset&&utils_hooks__hooks.updateOffset(mom,days||months)}function moment_calendar__calendar(time,formats){var now=time||local__createLocal(),sod=cloneWithOffset(now,this).startOf("day"),diff=this.diff(sod,"days",!0),format=-6>diff?"sameElse":-1>diff?"lastWeek":0>diff?"lastDay":1>diff?"sameDay":2>diff?"nextDay":7>diff?"nextWeek":"sameElse";return this.format(formats&&formats[format]||this.localeData().calendar(format,this,local__createLocal(now)))}function clone(){return new Moment(this)}function isAfter(input,units){var inputMs;return units=normalizeUnits("undefined"!=typeof units?units:"millisecond"),"millisecond"===units?(input=isMoment(input)?input:local__createLocal(input),+this>+input):(inputMs=isMoment(input)?+input:+local__createLocal(input),inputMs<+this.clone().startOf(units))}function isBefore(input,units){var inputMs;return units=normalizeUnits("undefined"!=typeof units?units:"millisecond"),"millisecond"===units?(input=isMoment(input)?input:local__createLocal(input),+input>+this):(inputMs=isMoment(input)?+input:+local__createLocal(input),+this.clone().endOf(units)<inputMs)}function isBetween(from,to,units){return this.isAfter(from,units)&&this.isBefore(to,units)}function isSame(input,units){var inputMs;return units=normalizeUnits(units||"millisecond"),"millisecond"===units?(input=isMoment(input)?input:local__createLocal(input),+this===+input):(inputMs=+local__createLocal(input),+this.clone().startOf(units)<=inputMs&&inputMs<=+this.clone().endOf(units))}function diff(input,units,asFloat){var delta,output,that=cloneWithOffset(input,this),zoneDelta=6e4*(that.utcOffset()-this.utcOffset());return units=normalizeUnits(units),"year"===units||"month"===units||"quarter"===units?(output=monthDiff(this,that),"quarter"===units?output/=3:"year"===units&&(output/=12)):(delta=this-that,output="second"===units?delta/1e3:"minute"===units?delta/6e4:"hour"===units?delta/36e5:"day"===units?(delta-zoneDelta)/864e5:"week"===units?(delta-zoneDelta)/6048e5:delta),asFloat?output:absFloor(output)}function monthDiff(a,b){var anchor2,adjust,wholeMonthDiff=12*(b.year()-a.year())+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months");return 0>b-anchor?(anchor2=a.clone().add(wholeMonthDiff-1,"months"),adjust=(b-anchor)/(anchor-anchor2)):(anchor2=a.clone().add(wholeMonthDiff+1,"months"),adjust=(b-anchor)/(anchor2-anchor)),-(wholeMonthDiff+adjust)}function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function moment_format__toISOString(){var m=this.clone().utc();return 0<m.year()&&m.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function format(inputString){var output=formatMoment(this,inputString||utils_hooks__hooks.defaultFormat);return this.localeData().postformat(output)}function from(time,withoutSuffix){return this.isValid()?create__createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()}function fromNow(withoutSuffix){return this.from(local__createLocal(),withoutSuffix)}function to(time,withoutSuffix){return this.isValid()?create__createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()}function toNow(withoutSuffix){return this.to(local__createLocal(),withoutSuffix)}function locale(key){var newLocaleData;return void 0===key?this._locale._abbr:(newLocaleData=locale_locales__getLocale(key),null!=newLocaleData&&(this._locale=newLocaleData),this)}function localeData(){return this._locale}function startOf(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units&&this.weekday(0),"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this}function endOf(units){return units=normalizeUnits(units),void 0===units||"millisecond"===units?this:this.startOf(units).add(1,"isoWeek"===units?"week":units).subtract(1,"ms")}function to_type__valueOf(){return+this._d-6e4*(this._offset||0)}function unix(){return Math.floor(+this/1e3)}function toDate(){return this._offset?new Date(+this):this._d}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function moment_valid__isValid(){return valid__isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}function weeksInYear(year,dow,doy){return weekOfYear(local__createLocal([year,11,31+dow-doy]),dow,doy).week}function getSetWeekYear(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==input?year:this.add(input-year,"y")}function getSetISOWeekYear(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add(input-year,"y")}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}function getSetQuarter(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)}function parseWeekday(input,locale){return"string"!=typeof input?input:isNaN(input)?(input=locale.weekdaysParse(input),"number"==typeof input?input:null):parseInt(input,10)}function localeWeekdays(m){return this._weekdays[m.day()]}function localeWeekdaysShort(m){return this._weekdaysShort[m.day()]}function localeWeekdaysMin(m){return this._weekdaysMin[m.day()]}function localeWeekdaysParse(weekdayName){var i,mom,regex;for(this._weekdaysParse=this._weekdaysParse||[],i=0;7>i;i++)if(this._weekdaysParse[i]||(mom=local__createLocal([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i}function getSetDayOfWeek(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=parseWeekday(input,this.localeData()),this.add(input-day,"d")):day}function getSetLocaleDayOfWeek(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)}function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}function matchMeridiem(isStrict,locale){return locale._meridiemParse}function localeIsPM(input){return"p"===(input+"").toLowerCase().charAt(0)}function localeMeridiem(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"}function parseMs(input,array){array[MILLISECOND]=toInt(1e3*("0."+input))}function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}function moment__createUnix(input){return local__createLocal(1e3*input)}function moment__createInZone(){return local__createLocal.apply(null,arguments).parseZone()}function locale_calendar__calendar(key,mom,now){var output=this._calendar[key];return"function"==typeof output?output.call(mom,now):output}function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];return format||!formatUpper?format:(this._longDateFormat[key]=formatUpper.replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key])}function invalidDate(){return this._invalidDate}function ordinal(number){return this._ordinal.replace("%d",number)}function preParsePostFormat(string){return string}function relative__relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)}function locale_set__set(config){var prop,i;for(i in config)prop=config[i],"function"==typeof prop?this[i]=prop:this["_"+i]=prop;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function lists__get(format,index,field,setter){var locale=locale_locales__getLocale(),utc=create_utc__createUTC().set(setter,index);return locale[field](utc,format)}function list(format,index,field,count,setter){if("number"==typeof format&&(index=format,format=void 0),format=format||"",null!=index)return lists__get(format,index,field,setter);var i,out=[];for(i=0;count>i;i++)out[i]=lists__get(format,i,field,setter);return out}function lists__listMonths(format,index){return list(format,index,"months",12,"month")}function lists__listMonthsShort(format,index){return list(format,index,"monthsShort",12,"month")}function lists__listWeekdays(format,index){return list(format,index,"weekdays",7,"day")}function lists__listWeekdaysShort(format,index){return list(format,index,"weekdaysShort",7,"day")}function lists__listWeekdaysMin(format,index){return list(format,index,"weekdaysMin",7,"day")}function duration_abs__abs(){var data=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),data.milliseconds=mathAbs(data.milliseconds),data.seconds=mathAbs(data.seconds),data.minutes=mathAbs(data.minutes),data.hours=mathAbs(data.hours),data.months=mathAbs(data.months),data.years=mathAbs(data.years),this}function duration_add_subtract__addSubtract(duration,input,value,direction){var other=create__createDuration(input,value);return duration._milliseconds+=direction*other._milliseconds,duration._days+=direction*other._days,duration._months+=direction*other._months,duration._bubble()}function duration_add_subtract__add(input,value){return duration_add_subtract__addSubtract(this,input,value,1)}function duration_add_subtract__subtract(input,value){return duration_add_subtract__addSubtract(this,input,value,-1)}function absCeil(number){return 0>number?Math.floor(number):Math.ceil(number)}function bubble(){var seconds,minutes,hours,years,monthsFromDays,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;return milliseconds>=0&&days>=0&&months>=0||0>=milliseconds&&0>=days&&0>=months||(milliseconds+=864e5*absCeil(monthsToDays(months)+days),days=0,months=0),data.milliseconds=milliseconds%1e3,seconds=absFloor(milliseconds/1e3),data.seconds=seconds%60,minutes=absFloor(seconds/60),data.minutes=minutes%60,hours=absFloor(minutes/60),data.hours=hours%24,days+=absFloor(hours/24),monthsFromDays=absFloor(daysToMonths(days)),months+=monthsFromDays,days-=absCeil(monthsToDays(monthsFromDays)),years=absFloor(months/12),months%=12,data.days=days,data.months=months,data.years=years,this}function daysToMonths(days){return 4800*days/146097}function monthsToDays(months){return 146097*months/4800}function as(units){var days,months,milliseconds=this._milliseconds;if(units=normalizeUnits(units),"month"===units||"year"===units)return days=this._days+milliseconds/864e5,months=this._months+daysToMonths(days),"month"===units?months:months/12;switch(days=this._days+Math.round(monthsToDays(this._months)),units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return 24*days+milliseconds/36e5;case"minute":return 1440*days+milliseconds/6e4;case"second":return 86400*days+milliseconds/1e3;case"millisecond":return Math.floor(864e5*days)+milliseconds;default:throw new Error("Unknown unit "+units)}}function duration_as__valueOf(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12)}function makeAs(alias){return function(){return this.as(alias)}}function duration_get__get(units){return units=normalizeUnits(units),this[units+"s"]()}function makeGetter(name){return function(){return this._data[name]}}function weeks(){return absFloor(this.days()/7)}function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function duration_humanize__relativeTime(posNegDuration,withoutSuffix,locale){var duration=create__createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),a=seconds<thresholds.s&&["s",seconds]||1===minutes&&["m"]||minutes<thresholds.m&&["mm",minutes]||1===hours&&["h"]||hours<thresholds.h&&["hh",hours]||1===days&&["d"]||days<thresholds.d&&["dd",days]||1===months&&["M"]||months<thresholds.M&&["MM",months]||1===years&&["y"]||["yy",years];return a[2]=withoutSuffix,a[3]=+posNegDuration>0,a[4]=locale,substituteTimeAgo.apply(null,a)}function duration_humanize__getSetRelativeTimeThreshold(threshold,limit){return void 0===thresholds[threshold]?!1:void 0===limit?thresholds[threshold]:(thresholds[threshold]=limit,!0)}function humanize(withSuffix){var locale=this.localeData(),output=duration_humanize__relativeTime(this,!withSuffix,locale);return withSuffix&&(output=locale.pastFuture(+this,output)),locale.postformat(output)}function iso_string__toISOString(){var minutes,hours,years,seconds=iso_string__abs(this._milliseconds)/1e3,days=iso_string__abs(this._days),months=iso_string__abs(this._months);minutes=absFloor(seconds/60),hours=absFloor(minutes/60),seconds%=60,minutes%=60,years=absFloor(months/12),months%=12;var Y=years,M=months,D=days,h=hours,m=minutes,s=seconds,total=this.asSeconds();return total?(0>total?"-":"")+"P"+(Y?Y+"Y":"")+(M?M+"M":"")+(D?D+"D":"")+(h||m||s?"T":"")+(h?h+"H":"")+(m?m+"M":"")+(s?s+"S":""):"P0D"}var hookCallback,globalLocale,momentProperties=utils_hooks__hooks.momentProperties=[],updateInProgress=!1,locales={},aliases={},formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={},match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,regexes={},tokens={},YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6;addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1}),addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)}),addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)}),addUnitAlias("month","M"),addRegexToken("M",match1to2),addRegexToken("MM",match1to2,match2),addRegexToken("MMM",matchWord),addRegexToken("MMMM",matchWord),addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1}),addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);null!=month?array[MONTH]=month:getParsingFlags(config).invalidMonth=input});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),deprecations={};utils_hooks__hooks.suppressDeprecationWarnings=!1;var from_string__isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;utils_hooks__hooks.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))}),addFormatToken(0,["YY",2],0,function(){return this.year()%100}),addFormatToken(0,["YYYY",4],0,"year"),addFormatToken(0,["YYYYY",5],0,"year"),addFormatToken(0,["YYYYYY",6,!0],0,"year"),addUnitAlias("year","y"),addRegexToken("Y",matchSigned),addRegexToken("YY",match1to2,match2),addRegexToken("YYYY",match1to4,match4),addRegexToken("YYYYY",match1to6,match6),addRegexToken("YYYYYY",match1to6,match6),addParseToken(["YYYYY","YYYYYY"],YEAR),addParseToken("YYYY",function(input,array){array[YEAR]=2===input.length?utils_hooks__hooks.parseTwoDigitYear(input):toInt(input)}),addParseToken("YY",function(input,array){array[YEAR]=utils_hooks__hooks.parseTwoDigitYear(input)}),utils_hooks__hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",!1);addFormatToken("w",["ww",2],"wo","week"),addFormatToken("W",["WW",2],"Wo","isoWeek"),addUnitAlias("week","w"),addUnitAlias("isoWeek","W"),addRegexToken("w",match1to2),addRegexToken("ww",match1to2,match2),addRegexToken("W",match1to2),addRegexToken("WW",match1to2,match2),addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});var defaultLocaleWeek={dow:0,doy:6};addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear"),addUnitAlias("dayOfYear","DDD"),addRegexToken("DDD",match1to3),addRegexToken("DDDD",match3),addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)}),utils_hooks__hooks.ISO_8601=function(){};var prototypeMin=deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var other=local__createLocal.apply(null,arguments);return this>other?this:other}),prototypeMax=deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var other=local__createLocal.apply(null,arguments);return other>this?this:other});offset("Z",":"),offset("ZZ",""),addRegexToken("Z",matchOffset),addRegexToken("ZZ",matchOffset),addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=!0,config._tzm=offsetFromString(input)});var chunkOffset=/([\+\-]|\d\d)/gi;utils_hooks__hooks.updateOffset=function(){};var aspNetRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,create__isoRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;create__createDuration.fn=Duration.prototype;var add_subtract__add=createAdder(1,"add"),add_subtract__subtract=createAdder(-1,"subtract");utils_hooks__hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){return void 0===key?this.localeData():this.locale(key)});addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100}),addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100}),addWeekYearFormatToken("gggg","weekYear"),addWeekYearFormatToken("ggggg","weekYear"),addWeekYearFormatToken("GGGG","isoWeekYear"),addWeekYearFormatToken("GGGGG","isoWeekYear"),addUnitAlias("weekYear","gg"),addUnitAlias("isoWeekYear","GG"),addRegexToken("G",matchSigned),addRegexToken("g",matchSigned),addRegexToken("GG",match1to2,match2),addRegexToken("gg",match1to2,match2),addRegexToken("GGGG",match1to4,match4),addRegexToken("gggg",match1to4,match4),addRegexToken("GGGGG",match1to6,match6),addRegexToken("ggggg",match1to6,match6),addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)}),addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=utils_hooks__hooks.parseTwoDigitYear(input)}),addFormatToken("Q",0,0,"quarter"),addUnitAlias("quarter","Q"),addRegexToken("Q",match1),addParseToken("Q",function(input,array){array[MONTH]=3*(toInt(input)-1)}),addFormatToken("D",["DD",2],"Do","date"),addUnitAlias("date","D"),addRegexToken("D",match1to2),addRegexToken("DD",match1to2,match2),addRegexToken("Do",function(isStrict,locale){return isStrict?locale._ordinalParse:locale._ordinalParseLenient}),addParseToken(["D","DD"],DATE),addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0],10)});var getSetDayOfMonth=makeGetSet("Date",!0);addFormatToken("d",0,"do","day"),addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)}),addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)}),addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)}),addFormatToken("e",0,0,"weekday"),addFormatToken("E",0,0,"isoWeekday"),addUnitAlias("day","d"),addUnitAlias("weekday","e"),addUnitAlias("isoWeekday","E"),addRegexToken("d",match1to2),addRegexToken("e",match1to2),addRegexToken("E",match1to2),addRegexToken("dd",matchWord),addRegexToken("ddd",matchWord),addRegexToken("dddd",matchWord),addWeekParseToken(["dd","ddd","dddd"],function(input,week,config){var weekday=config._locale.weekdaysParse(input);null!=weekday?week.d=weekday:getParsingFlags(config).invalidWeekday=input}),addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_");addFormatToken("H",["HH",2],0,"hour"),addFormatToken("h",["hh",2],0,function(){return this.hours()%12||12}),meridiem("a",!0),meridiem("A",!1),addUnitAlias("hour","h"),addRegexToken("a",matchMeridiem),addRegexToken("A",matchMeridiem),addRegexToken("H",match1to2),addRegexToken("h",match1to2),addRegexToken("HH",match1to2,match2),addRegexToken("hh",match1to2,match2),addParseToken(["H","HH"],HOUR),addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input),config._meridiem=input}),addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input),getParsingFlags(config).bigHour=!0});var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",!0);addFormatToken("m",["mm",2],0,"minute"),addUnitAlias("minute","m"),addRegexToken("m",match1to2),addRegexToken("mm",match1to2,match2),addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second"),addUnitAlias("second","s"),addRegexToken("s",match1to2),addRegexToken("ss",match1to2,match2),addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",!1);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)}),addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),addFormatToken(0,["SSS",3],0,"millisecond"),addFormatToken(0,["SSSS",4],0,function(){return 10*this.millisecond()}),addFormatToken(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),addFormatToken(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),addFormatToken(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),addFormatToken(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),addFormatToken(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),addUnitAlias("millisecond","ms"),addRegexToken("S",match1to3,match1),addRegexToken("SS",match1to3,match2),addRegexToken("SSS",match1to3,match3);var token;for(token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);var getSetMillisecond=makeGetSet("Milliseconds",!1);addFormatToken("z",0,0,"zoneAbbr"),addFormatToken("zz",0,0,"zoneName");var momentPrototype__proto=Moment.prototype;momentPrototype__proto.add=add_subtract__add,momentPrototype__proto.calendar=moment_calendar__calendar,momentPrototype__proto.clone=clone,momentPrototype__proto.diff=diff,momentPrototype__proto.endOf=endOf,momentPrototype__proto.format=format,momentPrototype__proto.from=from,momentPrototype__proto.fromNow=fromNow,momentPrototype__proto.to=to,momentPrototype__proto.toNow=toNow,momentPrototype__proto.get=getSet,momentPrototype__proto.invalidAt=invalidAt,momentPrototype__proto.isAfter=isAfter,momentPrototype__proto.isBefore=isBefore,momentPrototype__proto.isBetween=isBetween,momentPrototype__proto.isSame=isSame,momentPrototype__proto.isValid=moment_valid__isValid,momentPrototype__proto.lang=lang,momentPrototype__proto.locale=locale,momentPrototype__proto.localeData=localeData,momentPrototype__proto.max=prototypeMax,momentPrototype__proto.min=prototypeMin,momentPrototype__proto.parsingFlags=parsingFlags,momentPrototype__proto.set=getSet,momentPrototype__proto.startOf=startOf,momentPrototype__proto.subtract=add_subtract__subtract,momentPrototype__proto.toArray=toArray,momentPrototype__proto.toObject=toObject,momentPrototype__proto.toDate=toDate,momentPrototype__proto.toISOString=moment_format__toISOString,momentPrototype__proto.toJSON=moment_format__toISOString,momentPrototype__proto.toString=toString,momentPrototype__proto.unix=unix,momentPrototype__proto.valueOf=to_type__valueOf,momentPrototype__proto.year=getSetYear,momentPrototype__proto.isLeapYear=getIsLeapYear,momentPrototype__proto.weekYear=getSetWeekYear,momentPrototype__proto.isoWeekYear=getSetISOWeekYear,momentPrototype__proto.quarter=momentPrototype__proto.quarters=getSetQuarter,momentPrototype__proto.month=getSetMonth,momentPrototype__proto.daysInMonth=getDaysInMonth,momentPrototype__proto.week=momentPrototype__proto.weeks=getSetWeek,momentPrototype__proto.isoWeek=momentPrototype__proto.isoWeeks=getSetISOWeek,momentPrototype__proto.weeksInYear=getWeeksInYear,momentPrototype__proto.isoWeeksInYear=getISOWeeksInYear,momentPrototype__proto.date=getSetDayOfMonth,momentPrototype__proto.day=momentPrototype__proto.days=getSetDayOfWeek,momentPrototype__proto.weekday=getSetLocaleDayOfWeek,momentPrototype__proto.isoWeekday=getSetISODayOfWeek,momentPrototype__proto.dayOfYear=getSetDayOfYear,momentPrototype__proto.hour=momentPrototype__proto.hours=getSetHour,momentPrototype__proto.minute=momentPrototype__proto.minutes=getSetMinute,momentPrototype__proto.second=momentPrototype__proto.seconds=getSetSecond,momentPrototype__proto.millisecond=momentPrototype__proto.milliseconds=getSetMillisecond,momentPrototype__proto.utcOffset=getSetOffset,momentPrototype__proto.utc=setOffsetToUTC,momentPrototype__proto.local=setOffsetToLocal,momentPrototype__proto.parseZone=setOffsetToParsedOffset,momentPrototype__proto.hasAlignedHourOffset=hasAlignedHourOffset,momentPrototype__proto.isDST=isDaylightSavingTime,momentPrototype__proto.isDSTShifted=isDaylightSavingTimeShifted,momentPrototype__proto.isLocal=isLocal,momentPrototype__proto.isUtcOffset=isUtcOffset,momentPrototype__proto.isUtc=isUtc,momentPrototype__proto.isUTC=isUtc,momentPrototype__proto.zoneAbbr=getZoneAbbr,momentPrototype__proto.zoneName=getZoneName,momentPrototype__proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth),momentPrototype__proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth),momentPrototype__proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear),momentPrototype__proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",getSetZone);
var momentPrototype=momentPrototype__proto,defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},defaultInvalidDate="Invalid date",defaultOrdinal="%d",defaultOrdinalParse=/\d{1,2}/,defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},prototype__proto=Locale.prototype;prototype__proto._calendar=defaultCalendar,prototype__proto.calendar=locale_calendar__calendar,prototype__proto._longDateFormat=defaultLongDateFormat,prototype__proto.longDateFormat=longDateFormat,prototype__proto._invalidDate=defaultInvalidDate,prototype__proto.invalidDate=invalidDate,prototype__proto._ordinal=defaultOrdinal,prototype__proto.ordinal=ordinal,prototype__proto._ordinalParse=defaultOrdinalParse,prototype__proto.preparse=preParsePostFormat,prototype__proto.postformat=preParsePostFormat,prototype__proto._relativeTime=defaultRelativeTime,prototype__proto.relativeTime=relative__relativeTime,prototype__proto.pastFuture=pastFuture,prototype__proto.set=locale_set__set,prototype__proto.months=localeMonths,prototype__proto._months=defaultLocaleMonths,prototype__proto.monthsShort=localeMonthsShort,prototype__proto._monthsShort=defaultLocaleMonthsShort,prototype__proto.monthsParse=localeMonthsParse,prototype__proto.week=localeWeek,prototype__proto._week=defaultLocaleWeek,prototype__proto.firstDayOfYear=localeFirstDayOfYear,prototype__proto.firstDayOfWeek=localeFirstDayOfWeek,prototype__proto.weekdays=localeWeekdays,prototype__proto._weekdays=defaultLocaleWeekdays,prototype__proto.weekdaysMin=localeWeekdaysMin,prototype__proto._weekdaysMin=defaultLocaleWeekdaysMin,prototype__proto.weekdaysShort=localeWeekdaysShort,prototype__proto._weekdaysShort=defaultLocaleWeekdaysShort,prototype__proto.weekdaysParse=localeWeekdaysParse,prototype__proto.isPM=localeIsPM,prototype__proto._meridiemParse=defaultLocaleMeridiemParse,prototype__proto.meridiem=localeMeridiem,locale_locales__getSetGlobalLocale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),utils_hooks__hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",locale_locales__getSetGlobalLocale),utils_hooks__hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",locale_locales__getLocale);var mathAbs=Math.abs,asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asYears=makeAs("y"),milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years"),round=Math.round,thresholds={s:45,m:45,h:22,d:26,M:11},iso_string__abs=Math.abs,duration_prototype__proto=Duration.prototype;duration_prototype__proto.abs=duration_abs__abs,duration_prototype__proto.add=duration_add_subtract__add,duration_prototype__proto.subtract=duration_add_subtract__subtract,duration_prototype__proto.as=as,duration_prototype__proto.asMilliseconds=asMilliseconds,duration_prototype__proto.asSeconds=asSeconds,duration_prototype__proto.asMinutes=asMinutes,duration_prototype__proto.asHours=asHours,duration_prototype__proto.asDays=asDays,duration_prototype__proto.asWeeks=asWeeks,duration_prototype__proto.asMonths=asMonths,duration_prototype__proto.asYears=asYears,duration_prototype__proto.valueOf=duration_as__valueOf,duration_prototype__proto._bubble=bubble,duration_prototype__proto.get=duration_get__get,duration_prototype__proto.milliseconds=milliseconds,duration_prototype__proto.seconds=seconds,duration_prototype__proto.minutes=minutes,duration_prototype__proto.hours=hours,duration_prototype__proto.days=days,duration_prototype__proto.weeks=weeks,duration_prototype__proto.months=months,duration_prototype__proto.years=years,duration_prototype__proto.humanize=humanize,duration_prototype__proto.toISOString=iso_string__toISOString,duration_prototype__proto.toString=iso_string__toISOString,duration_prototype__proto.toJSON=iso_string__toISOString,duration_prototype__proto.locale=locale,duration_prototype__proto.localeData=localeData,duration_prototype__proto.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",iso_string__toISOString),duration_prototype__proto.lang=lang,addFormatToken("X",0,0,"unix"),addFormatToken("x",0,0,"valueOf"),addRegexToken("x",matchSigned),addRegexToken("X",matchTimestamp),addParseToken("X",function(input,array,config){config._d=new Date(1e3*parseFloat(input,10))}),addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))}),utils_hooks__hooks.version="2.10.6",setHookCallback(local__createLocal),utils_hooks__hooks.fn=momentPrototype,utils_hooks__hooks.min=min,utils_hooks__hooks.max=max,utils_hooks__hooks.utc=create_utc__createUTC,utils_hooks__hooks.unix=moment__createUnix,utils_hooks__hooks.months=lists__listMonths,utils_hooks__hooks.isDate=isDate,utils_hooks__hooks.locale=locale_locales__getSetGlobalLocale,utils_hooks__hooks.invalid=valid__createInvalid,utils_hooks__hooks.duration=create__createDuration,utils_hooks__hooks.isMoment=isMoment,utils_hooks__hooks.weekdays=lists__listWeekdays,utils_hooks__hooks.parseZone=moment__createInZone,utils_hooks__hooks.localeData=locale_locales__getLocale,utils_hooks__hooks.isDuration=isDuration,utils_hooks__hooks.monthsShort=lists__listMonthsShort,utils_hooks__hooks.weekdaysMin=lists__listWeekdaysMin,utils_hooks__hooks.defineLocale=defineLocale,utils_hooks__hooks.weekdaysShort=lists__listWeekdaysShort,utils_hooks__hooks.normalizeUnits=normalizeUnits,utils_hooks__hooks.relativeTimeThreshold=duration_humanize__getSetRelativeTimeThreshold;var _moment=utils_hooks__hooks;return _moment}),define("pagelet/task/directive/taskItem",["bower_components/moment/moment"],function(moment){return function(module){module.directive("taskItem",["$rootScope","$timeout","$compile","taskService","members","launcher","dialogService","router","groupService","MESSAGE_TYPE","TASK_OPERATION",function($rootScope,$timeout,$compile,taskService,memberService,launcher,dialogs,router,groupService,MESSAGE_TYPE,TASK_OPERATION){function link(scope){function onFinishTask(task){scope.task&&scope.task.id==task.id&&(scope.task.complete=!0,scope.isTogglingComplete=!0,$timeout(function(){scope.isTogglingComplete=!1},1e4))}function onUnfinishTask(task){scope.task&&scope.task.id==task.id&&(scope.task.complete=!1,scope.isTogglingComplete=!0,$timeout(function(){scope.isTogglingComplete=!1},1e4))}function onRenameTask(task){scope.task&&scope.task.id==task.id&&(scope.title=scope.task.title=task.title)}function onUpdateTask(task){scope.task&&scope.task.id==task.id&&(scope.task=_.extend(scope.task,task))}function onCommentTask(){}function onUpdateTaskFinishTime(){}function onAssignTask(){}function onChangeTaskPriority(){}scope.launcher=launcher,scope.task||(scope.task={},scope.isNew=!0,scope.isEditing=!0),scope.edit=function(){scope.isEditing=!0},scope.cancel=function(){scope.isEditing=!1,scope.isNew&&$rootScope.$broadcast("canceledAddTask"),"add"===scope.prevMode&&(scope.mode="add")},scope.saveTitle=function(){scope.task.title?taskService.renameTask(scope.task.gid,scope.task.id,scope.task.title).then(function(task){scope.title=scope.task.title=task.title}):scope.task.title=scope.title},scope.save=function(){scope.task&&(scope.isAdding=!0,scope.isEditing=!1,scope.isNew&&taskService.createTask(launcher.gid(),scope.listId||-1,scope.task.title,scope.task.priority,scope.task.executor&&scope.task.executor.userId,scope.task.expectFinishTime&&scope.task.expectFinishTime.getTime()).then(function(task){scope.title=scope.task.title,$rootScope.$broadcast("createdTask",task),scope.isAdding=!1,scope.task={}},function(){scope.isAdding=!1}))},scope.remove=function(){var oriTask=scope.task;dialogs.confirm("删除任务","确定要删除该任务？").then(function(){taskService.deleteTask(oriTask.gid,oriTask.id).then(function(){$rootScope.taskFlag.deletedTaskByCurClient=oriTask.id,$rootScope.$broadcast("removedTask",oriTask),"myTasks"==scope.taskMode?router.forward("/tasks"):launcher.getGroupRouter().forward("/tasks")},function(){})}).catch(function(){})},scope.toggleComplete=function(){scope.task.complete?(scope.task.complete=!1,$rootScope.$broadcast("task.unfinish",scope.task),taskService.unFinishTask(scope.task.gid,scope.task.id).then(function(){$rootScope.$broadcast("task.update",scope.task)},function(){scope.task.complete=!0,$rootScope.$broadcast("task.unfinish.fail",scope.task)})):(scope.task.complete=!0,$rootScope.$broadcast("task.finish",scope.task),taskService.finishTask(scope.task.gid,scope.task.id).then(function(){$rootScope.$broadcast("task.update",scope.task)},function(){scope.task.complete=!1,$rootScope.$broadcast("task.finish.fail",scope.task)}))},scope.getMembers=function(){return memberService.getMembers()},scope.changePriority=function(priority){scope.isNew?scope.task.priority=priority:taskService.changeTaskPriority(scope.task.gid,scope.task.id,priority).then(function(task){task.priority=priority,scope.task=_.extend(scope.task,task),$rootScope.$broadcast("task.update",scope.task)})},scope.changeAssignee=function(member){var userId=member?member.userId:"";scope.isNew?scope.task.executor=member||null:taskService.changeTaskExecutor(scope.task.gid,scope.task.id,userId).then(function(task){task.executor=member||null,scope.task=_.extend(scope.task,task),$rootScope.$broadcast("task.update",scope.task)})},scope.editTitle=function(){scope.isEditingTitle=!0},scope.editDoneTitle=function(){scope.isEditingTitle=!1},scope.tab="comments",scope.minDate=moment(),scope.$on("task.update",function(evt,task){task.id===scope.task.id&&(scope.task=_.extend(scope.task,task))});var hidePicker=!1;scope.$on("hidePicker",function(){hidePicker=!0}),scope.preventDatePickerHide=function($event){return hidePicker?(scope.task.expectFinishTime=scope.task.selectedFinishTime.toDate(),scope.isNew||taskService.changeTaskTime(scope.task.gid,scope.task.id,scope.task.expectFinishTime.getTime()).then(function(){$rootScope.$broadcast("task.update",scope.task)}),void(hidePicker=!1)):void $event.stopPropagation()},scope.getOperationList=function(){taskService.getTaskOp(scope.task.gid,scope.task.id).then(function(operationList){operationList.length!==scope.task.operations.length&&(scope.task.operations=operationList)})},scope.isOverdue=function(time){if(!time||"true"===scope.inComplete||"readOnly"==scope.mode&&!scope.taskMode)return!1;var today=new Date;return today.setHours(0),today.setMinutes(0),today.setSeconds(0),today.setMilliseconds(0),today>time?!0:!1},scope.$on("socket.event."+MESSAGE_TYPE.TASK,function($evt,content,value){content.operation==TASK_OPERATION.FINISH_TASK?onFinishTask(new taskService.Task(value)):content.operation==TASK_OPERATION.UNFINISH_TASK?onUnfinishTask(new taskService.Task(value)):content.operation==TASK_OPERATION.RENAME_TASK?onRenameTask(new taskService.Task(value)):content.operation==TASK_OPERATION.UPDATE_TASK?onUpdateTask(new taskService.Task(value)):content.operation==TASK_OPERATION.COMMENT_TASK?onCommentTask(new taskService.Task(value)):content.operation==TASK_OPERATION.UPDATE_TASK_EXPIRE?onUpdateTaskFinishTime(new taskService.Task(value)):content.operation==TASK_OPERATION.ASSIGN_TASK?onAssignTask(new taskService.Task(value)):content.operation==TASK_OPERATION.CHANGE_TASK_PRIORITY&&onChangeTaskPriority(new taskService.Task(value))}),scope.$on("task.finish",function($evt,task){onFinishTask(task)}),scope.$on("task.unfinish.fail",function($evt,task){onFinishTask(task)}),scope.$on("task.unfinish",function($evt,task){onUnfinishTask(task)}),scope.$on("task.finish.fail",function($evt,task){onUnfinishTask(task)}),scope.$watch("task",function(task){scope.title=task.title},!0)}return{restrict:"A",templateUrl:"pagelet/task/directive/taskItem.html",link:link,scope:{task:"=?taskItem",mode:"@",focus:"=?",taskMode:"@",listId:"=?",inComplete:"@"}}}])}}),define("pagelet/task/directive/taskAside",[],function(){return function(module){module.directive("taskAside",["$rootScope","launcher","taskService","router","MESSAGE_TYPE","TASK_OPERATION","dialogService","taskComparator",function($rootScope,launcher,taskService,router,MESSAGE_TYPE,TASK_OPERATION,dialogs,comparator){function link(scope){function onArchiveTaskList(list){scope.list&&scope.list.id==list.id&&$rootScope.taskFlag.archivedListByCurClient!==list.id&&dialogs.alert("任务清单",list.archiver?"该任务清单已被"+list.archiver+"归档":"该任务清单已被归档").then(function(){scope.show=!1;var groupRouter=launcher.getGroupRouter();groupRouter.forward("/tasks")})}function onRemoveTaskList(list){scope.list&&scope.list.id==list.id&&$rootScope.taskFlag.deletedListByCurClient!==list.id&&dialogs.alert("任务清单","该任务清单已被删除").then(function(){scope.show=!1;var groupRouter=launcher.getGroupRouter();groupRouter.forward("/tasks")})}function onDeleteTask(task){scope.task&&scope.task.id==task.id&&$rootScope.taskFlag.deletedTaskByCurClient!==task.id&&dialogs.alert("任务","该任务已被删除").then(function(){scope.show=!1,scope.close()})}scope.launcher=launcher,comparator.type("createTimeDesc"),$rootScope.$on("task.aside.task",function($evt,taskId,mode){scope.asideMode=mode,scope.list=!1;var groupId="myTasks"==mode?taskId.split("-")[2]:launcher.gid();taskService.getTask(groupId,taskId.split("-")[1]).then(function(task){scope.show=!0,scope.task=task,taskService.getTaskOp(groupId,taskId.split("-")[1]).then(function(operationList){scope.task.operations=operationList})},function(e){switch(scope.show=!1,e.error){case"208":dialogs.alert("打开任务","任务已被删除");break;default:dialogs.alert("打开任务","打开任务失败")}var groupRouter=launcher.getGroupRouter();groupRouter.forward("/tasks")})}),$rootScope.$on("task.aside.taskList",function($evt,listId,mode){scope.asideMode=mode,scope.task=!1;var gid=launcher.gid();if("-1"==listId){var list=new taskService.TaskList({id:-1,groupId:launcher.gid(),createTime:new Date(1894440390564)});scope.list=list,taskService.getTasks(gid,listId).then(function(tasks){scope.show=!0;var unfinishedTasks=_.filter(tasks,function(task){return!task.complete}),completedTasks=_.filter(tasks,function(task){return task.complete});scope.list.tasks=unfinishedTasks.sort(comparator),scope.list.completedTasks=completedTasks.sort(comparator),scope.list.ableToArchive=scope.list.completedTasks.length>0&&0==scope.list.tasks.length?!0:!1},function(){scope.show=!1;var groupRouter=launcher.getGroupRouter();groupRouter.forward("/tasks")})}else taskService.getTaskList(gid,listId).then(function(list){scope.show=!0,scope.list=list,taskService.getTaskListOp(gid,listId).then(function(operationList){scope.list.operations=operationList}),taskService.getTasks(gid,listId).then(function(tasks){var unfinishedTasks=_.filter(tasks,function(task){return!task.complete}),completedTasks=_.filter(tasks,function(task){return task.complete});scope.list.tasks=unfinishedTasks.sort(comparator),scope.list.completedTasks=completedTasks.sort(comparator),scope.list.ableToArchive=scope.list.completedTasks.length>0&&0==scope.list.tasks.length?!0:!1})},function(e){switch(scope.show=!1,e.error){case"51300":dialogs.alert("打开任务清单","清单已被删除");break;default:dialogs.alert("打开任务清单","打开任务清单失败")}var groupRouter=launcher.getGroupRouter();groupRouter.forward("/tasks")})}),router.before(function(){scope.show=!1,scope.task={}}),scope.close=function(){scope.task={},history.back()},scope.$on("socket.event."+MESSAGE_TYPE.TASK,function($evt,content,value){content.operation==TASK_OPERATION.DELETE_LIST?onRemoveTaskList(new taskService.TaskList(value)):content.operation==TASK_OPERATION.ARCHIVE_LIST?onArchiveTaskList(new taskService.TaskList(value)):content.operation==TASK_OPERATION.DELETE_TASK&&onDeleteTask(new taskService.Task(value))})}return{restrict:"A",templateUrl:"pagelet/task/directive/taskAside.html",link:link,scope:{}}}])}}),define("pagelet/task/msg/messageCtrl",[],function(){return function(module){module.controller("taskMessageCtrl",["$scope","launcher",function($scope,launcher){function ChatUser(json){this.userId=json.userId,this.name=json.name?String(json.name):void 0,this.photo=json.photo?String(json.photo):void 0}function TaskMessage(json){this.type=17,this.id=json.id?Number(json.id):void 0,this.groupId=json.groupId?Number(json.groupId):void 0,this.longInterval=Boolean(json.longInterval),this.time=json.time?Number(json.time):void 0,this.expectFinishTime=json.expectFinishTime?Number(json.expectFinishTime):void 0,this.user=new ChatUser(json.user),this.operation=String(json.operation),this.title=json.title?String(json.title):"无标题任务/清单",this.taskListId=json.taskListId?Number(json.taskListId):void 0,this.taskId=json.taskId?Number(json.taskId):void 0,this.link="/group/"+launcher.gid()+"/tasks/"+(json.taskId?"task-"+this.taskId:"list-"+this.taskListId)}var taskMsg=$scope.message.data;$scope.message=new TaskMessage(taskMsg)}])}}),define("pagelet/task/tasksCtrl",["underscore"],function(_){return function(module){module.controller("tasksCtrl",["$scope","$q","$filter","$timeout","taskService","launcher","members","MESSAGE_TYPE","TASK_OPERATION","taskComparator",function($scope,$q,$filter,$timeout,taskService,launcher,memberService,MESSAGE_TYPE,TASK_OPERATION,comparator){function onOpen(){return $q.when(null)}function onInvoke(){return $q.when(null)}function onClose(){return $q.when(null)}function init(){$scope.launcher=launcher,$q.all([taskService.getTaskLists(launcher.gid()),taskService.getTasks(launcher.gid())]).then(function(res){var taskLists=res[0],tasks=res[1],defaultTaskList=new taskService.TaskList({id:-1,groupId:launcher.gid(),createTime:new Date(1894440390564)});taskLists.unshift(defaultTaskList),taskLists=_.reject(taskLists,function(list){return list.archived}),_.each(tasks,function(v){var taskList=_.findWhere(taskLists,{id:v.listId});taskList&&(v.complete?taskList.completedTasks.push(v):taskList.tasks.push(v))}),_.each(taskLists,function(list){list.tasks=list.tasks.sort(comparator),list.completedTasks=list.completedTasks.sort(comparator)}),$scope.lists=taskLists.sort(comparator),$scope.filteredLists=[]}),filter=$scope.filter={assignee:"",dueDate:""}}function checkAssignee(executor,condition){if(!condition)return!0;if("all"==condition.userId)return!0;if(!executor)return"unassigned"===condition.userId?!0:!1;if(condition.userId===executor.userId)return!0;switch(condition.userId){case"myself":return launcher.uid()===executor.userId;case"all":return!!executor.userId;case"unassigned":return void 0===executor}return!1}function checkDueDate(expectFinishTime,condition){if(!condition)return!0;if(!expectFinishTime&&"notset"==condition)return!0;if(!expectFinishTime)return!1;var now=new Date;now.setHours(0),now.setMinutes(0),now.setSeconds(0),now.setMilliseconds(0);var startDate=new Date(now);switch(condition){case"today":return now.toDateString()===expectFinishTime.toDateString();case"thisweek":return expectFinishTime<(new Date).setDate(startDate.getDate()+7-now.getDay())&&expectFinishTime>=startDate;case"delay":return startDate>expectFinishTime}}function onAddTaskList(list){list.groupId!=$scope.lists[0].groupId||_.findWhere($scope.lists,{id:list.id})||$scope.lists.splice(1,0,list)}function onRemoveTaskList(list){$scope.isFilterOpen?$scope.filteredLists=_.reject($scope.filteredLists,function(v){return v.id===list.id}):$scope.lists=_.reject($scope.lists,function(v){return v.id===list.id})}var filter;$scope.$open(onOpen),$scope.$invoke(onInvoke),$scope.$close(onClose),comparator.type("createTimeDesc"),init(),$scope.$on("group.changed",function(evt,gid){gid&&init()}),$scope.$on("createdTask",function(evt,task){var list=_.findWhere($scope.lists,{id:task.listId});list&&!_.findWhere(list.tasks,{id:task.id})&&list.tasks.unshift(task)}),$scope.$watchCollection("filter",function(){filter.assignee||filter.dueDate?($scope.filteredLists=_.map($scope.lists,function(list){var tasks=_.filter(list.tasks,function(task){return checkAssignee(task.executor,filter.assignee)&&checkDueDate(task.expectFinishTime,filter.dueDate)}),listCopy=_.clone(list);return listCopy.tasks=tasks,listCopy}),$scope.isFilterOpen=!0):$scope.isFilterOpen=!1}),$scope.$on("canceledAddTaskList",function(){$scope.isAdding=!1}),$scope.$on("createdTaskList",function(evt,list){$scope.isAdding=!1,list.groupId!=$scope.lists[0].groupId||_.findWhere($scope.lists,{id:list.id})||$scope.lists.splice(1,0,list),$scope.triggerAddTask(list)}),$scope.$on("removedTaskList",function(evt,list){onRemoveTaskList(list)}),$scope.$on("task.archivelist",function($evt,list){onRemoveTaskList(list)}),$scope.$on("task.reopenlist",function($evt,list){onAddTaskList(list)}),$scope.$on("socket.event."+MESSAGE_TYPE.TASK,function($evt,content,value){content.operation==TASK_OPERATION.CREATE_LIST||content.operation==TASK_OPERATION.REOPEN_TASK_LIST?onAddTaskList(new taskService.TaskList(value)):(content.operation==TASK_OPERATION.DELETE_LIST||content.operation==TASK_OPERATION.ARCHIVE_LIST)&&onRemoveTaskList(new taskService.TaskList(value))}),$scope.getMembers=function(){return _.filter(memberService.getMembers(),function(member){return member.userId!==launcher.uid()})},$scope.addTaskList=function(){$scope.isAdding=!0},$scope.triggerAddTask=function(list){list||(list=$scope.isFilterOpen?$scope.filteredLists[0]:$scope.lists[0]),$timeout(function(){$scope.$broadcast("addTask",list)})},$scope.resetFilter=function(){filter.assignee=null,filter.dueDate=null,$scope.isFilterOpen=!1},$scope.checkDueDate=checkDueDate,$scope.checkAssignee=checkAssignee}])}}),define("pagelet/task/myTasksCtrl",["underscore"],function(_){return function(module){module.controller("myTasksCtrl",["$scope","launcher","taskService","$filter","MESSAGE_TYPE","TASK_OPERATION","$timeout",function($scope,launcher,taskService,$filter,MESSAGE_TYPE,TASK_OPERATION,$timeout){function filterTasks(tasks){var noExpectFinishTime=[];$scope.todayTasks=[],$scope.thisweekTasks=[],$scope.nextTasks=[],_.each(tasks,function(task){task.expectFinishTime?"today"==checkDueDate(task.expectFinishTime)?$scope.todayTasks.push(task):"thisweek"==checkDueDate(task.expectFinishTime)?$scope.thisweekTasks.push(task):"next"==checkDueDate(task.expectFinishTime)&&$scope.nextTasks.push(task):noExpectFinishTime.push(task)}),$scope.todayTasks=orderBy($scope.todayTasks,"expectFinishTime",!1),$scope.thisweekTasks=orderBy($scope.thisweekTasks,"expectFinishTime",!1),$scope.nextTasks=orderBy($scope.nextTasks,"expectFinishTime",!1),noExpectFinishTime=orderBy(noExpectFinishTime,"createTime",!0),$scope.nextTasks=$scope.nextTasks.concat(noExpectFinishTime)}function checkDueDate(expectFinishTime){var now=new Date;return $filter("date")(now,"yyyy-MM-dd")>=$filter("date")(new Date(expectFinishTime),"yyyy-MM-dd")?"today":expectFinishTime<(new Date).setDate(now.getDate()+7-now.getDay())&&expectFinishTime.getTime()>now.getTime()?"thisweek":"next"}function onUpdateTask(updateTask){var task=_.findWhere($scope.tasks,{id:updateTask.id});if(task){var userId=launcher.getUser().userId;_.isUndefined(userId)||""==updateTask.executorId||userId==updateTask.executorId?task=_.extend(task,updateTask):$scope.tasks=_.reject($scope.tasks,function(task){return task.id==updateTask.id}),filterTasks($scope.tasks)}}function onDeleteTask(deletedTask){_.findWhere($scope.tasks,{id:deletedTask.id})&&($scope.tasks=_.reject($scope.tasks,function(task){return task.id==deletedTask.id}),filterTasks($scope.tasks))}function onFinishTask(finishedTask){_.findWhere($scope.tasks,{id:finishedTask.id})&&$timeout(function(){$scope.tasks=_.reject($scope.tasks,function(task){return task.id==finishedTask.id}),filterTasks($scope.tasks)},5e3)}function onUnfinishTask(unfinishedTask){_.findWhere($scope.tasks,{id:unfinishedTask.id})||($scope.tasks.push(unfinishedTask),filterTasks($scope.tasks))}$scope.$open(function(){taskService.allOfMe().then(function(tasks){$scope.tasks=tasks,filterTasks(tasks)})}),$scope.$invoke(function(){}),$scope.$close(function(){});var orderBy=$filter("orderBy");$scope.$on("socket.event."+MESSAGE_TYPE.TASK,function($evt,content,value){content.operation==TASK_OPERATION.UPDATE_TASK?onUpdateTask(new taskService.Task(value)):content.operation==TASK_OPERATION.DELETE_TASK?onDeleteTask(new taskService.Task(value)):content.operation==TASK_OPERATION.FINISH_TASK?onFinishTask(new taskService.Task(value)):content.operation==TASK_OPERATION.UNFINISH_TASK&&onUnfinishTask(new taskService.Task(value))})}])}}),define("pagelet/task/filters",[],function(){return function(module){module.filter("dateInRange",["$filter",function($filter){var $date=$filter("date");return function(date,range){var date=Date.parse(date);if(!date)return!1;var today=Date.now();if("today"===range){var fmt="yyyyMMdd";return $date(date,fmt)===$date(today,fmt)}if("thisweek"===range){var fmt="yyyyw";return $date(date,fmt)===$date(today,fmt)}if("delay"===range){var fmt="yyyyMMdd";return $date(date,fmt)<$date(today,fmt)}throw new Error("unsupported range "+range)}}]),module.filter("searchTasksInLists",["$filter",function($filter){var $dateInRange=$filter("dateInRange");return function(lists,filter){return console.log("ff"),lists.map(function(list){var newList=angular.copy(list);return newList.tasks=newList.tasks.filter(function(task){return filter.assignee&&task.assignee!==filter.assignee?!1:filter.dueDate&&!$dateInRange(task.dueDate,filter.dueDate)?!1:!0}),newList}).filter(function(list){return list.tasks.length})}}])}}),define("pagelet/task/archivedTasksCtrl",["underscore"],function(_){return function(module){module.controller("archivedTasksCtrl",["$scope","$q","launcher","taskService","$filter","MESSAGE_TYPE","TASK_OPERATION",function($scope,$q,launcher,taskService,$filter,MESSAGE_TYPE,TASK_OPERATION){function onArchiveTaskList(taskList){taskList&&!_.findWhere($scope.archivedTaskLists,{id:taskList.id})&&taskService.getTasks(launcher.getGroup().id,taskList.id).then(function(tasks){taskList.tasks=tasks,$scope.archivedTaskLists.push(taskList)})}function onRemoveTaskList(taskList){$scope.archivedTaskLists=_.reject($scope.archivedTaskLists,function(list){return list.id==taskList.id})}$scope.$open(function(){{var archivedTaskLists=[],tasks=[];$filter("orderBy")}$q.all([taskService.getArchivedTaskList(launcher.gid()),taskService.getTasks(launcher.gid())]).then(function(res){archivedTaskLists=res[0],tasks=res[1],archivedTaskLists.length>0&&_.each(tasks,function(v){var taskList=_.findWhere(archivedTaskLists,{id:v.listId});taskList&&taskList.tasks.push(v)}),$scope.archivedTaskLists=archivedTaskLists})}),$scope.$invoke(function(){}),$scope.$close(function(){}),$scope.$on("socket.event."+MESSAGE_TYPE.TASK,function($evt,content,value){content.operation==TASK_OPERATION.ARCHIVE_LIST?onArchiveTaskList(new taskService.TaskList(value)):(content.operation==TASK_OPERATION.REOPEN_TASK_LIST||content.operation==TASK_OPERATION.DELETE_LIST)&&onRemoveTaskList(new taskService.TaskList(value))}),$scope.$on("task.archivelist",function($evt,taskList){onArchiveTaskList(taskList)}),$scope.$on("task.reopenlist",function($evt,taskList){onRemoveTaskList(taskList)}),$scope.$on("removedTaskList",function($evt,taskList){onRemoveTaskList(taskList)})}])}}),define("pagelet/task/directive/taskOperation",[],function(){return function(module){module.directive("taskOperation",["$rootScope","taskService","launcher",function(){function link(){}return{restrict:"A",templateUrl:"pagelet/task/directive/taskOperation.html",link:link,scope:{operation:"=?taskOperation"}}}])}}),define("pagelet/task/directive/operation",[],function(){return function(module){module.directive("operation",["$rootScope","taskService","launcher","TASK_OPERATION",function($rootScope,taskService,launcher,TASK_OPERATION){function link(scope,element){scope.operation.op==TASK_OPERATION.COMMENT_LIST?element.html('评论了清单 "'+scope.operation.msg+'"'):scope.operation.op==TASK_OPERATION.COMMENT_TASK?element.html("评论了任务"):scope.operation.op==TASK_OPERATION.CREATE_LIST?element.html('新建了任务清单 "'+scope.operation.msg+'"'):scope.operation.op==TASK_OPERATION.CREATE_TASK?element.html('新建了任务  "'+scope.operation.msg+'"'):scope.operation.op==TASK_OPERATION.DELETE_LIST?element.html('删除了清单  "'+scope.operation.msg+'"'):scope.operation.op==TASK_OPERATION.DELETE_TASK?element.html('删除了任务 "'+scope.operation.msg+'"'):scope.operation.op==TASK_OPERATION.ARCHIVE_LIST?element.html("归档了清单"):scope.operation.op==TASK_OPERATION.UPDATE_LIST?element.html("修改了清单描述"):scope.operation.op==TASK_OPERATION.UPDATE_TASK?element.html("更新了任务  "+scope.operation.msg):scope.operation.op==TASK_OPERATION.FINISH_TASK?element.html('完成了任务 "'+scope.operation.msg+'"'):scope.operation.op==TASK_OPERATION.UNFINISH_TASK?element.html('重新打开了任务 "'+scope.operation.msg+'"'):scope.operation.op==TASK_OPERATION.UPDATE_TASK_EXPIRE?element.html("修改了任务截止日期"):scope.operation.op==TASK_OPERATION.ASSIGN_TASK?element.html("将任务指派给 "+scope.operation.targetUserId):scope.operation.op==TASK_OPERATION.CHANGE_TASK_PRIORITY?element.html("将任务优先级调整为  "+("1"==scope.operation.msg?"紧急":"普通")):scope.operation.op==TASK_OPERATION.RENAME_TASK?element.html('修改了任务名称为 "'+scope.operation.msg+'"'):scope.operation.op==TASK_OPERATION.RENAME_LIST?element.html('修改了清单名称为 "'+scope.operation.msg+'"'):scope.operation.op==TASK_OPERATION.REOPEN_TASK_LIST&&element.html("重新打开了清单")}return{restrict:"A",link:link,scope:{operation:"="}}}])}}),define("pagelet/task/comparator",["underscore","bower_components/util/src/stringComparator"],function(_){"use strict";var comparators={createTimeAsc:function(f1,f2){var t1=f1.createTime.getTime(),t2=f2.createTime.getTime();return t1!==t2?t1-t2:0},createTimeDesc:function(f1,f2){var t1=f1.createTime.getTime(),t2=f2.createTime.getTime();return t2!==t1?t2-t1:0}};return function(){function compare(f1,f2){return comparators[sortType](f1,f2)}function getterOrSetter(type){return type?void(_.isFunction(comparators[type])&&(sortType=type)):sortType}var sortType=_.isUndefined(sortType)?"createTimeDesc":sortType;return _.extend(compare,{type:getterOrSetter})}}),define("taskModule",["underscore","angular","commonModule","angularDatepicker","pagelet/task/taskService","pagelet/task/directive/taskList","pagelet/task/directive/taskItem","pagelet/task/directive/taskAside","pagelet/task/msg/messageCtrl","pagelet/task/tasksCtrl","pagelet/task/myTasksCtrl","pagelet/task/filters","pagelet/task/archivedTasksCtrl","pagelet/task/directive/taskOperation","pagelet/task/directive/operation","pagelet/task/comparator"],function(_,angular,commonModule,datePicker,taskService,taskList,taskItem,taskAside,taskMessageCtrl,tasksCtrl,myTasksCtrl,taskFilters,archivedTasksCtrl,taskOperation,operation,taskComparator){"use strict";var module=angular.module("taskModule",[commonModule.name,"datePicker"]);return taskService(module),tasksCtrl(module),taskList(module),taskItem(module),taskAside(module),myTasksCtrl(module),taskFilters(module),taskMessageCtrl(module),archivedTasksCtrl(module),taskOperation(module),operation(module),module.constant("TASKLIST_STATUS",{normal:0,archived:1}).service("taskComparator",[taskComparator]).constant("TASK_OPERATION",{CREATE_LIST:0,RENAME_LIST:1,UPDATE_LIST:2,DELETE_LIST:3,ARCHIVE_LIST:4,COMMENT_LIST:5,CREATE_TASK:6,FINISH_TASK:7,UNFINISH_TASK:8,DELETE_TASK:9,RENAME_TASK:10,UPDATE_TASK:11,COMMENT_TASK:12,UPDATE_TASK_EXPIRE:13,ASSIGN_TASK:14,CHANGE_TASK_PRIORITY:15,REOPEN_TASK_LIST:16}).run(["launcher","viewport","dialogService","explorer","chatTemplate","permissionService","ROLES","MESSAGE_TYPE","$rootScope","router",function(launcher,viewport,dialogs,explorer,chatTemplate,permission,ROLES,MESSAGE_TYPE,$rootScope,router){launcher.wait().then(function(){var groupRouter=launcher.getGroupRouter(),taskRouter=groupRouter.bind("/tasks",function(params){viewport.open("tasks",params),$rootScope.$broadcast("task.enter-task")
});taskRouter.bind("/{taskId}",function(params){var taskId=params.taskId;if(/^list-/.test(taskId)){var listId=taskId.slice(5);$rootScope.$broadcast("task.aside.taskList",listId)}else $rootScope.$broadcast("task.aside.task",taskId)});var archivedTaskRouter=groupRouter.bind("/archivedTasks",function(params){viewport.open("archivedTasks",params),$rootScope.$broadcast("task.enter-task")});archivedTaskRouter.bind("/{taskId}",function(params){var taskId=params.taskId;if(/^list-/.test(taskId)){var listId=taskId.slice(5);$rootScope.$broadcast("task.aside.taskList",listId,"archivedTasks")}else $rootScope.$broadcast("task.aside.task",taskId,"archivedTasks")});var myTasksRouter=router.bind("/tasks",function(params){viewport.open("myTasks",params)});myTasksRouter.bind("/{taskId}",function(params){$rootScope.$broadcast("task.aside.task",params.taskId,"myTasks")})}),viewport.extendView(function(register){register("tasks","pagelet/task/tasks.html",!0)}),viewport.extendView(function(register){register("archivedTasks","pagelet/task/archivedTasks.html",!0)}),viewport.extendView(function(register){register("myTasks","pagelet/task/myTasks.html",!1)}),chatTemplate.extendTemplate(function(data){return data.type===MESSAGE_TYPE.TASK?(data.templateUrl="pagelet/task/msg/message.html",data.tipUrl="pagelet/task/msg/message-tip.html",!1):void 0})}])}),define("pagelet/search/plugin",[],function(){"use strict";return function(viewport){var VIEW_SRC="pagelet/search/search.html",VIEW_NAME="search";viewport.extendView(function(register){register(VIEW_NAME,VIEW_SRC)})}}),define("pagelet/search/searchInput",["underscore","jquery","util/keycode"],function(_,$,KEYCODE){"use strict";return function($location,viewport,explorer){function link(scope,el){function search(){$location.search("hrId",null);var val=$input.val().trim();return disableSearch?!1:""===val?(explorer.restore(),!1):(explorer.search(val),disableSearch=!0,setTimeout(function(){disableSearch=!1},1e3),!1)}var disableSearch=!1,$input=el.find("input"),$icon=el.find(".icon-search");$input.on("keydown",function(e){e.keyCode===KEYCODE.ENTER&&search()}),$icon.on("click",function(){search()}),scope.$on("search.clear",function(){$input.val("")})}return{restrict:"AC",templateUrl:"pagelet/search/searchInput.html",link:link,replace:!0}}}),define("pagelet/search/searchCtrl",["underscore","jquery"],function(_,$){"use strict";var TAB_NAME=["FILE","COMMENT","MESSAGE"];return function($scope,$location,$q,$timeout,viewport,searchService,fileMgr,explorer,shareService,starService){function init(keyword){$scope.loading=!0,doSearch(keyword)}function doSearch(keyword){var groupId=$scope.gid();$scope.keyword=keyword,$scope.tabName=TAB_NAME[0],$scope.messages=[],$scope.comments=[],$scope.results=[],searchService.searchMessage(groupId,keyword,null,pageSize).then(function(res){$scope.messages=res.value,$scope.messagesState.total=res.total,$scope.messagesState.pageTotal=parseInt((res.total-1)/pageSize,10)+1,$scope.messagesState.pageNum=1,$scope.loading=!1}).catch(function(){$scope.messagesState.total=0,$scope.messagesState.pageTotal=1,$scope.messagesState.pageNum=1}),searchService.searchComment(groupId,keyword,null,pageSize).then(function(res){$scope.comments=res.value,$scope.commentsState.total=res.total,$scope.commentsState.pageTotal=parseInt((res.total-1)/pageSize,10)+1,$scope.commentsState.pageNum=1,$scope.loading=!1}).catch(function(){$scope.commentsState.total=0,$scope.commentsState.pageTotal=1,$scope.commentsState.pageNum=1}),searchService.searchFile(groupId,keyword,null,pageSize).then(function(files){_.each(files,function(searchedFile){var tempFile=_.findWhere($scope.files,{id:_.isString(searchedFile.id)?searchedFile.id:String(searchedFile.id)});tempFile&&(searchedFile.favorite=tempFile.favorite)}),$scope.results=files,$scope.filesState.total=files.total,$scope.filesState.pageTotal=parseInt((files.total-1)/pageSize)+1,$scope.filesState.pageNum=1,0===$scope.results.length&&($scope.comments.length>0?$scope.tabName="COMMENT":$scope.messages.length>0&&($scope.tabName="MESSAGE"));var gid=$scope.gid();shareService.listShareFiles(gid).then(function(sharedFiles){_.forEach(sharedFiles,function(shareFile){var file=_.findWhere($scope.results,{id:String(shareFile.id)});_.isUndefined(file)||(file.shareEntry=shareFile)})}),starService.listStars(gid).then(function(staredFiles){_.forEach(staredFiles,function(staredFile){var file=_.findWhere($scope.results,{id:String(staredFile.id)});_.isUndefined(file)||(file.favorite=!0)})}),$scope.loading=!1}).catch(function(){$scope.filesState.total=0,$scope.filesState.pageTotal=1,$scope.filesState.pageNum=1})}function getSearchMessage(gid,keyword,pageNum,pageSize,scrollTop){searchService.searchMessage(gid,keyword,pageNum,pageSize).then(function(json){$scope.messages=json.value,$scope.messagesState.pageNum=pageNum,$timeout(function(){$search_messages.scrollTop(scrollTop)},0)})}function gotoFirstMessagePage(){var curPageNum=$scope.messagesState.pageNum;1!==curPageNum&&getSearchMessage($scope.gid(),$scope.keyword,1,pageSize,1e6)}function gotoPreMessagePage(){var curPageNum=$scope.messagesState.pageNum;1>=curPageNum||getSearchMessage($scope.gid(),$scope.keyword,curPageNum-1,pageSize,1e6)}function gotoNextMessagePage(){var curPageNum=$scope.messagesState.pageNum;curPageNum>=$scope.messagesState.pageTotal||getSearchMessage($scope.gid(),$scope.keyword,curPageNum+1,pageSize,0)}function gotoLastMessagePage(){var curPageNum=$scope.messagesState.pageNum,pageTotal=$scope.messagesState.pageTotal;curPageNum!==pageTotal&&getSearchMessage($scope.gid(),$scope.keyword,pageTotal,pageSize,0)}function getSearchFile(gid,keyword,pageNum,pageSize,scrollTop){searchService.searchFile(gid,keyword,pageNum,pageSize).then(function(files){files.length<=0||($scope.results=files,$scope.filesState.pageNum=pageNum,$timeout(function(){$(".search-files .widget-scroller-wrap").scrollTop(scrollTop)},0))})}function gotoFirstFilePage(){var curPageNum=$scope.filesState.pageNum;1!==curPageNum&&getSearchFile($scope.gid(),$scope.keyword,1,pageSize,1e6)}function gotoPreFilePage(){var curPageNum=$scope.filesState.pageNum;1>=curPageNum||getSearchFile($scope.gid(),$scope.keyword,curPageNum-1,pageSize,1e6)}function gotoNextFilePage(){var curPageNum=$scope.filesState.pageNum;curPageNum>=$scope.filesState.pageTotal||getSearchFile($scope.gid(),$scope.keyword,curPageNum+1,pageSize,0)}function gotoLastFilePage(){var curPageNum=$scope.filesState.pageNum,pageTotal=$scope.filesState.pageTotal;curPageNum!==pageTotal&&getSearchFile($scope.gid(),$scope.keyword,pageTotal,pageSize,0)}function returnList(){return explorer.restore(2)}function tabToFile(){$scope.tabName="FILE"}function tabToMessage(){$scope.tabName="MESSAGE"}function forwardMessage(id){$location.search("chathistory",""),$location.search("chathistory",id),$location.search("hrId",null)}function getSearchComment(gid,keyword,pageNum,pageSize,scrollTop){searchService.searchComment(gid,keyword,pageNum,pageSize).then(function(json){$scope.comments=json.value,$scope.commentsState.pageNum=pageNum,$timeout(function(){$search_comments.scrollTop(scrollTop)},0)})}function gotoFirstCommentPage(){var curPageNum=$scope.commentsState.pageNum;1!==curPageNum&&getSearchComment($scope.gid(),$scope.keyword,1,pageSize,1e6)}function gotoPreCommentPage(){var curPageNum=$scope.commentsState.pageNum;1>=curPageNum||getSearchComment($scope.gid(),$scope.keyword,curPageNum-1,pageSize,1e6)}function gotoNextCommentPage(){var curPageNum=$scope.commentsState.pageNum;curPageNum>=$scope.commentsState.pageTotal||getSearchComment($scope.gid(),$scope.keyword,curPageNum+1,pageSize,0)}function gotoLastCommentPage(){var curPageNum=$scope.commentsState.pageNum,pageTotal=$scope.commentsState.pageTotal;curPageNum!==pageTotal&&getSearchComment($scope.gid(),$scope.keyword,pageTotal,pageSize,0)}function tabToComment(){$scope.tabName="COMMENT"}function onFileUpdate(newFile){if(null!=$scope.search){var tempStarFile,relatedFile=_.findWhere($scope.results,{id:_.isString(newFile.id)?newFile.id:String(newFile.id)});null!=relatedFile&&starService.listStars($scope.gid()).then(function(starFiles){tempStarFile=_.findWhere(starFiles,{id:parseInt(newFile.id)}),tempStarFile&&(newFile.favorite=!0,newFile.favoriteDate=tempStarFile.favoriteDate)}).finally(function(){_.extend(relatedFile,newFile)})}}var pageSize=20,$search_messages=$(".search-messages"),$search_comments=$(".search-comments");$scope.messagesState={},$scope.filesState={},$scope.commentsState={},$scope.$on("files.move",function($evt,movedFiles,target){fileMgr.getFilePath($scope.gid(),target.id).then(function(path){$scope.results&&$scope.results.length&&_.each(movedFiles,function(file){var originFile=_.findWhere($scope.results,{id:file.id});originFile.path=path,originFile.parentId=file.parentId})})}),$scope.$on("files.search",function($evt,keyword){init(keyword)}),$scope.search&&init($scope.search),$scope.returnList=returnList,$scope.tabToFile=tabToFile,$scope.tabToMessage=tabToMessage,$scope.tabToComment=tabToComment,$scope.forwardMessage=forwardMessage,$scope.gotoFirstMessagePage=gotoFirstMessagePage,$scope.gotoPreMessagePage=gotoPreMessagePage,$scope.gotoNextMessagePage=gotoNextMessagePage,$scope.gotoLastMessagePage=gotoLastMessagePage,$scope.gotoFirstFilePage=gotoFirstFilePage,$scope.gotoPreFilePage=gotoPreFilePage,$scope.gotoNextFilePage=gotoNextFilePage,$scope.gotoLastFilePage=gotoLastFilePage,$scope.gotoFirstCommentPage=gotoFirstCommentPage,$scope.gotoPreCommentPage=gotoPreCommentPage,$scope.gotoNextCommentPage=gotoNextCommentPage,$scope.gotoLastCommentPage=gotoLastCommentPage,$scope.$on("file.update",function($evt,file){onFileUpdate(file)})}}),define("searchModule",["angular","pagelet/search/plugin","pagelet/search/searchInput","pagelet/search/searchCtrl"],function(angular,searchPlugin,searchInput,searchCtrl){"use strict";return angular.module("searchModule",[]).service("searchPlugin",["viewport","$location",searchPlugin]).directive("searchInput",["$location","viewport","explorer",searchInput]).controller("searchCtrl",["$scope","$location","$q","$timeout","viewport","searchService","fileManager","explorer","shareService","starService",searchCtrl])}),define("pagelet/table/tableCtrl",["util/fileValidator","util/trackTiming"],function(validator,trackTiming){"use strict";return function($scope,$q,$location,$timeout,router,viewport,explorer,tables,fileMgr,dialogs,masker,launcher,filePermission,titleService,storageMgr,LOCAL_STORAGE_KEY){function onOpen(opt){return opt.fileId?onInvoke(opt):newTable(opt.folderId).then(function(){return"新建表格"})}function onInvoke(opt){return $scope.file||opt.fileId?$scope.file?$q.when($scope.file.name):(force2Quit=!1,function(){var gid=$scope.gid(),fileId=opt.fileId;return fileMgr.getFile(gid,fileId).then(function(res){var file=res;return $scope.file=file,$scope.title=file.name.replace(/\.table/,""),opt})}().then(openTable).then(function(){return $timeout(function(){$("#"+$scope.token).load(function(){trackTiming.openTable.end().send().clear()})}),$scope.file.name}).catch(function(e){return e&&"20101"===e.error?dialogs.alert("打开表格","表格不存在或已经被删除"):e&&"260"===e.error?dialogs.alert("打开表格","无法查看该表格，仅群管理员或群主可见"):dialogs.alert("打开表格","打开表格失败"),$q.reject(e)})):$q.when(null)}function onClose(){return clearInterval(saveIntervalHint),function(){return!force2Quit&&isDirty()?alertToSave():$q.when(null)}().then(disconnect)}function disconnect(){return function(){return $scope.token?tables.close($scope.token):$q.when(null)}().finally(function(){$scope.tableUrl=$scope.title=$scope.token=$scope.file=$scope.folderId=null,$scope.maxVersion=0,_.each(watchers,function(unwatch){unwatch()}),watchers=[],$scope.isTableDirty=notDirty})}function newTable(folderId){var gid=$scope.gid();return $scope.folderId=folderId,$scope.meta=!1,tables.allocate(gid,null,folderId).then(function(token){$scope.token=token,$scope.tableUrl="/table/?groupId="+gid+"&token="+token,initAfterLoaded()})}function openTable(opt){var gid=$scope.gid(),fileId=opt.fileId;return $scope.meta=!!storage.get(LOCAL_STORAGE_KEY.FILE_META_EXPANDED),filePermission.check("table.edit",$scope.file)?function(){return isDirty()?alertToSave():$q.when(null)}().then(function(){return $q.all([fileMgr.getFile(gid,fileId),tables.allocate(gid,fileId)])}).then(function(res){var file=res[0],token=res[1];return $scope.file=file,$scope.title=file.name.replace(/\.table/,""),preTitle=file.name,fileMgr.getFilePath(file.gid,file.parentId).then(function(path){$scope.filePath=path}).catch(function(){$scope.filePath="读取路径失败"}),$scope.token=token,$scope.tableUrl="/table/?groupId="+gid+"&fileId="+fileId+"&token="+token,tables.getMaxVersion(gid,fileId,token,launcher.uid()).then(function(json){$scope.maxVersion=json}),opt.hasOwnProperty("commentId")?($scope.commentId=opt.commentId,$scope.max=!1):delete $scope.commentId,0===watchers.length&&(initAfterLoaded(),watchers.push($scope.$watch("file.name",onRename)),watchers.push($scope.$on("file.remove",onFileRemove))),file}):($scope.tableUrl="/yws/api/group/"+gid+"/preview/"+fileId+"?method=convert",$q.when(null))}function initAfterLoaded(){$scope.isTableDirty=notDirty,watchers.push($scope.$on("group.dismiss.this",quit)),watchers.push($scope.$on("group.quit.this",function(){force2Quit=!0})),watchers.push(router.before(interceptRoute))}function isTitleChanged(){return($scope.title||"")+".table"!==($scope.file?$scope.file.name:".table")}function isDirty(){return filePermission.check("table.edit",$scope.file)&&$scope.isTableDirty?$scope.isTableDirty()?!0:isTitleChanged():!1}function interceptRoute(){return isDirty()&&!force2Quit?function(){return $scope.file?save():alertToSave()}().then(disconnect):void 0}function alertToSave(){return dialogs.open({title:"退出编辑",src:"pagelet/table/confirm.html",width:370,height:30,buttons:[{text:"保存",handler:function($dialog){$dialog.dismiss(!0)},cls:"primary"},{text:"不保存",cls:"cancel",handler:function($dialog){$dialog.dismiss(!1)}},{text:"取消",cls:"cancel",handler:function($dialog){$dialog.cancel()}}]}).then(function(res){return res?save():void 0})}function saveAndQuit(){return filePermission.check("table.edit",$scope.file)?function(){return isDirty()?save():$q.when(null)}().then(function(){return $scope.notRenameDupliacate?void 0:$scope.fullScreen?(explorer.hint("发布成功","success"),void titleService.set(titleService.Priority.FILENAME,$scope.file.name)):disconnect().then(quit)}):quit()}function save(title){function createOrUpdate(){return $scope.file?doUpdate():doCreate()}function doCreate(){return tables.create($scope.gid(),title,$scope.folderId,$scope.token).catch(onDuplicatedName).catch(onFolderRemoved).catch(onFileNumLimit).catch(onNoSpace)}function doUpdate(){return!$scope.isTableDirty()&&isTitleChanged()?fileMgr.rename($scope.gid(),$scope.file,title).catch(onDuplicatedName).catch(onFileRemoved):(title===preTitle&&(title=null),tables.update($scope.gid(),title,$scope.file.id,$scope.token).catch(onDuplicatedName).catch(onFileRemoved).catch(onNoSpace).then(function(){explorer.hint("表格已保存","success")}))}function onDuplicatedName(e){return e&&"20108"===e.error&&e.adviceName?dialogs.confirm("发布表格","目录中有重名表格，是否重命名为："+e.adviceName,{ok:"是",cancel:"否"}).then(function(){return save(e.adviceName.replace(/.table$/,""))},function(){return $scope.notRenameDupliacate=!0,$scope.file}):$q.reject(e)}function onFileRemoved(e){return e&&"20101"==e.error?dialogs.confirm("发布表格","该表格已被群内其他成员删除了，是否保存为新的表格？").then(function(){return $scope.folderId=$scope.file.parentId,$scope.file=null,save()}):$q.reject(e)}function onFolderRemoved(e){return e&&"20101"==e.error?dialogs.open({src:"pagelet/file/selector/selector-dialog.html",title:"保存到",width:360,height:360,gid:$scope.gid(),except:[{name:title}],selectType:"folder"}).then(function(toFolder){return $scope.folderId=toFolder.id,save()}):$q.reject(e)}function onFileNumLimit(e){return e&&"20114"===e.error&&dialogs.alert("发布表格","当前群中的文件数已经到达上限，请删除不必要的文件后重新发布").then(quit),$q.reject(e)}function onNoSpace(e){return e&&"10024"===e.error&&dialogs.alert("发布表格","当前群的存储容量已满，无法增加新文件。请删除不必要的文件后重新发布").then(quit),$q.reject(e)}title=(title||$scope.title||"无标题表格")+".table",$scope.saving=!0,$scope.notRenameDupliacate=!1;var errMsg=validator(title,!0);return errMsg?dialogs.alert("发布笔记",'标题含有不合法字符，请修改后再试。不合法字符包括 \\ / : * ? " < > | ').then(function(){return $scope.saving=!1,$q.reject()}):(masker.push(),createOrUpdate().then(function(file){$scope.file=file}).finally(function(){masker.pop(),$scope.saving=!1}))}function quit(){return trackTiming.closeTable.clear().start(),$scope.folderId?explorer.openFolder($scope.folderId):($location.search("full",null),force2Quit=!0,explorer.restore())}function onRename(){$scope.title=$scope.file.name.replace(/\.table/,""),$scope.fullScreen&&titleService.set(titleService.Priority.FILENAME,$scope.file.name)}function onFileRemove($evt,file){$scope.file.id===file.id&&dialogs.alert("提示","该表格已被群内其他成员删除了").then(quit)}function onTableNotExists(){dialogs.alert("提示","表格不存在或已经被删除").then(quit)}function onUserExceed(number){dialogs.alert("提示","目前支持"+number+"人同时查看和编辑，已到达上限，请稍后再试").then(quit)}function onEditorError(){dialogs.confirm("提示","系统遇到一些问题，请重试",{ok:"重试"}).then(function(){window.location.reload()}).catch(quit)}function onSizeExceed(rowOrCol,number){var tag="maxrow"==rowOrCol?"行":"列";dialogs.alert("提示","目前支持的最大"+tag+"数为"+number+tag+"，已到达上限。")}function onWebsocketError(){explorer.hint("协同服务不稳定，正在重连","warning"),saveIntervalHint=setInterval(function(){explorer.hint("协同服务不稳定，正在重连","warning")},3e3)}function onWebsocketReconnect(){clearInterval(saveIntervalHint),explorer.hint("协同服务已成功重连","success")}function notDirty(){return!1}function onOpenFolder(fileId){explorer.locateFile(fileId)}function toggleMeta(){$scope.meta=!$scope.meta,storage.put(LOCAL_STORAGE_KEY.FILE_META_EXPANDED,$scope.meta)}var preTitle,force2Quit,saveIntervalHint,watchers=[],storage=storageMgr.forUser(launcher.uid());$scope.$open(onOpen),$scope.$invoke(onInvoke),$scope.$close(onClose),$scope.quit=quit,$scope.saveAndQuit=saveAndQuit,$scope.onTableNotExists=onTableNotExists,$scope.onUserExceed=onUserExceed,$scope.onEditorError=onEditorError,$scope.onSizeExceed=onSizeExceed,$scope.onWebsocketError=onWebsocketError,$scope.onWebsocketReconnect=onWebsocketReconnect,$scope.onOpenFolder=onOpenFolder,$scope.toggleMeta=toggleMeta}}),define("pagelet/table/service",["jquery","util/trackTiming"],function($,trackTiming){"use strict";return function($http,$q,fileMgr){function getWindow(token){return $("#"+token)[0].contentWindow}this.allocate=function(gid,fileId,parentId){function allocateNew(parentId){return trackTiming.allocateNew.start(),$http.get("/yws/api/group/"+gid+"/table",{params:{method:"openNew",parentId:parentId}}).then(function(req){trackTiming.allocateNew.end().setLabel("success").send().clear();var token=req.data.token;return token?token:$q.reject(req)}).catch(function(e){return trackTiming.allocateNew.end().setLabel("error").send().clear(),$q.reject(e.data)})}function allocateExists(){return trackTiming.allocateExists.start(),$http.get("/yws/api/group/"+gid+"/table/"+fileId+"?method=open").then(function(req){trackTiming.allocateExists.end().setLabel("success").send().clear();var token=req.data.token;return token?token:$q.reject(req)}).catch(function(e){return trackTiming.allocateExists.end().setLabel("error").send().clear(),$q.reject(e.data)})}return fileId?allocateExists():allocateNew(parentId)},this.create=function(gid,title,folderId,token){var tableWindow=getWindow(token);return trackTiming.saveTable.start(),$http.post("/yws/api/group/"+gid+"/table/"+tableWindow.client.fileId+"?method=save",{title:title,parentId:folderId,"new":!0,token:token}).then(function(req){trackTiming.saveTable.end().setLabel("success").send().clear();var data=req.data;return new fileMgr.File(gid,data)}).catch(function(e){return trackTiming.saveTable.end().setLabel("error").send().clear(),$q.reject(e.data)})},this.update=function(gid,title,fileId,token){return trackTiming.saveTable.start(),$http.post("/yws/api/group/"+gid+"/table/"+fileId+"?method=save",{title:title,token:token}).then(function(req){trackTiming.saveTable.end().setLabel("success").send().clear();var data=req.data;return new fileMgr.File(gid,data)}).catch(function(e){return trackTiming.saveTable.end().setLabel("error").send().clear(),$q.reject(e.data)})},this.close=function(token){var tableWindow=getWindow(token),defer=$q.defer(),timeout=null;return tableWindow&&tableWindow.client&&tableWindow.client.close?(tableWindow.client.close(function(){null!==timeout&&(clearTimeout(timeout),defer.resolve())}),timeout=setTimeout(function(){timeout=null,defer.reject()},5e3),defer.promise):$q.when()},this.getRevisions=function(groupId,fileId,token,userId){var defer=$q.defer();return trackTiming.getRevisions.start(),$http.get("/table/api/group/"+groupId+"/table/"+fileId,{params:{method:"getRevisors",token:token,userId:userId}}).success(function(json){trackTiming.getRevisions.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(){trackTiming.getRevisions.end().setLabel("error").send().clear(),defer.reject()}),defer.promise},this.getVersion=function(groupId,fileId,version,token,userId){var defer=$q.defer();return trackTiming.getVersion.start(),$http.get("/table/api/group/"+groupId+"/table/"+fileId,{params:{method:"getVersion",version:version,token:token,userId:userId}}).success(function(json){trackTiming.getVersion.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(){trackTiming.getVersion.end().setLabel("error").send().clear(),defer.reject()}),defer.promise},this.getMaxVersion=function(groupId,fileId,token,userId){var defer=$q.defer();return trackTiming.getMaxVersion.start(),$http.get("/table/api/group/"+groupId+"/table/"+fileId,{params:{method:"getMaxVerNO",token:token,userId:userId}}).success(function(json){trackTiming.getMaxVersion.end().setLabel("success").send().clear(),defer.resolve(json)}).error(function(){trackTiming.getMaxVersion.end().setLabel("error").send().clear(),defer.reject()}),defer.promise}}}),define("pagelet/table/editor",["underscore"],function(_){"use strict";return function(menus,dialogs){function link(scope,el){function onLoad(){contentWindow=el[0].contentWindow,$body=$(contentWindow.document.body),contentWindow.editor&&contentWindow.client&&(contentWindow.editor.setContextmenuCallback(handleMenuRequest),contentWindow.client.on("error",onError),contentWindow.client.on("websocket",onWebsocket),contentWindow.alert=delegateAlert,$body.on("mousedown",function(){menus.close()}),$thisBody.on("mousedown mouseup click dbclick",dispatchEvent),scope.$parent.isTableDirty=function(){if(!contentWindow.client)return!1;try{return contentWindow.client.isDirty()}catch(err){return console.log(err),!1}})}function dispatchEvent(e){$body.trigger(e.type,e)}function onDestroy(){el.off("load",onLoad),$thisBody.off("mousedown mouseup click dbclick",dispatchEvent),null!=$body&&$body.remove(),contentWindow=null}function delegateAlert(text){dialogs.alert("提示",text)}function onError(type,arg){switch(type){case"notable":scope.onTableNotExists();break;case"maxuser":scope.onUserExceed(arg);break;case"other":scope.onEditorError();break;case"maxcol":case"maxrow":scope.onSizeExceed(type,arg)}}function onWebsocket(type){switch(type){case"error":scope.onWebsocketError();break;case"reconnect":scope.onWebsocketReconnect()}}function handleMenuRequest(req){var callback=req.callback,offset=el.offset();menus.open({items:_.chain(req.items).reject(function(item){return item.disabled===!0}).map(function(item){return{name:name,label:item.name,type:"-"===item[0]?3:0,handler:function(){callback(item.key)}}}).value(),x:req.x+offset.left,y:req.y+offset.top})}var contentWindow,$body,$thisBody=$(document.body);el.on("load",onLoad),scope.$on("$destroy",onDestroy)}return{link:link}}}),define("pagelet/table/message",["underscore"],function(_){"use strict";return function($scope){function User(json){this.userId=json.userId,this.name=json.name?String(json.name):void 0,this.photo=json.photo?String(json.photo):void 0}function TableMessage(json){this.type=5,this.id=json.id?Number(json.id):void 0,this.groupId=json.groupId?Number(json.groupId):void 0,this.longInterval=Boolean(json.longInterval),this.time=json.time?Number(json.time):void 0,this.user=new User(json.user),this.operation=Number(json.operation),this.fileId=json.fileId?Number(json.fileId):void 0,this.parentId=Number(json.parentId),this.title=json.title?String(json.title):"无标题笔记",this.coRevisors=[this.user],json.properties?(this.version=json.properties.histVerNO?Number(json.properties.histVerNO):void 0,this.coRevisors=this.coRevisors.concat(_.map(json.proterties.coRevisors,function(value){return new User(value)}))):(this.version=json.tbHistVerNO?Number(json.tbHistVerNO):void 0,this.coRevisors=this.coRevisors.concat(_.map(json.coRevisors,function(value){return new User(value)}))),this.isOnlyManagerEdit=json.onlyManagerEdit?Boolean(json.isOnlyManagerEdit):!1,this.isOnlyManagerView=json.onlyManagerView?Boolean(json.onlyManagerView):!1}var data=$scope.message.data;$scope.msg=new TableMessage(data),$scope.file={name:data.title,isFolder:!1}}}),define("pagelet/table/diffview/tableDiffCtrl",["underscore","htmldiff"],function(_){"use strict";return function($scope,$q,$timeout,launcher,tableService,userService){function Revisor(json){this.id=json.userId,this.name=json.name,this.photo=json.photo}function TableHistory(json){var self=this;this.date=new Date(Number(json.histTbLastOpsTime||0)),this.version=Number(json.histTbVerNO||0),userService.getUsersInfo(json.histTbRevisors.join(":")).then(function(res){self.revisors=_.map(res,function(value){return new Revisor(value)}),self.revisorsName=_.map(self.revisors,function(value){return value.name}).join("、")})}function setDiffUrl(version){$scope.diffUrl="/table/diff?groupId="+gid+"&fileId="+fileId+"&token="+token+"&userId="+userId+"&version="+version;var $iframe=$(".tablediff").find("iframe")[0];$iframe.contentWindow.location.hash="",$iframe.onload=function(){$timeout(function(){$scope.changeVersionReady=!0,iframeDiff=$(".tablediff").find("iframe")[0].contentWindow.diff,iframeDiff.on("stop",function(){$scope.playing=!1,$scope.$apply()})})}}function changeVersion(version){$scope.playing=!1,$scope.activeVersion=version,$scope.activePersonalId=null,$scope.changeVersionReady=!1,tableService.getVersion(gid,fileId,version,token,userId).then(function(json){var oldTitle=json.histTbOldTitle.substr(0,json.histTbOldTitle.lastIndexOf(".")),newTitle=json.histTbNewTitle.substr(0,json.histTbNewTitle.lastIndexOf("."));oldTitle=oldTitle.trim()||"<div></div>",newTitle=newTitle.trim()||"<div></div>",null===worker?$scope.diffTitle=getHTMLDiff(oldTitle,newTitle):(worker.postMessage({cmd:"start",newVersion:newTitle,oldVersion:oldTitle}),worker.onmessage=function(evt){$scope.$apply(function(){$scope.diffTitle=evt.data})}.bind(this))}),$scope.diffUrl="",$scope.curVersion=version,setDiffUrl(version)}function changePerson(id){$scope.activePersonalId=id,iframeDiff&&iframeDiff.stop(),$scope.playing=!1,$(".tablediff").find("iframe")[0].contentWindow.location.hash="user="+id}function switchAction(evt,version){version===$scope.curVersion?($scope.playing=!$scope.playing,$scope.playing?iframeDiff.play():iframeDiff.stop()):changeVersion(version),evt.stopPropagation()}function getHistoryList(){tableService.getRevisions(gid,fileId,token,userId).then(function(list){$scope.tableHistoryList=_.map(list,function(value){return new TableHistory(value)}),changeVersion($scope.version?$scope.version:list.length)})}function init(){$scope.changeVersion=changeVersion,$scope.changePerson=changePerson,$scope.switchAction=switchAction,tableService.allocate(gid,fileId).then(function(res){token=res,getHistoryList()})}var token,iframeDiff,gid=$scope.gid,fileId=$scope.table.id,userId=launcher.uid(),worker=window.Worker?new window.Worker("./util/htmldiff.js"):null;init()}}),define("tableModule",["underscore","angular","commonModule","fileModule","pagelet/table/tableCtrl","pagelet/table/service","pagelet/table/editor","pagelet/table/message","pagelet/table/diffview/tableDiffCtrl"],function(_,angular,commonModule,fileModule,tableCtrl,service,editor,messageCtrl,tableDiffCtrl){"use strict";function initialize(launcher,viewport,dialogs,explorer,chatTemplate,permission,ROLES,MESSAGE_TYPE){function openTable(fileId,version,opt){baseRouter.forward("/table/"+fileId,opt)}function createTable(folder){baseRouter.forward("/table",{folderId:folder.id})}function traceTable(file,version){dialogs.open({src:"pagelet/table/diffview/tableDiff.html",title:"历史版本比较",table:file,width:823,height:500,cls:"diff",version:version,gid:launcher.gid(),canFullScreen:!0})}var baseRouter;launcher.wait().then(function(){baseRouter=launcher.getGroupRouter(),baseRouter.bind("/table/{fileId}",function(params){viewport.open("table",params)}),baseRouter.bind("/table",function(params){viewport.open("table",params)})}),viewport.extendView(function(register){register("table","pagelet/table/table.html")}),explorer.extendType(function(register){register("表格",/^.+\.table$/,2,{routerPrefix:"table",open:openTable,create:createTable,trace:traceTable,upload:!1,download:!1,share:!0})}),chatTemplate.extendTemplate(function(data){return data.type===MESSAGE_TYPE.GROUPTABLE?(data.templateUrl="pagelet/table/message.html",data.tipUrl="pagelet/table/message-tip.html",!1):void 0}),permission.register(ROLES.GROUP_FOUNDER,["table.*"]),permission.register(ROLES.GROUP_MANAGER,["table.*"]),permission.register(ROLES.GROUP_EDITOR,["table.*"]),permission.register(ROLES.GROUP_READER,[]),permission.register(ROLES.GROUP_RESTORER,[]),permission.register(ROLES.GROUP_VIEWER,[]),permission.deregister(ROLES.ORG_EXPIRED,["table.edit","table.trace"])}return angular.module("tableModule",[commonModule.name,fileModule.name]).service("tableService",["$http","$q","fileManager",service]).controller("tableCtrl",["$scope","$q","$location","$timeout","router","viewport","explorer","tableService","fileManager","dialogService","widgetMasker","launcher","filePermissionService","titleService","storageManager","LOCAL_STORAGE_KEY",tableCtrl]).controller("tableMessageCtrl",["$scope",messageCtrl]).controller("tableDiffCtrl",["$scope","$q","$timeout","launcher","tableService","userService",tableDiffCtrl]).directive("tableEditor",["menuService","dialogService",editor]).run(["launcher","viewport","dialogService","explorer","chatTemplate","permissionService","ROLES","MESSAGE_TYPE",initialize])}),define("pagelet/orgSetting/orgSettingInit",[""],function(){"use strict";return function(launcher,viewport,permission,$q,organizationService,orgMemberService,ROLES){launcher.wait().then(function(){launcher.getOrgRouter().bind("/{tab}",function(params){var forwardTab=function(){permission.check("orgSetting.viewOrgGroups")||"groups"!==params.tab||(params.tab="myGroups"),viewport.open("orgSetting",params)};return orgMemberService.fetchMembers(params.orgId,launcher.getUser()).then(function(){orgMemberService.getMembers().length>0&&forwardTab()})})}),permission.register(ROLES.ORG_OWNER,["orgSetting.*"]),permission.register(ROLES.ORG_MANAGER,["orgSetting.*","trailOrg.quit"]),permission.register(ROLES.ORG_USER,["trailOrg.quit","orgSetting.createGroup","orgSetting.quit"]),permission.register(ROLES.GROUP_FOUNDER,[]),permission.register(ROLES.GROUP_MANAGER,[]),permission.register(ROLES.GROUP_EDITOR,[]),permission.register(ROLES.GROUP_READER,[]),permission.register(ROLES.GROUP_RESTORER,["group.recover","group.erase"]),permission.register(ROLES.GROUP_VIEWER,["group.join"]),permission.deregister(ROLES.ORG_EXPIRED,["group.recover","group.erase","group.join","orgSetting.changePhoto","orgSetting.createGroup"]),permission.deregister(ROLES.ORG_OWNER,["orgSetting.quit"]),permission.deregister(ROLES.ORG_MANAGER,["orgSetting.dismiss"]),viewport.extendView(function(register){register("orgSetting","pagelet/orgSetting/orgSetting.html")})}}),define("pagelet/orgSetting/orgSettingCtrl",["underscore"],function(){"use strict";
return function($scope,$q,launcher,permission){function openTab(tab){switch(tab){case"groups":case"myGroups":case"members":case"setting":$scope.segment=tab,$scope.popMask()}return $q.when(null)}$scope.showMask=function(){$scope.ready=!1},$scope.popMask=function(){$scope.ready=!0},$scope.showOrgGroups=permission.check("orgSetting.viewOrgGroups"),$scope.showExpiredHint=launcher.getOrg()?launcher.getOrg().expireTime.getTime()<Date.now():!1,$scope.$on("org.member.roleChanged",function(evt,orgId,userId,newRole){launcher.getOrg().id===orgId&&(launcher.setOrgRole(newRole),$scope.showOrgGroups=permission.check("orgSetting.viewOrgGroups"),("groups"===$scope.segment||"myGroups"===$scope.segment)&&launcher.getOrgRouter().forward($scope.showOrgGroups?"/groups":"/myGroups"))}),$scope.$open(function(opt){return openTab(opt.tab,opt.orgId)}),$scope.$invoke(function(opt){return openTab(opt.tab,opt.orgId)}),$scope.tabJumpFactory=function(tabName){return function(){launcher.getOrgRouter().forward("/"+tabName)}},$scope.$watch("orgId()",function(newVal,oldVal){newVal!==oldVal&&($scope.showMask(),$scope.showExpiredHint=launcher.getOrg()?launcher.getOrg().expireTime.getTime()<Date.now():!1)}),$scope.getGroupName=function(){return launcher.getOrg()?launcher.getOrg().name:""},$scope.getGroupPhoto=function(){return launcher.getOrg()?launcher.getOrg().photo:""}}}),define("pagelet/orgSetting/setting/orgInfoCtrl",["underscore"],function(_){"use strict";return function($scope,dialogs,launcher,orgService,$q,$timeout,$rootSope,ORG_EVENTS,titleService){function toDate(time){return time>=10?time:"0"+time}function init(newOrg){newOrg&&($scope.orgName=newOrg.name,$scope.orgDescription=newOrg.description,$scope.photo=newOrg.photo,$scope.usedSpace=newOrg.usedSpace,$scope.totalSpace=newOrg.totalSpace,$scope.orgRechargeTime={year:newOrg.expireTime.getFullYear(),month:toDate(newOrg.expireTime.getMonth()+1),day:toDate(newOrg.expireTime.getDate())},$scope.orgNeedRecharge=newOrg.expireTime.getTime()<Date.now(),$scope.isTrailOrg=newOrg.trail,newOrg.trail&&($scope.leftTrailDays=newOrg.leftTrailDays),8==newOrg.comboNum&&($scope.specialOrg=!0))}var org=launcher.getOrg();$scope.ready=!1,$scope.specialOrg=!1,orgService.getOrg().then(function(res){var myOrg=_.findWhere(res,{id:org.id});_.extend(launcher.getOrg(),myOrg)}).finally(function(){$scope.ready=!0}),$scope.$on("org.changed",function(evt,newOrg){init(newOrg)}),init(launcher.getOrg()),$scope.uploadIcon=function(tasks){var task=tasks[0];dialogs.open($scope,{cls:"show-icon-dialog",src:"pagelet/orgSetting/setting/org-icon-upload.html",task:task}).then(function(coords){orgService.update({id:org.id,name:org.name,description:org.description,photoCroods:coords}).then(function(data){org.photo=data.photo},function(e){switch(e.error){case"51012":dialogs.alert("提示","抱歉，企业版已过期，暂时无法修改组织信息。购买请联系youdaogroup@service.netease.com。");break;default:dialogs.alert("服务器错误","获取数据失败")}})})},$scope.getUsedPrecentage=function(){return Math.floor(1e4*$scope.usedSpace/$scope.totalSpace)/100},$scope.deleteOrganization=function(){dialogs.confirm("解散组织","解散组织后，内部所有资料、讨论都会删除，不可撤销。您确定要解散组织吗？").then(function(){orgService.dismissOrg(launcher.getOrg().id).then(function(){$rootSope.$broadcast(ORG_EVENTS.DISMISS);var delGroups=_.where(launcher.getGroups(),{orgId:launcher.getOrg().id});$rootSope.$broadcast("org.del.groupUp",delGroups)},function(){dialogs.alert("解散失败","当前组织解散失败，请稍后再试!")})})},$scope.quitOrg=function(){dialogs.confirm("退出组织","退出组织后，您所拥有的内部群将转让给组织创建者。您确定要退出组织吗？").then(function(){orgService.quitOrg(launcher.getOrg().id).then(function(){$rootSope.$broadcast(ORG_EVENTS.QUIT);var delGroups=_.where(launcher.getGroups(),{orgId:launcher.getOrg().id});$rootSope.$broadcast("org.del.groupUp",delGroups)},function(){dialogs.alert("退出组织","退出组织失败，请稍后再试!")})})},$scope.saveChange=function(){var clearReady=function(){$timeout(function(){$scope.ready=!0,$scope.onsave=!1})};$scope.ready=!1,orgService.update({id:org.id,name:$scope.orgName,description:$scope.orgDescription}).then(function(newOrg){_.extend(launcher.getOrg(),newOrg),titleService.set(titleService.Priority.GROUPNAME,launcher.getOrg().name),$scope.savedFailed=!1,$scope.onsave=!0,clearReady()},function(e){switch($scope.savedFailed=!0,$scope.onsave=!0,e.error){case"51012":dialogs.alert("提示","抱歉，企业版已过期，暂时无法修改组织信息。购买请联系youdaogroup@service.netease.com。").then(clearReady);break;default:dialogs.alert("服务器错误","获取数据失败").then(clearReady)}})}}}),define("pagelet/orgSetting/groups/orgGroupsController",["underscore"],function(_){"use strict";return function($scope,$rootScope,$q,$filter,launcher,dialogs,organizations){function listGroups(){$scope.showMask(),$q.all([organizations.listGroups($scope.orgId(),!1),organizations.listGroups($scope.orgId(),!0)]).then(function(values){$scope.groups=orderBy(values[0],"createTime",!0),$scope.allGroups=$scope.groups,$scope.deletedgroups=orderBy(values[1],"modifyTime",!0),$scope.popMask()},function(){})}var orderBy=$filter("orderBy");listGroups(),$scope.toShowAll=!1,$scope.toShowAllDeleted=!1,$scope.toggle=function(){$scope.toShowAll=!$scope.toShowAll},$scope.toggleDelete=function(){$scope.toShowAllDeleted=!$scope.toShowAllDeleted},$scope.clear=function(){0!==$scope.deletedgroups.length&&dialogs.confirm("清空","点击确认彻底清空已删除的群").then(function(){var promises=[];_.each($scope.deletedgroups,function(groupToErase){promises.push(organizations.eraseGroup(groupToErase.orgId,groupToErase.id))}),$q.all(promises).then(function(){$scope.deletedgroups=[]},function(e){"51012"===e.error?dialogs.alert("提示","抱歉，企业版已过期，暂时无法完成清除。购买请联系youdaogroup@service.netease.com"):dialogs.alert("提示","抱歉，暂时无法完成清除，请稍后再试。")})})},$scope.forwardToGroup=function(groupId){launcher.forward(groupId)},$scope.createGroup=function(){$rootScope.$broadcast("org.createGroup",$scope.orgId())},$scope.$watch("orgId()",function(orgId){orgId&&listGroups()}),$scope.$on("org.group.erase",function(){listGroups()}),$scope.$on("socket.event.7",function(){listGroups()}),$scope.$on("socket.notification",function(evt,content){!content||20!==content.type&&21!==content.type||listGroups()}),$scope.$watch("keyword",function(keyword){return keyword?void($scope.groups=_.reject($scope.allGroups,function(group){return-1===group.name.toLowerCase().indexOf(keyword.toLowerCase())})):void($scope.groups=$scope.allGroups)})}}),define("pagelet/orgSetting/myGroups/myGroupsController",["underscore"],function(_){"use strict";return function($scope,$rootScope,$q,$filter,launcher){function getMyGroups(){$scope.$watch("launcher.getOrgs()",function(value){$scope.organizations=value.slice(0,value.length-1);for(var i=0;i<$scope.organizations.length;i++)$scope.organizations[i].id==$scope.orgId()&&($scope.myGroup=$scope.organizations[i].groups,$scope.allGroups=$scope.myGroup,$scope.groupNum=$scope.organizations[i].groups?$scope.organizations[i].groups.length:0)})}getMyGroups(),$scope.ownerId=$scope.uid(),$scope.forwardToGroup=function(groupId){launcher.forward(groupId)},$scope.createGroup=function(){$rootScope.$broadcast("org.createGroup",$scope.orgId())},$scope.$watch("orgId()",function(orgId){orgId&&getMyGroups()}),$scope.$on("org.group.erase",function(){getMyGroups()}),$scope.$on("socket.event.7",function(){getMyGroups()}),$scope.$on("socket.notification",function(evt,content){!content||20!==content.type&&21!==content.type||getMyGroups()}),$scope.$watch("keyword",function(keyword){return keyword?void($scope.myGroup=_.reject($scope.allGroups,function(group){return-1===group.name.toLowerCase().indexOf(keyword.toLowerCase())})):void($scope.myGroup=$scope.allGroups)})}}),define("pagelet/orgSetting/groups/groupController",["underscore"],function(){"use strict";return function($scope){function init(group){void 0!==group&&($scope.toShow=$scope.$index<11||$scope.toShowAll||12===$scope.groups.length&&11===$scope.$index,$scope.toShowDeleted=$scope.$index<11||$scope.toShowAllDeleted||12===$scope.groups.length&&11===$scope.$index)}$scope.$watchCollection("[group, toShowAll, toShowAllDeleted]",init)}}),define("pagelet/orgSetting/members/orgMembersCtrl",["underscore"],function(_){"use strict";return function($scope,$rootScope,launcher,router,organizationService,dialogService,orgMemberService,ROLES){function getPageMember(curPageNum){$scope.pageState.pageNum=curPageNum,$scope.members=members.slice(($scope.pageState.pageNum-1)*pageSize,$scope.pageState.pageNum*pageSize)}var members,GROUPNUMLIMIT=3,getMemberGroupList=function(memberId,offset,len){var gList=$scope.memberGroup[memberId],gListNum=$scope.memberGroupNum[memberId];if(memberId){if(gList&&0===offset)return;if(gList&&0!==offset&&gList.length===gListNum)return;void 0===gList&&(gList=[]),organizationService.listGroupsForMember(memberId,$scope.orgId(),offset,len).then(function(args){var array=args[0],totalNum=args[1];$scope.memberGroup[memberId]=_.union(gList,array),$scope.memberGroupNum[memberId]=Number(totalNum)||0,$scope.groupListReady[memberId]=!0})}},pageSize=60;$scope.pageState={},$scope.ownerId=$scope.uid(),$scope.ROLES=ROLES,$scope.removeMember=function(member){return orgMemberService.removeMember(member).then(function(){launcher.reload()})},$scope.changeRole=orgMemberService.changeRole,$scope.changeOwner=orgMemberService.changeOwner,$scope.myRole=orgMemberService.getMyRole(),$scope.memberGroup=[],$scope.memberGroupNum=[],$scope.groupListReady=[],$scope.gotoFirstPage=function(){var curPageNum=$scope.pageState.pageNum;1!==curPageNum&&getPageMember(1)},$scope.gotoPrePage=function(){var curPageNum=$scope.pageState.pageNum;1>=curPageNum||getPageMember(curPageNum-1)},$scope.gotoNextPage=function(){var curPageNum=$scope.pageState.pageNum;curPageNum>=$scope.pageState.pageTotal||getPageMember(curPageNum+1)},$scope.gotoLastPage=function(){var curPageNum=$scope.pageState.pageNum,pageTotal=$scope.pageState.pageTotal;curPageNum!==pageTotal&&getPageMember(pageTotal)},$scope.$watch(function(){return orgMemberService.getMembers()},function(curMemberlist){members=curMemberlist,$scope.pageState.total=members.length,$scope.pageState.pageTotal=parseInt((members.length-1)/pageSize,10)+1,$scope.members=[],getPageMember($scope.pageState.pageNum||1)}),$scope.$watch(function(){return orgMemberService.getMyRole()},function(myRole){$scope.myRole=myRole}),$scope.getGroupName=function(groupAndMember){return groupAndMember.group.name},$scope.forwardGroup=function(groupAndMember){router.forward("/"+groupAndMember.group.id)},$scope.getGroupRole=function(groupAndMember){var role="";switch(groupAndMember.member.role){case"ROLE_GROUP_USER":role="编辑者";break;case"ROLE_GROUP_MANAGER":role="管理员";break;case"ROLE_GROUP_FOUNDER":role="群主";break;case"ROLE_GROUP_READER":role="只读者";break;default:role="编辑者"}return role},$scope.getOrgRole=function(){var role="";switch($scope.myRole){case"ROLE_ORG_MANAGER":role="组织管理员";break;case"ROLE_ORG_EDITOR":role="组织编辑者"}return role},$scope.showGroups=function(memberId){getMemberGroupList(memberId,0,GROUPNUMLIMIT)},$scope.showRemainingGroups=function(memberId,$event){getMemberGroupList(memberId,GROUPNUMLIMIT,100),$event.stopImmediatePropagation()},$scope.haveRemainingGroups=function(memberId){var gList=$scope.memberGroup[memberId];return gList&&gList.length!==$scope.memberGroupNum[memberId]},$scope.newP2PDialog=function(user){$rootScope.$broadcast("p2p.chat",user)}}}),define("pagelet/orgSetting/members/orgInvitationCtrl",["underscore","analyzer"],function(_){"use strict";return function($scope,dialogService,orgMemberService,$q,userService){var timeoutDefer=null,checkUserAdded=function(list,prefix){var i;for(i=0;i<list.length;i++)list[i].added=!_.isUndefined(_.findWhere(orgMemberService.getMembers(),{userId:list[i].userId}));$scope.noFound=!1,prefix?($scope.results=[],$scope.users=list):($scope.results=list,$scope.users=[])},getSearchList=function(name){null!==timeoutDefer&&(timeoutDefer.promise.status=499,timeoutDefer.resolve()),$scope.users=[],timeoutDefer=$q.defer(),$scope.searchCompleted=!1,userService.searchPrefix(name,timeoutDefer).then(function(list){return timeoutDefer=null,$scope.searchCompleted=!0,0===list.length?void($scope.noFound=!0):void checkUserAdded(list,!0)})},init=function(){$scope.searchName="",$scope.users=[],$scope.searchCompleted=!0};$scope.inviteForUserId=function(userId,added){added||(dialogService.open($scope,{src:"pagelet/sidebar/userInfo/userInfo-dialog.html",userId:userId,isVisit:!0,added:added,cls:"user-info"}),$scope.prefixName="")},$scope.searchPrefix=getSearchList,$scope.$watch("orgId()",init),$scope.$watch("prefixName",function(name){name?getSearchList(name):($scope.users=[],$scope.results=[],null!==timeoutDefer&&(timeoutDefer.promise.status=499,timeoutDefer.resolve()))})}}),define("pagelet/orgSetting/plugin/operateGroupCtrl",["underscore"],function(){"use strict";return function($scope,launcher,rootScope,router,dialogs,organizationService){function recoverGroup(){dialogs.confirm("还原群","点击确定还原该群？如果原群主已不在组织内，你将成为该群群主").then(function(){organizationService.recoverGroup(launcher.orgId(),launcher.gid()).then(function(){window.location.reload()}).catch(function(e){"51003"===e.error?dialogs.alert("还原群失败","该群已经被彻底删除了").then(function(){router.forward("/")}):"51012"===e.error?dialogs.alert("提示","抱歉，企业版已过期，暂时无法完成还原。购买请联系youdaogroup@service.netease.com"):dialogs.alert("还原群失败","服务器错误，请稍后重试")})})}function eraseGroup(){dialogs.confirm("删除","点击确定彻底删除该群？").then(function(){organizationService.eraseGroup(launcher.orgId(),launcher.gid()).then(function(){rootScope.$broadcast("org.group.erase"),router.forward("/org/"+launcher.orgId()+"/groups")}).catch(function(e){"51003"===e.error?dialogs.alert("删除群失败","该群已经被彻底删除了").then(function(){router.forward("/")}):"51012"===e.error?dialogs.alert("提示","抱歉，企业版已过期，暂时无法完成清除。购买请联系youdaogroup@service.netease.com"):dialogs.alert("删除群失败","服务器错误，请稍后重试")})})}function joinGroup(){dialogs.confirm("加入该群","点击确定直接加入该群？加入后您将成为该群的群管理员。").then(function(){organizationService.joinGroup(launcher.gid(),"").then(function(){window.location.reload()}).catch(function(e){switch(e.error){case"51012":dialogs.alert("提示","抱歉，企业版已过期，暂时无法加入。购买请联系youdaogroup@service.netease.com")}dialogs.alert("加入群失败","服务器错误，请稍后重试")})})}$scope.recoverGroup=recoverGroup,$scope.joinGroup=joinGroup,$scope.eraseGroup=eraseGroup}}),define("orgSettingModule",["angular","commonModule","pagelet/orgSetting/orgSettingInit","pagelet/orgSetting/orgSettingCtrl","pagelet/orgSetting/setting/orgInfoCtrl","pagelet/orgSetting/groups/orgGroupsController","pagelet/orgSetting/myGroups/myGroupsController","pagelet/orgSetting/groups/groupController","pagelet/orgSetting/members/orgMembersCtrl","pagelet/orgSetting/members/orgMemberService","pagelet/orgSetting/members/orgInvitationCtrl","pagelet/orgSetting/plugin/operateGroupCtrl"],function(angular,commonModule,orgSettingInit,orgSettingCtrl,orgInfoCtrl,orgGroupsController,myGroupsController,groupController,orgMembersCtrl,orgMemberService,orgInvitationCtrl,operateGroupCtrl){"use strict";return angular.module("organization",[commonModule.name]).service("orgMemberService",["organizationService","dialogService","applicantService","$q","$rootScope","aliasService","launcher","ROLES","NOTIFICATION_TYPE",orgMemberService]).controller("orgSettingCtrl",["$scope","$q","launcher","permissionService",orgSettingCtrl]).controller("orgGroupsController",["$scope","$rootScope","$q","$filter","launcher","dialogService","organizationService",orgGroupsController]).controller("myGroupsController",["$scope","$rootScope","$q","$filter","launcher",myGroupsController]).controller("groupController",["$scope",groupController]).controller("orgMembersCtrl",["$scope","$rootScope","launcher","router","organizationService","dialogService","orgMemberService","ROLES","GROUP_EVENTS",orgMembersCtrl]).controller("orgInfoCtrl",["$scope","dialogService","launcher","organizationService","$q","$timeout","$rootScope","ORG_EVENTS","titleService","groupTopService",orgInfoCtrl]).controller("orgInvitationCtrl",["$scope","dialogService","orgMemberService","$q","userService",orgInvitationCtrl]).controller("operateGroupCtrl",["$scope","launcher","$rootScope","router","dialogService","organizationService",operateGroupCtrl]).run(["launcher","viewport","permissionService","$q","organizationService","orgMemberService","ROLES",orgSettingInit])}),define("app/config",["angular","underscore"],function(angular,_){"use strict";function param(obj){var name,value,fullSubName,subName,subValue,innerObj,i,query="";for(name in obj)if(obj.hasOwnProperty(name))if(value=obj[name],value instanceof Array)for(i=0;i<value.length;++i)subValue=value[i],fullSubName=name+"["+i+"]",innerObj={},innerObj[fullSubName]=subValue,query+=param(innerObj)+"&";else if(value instanceof Object)for(subName in value)value.hasOwnProperty(subName)&&(subValue=value[subName],fullSubName=name+"["+subName+"]",innerObj={},innerObj[fullSubName]=subValue,query+=param(innerObj)+"&");else void 0!==value&&null!==value&&(query+=encodeURIComponent(name)+"="+encodeURIComponent(value)+"&");return query.length?query.substr(0,query.length-1):query}function getCookie(name){var i,kv,cookie=document.cookie,cookies=cookie.split(";");for(i=0;i<cookies.length;i++)if(kv=cookies[i].split("="),$.trim(kv[0])===name)return kv[1]&&kv[1].length?kv[1]:null;return!1}return function($httpProvider,$locationProvider){var params,isPC=window.hasOwnProperty("YGroup"),isMac=window.hasOwnProperty("YGroupMac"),regexp=/^\/yws\/.+$/,keyfrom="web";isPC&&(keyfrom="pc"),isMac&&(keyfrom="note.0.0.0.mac"),params={keyfrom:keyfrom},$locationProvider.html5Mode(!0),$httpProvider.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8",$httpProvider.defaults.transformRequest=[function(data){return param(data)}],$httpProvider.interceptors.push(function(){var networkError=!1,interceptor=function($timeout,$q,$rootScope){return{request:function(opt){return regexp.test(opt.url)?(opt.params||(opt.params={}),_.extend(opt.params,params),/(?:\/yws\/mapi\/user)/i.test(opt.url)&&opt.params&&opt.params.method&&("get"===opt.params.method||"regsiter"===opt.params.method||"edm"===opt.params.method)||/(?:\/yws\/mapi\/res)/i.test(opt.url)||/(?:\/yws\/mapi\/ad)/i.test(opt.url)||/(?:\/yws\/mapi\/payment)/i.test(opt.url)||/(?:\/yws\/mapi\/ilogrpt)/i.test(opt.url)||/(?:\/yws\/public)/i.test(opt.url)||/(?:\/mapi\/weibo\/share)/i.test(opt.url)?opt:("get"===opt.method.toLowerCase()||"delete"===opt.method.toLowerCase()?_.extend(opt.params,{cstk:getCookie("YNOTE_CSTK")}):(opt.data||(opt.data={}),_.extend(opt.data,{cstk:getCookie("YNOTE_CSTK")})),opt)):opt},response:function(response){return networkError&&($rootScope.$broadcast("networkSuccess"),networkError=!1),$q.when(response)},responseError:function(response){var status=response.status,isClientCancelled=!1;return response.config&&response.config.timeout&&499===response.config.timeout.status&&(isClientCancelled=!0),0!==status||isClientCancelled||($rootScope.$broadcast("networkError"),networkError=!0),status>=500&&600>status&&$rootScope.$broadcast("serverError"),$q.reject(response)}}};return interceptor.$inject=["$timeout","$q","$rootScope"],interceptor}())}}),define("app/groupCtrl",[],function(){"use strict";return function($scope,launcher,clientProxy,storageMgr,$location,dialogService){function initMinUI(){$scope.state="ready",$scope.notPC=!clientProxy.isPC(),$scope.fullScreen=$location.search().full}$scope.key=function(ua){return ua.toLowerCase().indexOf("macintosh")>0?"⌘ + D":"Ctrl + D"}(window.navigator.userAgent),$scope.getUser=function(){return launcher.getUser()},$scope.uid=function(){return launcher.getUser()?launcher.getUser().userId:void 0},$scope.gid=function(){var grp=launcher.getGroup();if(grp)return grp.id},$scope.orgId=function(){return launcher.orgId()},$scope.getGroups=function(){return launcher.getGroups()},$scope.joinGroup=function(){dialogService.open($scope,{src:"pagelet/sidebar/joinGroup/joinGroup-dialog.html",userId:$scope.uid(),cls:"join-group"})},$scope.client=clientProxy,$scope.logout=launcher.logout,$scope.forwardRoot=function(){launcher.getGroupRouter().forward("/")},launcher.wait().then(initMinUI),$scope.$on("$locationChangeSuccess",function(){$scope.fullScreen=$location.search().full})}}),define("app/viewport/viewport",["underscore"],function(_){"use strict";return function($rootScope,$location,$q,extension,launcher,titleService){function attach(newDelegate){delegate=newDelegate,$rootScope.$evalAsync(loadViews)}function openView(viewName,opt){if(0===Object.keys(views).length){var defer=$q.defer();return setTimeout(function(){openView(viewName,opt).then(function(res){defer.resolve(res)}).catch(function(res){defer.reject(res)})},50),defer.promise}var cfg=views[viewName];return cfg?openSrc(cfg.src,opt,cfg.center).then(function(title){return clearOptions(view),view=viewName,memOptions[viewName]=opt,title&&$location.search().full&&(_.isObject(title)?titleService.set(titleService.Priority.FILENAME,title.name):titleService.set(titleService.Priority.FILENAME,title)),title}):$q.reject(viewName)}function openSrc(src,opt,center){return delegate(src,opt,center)}function clearOptions(viewName){var prefix=getPrefix(viewName),search=$location.search();_.each(search,function(v,k){0===k.indexOf(prefix)&&$location.search(k,null)})}function getPrefix(viewName){return(viewName||"")+"_"}function loadViews(){extension(VIEWPORT_VIEW,function(name,src,center){views[name]={src:src,center:center||!1}})}function getView(){return view}var view,delegate,VIEWPORT_VIEW="ext.viewport.view",views={},memOptions={};this.open=openView,this.getView=getView,this.extendView=extension.declare("ext.viewport.view"),this.attach=attach}}),define("app/router",["underscore"],function(_){"use strict";return function($rootScope,$location,$q){function onLocationChange($evt){var newPath=$location.path(),newParams=getParams();newPath===lastPath&&_.isEqual(newParams,lastParams)||($evt.preventDefault(),rootRouter.forward($location.path(),newParams))}function getParams(){var params={};return _.each($location.search(),function(v,k){"_"===k[0]&&"_"!==k&&(params[k.substring(1)]=v)}),params}function setParams(params){_.each(_.keys($location.search()),function(k){0===k.indexOf("_")&&$location.search(k,null)}),_.each(params,function(v,k){$location.search("_"+k,v)})}function Router(handler,parent){function matchNext(part,params){var value,nextPath="",nextRouter=null,paramName=null,regexp=/\{([^\/]+)\}/;return params=_.clone(params),part?children[part]?(nextRouter=children[part],nextPath="/"+part):(_.each(children,function(child,key){var matches=key.match(regexp);null!==matches&&(nextRouter=child,paramName=matches[1])}),nextRouter&&(value=_.isNaN(Number(part))?part:Number(part),params[paramName]=value),nextPath="/"+value):children.NULL&&(nextRouter=children.NULL,nextPath=""),{router:nextRouter,path:nextPath,params:params}}function routeNext(thisPathArray,params,hideParams){var nextPart=thisPathArray[0],next=matchNext(nextPart,params);return next.router?next.router.route(thisPathArray.slice(1),next.params,next.path,hideParams):$q.when(null)}var children={},before=[],after=[],state={path:"",params:{},hideParams:{}};this.forward=function(path,params,hideParams){var pathArray=_.reject((this.path()+path).split("/"),function(part){return""===part});return params=params||{},hideParams=hideParams||{},rootRouter.route(pathArray,_.clone(params),"",_.clone(hideParams)).then(function(){lastPath="/"+pathArray.join("/"),setParams(params),lastParams=getParams(),$location.path("/"+pathArray.join("/"))}).catch(function(){return setParams(lastParams),$location.path(lastPath).replace(),$q.reject()})},this.bind=function(path,nextHandler){return 1===arguments.length&&(nextHandler=path,path=null),path=path||null,null===path?this.bindNested(null,nextHandler):this.bindNested(_.reject(path.split("/"),function(part){return""===part}),nextHandler)},this.bindNested=function(pathArray,nextHandler){var next,key,result;return _.isArray(pathArray)&&pathArray.length>0?(key=pathArray.shift(),children[key]?children[key].bindNested(pathArray,nextHandler):(0===pathArray.length?next=new Router(nextHandler,this):(next=new Router(null,this),result=next.bindNested(pathArray,nextHandler)),children[key]=next)):next=children.NULL=new Router(nextHandler,this),void 0!==result?result:next},this.route=function(thisPathArray,params,newPath,hideParams){return function(){return $q.all(_.map(before,function(interceptor){return $q.when(interceptor(thisPathArray,params))}))}().then(function(){return _.isFunction(handler)?(console.log("Router.handler",this.toString(),handler.name,params),$q.when(handler(_.extend(params,hideParams)))):$q.when(null)}.bind(this)).then(function(){return routeNext(thisPathArray,_.clone(params),_.clone(hideParams))}).then(function(){return $q.all(_.map(after,function(interceptor){return $q.when(interceptor(thisPathArray,params))}))}).then(function(){state.path=newPath||"",state.params=params,state.hideParams=hideParams})},this.release=function(){parent.removeNext(this)},this.removeNext=function(next){children=_.reject(children,next)},this.before=function(interceptor){return before.push(interceptor),function(){before=_.without(before,interceptor)}},this.after=function(interceptor){return after.unshift(interceptor),function(){after=_.without(after,interceptor)}},this.toString=function(){return this.path()},this.path=function(){return parent?parent.path()+state.path:state.path}}var rootRouter=new Router(null,null),lastPath="/",lastParams={};return $rootScope.$on("$locationChangeSuccess",onLocationChange),rootRouter}}),define("app/launcher",["underscore","bower_components/util/src/cookies","util/tracker"],function(_,cookies,tracker){"use strict";return function($rootScope,$q,$location,$http,$timeout,router,groups,users,orgs,alias,pomelo,dialogs,clientProxy,applicants,updater,masker,ROLES,ORG_EVENTS,settings,storageMgr,NOTIFICATION_TYPE,titleService,LOCAL_STORAGE_KEY){function bootstrap(){var loadEnd,range,tag,loadStart=(new Date).getTime();return initialPromise=updater().then(function(){var ynote_loginCookie=cookies.get("YNOTE_LOGIN");return ynote_loginCookie?$q.when(null):$http.get("/login/acc/pe/getsess?product=YNOTE")}).catch(function(){}).then(function(){return $http.get("/yws/mapi/user",{params:{method:"get"}})}).then(function(req){var defer=$q.defer(),userMeta=req.data;return users.getCurrentUserInfo().then(function(newUser){user=newUser,user.is_vip=userMeta.is_vip,user.org_purchased=-1!==userMeta.org_purchase_ts,user.org_trail=-1!==userMeta.org_trial_ts,user.is_3rd=-1===userMeta.uid.indexOf("@"),pomelo.connect(user.userId),orgs.hasOwnedOrg().then(function(result){user.hasOwnedOrg=result},function(){user.hasOwnedOrg=!1}),defer.resolve(user)}).catch(function(e){defer.reject(e)}),defer.promise}).catch(function(res){if("500"==res.status)requireLogin();else{$rootScope.loadingError=!0;var error=JSON.stringify(res);res&&res.data&&res.data.error?error=res.data.error:res&&res.error?error=res.error:res&&res.ecode&&(error=res.ecode),tracker.event("error","loadingError","loadingError-"+error)}return $q.reject("notLogined")}).then(function(){var defer=$q.defer();return groups.getMyGroups(function(groups){defer.resolve(groups)},function(){defer.resolve([])}),$q.all([defer.promise,orgs.getOrg()])}).then(function(res){var myGroups=res[0],myOrgs=res[1];return orgList=myOrgs,$rootScope.taskFlag={},assignGroupToOrg(myGroups,orgList),list=myGroups,bindRouters(),myGroups}).then(function(){loadEnd=(new Date).getTime(),range=5e3*parseInt((loadEnd-loadStart)/5e3,10),tag="serverload:"+range+"-"+(range+5e3),_hmt.push(["_trackEvent","page","serverload",tag,loadEnd-loadStart]),$rootScope.$$postDigest(function(){var params=function(){var params={};return _.each($location.search(),function(v,k){"_"===k[0]&&"_"!==k&&(params[k.substring(1)]=v)}),params}();router.forward($location.path(),params)})}).catch(function(e){return"notmember"===e?(forwardFirst(),$q.reject(null)):"notLogined"===e?$q.reject(e):void 0})}function wait(){return initialPromise}function waitLab(){return labDeferred.promise}function gid(){return group?group.id:null}function clearGroupAndOrg(){group=null,org=null}function setGroup(newGroup){var oldGroup=group;group=newGroup,$rootScope.group=group,$rootScope.$broadcast("group.changed",group?group.id:null,oldGroup?oldGroup.id:null)}function setOrg(newOrg){var oldOrg=org;oldOrg!==newOrg&&(org=newOrg,$rootScope.$broadcast("org.changed",org,oldOrg))}function uid(){return user?user.userId:null}function orgId(){return org?org.id:null}function getUser(){return user}function getGroup(){return group}function getOrg(){return org}function getGroups(){return list}function getOrgs(){return orgList}function bindRouters(){router.bind("/",locateFirstTab),router.bind("/logout",doLogout),groupRouter=router.bind("/{gid}",locateGroup),orgRouter=router.bind("/org/{orgId}",locateOrg)}function locateOrg(params){return titleService.clearAll(),setGroup(null),org&&params.orgId===org.id?(titleService.set(titleService.Priority.GROUPNAME,org.name),$q.when(null)):(setOrg(_.findWhere(orgList,{id:Number(params.orgId)})),function(){return _.isUndefined(org)?(forwardFirst(),setOrgRole(null)):orgs.getRole(org.id,user.userId).then(function(myOrgRole){setOrgRole(myOrgRole?myOrgRole:null),checkTrailExpire(),titleService.set(titleService.Priority.GROUPNAME,org.name)})}())}function locateFirstTab(params){var openLastGidFailed=params.openLastGidFailed,lastClosedGroupId=storageMgr.forUser(user.userId).get(LOCAL_STORAGE_KEY.LAST_CLOSED_GROUP);return titleService.clearAll(),openLastGidFailed||_.isNull(lastClosedGroupId)?orgList.length>1?orgList[0].groups&&orgList[0].groups.length>0?(router.forward("/"+_.first(orgList[0].groups).id),$q.when()):(router.forward("/org/"+orgList[0].id+"/groups"),$q.when()):orgList[0].groups&&orgList[0].groups.length>0?(router.forward("/"+_.first(orgList[0].groups).id),$q.when()):null===group?$q.when():$q.reject():(router.forward("/"+lastClosedGroupId,{},{isOpenLastGid:!0}),$q.when())}function locateGroup(params){titleService.clearAll();var gid=params.gid,isOpenLastGid=params.isOpenLastGid;if(group&&gid===group.id)return titleService.set(titleService.Priority.GROUPNAME,group.name),$q.when(null);var tmpGroup,tmpOrg,tmpOrgRole,tmpGroupRole;return masker.push(),function(){var defer=$q.defer(),value=_.findWhere(list,{id:gid});return _.isObject(value)?$q.when(value):(groups.getGroup(gid,function(g){defer.resolve(g)},function(e){defer.reject(e)}),defer.promise)}().then(function(res){var defer=$q.defer(),newOrgId=Number(res.orgId);return tmpGroup=res,newOrgId===DEFAULT_ORGID?(tmpOrg=null,tmpOrgRole=null,defer.resolve(tmpGroup.deleted)):(tmpOrg=_.findWhere(orgList,{id:newOrgId}),orgs.getRole(newOrgId,user.userId).then(function(myOrgRole){tmpOrgRole=myOrgRole?myOrgRole:null,defer.resolve(tmpGroup.deleted)}).catch(function(e){defer.reject(e)})),defer.promise}).then(function(isDeleted){var defer=$q.defer();return groups.getMyRole(gid,user?user.userId:null).then(function(res){tmpGroupRole=isDeleted?ROLES.GROUP_RESTORER:res.role,defer.resolve(isDeleted)}).catch(function(e){tmpOrg&&-1!==[ROLES.ORG_OWNER,ROLES.ORG_MANAGER].indexOf(tmpOrgRole)?(tmpGroupRole=isDeleted?ROLES.GROUP_RESTORER:ROLES.GROUP_VIEWER,defer.resolve(isDeleted)):defer.reject(e)}),defer.promise}).catch(function(e){return isOpenLastGid||errorAlert(e,gid),group||forwardFirst(!0),$q.reject(e)}).then(function(){setGroup(tmpGroup),setOrg(tmpOrg),titleService.set(titleService.Priority.GROUPNAME,group.name),setGroupRole(tmpGroupRole),setOrgRole(tmpOrgRole)}).then(function(){return $http.get("/yhs/api/"+group.id+"/lab-settings",{params:{userId:group.owner}}).then(function(res){group.settings=res.data,labDeferred.resolve()}).catch(function(){group.settings={},labDeferred.resolve()}),$q.when()}).finally(function(){masker.pop()})}function forwardFirst(openLastGidFailed){var preGroup=group,preOrg=org;return setGroup(null),setOrg(null),$location.search("full",null),router.forward("/",{},{openLastGidFailed:openLastGidFailed}).catch(function(){return setGroup(preGroup),setOrg(preOrg),$q.reject()
})}function forward(idOrGroup){var gid;return gid=_.isObject(idOrGroup)?idOrGroup.gid:Number(idOrGroup),router.forward("/"+gid)}function errorAlert(e,id,preventNested){return e&&e.error&&"10000"===e.error?(dialogs.alert("提示","该群“"+id+"”不存在或已经解散"),!0):e&&e.error&&("30001"===e.error||"260"===e.error||"51002"===e.error)?(groups.getGroup(id,function(group){forwardFirst(),dialogs.confirm("提示","你不在该协作群“"+group.name+"”, 是否申请加入？",{width:360,ok:"申请加入"}).then(function(){dialogs.open({title:"加入群",group:group,src:"pagelet/sidebar/joinGroup/joinConfirm-dialog.html"})},function(){})},function(e){preventNested||errorAlert(e,id,!0)}),!0):!1}function startUserMonitor(){var state=null,keyField=["P_INFO","S_INFO","YNOTE_LOGIN"];setInterval(function(){var newState={};_.each(keyField,function(field){newState[field]=cookies.get(field)}),null===state?state=newState:_.isEqual(state,newState)||users.getCurrentUserInfo().then(function(newUser){user.userId!==newUser.userId?location.reload():state=newState}).catch(requireLogin)},1e3)}function assignGroupToOrg(myGroups,myOrgs){var defaultOrg={id:DEFAULT_ORGID,groups:[]};_.each(myGroups,function(myOrgGroup){if(0!==myOrgGroup.orgId){var myOrg=_.findWhere(myOrgs,{id:myOrgGroup.orgId});myOrg&&(_.isArray(myOrg.groups)?myOrg.groups.push(myOrgGroup):myOrg.groups=[myOrgGroup])}else defaultOrg.groups.push(myOrgGroup)}),myOrgs.push(defaultOrg)}function reload(){function doRefresh(myGroups){list=myGroups,orgs.getOrg().then(function(myOrgs){assignGroupToOrg(myGroups,myOrgs),orgList=myOrgs,defer.resolve(orgList)})}var defer=$q.defer();return groups.getMyGroups(doRefresh,function(e){e&&"10000"===e.error&&doRefresh([])}),defer.promise}function logout(){router.forward("/logout")}function doLogout(){return titleService.clearAll(),users.logout().then(function(){$location.search("logout",null),redirectToLogin("http://note.youdao.com/group")}),$q.reject()}function requireLogin(res){var url=encodeURIComponent(window.location.href),error=JSON.stringify(res);res&&res.data&&res.data.error?error=res.data.error:res&&res.error?error=res.error:res&&res.ecode&&(error=res.ecode),tracker.event("error","requireLogin",error),redirectToLogin(url)}function redirectToLogin(url){window.location.href="http://note.youdao.com/signIn/group.html?&callback="+url}function getGroupRouter(){return groupRouter}function getOrgRouter(){return orgRouter}function onGroupCreate(){reload().then(function(){null===group&&null===org&&forwardFirst()})}function onMemberEvent(evt,content,value){var action=value.action,gid=value.groupId;switch(action){case 0:reload().then(function(){null===group&&null===org&&forwardFirst(),value.user.userId===user.userId&&addGroupToCanCopyToList(value.groupId)});break;case 1:if(value.object.userId!==user.userId)break;reload().then(function(){1===list.length&&forwardFirst(),addGroupToCanCopyToList(value.groupId)});break;case 2:reload();break;case 7:reload().then(function(){value.user.userId===user.userId&&addGroupToCanCopyToList(value.groupId)});break;case 3:if(value.object.userId!==user.userId)return;if(removeGroupFromCanCopyToList(value.groupId),$rootScope.$broadcast("group.exit.this",value),list=_.reject(list,function(g){return g.id===gid}),group&&group.id!==gid)return void reload();reload().then(function(){forwardFirst()});break;case 4:if(value.object.userId!==user.userId)return;removeGroupFromCanCopyToList(value.groupId),$rootScope.$broadcast("group.remove.copy",value),reload(),group&&group.id===gid&&dialogs.alert("通知","您已经被管理员从群"+group.name+"中移除。").then(forwardFirst),$rootScope.$broadcast("group.quit.this")}}function onGroupEvent(evt,content,value){var effectGroup=_.findWhere(list,{id:value.groupId});if(group&&group.id===value.groupId&&(group.name=value.groupName),0===value.action)return void reload().then(function(){null===group&&null===org&&forwardFirst(),addGroupToCanCopyToList(value.groupId)});if(null!==effectGroup)if(1===value.action){effectGroup.name=value.groupName;var tempGroup=_.findWhere(groupsCanCopyTo,{id:value.groupId});tempGroup&&(tempGroup.name=value.groupName),$rootScope.$broadcast("group.update.copy",value)}else 2===value.action&&(removeGroupFromCanCopyToList(value.groupId),$rootScope.$broadcast("group.dismiss.copy",value),onGroupDismiss(evt,value))}function onOrgEvent(content){if(content.type===NOTIFICATION_TYPE.ENROLLED_IN_ORG)return void reload().then(function(){null===group&&null===org&&forwardFirst()});if(content.type===NOTIFICATION_TYPE.KICKED_OUT_FROM_ORG)return org&&org.id===content.orgId?void dialogs.alert("通知","您已被管理员从“"+org.name+"”组织中移除").then(function(){setGroup(null),setOrg(null),orgs.hasOwnedOrg().then(function(result){user.hasOwnedOrg=result}),reload().then(function(){forwardFirst()})}):void reload();if(content.type===NOTIFICATION_TYPE.INNER_GRP_RECOVERD&&reload(),content.type===NOTIFICATION_TYPE.ORG_DISMISS){if(!org||org.id!==content.orgId)return void reload();dialogs.alert("通知","您所在的“"+org.name+"”组织已经解散").then(function(){setGroup(null),setOrg(null),orgs.hasOwnedOrg().then(function(result){user.hasOwnedOrg=result}),reload().then(function(){forwardFirst()})})}}function onGroupDismiss(evt,groupToDismiss){if(!_.isUndefined(groupToDismiss)&&_.findWhere(orgList,{id:groupToDismiss.orgId})&&(orgList=_.map(orgList,function(value){return value.id===groupToDismiss.orgId&&(value.groups=_.reject(value.groups,function(g){return g.id===groupToDismiss.id||g.id===groupToDismiss.groupId})),value}),list=_.reject(list,function(g){return g.id===groupToDismiss.groupId}),group&&(groupToDismiss.id===group.id||groupToDismiss.groupId===group.id))){var alertMsg=org?"您所在的内部群已经解散":"您所在的群已经解散";dialogs.alert("通知",alertMsg).then(function(){if(setGroup(null),titleService.set(titleService.Priority.GROUPNAME,void 0),$location.search("full",null),groupToDismiss.orgId!==DEFAULT_ORGID){var myOrg=_.findWhere(orgList,{id:groupToDismiss.orgId});if(myOrg&&myOrg.groups.length>0)return router.forward("/"+_.first(myOrg.groups).id);if(myOrg)return router.forward("/org/"+myOrg.id+"/groups")}return forwardFirst()})}}function onOrgGroupDelete(evt,content){org&&group&&content.orgId===org.id&&content.groupId===group.id&&dialogs.alert("通知","你所在的内部群已经被彻底删除了").then(function(){if(setGroup(null),content.orgId!==DEFAULT_ORGID){var myOrg=_.findWhere(orgList,{id:content.orgId});if(myOrg&&myOrg.groups.length>0)return router.forward("/"+_.first(myOrg.groups).id);if(myOrg)return router.forward("/org/"+myOrg.id+"/groups")}return forwardFirst()})}function onOrgGroupRecover(evt,content){org&&group&&content.orgId===org.id&&content.groupId===group.id&&dialogs.alert("通知","你所在的内部群已经被还原了").then(function(){window.location.reload()})}function isVIP(){return user.is_vip}function hasPurchasedOrg(){return user.org_purchased||user.org_trail}function hasOwnedOrg(){return user.hasOwnedOrg}function getCurrentRole(){return currentRoles}function isOrgExpired(org){return org&&org.expireTime&&org.expireTime.getTime()<(new Date).getTime()?!0:!1}function setGroupRole(role){currentRoles=_.reject(currentRoles,function(value){return-1!==value.indexOf("ROLE_GROUP")}),role&&currentRoles.push(role)}function setOrgRole(role){currentRoles=_.reject(currentRoles,function(value){return-1!==value.indexOf("ROLE_ORG")||value===ROLES.ORG_EXPIRED}),role&&(currentRoles.push(role),isOrgExpired(org)&&currentRoles.push(ROLES.ORG_EXPIRED))}function checkTrailExpire(){if(org&&org.leftTrailDays&&org.leftTrailDays<0){var storage=storageMgr.forAll(),sf=storage.get(LOCAL_STORAGE_KEY.TRAIL_EXPIRE_WARNING),now=new Date,getDateString=function(date){return[date.getFullYear(),date.getMonth()+1,date.getDate()].join("-")};sf&&sf===getDateString(now)||dialogs.alert("企业版试用到期提醒","您的企业版试用时间已经截止，如需进一步使用请联系创建者购买企业版。购买联系youdaogroup@service.netease.com").finally(function(){storage.put(LOCAL_STORAGE_KEY.TRAIL_EXPIRE_WARNING,getDateString(now))})}}function getTrailCode(){return trailCode?trailCode:trailKey?trailKey:void 0}function getGroupsCanCopyTo(){var defer=$q.defer();if(null!==groupsCanCopyTo)return $q.when(groupsCanCopyTo);var rolesCanCopyFiles=["ROLE_GROUP_FOUNDER","ROLE_GROUP_EDITOR","ROLE_GROUP_MANAGER"];return groupsCanCopyTo=[],$q.all(_.map(list,function(group){return groups.getMyRole(group.id,user?user.userId:null)})).then(function(results){groupsCanCopyTo=_.map(_.reject(_.zip(list,results),function(v){return!_.contains(rolesCanCopyFiles,v[1].role)}),function(v){return v[0]}),defer.resolve(groupsCanCopyTo)}),defer.promise}function addGroupToCanCopyToList(gid){var tempGroup=_.findWhere(list,{id:gid}),sameGroup=_.findWhere(groupsCanCopyTo,{id:gid});tempGroup&&!sameGroup&&null!==groupsCanCopyTo&&groupsCanCopyTo.unshift(tempGroup)}function removeGroupFromCanCopyToList(gid){null!==groupsCanCopyTo&&(groupsCanCopyTo=_.reject(groupsCanCopyTo,function(g){return g.id===gid}))}function getGroupsOwnedByMe(){return _.filter(list,function(group){return group.owner===user.userId})}var user=null,group=null,org=null,list=[],orgList=[],groupRouter=null,orgRouter=null,initialPromise=null,labDeferred=$q.defer(),currentRoles=[],DEFAULT_ORGID=0,trailCode=$location.search()["try"],trailKey=$location.search().key,groupsCanCopyTo=null;$(window).on("beforeunload",function(){if(user&&user.userId&&group){var userStorage=storageMgr.forUser(user.userId);userStorage.put(LOCAL_STORAGE_KEY.LAST_CLOSED_GROUP,group.id)}}),$rootScope.$on("socket.event.11",function(evt,content){_.extend(user,content.value)}),$rootScope.$on(ORG_EVENTS.QUIT,function(){reload().then(forwardFirst)}),$rootScope.$on(ORG_EVENTS.DISMISS,function(){$http.get("/yws/mapi/user",{params:{method:"get"}}).then(function(req){var userMeta=req.data;user.is_vip=userMeta.is_vip,user.org_purchased=-1!==userMeta.org_purchase_ts,user.org_trail=-1!==userMeta.org_trial_ts},function(){location.reload()})}),$rootScope.$on("labs.change",function($evt,setting){group&&_.indexOf(setting.groupIds,group.id)>=0&&(group.settings[setting.id]=setting.active,$rootScope.$apply())}),this.gid=gid,this.uid=uid,this.clearGroupAndOrg=clearGroupAndOrg,this.orgId=orgId,this.getUser=getUser,this.getGroup=getGroup,this.getOrg=getOrg,this.getGroups=getGroups,this.forward=forward,this.forwardOrJoin=forward,this.bootstrap=bootstrap,this.wait=wait,this.waitLab=waitLab,this.reload=reload,this.logout=logout,this.isVIP=isVIP,this.getOrgs=getOrgs,this.getGroupRouter=getGroupRouter,this.getOrgRouter=getOrgRouter,this.getCurrentRole=getCurrentRole,this.setGroupRole=setGroupRole,this.setOrgRole=setOrgRole,this.hasPurchasedOrg=hasPurchasedOrg,this.hasOwnedOrg=hasOwnedOrg,this.getTrailCode=getTrailCode,this.getGroupsCanCopyTo=getGroupsCanCopyTo,this.getGroupsOwnedByMe=getGroupsOwnedByMe,bootstrap().then(function(){alias.init(),startUserMonitor()}).then(function(){var deferred=$q.defer();return users.isYDocUser().then(function(isYDocUser){user.isYDocUser=isYDocUser}).finally(function(){deferred.resolve()}),deferred.promise}).then(function(){_.each([ORG_EVENTS.CREATE,ORG_EVENTS.JOIN,ORG_EVENTS.UPDATE],function(evt){$rootScope.$on(evt,reload)}),$rootScope.$on("socket.notification",function(evt,content){onOrgEvent(content)}),$rootScope.$on(groups.CREATE,onGroupCreate),$rootScope.$on(groups.JOIN,reload),$rootScope.$on(groups.UPDATE,reload),$rootScope.$on(groups.QUIT,function(){reload().then(function(){forwardFirst()})}),$rootScope.$on("socket.event.1",onMemberEvent),$rootScope.$on("socket.event.7",onGroupEvent),$rootScope.$on("socket.notification",function(evt,content){content.type===NOTIFICATION_TYPE.INNER_GRP_ERASED?onOrgGroupDelete(evt,content):content.type===NOTIFICATION_TYPE.INNER_GRP_RECOVERD&&onOrgGroupRecover(evt,content)})}).then(settings.fecthList).then(function(){setTimeout(getGroupsCanCopyTo,1e4)})}}),define("app/settings",["underscore"],function(_){"use strict";return function($rootScope,$q,groupService,userService){function getList(){return messageSettingList}function onSettingEvent(evt,content,value){var groupId=Number(value.groupId||0),messageSetting=Number(value.messageSetting||0);messageSettingList[groupId]=messageSetting}function update(groupId,msg){var defer=$q.defer();return groupService.updateSettings(groupId,msg,function(data){messageSettingList[data.groupId]=data.messageSetting,defer.resolve(data)},function(e){defer.reject(e)}),defer.promise}function fecthList(){var defer=$q.defer();return userService.getSettingList().then(function(data){_.each(data,function(item){messageSettingList[item.groupId]=item.messageSetting}),defer.resolve(data)}).catch(function(e){"10002"==e.error?defer.resolve([]):defer.reject(e)}),defer.promise}var messageSettingList={};$rootScope.$on("socket.event.9",onSettingEvent),this.update=update,this.getList=getList,this.fecthList=fecthList}}),define("app/members",["underscore"],function(_){"use strict";return function($rootScope,$q,$timeout,groupService,vipService,userService,alias,launcher,dialogs,applicants,orgService,ROLES){function getMembers(){return memberList}function getMember(userId){return _.findWhere(memberList,{userId:userId})}function wait(){return waitDefer.promise}function getInvitees(){return inviteeList}function getLimitNum(){return launcher.getGroup().memberLimit}function isInGroup(userId){var found=!1;return _.each(memberList,function(member){return member.userId===userId?void(found=!0):void 0}),found}function setMemberSortKey(member){return member.sortKey=member.role===ROLES.GROUP_FOUNDER?0:member.role===ROLES.GROUP_MANAGER?1:member.role===ROLES.GROUP_EDITOR?2:member.role===ROLES.GROUP_READER?3:4,member}function getMemberKey(role){var result;return result=role===ROLES.GROUP_FOUNDER?0:role===ROLES.GROUP_MANAGER?1:role===ROLES.GROUP_EDITOR?2:role===ROLES.GROUP_READER?3:4}function sortMembersByRole(members){return _.sortBy(members,function(member){return member.sortKey})}function addMember(member,roleString){var newMember=new groupService.Member(_.extend(member,{groupId:launcher.getGroup().id,role:roleString||ROLES.GROUP_EDITOR}));setMemberSortKey(newMember),_.findWhere(memberList,{userId:member.userId})||(memberList=sortMembersByRole(_.union(memberList,[newMember]))),removeInvitee(member),$rootScope.$broadcast(EVENT.CHANGED,memberList)}function removeMember(member){memberList=_.reject(memberList,function(value){return value.userId===member.userId}),$rootScope.$broadcast(EVENT.CHANGED,memberList)}function changeMemberRole(news){news=new groupService.Member(news),memberList=_.map(memberList,function(member){return member.userId===news.userId&&(member.role=news.role,member.userId===launcher.getUser().userId&&launcher.setGroupRole(member.role),member=setMemberSortKey(member)),member}),memberList=sortMembersByRole(memberList),$rootScope.$broadcast(EVENT.CHANGED,memberList)}function removeMemberByOther(member){dialogs.confirm("移除","您确定要移除"+member.name+"吗？").then(function(){groupService.removeMember(member.groupId,member.userId,function(){removeMember(member)},function(){dialogs.alert("成员管理","删除失败")})})}function addInvitee(invitee){var isAdded=!1;if(invitee)return _.each(inviteeList,function(one){one.userId===invitee.userId&&(isAdded=!0)}),isAdded?!1:(inviteeList=_.union(inviteeList,[new groupService.Member(invitee)]),!0)}function removeInvitee(invitee){inviteeList=_.reject(inviteeList,function(value){return value.userId===invitee.userId})}function removeInviteeByOther(invitee){removeInvitee(invitee),applicants.deleteInvitee(launcher.getGroup().id,invitee.userId).then()}function fetchMembers(groupId){null!==defer&&(defer.promise.status=499,defer.resolve()),defer=$q.defer(),waitDefer=$q.defer(),memberList=[],groupId=groupId||launcher.getGroup().id,groupService.getMembers(groupId,defer,function(members){defer=null,members=_.map(members,function(member){return member.userId===launcher.getUser().userId&&(member.name=launcher.getUser().name),member=setMemberSortKey(member)}),members=sortMembersByRole(members),alias.updateAliasList(members),memberList=members;for(var users=[],i=0;i<memberList.length;i++)void 0===vipService.vipList[memberList[i].userId]&&users.push(memberList[i].userId);users.length>0&&vipService.updateUsersVip(users.join(":")),$rootScope.$broadcast(EVENT.CHANGED,memberList),waitDefer.resolve()})}function fetchInvitees(groupId){null!==inviteeDefer&&(inviteeDefer.promise.status=499,inviteeDefer.resolve()),inviteeDefer=$q.defer(),inviteeList=[],applicants.listInvitee(groupId,inviteeDefer).then(function(invitees){inviteeDefer=null,inviteeList=invitees})}function changeRole(member,role){return defer=$q.defer(),groupService.changeRole(member.groupId,member.userId,role,function(news){changeMemberRole(news),defer.resolve(news)},function(e){defer.reject(e)}),defer.promise}function changeOwner(member){dialogs.confirm("转让群","您确定要将“"+launcher.getGroup().name+"”转让给 "+member.name+" 吗？转让成功后你将自动成为编辑者。").then(function(){groupService.changeOwner(member.groupId,member.userId,function(){launcher.setGroupRole(ROLES.GROUP_EDITOR),fetchMembers(member.groupId)},function(e){e&&e.error&&"10027"===e.error?dialogs.alert("转让群","无法转让，对方没有拥有高级群的资格，无法向其转让此群"):e&&e.error&&"10025"===e.error?dialogs.alert("转让群","转让失败，对方拥有的群已达上限"):dialogs.alert("转让群","转让失败，请稍后重试")})})}function getAtTargets(message){var targets;return targets=_.map(memberList.concat([{name:"所有人",userId:"all"}]),function(value){var name=value.name,re=new RegExp("(@"+name+" )");return re.test(message)?value.userId:void 0}),targets=_.uniq(_.without(targets,void 0)).join()}function onMemberEvent(evt,content,value){var member={},group=launcher.getGroup();if(group&&value.groupId===group.id)switch(value.action){case 0:addMember(value.user,value.value);break;case 1:addMember(value.object);break;case 2:addMember(value.object);break;case 7:addMember(value.user);break;case 3:removeMember(value.user);break;case 4:removeMember(value.object);break;case 5:member.userId=value.object.userId,member.role=value.value,changeMemberRole(member),member.userId===launcher.getUser().userId&&($rootScope.$broadcast("group.myRole.changed",value.value),value.value===ROLES.GROUP_READER&&dialogs.alertBySrc("提示","pagelet/setting/members/become-reader-alert.html",{height:"auto"}));break;case 6:value.object.userId===launcher.getUser().userId&&launcher.setGroupRole(ROLES.GROUP_FOUNDER),fetchMembers(value.groupId)}}var waitDefer,EVENT={CHANGED:"members.changed"},memberList=[],inviteeList=[],defer=null,inviteeDefer=null;$rootScope.$on("socket.event.1",onMemberEvent),$rootScope.$on("group.changed",function(evt,gid){gid&&(fetchMembers(gid),fetchInvitees(gid))}),this.EVENT=EVENT,this.getMembers=getMembers,this.getMember=getMember,this.getLimitNum=getLimitNum,this.getInvitees=getInvitees,this.addInvitee=addInvitee,this.removeMember=removeMemberByOther,this.removeInvitee=removeInviteeByOther,this.changeRole=changeRole,this.changeOwner=changeOwner,this.isInGroup=isInGroup,this.getMemberKey=getMemberKey,this.getAtTargets=getAtTargets,this.wait=wait}}),define("app/viewport/scaffoldingCtrl",["underscore"],function(_){"use strict";return function($scope,$q,$location,viewport,launcher,clientProxy,explorer,storageMgr,fileMgr,members,$window,groupTopService,groupService,ROLES,LOCAL_STORAGE_KEY,router){function showEnterpriseAdOrNot(){var defer=$q.defer(),filterGroups=_.filter(launcher.getGroups(),function(group){return group.size>=3?group:void 0});return filterGroups.length>0?$q.all(_.map(filterGroups,function(group){return groupService.getMyRole(group.id,launcher.uid())})).then(function(members){var roles=_.map(members,function(member){return member.role});defer.resolve(_.contains(roles,ROLES.GROUP_FOUNDER)||_.contains(roles,ROLES.GROUP_MANAGER))}):defer.resolve(!1),defer.promise}function showCateNavOrNot(){if(launcher.getOrg()){var currentOrg=launcher.getOrg();$scope.showCateNav=currentOrg.expireTime.getTime()>Date.now()&&8!==currentOrg.comboNum?!0:!1}else $scope.showCateNav=!1}var storage=storageMgr.forAll(),showEnterpriseAd=storage.get(LOCAL_STORAGE_KEY.DISABLE_ENTERPRISE_AD);showEnterpriseAd||1!=launcher.getOrgs().length?$scope.showEnterpriseAd=!1:showEnterpriseAdOrNot().then(function(result){$scope.showEnterpriseAd=result}),showCateNavOrNot(),$scope.launcher=launcher,$scope.client=clientProxy,$scope.members=members,$scope.viewport=viewport,$scope.explorer=explorer,$scope.loading=!1,$scope.$location=$location,$scope.gid=function(){return launcher.gid()},$scope.getGroupSize=function(){var memberList=members.getMembers();return memberList?memberList.length:1},$scope.disableEnterpriseAd=function(){storage.put(LOCAL_STORAGE_KEY.DISABLE_ENTERPRISE_AD,!0),$scope.showEnterpriseAd=!1},$scope.isTopGroup=function(gid){return groupTopService.isTopGroup(gid)},$scope.disableNetErr=function(){$scope.isNetworkError=!1},$scope.toggleUpGroup=function(group){$scope.isTopGroup(group.id)?groupTopService.delTopGroup(group.id):groupTopService.addTopGroup(group)},$scope.refresh=function(){$window.location.reload()},$scope.tab="data",$scope.$on("task.enter-task",function(){$scope.tab="tasks"}),router.before(function(){$scope.tab="data"}),$scope.$on("folderId.change",function(evt,folderId){$scope.folderId=folderId}),$scope.$on("group.changed",function(evt,gid){gid&&fileMgr.getFileByPath(gid,"/").then(function(root){$scope.folderId=root.id})}),$scope.$on("org.changed",function(evt,newOrg,oldOrg){newOrg!=oldOrg&&showCateNavOrNot()}),_.each(["networkError","socket.disconnect","socket.init.error","socket.bind.error","socket.getBindInfo.error"],function(channel){$scope.$on(channel,function(){$scope.isNetworkError=!0})}),_.each(["socket.reconnect","networkSuccess","socket.bind.success"],function(channel){$scope.$on(channel,function(){$scope.isNetworkError=!1})})}}),define("app/viewport/container",["underscore","jquery"],function(_,$){"use strict";function container($compile,$http,$templateCache,$q,viewport,launcher){var ctrl=function(scope,el){function openSrc(src,opt,center){function openOrInvoke(){return views[src]&&views[src]===currentView?(viewEl=views[src],invokeView(viewEl,opt)):closeView().then(openBySrc)}function openBySrc(){return views[src]?(viewEl=views[src],openView(viewEl,src,opt)):$http.get(src,{cache:$templateCache}).then(compile)}function compile(res){var tpl=res.data,compileDefer=$q.defer();return newScope=_.extend(scope.$new(),{$open:function(handler){viewEl.data("$open",handler),viewEl.data("center",center),openBySrc().then(compileDefer.resolve).catch(compileDefer.reject)},$invoke:function(handler){viewEl.data("$invoke",handler)},$close:function(handler){viewEl.data("$close",handler)}}),viewEl=$(tpl).hide(),center?centerCt.append(viewEl):fullCt.append(viewEl),views[src]=viewEl,$compile(viewEl)(newScope),compileDefer.promise}function openView(viewEl,src,opt,preventRestore){return invoke("$open",viewEl,opt).then(function(res){return viewEl.data("center")?fullCt.hide():fullCt.show(),currentView=viewEl.data("src",src).data("opt",opt).show(),res}).catch(function(e){return preventRestore||closeView().then(restore),$q.reject(e)})}function restore(){return previousView?openView(previousView,previousView.data("src"),previousView.data("opt"),!0):void launcher.getGroupRouter().forward("/")}function invokeView(viewEl,opt){return invoke("$invoke",viewEl,opt).then(function(res){return viewEl.data("opt",opt),res})}function closeView(){return currentView?invoke("$close",currentView).then(function(res){return currentView&&(previousView=currentView.hide()),currentView=null,res}):$q.when()}function invoke(name,viewEl,opt){var res,handler=viewEl.data(name);return _.isFunction(handler)?(res=handler(opt),res?res:$q.when()):$q.when()}var newScope,viewEl;return chain?chain.finally(function(){return openSrc(src,opt,center)}):chain=openOrInvoke().finally(function(){chain=null})}function bindCenter(el){centerCt=el}function bindFull(el){fullCt=el}var currentView,previousView,chain,views={},fullCt=(el.find(".chat-ct"),$()),centerCt=$();viewport.attach(openSrc),this.bindCenter=bindCenter,this.bindFull=bindFull};return{link:function(){},controller:["$scope","$element",ctrl]}}function linkCenter(){return{link:function(scope,el,attr,containerCtrl){containerCtrl.bindCenter(el)},require:"^viewContainer"}}function linkFull(){return{link:function(scope,el,attr,containerCtrl){containerCtrl.bindFull(el)},require:"^viewContainer"}}return{container:container,center:linkCenter,full:linkFull}}),define("app/templates",[],function(){"use strict";return function($templateCache){$templateCache.put("app/groupApp.html",'<div class="main" ng-switch="state" ng-class="{notPC: notPC, fullscreen:fullScreen}">\n    <div ng-if="notPC && !fullScreen && state == \'ready\'" class="top-banner">\n        <div class="top-left">\n            <svg class="logo">\n                <use xlink:href="#logo"/>\n            </svg>\n            <a class="ydoc-tab" href="http://note.youdao.com/web" target="_blank">云笔记</a>\n            <i class="top-line"></i>\n            <a class="group-tab" ng-click="forwardRoot()">云协作</a>\n        </div>\n        <div class="top-right" ng-class="::{mac: client.isMac()}">\n            <img class="own-info" ng-src="{{getUser().photo}}" user-info data-user-id="{{uid()}}" title="个人信息"/>\n            <div class="group-title" widget-toggle="more" title="更多">\n                <span class="arrow-line-down"><i class="arrow-line"></i></span>\n                <ul class="widget-menu" widget-toggle-content>\n                    <li class="widget-menu-item" user-info data-user-id="{{uid()}}">\n                        <span class="link">个人信息</span>\n                    </li>\n                    <li class="widget-menu-item li-link">\n                        <a class="link" href="/web" target="_blank">查看我的笔记</a>\n                    </li>\n                    <li class="widget-menu-item li-link">\n                        <a class="link" href="http://survey2.163.com/html/notegroup_nps/paper.html" target="_blank">协作功能满意度调查</a>\n                    </li>\n                    <li class="widget-menu-item li-link">\n                        <a class="link" href="http://notefeedback.youdao.com/web/index.html?platform=group" target="_blank">意见反馈</a>\n                    </li>\n                    <li class="widget-menu-item" ng-click="logout()">\n                        <span class="link">注销登录</span>\n                    </li>\n                </ul>\n            </div>\n            <i class="top-line"></i>\n            <a class="update-vip" target="_blank" href="http://note.youdao.com/biz/?vendor=group">企业版</a>\n            <i class="top-line"></i>\n            <span class="top-btns">\n                <a class="pc-btn" href="http://download.ydstatic.com/notewebsite/downloads/YNote.exe"\n                   ng-if="::(!client.isMacBrowser())">\n                    <span>客户端下载</span>\n                </a>\n                <a class="pc-btn" href="https://itunes.apple.com/cn/app/you-dao-yun-xie-zuo/id948200041?mt=12"\n                   ng-if="::(client.isMacBrowser())">\n                    <span>客户端下载</span>\n                </a>\n            </span>\n        </div>\n    </div>\n    <div ng-if="state == \'ready\'" class="main-bd">\n        <div class="aside" ng-show="!fullScreen" ng-include="\'pagelet/sidebar/sidebar.html\'"></div>\n        <div class="center" ng-include="\'app/viewport/scaffolding.html\'"></div>\n        <div task-aside></div>\n        <div class="nogroup-wrap" ng-show="gid() == undefined && orgId() == undefined">\n            <div class="nogroup" ng-show="getGroups().length === 0">\n                <span class="info">你还未加入任何群</span>\n                <button class="btn" ng-click="joinGroup()">立即加入</button>\n            </div>\n        </div>\n        <div widget-hint></div>\n    </div>\n    <div class="mask-all"></div>\n</div>'),$templateCache.put("app/viewport/scaffolding.html",'<div class="default" ng-controller="scaffoldingCtrl">\n    <div class="default-bd">\n        <div class="enterprise-banner" ng-show="showEnterpriseAd">\n            <i class="close" ng-click="disableEnterpriseAd()"></i>\n            <p class="enterprise-title">企业必备协作工具，协作编辑第一品牌</p>\n            <div class="enterprise-feature">\n                <div class="co-edit"></div>\n                <p class="feature-text">协同编辑</p>\n                <div class="dashed-line left"></div>\n            </div>\n            <div class="enterprise-feature">\n                <div class="cloud-storage"></div>\n                <p class="feature-text">云存储</p>\n                <div class="dashed-line"></div>\n            </div>\n            <div class="enterprise-feature">\n                <div class="project-manage"></div>\n                <p class="feature-text">项目管理</p>\n                <div class="dashed-line right"></div>\n            </div>\n            <a class="enterprise-button btn" target="_blank" href="http://note.youdao.com/biz/?vendor=group">云协作企业版</a>\n        </div>\n        <p ng-if="isNetworkError" class="net-toast">\n            当前网络不可用，请连接网络后重试<span ng-click="refresh()" class="refresh">刷新</span>\n            <i class="net-close" ng-click="disableNetErr()"></i>\n        </p>\n        <div class="default-content" ng-class="{\'isNetworkError\': isNetworkError}" view-container>\n            <div note-draft-hint="folderId" class="top-dirty-info"></div>\n            <div class="content-bd" ng-show="!fullScreen">\n                <div class="category-hd" ng-if="launcher.getGroup() != null">\n                    <div class="category-nav" ng-if="showCateNav">\n                        <div class="category-nav-inner">\n                            <a href="/group/{{ gid() }}" ng-class="{active: tab === \'data\'}">资料</a>\n                            <a href="/group/{{ gid() }}/tasks" ng-class="{active: tab === \'tasks\'}">任务</a>\n                        </div>\n                    </div>\n                    <h1 class="explorer-title ellipsis">\n                        <span class="group-name" ng-click="launcher.getGroupRouter().forward(\'/\')">\n                            {{launcher.getGroup().name}}\n                        </span>\n                        <a class="calendar-link" ng-if="launcher.getGroup().settings[101]" ng-click="launcher.getGroupRouter().forward(\'/calendar\')">\n                            <svg><use xlink:href="#date"></use></svg>\n                        </a>\n                        <span class="up-group-icon" ng-class="{topGroup:isTopGroup(launcher.getGroup().id)}" ng-click="toggleUpGroup(launcher.getGroup());$event.stopPropagation()" ng-if="groupTopOn"></span>\n                    </h1>\n                    <div class="enterprise-container" ng-if="!showCateNav">\n                        <a target="_blank" href="http://note.youdao.com/biz/?vendor=group" class="enterprise-text">更多人数，更多权限</a>\n                        <i class="enterprise-new"></i>\n                    </div>\n                    <div lab-setting></div>\n                    <div class="chat-hd-main">\n                        <div class="blur-bg"></div>\n                        <div class="chat-hd-search">\n                            <div search-input></div>\n                        </div>\n                        <div class="chat-hd-invite" ng-click="launcher.getGroupRouter().forward(\'/setting/members\')">\n                            <span class="member-num">{{getGroupSize() <= 999 ? getGroupSize() : \'999+\'}}</span>\n                            <svg class=\'invite\' tracker track-category="setting" track-action="invitation" title="成员管理">\n                                <use class="default" xlink:href="#invite"/>\n                                <use class="hover" xlink:href="#invite_hover"/>\n                            </svg>\n                        </div>\n                        <div class="vline"></div>\n                        <svg class=\'settings\' ng-click="launcher.getGroupRouter().forward(\'/setting/options\')" title="群设置">\n                            <use class="default" xlink:href="#setting"/>\n                            <use class="hover" xlink:href="#setting_hover"/>                        \n                        </svg>                       \n                    </div>\n                </div>\n                <div class="category-ct" view-container-center>\n                    <div class="loading-style editor-loading" ng-show="loading"></div>\n                </div>\n                <div class="chat-ct">\n                    <div class="chat-ct-bd" ng-include="\'pagelet/chat/chat.html\'"></div>\n                </div>\n            </div>\n            <div class="category-full" view-container-full></div>\n        </div>\n    </div>\n    <div ng-show="state == \'notfound\'"></div>\n</div>\n'),$templateCache.put("common/widgets/comment/comment.html",'<div class="comment">\n    <div class="comment-send"\n         ng-if="type == \'file\'"\n         send-comment\n         send="send()"\n         file-id="{{entryId}}"\n         file-permission-check="comment.send"\n         file-permission-file="file">\n    </div>\n    <div class="comment-send"\n         ng-if="type == \'task\'"\n         send-comment\n         send="send()"\n         task-id="{{entryId}}"\n         gid="{{groupId}}">\n    </div>\n    <div class="comment-bd">\n        <div class="comment-list">\n            <div class="item" ng-repeat="comment in comments track by comment.id" highlight-comment>\n                <div class="item-container">\n                    <img ng-src="{{ comment.commenter.photo | photo }}" class="photo" user-info data-user-id="{{comment.commenter.userId}}">\n                    <div class="item-bd">\n                        <div class="commenter-name ellipsis">\n                            <span class="commenter selectable" ng-bind="comment.commenter | alias"></span>\n                            <span class="replyed-commenter selectable" ng-if="comment.hasReply">回复</span>\n                            <span class="replyed-commenter selectable" ng-if="comment.hasReply && comment.replyComment.commenter" ng-bind="comment.replyComment.commenter.name"></span>\n                        </div>\n                        <div class="comment-content selectable" ng-if="!comment.hasReply" ng-bind-html="comment.content | htmlFilter | emojiFilter">\n                        </div>\n                        <div class="replyed-container" ng-if="comment.hasReply">\n                            <div class="arrow"></div>\n                            <div class="comment-content selectable" ng-bind-html="comment.content | htmlFilter | emojiFilter">\n                            </div>\n                            <div class="comment-split"></div>\n                            <span class="replyed-commenter selectable" ng-if="comment.hasReply && comment.replyComment.commenter" ng-bind="comment.replyComment.commenter.name + \'：\'"></span>\n                            <span class="replyed-comment selectable" ng-bind-html="comment.replyComment.content | htmlFilter | emojiFilter">\n                            </span>\n                        </div>\n                        <span class="time selectable" ng-bind="comment.createDate | dateFormat:\'yyyy-MM-dd HH:mm\' ">\n                        </span>\n                        <span ng-if="!!comment.id && !comment.error">\n                            <span ng-if="type=\'file\'">\n                                <span file-permission-check="comment.delete"\n                                      file-permission-file="file">\n                                    <span class="action"\n                                         ng-if="comment.isMyself"\n                                         ng-class="{\'collapse-reply\': comment.expandReply}">\n                                        <span class="operation-split"></span><span ng-click="remove(comment.id)">删除</span>\n                                    </span>\n                                </span>\n                                <span file-permission-check="comment.reply"\n                                      file-permission-file="file">\n                                    <span class="action"\n                                         ng-if="!comment.expandReply">\n                                        <span class="comment-reply-btn" ng-click="reply(comment)">回复</span>\n                                    </span>\n                                    <span class="action collapse-reply"\n                                         ng-if="comment.expandReply">\n                                        <span class="comment-reply-btn" ng-click="comment.expandReply = !comment.expandReply">隐藏回复</span>\n                                    </span>\n                                </span>\n                            </span>\n                            <span ng-if="type == \'task\'">\n                                <span class="action"\n                                     ng-if="comment.isMyself"\n                                     ng-class="{\'collapse-reply\': comment.expandReply}">\n                                    <span class="operation-split"></span><span ng-click="remove(comment.id)">删除</span>\n                                </span>\n                                <span class="action"\n                                     ng-if="!comment.expandReply">\n                                    <span class="comment-reply-btn" ng-click="reply(comment)">回复</span>\n                                </span>\n                                <span class="action collapse-reply"\n                                     ng-if="comment.expandReply">\n                                    <span class="comment-reply-btn" ng-click="comment.expandReply = !comment.expandReply">隐藏回复</span>\n                                </span>\n                            </span>\n                        </span>\n                        <span ng-if="comment.error" class="comment-error">评论发送失败</span>\n                    </div>\n                </div>\n                <div ng-if="comment.expandReply" class="item-reply">\n                    <div class="reply-comment" file-id="{{type ===\'file\'?entryId:undefined}}" task-id="{{type ===\'task\'?entryId:undefined}}" reply-id="{{comment.id}}" reply-commenter="{{comment.commenter | alias}}" reply-user-id="{{comment.commenter.userId}}" reply-content="{{comment.content}}">\n                    </div>\n                </div>\n                <div ng-if="comment.version" class="comment-version">\n                    <div class="line"></div>\n                    <div class="comment-version-container"\n                         file-open-revision\n                         file-id="comment.fileId"\n                         group-id="comment.groupId"\n                         file-version="comment.version"\n                            >第 {{::comment.version}} 版\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="pager">\n            <ul ng-if="getPage() > 1">\n                <li class="prev"\n                    ng-if="getPageIndex() > 0"\n                    ng-click="setPageIndex(getPageIndex() - 1)">\n                </li>\n                <li ng-if="getPageIndex() <= 0">\n                </li>\n                <li ng-repeat="page in getPages()"\n                    ng-class="{current:page == getPageIndex()}"\n                    ng-click="setPageIndex(page)">\n                    <span ng-if="page >= 0"\n                          ng-bind="page + 1"></span>\n                    <span ng-if="page < 0">...</span>\n                </li>\n                <li class="next"\n                    ng-if="getPageIndex() < getPage() - 1"\n                    ng-click="setPageIndex(getPageIndex() + 1)">\n                </li>\n                <li ng-if="getPageIndex() >= getPage() - 1">\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>'),$templateCache.put("common/widgets/comment/input/reply-comment.html",'<textarea class="comment-reply-input" widget-at at-members="atMembers" placeholder="回复{{replyCommenter}}：" ng-model="content" ng-trim="false" max-input-length="1000">\n</textarea>\n<svg class="comment-reply-emoji"\n     emoji-toggle="emojiBoardVisible"\n     board-class="\'chat-emoji-board\'"\n     add-emoji="addEmoji(tag)">\n	<use class="default" xlink:href="#send_emoji"/>\n	<use class="hover" xlink:href="#send_emoji_hover"/>\n</svg>\n<div class="comment-reply-sendBtn btn">\n    回复\n</div>\n'),$templateCache.put("common/widgets/comment/input/send-comment.html",'<textarea class="comment-input" widget-at at-members="atMembers" placeholder="输入评论或@群成员…" ng-model="content" ng-trim="false" max-input-length="1000">\n</textarea>\n<svg class="comment-send-emoji"\n	emoji-toggle="emojiBoardVisible"\n	board-class="\'chat-emoji-board\'"\n	add-emoji="addEmoji(tag)">\n	<use class="default" xlink:href="#send_emoji"/>\n	<use class="hover" xlink:href="#send_emoji_hover"/>\n</svg>\n<div class="comment-sendBtn btn">评论</div>'),$templateCache.put("common/widgets/icon/showIcon.html",'<div  class="container show-icon">\n    <div class="show-icon-box">\n        <div change-icon ng-if="imgReady" class="img-jcrop">\n            <img ng-src="{{iconImagePath}}" alt="" id="cropTarget"/>\n        </div>\n        <div class="img-loading">正在载入,请稍后...</div>\n    </div>\n\n    <div class="preview" ng-show="imgReady">\n        <div class="preview-container">\n            <img ng-src="{{iconImagePath}}" alt="" class="preview-img">\n        </div>\n        <p class="preview-hint">预览图：120×120 像素</p>\n    </div>\n</div>\n\n'),$templateCache.put("common/widgets/labSetting/labSetting.html",'<div class="lab-container">\n    <p class="title">实验室功能设置</p>\n    <div class="lab-setting-list">\n        <ul>\n            <li ng-repeat="setting in list" class="item">\n                <span>\n                    <span class="title">\n                        {{setting.title}}\n                    </span>\n                    <span class="description">\n                        {{setting.description}}\n                    </span>\n                </span>\n                <input type="checkbox" ng-checked="setting.active" class="tgl" ng-click="switchActive(setting, $event)" id="cb{{setting.id}}"/>\n                <label for="cb{{setting.id}}" class="tgl-btn"></label>\n                <!--<div class="lab-btn" ng-class="{on: setting.active}" ng-click="switchActive(setting)">-->\n                    <!--<span class="onside">ON</span>-->\n                    <!--<span class="offside">OFF</span>-->\n                    <!--<span class="btnside">|||</span>-->\n                <!--</div>-->\n            </li>\n        </ul>\n\n        <div class="hint">\n            <p>注：</p>\n            <ol>\n                <!-- <li>开启后该功能在云协作中全局生效</li> -->\n                <li>实验室功能不保证稳定性，如果遇到问题请关闭</li>\n                <li>持续更新，请期待后续功能...</li>\n            </ol>\n        </div>\n    </div>\n</div>'),$templateCache.put("common/widgets/labSetting/labWarning.html",'<ol class="lab-warning">\n    <li>实验室功能不保证稳定性</li>\n    <li>同时开启多个实验室功能时不保证其兼容性</li>\n    <li>遇到功能问题时请关闭对应实验室功能</li>\n</ol>\n'),$templateCache.put("common/widgets/loading/loading.html",'<p class="loading-content">\n    <svg class="loading-icon">\n    	<use xlink:href="#loading"/>\n    </svg>\n</p>'),$templateCache.put("common/widgets/popover.html",'<div class="popover-popup" ng-style="{top: top, left: left}">\n    <div ng-include="popover"></div>\n</div>\n'),$templateCache.put("common/widgets/preview/preview.html",'<div class="widget-preview">\n    <div class="box">\n        <img class="image" alt="图片已经损坏 :<"/>\n        <!--<span class="image-size-percent">当前缩放比例: {{imageSizePercent}}%</span>-->\n    </div>\n\n    <ul class="tools" ng-if="index>-1">\n        <li ng-if="hasPager()" class="tool" ng-click="prev()" ng-class="{disable:!hasPrev()}">\n            <i class="icon-preview-prev"></i>\n        </li>\n        <li ng-if="hasPager()" class="tool" ng-click="next()" ng-class="{disable:!hasNext()}">\n            <i class="icon-preview-next"></i>\n        </li>\n        <li class="tool image-zoom-percent">\n            <i>\n                <span class="icon-preview-zoom-in" ng-click="zoomImage(1)"></span>\n                <span class="icon-preview-zoom-out" ng-click="zoomImage(-1)"></span>\n                <span class="image-size-percent">{{imageSizePercent}}%</span>\n            </i>\n        </li>\n        <li class="tool">\n            <a class="dl-info" ng-href="{{imageSrc()}}" ng-click="download($event)" download="{{imageName()}}" target="_blank">\n                <i class="icon-preview-dl"></i>\n            </a>\n        </li>\n        <li class="tool" ng-click="fitSize()">\n            <i ng-class="{\'icon-preview-fit-size\': !isOriginSize, \'icon-preivew-origin-size\': isOriginSize}"></i>\n        </li>\n    </ul>\n    <div class="info">\n        <div class="image-title">{{imageTitle}}</div>\n        <div class="image-index" ng-show="index&&listLength">第{{index}}/{{listLength}}张图</div>\n        <div class="image-buttons">\n            <div class="preview-close" ng-click="close()">\n                <i class="icon"></i>\n            </div>\n        </div>\n    </div>\n    <div class="tooltip" ng-if="showTip()">\n        使用 <span class="button">Ctrl</span> + 鼠标中轴 可以放大/缩小图片\n    </div>\n</div>\n<div class="preview-mask"></div>\n'),$templateCache.put("common/widgets/progress/progress.html",'<div class="widget-progress">\n    <div class="widget-progress-bar"></div>\n</div>'),$templateCache.put("common/widgets/scroller/scroller.html",'<div class="widget-scroller">\n    <div class="widget-scroller-wrap" ng-transclude tabindex="-1">\n    </div>\n    <div class="widget-scroller-bar"></div>\n</div>'),$templateCache.put("common/widgets/upload/h5upload.html",'<form action="{{action}}"\n      enctype="multipart/form-data"\n      encoding="multipart/form-data"\n      accept="{{accept}}"\n      method="post"\n      target="upload_directive_frame">\n    <div ng-transclude></div>\n    <input class="upload-btn" type="file" name="{{name}}" accept="{{accept}}" ng-click="setAcceptType()"/>\n</form>\n'),$templateCache.put("common/widgets/upload/h5uploadFolder.html",'<form enctype="multipart/form-data"\n      encoding="multipart/form-data"\n      method="post">\n    <span ng-transclude></span>\n    <input type="file" class="upload-btn" name="file[]" id="folder-input"  webkitdirectory/>\n</form>'),$templateCache.put("common/widgets/upload/swfupload.html",'<div class="widget-upload-swf">\n    <div id="{{id}}"></div>\n    <div class="widget-upload-swf-btn" ng-transclude></div>\n</div>'),$templateCache.put("pagelet/calendar/calendarItem.html",'<div ng-if="!isEditing">\n    <h3>{{ event.title }}</h3>\n    <div>{{ event.start.toDate() | date:fmt }} 到 {{ event.end.toDate() | date:fmt }}</div>\n    <hr>\n    <div class="actions">\n        <button class="btn btn-default" type="button" ng-click="cancel()" ng-if="!event.editable">确定</button>\n        <button class="btn btn-danger" type="button" ng-click="remove()" ng-if="event.editable">删除</button>\n        <button class="btn" type="button" ng-click="edit(); $event.originalEvent.bsPopoverHidePrevented = true" ng-if="event.editable">编辑</button>\n    </div>\n</div>\n\n<form ng-if="isEditing" shadow-model="event" ng-submit="save(event)">\n    <div>\n        <input type="text" ng-if="isEditing" widget-auto-focus ng-model="event.title">\n    </div>\n    <div>{{ event.start.toDate() | date:fmt }} 到 {{ event.end.toDate() | date:fmt }}</div>\n    <hr>\n    <div class="actions">\n        <button class="btn btn-default" type="button" ng-click="cancel()">取消</button>\n        <button class="btn" type="submit">保存</button>\n    </div>\n</form>\n'),$templateCache.put("pagelet/calendar/index.html",'<div class="calendar-wrapper">\n    <div class="calendar-container" ng-controller="calendarCtrl">\n        <div>\n            <span class="calendar-back" role="button" ng-click="back()">\n                <svg>\n                    <use xlink:href="#back"/>\n                </svg>\n                <span>返回</span>\n            </span>\n        </div>\n        <div ng-if="active" calendar="opt"></div>\n        <svg class="calendar-loading" ng-show="loading"><use xlink:href="#loading"/></svg>\n    </div>\n</div>\n'),$templateCache.put("pagelet/chat/chat.html",'<div class="chat-main" widget-copy>\n    <div ng-show="!$location.search().chathistory && !$location.search().hrId">\n        <div ng-include="\'pagelet/chat/normal/display/display.html\'"/>\n        <div permission-check="chat.send" send-message></div>\n    </div>\n    <div ng-show="$location.search().chathistory || $location.search().hrId" ng-include="\'pagelet/chat/history/history.html\'"></div>\n</div>'),$templateCache.put("pagelet/chat/history/history.html",'<div class="history" ng-controller="chatHistoryCtrl">\n    <div class="chat-history-hd">\n        <div class="back" ng-click=\'back()\'>\n            <svg class="icon-back">\n                <use xlink:href="#back"/>\n            </svg>\n            返回讨论\n        </div>\n        <div class="page">\n            <div class="option page-up" ng-class="{disable: noUpPage}" ng-click=\'gotoUp()\'>上一页</div>\n            <div class="option page-down"  ng-class="{disable: noDownPage}"  ng-click=\'gotoDown()\'>下一页</div>\n        </div>\n    </div>\n    <div class="loading-style" ng-show="loadingData"></div>\n    <div class="no-message" ng-show="noMessage">没有任何消息</div>\n	<div class="chat-display-bd chat-history-bd" ng-show="!loadingData">\n        <div class="message-node" ng-repeat="message in messages">\n            <div class="long-date selectable" ng-if=\'::(message.data.longDate)\'>\n                <svg class="date-icon">\n                    <use xlink:href="#date"/>\n                </svg>\n                <span ng-if="::(message.data.time | longdate)" ng-bind="::((message.data.time | longdate))"\n                      class="date"\n                      ng-class="::{\'green\': (message.data.time | longdate) == \'今天\', \'red\':  (message.data.time | longdate) == \'昨天\'}"></span>\n                <span class="long-date-label" ng-bind="::(message.data.time | date:\'yyyy.MM.dd\')"></span>\n            </div>\n	        <div class="msg-content" highlight-message ng-include="message.templateUrl"></div>\n		</div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/chat/normal/display/display.html",'<div ng-controller="displayCtrl" chattip chatscroll class="chat-display-main">\n    <div class="loading-style" ng-show="loadingData"></div>\n    <div class="no-message" ng-show="messages.length === 0 && !loadingData">没有任何消息</div>\n    <div class="unread-main" ng-if="unreadShow">\n        <span ng-bind="unreadMsgNum" class="unread-num"></span>条新消息，\n        <span class="unread-click" ng-click="readHistory($event)" ng-if="history">点击向上查看</span>\n        <span class="unread-click" ng-click="readPast($event)" ng-if="!history">点击向上查看</span>\n        <i class="unread-close" ng-click="unreadClose($event)"></i>\n    </div>\n    <div class="chat-display-bd chat-normal-display"\n         ng-class="{\'cover-send-container\': isCoverSendContainer, \'unread-top\': unreadShow}"\n         ng-show="!loadingData" chatunread\n         widget-scroller>\n        <div id="loadOlderMessage" class="chat-display-bd-loading" ng-show="chatState.hasOlderMessage && messages.length >= 20 && chatState.pages > 0 && chatState.pages < 3">\n            <svg class="loading-image-icon">\n                <use xlink:href="#chat_loading"/>\n            </svg>\n            <span class="loading-more-span">正在加载中...</span>\n        </div>\n        <div id="loadHistoryRecord" class="chat-display-bd-loading"\n             ng-show="chatState.pages == 3 && chatState.lastMessageId != 0"\n             ng-click="showHistory()">\n            <span class="loading-more-span">查看更多...</span>\n        </div>\n        <div class="message-node" ng-repeat="message in messages"\n             ng-class="{\'unread\':lastReadMsgId + 1 == message.data.id}">\n            <div class="long-date selectable" ng-if=\'::(message.data.longDate)\'>\n                <svg class="date-icon">\n                    <use xlink:href="#date"/>\n                </svg>\n                <span ng-if="::(message.data.time | longdate)" ng-bind="::((message.data.time | longdate))"\n                      class="date"\n                        ng-class="::{\'green\': (message.data.time | longdate) == \'今天\', \'red\':  (message.data.time | longdate) == \'昨天\'}"></span>\n                <span class="long-date-label" ng-bind="::(message.data.time | date:\'yyyy.MM.dd\')"></span>\n            </div>\n            <div class="msg-content" ng-include="message.templateUrl"></div>\n        </div>\n    </div>\n    <div id="chatTip" class="chat-display-ft"\n         ng-class="{\'cover-send-container\': isCoverSendContainer}">\n        <div ng-include="tipUrl" class="ellipsis"></div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/chat/normal/display/groupmessage/groupmessage-item.html",'<div class="group-message selectable">\n    <span ng-if="::(message.data.action === 1)">\n        本群已改名为{{ message.data.groupName }}\n    </span>\n</div>\n'),$templateCache.put("pagelet/chat/normal/display/hack/event-tip.html","<span>{{ tip.user.name }}：更新了日程</span>\n"),$templateCache.put("pagelet/chat/normal/display/hack/event.html",'<div ng-init="msg = (message.data.msgContent | jsonParse)">\n    <div class="msg-photo">\n        <img ng-src="{{::(message.data.user.photo | photo)}}" class="bubble-user" user-info data-user-id="{{message.data.user.userId}}" />\n    </div>\n    <div class="content-node">\n        <div class="content-head ellipsis selectable">\n            <div class="username" user-info data-user-id="{{message.data.user.userId}}" ng-bind="::(message.data.user | alias)"></div>\n            <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{message.data.user.userId}}\']}"></i></a>\n            <div class="operation" ng-switch="msg.type">\n                <span ng-switch-when="create">新建了日程</span>\n                <span ng-switch-when="update">更新了日程</span>\n                <span ng-switch-when="destroy">删除了日程</span>\n            </div>\n            <div class="time" ng-if="::(!message.error)" ng-bind="::(message.data.time | date:\'HH:mm\')"></div>\n        </div>\n        <div class="bubble">\n            <div class="bubble-node bubble-event-node" ng-class="{removed: msg.type === \'destroy\'}" ng-init="event = msg.content; fmt = event.allDay ? \'MM.dd\' : \'MM.dd HH:mm\'">\n                <h3 class="title">{{ event.title }}</h3>\n                <div class="range">{{ event.start | date:fmt }} 到 {{ event.end | date:fmt }}</div>\n                <hr ng-if="msg.type !== \'destroy\'">\n                <div class="actions" ng-if="msg.type !== \'destroy\'">\n                    <a href="/group/{{ $root.group.id }}/calendar/{{ event.start | date:\'yyyy-MM-dd\':\'UTC\' }}/{{ event.id }}">查看</a>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/chat/normal/display/hack/notice-tip.html","<span ng-bind=\"tip.user.name + '：发布了新公告' \"></span>\n"),$templateCache.put("pagelet/chat/normal/display/hack/notice.html",'<div>\n    <div class="msg-photo">\n        <img ng-src="{{::(message.data.user.photo | photo)}}" class="bubble-user" user-info data-user-id="{{message.data.user.userId}}" />\n    </div>\n    <div class="content-node">\n        <div class="content-head ellipsis selectable">\n            <div class="username" user-info data-user-id="{{message.data.user.userId}}" ng-bind="::(message.data.user | alias)"></div>\n            <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{message.data.user.userId}}\']}"></i></a>\n            <div class="time" ng-if="::(!message.error)" ng-bind="::(message.data.time | date:\'HH:mm\')"></div>\n        </div>\n        <div class="bubble bubble-notice">\n            <div class="bubble-text-node selectable">\n                <strong>发布了新公告</strong>\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/chat/normal/display/image/image-item.html",'<div ng-controller="imageCtrl">\n    <div class="msg-photo">\n        <img ng-src="{{::(message.data.user.photo | photo)}}" class="bubble-user" user-info data-user-id="{{message.data.user.userId}}" />\n        <i class="operation-icon operation-image-icon"></i>\n    </div>\n    <div class="content-node">\n        <div class="content-head ellipsis selectable">\n            <div class="username" user-info data-user-id="{{message.data.user.userId}}" ng-bind="::(message.data.user | alias)"></div>\n            <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{message.data.user.userId}}\']}"></i></a>\n            <div class="time" ng-if="::(!message.error)" ng-bind="::(message.data.time | date:\'HH:mm\')"></div>\n        </div>\n        <div class="bubble">\n            <div class="image" ng-if="!message.data.local">\n                <img style="height:{{image.height}}; width:{{image.width}}" ng-src="{{::previewSrc}}"\n                     ng-if="isNative && !message.error"\n                     widget-preview="image"\n                     widget-preview-list="images"\n                     widget-context-menu="contextMenu(image)"\n                     title="点击查看原图"\n                     image-fallback/>\n                <img style="height:{{image.height}}; width:{{image.width}}" ng-src="{{::previewSrc}}"\n                     ng-if="!isNative && !message.error"\n                     widget-preview="image"\n                     widget-preview-list="images"\n                     title="点击查看原图"\n                     image-fallback/>\n                <div class="error-img" ng-if="message.error">\n                </div>\n            </div>\n            <div class="sending-image" ng-if="message.data.local">\n                <div class="loading-style"></div>\n                <div class="percent">\n                    正在发送  {{percent}}%\n                </div>\n            </div>\n        </div>\n        <div class="error-text selectable" ng-if="message.error">消息发送失败</div>\n    </div>\n</div>'),$templateCache.put("pagelet/chat/normal/display/image/image-tip.html","<span ng-bind=\"tip.user.name + '：上传了图片' \"></span>\n"),$templateCache.put("pagelet/chat/normal/display/text/text-item.html",'<div ng-controller="displayTextCtrl">\n    <img ng-src="{{::(message.data.user.photo | photo)}}" class="bubble-user" user-info data-user-id="{{message.data.user.userId}}">\n    <div class="content-node">\n        <div class="content-head ellipsis selectable">\n            <div class="username" user-info data-user-id="{{message.data.user.userId}}" ng-bind="::(message.data.user | alias)"></div>\n            <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{message.data.user.userId}}\']}"></i></a>\n            <div class="time" ng-bind="::(message.data.time | date:\'HH:mm\')"></div>\n        </div>\n        <div>\n        <div class="bubble">\n            <div class="bubble-text-node selectable" ng-bind-html=\'::(message.data.message | htmlFilter | emojiFilter)\'>\n            </div>\n            <div class="error" ng-if="message.error"></div>\n        </div>\n        </div>\n        <div class="error-text selectable" ng-if="message.error">消息发送失败</div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/chat/normal/display/text/text-tip.html","<span ng-bind=\"tip.user.name + '：' + tip.message\"></span>\n"),$templateCache.put("pagelet/chat/normal/display/voice/voice-item.html",'<div ng-controller="displayVoiceCtrl">\n    <img ng-src="{{::(voiceMsg.user.photo | photo)}}" class="bubble-user" user-info data-user-id="{{voiceMsg.user.userId}}">\n    <div class="content-node">\n        <div class="content-head ellipsis selectable">\n            <div class="username" user-info data-user-id="{{voiceMsg.user.userId}}" ng-bind="::(voiceMsg.user | alias)"></div>\n            <div class="time" ng-bind="::(voiceMsg.time | date:\'HH:mm\')"></div>\n        </div>\n        <div class="bubble">\n            <div class="bubble-node bubble-voice-node" ng-click="play()">\n                <div class="voice" jplayer gid="gid()" duration="{{voiceMsg.duration}}" voice-src="{{voiceSrc}}" voice-type="{{voiceType}}" message-id="{{voiceMsg.id}}">\n                </div>\n                <span class="voice-time" ng-bind="::(voiceMsg.duration | timesize)" ng-click="$event.stopPropagation();"></span>\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/chat/normal/display/voice/voice-tip.html","<span ng-bind=\"tip.user.name + '：发送了一条语音' \"></span>\n"),$templateCache.put("pagelet/chat/normal/send/send-message.html",'<div class="chat-imagepreview" ng-show="imagePreview.show">\n    <div class="imagepreivew-bd">\n        <img ng-src="{{imagePreview.src}}"/>\n    </div>\n    <div class="imagepreivew-ft">\n        <button class="btn send-image" ng-click="sendImage()">\n            <i class="icon send-image-icon"></i>\n            发送\n        </button>\n        <button class="btn send-image-cancle" ng-click="imagePreview.show = false">\n            <i class="icon send-image-cancle-icon"></i>\n            取消\n        </button>\n    </div>\n</div>\n<div class="chat-send" >\n    <div class="chat-input">\n        <textarea widget-at at-members="atMembers" placeholder="@群成员或直接输入…" ng-model="message" ng-trim="false" max-input-length="2000">\n        </textarea>\n    </div>\n    <div class="actions" ng-class="{pc: client.isPC()}">\n        <svg class="send-emoji"\n           title="表情"\n           emoji-toggle="emojiBoardVisible"\n           board-class="\'chat-emoji-board\'"\n           add-emoji="addEmoji(tag)">\n           <use class="default" xlink:href="#send_emoji"/>\n           <use class="hover" xlink:href="#send_emoji_hover"/>\n        </svg>\n        <span class="send-pic"\n           title="添加图片"\n           ng-if="!client.isSupport(\'uploadChatImage\')">\n          <svg class="icon-send-pic">\n              <use class="default" xlink:href="#send_image"/>\n              <use class="hover" xlink:href="#send_image_hover"/>\n          </svg>\n          <i widget-upload="\'content\'"\n             upload-type="\'image\'"\n             upload-select="onImageSelect(tasks)"></i>\n        </span>\n        <svg class="send-pic"\n           title="添加图片"\n           ng-if="client.isSupport(\'uploadChatImage\')"\n           ng-click="uploadChatImage()">\n           <use class="default" xlink:href="#send_image"/>\n           <use class="hover" xlink:href="#send_image_hover"/>\n         </svg>\n        <span class="send-screen"\n              ng-if="client.isPC()"\n              widget-toggle="clipVisible"  title="截图">\n            <svg class="icon-send-screen">\n              <use class="default" xlink:href="#screenshot"/>\n              <use class="hover" xlink:href="#screenshot_hover"/>\n            </svg>\n            <ul class="menu" widget-toggle-content="left">\n                <li class="menu-option" ng-click="clipScreen(false)">截图</li>\n                <li class="menu-option" ng-click="clipScreen(true)">截图并隐藏当前窗口</li>\n            </ul>\n        </span>\n    </div>\n    <span class="vline"></span>\n    <button ng-click="sendText()" class="send-msg">发&nbsp;送</button>\n</div>'),$templateCache.put("pagelet/chat/p2p/p2p.html",'<div class="p2p" p2ptip p2pscroll ng-controller="p2pCtrl" ng-class="{minimized : minimized}">\n    <div class="p2p-hd" ng-click="talkWith(minimizedLatestContact);maximize(minimized);">\n        <div ng-if="recentContacts.length > 0">\n<!--             <div class="p2p-hd-icon"></div> -->\n            <div class="p2p-hd-name" ng-if="recentContacts.length > 0 && !minimized">\n                与<span>{{chatting | alias}}</span>正在进行私聊...\n            </div>\n            <div ng-if="minimized" class="p2p-hd-name">\n                {{minimizedLatestContact | alias}}\n            </div>\n        </div>\n        <div class="p2p-hd-name" ng-if="recentContacts.length === 0">\n            私聊\n        </div>\n        <svg class="icon-minimize-p2p" ng-click="toggleMinimize();$event.stopPropagation()">\n            <use class="default" ng-if="!minimized" xlink:href="#dialog_collapse"/>\n            <use class="hover" ng-if="!minimized" xlink:href="#dialog_collapse_hover"/>\n            <use class="default" ng-if="minimized" xlink:href="#dialog_expand"/>\n            <use class="hover" ng-if="minimized" xlink:href="#dialog_expand_hover"/>\n        </svg>\n        <svg class="icon-close-p2p" ng-click="closeP2P();$event.stopPropagation()">\n            <use class="default" xlink:href="#dialog_close"/>\n            <use class="hover" xlink:href="#dialog_close_hover"/>\n        </svg>\n    </div>\n    <div class="p2p-bd" ng-show="!minimized">\n        <div ng-if="recentContacts.length > 0">\n            <div class="p2p-load-more" ng-show="loadingMore">\n                <svg class="loading-image-icon">\n                    <use xlink:href="#chat_loading"/>\n                </svg>\n                <span class="loading-more-span">正在加载更多消息...</span>\n            </div>\n            <ul class="p2p-chat-list" widget-scroller="getMoreContact(bottom)">\n                <li class="p2p-chatter" ng-class="{active: person.isChatting}" ng-repeat="person in recentContacts" ng-click="chatWith(person, false)">\n                    <img class="p2p-chatter-photo" ng-src="{{::(person.photo | photo)}}">\n                    <div class="p2p-unread-messages" ng-if="unreadMessages[person.userId].length > 0">\n                        <span>{{unreadMessages[person.userId].length <= 99 ? unreadMessages[person.userId].length : \'99+\'}}</span>\n                    </div>\n                    <div title="{{person | alias}}" class="p2p-chatter-name">{{::person | alias}}</div>\n                    <div class="split"></div>\n                </li>\n                <li class="p2p-load-contacts" ng-show="loadingContacts">\n                    <div class="loading-style"></div>\n                </li>\n            </ul>\n            <ul class="p2p-messages">\n                <li class="p2p-message" ng-repeat="message in messages">\n                    <div class="message-wrap" ng-if="::(!message.isSend)">\n                        <div class="my-photo-container">\n                            <img ng-src="{{::(user.photo | photo)}}" user-info data-user-id="{{uid()}}" class="message-photo">\n                        </div>\n                        <div class="left-message-container" ng-switch="::message.type">\n                            <div ng-switch-when="0" ng-class="::{\'message-left\': !message.error, \'message-left-text\': true, \'message-left-error\': message.error}" ng-bind-html="::message.content | htmlFilter | emojiFilter"></div>\n                            <div ng-switch-when="2" ng-class="::{\'message-left\': !message.error, \'message-left-image\': true, \'message-left-error\': message.error}">\n                                <div ng-if="!message.fromLocal" class="image-preview">\n                                    <img style="height:{{message.height}}; width:{{message.width}}" ng-src="{{::message.content.link}}"\n                                         widget-preview="getImage(message)"\n                                         widget-preview-list="images"\n                                         title = "点击查看原图"\n                                         image-fallback/>\n                                </div>\n                                <div ng-show="message.fromLocal">\n                                    <div ng-show="message.error">\n                                        <i class="image-error"></i>\n                                    </div>\n                                    <div ng-show="!message.error" class="image-loading">\n                                        <div class="loading-style"></div>\n                                        <div class="percent">\n                                            正在发送  {{message.percent}}%\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="message-wrap" ng-if="::message.isSend">\n                        <div class="chatter-photo-container">\n                            <img ng-src="{{::(chatting.photo | photo)}}" user-info data-user-id="{{chatting.userId}}" class="message-photo">\n                        </div>\n                        <div class="arrive-message-container" ng-switch="::message.type">\n                            <div ng-switch-when="0" class="message-arrive message-arrive-text" ng-bind-html="::(message.content | htmlFilter | emojiFilter)"></div>\n                            <div ng-switch-when="2" class="message-arrive message-arrive-image">\n                                <div ng-if="::(!message.fromLocal)" class="image-preview">\n                                    <img style="height:{{message.height}}; width:{{message.width}}" ng-src="{{::message.content.link}}"\n                                         widget-preview="getImage(message)"\n                                         widget-preview-list="images"\n                                         title = "点击查看原图"\n                                         image-fallback/>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="message-time" ng-show="::(!message.error)">\n                        <div class="time-detail"  ng-class="{arrive : message.isSend, left : !message.isSend}">\n                            {{message | fileDate:\'messageTime\' | p2pDateFormat:\'MM-dd HH:mm\'}}\n                        </div>\n                    </div>\n                    <div class="message-error" ng-show="::message.error">\n                        <div class="message-error-text" ng-click="resend(message)" title="再次发送">发送失败</div>\n                        <icon class="message-error-icon" ng-click="resend(message)" title="再次发送"></icon>\n                    </div>\n                </li>\n            </ul>\n            <div class="p2p-imagepreview" ng-show="imagePreview.show">\n                <div class="imagepreivew-bd">\n                    <img ng-src="{{imagePreview.src}}"/>\n                </div>\n                <div class="imagepreivew-ft">\n                    <button class="btn send-image" ng-click="sendImage()">\n                        <i class="icon send-image-icon"></i>\n                        发送\n                    </button>\n                    <button class="btn send-image-cancel" ng-click="imagePreview.show = false">\n                        <i class="icon send-image-cancel-icon"></i>\n                        取消\n                    </button>\n                </div>\n            </div>\n            <div class="p2p-tip" ng-show="showP2Ptip" ng-click="clickTip()">\n                <div class="tip-container">\n                    <span class="tip-detail ellipsis">{{tip}}</span>\n                </div>\n            </div>\n        </div>\n        <div ng-show="recentContacts.length === 0" class="p2p-empty">\n            <div>\n                <img src="style/images/3fa56913.p2p_empty.png"  class="p2p-empty-image">\n            </div>\n        </div>\n    </div>\n    <div class="p2p-ft" ng-show="!minimized && recentContacts.length > 0">\n        <div sendp2p send="message && sendText()" gid="gid()" imagepreview="imagePreview" ng-model="message"></div>\n        <span class="p2p-item send-pic" title="添加图片">\n            <svg class="icon-send-pic"\n                 ng-click="client.isPC() && client.isSupport(\'uploadP2PImage\') && uploadP2PImage()">\n                <use class="default" xlink:href="#send_image"/>\n                <use class="hover" xlink:href="#send_image_hover"/>\n            </svg>\n            <i class="form-send-pic"\n               widget-upload="\'content\'"\n               upload-type="\'image\'"\n               upload-select="onImageSelect(tasks)"\n               ng-if="!(client.isPC() && client.isSupport(\'uploadP2PImage\'))"></i>\n        </span>\n        <span class="p2p-item" title="表情">\n            <svg class="send-emoji"\n                emoji-toggle="emojiBoardVisible"\n                board-class="\'chat-emoji-board\'"\n                add-emoji="addEmoji(tag)">\n                <use class="default" xlink:href="#send_emoji"/>\n                <use class="hover" xlink:href="#send_emoji_hover"/>\n            </svg>\n        </span>\n    </div>\n</div>'),$templateCache.put("pagelet/file/comment/msg/message.html",'<div ng-controller="commentMsgCtrl">\n    <div class="msg-photo">\n        <img ng-src="{{::(commentMsg.user.photo | photo)}}" class="bubble-user" user-info data-user-id="{{commentMsg.user.userId}}"  />\n        <i class="operation-icon" ng-class="::{\'operation-comment-icon\' : commentMsg.action == \'ADD\', \'operation-reply-icon\' : commentMsg.action == \'REPLY\'}"></i>\n    </div>\n    <div class="content-node group-note-node">\n        <div class="content-head selectable">\n            <div class="time" ng-bind="::(commentMsg.time | date:\'HH:mm\')"></div>\n            <div class="username" user-info data-user-id="{{commentMsg.user.userId}}" ng-bind="::(commentMsg.user | alias)"></div>\n            <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{commentMsg.user.userId}}\']}"></i></a>\n            <div class="comment-operation">\n                <span>\n                    在\n                    <span class="filename"\n                        file-open\n                        file-id="commentMsg.fileId"\n                        file-name="commentMsg.fileName"\n                        group-id="gid()"\n                        ng-bind="::(\'《\' + (commentMsg.fileName | fileName)+ \'》\')">\n                    </span>\n                    <span  ng-bind="::(commentMsg.action == \'ADD\' ? \'下添加评论\' : (commentMsg.action == \'REPLY\' ? \'下回复评论\' : \'\'))"></span>\n                </span>\n            </div>\n        </div>\n        <div class="bubble">\n            <div class="bubble-node bubble-comment-node selectable"\n                 open-comment\n                 file-id="commentMsg.fileId"\n                 file-name="commentMsg.fileName"\n                 group-id="gid()"\n                 comment-id="commentMsg.commentId">\n                <div class="arrow"></div>\n                <div class="comment-content">\n                    <div class="comment-text"\n                        ng-bind-html="commentMsg.content | htmlFilter | emojiFilter">\n                    </div>\n                    <div ng-if="::(commentMsg.action == \'REPLY\')" class="bubble-comment-wrapper">\n                        <div class="comment-split">\n                        </div>\n                        <div class="quota-content">\n                            <span ng-bind="commentMsg.object.name + \':\'" class="replyedUser"></span>\n                            <span ng-bind-html="commentMsg.replyContent | cut:120 | htmlFilter | emojiFilter"></span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/file/detail/default.html",'<div detail-comment>\n    <div ng-controller="defaultDetailCtrl" ng-if="fileData!=null" class="detail-default">\n        <p class="detail-item detail-file-icon" file-icon="fileData" file-size="large"></p>\n        <p class="detail-item detail-file-title" >\n            {{fileData.name}}\n            <span class="detail-rev" ng-click="openRevision(fileData)">第 {{fileData.version }} 版</span>\n        </p>\n        <p class="detail-item detail-file-info">\n            {{fileData | fileModifier | alias}}\n            {{fileData | fileModifyTime | dateFormat:\'yyyy-MM-dd HH:mm\'}}\n            {{fileData | fileAction}}\n            <span class="detail-file-path-prefix">所在位置： </span>\n            <span class="detail-file-path" ng-click="onOpenFolder(fileData.id)" title="{{filePath}}">{{filePath}}</span>\n        </p>\n        <p class="detail-item">\n            <button class="btn download"\n                    ng-click="download(gid(), fileData)" \n                    ng-if="!ableToEdit(fileData)">\n                下载 ({{fileData.size | fileSize}})\n            </button>\n            <button class="btn preview"\n                    ng-click="edit(fileData)"\n                    ng-if="ableToEdit(fileData)"\n                    file-permission-check="file.edit"\n                    file-permission-file="fileData">打开</button>\n            <button class="btn preview"\n                    ng-click="preview(fileData)"\n                    ng-if="ableToPreview(fileData) && !ableToEdit(fileData)">预览</button>\n        </p>\n    </div>\n</div>\n'),$templateCache.put("pagelet/file/detail/detail-comment.html",'<div class="detail" ng-class="{max:max}">\n    <div class="detail-hd">\n        <span class="back" ng-click="returnList()" ng-show="!fullScreen">\n            <svg class="icon-back">\n                <use xlink:href="#back"/>\n            </svg>\n            返回\n        </span>\n        <div class="title selectable">\n            <p class="name" ng-bind="fileData.name"></p>\n        </div>\n        <div class="detail-hd-right">\n          <div ng-if="modifiers.length > 0" class="modifier" widget-toggle="attendee">\n              <svg class="icon-modify"><use xlink:href="#note_editing"/></svg>\n              <span class="modify-num" ng-bind="modifiers.length"></span>\n              人正在编辑\n              <ul id="attendee-list" widget-toggle-content>\n                  <li id="user-{{user.userId}}" class="attendee" ng-repeat="user in modifiers">\n                      <span class="photo">\n                          <i class="portrait" ng-if="user.photo" style="background-image: url({{user.photo}})"></i>\n                          <i class="portrait" ng-if="!user.photo"></i>\n                      </span>\n                      <span class="nickname" title={{user.name}}>{{user.name}}</span>\n                  </li>\n              </ul>\n          </div>\n          <button class="detail-btn"\n                  ng-click="download(gid(), fileData)"\n                  ng-show="showDownload">\n              下载 ({{fileData.size | fileSize}})\n          </button>\n          <div file-detail-tools="fileData"\n               tools-close="returnList()"\n               tools-open-window="!fullScreen"\n               show-info-revision="showDownload"></div>\n        </div>\n    </div>\n    <p file-permission-check="!fileData.edit"\n          file-permission-file="fileData"\n          file-permission-need-readonly="true"\n          ng-if="fileData != null"\n          class="readonly-tip">\n          该文件为只读，仅群管理员以上可修改\n    </p>\n    <div class="detail-bd" ng-transclude></div>\n    <div ng-if="fileData" class="detail-aside">\n        <div>\n            <div class="comment-hd">\n                <span class="comment-title">评论</span>\n                <div class="toggle-comment" title="关闭评论" ng-click="$parent.max = !$parent.max; $event.stopPropagation()">\n                    <svg class="icon-close">\n                        <use xlink:href="#close"/>\n                    </svg>\n                </div>\n            </div>\n            <div comment\n                 type="file"\n                 file="fileData"\n                 entry-id="{{fileData.id}}"\n                 comment-id="{{commentId}}"\n                 sum="{{fileData.comments}}"\n                 get-user="getUser()"\n                 user-id="{{userId}}">\n            </div>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/file/detail/tools.html",'<div class="detail-tools"\n     ng-show="file != null">\n    <div class="toggle-meta" ng-click="toggleMeta()" ng-show="showInfoRevision">\n        <svg class="action">\n          <use class="default" xlink:href="#detail_meta"/>\n          <use class="hover" xlink:href="#detail_meta_hover"/>\n        </svg>\n    </div>\n    <div class="share-icon" file-permission-check="file.share" file-permission-file="file" ng-click="triggerShare(file);$event.stopPropagation()" title="分享">\n        <svg class="action">\n            <use class="default" xlink:href="#detail_share"/>\n            <use class="hover" xlink:href="#detail_share_hover"/>\n        </svg>\n    </div>\n    <div ng-show="file.domain === 0" class="demo-mode"\n         title="开始演示">\n        <svg class="action" ng-click="enterDemoMode()" tracker track-category="demoIcon" track-action="click">\n            <use class="default" xlink:href="#detail_demo"/>\n            <use class="hover" xlink:href="#detail_demo_hover"/>\n        </svg>\n        <p ng-if="showDemoTips" class="demo-tips">\n            <span class="tips-text">演示模式正式上线，点击播放按钮全屏演示笔记文档</span>\n            <i class="triangle-up"></i>\n            <a class="tips-close" ng-click="disableDemoTips();$event.stopPropagation()">不再提示</a>\n        </p>\n     </div>\n    <div class="toggle-comment-icon" ng-click="togglePanel()" title="收起/展开评论">\n        <svg class="action">\n            <use ng-if="$parent.max" class="default" xlink:href="#detail_toggle_comment"/>\n            <use ng-if="$parent.max" class="hover" xlink:href="#detail_toggle_comment_hover"/>\n            <use ng-if="!$parent.max" xlink:href="#detail_toggle_comment_selected"/>\n        </svg>\n    </div>\n    <div class="new-page-icon" ng-click="openNewPage()" ng-if="openWindow && !clientProxy.isNative()" title="在新窗口中打开">\n        <svg class="action">\n            <use class="default" xlink:href="#detail_new_page"/>\n            <use class="hover" xlink:href="#detail_new_page_hover"/>\n        </svg>\n    </div>\n    <div class="dropdown-trigger"\n         widget-toggle="dropdown" title="更多操作"\n         ng-if="dropdownMenu.length != 0">\n         <svg class="action">\n             <use class="default" xlink:href="#detail_dropdown_menu"/>\n             <use class="hover" xlink:href="#detail_dropdown_menu_hover"/>\n         </svg>\n        <ul class="widget-menu" widget-toggle-content="right">\n            <li ng-repeat="item in dropdownMenu" ng-switch="item.type">\n                <div ng-switch-when="3" class="widget-menu-item split-line"></div>\n                <div ng-switch-default class="widget-menu-item"\n                    ng-click="triggerHandler(item)" ng-bind="item.label"></div>\n            </li>\n        </ul>\n    </div>\n    <span class="rev" ng-click="openRevision(file)" ng-show="showInfoRevision && !tableVersion">\n          第 {{file.version}} 版\n    </span>\n    <span class="rev" ng-click="openRevision(file)" ng-show="tableVersion > 0">\n          第 {{tableVersion}} 版\n    </span>\n</div>'),$templateCache.put("pagelet/file/dialog/exceed-attachmentSpaceQuota.html",'<div class="confirm">\n    <p>您不是有道云笔记会员</p>\n    <p>现在购买<a href="//note.youdao.com/charge/setMeal.html?pcOpenByCookie=1" target="_blank"  tracker track-category="exceed" track-action="exceed-noteattachment-click">有道云笔记会员</a>，立享1G大附件。</p>\n</div>'),$templateCache.put("pagelet/file/dialog/folder-prop.html",'<div class="container folder-prop" ng-controller="folderPropDialogCtrl">\n    <div class="item">\n        <span class="item-key">文件夹名称：</span>\n        <input file-permission-check="file.rename"\n               file-permission-file="folder"\n               type="text" class="item-value" ng-model="folderName">\n        <span file-permission-check="!file.rename"\n           file-permission-file="folder"\n           class="item-value" ng-bind="::folderName"></span>\n    </div>\n    <div class="item">\n        <span class="item-key">最近修改人：</span>\n        <span class="item-value" ng-bind="::(folder | fileModifier : \'lastUpdater\' | alias)"></span>\n    </div>\n    <div class="item">\n        <span class="item-key">最近修改时间：</span>\n        <span class="item-value" ng-bind="::(folder | fileDate:\'updateDate\' | dateFormat:\'yyyy-MM-dd HH:mm\')"></span>\n    </div>\n    <div class="item folder-tip" ng-if="::(!isAllowedGroup)">\n        <p>以下功能仅在企业群中可用</p>\n        <a target="_blank" href="http://note.youdao.com/biz/">开通企业版</a>\n    </div>\n    <div class="item align-top" ng-class="::{\'disabled\': !isAllowedGroup}">\n        <span class="item-key">属性：</span>\n        <div class="item-value">\n            <label ng-show="::canChangeProp">\n                <input type="checkbox"\n                       ng-model="isOnlyManagerEdit"\n                       ng-disabled="!isAllowedGroup || parentFolderIsReadOnly"\n                        > 仅管理员及群主可以编辑\n            </label>\n            <p ng-if="::(!canChangeProp&&isOnlyManagerEdit)">仅管理员及群主可以编辑</p>\n            <p ng-if="::(!canChangeProp&&!isOnlyManagerEdit)">群编辑者以上均可编辑</p>\n            <br>\n            <label ng-show="::canChangeProp">\n                <input type="checkbox"\n                       ng-model="isOnlyManagerView"\n                       ng-disabled="!isAllowedGroup || parentFolderIsViewOnly"\n                        > 仅管理员及群主可见\n            </label>\n            <p ng-if="::(!canChangeProp&&isOnlyManagerView)">仅管理员及群主可见</p>\n            <p ng-if="::(!canChangeProp&&!isOnlyManagerView)">群成员均可见</p>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/file/dialog/move-progress.html",'<div class="file-progress">\n    <p class="info">正在移动第 {{index}}/{{total}} 个文件</p>\n    <div widget-progress value="sent" max="total" class="bar"></div>\n</div>'),$templateCache.put("pagelet/file/dialog/remove-folder.html",'<div class="confirm file-remove-confirm">\n    <p>您确定要删除这个文件夹吗？</p>\n    <p class="desc">删除时其中的文件也将同时被删除</p>\n</div>'),$templateCache.put("pagelet/file/directive/editor.html",'<div class="editor">\n    <input type="text" class="text" />\n</div>\n<div class="editor-bg"></div>'),$templateCache.put("pagelet/file/list/drag-proxy.html",'<div class="file-drag-proxy" ng-class="{multi:selection.length > 1}">\n    <i ng-if="selection.length == 1" file-icon="selection[0]" class="icon"></i>\n    <span ng-if="selection.length > 1" class="count">\n        {{selection.length}}\n    </span>\n</div>'),$templateCache.put("pagelet/file/list/editor.html",'<div class="editor">\n    <input type="text" class="text" maxlength="240"/>\n</div>'),$templateCache.put("pagelet/file/list/globalStar/globalStar.html",'<div class="globalStar" ng-controller="globalStarCtrl">\n    <div class="global-star-hd">\n        <h1>加星文件</h1>\n    </div>\n    <div class="global-star-bd">\n        <div class="global-star"\n             file-view="globalStarFiles"\n             file-view-layout="\'table\'"\n             file-view-loading="loading"\n             file-view-columns="\'group|favorite|modifier|size\'"\n             file-view-list-mode="globalStar"\n             file-droppable-support="false">\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/file/list/list.html",'<div ng-controller="explorerListCtrl">\n    <div ng-show="search == null" class="file-explorer">\n        <div class="expired-hint" ng-if="showExpiredHint">\n            企业版已到期，续费请联系<a href="mailto:youdaogroup@service.netease.com"> youdaogroup@service.netease.com</a>\n        </div>\n        <div class="operate-group-container"\n             ng-include="\'pagelet/orgSetting/plugin/operateGroup.html\'">\n        </div>\n        <div class="explorer-tools">\n            <div class="create toggle"\n                 ng-class="{disabled : !enableTools}"\n                 widget-toggle="createVisible"\n                 permission-check="file.create"\n                 gray="true">\n                <svg class="icon-creates">\n                    <use ng-if="enableTools" class="default" xlink:href="#new"/>\n                    <use ng-if="enableTools" class="hover" xlink:href="#new_hover"/>\n                    <use ng-if="!enableTools" xlink:href="#new_disable"/>\n                </svg>\n                <span class="create-text">新建</span>\n                <svg class="icon-toggle-arrow">\n                    <use xlink:href="#menu_down"/>\n                </svg>\n                <ul class="widget-menu" widget-toggle-content="right" ng-show="enableTools">\n                    <li class="widget-menu-item" ng-repeat="fileType in explorer.getCreatable()"\n                        ng-click="!loading && fileType.create(folder)" title="新建{{fileType.name}}">{{fileType.name}}\n                    </li>\n                    <li class="widget-menu-item" ng-click="!loading && createFolder()" title="新建文件夹">\n                        文件夹\n                    </li>\n                </ul>\n            </div>\n            <div ng-if="!enableTools" class="upload disabled" title="上传文件" permission-check="file.upload" gray="true">\n                <svg class="icon-uploads">\n                    <use xlink:href="#upload_disable"/>\n                </svg>\n                <span class="upload-text">上传</span>\n                <svg class="icon-toggle-arrow" ng-if="!client.isSafari()">\n                    <use xlink:href="#menu_down"/>\n                </svg>\n            </div>\n            <div ng-if="client.isSafari() && enableTools" class="upload"\n                 widget-upload="\'file\'" title="上传文件" upload-select="uploadDirectly(tasks)" upload-multiple="true"\n                 permission-check="file.upload" gray="true">\n                <svg class="icon-uploads">\n                    <use class="default" xlink:href="#upload"/>\n                    <use class="hover" xlink:href="#upload_hover"/>\n                </svg>\n                <span class="upload-text">上传</span>\n            </div>\n            <div ng-if="!client.isSafari() && enableTools" class="upload toggle" widget-toggle="uploadVisible"\n                 title="上传文件"\n                 permission-check="file.upload" gray="true">\n                <svg class="icon-uploads">\n                    <use class="default" xlink:href="#upload"/>\n                    <use class="hover" xlink:href="#upload_hover"/>\n                </svg>\n                <span class="upload-text">上传</span>\n                <svg class="icon-toggle-arrow">\n                    <use xlink:href="#menu_down"/>\n                </svg>\n                <ul class="widget-menu" widget-toggle-content>\n                    <li class="widget-menu-item" ng-click="!loading && uploadFile()" title="上传文件">\n                        文件\n                    </li>\n                    <li class="widget-menu-item" ng-click="!loading && uploadFolder()" ng-if="!client.isEdge()" title="上传文件夹">\n                        文件夹\n                    </li>\n                </ul>\n            </div>\n            <div ng-repeat="tool in explorer.getTools()"\n                 ng-include="tool.src"\n                 ng-click="!loading && invokeTool(tool.handler)"\n                 class="tools"\n                 ng-class="{disabled : !enableTools}"\n                 title="{{tool.text}}"\n                 permission-check="note.import"\n                 gray="true">\n            </div>\n\n            <div class="explorer-right-side" ng-show="!loading">\n                <div class="share-manager" widget-toggle="shareManagerVisible.show"\n                     ng-if="haveSharedFiles()" permission-check="file.viewShare">\n                    <svg class="share-manager-icon" widget-bubble="分享记录">\n                        <use class="default" xlink:href="#share_manager"/>\n                        <use class="hover" xlink:href="#share_manager_hover"/>\n                    </svg>\n                    <div widget-toggle-content="right">\n                        <div class="share-container" ng-click="stopPropagation($event)">\n                            <div class="info">查看和管理本群的分享</div>\n                            <ul class="share-list">\n                                <li class="share-file" ng-repeat="sharedFile in getSharedFiles(getAll)">\n                                    <span class="share-file-name" ng-bind="::sharedFile.name" title="{{sharedFile.name}}" ng-click="openShared(sharedFile)"></span>\n                                    <i class="stop-share"\n                                       widget-bubble="取消分享"\n                                       ng-click="unshare(sharedFile)"\n                                       file-permission-check="file.unshare"\n                                       file-permission-file="sharedFile"></i>\n                                    <i class="copy-share-link"\n                                       clip-button clip-content="{{sharedFile.link}}"\n                                       widget-bubble="复制链接"\n                                       widget-bubble-complete="复制成功"\n                                       file-permission-check="file.share"\n                                       file-permission-file="sharedFile"></i>\n\n                                    <div class="sharer">\n                                        <span>由</span>\n                                        <span class="sharer-name" ng-bind="::sharedFile.sharer | alias" title="{{sharedFile.sharer | alias}}"></span>\n                                        <span>分享</span>\n                                    </div>\n                                </li>\n                            </ul>\n                            <div ng-if="!getAll && getSharedFiles(true).length > 7" class="share-show-all" ng-click="fetchAll($event)">查看全部</div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="explorer-main">\n            <div class="explorer-tree-left" ng-if="!treeSelected" ng-click="toggleTreeStatus()"\n                 widget-bubble="点击这里可查看加星文件夹"\n                 widget-bubble-times="3000"\n                 widget-bubble-on="file.star.expandFileTree">\n                <svg class="arrow">\n                    <use xlink:href="#arrow_right"/>\n                </svg>\n            </div>\n            <div class="explorer-tree-right" ng-if="treeSelected" ng-click="toggleTreeStatus()">\n                <svg class="arrow">\n                    <use xlink:href="#arrow_left"/>\n                </svg>\n            </div>\n            <div ng-show="treeSelected" class="filetree-selector" widget-scroller>\n                <div permission-check="file.favorite"\n                     class="sidebar-stars"\n                     ng-click="selectStars();forwardStars();"\n                     ng-class="{selected : starsSelected}">\n                    <svg class="star-icon">\n                        <use class="default" xlink:href="#star"/>\n                        <use class="hover" xlink:href="#star_hover"/>\n                    </svg>\n                    <div class="stars-text"\n                         widget-bubble="点击这里可查看加星文件夹"\n                         widget-bubble-times="3000"\n                         widget-bubble-on="file.star.intro">加星文件\n                    </div>\n                </div>\n                <div ng-controller="fileTreeCtrl"  file-tree-selection="li.filetree-item">\n                    <div class="selector-wrapper" ng-include="\'pagelet/file/tree/file-tree.html\'" ></div>\n                </div>\n                <div class="sidebar-recycle" ng-click="selectTrash();forwardTrash();"\n                     ng-class="{selected : trashSelected}">\n                    <svg class="trash-icon">\n                        <use class="default" xlink:href="#trash"/>\n                        <use class="hover" xlink:href="#trash_hover"/>\n                    </svg>\n                    <div class="trash-text">回收站</div>\n                </div>\n            </div>\n            <div ng-show="listMode === \'trash\'" ng-include="\'pagelet/file/list/trash/trash.html\'"></div>\n            <div ng-show="listMode === \'star\'" class="file-detail" ng-class="{\'right-side\': treeSelected}">\n                <div class="star-hd">加星文件</div>\n                <div file-view="starFiles"\n                     file-view-layout="\'table\'"\n                     file-view-loading="loading"\n                     file-view-columns="\'favorite|modifier|size\'"\n                     file-view-list-mode="star"\n                     file-droppable-support="false"\n                     class="explorer-bd">\n                </div>\n            </div>\n            <div ng-show="listMode === \'list\'" class="file-detail" ng-class="{\'right-side\': treeSelected}">\n                <!-- 公告板 -->\n                <div ng-if="launcher.getGroup().settings[100]" notice></div>\n\n                <!--<div ng-include="\'pagelet/file/list/table.html\'" class="explorer-bd"></div>-->\n                <div class="explorer-hd" ng-class="{backable:stack.length > 1}">\n                    <div>\n                        <span class="back-btn" ng-click="backward()" ng-class="{disabled:stack.length == 1}">\n                            <svg class="back-btn-icon">\n                                <use xlink:href="#explorer_back"/>\n                            </svg>返回\n                        </span>\n                        <div class="vline"></div>\n                        <ul file-stack="stack"\n                            class="explorer-nav">\n                        </ul>\n                    </div>\n                </div>\n                <div class="folder-tip" ng-if="!folder.isOnlyManagerView&&folder.isOnlyManagerEdit">\n                    当前文件夹下所有内容均为只读状态，仅群管理员以上可修改\n                </div>\n                <div class="folder-tip" ng-if="folder.isOnlyManagerView">\n                    当前文件夹下所有内容均为群管理员以及群主可见\n                </div>\n                <div file-view="files"\n                     file-view-base="folder"\n                     file-view-layout="\'table\'"\n                     file-view-loading="loading"\n                     file-view-columns="\'date|modifier|size\'"\n                     file-view-list-mode="list"\n                     file-droppable-support="true"\n                     class="explorer-bd"\n                     ng-class="{\'has-tip\': folder.isOnlyManagerEdit || folder.isOnlyManagerView, \'has-notice\': launcher.getGroup().settings[100] }"\n                     widget-context-menu="getContextMenu()" menu-type="web">\n                </div>\n            </div>\n            <div ng-include="\'pagelet/file/upload/uploader.html\'"></div>\n        </div>\n    </div>\n    <div class="file-search" ng-show="search != null" ng-include="\'pagelet/search/search.html\'"></div>\n</div>'),$templateCache.put("pagelet/file/list/notice.html",'<div class="explorer-notice">\n    <div>\n        <div class="notice-title">\n            <svg class=\'icon\'>\n                <use xlink:href="#notice"/>\n            </svg>&nbsp;\n            <span ng-bind="noticeAbbrev || \'暂无公告\'"></span>\n            <svg class="detail_icon" title="收起/展开" ng-if="isDetail" ng-click="showMore()">\n                <use ng-if="!isMore" xlink:href="#file_upload_collapse"/>\n                <use ng-if="isMore" xlink:href="#file_upload_expand"/>\n            </svg>\n\n            <div class="notice-btn notice-btn-edit" ng-click="editNotice()" ng-if="!isEdit" permission-check="setting.editNotice">\n                编辑\n            </div>\n        </div>\n        <div class="notice-main" ng-if="isMore">\n            <div class="notice-content" ng-bind-html="noticeContent"></div>\n        </div>\n        <div class="notice-main" ng-show="isEdit">\n            <textarea class="notice-edit" ng-model="noticeContent" max-input-length="200"\n                      ng-trim="false" placeholder="请输入群公告…"></textarea>\n\n            <div class="notice-actions">\n                <span class="notice-btn" role="button" ng-click="cancelEdit()">取消</span>\n                <span class="notice-btn" role="button" ng-click="saveNotice()">发布</span>\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/file/list/table.html",'<div class="layout-table" file-layout-table>\n    <ul class="table-hd" file-layout-thead>\n        <li class="cell file-name" col-width="fill" ng-class="{isSupportSort: isSupportSort()}" ng-click="isSupportSort() && sortBy(\'name\')">\n            文件名\n            <svg class="arrow" ng-if="isSupportSort() && sortAttr==\'name\'">\n                <use ng-if="sortDirection == \'Desc\'" xlink:href="#arrow_down"/>\n                <use ng-if="sortDirection == \'Asc\'" xlink:href="#arrow_up"/>\n            </svg>\n        </li>\n        <li class="cell file-path" col-width="140" ng-if="::showColumn(\'path\')">所在位置</li>\n        <li class="cell file-path" col-width="140" ng-if="::showColumn(\'group\')">位置</li>\n        <li class="cell file-date" col-width="140" ng-if="::showColumn(\'date\')" ng-class="{isSupportSort: isSupportSort()}" ng-click="isSupportSort() && sortBy(\'time\')">\n            修改时间\n            <svg class="arrow" ng-if="isSupportSort() && sortAttr==\'time\'">\n                <use ng-if="sortDirection == \'Desc\'" xlink:href="#arrow_down"/>\n                <use ng-if="sortDirection == \'Asc\'" xlink:href="#arrow_up"/>\n            </svg>\n        </li>\n        <li class="cell file-date" col-width="140" ng-if="::showColumn(\'favorite\')">加星时间</li>\n        <li class="cell file-modifier" col-width="130" ng-if="showColumn(\'modifier\')" ng-class="{isSupportSort: isSupportSort()}" ng-click="isSupportSort() && sortBy(\'modifier\')">\n            最近修改人\n            <svg class="arrow" ng-show="isSupportSort() && sortAttr==\'modifier\'">\n                <use ng-if="sortDirection == \'Desc\'" xlink:href="#arrow_down"/>\n                <use ng-if="sortDirection == \'Asc\'" xlink:href="#arrow_up"/>\n            </svg>\n        </li>\n        <li class="cell file-size" col-width="80" ng-if="::showColumn(\'size\')" ng-class="{isSupportSort: isSupportSort()}" ng-click="isSupportSort() && sortBy(\'size\')">\n            大小\n            <svg class="arrow" ng-show="isSupportSort() && sortAttr==\'size\'">\n                <use ng-if="sortDirection == \'Desc\'" xlink:href="#arrow_down"/>\n                <use ng-if="sortDirection == \'Asc\'" xlink:href="#arrow_up"/>\n            </svg>\n        </li>\n    </ul>\n    <div widget-scroller="onTableScroll(height, visible, top, bottom)"\n         class="table-bd" widget-context-menu="getContextMenu()" menu-type="web">\n        <div class="region" file-selection="li.file-item" file-droppable="folder"\n             file-droppable-support="supportDroppable"\n             file-droppable-global-region="true">\n            <div class="nofile" ng-show="!loading && files.length === 0">\n                <svg class="icon-nofile">\n                    <use xlink:href="#blank_content"/>\n                </svg>\n                <div class="info">这里还没有内容</div>\n            </div>\n            <div class="loading-style" ng-show="loading" ng-class="{\'right-side\': treeSelected}"></div>\n            <ul file-layout-tbody class="rows" ng-show="!loading">\n                <div ng-show="creating"\n                    class="row file-item">\n                    <div>\n                        <div class="cell file-name"\n                              file-editor>\n                            <i class="file-icon">\n                                <svg class="folder_icon">\n                                    <use xlink:href="#type_folder"/>\n                                </svg>\n                            </i>\n                            <div class="name">\n                                <span ng-bind="createName"></span>\n                            </div>\n                        </div>\n                        <div class="cell file-path" ng-if="::showColumn(\'path\')">&nbsp;</div>\n                        <div class="cell file-path" ng-if="::showColumn(\'group\')">&nbsp;</div>\n                        <div class="cell file-date" ng-if="::showColumn(\'date\')">&nbsp;</div>\n                        <div class="cell file-date" ng-if="::showColumn(\'favorite\')">&nbsp;</div>\n                        <div class="cell file-modifier" ng-if="::showColumn(\'modifier\')">&nbsp;</div>\n                        <div class="cell file-size" ng-if="::showColumn(\'size\')">&nbsp;</div>\n                    </div>\n                </div>\n                <li ng-repeat="file in visibleFiles"\n                    ng-class="{selected:isSelected(file)}"\n                    file-droppable="file"\n                    file-droppable-support="supportDroppable"\n                    ng-dblclick="openOrForward(file)"\n                    class="row file-item">\n                    <div>\n                        <div class="cell file-name"\n                              file-editor="file">\n                            <i ng-if="!file.isFolder" file-icon="file" class="file-icon"\n                               ng-click="openOrForward(file);$event.stopPropagation()"></i>\n                            <div ng-if="!file.isFolder" class="name">\n                                <span title="{{file.name}}"\n                                      widget-highlight\n                                      high-value = "{{file.name}}"\n                                      keyword = "{{keyword}}"\n                                      ng-click="openOrForward(file, {search: keyword});$event.stopPropagation()"></span>\n                            </div>\n                            <i ng-if="file.isFolder" file-icon="file" class="file-icon"\n                               ng-click="openOrForward(file);$event.stopPropagation()"></i>\n                            <div ng-if="file.isFolder" class="name">\n                                <span title="{{file.name}}"\n                                      widget-highlight\n                                      high-value = "{{file.name}}"\n                                      keyword = "{{keyword}}"\n                                      ng-click="openOrForward(file);$event.stopPropagation();"></span>\n                            </div>\n                            <svg ng-if="file.shareEntry" class="share" ng-class="{folderShare : file.isFolder}">\n                                <use xlink:href="#share"/>\n                            </svg>\n                            <svg ng-if="!isGlobalstar && explorer.ableToShare(file)" class="share-trigger" ng-click="triggerShare(file);$event.stopPropagation()" ng-class="{ableToDownload:!isStar && explorer.ableToDownload(file), noStar:isStar && !(explorer.ableToDownload(file))}">\n                                <use class="default" xlink:href="#share_trigger"/>\n                                <use class="hover" xlink:href="#share_trigger_hover"/>\n                            </svg>\n                            <svg ng-if="!isStar && ableToFavorite" class="star-trigger" ng-click="toggleStar(file);$event.stopPropagation();" ng-class="{ableToDownload: explorer.ableToDownload(file), favorite: file.favorite}">\n                                <use class="default" xlink:href="#star_trigger"/>\n                                <use class="hover" xlink:href="#star_trigger_hover"/>\n                                <use class="fav" xlink:href="#star_trigger_favorite"/>\n                            </svg>\n                            <svg ng-if="explorer.ableToDownload(file) && !isGlobalstar"\n                                  class="dl-trigger"\n                                  ng-click="explorer.download(file);$event.stopPropagation()">\n                                <use class="default" xlink:href="#dl_trigger"/>\n                                <use class="hover" xlink:href="#dl_trigger_hover"/>\n                            </svg>\n                            <svg ng-if="!isGlobalstar" class="menu-trigger" file-context-menu="getFileMenu(file)">\n                                <use class="default" xlink:href="#menu_trigger"/>\n                                <use class="hover" xlink:href="#menu_trigger_hover"/>\n                            </svg>\n                        </div>\n                        <div class="cell file-path" ng-if="::showColumn(\'path\')">\n                            <span title="{{file.path ===\'/\' ? \'全部文件\' : file.path}}" ng-click="locateFile(file);$event.stopPropagation()" ng-bind="file.path ===\'/\' ? \'全部文件\' : file.path" class="path"></span>\n                        </div>\n                        <div class="cell file-path" ng-if="::showColumn(\'group\')">\n                            <span title="{{file.groupName}}" ng-click="forwardToGroup(file);$event.stopPropagation()" ng-bind="file.groupName" class="path"></span>\n                        </div>\n                        <div class="cell file-date" ng-if="::showColumn(\'date\')">{{file | fileDate:\'updateDate\' | dateFormat:\'yyyy-MM-dd HH:mm\'}}</div>\n                        <div class="cell file-date" ng-if="::showColumn(\'favorite\')">{{file | fileDate:\'favoriteDate\' | dateFormat:\'yyyy-MM-dd HH:mm\'}}</div>\n                        <div class="cell file-modifier" ng-if="::showColumn(\'modifier\')">{{file | fileModifier : \'lastUpdater\' | alias}}</div>\n                        <div class="cell file-size" ng-if="::showColumn(\'size\')">{{file.isFolder ? \'&nbsp;\' : (file.size | fileSize)}}</div>\n                    </div>\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/file/list/trash/trash.html",'<div class="file-detail trash-list" ng-class="{\'right-side\': treeSelected}" ng-controller="recycleCtrl">\n    <div class="trash-hd" ng-if="!loading"\n         permission-check="file.restoreOrClearTrash">\n        <div class="btn trash-restore"\n             ng-disabled="selectedFiles.length === 0"\n             ng-click="restoreFiles(gid(), selectedFiles);$event.stopPropagation();">\n            还原\n        </div>\n        <!--<div class="btn trash-clear" ng-click="deleteTrashes(gid(), selectedFiles);$event.stopPropagation();">-->\n        <div class="btn trash-clear"\n             ng-click="deleteTrashes(gid(), trashes, true);$event.stopPropagation();">\n            清空回收站\n        </div>\n        <div class="trash-tip">回收站内的文档将会保留30天，30天后将自动删除</div>\n    </div>\n    <div class="explorer-bd">\n        <div class="trash-table" file-layout-table>\n            <ul class="table-hd" file-layout-thead>\n                <li class="cell file-name" col-width="fill">文件名</li>\n                <li class="cell file-delete-date" col-width="140">删除时间</li>\n                <li class="cell file-deleter" col-width="130">删除人</li>\n                <li class="cell file-size" col-width="80">大小</li>\n            </ul>\n            <div widget-scroller="onTableScroll(height, visible, top, bottom)"\n                 class="table-bd" widget-context-menu="getTrashContextMenu()" menu-type="web">\n                <div class="region" permission-check="!file.viewRecycleBin">\n                    <div class="nopermission">\n                        <div class="nopermission-text">只有群主和管理员可以查看及恢复回收站中的文件</div>\n                    </div>\n                </div>\n                <div class="region" file-selection="li.trash-item" permission-check="file.viewRecycleBin">\n                    <div class="nofile" ng-show="trashes.length === 0">\n                        <svg class="icon-nofile">\n                            <use xlink:href="#blank_content"/>\n                        </svg>\n                        <div class="info">这里没有内容</div>\n                    </div>\n                    <ul file-layout-tbody class="rows" ng-show="!loading">\n                        <li ng-repeat="file in trashes"\n                            ng-class="{selected:isSelected(file)}"\n                            class="row trash-item">\n                            <div>\n                                <div class="cell file-name">\n                                    <i ng-if="!file.isFolder" file-icon="file" class="file-icon"></i>\n                                    <div ng-if="!file.isFolder" class="trash-name">\n                                        <span title="{{file.name}}">{{file.name}}</span>\n                                    </div>\n                                    <i ng-if="file.isFolder" file-icon="file" class="file-icon"></i>\n                                    <div ng-if="file.isFolder" class="trash-name">\n                                        <span title="{{file.name}}">{{file.name}}</span>\n                                    </div>\n                                    <div permission-check="file.restoreOrClearTrash">\n                                        <svg class="restore-trigger" title="还原" ng-click="restoreFiles(gid(), file)">\n                                            <use class="default" xlink:href="#restore_trigger"/>\n                                            <use class="hover" xlink:href="#restore_trigger_hover"/>\n                                        </svg>\n                                        <svg class="delete-trigger" title="彻底删除" ng-click="deleteTrashes(gid(), file)">\n                                            <use class="default" xlink:href="#delete_trigger"/>\n                                            <use class="hover" xlink:href="#delete_trigger_hover"/>\n                                        </svg>\n                                    </div>\n                                </div>\n                                <div class="cell file-delete-date">{{file | fileDate | dateFormat:\'yyyy-MM-dd HH:mm\'}}</div>\n                                <div class="cell file-deleter">{{file | fileModifier:\'deleter\' | alias}}</div>\n                                <div class="cell file-size" ng-if="!file.isFolder">{{file.size | fileSize}}</div>\n                                <div class="cell file-size" ng-if="file.isFolder">&nbsp;</div>\n                            </div>\n                        </li>\n                    </ul>\n                </div>\n             </div>\n        </div>\n        <div class="explorer-wait" ng-if="waiting">\n            <div class="msg">\n                <p ng-bind="waiting"></p>\n            </div>\n            <div class="mask"></div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/file/list/view.html",'<div ng-if="layout === \'table\'"\n     ng-include="\'pagelet/file/list/table.html\'"\n     class="file-view">\n</div>\n<div class="explorer-wait" ng-if="waiting">\n    <div class="msg">\n        <p ng-bind="waiting"></p>\n    </div>\n    <div class="mask"></div>\n</div>'),$templateCache.put("pagelet/file/msg/message-tip.html","<span ng-if='tip.operation == 0 && tip.isDir ' ng-bind=\"tip.user.name + '：发送了文件夹' \"></span>\n<span ng-if='tip.operation == 0 && !tip.isDir ' ng-bind=\"tip.user.name + '：发送了文件' \"></span>\n<span ng-if='tip.operation == 1 && tip.isDir ' ng-bind=\"tip.user.name + '：创建了文件夹' \"></span>\n<span ng-if='tip.operation == 1 && !tip.isDir ' ng-bind=\"tip.user.name + '：上传了文件' \"></span>\n<span ng-if='tip.operation == 2 && tip.isDir ' ng-bind=\"tip.user.name + '：修改了文件夹' \"></span>\n<span ng-if='tip.operation == 2 && !tip.isDir ' ng-bind=\"tip.user.name + '：修改了文件' \"></span>\n<span ng-if='tip.operation == 3 && tip.isDir ' ng-bind=\"tip.user.name + '：删除了文件夹' \"></span>\n<span ng-if='tip.operation == 3 && !tip.isDir ' ng-bind=\"tip.user.name + '：删除了文件' \"></span>\n"),$templateCache.put("pagelet/file/msg/message.html",'<div ng-controller="fileMessageCtrl">\n    <div class="msg-photo">\n        <img ng-src="{{::message.user.photo | photo}}" class="bubble-user" user-info data-user-id="{{message.user.userId}}" />\n        <i class="operation-icon" ng-class="::{\'operation-create-icon\':(message.operation == 1 && message.isDir), \'operation-edit-icon\': message.operation == 2, \'operation-upload-icon\': (message.operation == 1 && !message.isDir) || message.operation == 6, \'operation-delete-icon\': message.operation == 3, \'operation-rename-icon\': message.operation == 7, \'operation-recover-icon\': message.operation == 8}"></i>\n    </div>\n    <div class="content-node" id="{{messageId}}">\n        <div class="content-head ellipsis selectable">\n            <div class="username" user-info data-user-id="{{message.user.userId}}" ng-bind="::(message.user | alias)"></div>\n            <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{message.user.userId}}\']}"></i></a>\n            <div class="operation">\n                <span ng-if=\'::(message.operation == 0)\' ng-switch="::message.isDir">\n                    <span ng-switch-when=\'true\'>发送了文件夹</span>\n                    <span ng-switch-when=\'false\'>发送了文件</span>\n                </span>\n                <span ng-if=\'::(message.operation == 1)\' ng-switch="::message.isDir">\n                    <span ng-switch-when=\'true\'>新建了文件夹</span>\n                    <span ng-switch-when=\'false\'>上传了文件</span>\n                </span>\n                <span ng-if=\'::(message.operation == 2)\' ng-switch="::message.isDir">\n                    <span ng-switch-when=\'true\'>修改了文件夹</span>\n                    <span ng-switch-when=\'false\'>修改了文件</span>\n                </span>\n                <span ng-if=\'::(message.operation == 3)\' ng-switch="::message.isDir" class="delete">\n                    <span ng-switch-when=\'true\'>删除了文件夹</span>\n                    <span ng-switch-when=\'false\'>删除了文件</span>\n                </span>\n                <span ng-if=\'::(message.operation == 5)\' ng-switch="::message.isDir">\n                    <span ng-switch-when=\'true\'>导入了文件夹</span>\n                    <span ng-switch-when=\'false\'>导入了文件</span>\n                </span>\n                <span ng-if=\'::(message.operation == 6)\' ng-switch="::message.isDir">\n                    <span ng-switch-when=\'true\'>上传了文件夹</span>\n                </span>\n                <span ng-if=\'::(message.operation == 7)\' ng-switch="::message.isDir">\n                    <span ng-switch-when=\'false\'>重命名了文件</span>\n                    <span ng-switch-when=\'true\'>重命名了文件夹</span>\n                </span>\n                <span ng-if=\'::(message.operation == 8)\' ng-switch="::message.isDir">\n                    <span ng-switch-when=\'false\'>还原了文件</span>\n                    <span ng-switch-when=\'true\'>还原了文件夹</span>\n                </span>\n            </div>\n            <div class="time" ng-bind="::(message.time | date:\'HH:mm\')"></div>\n        </div>\n        <div class="bubble">\n            <div class="bubble-node bubble-file-node" ng-class="::{\'bubble-delete-node\': message.operation == 3, \'shadow-border\': message.operation == 1}" ng-if="files.length === 1">\n                <div class="fileinfo" ng-if="::(message.operation != 3)">\n                    <div ng-if="file.isDir" class="file-dir" ng-click="openFolder(file.fileId)" title="{{ file.fileName }}">\n                        <i class="fileicon active" file-icon="getIcon(file)" file-size="large"></i>\n                        <div class="filemeta">\n                            <span class="name active folder-name selectable" ng-bind="file.fileName"></span>\n                        </div>\n                    </div>\n                    <div ng-if="!file.isDir">\n                        <i class="fileicon active" file-icon="getIcon(file)" file-size="large"\n                           file-open\n                           file-id="file.fileId"\n                           file-version="file.version"\n                           file-name="file.fileName"\n                           group-id="gid()"\n                                ></i>\n                        <div class="filemeta">\n                            <span class="name active selectable" ng-bind="file.fileName"\n                                  file-open\n                                  file-id="file.fileId"\n                                  file-version="file.version"\n                                  file-name="file.fileName"\n                                  group-id="gid()"\n                                    ></span>\n                            <span class="revision active" ng-bind="::(\'第 \' + file.version + \' 版\')"\n                                  file-open-revision\n                                  file-id="file.fileId"\n                                  file-version="file.version"\n                                  group-id="gid()"\n                                    ></span>\n                        </div>\n                    </div>\n                </div>\n                <div class="fileinfo" ng-if="::(message.operation == 3)">\n                    <div ng-if="file.isDir" class="file-dir" title="{{ file.fileName }}">\n                        <i class="fileicon" file-icon="getIcon(file)" file-size="large" file-grey="true"></i>\n                        <div class="filemeta">\n                            <span class="name folder-name selectable delete" ng-bind="file.fileName"></span>\n                        </div>\n                    </div>\n                    <div ng-if="!file.isDir">\n                        <i class="fileicon" file-icon="getIcon(file)" file-size="large"  file-grey="true"></i>\n                        <div class="filemeta">\n                            <span class="name selectable delete" ng-bind="file.fileName"\n                                    ></span>\n                            <span class="revision" ng-bind="::(\'第 \' + file.version + \' 版\')"\n                                    ></span>\n                        </div>\n                    </div>\n                </div>\n                <div ng-if="::(!message.isDir && message.operation != 3)">\n                    <div class="bubble-split">\n                    </div>\n                    <div class="fileaction"\n                         file-open-exist-dir\n                         file-id="file.fileId"\n                         file-version="file.version"\n                         file-name="file.fileName"\n                         group-id="gid()">\n                        <svg class="folder-opener">\n                            <use class="default" xlink:href="#folder_opener"/>\n                            <use class="hover" xlink:href="#folder_opener_hover"/>\n                        </svg>\n                        <span class="fileaction-item">打开文件夹</span>\n                    </div>\n                </div>\n            </div>\n            <div class="bubble-node bubble-batch-node" ng-if="files.length > 1">\n                <div ng-repeat="file in files | limitTo: displayedNumber">\n                    <div class="file-line" ng-if="message.operation != 3">\n                        <i class="icon" file-icon="getIcon(file)" file-size="small"></i>\n                        <span ng-if="!file.isDir" class="file-name"  title="{{file.fileName}}" ng-click="openFile(file.fileId)">{{file.fileName | cutStringWithSuffix: 10}}</span>\n                        <span ng-if="file.isDir" class="file-name"  title="{{file.fileName}}" ng-click="openFolder(file.fileId)">{{file.fileName | cutStringWithSuffix: 10}}</span>\n                        <span class="fileaction" ng-click="locateFile(file.fileId)">\n                            <svg class="folder-opener">\n                                <use class="default" xlink:href="#folder_opener"></use>\n                                <use class="hover" xlink:href="#folder_opener_hover"></use>\n                            </svg>\n                        </span>\n                    </div>\n                </div>\n                <div class="bubble-split split-line" ng-if="files.length > 5"></div>\n                <div class="button-more-files" ng-if="files.length > 5 && displayedNumber < files.length" ng-click="showMoreFiles()">\n                    <span>\n                        <svg class="arrow">\n                            <use class="default" xlink:href="#show_more"></use>\n                            <use class="hover" xlink:href="#show_more_hover"></use>\n                        </svg>\n                    </span>\n                    <span>显示更多</span>\n                </div>\n                <div class="button-more-files" ng-if="files.length > 5 && displayedNumber === files.length" ng-click="packFiles()">\n                    <span>\n                        <svg class="arrow">\n                            <use class="default" xlink:href="#pack_all"></use>\n                            <use class="hover" xlink:href="#pack_all_hover"></use>\n                        </svg>\n                    </span>\n                    <span>收起</span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/file/revision/revision.html",'<ul ng-controller="revisionCtrl" class="file-revision">\n    <li class="item" ng-repeat="rev in revisions" ng-switch="$first" ng-class="{active: version ? rev.version == version : rev.version == revisions.length}">\n        <img class="photo" ng-src="{{(rev | fileModifier).photo | photo }}"/>\n        <span class="info" title="{{rev | fileModifier | alias}}{{ rev | fileAction}}了文件（第 {{rev.version}} 版）">\n            {{rev | fileModifier | alias}}{{ rev | fileAction}}了文件（第 {{rev.version}} 版）\n        </span>\n        <span class="date">{{rev | fileDate | date:\'yyyy-MM-dd HH:mm\'}}</span>\n        <span ng-switch-when="true">\n            <span class="version" >当前版本</span>\n            <span class="compare" ng-if="isCanCompareDocument(rev)" ng-click="compareDocument(rev)">\n                查看版本修改\n            </span>\n        </span>\n        <span ng-switch-default>\n            <span class="download" ng-click="download(gid,rev)">\n                下载该版本\n            </span>\n            <span class="compare" ng-if="isCanCompareDocument(rev)" ng-click="compareDocument(rev)">\n                查看版本修改\n            </span>\n        </span>\n    </li>\n</ul>\n'),$templateCache.put("pagelet/file/selector/copy-dialog.html",'<div ng-controller="copyCtrl" class="copy-selector" ng-click="hidePath()">\n    <div class="copy-selector-files" ng-if="except.length > 0">\n        <div class="one-file" ng-if="except.length == 1">\n            <i class="file-icon" ng-if="except.length == 1" file-icon="except[0]"></i>\n            <p class="file-name" title="{{showName(except)}}" ng-bind="fileName"></p>\n        </div>\n        <div class="multi-files" ng-if="except.length > 1">\n            <div class="multi-file-name" title="{{showName(except)}}">\n                {{fileName}}  等{{except.length}}个文件\n            </div>\n        </div>\n    </div>\n    <div class="copy-selector-bd">\n        <div class="destination-group-selector">\n            <span class="group-text">群：</span>\n            <ui-select class="dst-groups" ng-model="dstGroups.selected" theme="selectize">\n                <ui-select-match placeholder="{{currentGroup.name}}">\n                    <span ng-bind="$select.selected.name"></span>\n                </ui-select-match>\n                <ui-select-choices repeat="group in dstGroups">\n                    <span ng-bind="group.name"></span>\n                </ui-select-choices>\n            </ui-select>\n        </div>\n        <div class="destination-path-selector" ng-click="togglePath();$event.stopPropagation()">\n            <div class="bd-selector-path">\n                <span>路径：</span>\n                <span class="path" ng-bind="selectedPath" title="{{paths}}"></span>\n            </div>\n        </div>\n        <div ng-if="showPath && groupSelected != undefined">\n            <div class="destination-folder-selector" ng-include="\'pagelet/file/selector/copy-node.html\'"></div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/file/selector/copy-node.html",'<div class="file-selector-file"\n     ng-controller="fileSelectNodeCtrl"\n     ng-show="file!=undefined">\n    <div class="file-selector-title"\n         ng-class="{selected : selected, expanded : expanded, expandable : expandable}">\n        <div ng-if="expandable" class="toggle"  ng-click="toggle();$event.stopPropagation();">\n            <svg class="arrow">\n                <use ng-if="!expanded" xlink:href="#arrow_right"/>\n                <use ng-if="expanded" xlink:href="#arrow_down"/>\n            </svg>\n        </div>\n        <div class="name" ng-click="select()">\n            <svg class="folder">\n                <use ng-if="!file.parentId" class="default" xlink:href="#root"/>\n                <use ng-if="!file.parentId" class="hover" xlink:href="#root_hover"/>\n                <use ng-if="file.parentId&&!expanded" class="default" xlink:href="#folder"/>\n                <use ng-if="file.parentId&&!expanded" class="hover" xlink:href="#folder_hover"/>\n                <use ng-if="file.parentId&&expanded" class="default" xlink:href="#folder_expand"/>\n                <use ng-if="file.parentId&&expanded" class="hover" xlink:href="#folder_expand_hover"/>\n            </svg>\n            <span class="file-name" title="{{file.name}}" ng-bind="file.name"></span>\n        </div>\n    </div>\n    <ul class="file-selector-files">\n        <li ng-repeat="file in files" ng-include="\'pagelet/file/selector/copy-node.html\'" />\n    </ul>\n</div>'),$templateCache.put("pagelet/file/selector/selector-dialog.html",'<div ng-controller="fileSelectCtrl" class="file-selector">\n    <div class="file-selector-hd" ng-if="except.length > 0">\n        <i class="file-icon" ng-if="except.length == 1" file-icon="except[0]"></i>\n        <p class="file-name" title="{{showName(except)}}" ng-bind="showName(except)"></p>\n        <p class="files-num" ng-if="except.length > 1">\n            等{{except.length}}个文件\n        </p>\n    </div>\n    <div class="file-selector-bd">\n        <div class="bd-selector-path">{{$dialog.title}}：<span class="path" ng-bind="processPath(paths)" title="{{paths}}"></span> </div>\n        <div class="file-selector-node" ng-include="\'pagelet/file/selector/selector-node.html\'"></div>\n    </div>\n</div>'),$templateCache.put("pagelet/file/selector/selector-node.html",'<div class="file-selector-file"\n     ng-controller="fileSelectNodeCtrl"\n     ng-show="file!=undefined">\n    <div class="file-selector-title"\n         ng-class="{selected : selected, expanded : expanded, expandable : expandable}">\n        <div ng-if="expandable" class="toggle"  ng-click="toggle();$event.stopPropagation();">\n            <svg class="arrow">\n                <use ng-if="!expanded" xlink:href="#arrow_right"/>\n                <use ng-if="expanded" xlink:href="#arrow_down"/>\n            </svg>\n        </div>\n        <div class="name" ng-click="select()">\n            <svg class="folder">\n                <use ng-if="!file.parentId" class="default" xlink:href="#root"/>\n                <use ng-if="!file.parentId" class="hover" xlink:href="#root_hover"/>\n                <use ng-if="file.parentId&&!expanded" class="default" xlink:href="#folder"/>\n                <use ng-if="file.parentId&&!expanded" class="hover" xlink:href="#folder_hover"/>\n                <use ng-if="file.parentId&&expanded" class="default" xlink:href="#folder_expand"/>\n                <use ng-if="file.parentId&&expanded" class="hover" xlink:href="#folder_expand_hover"/>\n            </svg>\n            <span class="file-name" title="{{file.name}}" ng-bind="file.name"></span>\n        </div>\n    </div>\n    <ul class="file-selector-files">\n        <li ng-repeat="file in files" ng-include="\'pagelet/file/selector/selector-node.html\'" />\n    </ul>\n</div>'),$templateCache.put("pagelet/file/share/share-dialog.html",'<div class="share-dialog" ng-controller="shareDialogCtrl">\n    <div class="share-content">\n        <i class="success-icon"></i>\n        <div>\n            <div class="content-title">链接生成成功</div>\n            <div class="content-desc">将链接发给好友即可分享内容</div>\n        </div>\n    </div>\n    <div>\n        <input id="link-addr" type="text" readonly ng-value="message" onClick="this.select();"/>\n        <div class="btn-container" ng-if="!client.isPC() && !client.isMac()">\n            <button class="btn btn-copy" ng-bind="copyBtnText" ng-disabled="copyDone" clipboard="clipboardOptions"></button>\n        </div>\n        <div class="btn-container" ng-if="client.isPC() && !client.isMac()">\n            <button class="btn btn-copy" ng-bind="copyBtnText" ng-disabled="copyDone" ng-click="copyTextFromClient()"></button>\n        </div>\n        <div class="wx-icon">\n            <svg ng-mouseover="(showQrcode = true)" ng-mouseleave="(showQrcode = false)">\n                <use class="default" xlink:href="#share_qrcode"/>\n                <use class="hover" xlink:href="#share_qrcode_hover"/>\n            </svg>\n            <div class="wx-wrap" ng-show="showQrcode">\n                <span class="bot"></span>\n                <span class="top"></span>\n                <div id="wx-qrcode"></div>\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/file/tree/file-tree.html",'<div class="file-selector-file"\n     ng-controller="fileTreeSelectNodeCtrl"\n     ng-show="treeFile!=undefined">\n    <div class="file-selector-title"\n         file-droppable="treeFile"\n         file-droppable-support="true"\n         ng-class="{selected : selected, expanded : expanded, expandable : expandable}">\n        <div ng-if=\'expandable\' class = "toggle"  ng-click="toggle()">\n            <svg class="arrow">\n                <use ng-if="!expanded" xlink:href="#arrow_right"/>\n                <use ng-if="expanded" xlink:href="#arrow_down"/>\n            </svg>\n        </div>\n        <div class="name" ng-click="select();openOrForward(treeFile);">\n            <svg class="folder">\n                <use ng-if="!treeFile.parentId" class="default" xlink:href="#root"/>\n                <use ng-if="!treeFile.parentId" class="hover" xlink:href="#root_hover"/>\n                <use ng-if="treeFile.parentId&&!expanded" class="default" xlink:href="#folder"/>\n                <use ng-if="treeFile.parentId&&!expanded" class="hover" xlink:href="#folder_hover"/>\n                <use ng-if="treeFile.parentId&&expanded" class="default" xlink:href="#folder_expand"/>\n                <use ng-if="treeFile.parentId&&expanded" class="hover" xlink:href="#folder_expand_hover"/>\n            </svg>\n            <span class="file-name" title="{{treeFile.name}}" ng-bind="treeFile.name"></span>\n        </div>\n    </div>\n    <ul class="file-selector-files" ng-if="expanded">\n        <li ng-repeat="treeFile in treeFiles" class="filetree-item" ng-include="\'pagelet/file/tree/file-tree.html\'" />\n    </ul>\n</div>\n'),$templateCache.put("pagelet/file/upload/exceed-spaceQuota.html",'<div class="confirm">\n    <p>{{message}}群存储容量已满，无法增加文件。</p>\n    <p>现在<a href="//note.youdao.com/biz/" target="_blank" tracker track-category="exceed" track-action="exceed-space-click">购买企业版</a>，享超大空间！</p>\n</div>'),$templateCache.put("pagelet/file/upload/exceed-uploadLimitQuota.html",'<div class="confirm">\n    <p>{{message}}</p>\n    <p><a href="//note.youdao.com/biz/" target="_blank">购买企业版</a>，创建的协作群均享受1G大文件支持</p>\n</div>'),$templateCache.put("pagelet/file/upload/progress-dialog.html",'<div class="file-progress" ng-controller="progressCtrl">\n    <p class="info">{{text}}</p>\n    <div widget-progress value="sent" max="total" class="bar"></div>\n    <span class="percent">{{percent}}%</span>\n</div>'),$templateCache.put("pagelet/file/upload/upload-dialog.html",'<div class="file-upload" ng-controller="uploadCtrl">\n    <p class="error" ng-show="errMsg != undefined">{{errMsg}}</p>\n</div>\n'),$templateCache.put("pagelet/file/upload/upload-selector-dialog.html",'<div class="file-selector upload" ng-controller="fileSelectCtrl">\n    <div class="file-selector-hd">\n        <i ng-if="except.length == 1" file-icon="except[0]"></i>\n        <p class="file-name" title="{{showName(except)}}" ng-bind="showName(except)"></p>\n        <p class="files-num" ng-if="except.length > 1">\n            等{{except.length}}个文件\n        </p>\n    </div>\n    <div class="file-selector-bd">\n        <div ng-show="!showFiles">\n            <div class="bd-selector-path hide-files">上传到：<span class="path" ng-bind="processPath(paths)" title="{{paths}}"></span> <button class="btn primary" ng-click="showFiles = true">修 改</button> </div>\n        </div>\n        <div ng-show="showFiles">\n            <div class="bd-selector-path">上传到：<span class="path" ng-bind="processPath(paths)" title="{{paths}}"></span> </div>\n            <div class="file-selector-node" ng-include="\'pagelet/file/selector/selector-node.html\'"></div>\n        </div>\n    </div>\n    <div class="file-selector-ft">\n        <button ng-click="confirm()" class="btn primary">开始上传</button>\n        <button ng-click="cancel()" class="btn cancel">取消</button>\n    </div>\n</div>'),$templateCache.put("pagelet/file/upload/uploader.html",'<div class="file-uploader" ng-controller="uploaderCtrl" ng-show="runnings().length + waitings().length + finishes().length > 0" ng-class="{minimize: minimize}">\n    <div class="file-uploader-hd">\n        <span class="uploader-hd-title" ng-if="finishes().length < runnings().length + waitings().length + finishes().length">正在上传&nbsp;{{finishes().length}} / {{runnings().length + waitings().length + finishes().length}}</span>\n        <span class="uploader-hd-title" ng-if="finishes().length == runnings().length + waitings().length + finishes().length">上传完成</span>\n        <svg class="icon-status" title="收起/展开" ng-click="minimize = !minimize">\n            <use class="default" ng-if="!minimize" xlink:href="#dialog_collapse"/>\n            <use class="hover" ng-if="!minimize" xlink:href="#dialog_collapse_hover"/>\n            <use class="default" ng-if="minimize" xlink:href="#dialog_expand"/>\n            <use class="hover" ng-if="minimize" xlink:href="#dialog_expand_hover"/>\n        </svg>\n        <svg class="icon-close" title="关闭" ng-click="close()">\n            <use class="default" xlink:href="#dialog_close"/>\n            <use class="hover" xlink:href="#dialog_close_hover"/>\n        </svg>\n    </div>\n    <ul class="file-uploader-bd" ng-hide="minimize">\n            <li class="uploader-item running" ng-repeat="uploader in runnings()">\n                <i class="icon file-icon" file-icon="uploader"></i>\n                <p class="file-name">{{uploader.name}}</p>\n                <p class="file-size" ng-bind="uploader.total | fileSize"></p>\n                <svg class="icon-cancel" ng-click="cancel(uploader)">\n                    <use class="default" xlink:href="#file_upload_cancel"/>\n                    <use class="hover" xlink:href="#file_upload_cancel_hover"/>\n                </svg>\n                <div class="progress">\n                    <span class="uploader-progress" value="uploader.sent" max="uploader.total" status="uploader.status"></span>\n                </div>\n            </li>\n            <li class="uploader-item waiting" ng-repeat="uploader in waitings()">\n                <i class="icon file-icon" file-icon="uploader"></i>\n                <p class="file-name">{{uploader.name}}</p>\n                <p class="file-size" ng-bind="uploader.total | fileSize"></p>\n                <svg class="icon-cancel" ng-click="cancel(uploader)">\n                    <use class="default" xlink:href="#file_upload_cancel"/>\n                    <use class="hover" xlink:href="#file_upload_cancel_hover"/>\n                </svg>\n            </li>\n            <li class="uploader-item finish" ng-class="{nofull: !fullScreen, done: uploader.status==\'done\', error: uploader.status==\'error\'}" ng-repeat="uploader in finishes()">\n                <i class="file-icon" file-icon="uploader" ng-click="openFile(uploader.gid, uploader.id)"></i>\n                <p class="file-name" ng-click="openFile(uploader.gid, uploader.id)" ng-bind="uploader.name"></p>\n                <p class="file-size" ng-bind="uploader.total | fileSize"></p>\n                <svg class="icon-locate" title="{{hintTitle}}" ng-click="locationFile(uploader.gid, uploader.id)">\n                    <use class="default" xlink:href="#folder_opener"/>\n                    <use class="hover" xlink:href="#folder_opener_hover"/>\n                </svg>\n                <svg class="icon-success" ng-show="uploader.status == \'done\'">\n                    <use xlink:href="#file_upload_success"/>\n                </svg>\n                <svg class="icon-error" ng-show="uploader.status == \'error\'">\n                    <use xlink:href="#file_upload_error"/>\n                </svg>\n                <div class="progress">\n                    <span class="uploader-progress" value="uploader.sent" max="uploader.total" status="uploader.status"></span>\n                </div>\n                <span class="finish-text" ng-show="uploader.status == \'done\'">上传完成</span>\n            </li>\n    </ul>\n</div>'),$templateCache.put("pagelet/image/detail.html",'<div detail-comment>\n    <div class="image-detail" ng-controller="imageDetailCtrl">\n        <div ng-if="fileData!=null">\n            <p class="info" ng-show="meta">\n                <span class="meta-item">                    \n                    {{fileData | fileModifier | alias}}  \n                    {{fileData | fileModifyTime | dateFormat:\'yyyy-MM-dd HH:mm\'}}  \n                    {{fileData | fileAction}}\n                </span>\n                <span class="meta-path-prefix">所在位置: </span>\n                <span class="meta-path" ng-bind="filePath" title="{{filePath}}" ng-click="onOpenFolder(fileData.id)"></span>\n            </p>\n            <div class="detail-image-bd" ng-if="imageFile != null">\n                <div class="detail-image-prevew">\n                    <img class="detail-image"\n                         ng-click="openPreivew()"\n                         widget-preview="image"\n                         widget-preview-list="imageList"\n                         ng-src="{{image.preSrc}}"\n                         image-onload="getPageHeight()"\n                         image-fallback/>\n                </div>\n                <div href="javascript:;" class="pager prev" ng-if="hasPrev()" ng-click="prev()">\n                    <span class="prev-button"></span>\n                </div>\n                <div href="javascript:;" class="pager next" ng-if="hasNext()" ng-click="next()">\n                    <span class="next-button"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n'),$templateCache.put("pagelet/md/diffview/mdDiff.html",'<div class="mddiff" ng-controller="mdDiffCtrl">\n    <div class="history-container">\n        <div class="history">\n            <div class="history-title">\n                <div class="title" ng-switch="curVersion == 1">\n                    <span ng-switch-when="false"  ng-bind="\'第 \'+ curVersion +\' 版与第 \' + (curVersion - 1) + \' 版的比较结果\'"></span>\n                    <span ng-switch-when="true"  ng-bind="\'第 \'+ curVersion +\' 版\'"></span>\n                </div>\n            </div>\n            <div class="name" ng-bind-html="diffTitle">\n            </div>\n            <div class="content">\n                <iframe ng-src="{{diffUrl}}"\n                        height="100%" width="100%" frameborder="0"></iframe>\n            </div>\n        </div>\n        <div class="history-meta">\n            <div class="history-meta-title">\n                <span>历史版本</span>\n            </div>\n            <div class="history-meta-ul" widget-scroller>\n                <ul>\n                    <li ng-repeat=\'mdHistory in mdHistoryList\'\n                        class="history-meta-li">\n                        <div class="md-history-item"\n                             ng-click="changeVersion(mdHistory.version)"\n                             ng-class="{active: mdHistory.version == activeVersion}">\n                            <img class="photo" ng-src="{{mdHistory.modifier.photo | photo}}"/>\n                            <div class="md-history-info">\n                                <div>\n                                    <span class="md-history-author ellipsis" ng-bind="mdHistory.modifier.name">\n                                    </span>\n                                    <span ng-if="!$last" class="operation">修改了文件</span>\n                                    <span ng-if="$last" class="operation">创建了文件</span>\n                                </div>\n                                <div>\n                                    <span class="md-history-date"  ng-bind="mdHistory.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\'"></span>\n                                    <span class="version" ng-bind="\'第\'+ mdHistory.version + \'版\'"></span>\n                                </div>\n                            </div>\n                        </div>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </div>\n    <div class="diff-tip"><span class="green"></span>绿色表示与前一版本比较的新增内容&nbsp;&nbsp;&nbsp;&nbsp;<span class="red"></span>红色表示与前一版本比较的删除内容</div>\n</div>'),$templateCache.put("pagelet/md/md.html",'<div class="detail md"\n     ng-class="{nocomment:file==null,max:max}"\n     ng-controller="mdCtrl">\n    <div class="detail-hd">\n        <span class="back" ng-click="quit()" ng-show="!fullScreen">\n            <svg class="icon-back">\n                <use xlink:href="#back"/>\n            </svg>\n            返回\n        </span>\n        <div class="title selectable">\n            <input class="name-input"\n                   type="text"\n                   placeholder="请输入标题"\n                   maxlength="240"\n                   ng-model="title"\n                   ng-show="mode === \'edit\'"/>\n            <span class="name" ng-bind="title" ng-show="mode === \'view\'"></span>\n        </div>\n        <div class="detail-hd-right">\n            <button class="detail-btn"\n                    ng-click="edit()"\n                    title="编辑"\n                    ng-show="mode == \'view\'"\n                    file-permission-check="file.edit"\n                    file-permission-file="file">\n                <svg class="btn-icon">\n                    <use class="default" xlink:href="#detail_edit"/>\n                    <use class="hover" xlink:href="#detail_edit_hover"/>\n                </svg>\n                <span class="btn-text">编辑</span>\n            </button>\n            <button class="detail-btn" ng-click="saveAndQuit()" title="发布" ng-show="mode == \'edit\'"\n                    ng-disabled="saving">\n                <svg class="btn-icon">\n                    <use class="default" xlink:href="#detail_release"/>\n                    <use class="hover" xlink:href="#detail_release_hover"/>\n                </svg>\n                <span class="btn-text" ng-if="!saving">发布</span>\n                <span class="btn-text" ng-if="saving">正在发布</span>\n            </button>\n            <div file-detail-tools="file"\n                 tools-close="quit()"\n                 tools-open-window="!fullScreen"\n                 mode="mode"\n                 saving="saving"\n                 show-info-revision="true"></div>\n        </div>\n    </div>\n    <div class="detail-bd md-detail" ng-class="{meta:meta}">\n        <div class="view" ng-if="mode === \'view\'">\n            <p class="info" ng-show="meta">\n                <span class="meta-item" ng-bind="\'创建时间：\' + (file.createDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-item" ng-bind="\'修改时间：\' + (file.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-path-prefix">所在位置: </span>\n                <span class="meta-path" ng-bind="filePath" title="{{filePath}}" ng-click="onOpenFolder(file.id)"></span>\n            </p>\n            <iframe class="md-editor-preview-frame"\n                    ng-src="{{previewSrc}}"></iframe>\n            <div class="loading-style" ng-show="loading"></div>\n        </div>\n        <div class="edit" ng-if="mode === \'edit\'">\n            <p class="info" ng-show="meta">\n                <span class="meta-item" ng-bind="\'创建时间：\' + (file.createDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-item" ng-bind="\'修改时间：\' + (file.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n            </p>\n            <iframe class="md-editor-frame"\n                    ng-src="{{editorSrc}}"></iframe>\n            <div class="loading-style" ng-show="loading"></div>\n        </div>\n    </div>\n    <div ng-if="file" class="detail-aside">\n        <div>\n            <div class="comment-hd">\n                <span class="comment-title">评论</span>\n                <div class="toggle-comment" title="关闭评论" ng-click="$parent.max = !$parent.max; $event.stopPropagation()">\n                    <svg class="icon-close">\n                        <use xlink:href="#close"/>\n                    </svg>\n                </div>\n            </div>\n            <div comment\n                 type="file"\n                 file="file"\n                 entry-id="{{file.id}}"\n                 comment-id="{{commentId}}"\n                 sum="{{file.comments}}"\n                 get-user="getUser()"\n                 user-id="{{userId}}">\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/note/demo/tpl.html",'<div class="demo-page">\n    <iframe frameborder="none"\n            class="note-content"></iframe>\n    <div class="tool-bar" ng-class="{show : inDemoArea}">\n        <div ng-click="zoomIn()">\n            <i class="demo-mode-icon zoom-in-icon" title="放大"></i>\n        </div>\n        <div ng-click="zoomOut()">\n            <i class="demo-mode-icon zoom-out-icon" title="缩小"></i>\n        </div>\n        <div ng-click="exitDemoMode()">\n            <i class="demo-mode-icon esc-icon" title="退出"></i>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/note/diffview/noteDiff.html",'<div class="notediff" ng-controller="noteDiffCtrl">\n    <div class="history-container">\n    <div class="history">\n        <div class="history-title">\n            <div class="isDifferent" ng-if="!isDifferent" ng-bind="\'第\'+ version1 +\'版没有修改\'">\n            </div>\n            <div class="title" ng-switch="version1 == 1">\n                <span ng-switch-when="false"  ng-bind="\'第 \'+ version1 +\' 版与第 \' + version2 + \' 版的比较结果\'"></span>\n                <span ng-switch-when="true"  ng-bind="\'第 \'+ version1 +\' 版\'"></span>\n            </div>\n        </div>\n        <div class="content">\n            <iframe note-view="diffC" height="100%" width="100%" frameborder="0"></iframe>\n        </div>\n    </div>\n    <div class="history-meta">\n        <div class="history-meta-title">\n            <span>历史版本</span>\n        </div>\n        <ul class="history-meta-ul">\n            <li ng-repeat=\'noteHistory in noteHistoryList\'\n                class="note-history-item"\n                ng-click="changeVersion(noteHistory.version)"\n                ng-class="{active: noteHistory.version == activeVersion}"\n                ng-switch="$first">\n                    <img class="note-history-img" src="" ng-src="{{noteHistory.modifier.photo | photo}}" title="{{noteHistory.modifier | alias}}" alt="{{noteHistory.modifier | alias}}"/>\n                    <div class="note-history-info">\n                        <span class="note-history-version" ng-bind="\'第\' + noteHistory.version + \'版\'"></span>\n                        <div>\n                            <span class="note-history-author" ng-bind="noteHistory.modifier | alias"></span>\n                            <span ng-if="!$last" class="operation">修改了笔记</span>\n                            <span ng-if="$last" class="operation">创建了笔记</span>\n                        </div>\n                        <div>\n                            <span class="note-history-date"  ng-bind="noteHistory.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\'"></span>\n                            <span ng-switch-when="true">\n                                <span class="note-history-edit"\n                                      ng-click="editNote()"\n                                      file-permission-check="note.edit"\n                                      file-permission-file="note">编辑</span>\n                            </span>\n                            <span ng-switch-when="false">\n                                <span class="note-history-revert"\n                                      ng-click="revertToVersion(noteHistory.version)"\n                                      file-permission-check="note.revert"\n                                      file-permission-file="note">恢复到此版本</span>\n                            </span>\n                        </div>\n                    </div>\n            </li>\n         </ul>\n    </div>\n    </div>\n    <div class="diff-tip"><span class="green"></span>绿色表示与前一版本比较的新增内容&nbsp;&nbsp;&nbsp;&nbsp;<span class="red"></span>红色表示与前一版本比较的删除内容</div>\n</div>\n'),$templateCache.put("pagelet/note/editor/attachment.html",'<div class="file-upload" ng-controller="noteAttachmentCtrl">\n    <p ng-show="errMsg == undefined">可以添加任意不大于\n        <span ng-if="!vipOrOrg">200M</span>\n        <span ng-if="vipOrOrg">1G</span> 的文件\n    </p>\n    <p class="error" ng-show="errMsg != undefined">{{errMsg}}</p>\n    <button class="btn blue"\n        widget-upload="\'resource\'"\n        upload-select="onFileSelected(tasks)">\n        添加文件\n    </button>\n</div>'),$templateCache.put("pagelet/note/editor/collab/collab.html",'<div class="detail note"\n     ng-class="{nocomment:note==null,max:max}"\n     ng-controller="collabNoteEditorCtrl">\n    <div class="detail-hd">\n        <span class="back" ng-click="quit()" ng-show="!fullScreen">\n            <svg class="icon-back">\n                <use xlink:href="#back"/>\n            </svg>\n            返回\n        </span>\n        <div class="title selectable">\n            <input class="name-input"\n                   type="text"\n                   maxlength="250"\n                   ng-bind="note.name"\n                   ng-model="temp.title"\n                   widget-focus="focusTitle" ng-show="mode === \'edit\'" placeholder="点击此处输入标题"/>\n            <span class="name" ng-bind="note.name" ng-show="mode === \'view\'"></span>\n        </div>\n        <div class="note-saveinfo" ng-if="saveType == \'auto\'">笔记已自动保存</div>\n        <div class="note-saveinfo" ng-if="saveType == \'directly\'">笔记已保存</div>\n        <div class="detail-hd-right">\n          <div file-permission-check="note.edit"\n               file-permission-file="note"\n               ng-if="modifiers.length > 0" class="modifier"\n               ng-class="{\'show\': showMember}" ng-click="showMembers($event)"\n               widget-toggle="attendee">\n              <svg class="icon-modify"><use xlink:href="#note_editing"/></svg>\n              <span class="modify-num" ng-bind="modifiers.length"></span>\n              人正在编辑\n\n              <ul id="attendee-list" widget-toggle-content>\n                  <li id="user-{{user.id}}" class="attendee" ng-repeat="user in modifiers">\n                      <span class="photo">\n                          <i class="portrait" ng-if="user.portrait" style="background-image: url({{user.portrait}})"></i>\n                          <i class="portrait" ng-if="!user.portrait"></i>\n                          <i class="color-bg"></i>\n                          <i class="color" style="background-color: {{user.color}}"></i>\n                      </span>\n                      <span class="nickname" title={{user.name}}>{{user.name}}</span>\n                  </li>\n              </ul>\n          </div>\n          <button class="detail-btn" ng-click="saveAndQuit()" title="发布" ng-show="isNew"\n                ng-disabled="saving">\n            <svg class="btn-icon">\n              <use class="default" xlink:href="#detail_release"/>\n              <use class="hover" xlink:href="#detail_release_hover"/>\n            </svg>\n            <span class="btn-text" ng-if="!saving">发布</span>\n            <span class="btn-text" ng-if="saving">正在发布</span>\n        </button>\n          <div file-detail-tools="note"\n               tools-close="quit()"\n               tools-open-window="!fullScreen"\n               mode="mode"\n               saving="saving"\n               show-info-revision="true"></div>\n        </div>\n    </div>\n    <p file-permission-check="!note.edit"\n          file-permission-file="note"\n          file-permission-need-readonly="true"\n          ng-if="note != null"\n          class="readonly-tip">\n          该文件为只读，仅群管理员以上可修改\n    </p>\n    <div class="detail-bd"\n         ng-class="{meta:meta, search: hasSearch}">\n        <div class="view" ng-show="mode === \'view\'">\n            <div class="search-box" content-search ng-if="hasSearch"></div>\n            <p class="info" ng-show="meta">\n                <span class="meta-item" ng-bind="\'创建时间：\' + (note.createDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-item" ng-bind="\'修改时间：\' + (note.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-path-prefix">所在位置: </span>\n                <span class="meta-path" ng-bind="filePath" title="{{filePath}}" ng-click="onOpenFolder(note.id)"></span>\n            </p>\n            <div class="content">\n                <iframe frameborder="none"\n                        note-content="htmlContent"\n                        search-key="search.key"></iframe>\n                <div ng-if="hasSearch" class="highlight-bars">\n                    <div ng-repeat="bar in searchResult.list" class="highlight-bar" ng-style="{top: bar.highlightPos}"></div>\n                </div>\n            </div>\n        </div>\n        <div class="edit" ng-show="mode === \'edit\'">\n            <p class="info" ng-show="meta">\n                <span class="meta-item" ng-bind="\'创建时间：\' + (note.createDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-item" ng-bind="\'修改时间：\' + (note.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n            </p>\n            <div class="content" collab-editor="temp.content" ng-hide="hideFlag"></div>\n        </div>\n        <div class="loading-style editor-loading" ng-show="loading"></div>\n    </div>\n    <div ng-if="note&&!commentLoading" class="detail-aside">\n        <div>\n            <div class="comment-hd">\n                <span class="comment-title">评论</span>\n                <div class="toggle-comment" title="关闭评论" ng-click="$parent.max = !$parent.max; $event.stopPropagation()">\n                    <svg class="icon-close">\n                        <use xlink:href="#close"/>\n                    </svg>\n                </div>\n            </div>\n            <div comment\n                 type="file"\n                 file="note"\n                 entry-id="{{note.id}}"\n                 comment-id="{{commentId}}"\n                 sum="{{note.comments}}"\n                 get-user="getUser()"\n                 user-id="{{userId}}">\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/note/editor/draft-hint.html",'<p class="dirty-info">当前群有未发布的笔记\n    <span class="edit" ng-click="edit()">进入编辑</span>\n    <span class="clear" ng-click="clear()">舍弃</span>\n</p>'),$templateCache.put("pagelet/note/editor/editor.html",'<div class="detail note"\n     ng-class="{nocomment:note==null,max:max}"\n     ng-controller="noteEditorCtrl">\n    <div class="detail-hd">\n        <span class="back" ng-click="quit()" ng-show="!fullScreen">\n            <svg class="icon-back">\n                <use xlink:href="#back"/>\n            </svg>\n            返回\n        </span>\n        <div class="title selectable">\n            <input class="name-input"\n                   type="text"\n                   maxlength="240"\n                   ng-bind="note.name"\n                   ng-model="temp.title"\n                   widget-focus="focusTitle" ng-show="mode === \'edit\'" placeholder="点击此处输入标题"/>\n            <span class="name" ng-bind="note.name" ng-show="mode === \'view\'"></span>\n        </div>\n        <div class="note-saveinfo" ng-if="saveType == \'auto\'">笔记已自动保存</div>\n        <div class="note-saveinfo" ng-if="saveType == \'directly\'">笔记已保存</div>\n        <div class="detail-hd-right">\n        <div file-permission-check="note.edit"\n            file-permission-file="note" \n            ng-if="modifiers.length > 0" \n            class="modifier"\n            widget-toggle="attendee">\n            <svg class="icon-modify"><use xlink:href="#note_editing"/></svg>\n            <span class="modify-num" ng-bind="modifiers.length"></span>\n            人正在编辑\n            <ul id="attendee-list" widget-toggle-content>\n                <li id="user-{{user.userId}}" class="attendee" ng-repeat="user in modifiers">\n                    <span class="photo">\n                        <i class="portrait" ng-if="user.photo" style="background-image: url({{user.photo}})"></i>\n                        <i class="portrait" ng-if="!user.photo"></i>\n                    </span>\n                    <span class="nickname" title={{user.name}}>{{user.name}}</span>\n                </li>\n            </ul>\n        </div>\n        <button class="detail-btn" ng-click="saveAndQuit()" title="发布" ng-show="mode == \'edit\'"\n                ng-disabled="saving">\n            <svg class="btn-icon">\n                <use class="default" xlink:href="#detail_release"/>\n                <use class="hover" xlink:href="#detail_release_hover"/>\n            </svg>\n            <span class="btn-text" ng-if="!saving">发布</span>\n            <span class="btn-text" ng-if="saving">正在发布</span>\n        </button>\n        <button class="detail-btn"\n                ng-click="edit()"\n                title="编辑"\n                ng-show="mode == \'view\'"\n                file-permission-check="note.edit"\n                file-permission-file="note">\n                <svg class="btn-icon">\n                  <use class="default" xlink:href="#detail_edit"/>\n                  <use class="hover" xlink:href="#detail_edit_hover"/>\n                </svg>\n                <span class="btn-text">编辑</span>\n        </button>\n        <div file-detail-tools="note"\n             tools-close="quit()"\n             tools-open-window="!fullScreen"\n             mode="mode"\n             saving="saving"\n             show-info-revision="true"></div>\n        </div>\n    </div>\n    <p file-permission-check="!note.edit"\n          file-permission-file="note"\n          file-permission-need-readonly="true"\n          ng-if="note != null"\n          class="readonly-tip">\n          该文件为只读，仅群管理员以上可修改\n    </p>\n    <p class="dirty-info" ng-if="hasLocalModification() && mode === \'view\'">该笔记存在未发布的修改\n        <span class="edit" ng-click="edit()">进入编辑</span>\n        <span class="clear" ng-click="clearLocal()">舍弃</span>\n    </p>\n    <div class="detail-bd"\n         ng-class="{meta:meta, dirty:hasLocalModification() && mode === \'view\', search: hasSearch}">\n        <div class="view" ng-show="mode === \'view\'">\n            <div class="search-box" content-search ng-if="hasSearch"></div>\n            <p class="info" ng-show="meta">\n                <span class="meta-item" ng-bind="\'创建时间：\' + (note.createDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-item" ng-bind="\'修改时间：\' + (note.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-path-prefix">所在位置: </span>\n                <span class="meta-path" ng-bind="filePath" title="{{filePath}}" ng-click="onOpenFolder(note.id)"></span>\n            </p>\n            <div class="content">\n                <iframe frameborder="none"\n                    note-content="htmlContent"\n                    search-key="search.key"></iframe>\n                <div ng-if="hasSearch" class="highlight-bars">\n                    <div ng-repeat="bar in searchResult.list" class="highlight-bar" ng-style="{top: bar.highlightPos}"></div>\n                </div>\n            </div>\n        </div>\n        <div class="edit" ng-show="mode === \'edit\'">\n            <p class="info" ng-show="meta">\n                <span class="meta-item" ng-bind="\'创建时间：\' + (note.createDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-item" ng-bind="\'修改时间：\' + (note.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n            </p>\n            <div class="content" note-editor="temp.content"></div>\n        </div>\n    </div>\n    <div ng-if="note&&!commentLoading" class="detail-aside">\n        <div>\n            <div class="comment-hd">\n                <span class="comment-title">评论</span>\n                <div class="toggle-comment" title="关闭评论" ng-click="$parent.max = !$parent.max; $event.stopPropagation()">\n                    <svg class="icon-close">\n                        <use xlink:href="#close"/>\n                    </svg>\n                </div>\n            </div>\n            <div comment\n                 type="file"\n                 file="note"\n                 entry-id="{{note.id}}"\n                 comment-id="{{commentId}}"\n                 sum="{{note.comments}}"\n                 get-user="getUser()"\n                 user-id="{{userId}}">\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/note/editor/local-conflict.html",'<div class="note-save-dialog">\n    <p class="main-text">“{{modifier | alias}}”已经更新了笔记，是否舍弃未发布的修改，直接打开新版本？</p>\n    <p class="hint">注：您可以点击“历史版本”查看所有修改记录</p>\n</div>'),$templateCache.put("pagelet/note/editor/quit.html",'<p class="confirm">您的笔记尚未保存，是否保存？</p>'),$templateCache.put("pagelet/note/editor/save-local-copy.html",'<div class="note-save-dialog">\n    <p class="main-text">该篇笔记存在本地修改，是否将其提交?</p>\n    <p class="hint">注：取消提交将删除草稿并载入线上内容,提交后您可以点击“历史版本”查看所有修改记录。</p>\n</div>'),$templateCache.put("pagelet/note/editor/save.html",'<div class="note-save-dialog">\n    <p class="main-text">检测到“{{modifier | alias}}”已经更新了该笔记，是否仍将您的修改覆盖为最新版本？</p>\n    <p class="hint">注：您可以点击“历史版本”查看所有修改记录</p>\n</div>'),$templateCache.put("pagelet/note/import/importer.html",'<div class="import-progress" ng-controller="noteImportCtrl">\n    <p>笔记导入中...</p>\n    <div widget-progress\n         value="status.num * status.countprogress"\n         max="status.num"\n         class="bar"></div>\n    <span class="import-progress-size"\n          ng-bind="status.percent + \'%\'"></span>\n</div>'),$templateCache.put("pagelet/note/import/ydocSelector/file-tree.html",'<div class="file-selector-file"\n     ng-controller="importFileTreeSelectNodeCtrl"\n     ng-show="treeFile!=undefined">\n    <div class="file-selector-title"\n         ng-class="{selected : selected, expanded : expanded, expandable : expandable}">\n        <div class = "toggle"  ng-click="toggle()">\n            <svg class="arrow">\n                <use ng-if="!expanded" xlink:href="#arrow_right"/>\n                <use ng-if="expanded" xlink:href="#arrow_down"/>\n            </svg>\n        </div>\n        <div class="name" ng-click="select(treeFile)">\n            <svg class="folder">\n                <use ng-if="!treeFile.parentId" class="default" xlink:href="#root"/>\n                <use ng-if="!treeFile.parentId" class="hover" xlink:href="#root_hover"/>\n                <use ng-if="treeFile.parentId&&!expanded" class="default" xlink:href="#folder"/>\n                <use ng-if="treeFile.parentId&&!expanded" class="hover" xlink:href="#folder_hover"/>\n                <use ng-if="treeFile.parentId&&expanded" class="default" xlink:href="#folder_expand"/>\n                <use ng-if="treeFile.parentId&&expanded" class="hover" xlink:href="#folder_expand_hover"/>\n            </svg>\n            <span class="file-name" title="{{treeFile.name}}" ng-bind="treeFile.name"></span>\n        </div>\n    </div>\n    <ul class="file-selector-files" ng-if="expanded">\n        <li ng-repeat="treeFile in treeFiles" class="filetree-item" ng-include="\'pagelet/note/import/ydocSelector/file-tree.html\'" />\n    </ul>\n</div>\n'),$templateCache.put("pagelet/note/import/ydocSelector/importNote.html",'<div class="note-import" ng-controller="importNoteCtrl">\n    <div class="ydoc-import-list">\n        <div class="file-tree" widget-scroller>\n            <div class="file-selector-title"\n                 ng-class="{selected : selected, expanded : expanded, expandable : expandable}">\n                <div class = "toggle"  ng-click="toggleRoot()">\n                    <svg class="arrow"id ="root-arrow">\n                        <use ng-if="!expanded" xlink:href="#arrow_right"/>\n                        <use ng-if="expanded" xlink:href="#arrow_down"/>\n                    </svg>\n                </div>\n                <div class="name" ng-click="selectRoot()">\n                    <svg class="folder">\n                        <use class="default" xlink:href="#root"/>\n                        <use class="hover" xlink:href="#root_hover"/>\n                    </svg>\n                    <span class="file-name" title="全部文件">全部文件</span>\n                </div>\n            </div>\n            <ul class="file-selector-files" ng-if="expanded">\n                <li ng-repeat="treeFile in treeFiles" class="filetree-item" ng-include="\'pagelet/note/import/ydocSelector/file-tree.html\'" />\n            </ul>\n        </div>\n        <div class="file-detail-container" widget-scroller>\n            <div class="stack-container">\n                <span class="stack-root" title="全部文件">全部文件</span>\n                <span class="stack-detail" ng-repeat="path in pathList">\n                    <span class="slash">/</span>\n                    <span class="path-name" ng-class="{isLast: path.isLast}">{{path.name}}</span>\n                </span>\n                <div class="stack" title="{{path}}">{{path}}</div>\n            </div>\n            <div class="detail-container">\n                <div class="detail-header">\n                    <div class="file-name">文件名</div>\n                    <div class="file-size">大小</div>\n                </div>\n                <div class="file-detail">\n                    <ul>\n                        <li ng-repeat="file in visibleFiles" class="detail-node"\n                            ng-class="{selected:isSelected(file)}"\n                            ng-click="toggleFile($event, file)">\n                            <i file-icon="file" class="file-icon"></i>\n                            <span class="file-name" ng-class="{isFolder: file.isFolder}" ng-click="open(file);">{{file.name}}</span>\n                            <span class="file-size" ng-if="!file.isFolder">{{file.size | fileSize}}</span>\n                        </li>\n                        <div class="nofile" ng-show="visibleFiles.length === 0">\n                            <svg class="icon-nofile">\n                                <use xlink:href="#blank_content"/>\n                            </svg>\n                            <div class="info">这里没有内容</div>\n                        </div>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n    <p class="import-remind">*当前列表不包含加密笔记及笔记本</p>\n    <div class="import-ft">\n        <button ng-if="multiple"\n                ng-click="finish()"\n                ng-disabled="selection.length == 0"\n                ng-bind="\'确定 ( \' + selection.length + \' )\'"\n                class="btn"/>\n        <button ng-if="!multiple"\n                ng-click="finish()"\n                ng-disabled="selection.length == 0"\n                class="btn">确定</button>\n    </div>\n</div>'),$templateCache.put("pagelet/note/import/ynoteSelector/dialog.html",'<div class="note-import" ng-controller="noteSelectorCtrl">\n    <ul class="import-list">\n        <li ng-repeat="notebook in roots">\n            <div ng-if="notebook.path === undefined"\n                 class="import-notebook">\n                <span ng-class="{ expended : notebook.expended}"\n                      class="import-notebook-title"\n                      ng-click="notebook.expended = !notebook.expended">\n                    <svg class="arrow">\n                        <use ng-if="!notebook.expended" xlink:href="#arrow_right"/>\n                        <use ng-if="notebook.expended" xlink:href="#arrow_down"/>\n                    </svg>\n                    <span ng-bind="notebook.title"></span>\n                </span>\n                <div class="import-notebook" ng-show="notebook.expended">\n                    <ul class="import-notebooks">\n                        <li ng-repeat="notebook in getNotebook(notebook)">\n                            <div ng-include="\'pagelet/note/import/ynoteSelector/notebook.html\'"></div>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n            <div ng-if="notebook.path !== undefined"\n                 ng-include="\'pagelet/note/import/ynoteSelector/notebook.html\'"\n                 class="import-notebook">\n            </div>\n        </li>\n    </ul>\n    <p class="import-remind">* 当前列表不包含加密笔记及笔记本</p>\n    <div class="import-ft">\n        <button ng-if="multiple"\n                ng-click="finish()"\n                ng-disabled="selection.length == 0"\n                ng-bind="\'确定 ( \' + selection.length + \' )\'"\n                class="btn"/>\n        <button ng-if="!multiple"\n                ng-click="finish()"\n                ng-disabled="selection.length == 0"\n                class="btn">确定</button>\n    </div>\n</div>'),$templateCache.put("pagelet/note/import/ynoteSelector/notebook.html",'<span ng-class="{ expended : notebook.expended}"\n      class="import-notebook-title"\n      ng-click="notebook.expended = !notebook.expended;fetch(notebook);">\n    <svg class="arrow">\n        <use ng-if="!notebook.expended" xlink:href="#arrow_right"/>\n        <use ng-if="notebook.expended" xlink:href="#arrow_down"/>\n    </svg>\n    <span ng-bind="notebook.title"></span>\n</span>\n<div class="import-notebook" ng-show="notebook.expended">\n    <ul class="import-notes">\n        <li ng-repeat="ynote in notebook.ynotes"\n            ng-click="toggleSelect(ynote)"\n            ng-class="{selected:selection.indexOf(ynote) >= 0}">\n            <h3 ng-bind="ynote.title || \'无标题笔记\'"></h3>\n            <p ng-bind="ynote.digest"></p>\n        </li>\n    </ul>\n</div>'),$templateCache.put("pagelet/note/msg/message-tip.html","<span ng-if='tip.operation == 0' ng-bind=\"tip.user.name + '：发送了笔记' \"></span>\n<span ng-if='tip.operation == 1' ng-bind=\"tip.user.name + '：新建了笔记' \"></span>\n<span ng-if='tip.operation == 2' ng-bind=\"tip.user.name + '：修改了笔记' \"></span>\n<span ng-if='tip.operation == 3' ng-bind=\"tip.user.name + '：删除了笔记' \"></span>\n<span ng-if='tip.operation == 5' ng-bind=\"tip.user.name + '：新建了笔记' \"></span>\n"),$templateCache.put("pagelet/note/msg/message.html",'<div ng-controller="noteMessageCtrl">\n    <div class="msg-photo">\n        <img ng-src="{{::(noteMsg.user.photo | photo)}}" class="bubble-user" user-info data-user-id="{{noteMsg.user.userId}}" />\n        <i class="operation-icon" ng-class="::{\'operation-create-icon\' : noteMsg.operation == 1, \'operation-edit-icon\': noteMsg.operation == 2, \'operation-delete-icon\': noteMsg.operation == 3,\n        \'operation-import-icon\': noteMsg.operation == 5, \'operation-rename-icon\': noteMsg.operation == 7, \'operation-recover-icon\': noteMsg.operation == 8 }"></i>\n    </div>\n    <div class="content-node group-note-node">\n        <div class="content-head ellipsis selectable">\n            <div class="username" user-info data-user-id="{{message.data.user.userId}}" ng-bind="::(noteMsg.user | alias)"></div>\n            <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{message.data.user.userId}}\']}"></i></a>\n            <div class="operation">\n                <span ng-if=\'::(noteMsg.operation == 0)\'>发送了笔记</span>\n                <span ng-if=\'::(noteMsg.operation == 1)\'>新建了笔记</span>\n                <span ng-if=\'::(noteMsg.operation == 2)\'>修改了笔记</span>\n                <span ng-if=\'::(noteMsg.operation == 3)\' class="delete">删除了笔记</span>\n                <span ng-if=\'::(noteMsg.operation == 5)\'>导入了笔记</span>\n                <span ng-if=\'::(noteMsg.operation == 7)\'>重命名了笔记</span>\n                <span ng-if=\'::(noteMsg.operation == 8)\'>还原了笔记</span>\n            </div>\n            <div class="time" ng-bind="::(noteMsg.time | date:\'HH:mm\')"></div>\n        </div>\n        <div class="bubble">\n            <div class="bubble-node bubble-file-node" ng-class="::{\'bubble-delete-node\': noteMsg.operation == 3}">\n                <div class="fileinfo" ng-if="::(noteMsg.operation != 3)">\n                    <i class="fileicon active" file-icon="file" file-size="large"\n                            file-open\n                            file-id="noteMsg.noteId"\n                            file-name="noteMsg.title + \'.note\'"\n                            group-id="gid()"\n                        ></i>\n                    <div class="filemeta">\n                        <span class="name active selectable" ng-bind="::((noteMsg.title + \'.note\') | fileName)"\n                            file-open\n                            file-id="noteMsg.noteId"\n                            file-name="(noteMsg.title + \'.note\') | fileName"\n                            group-id="gid()"\n                            ></span>\n                        <span class="revision active" ng-bind="::(\'第 \' + noteMsg.version + \' 版\')"\n                            file-open-revision\n                            file-id="noteMsg.noteId"\n                            file-version="noteMsg.version"\n                            group-id="gid()"></span>\n                    </div>\n                </div>\n                <div class="fileinfo" ng-if="::(noteMsg.operation == 3)">\n                    <i class="fileicon" file-icon="file" file-size="large" file-grey="true"\n                        ></i>\n                    <div class="filemeta">\n                        <span class="name selectable delete" ng-bind="::((noteMsg.title + \'.note\') | fileName)"\n                            ></span>\n                        <span class="revision" ng-bind="::(\'第 \' + noteMsg.version + \' 版\')"\n                            ></span>\n                    </div>\n                </div>\n                <div ng-if="::(noteMsg.operation != 3)">\n                    <div class="bubble-split">\n                    </div>\n                    <div class="fileaction"\n                         file-open-exist-dir\n                         file-id="noteMsg.noteId"\n                         file-name="noteMsg.title + \'.note\'"\n                         group-id="gid()">\n                        <svg class="folder-opener">\n                            <use class="default" xlink:href="#folder_opener"/>\n                            <use class="hover" xlink:href="#folder_opener_hover"/>\n                        </svg>\n                        <span class="fileaction-item">打开文件夹</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/note/plugin/note-item.html",'<div>\n    <span class="icon" file-icon="file"></span>\n    <span class="name">\n        <span ng-if="file.data.draft" class="draft">[草稿]</span>\n        <i href="javascript:;"\n           file-open="file"\n           group-id="gid()"\n           ng-if="file.data.draft"\n           ng-bind-html="(file.data.title ||  \'无标题笔记\') + \'.note\'">\n        </i>\n        <i href="javascript:;"\n           file-open="file"\n           group-id="gid()"\n           ng-if="!file.data.draft"\n           ng-bind-html="file.name === \'.note\' ? \'无标题笔记.note\' : file.name ">\n        </i>\n    </span>\n    <span ng-if="file.id >= 0" class="revision" ng-click="openRevision(file)">第&nbsp;{{file.version}}&nbsp;版</span>\n    <span ng-if="file.id < 0" class="revision">未发布</span>\n    <span class="comments" ng-click="toggleComment(file)" ng-if="!file.data.draft">\n        <span ng-if="file.comments > 0">{{file.comments}}</span> 评论\n    </span>\n    <span class="size">{{file.size | fileSize}}</span>\n    <p class="info">\n        {{file | fileModifier | alias}}\n        {{file.lastModifiedDate | dateFormat:\'yyyy-MM-dd HH:mm\'}}\n        {{file | fileAction}}\n    </p>\n</div>\n'),$templateCache.put("pagelet/note/plugin/tool-create.html",'<svg class="import-note">\n	<use ng-if="enableTools" class="default" xlink:href="#import"/>\n	<use ng-if="enableTools" class="hover" xlink:href="#import_hover"/>\n	<use ng-if="!enableTools" xlink:href="#import_disable"/>\n</svg>\n<span class="tools-text">导入笔记</span>'),$templateCache.put("pagelet/note/search/search-panel.html",'<span class="search-container" ng-class="{hit: hitList.length > 0}">\n    <input id="search-key" type="text" ng-model="search.key" placeholder="查找内容"/>\n    <span class="hit-list">\n        <span>第{{currentHit+1}}条，</span>\n        <span>共{{hitList.length}}条</span>\n    </span>\n    <span class="no-hit-list" ng-show="hitList.length === 0 && search.key">\n        共0条\n    </span>\n</span>\n<i class="close" ng-click="cancel()" title="关闭"></i>\n<i class="next" ng-click="gotoNext()" ng-class="{\'disable\': !hitList.length}" title="查找下一个">\n	<svg>\n	<use ng-if="!hitList.length" xlink:href="#page_next"/>\n	<use ng-if="hitList.length" xlink:href="#page_next_active"/>\n	</svg>\n</i>\n<i class="pre" ng-click="gotoPre()" ng-class="{\'disable\': !hitList.length}" title="查找上一个">\n	<svg>\n	<use ng-if="!hitList.length" xlink:href="#page_pre"/>\n	<use ng-if="hitList.length" xlink:href="#page_pre_active"/>\n	</svg>\n</i>'),$templateCache.put("pagelet/office/preview.html",'<div detail-comment>\n    <div ng-controller="officePreviewCtrl" class="office-preview" ng-class="{meta:meta}">\n        <p class="info" ng-show="meta">\n            <span class="meta-item" ng-bind="\'创建时间：\' + (file.createDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n            <span class="meta-item" ng-bind="\'修改时间：\' + (file.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n            <span class="meta-item" ng-bind="\'文件大小：\' + (file.size | fileSize)"></span>\n            <span class="meta-path-prefix">所在位置： </span>\n            <span class="meta-path" ng-bind="filePath" title="{{filePath}}" ng-click="onOpenFolder(file.id)"></span>\n        </p>\n        <div class="office-preview-ct">\n            <iframe class="office-preview-iframe"\n                src="{{previewSrc}}"></iframe>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/orgSetting/groups/groups.html",'<div class="org-groups-main" ng-controller="orgGroupsController">\n    <div class="org-groups-hd">\n        <div class="org-group-hd-main">\n            <div class="org-groups-title">\n                <svg class="my-org-group-icon">\n                    <use xlink:href="#my_org_group"/>\n                </svg>\n                组织下全部群 ({{allGroups.length}})\n            </div>\n            <div class="org-groups-search">\n                <div class="input-search">\n                    <svg class="search-icon">\n                        <use xlink:href="#search"/>\n                    </svg>\n                    <input class="search-text" placeholder="搜索组织协作群" ng-model="keyword" max-input-length="1000">\n                </div>\n            </div>\n        </div>\n    </div>\n    <ul class="orggroups">\n        <li ng-repeat="group in groups track by $index " class="group">\n            <div ng-controller="groupController" ng-click="forwardToGroup(group.id)" class="orggroup">\n                <i class="groupicon"></i>\n                <div class="groupname">{{group.name}}</div>\n                <div class="groupvol">({{group.size}}人)</div>\n            </div>\n        <!--<li class="expandAll" ng-if="filtered.length > 12 && !toShowAll">\n            <div class="title" ng-click="toggle()">\n                查看全部\n            </div>\n        </li>\n        <li class="collapse" ng-if="filtered.length > 12 && toShowAll">\n            <div class="title" ng-click="toggle()">\n                收起\n            </div>\n        </li>-->\n        </li>\n        <li class="quick-add" ng-click="createGroup()" permission-check="orgSetting.createGroup">\n            <svg class="org-new-group-icon">\n                <use xlink:href="#org_new_group"/>\n            </svg>\n            新建\n        </li>\n    </ul>\n    <div class="deleted-groups-hd">\n        <div class="deleted-groups-title">\n            <svg class="deleted-org-group-icon">\n                <use xlink:href="#org_group_deleted"/>\n            </svg>\n            已被删除的群 ({{deletedgroups.length}})\n        </div>\n        <div class="clear-deleted-group" ng-click="clear()">\n            <svg class="clear-icon">\n                <use class="default" xlink:href="#delete_group"/>\n                <use class="hover" xlink:href="#delete_group_hover"/>\n            </svg>\n            <div class="clear-text">全部清空</div>\n        </div>\n    </div>\n    <ul class="deletedgroups">\n        <li ng-repeat="deletedgroup in deletedgroups track by $index" class="group">\n            <div ng-controller="groupController" ng-click="forwardToGroup(deletedgroup.id)"\n                 class="deletedgroup">\n                <i class="groupicon"></i>\n                <div class="groupname">{{deletedgroup.name}}</div>\n                <div class="groupvol">({{deletedgroup.size}}人)</div>\n            </div>\n        <!--<li class="expandAll" ng-if="deletedgroups.length>12&&!toShowAllDeleted">\n            <div class="title" ng-click="toggleDelete()">\n                查看全部\n            </div>\n        </li>\n        <li class="collapse" ng-if="toShowAllDeleted">\n            <div class="title" ng-click="toggleDelete()">\n                收起\n            </div>\n        </li>-->\n        </li>\n    </ul>\n</div>'),$templateCache.put("pagelet/orgSetting/members/members.html",'<div class="members-main" ng-controller="orgMembersCtrl">\n    <span class="members-title"\n        permission-check="orgSetting.invite">\n        <svg class="members-invite">\n            <use xlink:href="#members_invite"/>\n        </svg>\n        邀请加入\n    </span>\n    <div class="invitation"\n         permission-check="orgSetting.invite"\n         ng-controller="orgInvitationCtrl">\n        <div class="invitation-bd">\n            <div class="invitation-from-userid" select-user>\n                <p class="invitation-title-hint">请输入有道云笔记登录邮箱或者昵称进行搜索</p>\n                <form ng-submit="searchPrefix(prefixName)">\n                    <div class="invitation-input">\n                        <input class="input-name" type="text" ng-model="prefixName" placeholder="目前仅支持搜索有道云笔记用户"/>\n                        <svg class="cancel" ng-click="prefixName = \'\'" ng-show="searchCompleted && prefixName">\n                            <use class="default" xlink:href="#file_upload_cancel"/>\n                            <use class="hover" xlink:href="#file_upload_cancel_hover"/>\n                        </svg>\n                        <svg class="load-data" ng-show="!searchCompleted && prefixName">\n                            <use xlink:href="#loading"/>\n                        </svg>\n                    </div>\n                    <span class="invitation-error-hint error" ng-show="noFound">未找到该用户，请检查填写帐号是否正确</span>\n                </form>\n                <div class="invitation-search-list" ng-show="users.length > 0">\n                    <ul class="invitation-ul">\n                        <li class="invitation-li invitation-item"\n                            ng-class="{select:mouseEnter, added:user.added}"\n                            ng-mouseenter="mouseEnter = true"\n                            ng-mouseleave="mouseEnter = false"\n                            ng-repeat="user in users"\n                            data-user-id="{{user.userId}}"\n                            data-added="{{user.added}}"\n                            data-is-visit="true"\n                            data-orgId="{{orgId}}"\n                            ng-click="inviteForUserId(user.userId, user.added)">\n                            <div class="invitation-item-left">\n                                <img class="invitation-photo" ng-src="{{user.photo | photo}}" alt="" />\n                            </div>\n                            <p class="invitation-item-right">\n                                <span class="user-name" ng-bind-html="user.name | highlight:prefixName"></span>(\n                                <span class="user-userId" ng-bind-html="user.userId | highlight:prefixName"></span>)\n                                <span class="user-added" ng-show="user.added">已添加</span>\n                            </p>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n    <span class="members-title">\n        <svg class="members-list">\n            <use xlink:href="#members_list"/>\n        </svg>\n        成员列表 ({{pageState.total}}人)\n    </span>\n    <ul class="members">\n        <li class="member" ng-repeat="member in members" ng-mouseover="showOperation = true" ng-mouseleave="(showOperation = false)">\n            <img class="photo" ng-src="{{ member.photo | photo }}" user-info data-user-id="{{member.userId}}" data-invitee="{{member.joinTime == 0}}">\n            <div class="info">\n                <div class="username" user-info data-user-id="{{member.userId}}" data-invitee="{{member.joinTime == 0}}" ng-bind="member | alias" title="{{member | alias}}"></div>\n                <div class="role" ng-switch="member.role">\n                    <span class="role-red" ng-switch-when="ROLE_ORG_OWNER">（创建者）</span>\n                    <span class="role-green" ng-switch-when="ROLE_ORG_MANAGER">（管理员）</span>\n                    <span ng-switch-when="ROLE_ORG_USER">（普通用户）</span>\n                </div>\n            </div>\n            <div class="operation" ng-show="showOperation" >\n                <a class="privateChat" ng-if="ownerId != member.userId" ng-click="newP2PDialog(member)" >\n                    私聊\n                </a>\n                <div widget-toggle="showFlag" ng-if="::(myRole == ROLES[\'ORG_OWNER\'] || myRole == ROLES[\'ORG_MANAGER\'])"  class="show-groups">\n                    <a ng-click="showGroups(member.userId)">\n                        加入的群\n                    </a>\n                    <div class="member-group-list widget-menu" widget-toggle-content>\n                        <div class="loading-style" ng-show="!groupListReady[member.userId]">\n                        </div>\n                        <div ng-show="groupListReady[member.userId]">\n                            <div ng-class="{\'member-group-num\' : memberGroup[member.userId].length > 0}">\n                                {{memberGroupNum[member.userId]}}个\n                            </div>\n                            <ul class="member-groups" ng-if="memberGroup[member.userId] && memberGroup[member.userId].length > 0">\n                                <li class="member-group" ng-repeat="group in memberGroup[member.userId]" ng-bind="::(getGroupName(group) +  \'(\' + getGroupRole(group) + \')\')">\n                                    <a ng-click="forwardGroup(group)">\n                                        <span class="member-group-name" ng-bind="::(getGroupName(group))"></span>\n                                        <span class="member-group-role" ng-bind="::(\'(\'+getGroupRole(group)+\')\')"></span>\n                                    </a>\n                                </li>\n                            </ul>\n                            <div class="member-group-list-expand" ng-if="haveRemainingGroups(member.userId)">\n                                <button class="btn"  ng-click="showRemainingGroups(member.userId, $event)">展开全部</button>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n\n                <div class="more-operation" widget-toggle="memberMoreVisible">\n                    <a class="more" ng-if="ownerId != member.userId && member.role !== ROLES[\'ORG_OWNER\'] && (myRole == ROLES[\'ORG_OWNER\'] || (myRole == ROLES[\'ORG_MANAGER\'] && member.role !== ROLES[\'ORG_MANAGER\']))">\n                        更多                 \n                        <svg class="icon-menu-down">\n                            <use xlink:href="#menu_down"/>\n                        </svg>\n                        <ul class="menu widget-menu" ng-class="{owner: myRole == ROLES[\'ORG_OWNER\']}" widget-toggle-content>\n                            <!--<li class="menu-option widget-menu-item" ng-if="member.role != ROLES[\'ORG_OWNER\']" ng-click="changeOwner(member)">-->\n                                <!--转让该组织-->\n                            <!--</li>-->\n                            <li class="menu-option widget-menu-item" ng-if="myRole == ROLES[\'ORG_OWNER\'] && member.role == ROLES[\'ORG_USER\']" ng-click="changeRole(launcher.orgId(), member, ROLES[\'ORG_MANAGER\'])">\n                                设为组织管理员\n                            </li>\n                            <li class="menu-option widget-menu-item" ng-if="myRole == ROLES[\'ORG_OWNER\'] && member.role == ROLES[\'ORG_MANAGER\']" ng-click="changeRole(launcher.orgId(), member, ROLES[\'ORG_USER\'])">\n                                设为普通成员\n                            </li>\n                            <li class="menu-option widget-menu-item" ng-if="(myRole == ROLES[\'ORG_OWNER\'] || (myRole == ROLES[\'ORG_MANAGER\'] && member.role == ROLES[\'ORG_USER\']))"\n                                ng-click="removeMember(member)">\n                                移除\n                            </li>\n                        </ul>\n                    </a>\n                </div>\n            </div>\n        </li>\n        <!--<div class="line"></div>-->\n    </ul>\n    <div class="page-num" ng-if="pageState.pageTotal > 1">\n        当前页&nbsp;{{pageState.pageNum}}/{{pageState.pageTotal}}\n    </div>\n    <div class="page-locate" ng-if="pageState.pageTotal > 1">\n        <svg class="page-locate-btn first"\n             ng-class="{active: pageState.pageNum > 1}"\n             ng-click="gotoFirstPage()">\n            <use ng-if="pageState.pageNum <= 1" xlink:href="#page_first"/>\n            <use ng-if="pageState.pageNum > 1" xlink:href="#page_first_active"/>\n        </svg>\n        <svg class="page-locate-btn pre"\n             ng-class="{active: pageState.pageNum > 1}"\n             ng-click="gotoPrePage()">\n            <use ng-if="pageState.pageNum <= 1" xlink:href="#page_pre"/>\n            <use ng-if="pageState.pageNum > 1" xlink:href="#page_pre_active"/>\n        </svg>\n        <svg class="page-locate-btn next"\n             ng-class="{active: pageState.pageNum < pageState.pageTotal}"\n             ng-click="gotoNextPage()">\n            <use ng-if="pageState.pageNum >= pageState.pageTotal" xlink:href="#page_next"/>\n            <use ng-if="pageState.pageNum < pageState.pageTotal" xlink:href="#page_next_active"/>\n        </svg>\n        <svg class="page-locate-btn last"\n             ng-class="{active: pageState.pageNum < pageState.pageTotal}"\n             ng-click="gotoLastPage()">\n            <use ng-if="pageState.pageNum >= pageState.pageTotal" xlink:href="#page_last"/>\n            <use ng-if="pageState.pageNum < pageState.pageTotal" xlink:href="#page_last_active"/>\n        </svg>\n    </div>\n</div>\n'),$templateCache.put("pagelet/orgSetting/myGroups/myGroups.html",'<div class="org-groups-main" ng-controller="myGroupsController">\n    <div class="org-groups-hd">\n        <div class="org-group-hd-main">\n            <div class="org-groups-title">\n                <svg class="my-org-group-icon">\n                    <use xlink:href="#my_org_group"/>\n                </svg>\n                我的组织协作群 ({{groupNum}})\n            </div>\n            <div class="org-groups-search">\n                <div class="input-search">\n                    <svg class="search-icon">\n                        <use xlink:href="#search"/>\n                    </svg>\n                    <input class="search-text" placeholder="搜索组织协作群" ng-model="keyword" max-input-length="1000">\n                </div>\n            </div>\n        </div>\n    </div>\n    <ul class="orggroups">\n        <li ng-repeat="mg in myGroup" class="group">\n            <div ng-controller="groupController" ng-click="forwardToGroup(mg.id)" class="orggroup">\n                <i class="groupicon"></i>\n                <div class="groupname">{{mg.name}}</div>\n                <div class="groupvol">({{mg.size}}人)</div>\n            </div>\n        <li class="quick-add" ng-click="createGroup()" permission-check="orgSetting.createGroup">\n            <svg class="org-new-group-icon">\n                <use xlink:href="#org_new_group"/>\n            </svg>\n            新建\n        </li>\n        </li>\n    </ul>\n</div>'),$templateCache.put("pagelet/orgSetting/orgSetting.html",'<div class="org-setting">\n    <div ng-controller="orgSettingCtrl">\n        <div ng-show="ready">\n            <div class="expired-hint" ng-if="showExpiredHint">\n                企业版已到期，续费请联系<a href="mailto:youdaogroup@service.netease.com"> youdaogroup@service.netease.com</a>\n            </div>\n            <div class="org-setting-head">\n                <img class="org-img" src="{{getGroupPhoto()}}" />\n                <span class="org-name">{{getGroupName()}}</span>\n                <ul class="org-setting-tabs">\n                    <li permission-check="orgSetting.viewOrgGroups" class="org-setting-tab" ng-click="tabJumpFactory(\'groups\')()" ng-class="{\'active\' : segment == \'groups\' }">组织协作群</li>\n                    <li permission-check="!orgSetting.viewOrgGroups" class="org-setting-tab" ng-click="tabJumpFactory(\'myGroups\')()" ng-class="{\'active\' : segment == \'myGroups\' }">组织协作群</li>\n                    <li class="org-setting-tab" ng-click="tabJumpFactory(\'members\')()" ng-class="{\'active\' : segment == \'members\' }">组织成员</li>\n                    <li class="org-setting-tab" ng-click="tabJumpFactory(\'setting\')()" ng-class="{\'active\' : segment == \'setting\' }">设置</li>\n                </ul>\n            </div>\n            <div class="org-setting-bd" ng-class="{\'hasExpiredHint\': showExpiredHint}" widget-scroller>\n                <div ng-if="segment != null" ng-include="\'pagelet/orgSetting/\' + segment + \'/\' + segment + \'.html\'"></div>\n            </div>\n        </div>\n        <div class="loading-style" ng-show="!ready"></div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/orgSetting/plugin/operateGroup.html",'<div class="operate-group" ng-controller="operateGroupCtrl">\n    <div class="recover-group"\n         ng-click="recoverGroup()"\n         permission-check="group.recover">\n         <svg class="icon-operate">\n            <use class="default" xlink:href="#recover_group"/>\n            <use class="hover" xlink:href="#recover_group_hover"/>\n         </svg>\n         <span class="operate-text">还原群</span>\n    </div>\n    <div class="erase-group"\n          ng-click="eraseGroup()"\n          permission-check="group.erase">\n         <svg class="icon-operate">\n            <use class="default" xlink:href="#erase_group"/>\n            <use class="hover" xlink:href="#erase_group_hover"/>\n         </svg>\n         <span class="operate-text">彻底删除群</span>\n    </div>\n    <div class="join-group"\n         ng-click="joinGroup()"\n         permission-check="group.join">\n         <svg class="icon-operate">\n            <use class="default" xlink:href="#join_group"/>\n            <use class="hover" xlink:href="#join_group_hover"/>\n         </svg>\n         <span class="operate-text">加入群</span>\n    </div>\n</div>'),$templateCache.put("pagelet/orgSetting/setting/org-icon-upload.html",'<div show-icon error-title="组织信息"></div>'),$templateCache.put("pagelet/orgSetting/setting/setting.html",'<div ng-controller="orgInfoCtrl">\n    <div class="org-recharge"\n         permission-check="orgSetting.recharge"\n         ng-if="!isTrailOrg">\n        <span>尊敬的用户，您的企业版到期时间为</span>\n        <span class="num">{{orgRechargeTime.year}}</span><span class="unit"> -</span>\n        <span class="num">{{orgRechargeTime.month}}</span><span class="unit"> -</span>\n        <span class="num">{{orgRechargeTime.day}}</span><span class="unit"></span>\n        <!-- <span class="btn">立即缴费</span>-->\n        <span class="error-hint">如要续费，请联系客服邮箱<a href="mailto:youdaogroup@service.netease.com"> youdaogroup@service.netease.com</a></span>\n    </div>\n    <div class="org-recharge"\n         ng-if="isTrailOrg"\n         permission-check="orgSetting.recharge">\n        <span ng-if="leftTrailDays > 0">有道云协作企业版剩余试用时间：<span class="num">{{leftTrailDays}}</span>天</span>\n        <span ng-if="leftTrailDays == 0">您的企业版试用将在今天到期</span>\n        <span ng-if="leftTrailDays < 0">您的企业版试用时间已到期</span>\n        <span class="error-hint">联系<a href="mailto:youdaogroup@service.netease.com">youdaogroup@service.netease.com</a>购买</span>\n    </div>\n    <form class="setting-form" name="orgSettingForm" ng-submit="saveChange()" novalidate>\n        <div>\n            <ul class="org-profile-editor">\n                <li>\n                    <span class="org-profile-label">名称</span>\n                    <span ng-bind="orgName"\n                          permission-check="!orgSetting.changeName"></span>\n                    <input type="text"\n                           placeholder="云协作组织名称"\n                           ng-model="orgName"\n                           name="orgName"\n                           permission-check="orgSetting.changeName"\n                           ng-maxlength="50"\n                           ng-minlength="1"\n                           ng-readonly="!ready"\n                           required/>\n                    <p ng-show="orgSettingForm.orgName.$error.maxlength" class="error-hint">组织名称不能超过50个字符</p>\n                    <p ng-show="orgSettingForm.orgName.$error.required" class="error-hint">组织名称不能为空</p>\n                </li>\n                <li class="org-icon-editor">\n                    <div class="org-icon-img">\n                        <span class="org-profile-label align-top">头像</span>\n                        <div class="org-icon-border">\n                            <img id="org-icon" ng-src="{{photo}}" default-src="style/images/491c4c20.org_icon_default.png"/>\n                        </div>\n                    </div>\n\n                    <div class="org-icon-upload"\n                         permission-check="orgSetting.changePhoto">\n                        <span class="org-icon-hint">支持JPG、PNG、GIF格式，小于2MB</span>\n                        <button class="btn"\n                                widget-upload="\'image\'"\n                                upload-type="\'image\'"\n                                upload-select="uploadIcon(tasks)"\n                                ng-disabled="!ready"\n                                title="上传新头像">\n                            上传新头像\n                        </button>\n                    </div>\n                </li>\n                <li permission-check="orgSetting.showQuota">\n                    <span class="org-profile-label">空间</span>\n                    <progress class="org-quota-progressbar" max="100" value="{{usedSpace*100/totalSpace}}" title="使用量：{{getUsedPrecentage()}}%"></progress>\n                    <span class="org-quota-text">{{usedSpace | fileSize}} / {{totalSpace | fileSize}}</span>\n                </li>\n                <li>\n                    <span class="org-profile-label align-top" placeholder="组织简介">简介</span>\n                    <span class="org-des-readonly"\n                      ng-bind="orgDescription"\n                      permission-check="!orgSetting.changeDescription"></span>\n                    <textarea name="orgDescription"\n                              id=""\n                              cols="30"\n                              rows="4"\n                              ng-model="orgDescription"\n                              permission-check="orgSetting.changeDescription"\n                              ng-maxlength=200\n                              ng-readonly="!ready"></textarea>\n                    <p ng-show="orgSettingForm.orgDescription.$error.maxlength" class="error-hint">组织简介不能超过200个字符</p>\n                </li>\n            </ul>\n            <div class="org-setting-save"\n                 permission-check="orgSetting.save">\n                <div class="org-setting-save-margin">\n                    <button ng-if="!onsave" type="submit" class="btn" ng-disabled="!ready || orgSettingForm.$invalid">保存</button>\n                    <div ng-if="onsave">\n                        <button ng-if="!savedFailed" class="btn" disabled>保存成功</button>\n                        <button ng-if="savedFailed" class="btn" disabled>保存失败</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="org-setting-exit" permission-check="trailOrg.quit" ng-if="leftTrailDays < 0">\n            <div class="org-setting-exit-margin">\n                <div class="btn dismiss" ng-click="quitOrg()">退出组织</div>\n            </div>\n        </div>\n        <div class="org-setting-exit" permission-check="orgSetting.quit" ng-if="specialOrg">\n            <div class="org-setting-exit-margin">\n                <div class="btn dismiss" ng-click="quitOrg()">退出组织</div>\n            </div>\n        </div>\n        <div class="org-setting-dismiss" permission-check="orgSetting.dismiss" ng-if="isTrailOrg || orgNeedRecharge">\n            <div class="org-setting-dismiss-margin">\n                <div class="btn dismiss" ng-click="deleteOrganization()">解散组织</div>\n            </div>\n        </div>\n    </form>\n\n</div>\n\n'),$templateCache.put("pagelet/pdf/pdfViewer.html",'<div class="pdf-toolbar-container">\n    <div class="pdf-toolbar" ng-class="{active: showToolbar}">\n        <span class="pdf-toolbar-page">{{ pdfInfo.page }} / {{ pdfInfo.pageCount }}</span>\n        <button class="pdf-toolbar-page-prev" type="button" ng-click="pagePrev()">\n            <svg><use xlink:href="#pdf-page-prev"/></svg>\n        </button>\n        <button class="pdf-toolbar-page-next" type="button" ng-click="pageNext()">\n            <svg><use xlink:href="#pdf-page-next"/></svg>\n        </button>\n        <div class="pdf-toolbar-zoom-group">\n            <button class="pdf-toolbar-zoom-in" type="button" ng-click="zoomIn()">\n                <svg><use xlink:href="#pdf-zoom-in"/></svg>\n            </button>\n            <button class="pdf-toolbar-zoom-out" type="button" ng-click="zoomOut()">\n                <svg><use xlink:href="#pdf-zoom-out"/></svg>\n            </button>\n        </div>\n        <button class="pdf-toolbar-fullscreen" type="button" ng-if="showFullscreen" ng-click="presentationMode()">\n            <svg><use xlink:href="#pdf-fullscreen"/></svg>\n        </button>\n    </div>\n</div>\n<iframe ng-src="{{ ::url }}" frameborder="0" width="100%" height="100%"></iframe>\n<!-- TODO fullscreen close btn -->\n'),$templateCache.put("pagelet/pdf/preview.html",'<div detail-comment>\n    <div ng-controller="pdfPreviewCtrl" class="office-preview" ng-class="{meta:meta}">\n        <p class="info" ng-show="meta">\n            <span class="meta-item" ng-bind="\'创建时间：\' + (file.createDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n            <span class="meta-item" ng-bind="\'修改时间：\' + (file.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n            <span class="meta-item" ng-bind="\'文件大小：\' + (file.size | fileSize)"></span>\n            <span class="meta-path-prefix">所在位置： </span>\n            <span class="meta-path" ng-bind="filePath" title="{{filePath}}" ng-click="onOpenFolder(file.parentId)"></span>\n        </p>\n        <div class="office-preview-ct">\n            <div class="office-preview-iframe" ng-if="src" pdf-viewer="src"></div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/search/search.html",'<div class="search" ng-controller="searchCtrl">\n    <div class="search-hd">\n        <span class="back" ng-click="returnList()">\n            <svg class="icon-back">\n                <use xlink:href="#back"/>\n            </svg>\n            返回\n        </span>\n        <span class="split"></span>\n        <div class="title">\n            <span class="title-other">“</span>\n            <span class="title-content ellipsis" ng-bind="keyword"></span>\n            <span class="title-other">” 的搜索结果</span>\n        </div>\n    </div>\n    <div class="search-bd">\n        <ul class="search-bd-tabs">\n            <li class="search-tab" \n            ng-click="tabToFile()"\n            ng-class="{\'active\' : tabName == \'FILE\' }">\n            文件({{filesState.total}})\n            </li>\n            <li class="search-tab"\n                ng-click="tabToComment()"\n                ng-class="{\'active\' : tabName == \'COMMENT\' }">\n                评论与回复({{commentsState.total}})\n            </li>\n            <li class="search-tab"\n            ng-click="tabToMessage()"\n            ng-class="{\'active\' : tabName == \'MESSAGE\' }">\n            讨论({{messagesState.total}})\n            </li>\n        </ul>\n        <div class="search-bd-content" ng-show="tabName == \'FILE\'">\n            <div class="search-files"\n                 file-view="results"\n                 file-view-layout="\'table\'"\n                 file-view-loading="loading"\n                 file-view-keyword="keyword"\n                 file-view-columns="\'path|date|modifier|size\'"\n                 file-view-list-mode="search"\n                 file-droppable-support="false">\n            </div>\n            <div class="page-num" ng-if="filesState.pageTotal > 1">当前页&nbsp;{{filesState.pageNum}}&nbsp;/&nbsp;{{filesState.pageTotal}}</div>\n            <div class="page-locate" ng-if="filesState.pageTotal > 1">\n                <svg class="page-locate-btn first"\n                     ng-class="{active: filesState.pageNum > 1}"\n                     ng-click="gotoFirstFilePage()">\n                    <use ng-if="filesState.pageNum <= 1" xlink:href="#page_first"/>\n                    <use ng-if="filesState.pageNum > 1" xlink:href="#page_first_active"/>\n                </svg>\n                <svg class="page-locate-btn pre"\n                     ng-class="{active: filesState.pageNum > 1}"\n                     ng-click="gotoPreFilePage()">\n                    <use ng-if="filesState.pageNum <= 1" xlink:href="#page_pre"/>\n                    <use ng-if="filesState.pageNum > 1" xlink:href="#page_pre_active"/>\n                </svg>\n                <svg class="page-locate-btn next"\n                     ng-class="{active: filesState.pageNum < filesState.pageTotal}"\n                     ng-click="gotoNextFilePage()">\n                    <use ng-if="filesState.pageNum >= filesState.pageTotal" xlink:href="#page_next"/>\n                    <use ng-if="filesState.pageNum < filesState.pageTotal" xlink:href="#page_next_active"/>\n                </svg>\n                <svg class="page-locate-btn last"\n                     ng-class="{active: filesState.pageNum < filesState.pageTotal}"\n                     ng-click="gotoLastFilePage()">\n                    <use ng-if="filesState.pageNum >= filesState.pageTotal" xlink:href="#page_last"/>\n                    <use ng-if="filesState.pageNum < filesState.pageTotal" xlink:href="#page_last_active"/>\n                </svg>\n            </div>\n        </div>\n        <div class="search-bd-content" ng-show="tabName == \'MESSAGE\'">\n            <div class="search-messages">\n            <div class="message active" ng-repeat="message in messages">\n                <img ng-src="{{::(message.user.photo | photo)}}" class="user-img" user-info data-user-id="{{message.user.userId}}">\n                <div class="content-node">\n                    <div class="content-hd ellipsis selectable">\n                        <div class="username" user-info data-user-id="{{message.user.userId}}" ng-bind="message.user | alias"></div>\n                        <div class="time" ng-bind="::(message.time | date:\'yyyy-MM-dd HH:mm\')"></div>\n                    </div>\n                    <div \n                        class="content-bd selectable"\n                        widget-highlight\n                        high-value = "{{message.message}}"\n                        keyword = "{{keyword}}"\n                        before-filters = \'emojiFilter\'\n                        enable-linkify="true">\n                    </div>\n                </div>\n                <div class="content-forward" ng-click="forwardMessage(message.id)">\n                    查看前后消息\n                </div>\n            </div>\n            </div>\n            <div class="page-num" ng-if="messagesState.pageTotal > 1">当前页&nbsp;{{messagesState.pageNum}}&nbsp;/&nbsp;{{messagesState.pageTotal}}</div>\n            <div class="page-locate" ng-if="messagesState.pageTotal > 1">\n                <svg class="page-locate-btn first"\n                     ng-class="{active: messagesState.pageNum > 1}"\n                     ng-click="gotoFirstMessagePage()">\n                    <use ng-if="messagesState.pageNum <= 1" xlink:href="#page_first"/>\n                    <use ng-if="messagesState.pageNum > 1" xlink:href="#page_first_active"/>\n                </svg>\n                <svg class="page-locate-btn pre"\n                     ng-class="{active: messagesState.pageNum > 1}"\n                     ng-click="gotoPreMessagePage()">\n                    <use ng-if="messagesState.pageNum <= 1" xlink:href="#page_pre"/>\n                    <use ng-if="messagesState.pageNum > 1" xlink:href="#page_pre_active"/>\n                </svg>\n                <svg class="page-locate-btn next"\n                     ng-class="{active: messagesState.pageNum < messagesState.pageTotal}"\n                     ng-click="gotoNextMessagePage()">\n                    <use ng-if="messagesState.pageNum >= messagesState.pageTotal" xlink:href="#page_next"/>\n                    <use ng-if="messagesState.pageNum < messagesState.pageTotal" xlink:href="#page_next_active"/>\n                </svg>\n                <svg class="page-locate-btn last"\n                     ng-class="{active: messagesState.pageNum < messagesState.pageTotal}"\n                     ng-click="gotoLastMessagePage()">\n                    <use ng-if="messagesState.pageNum >= messagesState.pageTotal" xlink:href="#page_last"/>\n                    <use ng-if="messagesState.pageNum < messagesState.pageTotal" xlink:href="#page_last_active"/>\n                </svg>\n            </div>\n        </div>\n        <div class="search-bd-content" ng-show="tabName == \'COMMENT\'">\n            <div class="search-comments">\n                <div class="comment active" ng-repeat="comment in comments">\n                    <img ng-src="{{::(comment.user.photo | photo)}}" class="user-img" user-info data-user-id="{{comment.user.userId}}">\n                    <div class="content-node">\n                        <div class="content-hd selectable">\n                            <div class="username" user-info data-user-id="{{comment.user.userId}}" ng-bind="::(comment.user | alias)"></div>\n                            <div class="content-file-name">\n                                在\n                                <span class="fileName"\n                                      file-open\n                                      file-id="comment.fileId"\n                                      file-name="comment.fileName"\n                                      group-id="comment.groupId"\n                                      ng-bind="comment.fileName">\n                                </span>\n                                中\n                                <span ng-if="::(!comment.reply)">评论了</span>\n                                <span ng-if="::(comment.reply)">回复了</span>\n                            </div>\n                            <div class="time" ng-bind="::(comment.time | date:\'yyyy-MM-dd HH:mm\')"></div>\n                        </div>\n                        <div\n                                class="content-bd selectable"\n                                widget-highlight\n                                high-value = "{{comment.content}}"\n                                keyword = "{{keyword}}"\n                                before-filters = \'emojiFilter\'\n                                enable-linkify="true">\n                        </div>\n                    </div>\n                    <div\n                            open-comment\n                            file-id="comment.fileId"\n                            file-name="comment.fileName"\n                            group-id="comment.groupId"\n                            comment-id="comment.id"\n                            class="content-forward">\n                        <span ng-if="::(!comment.reply)">查看评论</span>\n                        <span ng-if="::(comment.reply)">查看回复</span>\n                    </div>\n                </div>\n            </div>\n            <div class="page-num" ng-if="commentsState.pageTotal > 1">当前页&nbsp;{{commentsState.pageNum}}&nbsp;/&nbsp;{{commentsState.pageTotal}}</div>\n            <div class="page-locate" ng-if="commentsState.pageTotal > 1">\n                <svg class="page-locate-btn first"\n                     ng-class="{active: commentsState.pageNum > 1}"\n                     ng-click="gotoFirstCommentPage()">\n                    <use ng-if="commentsState.pageNum <= 1" xlink:href="#page_first"/>\n                    <use ng-if="commentsState.pageNum > 1" xlink:href="#page_first_active"/>\n                </svg>\n                <svg class="page-locate-btn pre"\n                     ng-class="{active: commentsState.pageNum > 1}"\n                     ng-click="gotoPreCommentPage()">\n                    <use ng-if="commentsState.pageNum <= 1" xlink:href="#page_pre"/>\n                    <use ng-if="commentsState.pageNum > 1" xlink:href="#page_pre_active"/>\n                </svg>\n                <svg class="page-locate-btn next"\n                     ng-class="{active: commentsState.pageNum < commentsState.pageTotal}"\n                     ng-click="gotoNextCommentPage()">\n                    <use ng-if="commentsState.pageNum >= commentsState.pageTotal" xlink:href="#page_next"/>\n                    <use ng-if="commentsState.pageNum < commentsState.pageTotal" xlink:href="#page_next_active"/>\n                </svg>\n                <svg class="page-locate-btn last"\n                     ng-class="{active: commentsState.pageNum < commentsState.pageTotal}"\n                     ng-click="gotoLastCommentPage()">\n                    <use ng-if="commentsState.pageNum >= commentsState.pageTotal" xlink:href="#page_last"/>\n                    <use ng-if="commentsState.pageNum < commentsState.pageTotal" xlink:href="#page_last_active"/>\n                </svg>\n            </div>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/search/searchInput.html",'<div class="input-search">\n    <svg class="icon-search">\n    	<use xlink:href="#search"/>\n    </svg>\n\n    <input class="search-text" placeholder="搜索..." ng-model="content" max-input-length="1000">\n</div>'),$templateCache.put("pagelet/setting/members/become-reader-alert.html",'<div class="confirm">\n    <p>你已经被该群管理员设置成为只读者</p>\n    <p>点击查看<a href="http://note.youdao.com/helpcenter/help.html#f-13-1" target="_blank">成员角色权限说明</a></p>\n</div>'),$templateCache.put("pagelet/setting/members/chat-template.html",'<div class="member-message selectable">\n    <div class="member" ng-if="::(message.data.action == 0 || message.data.action == 3 || message.data.action == 7)">\n        <img ng-src="{{::(message.data.user.photo | photo)}}" class="bubble-user" user-info data-user-id="{{message.data.user.userId}}">\n        <i class="operation-icon" ng-class="::{\'operation-join-icon\': message.data.action == 0 || message.data.action == 7, \'operation-leave-icon\': message.data.action == 3}"></i>\n    </div>\n    <div  class="member" ng-if="::(message.data.action == 1 || message.data.action == 2 || message.data.action == 4 || message.data.action == 5 || message.data.action == 6)" >\n        <img ng-src="{{::(message.data.object.photo | photo)}}" class="bubble-user" user-info data-user-id="{{message.data.object.userId}}">\n        <i class="operation-icon" ng-show="::(message.data.action != 6)" ng-class="::{\'operation-join-icon\': message.data.action == 1 || message.data.action == 2, \'operation-leave-icon\': message.data.action == 4}"></i>\n    </div>\n    <div class="content-node">\n        <div class="content-head selectable">\n            <div class="member-item" ng-if="::(message.data.action == 0 || message.data.action == 3 || message.data.action == 7)">\n                <div class="username" user-info data-user-id="{{message.data.user.userId}}" ng-bind="::(message.data.user | alias)"></div>\n                <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{message.data.user.userId}}\']}"></i></a>\n            </div>\n            <div class="member-item" ng-if="::(message.data.action == 1 || message.data.action == 2 || message.data.action == 4 || message.data.action == 5 || message.data.action == 6)">\n                <div class="username" user-info data-user-id="{{message.data.object.userId}}" ng-bind="::(message.data.object | alias)"></div>\n                <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{message.data.object.userId}}\']}"></i></a>\n            </div>\n            <div class="time" ng-if="::(!message.error)" ng-bind="::(message.data.time | date:\'HH:mm\')"></div>\n        </div>\n        <div class="bubble">\n            <div class="bubble-text-node selectable">\n                <span class="member-text" ng-if="::(message.data.action == 0 || message.data.action == 2)">\n                    <span class="bold">加入了本群</span>\n                </span>\n                <span class="member-text" ng-if="::(message.data.action == 1)">\n                    <span class="bold">加入了本群</span>&nbsp;&nbsp;&nbsp;(&nbsp;{{message.data.user | alias}}&nbsp;批准&nbsp;)\n                </span>\n                <span class="member-text" ng-if="::(message.data.action == 7)">\n                    <span class="bold">加入了本群</span>&nbsp;&nbsp;&nbsp;(&nbsp;{{message.data.object | alias}}&nbsp;邀请&nbsp;)\n                </span>\n                <span class="member-text" ng-if="::(message.data.action == 3 || message.data.action == 4)">\n                    <span class="bold">退出了本群</span>\n                </span>\n                <span class="member-text" ng-if="::(message.data.action == 6)">\n                    <div class="line owner"></div>成为了新的群主\n                </span>\n                <!-- action 5 产品中暂时还没有使用 -->\n                <span class="member-text" ng-if="::(message.data.action == 5)">\n                    <div class="line owner"></div>成为了新的管理员\n                </span>\n            </div>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/setting/members/invitation/invitation-email.html",'<div class="container email-invitation" ng-controller="emailInvitationCtrl">\n    <div class="invitee-email">\n        <span class="item-left">收件人</span>\n        <input type="text"\n               name="invitee-email"\n               ng-model="inviteeEmail"\n               placeholder="可使用,区分多个收件人"\n               required\n               widget-auto-focus\n               />\n    </div>\n</div>\n'),$templateCache.put("pagelet/setting/members/members.html",'<div class="members-main" ng-controller="membersCtrl">\n    <span class="members-title"\n        permission-check="setting.invite">\n        <svg class="members-invite">\n            <use xlink:href="#members_invite"/>\n        </svg>\n        邀请加入（群号：{{gid()}}）\n        <span class="limit-hint" ng-if="members.length >= memberLimit && !group.isVip && myRole == \'ROLE_GROUP_FOUNDER\'">您的群已经满员。<a href="//note.youdao.com/biz/" target="_blank">购买企业版</a>，支持更多成员、更大空间以及更多特权！</span>\n        <span class="limit-hint" ng-if="members.length >= memberLimit && !group.isVip && myRole != \'ROLE_GROUP_FOUNDER\'">该群已经满员。购买企业版，支持更多成员、更大空间以及更多特权！</span>\n    </span>\n    <div class="invitation" ng-controller="invitationCtrl"\n        permission-check="setting.invite">\n        <div class="invitation-bd">\n            <div class="invitation-link">\n                <p class="invitation-title-hint invitation-title">复制邀请链接发送给朋友，邀请他们加入</p>\n                <input class="invitation-link-text" value="{{invitationUrl}}" type="text" readonly="readonly" ng-copy="copyAction()"/>\n                <div class="btn-container" ng-if="!client.isPC() && !client.isMac()">\n                    <button class="btn btn-copy" clipboard="clipboardOptions" ng-bind="copyBtnText" ng-disabled="copyDone"></button>\n                </div>\n                <div class="btn-container" ng-if="client.isPC() && !client.isMac()">\n                    <button class="btn btn-copy" ng-bind="copyBtnText" ng-disabled="copyDone" ng-click="copyTextFromClient()"></button>\n                </div>\n                <div class="invitation-buttons">\n                    <div class="invitation-emails" ng-click="openEmailInvite()" ng-show="!is_3rdLogin">\n                        <div class="email-icon"></div>\n                        <div class="email-invite-text">邮件发送邀请链接</div>\n                    </div>\n                    <div class="invitation-qq" ng-class="{is3rdlogin : is_3rdLogin}">\n                        <div class="qq-icon"></div>\n                        <a class="qq-invite-text" target="_blank" href={{qqInviteLink}}>QQ发送邀请链接</a>\n                    </div>\n                </div>\n            </div>\n            <div class="invitation-from-userid" select-user ng-show="!isOrgGroup">\n                <p class="invitation-title-hint">请输入有道云笔记登录邮箱或者昵称进行搜索</p>\n                <form>\n                    <div class="invitation-input">\n                        <input class="input-name" type="text" ng-model="prefixName" placeholder="目前仅支持搜索有道云笔记用户" title="目前仅支持搜索有道云笔记用户"/>\n                        <svg class="cancel" ng-click="prefixName = \'\'; noFound = false" ng-show="searchCompleted && prefixName">\n                            <use class="default" xlink:href="#file_upload_cancel"/>\n                            <use class="hover" xlink:href="#file_upload_cancel_hover"/>\n                        </svg>\n                        <svg class="load-data" ng-show="!searchCompleted && prefixName">\n                            <use xlink:href="#loading"/>\n                        </svg>\n                    </div>\n                    <span class="invitation-error-hint error" ng-show="noFound">未找到该用户，请检查填写帐号是否正确</span>\n                </form>\n                <div class="invitation-search-list" ng-show="users.length > 0">\n                    <ul class="invitation-ul">\n                        <li class="invitation-li invitation-item"\n                            ng-class="{select:mouseEnter, added:user.added}"\n                            ng-mouseenter="mouseEnter = true"\n                            ng-mouseleave="mouseEnter = false"\n                            ng-repeat="user in users"\n                            data-user-id="{{user.userId}}"\n                            data-added="{{user.added}}"\n                            data-is-visit="true"\n                            ng-click="inviteForUserId(user.userId, user.added)">\n                            <div class="invitation-item-left">\n                                <img class="invitation-photo" ng-src="{{user.photo | photo}}" alt="" />\n                            </div>\n                            <p class="invitation-item-right">\n                                <span class="user-name" ng-bind-html="user.name | highlight:prefixName"></span>(\n                                <span class="user-userId" ng-bind-html="user.userId | highlight:prefixName"></span>)\n                                <span class="user-added" ng-show="user.added">已添加</span>\n                            </p>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n\n            <div class="invitation-quick" ng-show="isOrgGroup">\n                <p class="invitation-title-hint">直接邀请<span class="black invitation-group-name"> {{orgName}} </span>组织中的成员</p>\n                <button class="btn btn-add" ng-click="quickAddMember()">选择组织中的成员</button>\n            </div>\n        </div>\n    </div>\n    <span class="members-title">\n        <svg class="members-list">\n            <use xlink:href="#members_list"/>\n        </svg>\n        <span>成员列表</span>\n        <span class="member-intro">（<a href="http://note.youdao.com/helpcenter/help.html#f-13-1" target="_blank">成员角色说明</a>）</span>\n    </span>\n    <ul class="members">\n        <li class="member" ng-repeat="member in members" ng-mouseover="showOperation = true" ng-mouseleave="(showOperation = false)">\n        <img class="photo" ng-src="{{ member.photo | photo }}" user-info data-user-id="{{member.userId}}" data-invitee="{{member.joinTime == 0}}">\n            <div class="info">\n                <div class="username" user-info data-user-id="{{member.userId}}" data-invitee="{{member.joinTime == 0}}" ng-bind="member | alias" title="{{member | alias}}"></div>\n                <div class="role" ng-switch="member.role">\n                    <span class="role-red" ng-switch-when="ROLE_GROUP_FOUNDER">（群主）</span>\n                    <span class="role-green" ng-switch-when="ROLE_GROUP_MANAGER">（管理员）</span>\n                    <span ng-switch-when="ROLE_GROUP_EDITOR">（编辑者）</span>\n                    <span ng-switch-when="ROLE_GROUP_READER">（只读者）</span>\n                </div>\n            </div>\n            <div class="operation" ng-show="showOperation">\n\n                <a class="privateChat" ng-if="ownerId != member.userId" ng-click="newP2PDialog(member)" >\n                    私聊\n                </a>\n\n                <div class="more-operation" widget-toggle="memberMoreVisible"\n                        permission-check="setting.changeRole">\n                    <a class="more" ng-if="ownerId != member.userId &&\n                        myRoleSortKey < member.sortKey">\n                        更多\n                        <svg class="icon-menu-down">\n                            <use xlink:href="#menu_down"/>\n                        </svg>\n                        <ul class="menu widget-menu owner" widget-toggle-content>\n                            <li class="menu-option widget-menu-item" ng-if="myRole == ROLES[\'GROUP_FOUNDER\'] && member.role != ROLES[\'GROUP_FOUNDER\']" ng-click="changeOwner(member)">\n                                设为群主\n                            </li>\n                            <li class="menu-option widget-menu-item" ng-if="myRole == ROLES[\'GROUP_FOUNDER\'] && member.role != ROLES[\'GROUP_MANAGER\']" ng-click="changeRole(member, ROLES[\'GROUP_MANAGER\'])">\n                                设为管理员\n                            </li>\n                            <li class="menu-option widget-menu-item" ng-if="(myRole == ROLES[\'GROUP_FOUNDER\'] || myRole == ROLES[\'GROUP_MANAGER\']) &&\n                                        member.role != ROLES[\'GROUP_EDITOR\']" ng-click="changeRole(member, ROLES[\'GROUP_EDITOR\'])">\n                                设为编辑者\n                            </li>\n                            <li class="menu-option widget-menu-item" ng-if="(myRole == ROLES[\'GROUP_FOUNDER\'] || myRole == ROLES[\'GROUP_MANAGER\']) &&\n                                        member.role != ROLES[\'GROUP_READER\']" ng-click="changeRole(member, ROLES[\'GROUP_READER\'])" ng-show="launcher.orgId()">\n                                设为只读者\n                            </li>\n                            <li class="menu-option widget-menu-item" ng-if="\n                (myRole == ROLES[\'GROUP_FOUNDER\'] ||\n                    (myRole == ROLES[\'GROUP_MANAGER\'] &&\n                        (member.role == ROLES[\'GROUP_EDITOR\'] ||\n                            member.role == ROLES[\'GROUP_READER\']))) &&\n                (ownerId != member.userId)" ng-click="removeMember(member)"\n                                permission-check="setting.removeMember">\n                                移除\n                            </li>\n                        </ul>\n                    </a>\n                </div>\n            </div>\n        </li>\n        <li class="member" ng-if="myRole" ng-repeat="member in invitees" ng-mouseover="showOperation = true" ng-mouseleave="(showOperation = false)">\n            <img class="photo" ng-src="{{ member.photo | photo }}" user-info data-user-id="{{member.userId}}" data-invitee="{{member.joinTime == 0}}">\n            <div class="info">\n                <div class="username" user-info data-user-id="{{member.userId}}" data-invitee="{{member.joinTime == 0}}" ng-bind="member | alias" title="{{member | alias}}"></div>\n            </div>\n            <div class="operation" ng-if="myRole == ROLES[\'GROUP_FOUNDER\'] || myRole == ROLES[\'GROUP_MANAGER\']" ng-show="showOperation">\n                <a class="remove" ng-click="removeInvitee(member)">\n                    移除\n                </a>\n            </div>\n            <p ng-show="!showOperation || !(myRole == ROLES[\'GROUP_FOUNDER\'] || myRole == ROLES[\'GROUP_MANAGER\'])" class="members-join-status">\n                已邀请，等待验证\n            </p>\n        </li>\n        <!--<div class="line"></div>-->\n    </ul>\n</div>\n'),$templateCache.put("pagelet/setting/members/quickAdd/quickAdd-dialog.html",'<div class="container" ng-controller="quickAddCtrl" >\n    <div class="item-left">\n        <input class="item-search" type="text" ng-model="prefix" placeholder="输入查找关键字"/>\n        <div class="list-container">\n            <ul class="quick-list">\n                <li class="quick-list-item" ng-repeat="member in quickList | filter: filterByNameOrId"\n                    ng-click="selectMember(member,$event)">\n                    <img class="list-img" ng-src="{{ member.photo | photo }}" />\n                    <span class="list-name">{{member | alias}}</span>\n                    <span class="list-email">{{member.userId}}</span>\n                </li>\n            </ul>\n            <p class="item-title1" ng-show="(alreadyList | filter: filterByNameOrId).length > 0">已在该群中:</p>\n            <ul class="already-list">\n                <li class="already-list-item" ng-repeat="member in alreadyList | filter: filterByNameOrId">\n                    <img class="list-img" ng-src="{{ member.photo | photo }}" />\n                    <span class="list-name">{{member | alias}}</span>\n                    <span class="list-email">{{member.userId}}</span>\n                </li>\n            </ul>\n        </div>\n    </div>\n\n    <div class="item-right">\n        <p class="item-title2">选择成员({{selectNum}})</p>\n        <ul class="select-list">\n            <li class="select-list-item" ng-repeat="member in selectList" ng-mouseover="showCancel = true" ng-mouseleave="showCancel = false">\n                <img class="list-img" ng-src="{{ member.photo | photo }}" />\n                <span class="list-name">{{member | alias}}</span>\n                <span class="list-email">{{member.userId}}</span>\n                <svg class="select-cancel" ng-show="showCancel" ng-click="deleteMember(member)">\n                    <use class="default" xlink:href="#dialog_close"/>\n                    <use class="hover" xlink:href="#dialog_close_hover"/>\n                </svg>\n            </li>\n        </ul>\n    </div>\n</div>'),$templateCache.put("pagelet/setting/options/dismiss-group.html",'<div class="confirm setting-confirm-dismiss">\n    <p>您确定要解散该群吗？</p>\n    <p class="desc">解散群后群内所有资料将会被删除</p>\n</div>'),$templateCache.put("pagelet/setting/options/groupmessage/groupmessage-item.html",'<div class="group-message selectable">\n    <div ng-if="::(message.data.action === 1)">\n        <div class="line rename"></div>\n        <span class="group-hint">本群已改名为：</span><span class="group-name">{{ message.data.groupName }}</span>\n    </div>\n</div>\n'),$templateCache.put("pagelet/setting/options/options.html",'<div class="options" ng-controller="optionsCtrl">\n    <form ng-submit="save()" ng-show="ready">\n\n        <fieldset class="options-fields">\n            <div class="options-items">\n                <span class="options-label">群号</span>\n                <span class="options-text">{{gid()}}</span>\n            </div>\n            <div class="options-items">\n                <span class="options-label">群名</span>\n                <input class="options-name" max-input-length="32" permission-check="setting.changeName" ng-disabled="!ready" ng-model="group.name" type="text" />\n                <span class="options-text" permission-check="!setting.changeName" ng-bind="group.name"></span>\n            </div>\n            <div class="options-items">\n                <span class="options-label options-label-desc align-top">群简介</span>\n                <textarea name="groupDesc" ng-disabled="!ready" permission-check="setting.changeDescription" max-input-length="60" id="" ng-model="group.description" class="options-desc"></textarea>\n                <span class="options-text" permission-check="!setting.changeDescription" ng-bind="group.description"></span>\n            </div>\n            <div class="options-items options-group-type">\n                <span class="options-label options-label-desc">群类型</span>\n                <span class="options-text group-type-text">{{group.typeName}}<span class="gray" ng-if="group.type == \'normal\' || group.type == \'vip\' || group.type == \'hundred\' || group.type == \'feedback\'">（最多支持{{group.memberLimit}}个成员、{{group.totalSpace | fileSize}}群存储容量）</span></span>\n                <a class="vip-link" href="//note.youdao.com/biz/" target="_blank" ng-if="group.type != \'inner_group\' && !group.isVip && (group.owner == uid())">\n                    购买企业版，支持更多成员、更大空间以及更多特权！</a>\n                <div class="group-space">\n                    <div class="space-ratio"><div class="space-bar" ng-style="{\'width\': (group.usedSpace / group.totalSpace)  > 1 ? \'100%\' : ((group.usedSpace / group.totalSpace) * 100) + \'%\'}"></div></div>\n                    <span>{{group.usedSpace | fileSize}} / {{group.totalSpace | fileSize}}</span>\n                </div>\n            </div>\n        </fieldset>\n\n        <fieldset class="options-fields">\n            <span class="options-label align-top">加入身份验证</span>\n            <ul class="options-radios"\n                permission-check="setting.joinValidate">\n                <li>\n                    <label>\n                        <input class="checkbox" ng-disabled="!ready" type="radio" ng-model="group.acl" name="passport" value="1"/>\n                        <i class="label-radio"></i>\n                        允许任何人加入群\n                    </label>\n                </li>\n                <li>\n                    <label>\n                        <input class="checkbox" ng-disabled="!ready" type="radio" ng-model="group.acl" name="passport" value="2"/>\n                        <i class="label-radio"></i>\n                        需要身份验证才能加入该群\n                    </label>\n                </li>\n                <li>\n                    <label>\n                        <input class="checkbox" ng-disabled="!ready" type="radio" ng-model="group.acl" name="passport" value="3"/>\n                        <i class="label-radio"></i>\n                        不允许任何人加入该群\n                    </label>\n                </li>\n            </ul>\n            <span permission-check="!setting.joinValidate">\n                <span class="options-text" ng-if="group.acl == 1">允许任何人加入群</span>\n                <span class="options-text" ng-if="group.acl == 2">需要身份验证才能加入该群</span>\n                <span class="options-text" ng-if="group.acl == 3">不允许任何人加入该群</span>\n            </span>\n        </fieldset>\n\n        <fieldset class="options-fields"\n                permission-check="setting.listenMessage">\n            <span class="options-label align-top">群消息设置</span>\n            <ul class="options-radios">\n                <li>\n                    <label>\n                        <input class="checkbox" ng-disabled="!ready" type="radio" ng-model="settings.msg" name="alert" value="0"/>\n                        <i class="label-radio"></i>\n                        接收消息并提醒\n                    </label>\n                </li>\n                <li>\n                    <label>\n                        <input class="checkbox" ng-disabled="!ready" type="radio" ng-model="settings.msg" name="alert" value="1"/>\n                        <i class="label-radio"></i>\n                        不提醒仅显示消息数目\n                    </label>\n                </li>\n                <li>\n                    <label>\n                        <input class="checkbox" ng-disabled="!ready" type="radio" ng-model="settings.msg" name="alert" value="2"/>\n                        <i class="label-radio"></i>\n                        不提醒并且不显示消息数目\n                    </label>\n                </li>\n            </ul>\n        </fieldset>\n        <div permission-check="setting.listenMessage">\n            <input class="save-btn btn" type="submit" ng-disabled="!ready || saved" value="{{!saved ? \'保存\' : \'保存成功\'}}"/>\n            <span class="quit-text" permission-check="setting.quitGroup" ng-show="ready" ng-click="quit()">退出群</span>\n        </div>\n    </form>\n\n<!--     <div class="option-bottom" permission-check="setting.quitGroup" ng-show="ready">\n    <label class="options-label">退出群</label>\n    <button ng-click="quit()" ng-disabled="!ready" class="btn btn-primary dismiss-btn">退出群</button>\n</div> -->\n\n    <div class="option-bottom" permission-check="setting.removeGroup" ng-show="ready">\n<!--         <label class="options-label">解散群</label> -->\n        <div class="dismiss-group">\n            <button ng-click="dismiss()" ng-disabled="!ready" class="btn btn-primary dismiss">了解风险，解散群</button>\n            <label class="dismiss-message" ng-if="!orgId()">群解散后，所有的内容也会被立刻删除，不能恢复。请谨慎操作</label>\n            <label class="dismiss-message" ng-if="orgId()">\n                群解散后，所有的内容也会被立刻删除，<span class="red">仅组织管理员可恢复。请谨慎操作</span>\n            </label>\n        </div>\n    </div>\n\n    <div class="operate-group-container"\n         ng-show="ready"\n         ng-include="\'pagelet/orgSetting/plugin/operateGroup.html\'">\n    </div>\n</div>\n'),$templateCache.put("pagelet/setting/setting.html",'<div class="setting">\n    <div ng-controller="settingCtrl" >\n        <div class="setting-hd">\n            <span class=\'back\' ng-click="explorer.restore()">\n                <svg class="icon-back">\n                    <use xlink:href="#back"/>\n                </svg>\n                返回群\n            </span>\n            <ul class="setting-tabs">\n                <li class="setting-tab" ng-click="launcher.getGroupRouter().forward(\'/setting/members\')"\n                    ng-class="{\'active\' : segment == \'members\' }">成员管理</li>\n                <li class="setting-tab" ng-click="launcher.getGroupRouter().forward(\'/setting/options\')" ng-class="{\'active\' : segment == \'options\' }">群设置</li>\n            </ul>\n        </div>\n        <div class="setting-bd" widget-scroller>\n            <div ng-if="segment != null" ng-include="\'pagelet/setting/\' + segment + \'/\' + segment + \'.html\'"></div>         \n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/sidebar/createGroup/createGroup-dialog.html",'<div class="container create-group" ng-controller="createGroupCtrl">\n    <div ng-show="step1">\n        <div class="item">\n            <span class="item-left">群名称</span>\n            <input class="item-right" type="text"\n                name="groupName"\n                ng-model="groupName"\n                max-input-length="32"\n                required\n                widget-auto-focus\n                />\n        </div>\n        <div class="item" ng-show="hasOrganization">\n            <span class="item-left">所在组织</span>\n            <ui-select class="item-right styled-select" ng-model="orgs.selected.id" theme="selectize">\n                <ui-select-match>\n                    <span ng-bind="$select.selected.name || \'无\'"></span>\n                </ui-select-match>\n                <ui-select-choices repeat="o.id as o in orgs">\n                    <span ng-bind="o.name || \'无\'"></span>\n                </ui-select-choices>\n            </ui-select>\n        </div>\n        <div class="item group-desc">\n            <span class="item-left create-group-desc-left"><span>群简介</span><br /> <span class="create-group-desc-hint">(选填)</span></span>\n            <textarea class="item-right" name="groupDesc" max-input-length="60" id="" ng-model="description"></textarea>\n        </div>\n        <div class="item">\n            <p class="item-left">加群验证</p>\n            <div class="item-right item-radio">\n                <label>\n                    <input type="radio" ng-model="acl" value="1" /> \n                    <i class="label-radio"></i>\n                    允许任何人\n                </label>\n                <label>\n                    <input type="radio" ng-model="acl" value="2" />\n                    <i class="label-radio"></i>\n                    需身份验证\n                </label>\n                <label>\n                    <input type="radio" ng-model="acl" value="3" />\n                    <i class="label-radio"></i>\n                    不允许任何人\n                </label>\n            </div>\n        </div>\n    </div>\n    <div ng-show="step2">\n        <div>\n            <p class="create-group-success">群“<span ng-bind="groupName"></span>”创建成功</p>\n        </div>\n        <div>\n            <p class="item-left">群号</p><p class="item-right" ng-bind="groupId"></p>\n        </div>\n        <div>\n            <p class="item-left">群简介</p><p class="item-right group-desc" ng-bind="description"></p>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/sidebar/createGroup/exceed-groupQuota.html",'<div class="confirm">\n    <p>您创建的群数量已超过限制。</p>\n    <p>现在<a href="//note.youdao.com/biz/" target="_blank" tracker track-category="exceed" track-action="exceed-group-click">购买企业版</a>，支持建立更多协作群！</p>\n</div>'),$templateCache.put("pagelet/sidebar/createOrganization/createOrganization-dialog.html",'<div class="container create-organization" ng-controller="createOrganizationCtrl">\n    <div ng-show="step1">\n        <div class="item">\n            <span class="item-left">组织名称</span>\n            <input class="item-right float-right" type="text"\n                name="orgName"\n                ng-model="orgName"\n                max-input-length="50"\n                required\n                widget-auto-focus\n                />\n        </div>\n        <div class="item org-image">\n            <span class="item-left">组织头像</span>\n            <div class="item-right">\n                <div class="image-container">\n                    <img ng-src="{{photo()}}" alt="" class="org-icon" ng-style="resizeIcon"/>\n                </div>\n                <div class="org-icon-upload">\n                    <span class="org-icon-hint">支持JPG、PNG、GIF格式，小于2MB</span>\n                    <button class="upload-icon"\n                            widget-upload="\'image\'"\n                            upload-type="\'image\'"\n                            upload-select="uploadIcon(tasks)"\n                            title="上传新头像">\n                        上传新头像\n                    </button>\n                </div>                \n            </div>\n        </div>\n        <div class="item align-top">\n            <span class="item-left create-org-desc-left"><span>组织简介</span><br /> <span class="create-org-desc-hint">( 选填 )</span></span>\n            <textarea class="item-right float-right org-desc" name="orgDesc" max-input-length="200" ng-model="orgDesc" ></textarea>\n        </div>\n    </div>\n    <div ng-show="step2">\n        <div class="item">\n            <p class="create-org-success">组织“<span ng-bind="orgName"></span>”创建成功</p>\n        </div>\n        <div class="item">\n            <span class="item-left">组织号</span><span class="item-right" ng-bind="orgId"></span>\n        </div>\n        <div class="item">\n            <span class="item-left">组织简介</span><span class="item-right org-desc" ng-bind="orgDesc"></span>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/sidebar/joinGroup/joinConfirm-dialog.html",'<div class="container" ng-controller="joinConfirmCtrl">\n    <div class="item">\n        <span class="item-left">群号:</span>\n        <span class="item-right" ng-bind="group.id"></span>\n    </div>\n    <div class="item">\n        <span class="item-left">群名:</span>\n        <span class="item-right" ng-bind="group.name"></span>\n    </div>\n    <div class="item">\n        <span class="item-left">创建人:</span>\n        <span class="item-right" ng-bind="group.ownerName"></span>\n    </div>\n    <div class="item">\n        <span class="item-left">群简介:</span>\n        <span class="item-right" ng-bind="group.description"></span>\n    </div>\n    <div class="item" ng-show="group.acl == 2">\n        <span class="item-left">该群需要验证您的身份，请输入您的请求信息:</span>\n        <textarea max-input-length="32" ng-model="applyMessage"></textarea>\n    </div>\n</div>'),$templateCache.put("pagelet/sidebar/joinGroup/joinGroup-dialog.html",'<div class="container" ng-controller="joinGroupCtrl">\n    <div class="item input-groupId">\n        <p>\n            <span class="item-left">请输入群号</span><span class="hint error" ng-show="notFound">未找到符合条件的群</span>\n        </p>\n        <form ng-submit="confirm()">\n            <input type="text"\n                name="groupId"\n                ng-model="groupId"\n                widget-auto-focus\n                />\n            <input type="submit" class="btn-confirm" value="确定" ng-disabled="btnDisabled"/>\n        </form>\n    </div>\n</div>\n'),$templateCache.put("pagelet/sidebar/notify/exceed-memberQuota.html",'<div class="confirm">\n    <p>您的群已经满员，无法加入新成员。</p>\n    <p>现在<a href="//note.youdao.com/biz/" target="_blank" tracker track-category="exceed" track-action="exceed-member-click">购买企业版</a>，支持更多成员、更大空间以及更多特权！</p>\n</div>'),$templateCache.put("pagelet/sidebar/notify/message.html",'<div class="message-list" widget-scroller="onScroll(bottom, true)">\n    <ul class="message-ul" ng-show="!noNotification">\n        <li ng-repeat="message in myMessages" class="message-li" ng-mouseenter="message.show = true" ng-mouseleave="message.show = false">\n            <div class="message-item item-left">\n                <img class="message-photo" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true" ng-src="{{message.applier.photo | photo}}" alt="">\n            </div>\n            <div class="message-item item-right" ng-switch="message.type">\n                <div ng-switch-when="11">\n                    <p class="message-hd">\n                        <span class="message-applier" ng-bind="message.applier | alias" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true" title="{{message.applier | alias}}"></span>\n                        在\n                        <span class="message-groupName" ng-bind="message.groupName" title="{{message.groupName}}" ng-click="forward(message.groupId);"></span>\n                        中提到了我\n                        <span class="message-time" ng-bind="formatTime(message.time)" ng-show="!message.show"></span>\n                        <span class="message-forward"  ng-show="message.show" ng-click="forwardAction(message)">查看前后消息</span>\n                    </p>\n                    <div class="message-bd">\n                        <p ng-bind-html="message.message | htmlFilter | emojiFilter"></p>\n                    </div>\n                </div>\n                <div ng-switch-when="12">\n                    <p class="message-hd">\n                        <span ng-bind="message.applier | alias" class="message-applier" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true" title="{{message.applier | alias}}"></span>\n                        在评论\n                        <a href="javascript:;" class="message-filename" title="{{message.fileName | fileName}}" ng-click="openFile(message.groupId, message.fileId, message.fileName)">{{message.fileName | fileName}}</a>\n                        时提到了你\n                        <span class="message-time" ng-bind="formatTime(message.time)" ng-show="!message.show"></span>\n                        <span class="message-forward" ng-show="message.show" ng-click="forwardAction(message)">查看评论</span>\n                    </p>\n                    <div class="message-bd">\n                        <p ng-bind-html="message.message | htmlFilter | emojiFilter"></p>\n                    </div>\n                </div>\n                <div ng-switch-when="13">\n                    <p class="message-hd">\n                        <span ng-bind="message.applier | alias" class="message-applier" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true" title="{{message.applier | alias}}"></span>\n                        回复了\n                        <a href="javascript:;" class="message-groupName" title="{{message.fileName | fileName}}" ng-click="openFile(message.groupId, message.fileId, message.fileName)">我的评论</a>\n                        <span class="message-time" ng-bind="formatTime(message.time)" ng-show="!message.show"></span>\n                        <span class="message-forward"  ng-show="message.show" ng-click="forwardAction(message)">查看回复</span>\n                    </p>\n                    <div class="message-bd">\n                        <div class="repliedMessage">{{getUser().name}}：<span ng-bind-html="message.repliedMessage | cut:120 | htmlFilter | emojiFilter"></span> </div>\n                        <p ng-bind-html="message.message | htmlFilter | emojiFilter"></p>\n                    </div>\n                </div>\n            </div>\n        </li>\n    </ul>\n    <p class="no-notification" ng-show="noNotification">暂无通知</p>\n</div>\n'),$templateCache.put("pagelet/sidebar/notify/notification.html",'<div class="notify-list" widget-scroller="onScroll(bottom)">\n    <ul class="notify-ul" ng-show="!noNotification">\n        <li ng-repeat="message in messages" class="notify-li">\n            <div class="item-left" >\n                <p class="notify-group-message"\n                   ng-if="message.type < NOTIFICATION_TYPE[\'ENROLLED_IN_ORG\'] ||\n                            message.type == NOTIFICATION_TYPE[\'NEVER\'] ||\n                            message.type == NOTIFICATION_TYPE[\'INNER_GRP_RECOVERD\'] ||\n                            message.type == NOTIFICATION_TYPE[\'INNER_GRP_ERASED\']">\n                    <span ng-bind="message.groupName"></span>(<span ng-bind="message.groupId"></span>)\n                </p>\n                <p class="notify-group-message"\n                   ng-if="message.type >= NOTIFICATION_TYPE[\'ENROLLED_IN_ORG\'] &&\n                            message.type != NOTIFICATION_TYPE[\'NEVER\'] &&\n                            message.type != NOTIFICATION_TYPE[\'INNER_GRP_RECOVERD\'] &&\n                            message.type != NOTIFICATION_TYPE[\'INNER_GRP_ERASED\']">\n                    <span ng-bind="message.orgName"></span>\n                </p>\n                <div class="message-operation">\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'CONFIRM\']">\n                        <p ng-show="message.applier.userId == getUser().userId">您已成功加入该群</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'REMOVE\']">\n                        <p>您被移出该群</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'DISSOVE\']">\n                        <p>该群已被群主解散</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'INVITE\']">\n                        <p><a href="javascript:;" class="notify-member-name" ng-bind="message.applier | alias" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true"></a><span>&nbsp;邀请您加入群</span></p>\n                        <p class="apply-message" ng-bind="message.message"></p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'INVITE_USER_EXIST\']">\n                        <p><a href="javascript:;" class="notify-member-name" ng-bind="message.applier | alias" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true"></a><span>&nbsp;邀请您加入群</span></p>\n                        <p class="apply-message" ng-bind="message.message"></p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'DELETE_INVITE\']">\n                        <p><a href="javascript:;" class="notify-member-name" ng-bind="message.applier | alias" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true"></a><span>&nbsp;邀请您加入群</span></p>\n                        <p class="apply-message" ng-bind="message.message"></p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'ACCEPT_INVITE\']">\n                        <div ng-if="message.applier.userId != getUser().userId">\n                            <p><a href="javascript:;" class="notify-member-name" ng-bind="message.applier | alias" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true"></a><span>&nbsp;邀请您加入群</span></p>\n                            <p class="apply-message" ng-bind="message.message"></p>\n                        </div>\n                        <p ng-if="message.applier.userId == getUser().userId">\n                            <a href="javascript:;" class="notify-member-name" ng-bind="message.confirmer | alias" user-info data-user-id="{{message.confirmer.userId}}" data-from-notify="true"></a>&nbsp;接受了您的邀请\n                        </p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'IGNORE_INVIT\']">\n                        <div ng-if="message.applier.userId != getUser().userId">\n                            <p><a href="javascript:;" class="notify-member-name" ng-bind="message.applier | alias" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true"></a><span>&nbsp;邀请您加入群</span></p>\n                            <p class="apply-message" ng-bind="message.message"></p>\n                        </div>\n                        <p ng-if="message.applier.userId == getUser().userId">\n                            <a href="javascript:;" class="notify-member-name" ng-bind="message.confirmer | alias" user-info data-user-id="{{message.confirmer.userId}}" data-from-notify="true"></a>&nbsp;拒绝了您的邀请\n                        </p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'GIVE_GROUP_TO_OTHER\']">\n                        <p ng-show="message.confirmer.userId == getUser().userId || message.confirmer.userId == null">您成为了群主</p>\n                        <p ng-show="message.confirmer.userId != getUser().userId && message.confirmer.userId != null"><a href="javascript:;" class="notify-member-name" ng-bind="message.confirmer | alias" user-info data-user-id="{{message.confirmer.userId}}" data-from-notify="true"></a>成为了新的群主</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'CHANGE_ROLE\']">\n                        <p ng-show="message.confirmer.userId == getUser().userId && message.props.ROLE == \'ROLE_GROUP_MANAGER\'">您成为了管理员</p>\n                        <p ng-show="message.confirmer.userId != getUser().userId && message.props.ROLE == \'ROLE_GROUP_MANAGER\'">群主将<a href="javascript:;" class="notify-member-name" ng-bind="message.confirmer | alias" user-info data-user-id="{{message.confirmer.userId}}" data-from-notify="true"></a>设为了管理员</p>\n\n                        <p ng-show="message.confirmer.userId == getUser().userId && message.props.ROLE == \'ROLE_GROUP_EDITOR\'">您成为了编辑者</p>\n                        <p ng-show="message.confirmer.userId != getUser().userId && message.props.ROLE == \'ROLE_GROUP_EDITOR\'">群主将<a href="javascript:;" class="notify-member-name" ng-bind="message.confirmer | alias" user-info data-user-id="{{message.confirmer.userId}}" data-from-notify="true"></a>设为了编辑者</p>\n\n                        <p ng-show="message.confirmer.userId == getUser().userId && message.props.ROLE == \'ROLE_GROUP_READER\'">您成为了只读者</p>\n                        <p ng-show="message.confirmer.userId != getUser().userId && message.props.ROLE == \'ROLE_GROUP_READER\'">群主将<a href="javascript:;" class="notify-member-name" ng-bind="message.confirmer | alias" user-info data-user-id="{{message.confirmer.userId}}" data-from-notify="true"></a>设为了只读者</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'ENROLLED_IN_ORG\']">\n                        <p ng-show="message.confirmer.userId == getUser().userId">\n                            <a href="javascript:;"\n                              class="notify-member-name"\n                              ng-bind="message.applier | alias"\n                              user-info data-user-id="{{message.applier.userId}}" data-from-notify="true">\n                            </a>\n                            将您加入了该组织\n                        </p>\n                        <p ng-show="message.confirmer.userId !== getUser().userId">\n                            <a href="javascript:;"\n                              class="notify-member-name"\n                              ng-bind="message.confirmer | alias"\n                              user-info data-user-id="{{message.confirmer.userId}}" data-from-notify="true">\n                            </a>\n                            已经加入该组织\n                        </p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'KICKED_OUT_FROM_ORG\']">\n                        <p>您被移出该组织</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'INNER_GRP_RECOVERD\']">\n                        <p>该群已被组织管理员\n                            <a href="javascript:;"\n                               class="notify-member-name"\n                               ng-bind="message.applier | alias"\n                               user-info data-user-id="{{message.applier.userId}}" data-from-notify="true">\n                            </a>\n                            恢复</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'INNER_GRP_ERASED\']">\n                        <p>该群已被组织管理员\n                            <a href="javascript:;"\n                               class="notify-member-name"\n                               ng-bind="message.applier | alias"\n                               user-info data-user-id="{{message.applier.userId}}" data-from-notify="true">\n                            </a>\n                            彻底删除</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'ORG_ROLE_CHANGED\']">\n                        <p ng-if="message.role == ROLES[\'ORG_MANAGER\']">\n                            <a href="javascript:;"\n                               class="notify-member-name"\n                               ng-bind="message.applier | alias"\n                               user-info data-user-id="{{message.applier.userId}}" data-from-notify="true">\n                            </a>\n                            提升您为该组织的管理员\n                        </p>\n                        <p ng-if="message.role == ROLES[\'ORG_USER\']">\n                            <a href="javascript:;"\n                               class="notify-member-name"\n                               ng-bind="message.applier | alias"\n                               user-info data-user-id="{{message.applier.userId}}" data-from-notify="true">\n\n                            </a>\n                            将您降为该组织的普通成员\n                        </p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'ORG_DISMISS\']">\n                        <p>该组织已经被解散</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'ORG_TRANSFER\']">\n                        <p>\n                            <a href="javascript:;"\n                               class="notify-member-name"\n                               ng-bind="message.applier | alias"\n                               user-info data-user-id="{{message.applier.userId}}" data-from-notify="true">\n                            </a>\n                            将该组织转让给了您\n                        </p>\n                    </div>\n                    <div ng-show="checkShowMessage(message.applier.userId, message.type)">\n                        <p ng-show="message.applier.userId != getUser().userId">\n                            <a href="javascript:;" class="notify-member-name" ng-bind="message.applier | alias" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true"></a>\n                            <span>&nbsp;申请加入群：</span>\n                        </p>\n                        <p ng-show="message.applier.userId == getUser().userId">您申请加入群：</p>\n                        <p class="apply-message" ng-bind="message.message"></p>\n                    </div>\n                </div>\n            </div>\n            <div class="item-right">\n                <p class="message-time" ng-bind="formatTime(message.time)"></p>\n                <div class="message-operation">\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'INVITE\']">\n                        <button class="btn" ng-disabled="message.disabled" ng-click="confirmInvite(message)">接受邀请</button>\n                        <button class="btn" ng-disabled="message.disabled" ng-click="ignoreInvite(message)">拒绝</button>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'ACCEPT_INVITE\']">\n                        <p ng-show="message.applier.userId != getUser().userId">已接受邀请</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'IGNORE_INVIT\']">\n                        <p ng-show="message.applier.userId != getUser().userId">已拒绝邀请</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'DELETE_INVITE\']">\n                        <p>该邀请已失效</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'DEACTIVE_APPLY\']">\n                        <p>该请求已失效</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'APPLY\']">\n                        <div ng-if="isInGroup(message.groupId)">\n                            <button class="btn" ng-disabled="message.disabled" ng-click="acceptApplicant(message)">通过验证</button>\n                            <button class="btn" ng-disabled="message.disabled" ng-click="rejectApplicant(message, false)">拒绝</button>\n                        </div>\n                       <!--  <button class="btn" ng-click="rejectApplicant(message, true)">不再接受</button> -->\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'CONFIRM\']">\n                        <p ng-show="message.applier.userId != getUser().userId">已同意</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'REJECT\']">\n                        <p ng-show="message.applier.userId != getUser().userId">已拒绝</p>\n                        <p ng-show="message.applier.userId == getUser().userId">已拒绝您的请求</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'NEVER\']">\n                        <p ng-show="message.applier.userId != getUser().userId">该用户已被禁止加入</p>\n                        <p ng-show="message.applier.userId == getUser().userId">您已被禁止加入该群</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'APPLY_USER_EXIST\']">\n                        <p ng-show="message.applier.userId != getUser().userId">该用户已是该群成员</p>\n                        <p ng-show="message.applier.userId == getUser().userId">您已经是该群成员</p>\n                    </div>\n                    <div ng-if="message.type == NOTIFICATION_TYPE[\'INVITE_USER_EXIST\']">\n                        <p ng-show="message.confirmer.userId != getUser().userId">该用户已是该群成员</p>\n                        <p ng-show="message.confirmer.userId == getUser().userId">您已经是该群成员</p>\n                    </div>\n                </div>\n            </div>\n        </li>\n    </ul>\n    <p class="no-notification" ng-show="noNotification">暂无通知</p>\n</div>\n'),$templateCache.put("pagelet/sidebar/notify/notifyList-dialog.html",'<div class="notification" ng-controller="notifyListCtrl">\n    <ul class="notification-tabs" ng-class="{\'showTask\' : hasOrg}">\n        <li class="notification-tab" ng-click="segment = \'message\'" ng-class="{\'active\' : segment == \'message\' }"><span>我的消息</span><span ng-show="messageNum" ng-bind="messageNum > 10 ? \'10+\' : messageNum" class="unReadMessage"></span> </li>\n        <li class="split"></li>\n        <li class="notification-tab" ng-click="segment = \'notification\'" ng-class="{\'active\' : segment == \'notification\' }"><span>群通知</span><span ng-show="notificationNum" ng-bind="notificationNum > 10 ? \'10+\' : notificationNum" class="unReadMessage"></span></li>\n        <li class="split" ng-if="hasOrg"></li>\n        <li class="notification-tab" ng-show="hasOrg" ng-click="segment = \'tasksNotification\'" ng-class="{\'active\' : segment == \'tasksNotification\' }"><span>任务通知</span><span ng-show="tasksNotificationNum" ng-bind="tasksNotificationNum > 10 ? \'10+\' : tasksNotificationNum" class="unReadMessage"></span></li>\n    </ul>\n    <div class="notification-bd" ng-include="\'pagelet/sidebar/notify/\' + segment + \'.html\'"></div>\n    <div class="loading-style" ng-if="pageLoading"></div>\n</div>\n'),$templateCache.put("pagelet/sidebar/notify/tasksNotification.html",'<div class="message-list" widget-scroller="onScroll(bottom, \'tasks\')">\n    <ul class="message-ul" ng-show="!noNotification">\n        <li ng-repeat="message in taskMessages" class="message-li" ng-mouseenter="message.show = true" ng-mouseleave="message.show = false">\n            <div class="message-item item-right" ng-switch="message.type">\n                <div ng-switch-when="31">\n                    <p class="message-hd">\n                        <span ng-bind="message.applier | alias" class="message-applier" user-info data-user-id="{{message.applier.userId}}" data-from-notify="true" title="{{message.applier | alias}}"></span>\n                        <span>完成了任务</span>\n                        <span class="task-group-right">\n                           <span>来自群：</span>\n                           <span class="message-groupName" ng-bind="message.groupName" title="{{message.groupName}}" ng-click="forward(message.groupId);"></span>\n                        </span>\n                        <span class="message-time" ng-bind="formatTime(message.time)"></span>\n                    </p>\n                    <div class="message-bd">\n                        <span ng-bind="message.taskName"></span>\n                        <span class="task-forward"  ng-show="message.show" ng-click="forwardTask(message)">查看详情</span>\n                    </div>\n                </div>\n                <div ng-switch-when="32">\n                    <p class="message-hd">\n                        <span>以下任务被删除</span>\n                        <span class="task-group-right">\n                           <span>来自群：</span>\n                           <span class="message-groupName" ng-bind="message.groupName" title="{{message.groupName}}" ng-click="forward(message.groupId);"></span>\n                        </span>\n                        <span class="message-time" ng-bind="formatTime(message.time)"></span>\n                    </p>\n                    <div class="message-bd">\n                        <span ng-bind="message.taskName"></span>\n                        <span class="task-forward"  ng-show="message.show" ng-click="forwardTask(message)">查看详情</span>\n                    </div>\n                </div>\n                <div ng-switch-when="33">\n                    <p class="message-hd">\n                        <span>以下任务已经过期</span>\n                        <span class="task-group-right">\n                           <span>来自群：</span>\n                           <span class="message-groupName" ng-bind="message.groupName" title="{{message.groupName}}" ng-click="forward(message.groupId);"></span>\n                        </span>\n                        <span class="message-time" ng-bind="formatTime(message.time)"></span>\n                    </p>\n                    <div class="message-bd">\n                        <span ng-bind="message.taskName"></span>\n                        <span class="task-forward"  ng-show="message.show" ng-click="forwardTask(message)">查看详情</span>\n                    </div>\n                </div>\n                <div ng-switch-when="34">\n                    <p class="message-hd">\n                        <span>收到了新的@提醒</span>\n                        <span class="task-group-right">\n                           <span>来自群：</span>\n                           <span class="message-groupName" ng-bind="message.groupName" title="{{message.groupName}}" ng-click="forward(message.groupId);"></span>\n                        </span>\n                        <span class="message-time" ng-bind="formatTime(message.time)"></span>\n                    </p>\n                    <div class="message-bd">\n                        <span ng-bind="message.taskName"></span>\n                        <span class="task-forward"  ng-show="message.show" ng-click="forwardTask(message)">查看详情</span>\n                    </div>\n                </div>\n                <div ng-switch-when="30">\n                    <p class="message-hd">\n                        <span>收到了一个新任务</span>\n                        <span class="task-group-right">\n                           <span>来自群：</span>\n                           <span class="message-groupName" ng-bind="message.groupName" title="{{message.groupName}}" ng-click="forward(message.groupId);"></span>\n                        </span>\n                        <span class="message-time" ng-bind="formatTime(message.time)"></span>\n                    </p>\n                    <div class="message-bd">\n                        <span ng-bind="message.taskName"></span>\n                        <span class="task-forward"  ng-show="message.show" ng-click="forwardTask(message)">查看详情</span>\n                    </div>\n                </div>\n            </div>\n            <div class="line"></div>\n        </li>\n    </ul>\n    <p class="no-notification" ng-show="noNotification">暂无通知</p>\n</div>\n'),$templateCache.put("pagelet/sidebar/orgTutorial/org-tutorial.html",'<div>\n    <i id="tutorial-close"></i>\n    <div class="tutorial-content">\n        <i class="tutorial-clap"></i>\n        <div>\n            <span class="tutorial-title">恭喜您获得试用资格</span>\n            <span class="tutorial-description">点击“创建组织”现在就体验企业版吧!</span>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/sidebar/showIcon/showIcon-dialog.html",'<div show-icon error-title="个人信息"></div>'),$templateCache.put("pagelet/sidebar/sidebar.html",'<div class="sidebar-container" ng-controller="sidebarCtrl">\n    <div class="sidebar-hd" ng-class="{pc: client.isNative()}">\n        <div class="sidebar-hd-btns">\n            <div class="sidebar-plus" widget-toggle="sidebarGroupVisible" widget-toggle-before="checkOrgLimit()">\n                <svg class="icon-sidebar-plus" title="创建/加入群">\n                    <use class="default" xlink:href="#create_add"/>\n                    <use class="hover" xlink:href="#create_add_hover"/>\n                    <use class="active" xlink:href="#create_add_active"/>\n                </svg>\n                <span class="sidebar-tips">创建/加入</span>\n                <svg class="icon-menu-down">\n                    <use xlink:href="#menu_down"/>\n                </svg>\n                <ul class="menu" widget-toggle-content="right">\n                    <li class="menu-option" ng-click="createGroup()">\n                        创建群\n                    </li>\n                    <li class="menu-option" ng-click="joinGroup()">\n                        加入群\n                    </li>\n                    <li class="menu-option topline" ng-if="ableToCreateOrg" ng-click="createOrganization()">\n                        创建组织\n                    </li>\n                </ul>\n            </div>\n            <div class="sidebar-notify" ng-click="notifyList()">\n                <span shake-interval class="hover-stop shake-constant shake-little">\n                    <svg class="icon-sidebar-notify" title="通知消息">\n                        <use class="default" xlink:href="#notify"/>\n                        <use class="hover" xlink:href="#notify_hover"/>\n                        <use class="active" xlink:href="#notify_active"/>\n                    </svg>\n                    <svg class="notification-unread-icon" ng-show="notificationUnread || taskNotificationUnread || myMessageUnread">\n                        <use xlink:href="#notify_unread">\n                    </svg>                    \n                </span>\n                <span class="sidebar-tips">通知</span>\n            </div>\n            <div class="org-tutorial" ng-if="orgTutorial" org-tutorial></div>\n        </div>\n    </div>\n    <div class="sidebar-bd" ng-class="{pc: client.isPC(), mac: client.isMac()}">\n        <div class="sidebar-groups" widget-scroller ng-class="{gstar: globalStarOn}">\n            <div class="top-groups">\n                <div class="sidebar-top-groups" ng-if="groupTopOn">\n                    <div class="sidebar-top-groups-title"  ng-class="{expanded : showPersonalGroups}">\n                        <i class="icon-expand" ng-class="{expanded : showPersonalGroups}"></i>\n                        <span class="sidebar-my-top-groups">我的加星群</span>\n                    </div>\n                </div>\n                <ul class="sidebar-ul" ng-if="groupTopOn">\n                    <li class="sidebar-li" ng-repeat="group in topGroups" ng-class="{select: group.id == gid()}" ng-click="forwardGroup(group.id);clearUnread(unreads[group.id], group.id)">\n                        <span ng-bind="group.name" class="groupName ellipsis" ng-class="{noOrganization : !hasOrganization, shortName: unreads[group.id] != 0}"></span>\n                        <span ng-click="resetPosition ? clearUnread(unreads[group.id], group.id) : void(0); $event.stopPropagation();" ng-show=\'!!unreads[group.id] && unreads[group.id] != 0\' class="unReadMessage shake-constant shake-little" ng-bind="(unreads[group.id] <= 99 ? unreads[group.id] : \'99+\')" funny-drag></span>\n                    </li>\n                </ul>\n            </div>\n            <div class="divide-line" ng-if="groupTopOn"></div>\n            <ul class="org-groups" ng-if="hasOrganization" ng-class="{groupTop : groupTopOn}">\n                <li ng-repeat="organization in organizations" ng-controller="sidebarOrgGroupsCtrl" class="org">\n                    <div class="org-groups-hd" ng-click="forwardOrg(organization.id)" ng-class="{expanded : showOrgGroups, selected: organization.id == orgId()&&!gid()}">\n                        <svg class="icon-org-expand" ng-click="toggleOrgGroups();$event.stopPropagation();">\n                            <use ng-if="showOrgGroups" xlink:href="#expand"/>\n                            <use ng-if="!showOrgGroups" xlink:href="#collapse"/>\n                        </svg>                        \n                        <div class="sidebar-org-name ellipsis"  title="{{organization.name}}">{{organization.name}}</div>\n                    </div>\n                    <ul id="sidebar-org-group" class="sidebar-ul" ng-if="showOrgGroups">\n                        <li class="sidebar-li" ng-repeat="group in organization.groups" ng-class="{select: group.id == gid()}" ng-click="forwardGroup(group.id);clearUnread(unreads[group.id], group.id)">\n                            <span ng-bind="group.name" class="groupName ellipsis" ng-class="{shortName: unreads[group.id] != 0}"></span>\n                            <span ng-click="resetPosition ? clearUnread(unreads[group.id], group.id) : void(0); $event.stopPropagation();" ng-show=\'!!unreads[group.id] && unreads[group.id] != 0\' class="unReadMessage shake-constant shake-little" ng-bind="(unreads[group.id] <= 99 ? unreads[group.id] : \'99+\')" funny-drag></span>\n                        </li>\n                    </ul>\n                </li>\n            </ul>\n            <div class="divide-line" ng-if="hasOrganization"></div>\n            <div class="personal-groups">\n                <div class="sidebar-personal-groups" ng-if="hasOrganization || groupTopOn">\n                    <div class="sidebar-personal-groups-title"  ng-class="{expanded : showPersonalGroups}">\n                        <svg class="icon-expand" ng-class="{expanded : showPersonalGroups}" ng-click="togglePersonalGroups();$event.stopPropagation();">\n                            <use ng-if="showPersonalGroups" xlink:href="#expand"/>\n                            <use ng-if="!showPersonalGroups" xlink:href="#collapse"/>                           \n                        </svg>\n                        <span class="sidebar-my-personal-groups">我的私人群</span>\n                    </div>\n                </div>\n                <ul class="sidebar-ul" ng-if="showPersonalGroups" ng-class="{noOrg: !(hasOrganization || groupTopOn)}">\n                    <li class="sidebar-li" ng-repeat="group in personalGroups" ng-class="{select: group.id == gid()}" ng-click="forwardGroup(group.id);clearUnread(unreads[group.id], group.id)">\n                        <span ng-bind="group.name" class="groupName ellipsis" ng-class="{noOrganization : !hasOrganization, shortName: unreads[group.id] != 0}"></span>\n                        <span ng-click="resetPosition ? clearUnread(unreads[group.id], group.id) : void(0); $event.stopPropagation();" ng-show=\'!!unreads[group.id] && unreads[group.id] != 0\' class="unReadMessage shake-constant shake-little" ng-bind="(unreads[group.id] <= 99 ? unreads[group.id] : \'99+\')" funny-drag></span>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </div>\n    <div class="sidebar-ft">\n        <div class="sidebar-global-star" ng-if="globalStarOn" ng-click="forwardGlobalStar()">\n            <i class="global-star-icon"></i>\n            <span>加星文件</span>\n        </div>\n        <div class="sidebar-p2p"\n             ng-click="toggleP2P()" ng-if="!orgWithTask">\n            <svg class="p2p-icon">\n                <use xlink:href="#sidebar_p2p"/>\n            </svg>\n            <svg class="p2p-unread-icon" ng-if="unread">\n                <use xlink:href="#notify_unread"/>\n            </svg>\n            <span ng-if="!unread">云协作私聊</span>\n            <span ng-if="unread">您有新的未读消息</span>\n        </div>\n        <div class="has-task" ng-if="orgWithTask">\n            <div class="sidebar-p2p"\n                 ng-click="toggleP2P()" >\n                <svg class="p2p-icon">\n                    <use xlink:href="#sidebar_p2p"/>\n                </svg>\n                <svg class="p2p-unread-icon" ng-if="unread">\n                    <use xlink:href="#notify_unread"/>\n                </svg>\n                <span>我的私聊</span>\n            </div>\n            <div class="sidebar-task" ng-click="forwardMyTask()">\n                <svg class="task-icon">\n                    <use xlink:href="#sidebar_task"/>\n                </svg>\n                <span>我的任务</span>\n            </div>          \n        </div>\n        <div class="p2p-container" ng-show="showP2P" ng-include="\'pagelet/chat/p2p/p2p.html\'"></div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/sidebar/userInfo/userInfo-dialog.html",'<div class="container user-info" ng-controller="userInfoDialogCtrl">\n    <div ng-show="isMyself">\n        <div class="user-info-hd">\n            <span class="items-key">头像</span>\n            <div class="items-value">\n                <div class="user-info-item-left">\n                    <img ng-src="{{getUser().photo | photo}}" alt="" class="userIcon" widget-preview="image" title="点击查看高清头像"/>\n                </div>\n                <div class="user-info-item-right">\n                    <button class="changeIcon" widget-upload="\'image\'"\n                        upload-type="\'image\'"\n                        upload-select="onImageSelect(tasks)">\n                        上传新头像\n                    </button>\n                    <span class="upload-hint">支持JPG、PNG、GIF格式，小于2MB</span>\n                </div>\n            </div>\n        </div>\n        <div class="currentUserInfo-upload user-info-bd">\n            <div class="item">\n                <span class="items-key">账号</span><span class="items-value" ng-bind="userId"></span>\n            </div>\n            <div class="item">\n                <span class="items-key">昵称</span><input type="text" class="items-value float-right" max-input-length="32" ng-model="userInfo.name" />\n            </div>\n            <p class="nickname-used error" ng-show="errorShow">该昵称已被占用</p>\n            <div class="item">\n                <span class="items-key">性别</span>\n                    <span class="items-value">\n                        <label>\n                            <input type="radio" ng-model="userInfo.sex" value="0" />\n                            <i class="label-radio"></i> \n                            男\n                        </label> \n                        <label>\n                            <input type="radio" ng-model="userInfo.sex" value="1" />\n                            <i class="label-radio"></i>\n                            女\n                        </label> \n                        <label>\n                            <input type="radio" ng-model="userInfo.sex" value="2" />\n                            <i class="label-radio"></i>\n                            保密\n                        </label>\n                    </span>\n            </div>\n            <div class="item">\n                <span class="items-key">地区</span>\n                <div class="items-value float-right">\n                    <ui-select class="styled-select" ng-model="locationData.selected" theme="selectize">\n                        <ui-select-match>\n                            <span ng-bind="$select.selected.name"></span>\n                        </ui-select-match>\n                        <ui-select-choices repeat="p in locationData">\n                            <span ng-bind="p.name"></span>\n                        </ui-select-choices>\n                    </ui-select>\n                    <ui-select class="styled-select city" ng-model="locationData.selected.cities.selected" theme="selectize">\n                        <ui-select-match>\n                            <span ng-bind="$select.selected"></span>\n                        </ui-select-match>\n                        <ui-select-choices repeat="c in locationData.selected.cities">\n                            <span ng-bind="c"></span>\n                        </ui-select-choices>\n                    </ui-select>                \n                </div>\n            </div>\n            <div class="item align-top">\n                <span class="items-key">签名</span><textarea type="text" class="items-value float-right user-info-signature" max-input-length="60" ng-model="userInfo.description"></textarea>\n            </div>\n        </div>\n    </div>\n    <div ng-show="!isMyself">\n         <div class="user-info-hd">\n            <span class="items-key">头像</span>\n            <div class="items-value">\n                <div class="user-info-item-left">\n                    <img ng-src="{{userInfo.photo | photo}}" alt="" class="userIcon" widget-preview="image" title="点击查看高清头像"/>\n                    <span class="user-info-nickname" ng-bind="userInfo | alias" title="{{userInfo | alias}}"></span>\n                </div>\n            </div>\n            <div class="p2p-new" title="开始聊天吧!" ng-click="newP2PDialog(userInfo)">\n                    <svg class="icon-p2p">\n                        <use xlink:href="#userinfo_p2p"/>\n                    </svg>\n                    私聊\n            </div>\n        </div>\n        <div class="user-info-bd">\n            <div class="item">\n                <span class="items-key">账号</span><span class="items-value" ng-bind="userId" title="{{userId}}"></span>\n            </div>\n            <div class="item"  ng-show="!fromNotify">\n                <span class="items-key">昵称</span><span class="items-value" ng-bind="userInfo.name"></span>\n            </div>\n            <div class="item" ng-show="!fromNotify">\n                <span class="items-key">备注</span><input type="text" class="items-value float-right" max-input-length="32" ng-model="aliasName" />\n            </div>\n            <div class="item">\n                <span class="items-key">性别</span>\n                <p class="items-value" ng-switch="userInfo.sex">\n                    <span ng-switch-when="0">男</span>\n                    <span ng-switch-when="1">女</span>\n                    <span ng-switch-when="2">未知</span>\n                </p>\n            </div>\n            <div class="item">\n                <span class="items-key">地区</span><span class="items-value" ng-bind="userInfo.location"></span>\n            </div>\n            <div class="item">\n                <span class="items-key">签名</span><span class="items-value other-info-signature" ng-bind="userInfo.description | cut:60" title="{{userInfo.description | cut:60}}"></span>\n            </div>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/table/confirm.html",'<p class="confirm">您的表格尚未保存，是否保存？</p>'),$templateCache.put("pagelet/table/diffview/tableDiff.html",'<div class="tablediff" ng-controller="tableDiffCtrl">\n    <div class="history-container">\n        <div class="history">\n            <div class="history-title">\n                <div class="title" ng-switch="curVersion == 1">\n                    <span ng-switch-when="false"  ng-bind="\'第 \'+ curVersion +\' 版与第 \' + (curVersion - 1) + \' 版的比较结果\'"></span>\n                    <span ng-switch-when="true"  ng-bind="\'第 \'+ curVersion +\' 版\'"></span>\n                </div>\n            </div>\n            <div class="name" ng-bind-html="diffTitle">\n            </div>\n            <div class="content">\n                <iframe ng-src="{{diffUrl}}"\n                        height="100%" width="100%" frameborder="0"></iframe>\n            </div>\n        </div>\n        <div class="history-meta">\n            <div class="history-meta-title">\n                <span>历史版本</span>\n            </div>\n            <div class="history-meta-ul" widget-scroller>\n            <ul>\n                <li ng-repeat=\'tableHistory in tableHistoryList\'\n                    class="history-meta-li"\n                    ng-class="{active: tableHistory.version == activeVersion}">\n                    <div class="table-history-item"\n                         ng-class="{active: tableHistory.version == activeVersion && !activePersonalId}"\n                         ng-click="changeVersion(tableHistory.version)">\n                        <div class="photos" ng-switch="tableHistory.revisors.length">\n                            <div class="mode-1" ng-switch-when="1">\n                                <img class="photo" ng-src="{{tableHistory.revisors[0].photo}}"/>\n                            </div>\n                            <div class="mode-2" ng-switch-when="2">\n                                <img class="small-photo photo-1" ng-src="{{tableHistory.revisors[0].photo}}"/>\n                                <img class="small-photo photo-2" ng-src="{{tableHistory.revisors[1].photo}}"/>\n                            </div>\n                            <div class="mode-3" ng-switch-when="3">\n                                <img class="small-photo photo-1" ng-src="{{tableHistory.revisors[0].photo}}"/>\n                                <img class="small-photo photo-3" ng-src="{{tableHistory.revisors[2].photo}}"/>\n                                <img class="small-photo photo-2" ng-src="{{tableHistory.revisors[1].photo}}"/>\n                            </div>\n                            <div class="mode-4" ng-switch-default>\n                                <img class="small-photo photo-1" ng-src="{{tableHistory.revisors[0].photo}}"/>\n                                <img class="small-photo photo-2" ng-src="{{tableHistory.revisors[1].photo}}"/>\n                                <img class="small-photo photo-3" ng-src="{{tableHistory.revisors[2].photo}}"/>\n                                <img class="small-photo photo-4" ng-src="{{tableHistory.revisors[3].photo}}"/>\n                            </div>\n                        </div>\n                        <div class="table-history-info">\n                            <!--<span class="table-history-version" ng-bind="\'第\' + tableHistory.version + \'版\'"></span>-->\n                            <div>\n                                <span class="table-history-authors ellipsis" ng-bind="tableHistory.revisorsName">\n                                </span>\n                                <span ng-if="!$last" class="operation">修改了表格</span>\n                                <span ng-if="$last" class="operation">创建了表格</span>\n                                <svg class="play"\n                                   ng-if="tableHistory.version == activeVersion && changeVersionReady"\n                                   ng-click="switchAction($event, tableHistory.version)">\n                                   <use ng-if="!playing" class="default" xlink:href="#play"/>\n                                   <use ng-if="!playing" class="hover" xlink:href="#play_hover"/>\n                                   <use ng-if="playing" class="default" xlink:href="#stop"/>\n                                   <use ng-if="playing" class="hover" xlink:href="#stop_hover"/>\n                               </svg>\n                            </div>\n                            <div>\n                                <span class="table-history-date"  ng-bind="tableHistory.date | date:\'yyyy-MM-dd HH:mm\'"></span>\n                                <span class="version" ng-bind="\'第\'+ tableHistory.version + \'版\'"></span>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div ng-if="tableHistory.version == activeVersion && tableHistory.revisors.length > 1">\n                        <div ng-repeat="revisor in tableHistory.revisors"\n                             ng-click="changePerson(revisor.id)"\n                             class="personal-change"\n                             ng-class="{active: revisor.id == activePersonalId,\n                                        last: $last}">\n                            <div class="wrapper">\n                                <img ng-src="{{revisor.photo}}"/>\n                                <span class="ellipsis">{{revisor.name}}</span> 的修改\n                            </div>\n                        </div>\n                    </div>\n                </li>\n            </ul>\n            </div>\n        </div>\n    </div>\n    <div class="diff-tip"><span class="green"></span>绿色表示与前一版本比较的新增内容&nbsp;&nbsp;&nbsp;&nbsp;<span class="red"></span>红色表示与前一版本比较的删除内容</div>\n</div>'),$templateCache.put("pagelet/table/message-tip.html","<span ng-if='tip.operation == 0' ng-bind=\"tip.user.name + '：发送了表格' \"></span>\n<span ng-if='tip.operation == 1' ng-bind=\"tip.user.name + '：新建了表格' \"></span>\n<span ng-if='tip.operation == 2' ng-bind=\"tip.user.name + '：修改了表格' \"></span>\n<span ng-if='tip.operation == 3' ng-bind=\"tip.user.name + '：删除了表格' \"></span>\n<span ng-if='tip.operation == 5' ng-bind=\"tip.user.name + '：新建了表格' \"></span>\n<span ng-if='tip.operation == 8' ng-bind=\"tip.user.name + '：还原了表格' \"></span>\n"),$templateCache.put("pagelet/table/message.html",'<div ng-controller="tableMessageCtrl">\n    <div class="msg-photo">\n        <div class="photos" ng-switch="msg.coRevisors.length">\n            <div class="mode-1" ng-switch-when="1"\n                 user-info data-user-id="{{msg.coRevisors[0].userId}}">\n                <img class="photo" ng-src="{{msg.coRevisors[0].photo | photo}}"/>\n            </div>\n            <div class="mode-2" ng-switch-when="2">\n                <img class="small-photo photo-1" ng-src="{{msg.coRevisors[0].photo | photo}}"/>\n                <img class="small-photo photo-2" ng-src="{{msg.coRevisors[1].photo | photo}}"/>\n            </div>\n            <div class="mode-3" ng-switch-when="3">\n                <img class="small-photo photo-1" ng-src="{{msg.coRevisors[0].photo | photo}}"/>\n                <img class="small-photo photo-3" ng-src="{{msg.coRevisors[2].photo | photo}}"/>\n                <img class="small-photo photo-2" ng-src="{{msg.coRevisors[1].photo | photo}}"/>\n            </div>\n            <div class="mode-4" ng-switch-default>\n                <img class="small-photo photo-1" ng-src="{{msg.coRevisors[0].photo | photo}}"/>\n                <img class="small-photo photo-2" ng-src="{{msg.coRevisors[1].photo | photo}}"/>\n                <img class="small-photo photo-3" ng-src="{{msg.coRevisors[2].photo | photo}}"/>\n                <img class="small-photo photo-4" ng-src="{{msg.coRevisors[3].photo | photo}}"/>\n            </div>\n        </div>\n        <i class="operation-icon" ng-class="::{\'operation-create-icon\': msg.operation == 1, \'operation-edit-icon\': msg.operation == 2, \'operation-delete-icon\': msg.operation == 3, \'operation-rename-icon\': msg.operation == 7, \'operation-recover-icon\': msg.operation == 8}"></i>\n    </div>\n    <div class="content-node">\n        <div class="content-head selectable">\n            <div class="time" ng-bind="::(msg.time | date:\'HH:mm\')"></div>\n            <div class="username-wrapper" ng-repeat="revisor in msg.coRevisors">\n                <span ng-if="::($index < 4)" class="username" user-info data-user-id="{{revisor.userId}}">{{revisor.name}}</span>\n                <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{revisor.userId}}\']}"></i></a>\n                <span ng-if="::(!$last && $index < 3)">、</span>\n                <span ng-if="::($index == 4)">等</span>               \n            </div>\n            <div class="operation">\n                <span ng-if=\'::(msg.operation == 0)\'>发送了表格</span>\n                <span ng-if=\'::(msg.operation == 1)\'>新建了表格</span>\n                <span ng-if=\'::(msg.operation == 2)\'>修改了表格</span>\n                <span ng-if=\'::(msg.operation == 3)\' class="delete">删除了表格</span>\n                <span ng-if=\'::(msg.operation == 7)\'>重命名了表格</span>\n                <span ng-if=\'::(msg.operation == 8)\'>还原了表格</span>\n            </div>\n        </div>\n        <div class="bubble">\n            <div class="bubble-node bubble-file-node" ng-class="::{\'bubble-delete-node\': msg.operation == 3}">\n                <div class="fileinfo" ng-if="::(msg.operation != 3)">\n                    <i class="fileicon active" file-icon="file" file-size="large"\n                            file-open\n                            file-id="msg.fileId"\n                            file-name="msg.title | fileName"\n                            group-id="gid()"\n                        ></i>\n                    <div class="filemeta">\n                        <span class="name active selectable"\n                            ng-bind="::(msg.title | fileName)"\n                            file-open\n                            file-id="msg.fileId"\n                            file-name="msg.title | fileName"\n                            group-id="gid()"\n                            ></span>\n                        <span class="revision active" ng-bind="::(\'第 \' + msg.version + \' 版\')"\n                              ng-if="msg.version > 0"\n                              permission-check="table.trace"\n                              file-open-revision\n                              file-id="msg.fileId"\n                              file-version="msg.version"\n                              group-id="gid()"></span>\n                    </div>\n                </div>\n                <div class="fileinfo" ng-if="::(msg.operation == 3)">\n                    <i class="fileicon" file-icon="file" file-size="large" file-grey="true"\n                        ></i>\n                    <div class="filemeta">\n                        <span class="name selectable delete" ng-bind="::(msg.title | fileName)"\n                            ></span>\n                        <span class="revision"\n                              ng-if="::(msg.version > 0)"\n                              permission-check="table.trace"\n                              ng-bind="::(\'第 \' + msg.version + \' 版\')"></span>\n                    </div>\n                </div>\n                <div ng-if="::(msg.operation != 3)">\n                    <div class="bubble-split">\n                    </div>\n                    <div class="fileaction"\n                         file-open-exist-dir\n                         file-id="msg.fileId"\n                         file-name="msg.title | fileName"\n                         group-id="gid()">\n                        <svg class="folder-opener">\n                            <use class="default" xlink:href="#folder_opener"/>\n                            <use class="hover" xlink:href="#folder_opener_hover"/>\n                        </svg>\n                        <span class="fileaction-item">打开文件夹</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/table/table.html",'<div class="detail ytable"\n     ng-class="{nocomment:file==null,max:max}"\n     ng-controller="tableCtrl">\n    <div class="detail-hd">\n        <span class="back" ng-click="file==null ? quit() : saveAndQuit()" ng-show="!fullScreen">\n            <svg class="icon-back">\n                <use xlink:href="#back"/>\n            </svg>\n            返回\n        </span>\n        <div class="title selectable">\n            <input class="name-input"\n                   type="text"\n                   maxlength="240"\n                   ng-model="title"\n                   widget-focus="focusTitle"\n                   file-permission-check="table.edit"\n                   file-permission-file="file" placeholder="点击此处输入标题"/>\n            <span ng-bind="title"\n                  file-permission-check="!table.edit"\n                  file-permission-file="file"></span>\n<!--             <span class="rev"\n                  ng-show="file != null && maxVersion > 0"\n                  ng-click="explorer.openRevision(file)">\n                    第 {{maxVersion}} 版\n            </span> -->\n        </div>\n        <button class="detail-btn" ng-click="saveAndQuit()" title="发布"\n                ng-disabled="saving" ng-show="file==null">\n            <svg class="btn-icon">\n              <use class="default" xlink:href="#detail_release"/>\n              <use class="hover" xlink:href="#detail_release_hover"/>\n            </svg>\n            <span class="btn-text" ng-if="!saving">发布</span>\n            <span class="btn-text" ng-if="saving">正在发布</span>\n        </button>\n        <div class="detail-hd-right">\n            <div file-detail-tools="file"\n                 tools-close="quit()"\n                 tools-open-window="!fullScreen"\n                 show-info-revision="true"\n                 table-version="maxVersion"></div>\n        </div>\n    </div>\n    <p file-permission-check="!table.edit"\n          file-permission-file="file"\n          file-permission-need-readonly="true"\n          ng-if="file != null"\n          class="readonly-tip">\n          该文件为只读，仅群管理员以上可修改\n    </p>\n    <div class="detail-bd">\n        <div>\n            <p class="info" ng-show="meta">\n                <span class="meta-item" ng-bind="\'创建时间：\' + (file.createDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-item" ng-bind="\'修改时间：\' + (file.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n                <span class="meta-path-prefix">所在位置： </span>\n                <span class="meta-path" ng-bind="filePath" title="{{filePath}}" ng-click="onOpenFolder(file.id)"></span>\n            </p>\n        </div>\n        <div class="content" ng-class="{expanded: meta}">\n            <iframe id="{{token}}"\n                    ng-if="tableUrl!=null"\n                    ng-src="{{tableUrl}}"\n                    frameborder="0"\n                    table-editor/>\n        </div>\n    </div>\n    <div ng-if="file" class="detail-aside">\n        <div>\n            <div class="comment-hd">\n                <span class="comment-title">评论</span>\n                <div class="toggle-comment" title="关闭评论" ng-click="$parent.max = !$parent.max; $event.stopPropagation()">\n                    <svg class="icon-close">\n                        <use xlink:href="#close"/>\n                    </svg>\n                </div>\n            </div>\n            <div comment\n                 type="file"\n                 file="file"\n                 entry-id="{{file.id}}"\n                 comment-id="{{commentId}}"\n                 sum="{{file.comments}}"\n                 get-user="getUser()"\n                 user-id="{{userId}}"\n                 file-token="token">\n            </div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/task/archivedTasks.html",'<div class="archived-tasks tasks-container" ng-controller="archivedTasksCtrl">\n    <div class="archived-tasks-hd">\n        <a href="/group/{{launcher.getGroup().id}}/tasks">\n            <svg><use xlink:href="#back"></use></svg>\n            返回全部任务\n        </a>\n    </div>\n    <div class="task-container">\n        <ul ng-if="archivedTaskLists.length > 0">\n            <div widget-scroller class="scroll-container">\n                <li ng-repeat="list in archivedTaskLists" task-list="list" mode="readOnly"></li>\n            </div>\n        </ul>\n        <div ng-if="archivedTaskLists.length === 0" class="blank">\n            <svg>\n                <use xlink:href="#blank_list"/>\n            </svg>\n            <p>目前没有被归档的任务</p>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/task/directive/taskAside.html",'<div class="task-aside" ng-class="{active: show}">\n    <a class="close" href="/group/{{ mode == \'myTasks\' ? \'tasks\' : (asideMode ==\'archivedTasks\' ? launcher.getGroup().id + \'/archivedTasks\' : launcher.getGroup().id + \'/tasks\') }}" role="button"></a>\n    <div ng-if="show && task">\n        <div task-item="task" mode="detail" task-mode="myTasks" ng-if="asideMode==\'myTasks\'"></div>\n        <div task-item="task" mode="readOnly" task-mode="archivedTasks" ng-if="asideMode==\'archivedTasks\'"></div>\n        <div task-item="task" mode="detail" ng-if="!asideMode"></div>\n    </div>\n    <div ng-if="show && list">\n        <div task-list="list" mode="detail" in-aside="true" ng-if="!(asideMode==\'archivedTasks\')"></div>\n        <div task-list="list" mode="readOnly" in-aside="true" ng-if="asideMode==\'archivedTasks\'"></div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/task/directive/taskItem.html",'<div class="task-item" ng-if="!mode" ng-class="{\'finished\' : task.complete && !inComplete}">\n    <label class="task-checkbox" ng-checked="task.complete" ng-class="{active: task.complete}" ng-click="toggleComplete()">\n        <svg><use xlink:href="#task_complete"/></svg>\n    </label>\n    <div class="task-item-mask" ng-if="task.complete && !inComplete"></div>\n    <svg class="task-item-urgent" ng-if="task.priority">\n        <use class="unfinished" xlink:href="#task_urgent"/>\n        <use class="finished" xlink:href="#task_urgent_finished"/>\n    </svg>\n    <a class="task-item-title" ng-if="!(taskMode == \'myTasks\')" href="/group/{{launcher.getGroup().id}}/tasks/task-{{ task.id }}">{{ task.title }}</a>\n    <a class="task-item-title" ng-if="taskMode == \'myTasks\'" href="/group/tasks/task-{{ task.id }}-{{task.gid}}">{{ task.title }}</a>\n    <span class="task-item-meta" ng-if="task.executor">\n        <svg><use xlink:href="#task_assignee"/></svg>\n        {{(task.executor || task.executorId) | alias }}\n    </span>\n    <span class="task-item-meta" ng-if="task.expectFinishTime" ng-class="{\'overdue\': isOverdue(task.expectFinishTime), \'finished\': task.complete}">\n        <svg><use xlink:href="#task_date"/></svg>\n        {{ task.expectFinishTime | date:\'yyyy.MM.dd\' }}\n    </span>\n    <span class="task-item-group-list" ng-if="taskMode == \'myTasks\'">\n        <a class="task-item-meta" href="/group/{{task.gid}}/tasks">{{task.groupName}} . </a>\n        <a class="task-item-meta" href="/group/{{task.gid}}/tasks/task-{{task.id}}">{{task.listName}}</a>\n    </span>\n</div>\n<div class="task-item" ng-if="mode == \'readOnly\' && !taskMode">\n    <label class="task-checkbox" ng-checked="task.complete" ng-class="{active: task.complete}">\n        <svg><use xlink:href="#task_complete"/></svg>\n    </label>\n    <div class="task-item-mask" ng-if="task.complete && !inComplete"></div>\n    <a class="task-item-title" ng-if="taskMode == \'myTasks\'" href="/group/tasks/task-{{ task.id }}-{{task.gid}}">{{ task.title }}</a>\n    <svg class="task-item-urgent" ng-if="task.priority">\n        <use class="unfinished" xlink:href="#task_urgent"/>\n        <use class="finished" xlink:href="#task_urgent_finished"/>\n    </svg>\n    <a class="task-item-title" href="/group/{{launcher.getGroup().id}}/archivedTasks/task-{{ task.id }}">{{ task.title }}</a>\n    <span class="task-item-meta" ng-if="task.executor">\n        <svg><use xlink:href="#task_assignee"/></svg>\n        {{ task.executor | alias }}\n    </span>\n    <span class="task-item-meta" ng-if="task.expectFinishTime" ng-class="{\'overdue\': isOverdue(task.expectFinishTime), \'finished\': task.complete}">\n        <svg><use xlink:href="#task_date"/></svg>\n        {{ task.expectFinishTime | date }}\n    </span>\n</div>\n<div class="task-item task-item-detail" ng-if="mode == \'readOnly\' && taskMode == \'archivedTasks\'">\n    <header>\n        <a href="/group/{{ launcher.getGroup().id }}/archivedTasks/list-{{ task.listId }}"  ng-if="task.listId !== -1" class="item-back-list">\n            <svg><use xlink:href="#back"></use></svg>\n            查看所在任务清单\n        </a>\n        <label class="task-checkbox" ng-class="{active: task.complete}">\n            <svg><use xlink:href="#task_complete"/></svg>\n        </label>\n        <span>\n            <span class="task-item-detail-title">{{ task.title }}</span>\n        </span>\n    </header>\n    <div class="task-item-detail-info">\n        <label><svg><use xlink:href="#task_assignee"/></svg> 指派对象：</label>\n        <div class="task-item-toggle">\n            <span ng-if="task.executor">{{ task.executor | alias }}</span>\n            <span ng-if="!task.executor">未指派</span>\n        </div>\n    </div>\n    <div class="task-item-detail-info">\n        <label><svg><use xlink:href="#task_date"/></svg> 截止时间：</label>\n        <div class="task-item-toggle">\n            <span ng-if="task.expectFinishTime" ng-class="{\'overdue\': isOverdue(task.expectFinishTime)}">{{ task.expectFinishTime | date:\'yyyy.MM.dd\' }}</span>\n            <span ng-if="!task.expectFinishTime">未设置</span>\n        </div>\n    </div>\n    <div class="task-item-detail-info">\n        <label><svg><use xlink:href="#task_priority"/></svg> 优先级：</label>\n        <div class="task-item-toggle">\n            <span ng-if="task.priority == 0">普通</span>\n            <span ng-if="task.priority == 1">紧急</span>\n            <span ng-if="task.priority != 0 && task.priority != 1">未设置</span>\n        </div>\n    </div>\n\n    <div class="task-item-detail-tab">\n        <div ng-class="{active: tab === \'comments\'}" ng-click="tab = \'comments\'"><svg><use xlink:href="#task_comment"/></svg> 相关讨论</div>\n        <div ng-class="{active: tab === \'history\'}" ng-click="tab = \'history\';getOperationList()"><svg><use xlink:href="#task_log"/></svg> 操作日志</div>\n    </div>\n    <div class="task-item-detail-comments" ng-if="tab === \'comments\'">\n        <div comment\n             type="task"\n             entry-id="{{task.id}}"\n             sum="{{task.commentsNum}}"\n             user-id="{{userId}}"\n             group-id="{{task.gid}}">\n        </div>\n    </div>\n    <ul class="task-item-detail-history" ng-if="tab === \'history\'">\n        <li ng-repeat="operation in task.operations" task-operation="operation"></li>\n    </ul>\n</div>\n<div class="task-item task-item-detail" ng-if="mode === \'detail\'">\n    <header>\n        <a href="/group/{{ launcher.getGroup().id }}/tasks/list-{{ task.listId }}"  ng-if="task.listId !== -1" class="item-back-list">\n            <svg><use xlink:href="#back"></use></svg>\n            查看所在任务清单\n        </a>\n        <label class="task-checkbox" ng-class="{active: task.complete}" ng-click="toggleComplete()">\n            <svg><use xlink:href="#task_complete"/></svg>\n        </label>\n        <div class="task-item-mask" ng-if="isTogglingComplete && !inComplete"></div>\n        <span ng-hide="isEditingTitle">\n            <span class="task-item-detail-title" ng-click="editTitle()">{{ task.title }}</span>\n            <span class="task-op-more" ng-class="{\'hasParentList\': task.listId !== -1}" widget-toggle="false">\n                <svg><use xlink:href="#task_op_more"/></svg>更多\n                <ul class="widget-menu" widget-toggle-content="right">\n                    <li class="widget-menu-item" title="删除任务" ng-click="remove()"><svg class="task-list-detail-remove"><use xlink:href="#task_del"/></svg>删除任务</li>\n                </ul>\n            </span>            \n        </span>\n        <div ng-show="isEditingTitle">\n            <input class="form-control-task" type="text" placeholder="输入任务名称"\n                widget-auto-focus\n                widget-focus="isEditingTitle === true"\n                ng-model="task.title"\n                ng-model-options="{updateOn:\'blur\'}"\n                ng-blur="editDoneTitle()"\n                ng-change="saveTitle()"\n            >\n        </div>\n    </header>\n    <div class="task-item-detail-info">\n        <label><svg><use xlink:href="#task_assignee"/></svg> 指派对象：</label>\n        <div class="task-item-toggle" widget-toggle="false">\n            <span ng-if="task.executor">{{ task.executor | alias }}</span>\n            <span ng-if="!task.executor">未指派</span>\n            <svg class="arrow"><use xlink:href="#menu_down"/></svg>\n            <ul class="widget-menu assign" widget-toggle-content>\n                <li class="widget-menu-item" ng-click="changeAssignee()">无指派</li>\n                <li class="widget-menu-item task-assignee-menu-item" ng-repeat="member in getMembers()" ng-click="changeAssignee(member)">\n                    <img ng-src="{{ member.photo }}" width="16" height="16">\n                    <span>{{ member.name }}</span>\n                </li>\n            </ul>\n            <!--\n            <div task-select-member widget-toggle-content class="widget-menu">\n            </div> -->\n        </div>\n    </div>\n    <div class="task-item-detail-info">\n        <label><svg><use xlink:href="#task_date"/></svg> 截止时间：</label>\n        <div class="task-item-toggle" widget-toggle="false">\n            <span ng-if="task.expectFinishTime">{{ task.expectFinishTime | date:\'yyyy.MM.dd\' }}</span>\n            <span ng-if="!task.expectFinishTime">截止时间</span>\n            <svg class="arrow"><use xlink:href="#menu_down"/></svg>\n            <div class="widget-menu" widget-toggle-content>\n                <div class="task-date-picker" date-picker="task.selectedFinishTime" view="date" min-date="minDate" min-view="date" max-view="date" auto-close="true" ng-click="preventDatePickerHide($event)"></div>\n            </div>\n        </div>\n    </div>\n    <div class="task-item-detail-info">\n        <label><svg><use xlink:href="#task_priority"/></svg> 优先级：</label>\n        <div class="task-item-toggle" widget-toggle="false">\n            <span ng-if="task.priority == 0">普通</span>\n            <span ng-if="task.priority == 1">紧急</span>\n            <svg class="arrow"><use xlink:href="#menu_down"/></svg>\n            <ul class="widget-menu" widget-toggle-content>\n                <li class="widget-menu-item" ng-click="changePriority(0)">普通</li>\n                <li class="widget-menu-item" ng-click="changePriority(1)">紧急</li>\n            </ul>\n        </div>\n    </div>\n    <!--\n    <div class="task-item-detail-info">\n        <label><svg><use xlink:href="#task_attach"/></svg> 附件：</label>\n        <div ng-hide="task.attach" style="width:60px" widget-upload="\'content\'" upload-type="\'all\'" upload-select="uploadAttach(tasks, task)">添加附件</div>\n        <div ng-show="task.attach"><button type="button" ng-click="removeAttach(task)">删除附件：{{ task.attach.name }}</button></div>\n    </div>\n    -->\n\n    <div class="task-item-detail-tab">\n        <div ng-class="{active: tab === \'comments\'}" ng-click="tab = \'comments\'"><svg><use xlink:href="#task_comment"/></svg> 相关讨论</div>\n        <div ng-class="{active: tab === \'history\'}" ng-click="tab = \'history\';getOperationList()"><svg><use xlink:href="#task_log"/></svg> 操作日志</div>\n    </div>\n    <div class="task-item-detail-comments" ng-if="tab === \'comments\'">\n        <div comment\n             type="task"\n             entry-id="{{task.id}}"\n             sum="{{task.commentsNum}}"\n             user-id="{{userId}}"\n             group-id="{{task.gid}}">\n        </div>\n    </div>\n    <ul class="task-item-detail-history" ng-if="tab === \'history\'">\n        <li ng-repeat="operation in task.operations" task-operation="operation"></li>\n    </ul>\n</div>\n\n<form class="task-item is-edit" ng-if="mode === \'edit\'" ng-submit="save()">\n    <div class="form-group-task">\n        <label class="task-checkbox" ng-class="{active: task.complete, disabled: true}">\n            <svg><use xlink:href="#task_complete"/></svg>\n        </label>\n        <input type="text" placeholder="任务名称" widget-auto-focus widget-focus="focus === true" ng-model="task.title">\n        <div class="task-item-toggle" widget-toggle="false">\n            <svg><use xlink:href="#task_priority"/></svg>\n            <span ng-switch="task.priority">\n                <span ng-switch-when="undefined">优先级</span>\n                <span ng-switch-when="0">普通</span>\n                <span ng-switch-when="1">紧急</span>\n            </span>\n            <svg class="arrow"><use xlink:href="#menu_down"/></svg>\n            <ul class="widget-menu" widget-toggle-content>\n                <li class="widget-menu-item" ng-click="changePriority(0)">普通</li>\n                <li class="widget-menu-item" ng-click="changePriority(1)">紧急</li>\n            </ul>\n        </div>\n        <div class="task-item-toggle" widget-toggle="false">\n            <svg><use xlink:href="#task_assignee_center"/></svg>\n            <span ng-if="task.executor">{{ task.executor | alias }}</span>\n            <span ng-if="!task.executor">未指派</span>\n            <svg class="arrow"><use xlink:href="#menu_down"/></svg>\n            <ul class="widget-menu assign" widget-toggle-content>\n                <li class="widget-menu-item" ng-click="changeAssignee()">无指派</li>\n                <li class="widget-menu-item task-assignee-menu-item" ng-repeat="member in getMembers()" ng-click="changeAssignee(member)">\n                    <img ng-src="{{ member.photo }}" width="16" height="16">\n                    <span>{{ member.name }}</span>\n                </li>\n            </ul>\n            <!--\n            <div task-select-member widget-toggle-content class="widget-menu">\n            </div> -->\n        </div>\n        <div class="task-item-toggle" widget-toggle="false">\n            <svg><use xlink:href="#task_date_center"/></svg>\n            <span ng-if="task.expectFinishTime">{{ task.expectFinishTime | date:\'yyyy.MM.dd\' }}</span>\n            <span ng-if="!task.expectFinishTime">截止时间</span>\n            <svg class="arrow"><use xlink:href="#menu_down"/></svg>\n            <div class="widget-menu" widget-toggle-content="right">\n                <div class="task-date-picker" date-picker="task.selectedFinishTime" min-date="minDate" view="date" min-view="date" max-view="date" auto-close="true" ng-click="preventDatePickerHide($event)"></div>\n            </div>\n        </div>\n\n    </div>\n    <div class="form-group-task">\n        <button class="btn btn-task-primary" type="submit" ng-disabled="isAdding || !task.title">添加任务</button>\n        <button class="btn btn-task-default" type="button" ng-click="cancel()">取消</button>\n    </div>\n</form>'),$templateCache.put("pagelet/task/directive/taskList.html",'<div class="task-list" ng-if="!mode">\n    <h3 class="task-list-title"><a href="/group/{{ launcher.getGroup().id }}/tasks/list-{{ list.id }}">{{ list.title }}</a></h3>\n    <ul>\n        <li ng-repeat="task in list.tasks" task-item="task"></li>\n        <li ng-show="isAdding" task-item mode="edit" list-id="list.id" focus="isAdding"></li>\n    </ul>\n    <div class="task-list-footer" ng-hide="isAdding || list.id == -1 || isFilterOpen">\n        <span role="button" ng-click="addTask()"><svg><use xlink:href="#task_add"/></svg> 添加任务到清单</span>\n    </div>\n    <div class="task-list-footer" ng-if="!noTaskInDefaultList && !isFilterOpen && list.completedTasks.length > 0">\n        <a href="/group/{{ launcher.getGroup().id }}/tasks/list-{{ list.id }}"><svg><use xlink:href="#task_more"/></svg> 更多已完成的任务</a>\n    </div>\n</div>\n\n<div class="task-list is-detail" ng-if="mode === \'detail\'">\n    <header ng-if="list.id != -1">\n        <h3 ng-hide="isEditingTitle">\n            <span class="task-list-detail-title" ng-click="editTitle()">{{ list.title }}</span>\n            <span class="task-op-more" widget-toggle="false">\n                <svg><use xlink:href="#task_op_more"/></svg>更多\n                <ul class="widget-menu" widget-toggle-content="right">\n                    <li class="widget-menu-item" title="删除任务清单" ng-click="remove()"><svg class="task-list-detail-remove"><use xlink:href="#task_del"/></svg>删除清单</li>\n                    <li class="widget-menu-item" title="归档任务清单" ng-click="archive()" ng-if="list.ableToArchive && !list.archived"><svg class="task-list-detail-archive"><use xlink:href="#task_archive"/></svg>归档</li>\n                </ul>\n            </span>\n        </h3>\n        <div ng-show="isEditingTitle">\n            <input class="form-control-task" type="text" placeholder="输入清单名称"\n                widget-auto-focus\n                widget-focus="isEditingTitle === true"\n                ng-model="list.title"\n                ng-model-options="{updateOn:\'blur\'}"\n                ng-blur="editDoneTitle()"\n                ng-change="saveTitle()"\n            >\n        </div>\n\n        <p class="task-list-detail-desc" ng-hide="isEditingDesc" ng-click="editDesc()">{{ list.desc == \' \' ? \'对此清单添加描述文字\' : list.desc }}</p>\n        <div ng-show="isEditingDesc">\n            <input class="form-control-task" type="text" placeholder="清单描述（可选填）"\n                widget-auto-focus\n                widget-focus="isEditingDesc === true"\n                ng-model="list.desc"\n                ng-model-options="{updateOn:\'blur\'}"\n                ng-blur="editDoneDesc()"\n                ng-change="saveDesc()"\n            >\n        </div>\n    </header>\n    <header ng-if="list.id === -1">\n        <h3><span class="task-list-detail-title">默认清单</span></h3>\n    </header>\n    <div class="task-list-body">\n        <ul class="unfinished-task" ng-if="list.tasks.length > 0">\n            <li ng-repeat="task in list.tasks" task-item="task"></li>\n        </ul>\n        <ul class="finished-task" ng-if="list.completedTasks.length > 0">\n            <span class="task-list-detail-title-2"><svg class="task-more"><use xlink:href="#task_more"/></svg>已完成的任务</span>\n            <!-- completed tasks -->\n            <li ng-repeat="task in list.completedTasks" task-item="task" in-complete="true"></li>\n        </ul>\n    </div>\n    <div class="task-list-operation"  ng-if="list.id != -1">\n        <span class="task-list-detail-title-2"><svg><use xlink:href="#task_log"/></svg>操作日志</span>\n        <ul class="task-list-history">\n            <li ng-repeat="operation in list.operations" task-operation="operation"></li>\n        </ul>\n    </div>\n</div>\n\n<div class="task-list" ng-if="mode === \'readOnly\' && !inAside">\n    <header>\n        <h3 class="task-list-title">\n            <a href="/group/{{ launcher.getGroup().id }}/archivedTasks/list-{{ list.id }}">{{ list.title }}</a>\n        </h3>\n    </header>\n    <ul>\n        <li ng-repeat="task in list.tasks" task-item="task" mode="readOnly"></li>\n    </ul>\n</div>\n\n<div class="task-list is-detail" ng-if="mode === \'readOnly\' && inAside">\n    <header>\n        <h3>\n            <span class="task-list-detail-title">{{ list.title }}</span>\n            <span class="task-op-more" widget-toggle="false">\n                <svg><use xlink:href="#task_op_more"/></svg>更多\n                <ul class="widget-menu" widget-toggle-content="right">\n                    <li class="widget-menu-item" title="删除任务清单" ng-click="remove()"><svg class="task-list-detail-remove"><use xlink:href="#task_del"/></svg>删除清单</li>\n                    <li class="widget-menu-item" title="重新打开任务清单" ng-click="reopen()" ng-if="list.archived"><svg class="task-list-detail-reopen"><use xlink:href="#task_reopen"/></svg>重新打开清单</li>\n                </ul>\n            </span>\n        </h3>\n        <p class="task-list-detail-desc">{{list.desc}}</p>\n    </header>\n    <div class="task-list-body">\n        <ul class="finished-task" ng-if="list.completedTasks.length > 0">\n            <span class="task-list-detail-title-2"><svg class="task-more"><use xlink:href="#task_more"/></svg>已完成的任务</span>\n            <li ng-repeat="task in list.completedTasks" task-item="task" mode="readOnly" in-complete="true"></li>\n        </ul>\n    </div>\n    <div class="task-list-operation">\n        <span class="task-list-detail-title-2"><svg><use xlink:href="#task_log"/></svg>操作日志</span>\n        <ul class="task-list-history">\n            <li ng-repeat="operation in list.operations" task-operation="operation"></li>\n        </ul>\n    </div>\n</div>\n\n<form class="task-list" ng-if="mode === \'edit\'" ng-submit="save(list)">\n    <div class="form-group-task">\n        <input class="form-control-task" type="text" placeholder="输入清单名称" widget-auto-focus ng-model="list.title">\n    </div>\n    <div class="form-group-task task-list-form-desc">\n        <input class="form-control-task" type="text" placeholder="清单描述（可选填）" ng-model="list.desc">\n    </div>\n    <div class="form-group-task">\n        <button class="btn btn-task-primary" type="submit" ng-disabled="!list.title">保存清单并添加任务</button>\n        <button class="btn btn-task-default" type="button" ng-click="cancel()">取消</button>\n    </div>\n</form>\n\n'),$templateCache.put("pagelet/task/directive/taskOperation.html",'<div class="task-operation">\n    <!--<i class="task-operation-icon-container" operation-icon="operation"></i>-->\n    <span class="task-operation-time">{{ operation.opTime | date : \'yyyy-MM-dd HH:mm:ss\'}}</span>\n    <span class="task-operation-operator">{{ operation.operator | alias}}</span>\n    <span class="task-operation-action" operation="operation"></span>\n</div>'),$templateCache.put("pagelet/task/msg/message-tip.html","<span ng-if='tip.operation == 0' ng-bind=\"tip.user.name + '：新建了清单' \"></span>\n<span ng-if='tip.operation == 3' ng-bind=\"tip.user.name + '：删除了清单' \"></span>\n<span ng-if='tip.operation == 5' ng-bind=\"tip.user.name + '：新建了任务' \"></span>\n<span ng-if='tip.operation == 6' ng-bind=\"tip.user.name + '：完成了任务' \"></span>\n<span ng-if='tip.operation == 8' ng-bind=\"tip.user.name + '：删除了任务' \"></span>"),$templateCache.put("pagelet/task/msg/message.html",'<div ng-controller="taskMessageCtrl">\n    <div class="msg-photo">\n        <img ng-src="{{::message.user.photo | photo}}" class="bubble-user" user-info data-user-id="{{message.user.userId}}" />\n        <i class="operation-icon" ng-class="::{\'operation-upload-icon\': message.operation == 1 || message.operation == 6, \'operation-delete-icon\': message.operation == 3}"></i>\n    </div>\n    <div class="content-node">\n        <div class="content-head ellipsis selectable">\n            <div class="username" user-info data-user-id="{{message.user.userId}}" ng-bind="::(message.user | alias)"></div>\n            <a href="http://note.youdao.com/charge/setMeal.html" target="_blank" tracker track-category="vipIcon" track-action="click"><i ng-class="{vip:vipList[\'{{message.user.userId}}\']}"></i></a>\n            <div class="operation" ng-switch="::message.operation">\n                <!--<span ng-switch-when="0">新建了清单</span>\n                <span ng-switch-when="3">删除了清单</span>\n                <span ng-switch-when="5">新建了任务</span>\n                <span ng-switch-when="6">完成了任务</span>\n                <span ng-switch-when="8">删除了任务</span>-->\n                <span ng-switch-when="CREATE_LIST">新建了清单</span>\n                <span ng-switch-when="DELETE_LIST" class="delete">删除了清单</span>\n                <span ng-switch-when="CREATE_TASK">新建了任务</span>\n                <span ng-switch-when="FINISH_TASK">完成了任务</span>\n                <span ng-switch-when="DELETE_TASK" class="delete">删除了任务</span>\n            </div>\n            <div class="time" ng-bind="::(message.time | date:\'HH:mm\')"></div>\n        </div>\n        <div class="bubble">\n            <div class="bubble-node bubble-file-node">\n                <div class="fileinfo" ng-if="::(message.operation != \'DELETE_LIST\' && message.operation != \'DELETE_TASK\')">\n                    <a class="fileicon task active" href="{{message.link}}"\n                            ><svg><use xlink:href="#task_push"/></svg></a>\n                    <div class="filemeta">\n                        <a class="name active selectable" ng-bind="::((message.title) | fileName)"\n                           href="{{message.link}}"\n                              ></a>\n                        <span class="revision" ng-if="::(message.expectFinishTime && message.operation != \'CREATE_LIST\')"\n                              ng-bind="::(message.expectFinishTime | date:\'yyyy-MM-dd\')"></span>\n                    </div>\n                </div>\n                <div class="fileinfo" ng-if="::(message.operation == \'DELETE_LIST\' || message.operation == \'DELETE_TASK\')">\n                    <i class="fileicon task"><svg><use xlink:href="#task_push_gray"/></svg></i>\n                    <div class="filemeta">\n                        <span class="name selectable delete" ng-bind="::((message.title) | fileName)"\n                                ></span>\n                        <span class="revision" ng-if="::(message.expectFinishTime && message.operation != \'DELETE_LIST\' && message.operation != \'CREATE_LIST\')"\n                              ng-bind="::(message.expectFinishTime | date:\'yyyy-MM-dd\')"></span>\n                    </div>\n                </div>\n                <div ng-if="::(message.operation != \'DELETE_LIST\' && message.operation != \'DELETE_TASK\')">\n                    <div class="bubble-split">\n                    </div>\n                    <a class="fileaction" href="{{message.link}}">\n                        <svg class="folder-opener task">\n                            <use class="default" xlink:href="#folder_opener"/>\n                            <use class="hover" xlink:href="#folder_opener_hover"/>\n                        </svg>\n                        <span class="fileaction-item">查看</span>\n                    </a>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("pagelet/task/myTasks.html",'<div class="my-tasks tasks-container" ng-controller="myTasksCtrl">\n    <h1>我的任务</h1>\n    <div class="scroll-container" widget-scroller>\n        <h3>今天</h3>\n        <ul>\n            <li ng-repeat="task in todayTasks" task-item="task" task-mode="myTasks"></li>\n        </ul>\n        <hr>\n        <h3>本周内</h3>\n        <ul>\n            <li ng-repeat="task in thisweekTasks" task-item="task" task-mode="myTasks"></li>\n        </ul>\n        <hr>\n        <h3>下一步</h3>\n        <ul>\n            <li ng-repeat="task in nextTasks" task-item="task" task-mode="myTasks"></li>\n        </ul>\n    </div>\n</div>\n'),$templateCache.put("pagelet/task/tasks.html",'<div class="tasks-container" ng-controller="tasksCtrl">\n    <div class="task-top">\n        <button class="btn create-task" type="button" ng-click="triggerAddTask()">新建任务</button>\n        <span>或</span>\n        <button class="btn create-task" type="button" ng-click="addTaskList()">新建任务清单</button>\n    </div>\n    <div widget-scroller class="scroll-container">\n        <div class="task-top-2">\n            <span ng-if="!(lists.length === 1 && lists[0].tasks.length === 0 && lists[0].completedTasks.length == 0)">\n                <span class="all-task" role="button" ng-click="resetFilter()" ng-class="{\'selected\': !isFilterOpen}">全部任务</span>\n                <span class="split"></span>\n                <span role="button" class="filter-btn" ng-class="{\'selected\': isFilterOpen}" widget-toggle="false">\n                    <svg class="filter-open">\n                        <use xlink:href="#filter_open"/>\n                    </svg>\n                    <span title="取消筛选">\n                        <svg class="filter-close" ng-click="resetFilter(); $event.stopPropagation()">\n                            <use xlink:href="#filter_close"/>\n                        </svg>\n                    </span>\n                    <span>筛选查看</span>\n                    <div class="widget-menu" widget-toggle-content>\n                        <label for="">按成员筛选查看：</label>\n                        <div class="filter-item-toggle" widget-toggle="false" ng-click="$event.stopPropagation()">\n                            <span ng-bind="filter.assignee.name || \'查找成员\'"></span>\n                            <ul class="widget-menu" widget-toggle-content>\n                                <li class="widget-menu-item" ng-click="filter.assignee = {name: \'我自己\', userId: \'myself\'}">我自己</li>\n                                <li class="widget-menu-item" ng-click="filter.assignee = {name: \'所有人\', userId: \'all\'}">所有人</li>\n                                <li class="widget-menu-item" ng-click="filter.assignee = {name: \'无指派\', userId: \'unassigned\'}">无指派</li>\n                                <li class="widget-menu-item split-line"></li>\n                                <li class="widget-menu-item" ng-repeat="member in getMembers()" ng-click="filter.assignee = member">\n                                    <img ng-src="{{ member.photo }}" width="16" height="16">\n                                    <span>{{ member.name }}</span>\n                                </li>\n                            </ul>\n                        </div>\n                        <label for="">按到期时间筛选查看：</label>\n                        <span class="time-btn" ng-click="filter.dueDate = \'today\'" ng-class="{\'selected\': filter.dueDate == \'today\'}">今天</span>\n                        <span class="time-btn" ng-click="filter.dueDate = \'thisweek\'" ng-class="{\'selected\': filter.dueDate == \'thisweek\'}">本周内</span>\n                        <span class="time-btn" ng-click="filter.dueDate = \'delay\'" ng-class="{\'selected\': filter.dueDate == \'delay\'}">已过期</span>\n                        <span class="time-btn" ng-click="filter.dueDate = \'notset\'" ng-class="{\'selected\': filter.dueDate == \'notset\'}">无时限</span>\n                    </div>\n                </span>\n            </span>\n            <span class="pull-right">\n                <a href="/group/{{ launcher.getGroup().id }}/archivedTasks"><svg><use xlink:href="#task_archive"/></svg> 查看已归档的清单</a>\n            </span>\n        </div>\n\n        <div class="task-container" ng-if="!isFilterOpen">\n            <ul ng-if="lists.length > 0">\n                <li ng-repeat="list in lists" task-list="list" is-filter-open="isFilterOpen" filter="filter" no-task-in-default-list="lists.length === 1 && lists[0].tasks.length === 0 && lists[0].completedTasks.length == 0"></li>\n                <li ng-if="isAdding" task-list mode="edit"></li>\n            </ul>\n            <div ng-if="lists.length === 1 && lists[0].tasks.length === 0" class="blank">\n                <svg>\n                    <use xlink:href="#blank_list"/>\n                </svg>\n                <p>目前没有待处理的任务</p>\n            </div>\n        </div>\n\n        <div class="task-container" ng-if="isFilterOpen">\n            <ul ng-if="filteredLists.length > 0">\n                <li ng-repeat="list in filteredLists" task-list="list" is-filter-open="isFilterOpen" filter="filter" check-due-date="checkDueDate" check-assignee="checkAssignee" no-task-in-default-list="filteredLists.length === 1 && filteredLists[0].tasks.length === 0 && filteredLists[0].completedTasks.length === 0"></li>\n                <li ng-if="isAdding" task-list mode="edit"></li>\n            </ul>\n            <div ng-if="filteredLists.length === 1 && filteredLists[0].tasks.length === 0" class="blank">\n                <svg>\n                    <use xlink:href="#blank_list"/>\n                </svg>\n                <p>没有找到符合条件的任务</p>\n            </div>\n        </div>\n    </div>\n    <script type="text/ng-template" id="/tasksFilter.html">\n        <div>\n            <label for="">按成员筛选查看：</label>\n            <select select-member ng-model="data.filter.assignee">\n                <option></option>\n            </select>\n            <label for="">按到期时间筛选查看：</label>\n            <span class="time-btn" ng-click="data.filter.dueDate = \'today\'">今天</span>\n            <span class="time-btn" ng-click="data.filter.dueDate = \'thisweek\'">本周内</span>\n            <span class="time-btn" ng-click="data.filter.dueDate = \'delay\'">已过期</span>\n            <span class="time-btn" ng-click="data.filter.dueDate = \'\'">无时限</span>\n        </div>\n    </script>\n</div>\n'),$templateCache.put("pagelet/text/preview.html",'<div detail-comment>\n    <div ng-controller="textPreviewCtrl" class="office-preview" ng-class="{meta:meta}">\n        <p class="info" ng-show="meta">\n            <span class="meta-item" ng-bind="\'创建时间：\' + (file.createDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n            <span class="meta-item" ng-bind="\'修改时间：\' + (file.lastModifiedDate | date:\'yyyy-MM-dd HH:mm\')"></span>\n            <span class="meta-item" ng-bind="\'文件大小：\' + (file.size | fileSize)"></span>\n            <span class="meta-path-prefix">所在位置： </span>\n            <span class="meta-path" ng-bind="filePath" title="{{filePath}}" ng-click="onOpenFolder(file.parentId)"></span>\n        </p>\n        <div class="office-preview-ct text-preview-ct">\n            <div class="office-preview-iframe" ng-if="src" text-viewer="src"></div>\n        </div>\n    </div>\n</div>'),$templateCache.put("pagelet/text/textViewer.html",'<div class="text-viewer selectable">{{ content }}</div>\n')
}}),define("groupApp",["angular","angularLocaleZhHansCn","angularAnimate","angularSanitize","angularUiSelect","ynDialog","ynToast","ynMenu","commonModule","sidebarModule","fileModule","chatModule","settingModule","noteModule","imageModule","previewModule","pdfModule","calendarModule","textModule","markdownModule","taskModule","searchModule","tableModule","orgSettingModule","app/config","app/groupCtrl","app/viewport/viewport","app/router","app/launcher","app/settings","app/members","app/viewport/scaffoldingCtrl","app/viewport/container","app/templates"],function(angular,angularLocaleZhHansCn,angularAnimate,angularSanitize,angularUiSelect,ynDialog,ynToast,ynMenu,commonModule,sidebarModule,fileModule,chatModule,settingModule,noteModule,imageModule,previewModule,pdfModule,calendarModule,textModule,markdownModule,taskModule,searchModule,tableModule,orgSettingModule,config,groupCtrl,viewport,router,launcher,settings,members,scaffoldingCtrl,viewContainer,templates){"use strict";return angular.module("groupApp",["ngAnimate","ngSanitize","ui.select","ynote.dialog","ynote.toast","ynote.menu",commonModule.name,sidebarModule.name,fileModule.name,chatModule.name,settingModule.name,noteModule.name,imageModule.name,previewModule.name,pdfModule.name,calendarModule.name,textModule.name,markdownModule.name,taskModule.name,searchModule.name,tableModule.name,orgSettingModule.name]).controller("groupCtrl",["$scope","launcher","clientProxy","storageManager","$location","dialogService","notification",groupCtrl]).controller("scaffoldingCtrl",["$scope","$q","$location","viewport","launcher","clientProxy","explorer","storageManager","fileManager","members","$window","groupTopService","groupService","ROLES","LOCAL_STORAGE_KEY","router",scaffoldingCtrl]).service("router",["$rootScope","$location","$q",router]).service("launcher",["$rootScope","$q","$location","$http","$timeout","router","groupService","userService","organizationService","aliasService","pomeloService","dialogService","clientProxy","applicantService","updater","widgetMasker","ROLES","ORG_EVENTS","settings","storageManager","NOTIFICATION_TYPE","titleService","LOCAL_STORAGE_KEY",launcher]).service("settings",["$rootScope","$q","groupService","userService",settings]).service("members",["$rootScope","$q","$timeout","groupService","vipService","userService","aliasService","launcher","dialogService","applicantService","organizationService","ROLES",members]).directive("viewContainer",["$compile","$http","$templateCache","$q","viewport","launcher",viewContainer.container]).directive("viewContainerCenter",[viewContainer.center]).directive("viewContainerFull",[viewContainer.full]).service("viewport",["$rootScope","$location","$q","extension","launcher","titleService",viewport]).constant("DOCUMENT_TITLE","有道云协作").config(["$httpProvider","$locationProvider",config]).run(["$templateCache",templates]).run(["members",function(){}]).constant("ROLES",{ORG_OWNER:"ROLE_ORG_OWNER",ORG_MANAGER:"ROLE_ORG_MANAGER",ORG_USER:"ROLE_ORG_USER",GROUP_FOUNDER:"ROLE_GROUP_FOUNDER",GROUP_MANAGER:"ROLE_GROUP_MANAGER",GROUP_EDITOR:"ROLE_GROUP_EDITOR",GROUP_READER:"ROLE_GROUP_READER",GROUP_RESTORER:"ROLE_GROUP_RESTORER",GROUP_VIEWER:"ROLE_GROUP_VIEWER",ORG_EXPIRED:"STATUS_ORG_EXPIRED"}).constant("ORG_EVENTS",{CREATE:"org.create",UPDATE:"org.update",JOIN:"org.join",DISMISS:"org.dismiss",INVITED:"org.invited",QUIT:"org.quit"}).constant("GROUP_EVENTS",{QUIT:"group.quit",CREATE:"group.create",UPDATE:"group.update",JOIN:"group.join",DISMISS:"group.dismiss",INVITED:"group.invited",FORWARD:"group.forward"}).constant("SHARE_EVENTS",{SHARE:"share.start",UNSHARE:"share.stop"})});